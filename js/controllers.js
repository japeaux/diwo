angular.module('app.controllers', ['ngCordova','ion-datetime-picker','chart.js','ionic-ratings'])

.controller('versaoCtrl', ['$scope', '$stateParams','$state','$http', '$ionicPopup',// The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams,$state, $http, $ionicPopup ) {
 

  var tela = JSON.parse( window.localStorage.getItem( 'versao' ));
  if(tela == '1'){
    $state.go('novahomesemlogin')
  }

  $scope.$on("$ionicView.enter", function(event, data){
    var tela = JSON.parse( window.localStorage.getItem( 'versao' ));
    console.log(tela, "tela")
    if(tela == '1'){
      $state.go('novahomesemlogin')
    }

  });


  $scope.Skip = function(){
    $state.go('novahomesemlogin')
  }

  $scope.irparaloja = function(){
    window.location.href = "http://onelink.to/cscut7";
  }

}])  

.controller('cartelaCtrl', ['$scope', '$stateParams','$http', 'formComercio','formMeusPost','formvimdopost', 'EventoService', '$timeout', 'formItem', '$state', 'formUser', 'formtela', 'formtelaCriar', '$ionicLoading', 'formvimdofiltro', 'formvimdofiltroperfil', 'formLimiteatuacao', '$ionicTabsDelegate', '$cordovaCamera', '$cordovaFile', '$cordovaFileTransfer', '$cordovaDevice','$ionicPopup', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, $http, formComercio,formMeusPost,formvimdopost, EventoService, $timeout, formItem,  $state, formUser, formtela, formtelaCriar, $ionicLoading, formvimdofiltro, formvimdofiltroperfil, formLimiteatuacao, $ionicTabsDelegate, $cordovaCamera, $cordovaFile, $cordovaFileTransfer, $cordovaDevice,$ionicPopup ) {
 $scope.user = formUser.getForm();
  
   EventoService.GetComercioFinalizado($scope.user).then(function(badges) {
    // $scope.auxcarimbo = {};
    //  for(var i = 0 ;i<items.length;i++){
    //   $scope.auxcarimbo[i] = badges[i];
    //  }
     console.log(badges)
    if(badges!='error'){
      $scope.user.pocket  = badges;
      console.log($scope.user.pocket)
      EventoService.GetComercios($scope.user).then(function(items) { //
       if(items=='E'){
          //$scope.vazio = true;
          $scope.items = [];
        }else{
          $scope.items = items;
          //console.log(items)
        }
      });
    }else{
      EventoService.GetComercios($scope.user).then(function(items) { //
       if(items=='E'){
          //$scope.vazio = true;
          $scope.items = [];
        }else{
          $scope.items = items;
          //console.log(items)
        }
      });
    }
     
  });


    if (navigator.geolocation) {
      navigator.geolocation.getCurrentPosition(successFunction, errorFunction);
    } 
    function successFunction(position) {
 
      $scope.user.lat =  position.coords.latitude;
      $scope.user.long =  position.coords.longitude;
     
      EventoService.GetComercioFinalizado($scope.user).then(function(badges) {
        if(badges!='error'){
          $scope.user.pocket  = badges;
       
          EventoService.GetComercios($scope.user).then(function(items) { //
           if(items=='E'){
              //$scope.vazio = true;
              $scope.items = [];
            }else{
              $scope.items = items;
              //console.log(items)
            }
          });
        }else{
          EventoService.GetComercios($scope.user).then(function(items) { //
           if(items=='E'){
              //$scope.vazio = true;
              $scope.items = [];
            }else{
              $scope.items = items;
              //console.log(items)
            }
          });
        }
      });
    }
    function errorFunction(){
      console.log("error")
    }

    $scope.$on("$ionicView.enter", function(event, data){
      $ionicTabsDelegate.showBar(1);
       $scope.user = formUser.getForm();
       if($scope.user.lat){
         EventoService.GetComercioFinalizado($scope.user).then(function(badges) {
          if(badges!='error'){
            $scope.user.pocket  = badges;
            console.log($scope.user.pocket)
            EventoService.GetComercios($scope.user).then(function(items) { //
             if(items=='E'){
                //$scope.vazio = true;
                $scope.items = [];
              }else{
                $scope.items = items;
                //console.log(items)
              }
            });
          } 
        });
       }
      
    });

    $scope.enterItem =  function(item){

      formComercio.updateForm($scope.items[item]);
      $state.go("tabsController.telacomercio");
    }


}])

.controller('telacomercioCtrl', ['$scope', '$stateParams', '$state', 'EventoService', 'formComercio', '$ionicTabsDelegate', 'formItem', 'formDataEscolhida', '$ionicPopup', '$cordovaActionSheet','$ionicLoading','$http','formCodigo', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, $state, EventoService, formComercio, $ionicTabsDelegate, formItem, formDataEscolhida, $ionicPopup, $cordovaActionSheet,$ionicLoading,$http,formCodigo) {

  $scope.comercio = formComercio.getForm();

  $scope.auxdatavalida = {};
  $scope.auxdatavalida.diainicio = [];
  $scope.auxdatavalida.curr_date =[];
            $scope.auxdatavalida.h2 = [];
            $scope.auxdatavalida.m2 = [];
            $scope.auxdatavalida.curr_month = [];
            $scope.auxdatavalida.curr_year =[];
            $scope.items = [];
      EventoService.GetEventosPendentes($scope.comercio).then(function(items) {        
        //console.log(items)
        if(items=='E'){
          $scope.vazio = true;
          $scope.items = [];
        }else{
          $scope.vazio = false;
          for (var i = 0; i < items.length; i++) {
                var curr_date = (items[i].diainicio[8]+items[i].diainicio[9]);
                var h2 = (items[i].diainicio[11]+items[i].diainicio[12]);
                var m2 = (items[i].diainicio[14]+items[i].diainicio[15]);
                var curr_month = (items[i].diainicio[5]+items[i].diainicio[6]);
                var curr_year = (items[i].diainicio[0]+items[i].diainicio[1]+items[i].diainicio[2]+items[i].diainicio[3]);
                var j = curr_date + "/" + curr_month + "/" + curr_year+ ' '+h2 + ':' + m2;
                items[i].datainicio = j;
                items[i].dia = curr_date+'/'+curr_month;
                items[i].hora = h2+':'+m2;

            }
          $scope.items = items;
          $scope.lastidvestido = $scope.items[0].idevento;
        }
      });
      $scope.eventoscomercio = true;
      $scope.infos = false;
      $scope.escolhahorario = false;
      $scope.eventoshorario = false;
      $scope.eventosdata = false;
       if(!$scope.comercio.horariofuncionamento){
        $scope.naotemhorario = true;
        document.getElementById("loadEventos").className = "btncomerciotab actcomerciotab";
        //document.getElementById("loadHorarios").className = "btncomerciotab";
        document.getElementById("loadInfos").className = "btncomerciotab";
      }else{
        document.getElementById("loadEventos").className = "btncomerciotab actcomerciotab";
        document.getElementById("loadHorarios").className = "btncomerciotab";
        document.getElementById("loadInfos").className = "btncomerciotab";
      }

  $scope.$on("$ionicView.enter", function(event, data){
    $ionicTabsDelegate.showBar(0);
    $scope.eventosdata = false;
    $scope.comercio = formComercio.getForm();
    console.log($scope.comercio.horariofuncionamento,"$scope.comercio.horariofuncionamento")
      if(!$scope.comercio.horariofuncionamento){
        $scope.naotemhorario = true;
      }
    
  });

    $scope.loadEventos = function() {
      
      $scope.items = [];
      EventoService.GetEventosPendentes($scope.comercio).then(function(items) {        
        //console.log(items)
        if(items=='E'){
          $scope.vazio = true;
          $scope.items = [];
        }else{
          $scope.vazio = false;
          for (var i = 0; i < items.length; i++) {
                var curr_date = (items[i].diainicio[8]+items[i].diainicio[9]);
                var h2 = (items[i].diainicio[11]+items[i].diainicio[12]);
                var m2 = (items[i].diainicio[14]+items[i].diainicio[15]);
                var curr_month = (items[i].diainicio[5]+items[i].diainicio[6]);
                var curr_year = (items[i].diainicio[0]+items[i].diainicio[1]+items[i].diainicio[2]+items[i].diainicio[3]);
                var j = curr_date + "/" + curr_month + "/" + curr_year+ ' '+h2 + ':' + m2;
                items[i].datainicio = j;
                items[i].dia = curr_date+'/'+curr_month;
                items[i].hora = h2+':'+m2;

            }
          $scope.items = items;
          $scope.lastidvestido = $scope.items[0].idevento;
        }
      });
      $scope.eventoscomercio = true;
      $scope.infos = false;
      $scope.escolhahorario = false;
      $scope.eventoshorario = false;
      $scope.eventosdata = false;
       if(!$scope.comercio.horariofuncionamento){
        $scope.naotemhorario = true;
        document.getElementById("loadEventos").className = "btncomerciotab actcomerciotab";
        //document.getElementById("loadHorarios").className = "btncomerciotab";
        document.getElementById("loadInfos").className = "btncomerciotab";
      }else{
        document.getElementById("loadEventos").className = "btncomerciotab actcomerciotab";
        document.getElementById("loadHorarios").className = "btncomerciotab";
        document.getElementById("loadInfos").className = "btncomerciotab";
      }
    }
    

    $scope.loadHorarios = function() {
      // $scope.datas = {};
      // $scope.datainicio= [];
      // $scope.dia = [];
      // $scope.semana =[];
      // $scope.datas.dia =[];
      // $scope.datas.semana =[];
      document.getElementById("loadEventos").className = "btncomerciotab";
      document.getElementById("loadHorarios").className = "btncomerciotab actcomerciotab";
      document.getElementById("loadInfos").className = "btncomerciotab";
      $scope.vazio = false;
      $scope.datas =[];
      $scope.datainicio= [];
      $scope.dia = [];
      $scope.semana =[];
      $scope.mesescrito =[];
      $scope.datas.dia =[];
      $scope.datas.semana =[];
      $scope.datas.mesescrito =[];

      $scope.datainicio2= [];
      $scope.dia2 = [];
      $scope.semana2 =[];
      $scope.mesescrito2 =[];
     //  for(var i = 0;i<30;i++){
     //    var now = new Date(); 
     //    now.setDate(now.getDate() + i);
     //    var curr_date1 = (now.getDate()<10?'0':'') + now.getDate();
     //    var curr_month1 = (now.getMonth()<10?'0':'') + (now.getMonth() + 1); 
     //    var curr_year1 = now.getFullYear();
     //    var h2 = (now.getHours()<10?'0':'') + now.getHours();
     //    var m2 = (now.getMinutes()<10?'0':'') + now.getMinutes();

     //    var j = curr_date1 + "/" + curr_month1 + "/" + curr_year1+ ' '+h2 + ':' + m2;
     //    $scope.datainicio[i] = j;
     //    $scope.dia[i] = curr_date1+'/'+curr_month1;
     //    $scope.semana[i] =  now.getDay();
     //    if($scope.semana[i] == 0){
     //      $scope.semana[i] = "Domingo";
     //    }
     //    if($scope.semana[i] == 1){
     //      $scope.semana[i] = "Segunda-feira";
     //    }
     //    if( $scope.semana[i] == 2){
     //      $scope.semana[i] = "Terça-feira";
     //    }
     //    if($scope.semana[i] == 3){
     //      $scope.semana[i] = "Quarta-feira";
     //    }
     //    if($scope.semana[i] == 4){
     //      $scope.semana[i] = "Quinta-feira";
     //    }
     //    if($scope.semana[i] == 5){
     //      $scope.semana[i] = "Sexta-feira";
     //    }
     //    if($scope.semana[i] == 6){
     //      $scope.semana[i] = "Sábado";
     //    }
     //  $scope.datas.dia[i] = $scope.dia[i];
     //  $scope.datas.semana[i] = $scope.semana[i];
     //  console.log($scope.semana[i])
     // }

      var semanafuncionamento = $scope.comercio.semanafuncionamento.split(" ") ;
      var j2 = 0;
      for(var i = 0;j2<30;i++){
        var now = new Date(); 
        now.setDate(now.getDate() + i );
        var curr_date1 = (now.getDate()<10?'0':'') + (now.getDate());
        var curr_month1 = (now.getMonth()<10?'0':'') + (now.getMonth()+1) ; 
        var curr_year1 = now.getFullYear();
        var h2 = (now.getHours()<10?'0':'') + now.getHours();
        var m2 = (now.getMinutes()<10?'0':'') + now.getMinutes();
        $scope.semana[i] =  now.getDay();
        var j = curr_date1 + "/" + curr_month1 + "/" + curr_year1+ ' '+h2 + ':' + m2;
        $scope.datainicio[i] = j;
        //console.log(curr_month1, parseInt(curr_month1), parseInt(curr_year1))

        if(parseInt(curr_month1) == 1){
          $scope.mesescrito[i] = "Jan";
        }
        if(parseInt(curr_month1) == 2){
          $scope.mesescrito[i] = "Fev";
        }
        if(parseInt(curr_month1) == 3){
          $scope.mesescrito[i] = "Mar";
        }
        if(parseInt(curr_month1) == 4){
          $scope.mesescrito[i] = "Abr";
        }
        if(parseInt(curr_month1) == 5){
          $scope.mesescrito[i] = "Mai";
        }
        if(parseInt(curr_month1) == 6){
          $scope.mesescrito[i] = "Jun";
        }
        if(parseInt(curr_month1) == 7){
          $scope.mesescrito[i] = "Jul";
        }
        if(parseInt(curr_month1) == 8){
          $scope.mesescrito[i] = "Ago";
        }
        if(parseInt(curr_month1) == 9){
          $scope.mesescrito[i] = "Set";
        }
        if(parseInt(curr_month1) == 10){
          $scope.mesescrito[i] = "Out";
        }
        if(parseInt(curr_month1) == 11){
          $scope.mesescrito[i] = "Nov";
        }
        if(parseInt(curr_month1) == 12){
          $scope.mesescrito[i] = "Dez";
        }

        $scope.dia[i] = curr_date1;
   
         //console.log($scope.semana[i],"ANTEST",$scope.dia[i], i, $scope.semana[i],  $scope.datainicio[i]);
        if(semanafuncionamento.length>=1){
          for(var w = 0; w < semanafuncionamento.length; w++){
            var t = semanafuncionamento[w].toLowerCase();
            //console.log(t, semanafuncionamento[w])
            if(semanafuncionamento[w] == 'Dom'){ // Seg Ter Qua Qui Sex Sab
              if($scope.semana[i] == 0){
                $scope.semana2[j2] = "Dom";
                $scope.dia2[j2] = curr_date1;
                $scope.mesescrito2[j2] = $scope.mesescrito[i];
                $scope.datainicio2[j2] = $scope.datainicio[i];
                $scope.datas[j2] = {dia : $scope.dia2[j2], semana : $scope.semana2[j2], diainicio:  $scope.datainicio2[j2], mesescrito : $scope.mesescrito2[j2]};
                j2++;
              }
            }
            if(semanafuncionamento[w] == 'Seg'){ // Seg Ter Qua Qui Sex Sab
              
              //console.log("semanafuncionamento[w]",semanafuncionamento[w], $scope.semana[i])
              if($scope.semana[i] == 1){
                $scope.semana2[j2] = "Seg";
                $scope.dia2[j2] = curr_date1;
                $scope.mesescrito2[j2] = $scope.mesescrito[i];
                $scope.datainicio2[j2] = $scope.datainicio[i];
                $scope.datas[j2] = {dia : $scope.dia2[j2], semana : $scope.semana2[j2], diainicio:  $scope.datainicio2[j2], mesescrito : $scope.mesescrito2[j2]};
                //console.log($scope.datainicio2[j2], $scope.mesescrito2[j2], $scope.dia2[j2], $scope.semana2[j2], j2)
                j2++;
              }
            }
            if(semanafuncionamento[w] == 'Ter'){ // Seg Ter Qua Qui Sex Sab
              if($scope.semana[i] == 2){
                $scope.semana2[j2] = "Ter";
                $scope.dia2[j2] = curr_date1;
                $scope.mesescrito2[j2] = $scope.mesescrito[i];
                $scope.datainicio2[j2] = $scope.datainicio[i];
                $scope.datas[j2] = {dia : $scope.dia2[j2], semana : $scope.semana2[j2], diainicio:  $scope.datainicio2[j2], mesescrito : $scope.mesescrito2[j2]};
                j2++;
              }
            }
            if(semanafuncionamento[w] == 'Qua'){ // Seg Ter Qua Qui Sex Sab
              if($scope.semana[i] == 3){
                $scope.semana2[j2] = "Qua";
                $scope.dia2[j2] = curr_date1;
                $scope.mesescrito2[j2] = $scope.mesescrito[i];
                $scope.datainicio2[j2] = $scope.datainicio[i];
                $scope.datas[j2] = {dia : $scope.dia2[j2], semana : $scope.semana2[j2], diainicio:  $scope.datainicio2[j2], mesescrito : $scope.mesescrito2[j2]};
                j2++;
              }
            }
            if(semanafuncionamento[w] == 'Qui'){ // Seg Ter Qua Qui Sex Sab
              if($scope.semana[i] == 4){
                $scope.semana2[j2] = "Qui";
                $scope.dia2[j2] = curr_date1;
                $scope.mesescrito2[j2] = $scope.mesescrito[i];
                $scope.datainicio2[j2] = $scope.datainicio[i];
                $scope.datas[j2] = {dia : $scope.dia2[j2], semana : $scope.semana2[j2], diainicio:  $scope.datainicio2[j2], mesescrito : $scope.mesescrito2[j2]};
                j2++;
              }
            }
            if(semanafuncionamento[w] == 'Sex'){ // Seg Ter Qua Qui Sex Sab
              if($scope.semana[i] == 5){
                $scope.semana2[j2] = "Sex";
                $scope.dia2[j2] = curr_date1;
                $scope.mesescrito2[j2] = $scope.mesescrito[i];
                $scope.datainicio2[j2] = $scope.datainicio[i];
                $scope.datas[j2] = {dia : $scope.dia2[j2], semana : $scope.semana2[j2], diainicio:  $scope.datainicio2[j2], mesescrito : $scope.mesescrito2[j2]};
                j2++;
              }
            }
            if(semanafuncionamento[w] == 'Sab'){ // Seg Ter Qua Qui Sex Sab
              if($scope.semana[i] == 6){
                $scope.semana2[j2] = "Sáb";
                $scope.dia2[j2] = curr_date1;
                $scope.mesescrito2[j2] = $scope.mesescrito[i];
                $scope.datainicio2[j2] = $scope.datainicio[i];
                $scope.datas[j2] = {dia : $scope.dia2[j2], semana : $scope.semana2[j2], diainicio:  $scope.datainicio2[j2], mesescrito : $scope.mesescrito2[j2]};
                j2++;
              }
            }
          }
        }
      }
      EventoService.GetEventosPendentes($scope.comercio).then(function(items) {        
        console.log(items, "GetEventosPendentes")
        if(items=='E'){
        }else{
          for (var i = 0; i < items.length; i++) {
            $scope.auxdatavalida.curr_date[i] = (items[i].diainicio[8]+items[i].diainicio[9]);
            $scope.auxdatavalida.h2[i] = (items[i].diainicio[11]+items[i].diainicio[12]);
            $scope.auxdatavalida.m2[i] = (items[i].diainicio[14]+items[i].diainicio[15]);
            $scope.auxdatavalida.curr_month[i] = (items[i].diainicio[5]+items[i].diainicio[6]);
            $scope.auxdatavalida.curr_year[i] = (items[i].diainicio[0]+items[i].diainicio[1]+items[i].diainicio[2]+items[i].diainicio[3]);
            var j = $scope.auxdatavalida.curr_year[i]  + "-" + $scope.auxdatavalida.curr_month[i] + "-" + $scope.auxdatavalida.curr_date[i]+ ' '+$scope.auxdatavalida.h2[i]  + ':' + $scope.auxdatavalida.m2[i] + ':' + '00';

            $scope.auxdatavalida.diainicio[i] = j;
            //var currentdate = new Date(); 
            console.log($scope.auxdatavalida.diainicio,"$scope.auxdatavalida.diainicio")
            }
        }
      });

   
     //console.log($scope.datas)
      $scope.eventoscomercio = false;
      $scope.infos = false;
      $scope.eventoshorario = true;
      $scope.escolhahorario = false;
      $scope.eventosdata = false;
      $scope.evento = {};
      var horariofuncionamento = $scope.comercio.horariofuncionamento.split(" ") ;
        if(horariofuncionamento.length>=1){
          for(var w = 0; w < horariofuncionamento.length; w++){
            if(w == 0){
              $scope.evento.horario1 =horariofuncionamento[w];
            }
            if(w == 1){
              $scope.evento.horario2 =horariofuncionamento[w];
            }
            if(w == 2){
              $scope.evento.horario3 =horariofuncionamento[w];
            }
            if(w == 3){
              $scope.evento.horario4 =horariofuncionamento[w];
            }
            if(w == 4){
              $scope.evento.horario5 =horariofuncionamento[w];
            }
            if(w == 5){
              $scope.evento.horario6 =horariofuncionamento[w];
            }
            if(w == 6){
              $scope.evento.horario7 =horariofuncionamento[w];
            }
            if(w == 7){
              $scope.evento.horario8 =horariofuncionamento[w];
            }
            if(w == 8){
              $scope.evento.horario9 =horariofuncionamento[w];
            }
            if(w == 9){
              $scope.evento.horario10 =horariofuncionamento[w];
            }
            if(w == 10){
              $scope.evento.horario11 =horariofuncionamento[w];
            }
            if(w == 11){
              $scope.evento.horario12 =horariofuncionamento[w];
            }
            if(w == 12){
              $scope.evento.horario13 =horariofuncionamento[w];
            }
            if(w == 13){
              $scope.evento.horario14 =horariofuncionamento[w];
            }
            if(w == 14){
              $scope.evento.horario15 =horariofuncionamento[w];
            }
            if(w == 15){
              $scope.evento.horario16 =horariofuncionamento[w];
            }
            if(w == 16){
              $scope.evento.horario17 =horariofuncionamento[w];
            }
            if(w == 17){
              $scope.evento.horario18 =horariofuncionamento[w];
            }
            if(w == 18){
              $scope.evento.horario19 =horariofuncionamento[w];
            }
            if(w == 19){
              $scope.evento.horario20 =horariofuncionamento[w];
            }
            if(w == 20){
              $scope.evento.horario21 =horariofuncionamento[w];
            }
            if(w == 21){
              $scope.evento.horario22 =horariofuncionamento[w];
            }
            if(w == 22){
              $scope.evento.horario23 =horariofuncionamento[w];
            }
            if(w == 23){
              $scope.evento.horario24 =horariofuncionamento[w];
            }

          }
        }
     
    }

    var auxdataescolhida


    $scope.escolhedata = function(dia){
      $scope.escolhahorario = true;
      $scope.eventoscomercio = false;
      $scope.infos = false;
      $scope.eventoshorario = true;
      $scope.eventosdata = true;
      console.log(dia);
      $scope.diaescolhido = dia;
      $scope.horario1 = true;
      $scope.horario2 = true;
      $scope.horario3 = true;
      $scope.horario4 = true;
      $scope.horario5 = true;
      $scope.horario6 = true;
      $scope.horario7 = true;
      $scope.horario8 = true;
      $scope.horario9 = true;
      $scope.horario10 = true;
      $scope.horario11 = true;
      $scope.horario12 = true;
      $scope.horario13 = true;
      $scope.horario14 = true;
      $scope.horario15 = true;
      $scope.horario16 = true;
      $scope.horario17 = true;
      $scope.horario18 = true;
      $scope.horario19 = true;
      $scope.horario20 = true;
      $scope.horario21 = true;
      $scope.horario22 = true;
      $scope.horario23 = true;
      $scope.horario24 = true;


      //$scope.dataescolhida.diainicio = '2019/'+$scope.dataescolhida.dia[3]+$scope.dataescolhida.dia[4]+'/'+$scope.dataescolhida.dia[0]+$scope.dataescolhida.dia[1]+' '+$scope.dataescolhida.horarioescolhido
      auxdataescolhida = '2019-'+dia[3]+dia[4]+'-'+dia[0]+dia[1];
      var currentdate1 = new Date(auxdataescolhida);
      console.log(currentdate1, "currentdate1")
      var curr_date1 = dia[0] + dia[1];
      var curr_month1 = dia[3] + dia[4]; //Months are zero based
      var curr_h1 = (currentdate1.getHours()<10?'0':'') + currentdate1.getHours();
      var curr_m1 = (currentdate1.getMinutes()<10?'0':'') + currentdate1.getMinutes();
      //var curr_j = curr_year + "-" + curr_month + "-" + curr_date+ ' '+curr_h + ':' + curr_m + ':' + '00';
        //console.log($scope.auxdatavalida.diainicio.length, curr_date1)
        var horariofuncionamento = $scope.comercio.horariofuncionamento.split(" ") ;
        var w = horariofuncionamento.length
          if(w == 0){
              $scope.horario1 = false;
              $scope.horario2 = false;
              $scope.horario3 = false;
              $scope.horario4 = false;
              $scope.horario5 = false;
              $scope.horario6 = false;
              $scope.horario7 = false;
              $scope.horario8 = false;
              $scope.horario9 = false;
              $scope.horario10 = false;
              $scope.horario11 = false;
              $scope.horario12 = false;
              $scope.horario13 = false;
              $scope.horario14 = false;
              $scope.horario15 = false;
              $scope.horario16 = false;
              $scope.horario17 = false;
              $scope.horario18 = false;
              $scope.horario19 = false;
              $scope.horario20 = false;
              $scope.horario21 = false;
              $scope.horario22 = false;
              $scope.horario23 = false;
              $scope.horario24 = false;
            }
            if(w == 1){
              $scope.horario2 = false;
              $scope.horario3 = false;
              $scope.horario4 = false;
              $scope.horario5 = false;
              $scope.horario6 = false;
              $scope.horario7 = false;
              $scope.horario8 = false;
              $scope.horario9 = false;
              $scope.horario10 = false;
              $scope.horario11 = false;
              $scope.horario12 = false;
              $scope.horario13 = false;
              $scope.horario14 = false;
              $scope.horario15 = false;
              $scope.horario16 = false;
              $scope.horario17 = false;
              $scope.horario18 = false;
              $scope.horario19 = false;
              $scope.horario20 = false;
              $scope.horario21 = false;
              $scope.horario22 = false;
              $scope.horario23 = false;
              $scope.horario24 = false;
            }
            if(w == 2){
              $scope.horario3 = false;
              $scope.horario4 = false;
              $scope.horario5 = false;
              $scope.horario6 = false;
              $scope.horario7 = false;
              $scope.horario8 = false;
              $scope.horario9 = false;
              $scope.horario10 = false;
              $scope.horario11 = false;
              $scope.horario12 = false;
              $scope.horario13 = false;
              $scope.horario14 = false;
              $scope.horario15 = false;
              $scope.horario16 = false;
              $scope.horario17 = false;
              $scope.horario18 = false;
              $scope.horario19 = false;
              $scope.horario20 = false;
              $scope.horario21 = false;
              $scope.horario22 = false;
              $scope.horario23 = false;
              $scope.horario24 = false;
            }
            if(w == 3){
              $scope.horario4 = false;
              $scope.horario5 = false;
              $scope.horario6 = false;
              $scope.horario7 = false;
              $scope.horario8 = false;
              $scope.horario9 = false;
              $scope.horario10 = false;
              $scope.horario11 = false;
              $scope.horario12 = false;
              $scope.horario13 = false;
              $scope.horario14 = false;
              $scope.horario15 = false;
              $scope.horario16 = false;
              $scope.horario17 = false;
              $scope.horario18 = false;
              $scope.horario19 = false;
              $scope.horario20 = false;
              $scope.horario21 = false;
              $scope.horario22 = false;
              $scope.horario23 = false;
              $scope.horario24 = false;
            }
            
            if(w == 4){
              $scope.horario5 = false;
              $scope.horario6 = false;
              $scope.horario7 = false;
              $scope.horario8 = false;
              $scope.horario9 = false;
              $scope.horario10 = false;
              $scope.horario11 = false;
              $scope.horario12 = false;
              $scope.horario13 = false;
              $scope.horario14 = false;
              $scope.horario15 = false;
              $scope.horario16 = false;
              $scope.horario17 = false;
              $scope.horario18 = false;
              $scope.horario19 = false;
              $scope.horario20 = false;
              $scope.horario21 = false;
              $scope.horario22 = false;
              $scope.horario23 = false;
              $scope.horario24 = false;
            }
            if(w == 5){
              $scope.horario6 = false;
              $scope.horario7 = false;
              $scope.horario8 = false;
              $scope.horario9 = false;
              $scope.horario10 = false;
              $scope.horario11 = false;
              $scope.horario12 = false;
              $scope.horario13 = false;
              $scope.horario14 = false;
              $scope.horario15 = false;
              $scope.horario16 = false;
              $scope.horario17 = false;
              $scope.horario18 = false;
              $scope.horario19 = false;
              $scope.horario20 = false;
              $scope.horario21 = false;
              $scope.horario22 = false;
              $scope.horario23 = false;
              $scope.horario24 = false;
            }
            if(w == 6){
              $scope.horario7 = false;
              $scope.horario8 = false;
              $scope.horario9 = false;
              $scope.horario10 = false;
              $scope.horario11 = false;
              $scope.horario12 = false;
              $scope.horario13 = false;
              $scope.horario14 = false;
              $scope.horario15 = false;
              $scope.horario16 = false;
              $scope.horario17 = false;
              $scope.horario18 = false;
              $scope.horario19 = false;
              $scope.horario20 = false;
              $scope.horario21 = false;
              $scope.horario22 = false;
              $scope.horario23 = false;
              $scope.horario24 = false;
            }
            if(w == 7){
              $scope.horario8 = false;
              $scope.horario9 = false;
              $scope.horario10 = false;
              $scope.horario11 = false;
              $scope.horario12 = false;
              $scope.horario13 = false;
              $scope.horario14 = false;
              $scope.horario15 = false;
              $scope.horario16 = false;
              $scope.horario17 = false;
              $scope.horario18 = false;
              $scope.horario19 = false;
              $scope.horario20 = false;
              $scope.horario21 = false;
              $scope.horario22 = false;
              $scope.horario23 = false;
              $scope.horario24 = false;
            }
            if(w == 8){
              $scope.horario9 = false;
              $scope.horario10 = false;
              $scope.horario11 = false;
              $scope.horario12 = false;
              $scope.horario13 = false;
              $scope.horario14 = false;
              $scope.horario15 = false;
              $scope.horario16 = false;
              $scope.horario17 = false;
              $scope.horario18 = false;
              $scope.horario19 = false;
              $scope.horario20 = false;
              $scope.horario21 = false;
              $scope.horario22 = false;
              $scope.horario23 = false;
              $scope.horario24 = false;
            }
            if(w == 9){
              $scope.horario10 = false;
              $scope.horario11 = false;
              $scope.horario12 = false;
              $scope.horario13 = false;
              $scope.horario14 = false;
              $scope.horario15 = false;
              $scope.horario16 = false;
              $scope.horario17 = false;
              $scope.horario18 = false;
              $scope.horario19 = false;
              $scope.horario20 = false;
              $scope.horario21 = false;
              $scope.horario22 = false;
              $scope.horario23 = false;
              $scope.horario24 = false;
            }
            if(w == 10){
              $scope.horario11 = false;
              $scope.horario12 = false;
              $scope.horario13 = false;
              $scope.horario14 = false;
              $scope.horario15 = false;
              $scope.horario16 = false;
              $scope.horario17 = false;
              $scope.horario18 = false;
              $scope.horario19 = false;
              $scope.horario20 = false;
              $scope.horario21 = false;
              $scope.horario22 = false;
              $scope.horario23 = false;
              $scope.horario24 = false;
            }
            if(w == 11){
              $scope.horario12 = false;
              $scope.horario13 = false;
              $scope.horario14 = false;
              $scope.horario15 = false;
              $scope.horario16 = false;
              $scope.horario17 = false;
              $scope.horario18 = false;
              $scope.horario19 = false;
              $scope.horario20 = false;
              $scope.horario21 = false;
              $scope.horario22 = false;
              $scope.horario23 = false;
              $scope.horario24 = false;
            }
            if(w == 12){
              $scope.horario13 = false;
              $scope.horario14 = false;
              $scope.horario15 = false;
              $scope.horario16 = false;
              $scope.horario17 = false;
              $scope.horario18 = false;
              $scope.horario19 = false;
              $scope.horario20 = false;
              $scope.horario21 = false;
              $scope.horario22 = false;
              $scope.horario23 = false;
              $scope.horario24 = false;
            }
            if(w == 13){
              $scope.horario14 = false;
              $scope.horario15 = false;
              $scope.horario16 = false;
              $scope.horario17 = false;
              $scope.horario18 = false;
              $scope.horario19 = false;
              $scope.horario20 = false;
              $scope.horario21 = false;
              $scope.horario22 = false;
              $scope.horario23 = false;
              $scope.horario24 = false;
            }
            if(w == 14){
              $scope.horario15 = false;
              $scope.horario16 = false;
              $scope.horario17 = false;
              $scope.horario18 = false;
              $scope.horario19 = false;
              $scope.horario20 = false;
              $scope.horario21 = false;
              $scope.horario22 = false;
              $scope.horario23 = false;
              $scope.horario24 = false;
            }
            if(w == 15){
              $scope.horario16 = false;
              $scope.horario17 = false;
              $scope.horario18 = false;
              $scope.horario19 = false;
              $scope.horario20 = false;
              $scope.horario21 = false;
              $scope.horario22 = false;
              $scope.horario23 = false;
              $scope.horario24 = false;
            }
            if(w == 16){
              $scope.horario17 = false;
              $scope.horario18 = false;
              $scope.horario19 = false;
              $scope.horario20 = false;
              $scope.horario21 = false;
              $scope.horario22 = false;
              $scope.horario23 = false;
              $scope.horario24 = false;
            }
            if(w == 17){
              $scope.horario18 = false;
              $scope.horario19 = false;
              $scope.horario20 = false;
              $scope.horario21 = false;
              $scope.horario22 = false;
              $scope.horario23 = false;
              $scope.horario24 = false;
            }
            if(w == 18){
              $scope.horario19 = false;
              $scope.horario20 = false;
              $scope.horario21 = false;
              $scope.horario22 = false;
              $scope.horario23 = false;
              $scope.horario24 = false;
            }
            if(w == 19){
              $scope.horario20 = false;
              $scope.horario21 = false;
              $scope.horario22 = false;
              $scope.horario23 = false;
              $scope.horario24 = false;
            }
            if(w == 20){
              $scope.horario21 = false;
              $scope.horario22 = false;
              $scope.horario23 = false;
              $scope.horario24 = false;
            }
            if(w == 21){
              $scope.horario22 = false;
              $scope.horario23 = false;
              $scope.horario24 = false;
            }
            if(w == 22){
              $scope.horario23 = false;
              $scope.horario24 = false;
            }
            if(w == 23){
              $scope.horario24 = false;
            }
        


        for (var i = 0; i <  $scope.auxdatavalida.diainicio.length; i++) {
          //console.log(curr_date1, $scope.auxdatavalida.curr_date[i] , $scope.auxdatavalida.curr_month[i] ,curr_month1)
            if($scope.auxdatavalida.curr_date[i] == curr_date1 && $scope.auxdatavalida.curr_month[i] == curr_month1 ){
              
              if( $scope.auxdatavalida.h2[i] == '14'){
                $scope.horario1 = false;
              }
              if( $scope.auxdatavalida.h2[i] == '15'){
                $scope.horario2 = false;
              }
              if( $scope.auxdatavalida.h2[i] == '16'){
                $scope.horario3 = false;
              }
              if( $scope.auxdatavalida.h2[i] == '17'){
                $scope.horario4 = false;
              }
              if( $scope.auxdatavalida.h2[i] == '18'){
                $scope.horario5 = false;
              }
              if( $scope.auxdatavalida.h2[i] == '19'){
                $scope.horario6 = false;
              }
              if( $scope.auxdatavalida.h2[i] == '20'){
                $scope.horario7 = false;
              }
              if( $scope.auxdatavalida.h2[i] == '21'){
                $scope.horario8 = false;
              }

            }
            //var currentdate = new Date(); 
            }
    }
    $scope.tiratag1 = function(){
        // $scope.evento.auxtagbutton1 = false;
        // $scope.evento.auxtag1 = '';
        $scope.dataescolhida = {}
        $scope.dataescolhida.dia = $scope.diaescolhido;
        $scope.dataescolhida.horarioescolhido = $scope.evento.horario1;
        $scope.dataescolhida.semana = $scope.diaescolhido;
        formDataEscolhida.updateForm($scope.dataescolhida);
        console.log($scope.dataescolhida);
        if($scope.dataescolhida){
          $state.go('tabsController.CriaEventoViaComercio');
        }
        
    }
    $scope.tiratag2 = function(){
        $scope.dataescolhida = {}
        $scope.dataescolhida.dia = $scope.diaescolhido;
        $scope.dataescolhida.horarioescolhido = $scope.evento.horario2;
        formDataEscolhida.updateForm($scope.dataescolhida);
        if($scope.dataescolhida){
          $state.go('tabsController.CriaEventoViaComercio');
        }
        // $scope.evento.auxtagbutton2 = false;
        // $scope.evento.auxtag2 = '';
    }
    $scope.tiratag3 = function(){
      $scope.dataescolhida = {}
        $scope.dataescolhida.dia = $scope.diaescolhido;
        $scope.dataescolhida.horarioescolhido = $scope.evento.horario3;
        formDataEscolhida.updateForm($scope.dataescolhida);
        if($scope.dataescolhida){
          $state.go('tabsController.CriaEventoViaComercio');
        }
        // $scope.evento.auxtagbutton3 = false;
        // $scope.evento.auxtag3 = '';
    }
    $scope.tiratag4 = function(){
      $scope.dataescolhida = {}
        $scope.dataescolhida.dia = $scope.diaescolhido;
        $scope.dataescolhida.horarioescolhido = $scope.evento.horario4;
        formDataEscolhida.updateForm($scope.dataescolhida);
        if($scope.dataescolhida){
          $state.go('tabsController.CriaEventoViaComercio');
        }
        // $scope.evento.auxtagbutton4 = false;
        // $scope.evento.auxtag4 = '';
    }
    $scope.tiratag5 = function(){
      $scope.dataescolhida = {}
        $scope.dataescolhida.dia = $scope.diaescolhido;
        $scope.dataescolhida.horarioescolhido = $scope.evento.horario5;
        formDataEscolhida.updateForm($scope.dataescolhida);
        if($scope.dataescolhida){
          $state.go('tabsController.CriaEventoViaComercio');
        }
        // $scope.evento.auxtagbutton5 = false;
        // $scope.evento.auxtag5 = '';
    }
    $scope.tiratag6 = function(){
      $scope.dataescolhida = {}
        $scope.dataescolhida.dia = $scope.diaescolhido;
        $scope.dataescolhida.horarioescolhido = $scope.evento.horario6;
        formDataEscolhida.updateForm($scope.dataescolhida);
        if($scope.dataescolhida){
          $state.go('tabsController.CriaEventoViaComercio');
        }
        // $scope.evento.auxtagbutton6 = false;
        // $scope.evento.auxtag6 = '';
    }
    $scope.tiratag7 = function(){
      $scope.dataescolhida = {}
        $scope.dataescolhida.dia = $scope.diaescolhido;
        $scope.dataescolhida.horarioescolhido = $scope.evento.horario7;
        formDataEscolhida.updateForm($scope.dataescolhida);
        if($scope.dataescolhida){
          $state.go('tabsController.CriaEventoViaComercio');
        }
        // $scope.evento.auxtagbutton7 = false;
        // $scope.evento.auxtag7 = '';
    }
    $scope.tiratag8 = function(){
      $scope.dataescolhida = {}
        $scope.dataescolhida.dia = $scope.diaescolhido;
        $scope.dataescolhida.horarioescolhido = $scope.evento.horario8;
        formDataEscolhida.updateForm($scope.dataescolhida);
        if($scope.dataescolhida){
          $state.go('tabsController.CriaEventoViaComercio');
        }
        // $scope.evento.auxtagbutton8 = false;
        // $scope.evento.auxtag8 = '';
    }
    $scope.tiratag9 = function(){
        // $scope.evento.auxtagbutton1 = false;
        // $scope.evento.auxtag1 = '';
        $scope.dataescolhida = {}
        $scope.dataescolhida.dia = $scope.diaescolhido;
        $scope.dataescolhida.horarioescolhido = $scope.evento.horario9;
        $scope.dataescolhida.semana = $scope.diaescolhido;
        formDataEscolhida.updateForm($scope.dataescolhida);
        console.log($scope.dataescolhida);
        if($scope.dataescolhida){
          $state.go('tabsController.CriaEventoViaComercio');
        }
        
    }
    $scope.tiratag10 = function(){
        // $scope.evento.auxtagbutton1 = false;
        // $scope.evento.auxtag1 = '';
        $scope.dataescolhida = {}
        $scope.dataescolhida.dia = $scope.diaescolhido;
        $scope.dataescolhida.horarioescolhido = $scope.evento.horario10;
        $scope.dataescolhida.semana = $scope.diaescolhido;
        formDataEscolhida.updateForm($scope.dataescolhida);
        console.log($scope.dataescolhida);
        if($scope.dataescolhida){
          $state.go('tabsController.CriaEventoViaComercio');
        }
        
    }
    $scope.tiratag11 = function(){
        // $scope.evento.auxtagbutton1 = false;
        // $scope.evento.auxtag1 = '';
        $scope.dataescolhida = {}
        $scope.dataescolhida.dia = $scope.diaescolhido;
        $scope.dataescolhida.horarioescolhido = $scope.evento.horario11;
        $scope.dataescolhida.semana = $scope.diaescolhido;
        formDataEscolhida.updateForm($scope.dataescolhida);
        console.log($scope.dataescolhida);
        if($scope.dataescolhida){
          $state.go('tabsController.CriaEventoViaComercio');
        }
        
    }
    $scope.tiratag12 = function(){
        // $scope.evento.auxtagbutton1 = false;
        // $scope.evento.auxtag1 = '';
        $scope.dataescolhida = {}
        $scope.dataescolhida.dia = $scope.diaescolhido;
        $scope.dataescolhida.horarioescolhido = $scope.evento.horario12;
        $scope.dataescolhida.semana = $scope.diaescolhido;
        formDataEscolhida.updateForm($scope.dataescolhida);
        console.log($scope.dataescolhida);
        if($scope.dataescolhida){
          $state.go('tabsController.CriaEventoViaComercio');
        }
        
    }
    $scope.tiratag13 = function(){
        // $scope.evento.auxtagbutton1 = false;
        // $scope.evento.auxtag1 = '';
        $scope.dataescolhida = {}
        $scope.dataescolhida.dia = $scope.diaescolhido;
        $scope.dataescolhida.horarioescolhido = $scope.evento.horario13;
        $scope.dataescolhida.semana = $scope.diaescolhido;
        formDataEscolhida.updateForm($scope.dataescolhida);
        console.log($scope.dataescolhida);
        if($scope.dataescolhida){
          $state.go('tabsController.CriaEventoViaComercio');
        }
        
    }
    $scope.tiratag14 = function(){
        // $scope.evento.auxtagbutton1 = false;
        // $scope.evento.auxtag1 = '';
        $scope.dataescolhida = {}
        $scope.dataescolhida.dia = $scope.diaescolhido;
        $scope.dataescolhida.horarioescolhido = $scope.evento.horario14;
        $scope.dataescolhida.semana = $scope.diaescolhido;
        formDataEscolhida.updateForm($scope.dataescolhida);
        console.log($scope.dataescolhida);
        if($scope.dataescolhida){
          $state.go('tabsController.CriaEventoViaComercio');
        }
        
    }
    $scope.tiratag15 = function(){
        // $scope.evento.auxtagbutton1 = false;
        // $scope.evento.auxtag1 = '';
        $scope.dataescolhida = {}
        $scope.dataescolhida.dia = $scope.diaescolhido;
        $scope.dataescolhida.horarioescolhido = $scope.evento.horario15;
        $scope.dataescolhida.semana = $scope.diaescolhido;
        formDataEscolhida.updateForm($scope.dataescolhida);
        console.log($scope.dataescolhida);
        if($scope.dataescolhida){
          $state.go('tabsController.CriaEventoViaComercio');
        }
        
    }
    $scope.tiratag16 = function(){
        // $scope.evento.auxtagbutton1 = false;
        // $scope.evento.auxtag1 = '';
        $scope.dataescolhida = {}
        $scope.dataescolhida.dia = $scope.diaescolhido;
        $scope.dataescolhida.horarioescolhido = $scope.evento.horario16;
        $scope.dataescolhida.semana = $scope.diaescolhido;
        formDataEscolhida.updateForm($scope.dataescolhida);
        console.log($scope.dataescolhida);
        if($scope.dataescolhida){
          $state.go('tabsController.CriaEventoViaComercio');
        }
        
    }
    $scope.tiratag17 = function(){
        // $scope.evento.auxtagbutton1 = false;
        // $scope.evento.auxtag1 = '';
        $scope.dataescolhida = {}
        $scope.dataescolhida.dia = $scope.diaescolhido;
        $scope.dataescolhida.horarioescolhido = $scope.evento.horario17;
        $scope.dataescolhida.semana = $scope.diaescolhido;
        formDataEscolhida.updateForm($scope.dataescolhida);
        console.log($scope.dataescolhida);
        if($scope.dataescolhida){
          $state.go('tabsController.CriaEventoViaComercio');
        }
        
    }
    $scope.tiratag18 = function(){
        // $scope.evento.auxtagbutton1 = false;
        // $scope.evento.auxtag1 = '';
        $scope.dataescolhida = {}
        $scope.dataescolhida.dia = $scope.diaescolhido;
        $scope.dataescolhida.horarioescolhido = $scope.evento.horario18;
        $scope.dataescolhida.semana = $scope.diaescolhido;
        formDataEscolhida.updateForm($scope.dataescolhida);
        console.log($scope.dataescolhida);
        if($scope.dataescolhida){
          $state.go('tabsController.CriaEventoViaComercio');
        }
        
    }
    $scope.tiratag19 = function(){
        // $scope.evento.auxtagbutton1 = false;
        // $scope.evento.auxtag1 = '';
        $scope.dataescolhida = {}
        $scope.dataescolhida.dia = $scope.diaescolhido;
        $scope.dataescolhida.horarioescolhido = $scope.evento.horario19;
        $scope.dataescolhida.semana = $scope.diaescolhido;
        formDataEscolhida.updateForm($scope.dataescolhida);
        console.log($scope.dataescolhida);
        if($scope.dataescolhida){
          $state.go('tabsController.CriaEventoViaComercio');
        }
        
    }
    $scope.tiratag20 = function(){
        // $scope.evento.auxtagbutton1 = false;
        // $scope.evento.auxtag1 = '';
        $scope.dataescolhida = {}
        $scope.dataescolhida.dia = $scope.diaescolhido;
        $scope.dataescolhida.horarioescolhido = $scope.evento.horario20;
        $scope.dataescolhida.semana = $scope.diaescolhido;
        formDataEscolhida.updateForm($scope.dataescolhida);
        console.log($scope.dataescolhida);
        if($scope.dataescolhida){
          $state.go('tabsController.CriaEventoViaComercio');
        }
        
    }
    $scope.tiratag21 = function(){
        // $scope.evento.auxtagbutton1 = false;
        // $scope.evento.auxtag1 = '';
        $scope.dataescolhida = {}
        $scope.dataescolhida.dia = $scope.diaescolhido;
        $scope.dataescolhida.horarioescolhido = $scope.evento.horario21;
        $scope.dataescolhida.semana = $scope.diaescolhido;
        formDataEscolhida.updateForm($scope.dataescolhida);
        console.log($scope.dataescolhida);
        if($scope.dataescolhida){
          $state.go('tabsController.CriaEventoViaComercio');
        }
        
    }
    $scope.tiratag22= function(){
        // $scope.evento.auxtagbutton1 = false;
        // $scope.evento.auxtag1 = '';
        $scope.dataescolhida = {}
        $scope.dataescolhida.dia = $scope.diaescolhido;
        $scope.dataescolhida.horarioescolhido = $scope.evento.horario22;
        $scope.dataescolhida.semana = $scope.diaescolhido;
        formDataEscolhida.updateForm($scope.dataescolhida);
        console.log($scope.dataescolhida);
        if($scope.dataescolhida){
          $state.go('tabsController.CriaEventoViaComercio');
        }
        
    }
    $scope.tiratag23 = function(){
        // $scope.evento.auxtagbutton1 = false;
        // $scope.evento.auxtag1 = '';
        $scope.dataescolhida = {}
        $scope.dataescolhida.dia = $scope.diaescolhido;
        $scope.dataescolhida.horarioescolhido = $scope.evento.horario23;
        $scope.dataescolhida.semana = $scope.diaescolhido;
        formDataEscolhida.updateForm($scope.dataescolhida);
        console.log($scope.dataescolhida);
        if($scope.dataescolhida){
          $state.go('tabsController.CriaEventoViaComercio');
        }
        
    }
    $scope.tiratag24 = function(){
        // $scope.evento.auxtagbutton1 = false;
        // $scope.evento.auxtag1 = '';
        $scope.dataescolhida = {}
        $scope.dataescolhida.dia = $scope.diaescolhido;
        $scope.dataescolhida.horarioescolhido = $scope.evento.horario24;
        $scope.dataescolhida.semana = $scope.diaescolhido;
        formDataEscolhida.updateForm($scope.dataescolhida);
        console.log($scope.dataescolhida);
        if($scope.dataescolhida){
          $state.go('tabsController.CriaEventoViaComercio');
        }
        
    }
    // $scope.tiratag9 = function(){
    //     // $scope.evento.auxtagbutton9 = false;
    //     // $scope.evento.auxtag9 = '';
    // }
    $scope.loadInfos = function() {
      $scope.eventosdata = false;
      $scope.escolhahorario = false;
      $scope.eventoscomercio = false;
      $scope.infos = true;
      $scope.vazio = false;
      //$scope.comercio.infocomercio.replace(/\n/g, "<br />");
      //console.log($scope.comercio.precopor,"$scope.comercio.precopor")
      //$scope.comercio.infocomercio = nl2br(htmlentities($scope.comercio.infocomercio, ENT_QUOTES, 'UTF-8'));
      // document.getElementById("loadEventos").className = "btncomerciotab";
      // document.getElementById("loadHorarios").className = "btncomerciotab";
      // document.getElementById("loadInfos").className = "btncomerciotab actcomerciotab";
      //console.log($scope.comercio.infocomercio);
      if($scope.comercio.preco == '0' || $scope.comercio.preco =="Gratuito"){
        $scope.comercio.preco = "Gratuito";
        $scope.porpessoa = false;
        $scope.porlocal = false;
      }else{
        if($scope.comercio.precopor == '1'){
          $scope.porpessoa = true;
          $scope.porlocal = false;
        }else{
          $scope.porpessoa = false;
          $scope.porlocal = true;
        }
      }
      console.log("$scope.comercio.horariofuncionamento",$scope.comercio.horariofuncionamento)
      if(!$scope.comercio.horariofuncionamento){
        document.getElementById("loadEventos").className = "btncomerciotab";
      //document.getElementById("loadHorarios").className = "btncomerciotab";
        document.getElementById("loadInfos").className = "btncomerciotab actcomerciotab";
        console.log("$scope.comercio.horariofuncionamento",$scope.comercio.horariofuncionamento)
        $scope.naotemhorario = true;
      }else{
        document.getElementById("loadEventos").className = "btncomerciotab";
        document.getElementById("loadHorarios").className = "btncomerciotab";
        document.getElementById("loadInfos").className = "btncomerciotab actcomerciotab";
      }
      if($scope.comercio.oqtem){
        $scope.auxsemanabutton1 = true;
        $scope.auxsemanabutton2 = true;
        $scope.auxsemanabutton3 = true;
        $scope.auxsemanabutton4 = true;
        $scope.auxsemanabutton5 = true;
        $scope.auxsemanabutton6 = true;
        $scope.auxsemanabutton7 = true;
        var res2 = $scope.comercio.oqtem.split(" ") ;
        if(res2.length>1){
          for(var w = 0; w < res2.length; w++){
            if(res2[w] == 'Arcondicionado'){
              $scope.auxsemanabutton1 = false;
              $scope.auxsemanabutton1aux = true;
            }
            if(res2[w] == 'Areadefumante'){
              $scope.auxsemanabutton2 = false;
              $scope.auxsemanabutton2aux = true;
            }
            if(res2[w] == 'Estacionamento'){
              $scope.auxsemanabutton3 = false;
              $scope.auxsemanabutton3aux = true;
            }
            if(res2[w] == 'Pets'){
              $scope.auxsemanabutton4 = false;
              $scope.auxsemanabutton4aux = true;
            }
            if(res2[w] == 'PNE'){
              $scope.auxsemanabutton5 = false;
              $scope.auxsemanabutton5aux = true;
            }
            if(res2[w] == 'Wifi'){
              $scope.auxsemanabutton6 = false;
              $scope.auxsemanabutton6aux = true;
            }
          }
        }
      }else{
        $scope.auxsemanabutton1aux = false;
        $scope.auxsemanabutton2aux = false;
        $scope.auxsemanabutton3aux = false;
        $scope.auxsemanabutton4aux = false;
        $scope.auxsemanabutton5aux = false;
        $scope.auxsemanabutton6aux = false;
        $scope.auxsemanabutton7aux = false;
        $scope.auxsemanabutton1 = true;
        $scope.auxsemanabutton2 = true;
        $scope.auxsemanabutton3 = true;
        $scope.auxsemanabutton4 = true;
        $scope.auxsemanabutton5 = true;
        $scope.auxsemanabutton6 = true;
        $scope.auxsemanabutton7 = true;
      }
      $scope.eventoshorario = false;
      
    }
    $scope.Vermapa = function(){
      $state.go('tabsController.ver_onde_mapa_Comercio');
    }
   
  $scope.enterEvento =  function(item){
    formItem.updateForm(item);
    $state.go('tabsController.Eventocomercio');
  }
    
}])

.controller('EventocomercioCtrl', ['$scope', '$stateParams', 'formItem', 'formUser', 'formtelaCriar', 'formOutro', '$http', '$timeout','$ionicPopup', 'EventoService', '$state','$cordovaSocialSharing', 'formvimdofiltro', 'formEventoEditahome','formvimdofiltroperfil', 'formLimiteatuacao','formvimdopost',// The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, formItem, formUser, formtelaCriar, formOutro, $http, $timeout, $ionicPopup, EventoService, $state, $cordovaSocialSharing, formvimdofiltro, formEventoEditahome, formvimdofiltroperfil, formLimiteatuacao, formvimdopost) {

  $scope.evento = formItem.getForm();
  $scope.aux = formUser.getForm();
  formvimdopost.updateForm(false);
  $scope.tag = '';
  $scope.nuser = 0;
  $scope.convidar = false;
  var datainvalida = 0;

  $scope.borala = true;
  $scope.aviso =false;
  $scope.desistir = false;
  $scope.reserva = false;
  $scope.chathome = false;
  $scope.pinza = false;
  $scope.despinza = false;
  $scope.data = {};
  $scope.auxdata ={};
  $scope.limiteconfirmacao ={};
  $scope.fim = {};
  $scope.dia = {};
  $scope.pushnoti ={};
  $scope.limiteatuacao = formLimiteatuacao.getForm();

  var hj = $scope.evento.diainicio;
  var ano = (hj[0]+hj[1]+hj[2]+hj[3]).valueOf();
  var mes = (hj[5]+hj[6]).valueOf();
  var dia = (hj[8]+hj[9]).valueOf();

  var h = (hj[11]+hj[12]).valueOf();
  var m = (hj[14]+hj[15]).valueOf();

  var vdf = formvimdofiltro.getForm();
  $scope.vimdofiltroEA =false;
  if(vdf){
    $scope.vimdofiltroEA = vdf;
  }

  var currentdate = new Date(); 
  var curr_date = (currentdate.getDate()<10?'0':'') + currentdate.getDate();
  var curr_month = (currentdate.getMonth()<10?'0':'') + (currentdate.getMonth() + 1); 
  var curr_year = currentdate.getFullYear();
  var h2 = (currentdate.getHours()<10?'0':'') + currentdate.getHours();
  var m2 = (currentdate.getMinutes()<10?'0':'') + currentdate.getMinutes();
    

  var hjd = $scope.evento.duracao;
  var hd = (hjd[0]+hjd[1]).valueOf();
  var md = (hjd[3]+hjd[4]).valueOf();
  $scope.duracao = hd+':'+md;

  var  hjl = $scope.evento.dialimiteconfirmacao;
  $scope.limiteconfirmacao.dia =  (hjl[8]+hjl[9]).valueOf()+'/'+(hjl[5]+hjl[6]).valueOf();
  $scope.limiteconfirmacao.hora =  (hjl[11]+hjl[12]).valueOf()+':'+(hjl[14]+hjl[15]).valueOf();  
  
  

  var hjf = $scope.evento.diafim;
  $scope.fim.dia =  (hjf[8]+hjf[9]).valueOf()+'/'+(hjf[5]+hjf[6]).valueOf()+'/'+(hjf[0]+hjf[1]+hjf[2]+hjf[3]);
  $scope.fim.hora = (hjf[11]+hjf[12]).valueOf()+':'+(hjf[14]+hjf[15]).valueOf();
  $scope.dia.dia = dia+'/'+mes;
  $scope.dia.hora = h+':'+m +' - '+(hjf[11]+hjf[12]).valueOf()+':'+(hjf[14]+hjf[15]).valueOf() ;

  if($scope.limiteconfirmacao.dia == $scope.dia.dia){
    $scope.limsemana = $scope.evento.semana;
  }else{
    if($scope.evento.semana == "Segunda-feira"){
      $scope.limsemana = "Domingo";
    }
    if($scope.evento.semana == "Terça-feira"){
      $scope.limsemana = "Segunda-feira";
    }
    if($scope.evento.semana == "Quarta-feira"){
      $scope.limsemana = "Terça-feira";
    }
    if($scope.evento.semana == "Quinta-feira"){
      $scope.limsemana = "Quarta-feira";
    }
    if($scope.evento.semana == "Sexta-feira"){
      $scope.limsemana = "Quinta-feira";
    }
    if($scope.evento.semana == "Sábado"){
      $scope.limsemana = "Sexta-feira";
    }
    if($scope.evento.semana == "Domingo"){
      $scope.limsemana = "Sábado";
    }
  }
  var zone;
  var meuestado;
  var noti = {};
  var confirm = $scope.aux.iduser;

  var ano5 = (hjl[0]+hjl[1]+hjl[2]+hjl[3]).valueOf()-curr_year;
  var mes5 = (hjl[5]+hjl[6]).valueOf()-curr_month;
  var dia5 = (hjl[8]+hjl[9]).valueOf()-curr_date;
  var h5 = (hjl[11]+hjl[12]).valueOf()-h2;
  var m5 = (hjl[14]+hjl[15]).valueOf()-m2;

  
  console.log(ano5, mes5, dia5,h5, m5 , 'COMOMO?')
  if(ano5 == 0 && mes5 == 0 && dia5 == 0 && ((h5 == 1 && m5<30 && m5>0)||(h5==0 && m5 > 30)|| (h5==1 && m5>-30))){
    console.log('YELLOWZONE');
    zone = 'yellow';
    $scope.confirmaPessoa =true;
  }
  if(ano5<0 || mes5 < 0 ||(ano5 == 0 && mes5 == 0 && (dia5 < 0 || (dia5==0 && ((h5 == 0 && m5<=0)||(h5 < 0)) )))){
    console.log('REDZONE');
    $scope.borala = false;
    $scope.aviso =true;
    zone = 'red';
    $scope.confirmaPessoa =false;
    $scope.deletarPessoa = false;
    $scope.edita = false;
  }else{
    $scope.borala = true;
    $scope.aviso =false;
  }

  if($scope.evento.adm ==  $scope.aux.iduser){
    $scope.deletarPessoa = true;
    $scope.confirmaPessoa =true;
    if(zone == 'red'){
      $scope.edita = false;
      $scope.deletarPessoa = false;
    }else{
      $scope.edita = true;
    }
  }
  console.log("numeor", $scope.evento.pmin, $scope.evento.patual , $scope.evento.pmax)
  
    if(parseInt($scope.evento.pmin)>parseInt($scope.evento.patual)){
      $scope.menorqpmin = true;
      $scope.nopmin = false;
      $scope.entre = false;
      $scope.cheio = false;
    }
    if(parseInt($scope.evento.pmin)==parseInt($scope.evento.patual)){
      $scope.menorqpmin = false;
      $scope.nopmin = true;
      $scope.entre = false;
      $scope.cheio = false;
    }

    if(parseInt($scope.evento.pmin)<parseInt($scope.evento.patual) && parseInt($scope.evento.pmax)>parseInt($scope.evento.patual)){
      $scope.menorqpmin = false;
      $scope.nopmin = false;
      $scope.entre = true;
      $scope.cheio = false;
      console.log("nao cheio")
    }
    if(parseInt($scope.evento.pmin)<parseInt($scope.evento.patual) && parseInt($scope.evento.pmax)<=parseInt($scope.evento.patual)){
      $scope.menorqpmin = false;
      $scope.nopmin = false;
      $scope.entre = false;
      $scope.cheio = true;
      console.log(" cheio", $scope.evento.pmin.valueOf() , $scope.evento.patual.valueOf(), $scope.evento.pmax.valueOf())
    }
     
    // $scope.auxfoto = $scope.evento.nomeevento + $scope.evento.diainicio;
    // var mystring = String($scope.auxfoto);
    // mystring = mystring.replace(/[^a-zA-Z0-9]/g, '');
    // $scope.evento.eventopic = 'https://s3.amazonaws.com/diwoappprofilepics/eventopicsdiwo/' + mystring + '.jpg';
  

  console.log($scope.evento.patual , $scope.evento.pmin)
  if(parseInt($scope.evento.patual) < parseInt($scope.evento.pmin) && zone == 'red'){
    console.log('Evento não acontece por falta de pessoas')
  }
  if(parseInt($scope.evento.patual) < parseInt($scope.evento.pmin) && zone == 'yellow'){
    console.log('Evento esta com poucas pessoas, talvez ele nao aconteça')
  }
  
  if($scope.evento.preco == 0 || $scope.evento.preco =="Gratuito"){
      $scope.evento.preco = "Gratuito";
      $scope.porpessoa = false;
      $scope.porlocal = false;
    }else{
      if($scope.evento.precopor == 1){
        $scope.porpessoa = true;
        $scope.porlocal = false;
      }else{
        $scope.porpessoa = false;
        $scope.porlocal = true;
      }
    }

  if($scope.evento.genero == "masc"){
      $scope.masc = true;
      $scope.fem = false;
  }
  if($scope.evento.genero == "fem"){
      $scope.fem = true;
      $scope.masc = false;
  }
  if($scope.evento.genero == "todos"){
      $scope.fem = false;
      $scope.masc = false;
  }

  $scope.helppp = {};
  $scope.helppp.idevento = $scope.evento.idevento;
  $scope.helppp.iduser = $scope.aux.iduser
  EventoService.VerificaPossoConvidar($scope.helppp).then(function(convi) {
    $scope.convidar = convi.success;
  });

   if($scope.evento.tipodeevento){
      console.log("patrocinadoffff")
      $scope.evento.patrocinado = true;
      //$scope.evento.styleItem = "background-color: #212121;color: white;box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.3);border: 4px dotted #ffdb29;";
      //$scope.evento.styleItem = "background-color: #212121;color: white;box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.3);border: 4px dotted #ff9008;";
      $scope.evento.styleItem = "background-color: #212121;color: white;box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.3);outline: 7px dotted #ff4c42;outline-offset: -4px;";
      //$scope.evento.styleItem = "background-color: #212121;color: white;box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.3);border: 4px dotted #f9bdff;";
      //$scope.evento.styleItem = "background-color: #212121;color: white;box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.3);border: 4px dotted #00FFFF;";

      document.getElementById("Eventocomercio").style.backgroundImage = "url('img/background_patrocinado.jpg')"
    }else{
      $scope.evento.styleItem = "background-color: #212121;color: white;box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.3);"
      $scope.evento.patrocinado = false;
      document.getElementById("Eventocomercio").style.backgroundColor = "#212121"
    }


  $scope.$on("$ionicView.enter", function(event, data){

    $scope.tag = '';
    $scope.items = [];
    $scope.pinza = false;
    $scope.despinza = false;
    $scope.evento = formItem.getForm();
    $scope.aux = formUser.getForm();
    datainvalida = 0;
    formvimdopost.updateForm(false);
    $scope.menorqpmin = false;
    $scope.nopmin = false;
    $scope.entre = false;
    $scope.cheio = false;

    $scope.convidar = false;
    $scope.limiteatuacao = formLimiteatuacao.getForm();
    $scope.auxdata ={};
    $scope.pushnoti = {};
    var hjd = $scope.evento.duracao;
    var hd = (hjd[0]+hjd[1]).valueOf();
    var md = (hjd[3]+hjd[4]).valueOf();
    $scope.duracao = hd+':'+md;

    var  hjl = $scope.evento.dialimiteconfirmacao;
    $scope.limiteconfirmacao.dia =  (hjl[8]+hjl[9]).valueOf()+'/'+(hjl[5]+hjl[6]).valueOf();
    $scope.limiteconfirmacao.hora =  (hjl[11]+hjl[12]).valueOf()+':'+(hjl[14]+hjl[15]).valueOf();  
    
    

    var hjf = $scope.evento.diafim;
    $scope.fim.dia =  (hjf[8]+hjf[9]).valueOf()+'/'+(hjf[5]+hjf[6]).valueOf()+'/'+(hjf[0]+hjf[1]+hjf[2]+hjf[3]);
    $scope.fim.hora = (hjf[11]+hjf[12]).valueOf()+':'+(hjf[14]+hjf[15]).valueOf();
    $scope.dia.dia = dia+'/'+mes;
    $scope.dia.hora = h+':'+m +' - '+(hjf[11]+hjf[12]).valueOf()+':'+(hjf[14]+hjf[15]).valueOf() ;

            // Ve se eu tenho ou não interesse nesse evento
    $scope.auxpinza ={};
    $scope.auxpinza.iduser = $scope.aux.iduser;
    $scope.auxpinza.idevento = $scope.evento.idevento;
    var vdf = formvimdofiltro.getForm();
    $scope.vimdofiltroEA =false;
    if(vdf){
      $scope.vimdofiltroEA = vdf;
    }
    if(parseInt($scope.evento.pmin)>parseInt($scope.evento.patual)){
      $scope.menorqpmin = true;
      $scope.nopmin = false;
      $scope.entre = false;
      $scope.cheio = false;
    }
    if(parseInt($scope.evento.pmin)==parseInt($scope.evento.patual)){
      $scope.menorqpmin = false;
      $scope.nopmin = true;
      $scope.entre = false;
      $scope.cheio = false;
    }

    if(parseInt($scope.evento.pmin)<parseInt($scope.evento.patual) && parseInt($scope.evento.pmax)>parseInt($scope.evento.patual)){
      $scope.menorqpmin = false;
      $scope.nopmin = false;
      $scope.entre = true;
      $scope.cheio = false;
      console.log("nao cheio")
    }
    if(parseInt($scope.evento.pmin)<parseInt($scope.evento.patual) && parseInt($scope.evento.pmax)<=parseInt($scope.evento.patual)){
      $scope.menorqpmin = false;
      $scope.nopmin = false;
      $scope.entre = false;
      $scope.cheio = true;
      console.log(" cheio", $scope.evento.pmin.valueOf() , $scope.evento.patual.valueOf(), $scope.evento.pmax.valueOf())
    }
    if($scope.evento.tipodeevento){
      //console.log("patrocinadoffff")
      $scope.evento.patrocinado = true;
      //$scope.evento.styleItem = "background-color: #212121;color: white;box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.3);border: 4px dotted #ffdb29;";
      //$scope.evento.styleItem = "background-color: #212121;color: white;box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.3);border: 4px dotted #ff9008;";
      $scope.evento.styleItem = "background-color: #212121;color: white;box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.3);outline: 7px dotted #ff4c42;outline-offset: -4px;";
      //$scope.evento.styleItem = "background-color: #212121;color: white;box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.3);border: 4px dotted #f9bdff;";
      //$scope.evento.styleItem = "background-color: #212121;color: white;box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.3);border: 4px dotted #00FFFF;";

      document.getElementById("Eventocomercio").style.backgroundImage = "url('img/background_patrocinado.jpg')"
    }else{
      $scope.evento.styleItem = "background-color: #212121;color: white;box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.3);"
      $scope.evento.patrocinado = false;
      document.getElementById("Eventocomercio").style.backgroundColor = "#212121"
    }

    if($scope.evento.preco == 0 || $scope.evento.preco =="Gratuito"){
      $scope.evento.preco = "Gratuito";
      $scope.porpessoa = false;
      $scope.porlocal = false;
    }else{
      if($scope.evento.precopor == 1){
        $scope.porpessoa = true;
        $scope.porlocal = false;
      }else{
        $scope.porpessoa = false;
        $scope.porlocal = true;
      }
    }

    $scope.helppp = {};
    $scope.helppp.idevento = $scope.evento.idevento;
    $scope.helppp.iduser = $scope.aux.iduser
    EventoService.VerificaPossoConvidar($scope.helppp).then(function(convi) {
      $scope.convidar = convi;
    });

    EventoService.verificahorariopessoaeventoconfirmados($scope.aux).then(function(items) {
      $scope.auxdata = items;
      for(var r = 0;r<$scope.auxdata.length; r++){
        //console.log($scope.auxdata[r].idevento, $scope.auxdata[r].diainicio, $scope.auxdata[r].diafim , we ,$scope.evento.diafim);
        if($scope.evento.idevento!=$scope.auxdata[r].idevento){
          if (($scope.auxdata[r].diainicio < $scope.evento.diainicio && $scope.auxdata[r].diafim > $scope.evento.diainicio) || ($scope.auxdata[r].diainicio<$scope.evento.diafim && $scope.auxdata[r].diafim>$scope.evento.diafim) ||($scope.auxdata[r].diainicio > $scope.evento.diainicio && $scope.auxdata[r].diafim<$scope.evento.diafim) || ($scope.auxdata[r].diainicio < $scope.evento.diainicio && $scope.auxdata[r].diafim>$scope.evento.diafim) ) {
            console.log('horario invalido');
            datainvalida = 1;
          }
        }
      }
    });

    if($scope.aux.iduser != $scope.evento.adm){
       $scope.edita = false;
       console.log($scope.auxpinza.iduser , $scope.auxpinza.idevento)
      EventoService.Getpinza($scope.auxpinza).then(function(items) {
        //alert(items.success)
        console.log(items.success,"qeqew" )
        if(items.success != false){
          if (items[0].estado == 7) {
            $scope.pinza = false;
            $scope.despinza = true;
            console.log('eh favorito')
          }
        }else{
          console.log('N eh')
          $scope.pinza = true;
          $scope.despinza = false;
        } 
      });
    }else{
       if(zone == 'red'){
          $scope.edita = false;
        }else{
          $scope.edita = true;
        }
      $scope.pinza = false;
      $scope.despinza = false;
    }
    
            //Pega tags do evento
    EventoService.Gettags($scope.evento.idevento).then(function(tags) {
      console.log(tags, "tags")
      if(tags!='E' && tags!='Error'){
        for(var  i =0; i< tags.length;i++){
          $scope.tag = ($scope.tag + ' ' + tags[i].tag);
        } 
      }
      
      console.log($scope.tag,"dasd")
    });
            //Capacidade do evento
    if(parseInt($scope.evento.pmax) <= parseInt($scope.evento.patual)){
        console.log('Evento cheio');
        $scope.borala = false;
        $scope.reserva = true;
    }
    console.log($scope.evento.idevento, "bug")
    EventoService.GetParticipantes($scope.evento.idevento).then(function(parti) {
      console.log(parti.length , "parti.length");
      $scope.nomeevento = parti[0].nomeevento;
      console.log($scope.nomeevento, "bug dentro")
      for (var i = 0; i < parti.length; i++) {
        if ($scope.aux.iduser == parti[i].iduser && parti[i].estado!=7 && parti[i].estado!=8) {
          $scope.nuser++;
          $scope.borala = false;
          $scope.reserva = false;
          $scope.desistir = true;
          $scope.chathome = true;
        }
        if ($scope.aux.iduser == parti[i].iduser) {
          meuestado = parti[i].estado;
        }
        if ($scope.aux.iduser == parti[i].iduser && parti[i].estado == 7) {
          $scope.pinza = false;
          $scope.despinza = true;
        }
        if ($scope.aux.iduser == parti[i].iduser && parti[i].estado == 8) {
          $scope.reserva = false;
          var alertPopup = $ionicPopup.alert({
                          title: 'ლ(*꒪ヮ꒪*)ლ',
                          template: 'Tais na fila da reserva, se vagar t avisaremos'
          });
          console.log('reservado');
        }            
      }


    });
    console.log($scope.evento.idevento, "bug")
    EventoService.GetParticipantesSemFav($scope.evento.idevento).then(function(items) {
      console.log(items[0].iduser, "bug dentro")
      for (var i = 0; i < items.length; i++) {
        if (items[i].estado == 0) {
          items[i].confirmacao = 'Sou o organizador';
          $scope.criador = items[i].iduser;
        }
        if (items[i].estado == 1) {
          items[i].confirmacao = 'Aguardando confirmação';
        }
        if (items[i].estado == 2) {
          items[i].confirmacao = 'Confirmado';
        }
        if(items[i].borda == 0){
            items[i].bb = false;
            items[i].bs = false;
            items[i].bg = false;
          }
          if(items[i].borda == 1){
            items[i].bb = true;
            items[i].bs = false;
            items[i].bg = false;
          }
          if(items[i].borda == 2){
            items[i].bb = false;
            items[i].bs = true;
            items[i].bg = false;
          }
          if(items[i].borda == 3){
            items[i].bb = false;
            items[i].bs = false;
            items[i].bg = true;
          }
           if((items[i].profilepic[8] == 's' && items[i].profilepic[9] == '3')||(items[i].profilepic[8] == 'd' && items[i].profilepic[9] == 'i')){
          
             items[i].profilepic=items[i].profilepic+"?{{getTimeStamp()}}";
           }else{
             items[i].profilepic=items[i].profilepic;
           }

      }
      $scope.items = items;
     
      
    });
  });
    //  $scope.share = function() {
    //         $cordovaSocialSharing.canShareVia("twitter", 'Oii', '', 'http://diwoapp.com.br/politica-de-privacidade/').then(function(result) {
    //             $cordovaSocialSharing.shareViaTwitter('Oii', '', 'http://diwoapp.com.br/politica-de-privacidade/');
    //         }, function(error) {
    //             alert("Cannot share on Twitter");
    //         }); device.platform == "Android" ? "https://play.google.com/store/apps/details?id=com.ionicframework.invitta391892" : "ITUNES_URL
    //     }
    //$scope.linkevento ='';
    $scope.share = function(t, msg, img, link){ 
      $scope.msgshare = "Olha o que achei: " + $scope.evento.nomeevento + ' dia ' +dia+'/'+mes + ' bora?';
      $scope.linkevento = "https://ec2.diwoapp.com.br/pageteste.html?idevento="+$scope.evento.idevento;
       console.log($scope.msgshare)
        if(t == 'w')
          $cordovaSocialSharing.canShareVia('whatsapp', $scope.msgshare, '', 'http://diwoapp.com.br/politica-de-privacidade/').then(function(result) {
            $cordovaSocialSharing.shareViaWhatsApp($scope.msgshare, '' , $scope.linkevento) ;
            }, function(error) {
                alert("Cannot share on whatsapp");
            });
        else if(t == 'f')
          $cordovaSocialSharing.canShareVia('facebook', $scope.msgshare, '', 'http://diwoapp.com.br/politica-de-privacidade/').then(function(result) {
                $cordovaSocialSharing.shareViaFacebook( $scope.msgshare, '', $scope.linkevento);
            }, function(error) {
                alert("Cannot share on whatsapp");
            });
  
        else if(t == 't')
            $cordovaSocialSharing.canShareVia('twitter', $scope.msgshare, '', 'http://diwoapp.com.br/politica-de-privacidade/').then(function(result) {
                $cordovaSocialSharing.shareViaTwitter( + $scope.msgshare, '',  $scope.linkevento);
            }, function(error) {
                alert("Cannot share on whatsapp");
            }); 
    }

                      
    $scope.chamamos = function(){  
      $scope.carinha = '';
      $ionicPopup.prompt({
          title: 'Ajude um amigo',
          template: 'Ajude um amigo(a) que amaria esse evento a fazer parte dele também! Com um amigo é sempre mais seguro.Nós enviaremos um meme, poema ou áudio convidando ele(a) por você. Só precisamos do “@”, email ou telefone dela e voilá :)',
         inputType: 'text',
         inputPlaceholder: '@insta ou numero pra whats ou email'
       }).then(function(contato) {
        if(contato){
          if(contato!= ''){
            $scope.carinha = $scope.aux.iduser + " " +$scope.aux.username + " quer convidar: " + contato + " no evento id:" + $scope.evento.idevento + " nome do evento: " + $scope.evento.nomeevento;
            $http.post('https://ec2.diwoapp.com.br/pedeconvite.php', {namereportado : $scope.evento.nomeevento,
                                                                                      usernamereportando : contato,
                                                                                      tiporeport : 'Convide meu amigo',
                                                                                      motivo : $scope.carinha}).then(function (tes){
              if(tes.data.success == true){
                var alertPopup = $ionicPopup.alert({
                  title: 'Pronto!',
                  template: 'Convidaremos ele de uma das formas, obrigado!!'
                });
                alertPopup.then(function(){
                  EventoService.ConvidarPessoaevento($scope.helppp).then(function(convite) {
                    if(convite){
                      $scope.convidar = false;
                    }
                  });
                });
              }else{
                var alertPopup = $ionicPopup.alert({
                  title: 'Vish',
                  template: 'Ocorreu uma falha!!'
                });
              }
            });
          }
          console.log($scope.carinha)
        }
      }); 
    }
  

  // $scope.enterItem =  function(item){
  //   formOutro.updateForm(item);
  //   //console.log(item.iduser);
  //   formvimdofiltroperfil.updateForm(false);
  //   $state.go('tabsController.perfilOutro');
  // }

  $scope.Vermapa = function(){
    $state.go('tabsController.ver_onde_mapa_Comercio');
  }

  // $scope.editar = function(){
  //   formEventoEditahome.updateForm($scope.evento)
  //   $state.go('tabsController.EditaEEAPart1');
  //   //$state.go('tabsController.EditaEventoPart1');
  // }

  $scope.aprova = function(item){
    console.log(meuestado)
    if(meuestado == 1 || meuestado == 8 || meuestado == 7 ){
                var alertPopup = $ionicPopup.alert({
                          title: '(°ロ°)☝',
                          template: 'Ainda não foi confirmado para poder aprovar alguem'
                        });
    }else{
      if(item.estado == 1 ){
        if (item.iduser!=$scope.aux.iduser  && confirm!= item.iduser) {
                confirm = item.iduser;
                console.log(item.iduser, $scope.aux.iduser);
                $scope.msgnoti = ('Tu foi aceito no evento: ' + $scope.evento.nomeevento);
                $scope.evento.patual = parseInt($scope.evento.patual)+1;
                $http.post('https://ec2.diwoapp.com.br/addpessoaevento.php', {idevento : $scope.evento.idevento,
                                                                                patual : $scope.evento.patual});
                $http.post('https://ec2.diwoapp.com.br/atualizarpessoaevento.php' , {iduser : item.iduser,
                                                                                  idevento : $scope.evento.idevento,
                                                                                  confirmacao : 'Confirmação aceita',
                                                                                  estado :2});
                noti.recebeusername = item.username;
                noti.recebe = item.iduser;
                noti.envia = $scope.aux.iduser;
                noti.tipo = 2;
                noti.nomeevento = $scope.evento.nomeevento;
                $http.post("https://ec2.diwoapp.com.br/deletanotificacaoporids.php", {id_user_recebe : $scope.evento.adm,
                                                                              id_user_envia: item.iduser,
                                                                              nomeevento: noti.nomeevento,
                                                                              tipo : '1'});
                EventoService.VerificaNotificacao(noti).then(function(res) {
                  console.log(res);
                  if(res){
                    $http.post('https://ec2.diwoapp.com.br/notificapessoa.php', {notificacao : $scope.msgnoti, 
                                          idevento : $scope.evento.idevento,
                                          nomeevento : $scope.evento.nomeevento,
                                          id_user_envia : $scope.aux.iduser,
                                          username_envia : $scope.aux.username,
                                          apelido_envia : $scope.aux.apelido,
                                          tipo : '2',
                                          id_user_recebe : noti.recebe});
                    EventoService.getusuario2(noti.recebeusername).then(function(user) {
                      if(user.notiparticipando == '1'){
                        $scope.pushnoti.titulo =  'Boraaa!!!' ;
                        $scope.pushnoti.msg = $scope.msgnoti;
                        $scope.pushnoti.token = user.devicetoken;
                        EventoService.MandaPushNoti($scope.pushnoti);
                      }
                      
                    });
                  }
                });
                 var alertPopup = $ionicPopup.alert({
                          title: '(/^▽^)/',
                          template: 'Vamos avisa-lo que ele foi aprovado, obrigado.'
                        });
                 item.confirmacao = 'Confirmação aprovada';

              
        }else{
          if(confirm ==  item.iduser){
            var alertPopup = $ionicPopup.alert({
                          title: '༼ つ ◕_◕ ༽つ',
                          template: 'Ja esta confirmado nesse evento!!!'
                        });
          }else{
              var alertPopup = $ionicPopup.alert({
                          title: 'ಠ_ಠ',
                          template: 'Seria muito facil tu se aceitar no evento né?'
                        });
          }
        }
      }
      if(item.estado == 2 ){
        var alertPopup = $ionicPopup.alert({
                      title: '༼ つ ◕_◕ ༽つ',
                      template: 'Ja esta confirmado nesse evento!!!'
                    });
        console.log('Ja estou confirmado')
      }
      console.log($scope.evento.diainicio)
      if(item.estado == 8 ){
        if(parseInt($scope.evento.patual)<parseInt($scope.evento.pmax)  && confirm!= item.iduser){
                confirm = item.iduser;
                console.log(item.iduser, $scope.aux.iduser);
                $scope.msgnoti = ('Tu foi aceito no evento: ' + $scope.evento.nomeevento);
                $scope.evento.patual = parseInt($scope.evento.patual)+1;
                $http.post('https://ec2.diwoapp.com.br/addpessoaevento.php', {idevento : $scope.evento.idevento,
                                                                                patual : $scope.evento.patual});
                $http.post('https://ec2.diwoapp.com.br/atualizarpessoaevento.php' , {iduser : item.iduser,
                                                                                  idevento : $scope.evento.idevento,
                                                                                  confirmacao : 'Confirmação aceita',
                                                                                  estado :2});
                noti.recebeusername = item.username;
                noti.recebe = item.iduser;
                noti.envia = $scope.aux.iduser;
                noti.tipo = 2;
                noti.nomeevento = $scope.evento.nomeevento;
                EventoService.VerificaNotificacao(noti).then(function(res) {
                  console.log(res);
                  if(res){
                    $http.post('https://ec2.diwoapp.com.br/notificapessoa.php', {notificacao : $scope.msgnoti, 
                                          idevento : $scope.evento.idevento,
                                          nomeevento : $scope.evento.nomeevento,
                                          id_user_envia : $scope.aux.iduser,
                                          username_envia : $scope.aux.username,
                                          apelido_envia : $scope.aux.apelido,
                                          tipo : '2',
                                          id_user_recebe : noti.recebe});
                    EventoService.getusuario2(noti.recebeusername).then(function(user) {
                      if(user.notiparticipando == '1'){
                        $scope.pushnoti.titulo =  'Boraaa!!!' ;
                        $scope.pushnoti.msg = $scope.msgnoti;
                        $scope.pushnoti.token = user.devicetoken;
                        EventoService.MandaPushNoti($scope.pushnoti);
                      }
                    });
                  }
                });
                  var alertPopup = $ionicPopup.alert({
                      title: '(°◡°♡).:｡',
                      template: 'Vamos confirmar a presença dele!!'
                    });
                 item.confirmacao = 'Confirmação aprovada';
         
        console.log('Ja estou confirmado')
        }else{
          var confirmPopup = $ionicPopup.show({
                   title: '(◕⌓◕;)',
                   template: 'Evento esta cheio, deseja confirmar essa pessoa mesmo assim?',
                   buttons: [
                      { text: 'Não',
                        type: 'button-assertive'},
                      {
                        text: 'Sim',
                        type: 'button-positive',
                        onTap: function(e){
                          confirm = item.iduser;
                          console.log(item.iduser, $scope.aux.iduser);
                          $scope.msgnoti = ('Tu foi aceito no evento: ' + $scope.evento.nomeevento);
                          $scope.evento.patual = parseInt($scope.evento.patual)+1;
                          $http.post('https://ec2.diwoapp.com.br/addpessoaevento.php', {idevento : $scope.evento.idevento,
                                                                                          patual : $scope.evento.patual});
                          $http.post('https://ec2.diwoapp.com.br/atualizarpessoaevento.php' , {iduser : item.iduser,
                                                                                            idevento : $scope.evento.idevento,
                                                                                            confirmacao : 'Confirmação aceita',
                                                                                            estado :2});
                          noti.recebeusername = item.username;
                          noti.recebe = item.iduser;
                          noti.envia = $scope.aux.iduser;
                          noti.tipo = 2;
                          noti.nomeevento = $scope.evento.nomeevento;
                          EventoService.VerificaNotificacao(noti).then(function(res) {
                            console.log(res);
                            if(res){
                              $http.post('https://ec2.diwoapp.com.br/notificapessoa.php', {notificacao : $scope.msgnoti, 
                                                    idevento : $scope.evento.idevento,
                                                    nomeevento : $scope.evento.nomeevento,
                                                    id_user_envia : $scope.aux.iduser,
                                                    username_envia : $scope.aux.username,
                                                    apelido_envia : $scope.aux.apelido,
                                                    tipo : '2',
                                                    id_user_recebe : noti.recebe});
                              EventoService.getusuario2(noti.recebeusername).then(function(user) {
                                if(user.notiparticipando == '1'){
                                  $scope.pushnoti.titulo =  'Boraaa!!!' ;
                                  $scope.pushnoti.msg = $scope.msgnoti;
                                  $scope.pushnoti.token = user.devicetoken;
                                  EventoService.MandaPushNoti($scope.pushnoti);
                                }
                              });
                            }
                          });
                            var alertPopup = $ionicPopup.alert({
                                title: '(°◡°♡).:｡',
                                template: 'Vamos confirmar a presença dele!!'
                              });
                           item.confirmacao = 'Confirmação aprovada';
                              }
                             }
                           ]
                   })
            // var alertPopup = $ionicPopup.alert({
            //             title: '(◕⌓◕;)',
            //             template: 'Evento esta cheio, ou aumenta o numero de vagas ou escolha alguem para excluir do evento'
            //           });
          console.log('Esta cheio o evento')
        }
      }
      if (item.estado == 0) {
                var alertPopup = $ionicPopup.alert({
                          title: 'ლ(́◉◞౪◟◉‵ლ)',
                          template: 'Ja sou o organizador, não preciso me confirmar'
                        });
      }
    }
  }

  $scope.onItemDelete = function(item) {
    if (item.iduser == $scope.aux.iduser) {
      var alertPopup = $ionicPopup.alert({
                      title: 'Oi?',
                      template: 'Tu és o organizador, não podes se deletar do seu evento, podes cancelar ele'
      });
    }else{
      var confirmPopup = $ionicPopup.show({
                   title: 'ATENÇÃO!!!',
                   template: 'Você esta preste excluir pessoa do evento, ela não poderá mais entrar neste evento, tens certeza disso?',
                   buttons: [
                      { text: 'Não',
                        type: 'button-assertive'},
                      {
                        text: 'Sim',
                        type: 'button-positive',
                        onTap: function(e){
                        noti.recebeusername = item.username;
                        noti.recebe = item.iduser;
                        noti.envia = $scope.aux.iduser;
                        noti.tipo = 9;
                        noti.nomeevento = $scope.evento.nomeevento;
                        EventoService.VerificaNotificacao(noti).then(function(res) {
                          console.log(res);
                          if(res){
                            $http.post('https://ec2.diwoapp.com.br/notificapessoa.php', {notificacao : 'Tu foi retirado do evento', 
                                                                                            idevento : $scope.evento.idevento,
                                                                                            nomeevento : $scope.evento.nomeevento,
                                                                                            id_user_envia : $scope.aux.iduser,
                                                                                            username_envia : $scope.aux.username,
                                                                                            apelido_envia : $scope.aux.apelido,
                                                                                            tipo : '9', //pessoa kickada
                                                                                            id_user_recebe : noti.recebe});
                            EventoService.getusuario2(noti.recebeusername).then(function(user) {
                              if(user.notiparticipando == '1'){
                                $scope.pushnoti.titulo = $scope.evento.nomeevento;
                                $scope.pushnoti.msg = 'Tu foi retirado do evento: ' + $scope.evento.nomeevento;
                                $scope.pushnoti.token = user.devicetoken;
                                EventoService.MandaPushNoti($scope.pushnoti);
                              }
                            });
                          }
                        });
                          $http.post('https://ec2.diwoapp.com.br/deletapessoaevento.php', {iduser :item.iduser,
                                                                                              idevento : $scope.evento.idevento});
                          $http.post('https://ec2.diwoapp.com.br/deletachat.php', {iduser : item.iduser,
                                                                                      idevento : $scope.aux.idevento}); 
                          if(item.estado == 2){
                           $scope.evento.patual = parseInt($scope.evento.patual)-1;
                          }
                          $http.post('https://ec2.diwoapp.com.br/addpessoaevento.php', {idevento : $scope.evento.idevento,
                                                                                          patual : $scope.evento.patual});     
                          $http.post('https://ec2.diwoapp.com.br/pessoanaoevento.php', {iduser : item.iduser, 
                                                                                          idevento : $scope.evento.idevento,
                                                                                          nomeevento : $scope.evento.nomeevento,
                                                                                          estado : '1'});//foi kickado
                                                                                             

                          $scope.items.splice($scope.items.indexOf(item), 1);      
                              }
                             }
                           ]
                   })


      
    }
  }  

  $scope.confirma = function(){
    if($scope.limiteatuacao){
      if(datainvalida==1){
        var alertPopup = $ionicPopup.alert({
          title: 'ಠ_ಠ',
          template: 'Ja tens um evento marcado nesta data querido'
        });
      }else{
        if ($scope.nuser == 0) {
              if (!$scope.evento.idevento || !$scope.aux.iduser) {
                              var alertPopup = $ionicPopup.alert({
                              title: 'Vish deu ruim',
                              template: 'Favor refaça seu login'
                            });

              }else{
                if($scope.evento.tipodeevento){
                  if(zone == 'yellow'){
                    var confirmPopup = $ionicPopup.show({
                         title: 'ZONA AMARELA',
                         template: 'Evento esta na ZONA AMARELA, caso voce desista uma vez que confirmado a presença tu sofrerás um cartão amarelo. Deseja ir mesmo assim?',
                         buttons: [
                            { text: 'Não sei se vou',
                              type: 'button-assertive',
                              onTap: function(e){
                                console.log('nada acontece');
                              }},
                            {
                              text: 'Quero ir',
                              type: 'button-positive',
                              onTap: function(e){
                                $scope.confirmacao = 'Confirmação aceita';
                                $scope.estado = '2';
                      var link = 'https://ec2.diwoapp.com.br/irevento.php';
                      $http.post(link, {idevento : $scope.evento.idevento,
                                      idadm : $scope.evento.adm, 
                                      admusername : $scope.evento.admusername, 
                                      diainicio : $scope.evento.diainicio,
                                      diafim : $scope.evento.diafim,
                                      iduser : $scope.aux.iduser,
                                      borda : $scope.aux.borda,
                                      username: $scope.aux.username,
                                      profilepic : $scope.aux.profilepic,
                                      devicetoken : $scope.aux.devicetoken,
                                      apelido : $scope.aux.apelido,
                                      confirmacao : $scope.confirmacao,
                                      nomeevento :  $scope.evento.nomeevento,
                                      eventopic : $scope.evento.eventopic,
                                      idComercioParceiro : $scope.evento.idComercioParceiro, 
                                      estado : $scope.estado}).then(function (res){
                        $scope.response = res.data;
                        $http.post('https://ec2.diwoapp.com.br/deletapessoaevento.php', {iduser : $scope.aux.iduser,
                                                                                    idevento : $scope.evento.idevento,
                                                                                    estado: '5'});
                        if ($scope.response.success == true) {
                         
                          $scope.evento.patual = parseInt($scope.evento.patual)+1;
                          $http.post('https://ec2.diwoapp.com.br/addpessoaevento.php', {idevento : $scope.evento.idevento,
                                                                          patual : $scope.evento.patual});
                          console.log($scope.evento.patual,$scope.evento.pmin , 'Número de pessoas alcançado do evento ')
                          if(parseInt($scope.evento.patual) == parseInt($scope.evento.pmin)){
                            EventoService.GetUserPorId($scope.evento.idComercioParceiro).then(function(comercio) {
                              $scope.msgnotiComercio = ('Número mínimo de pessoas alcançado do evento ' + $scope.evento.nomeevento );
                              noti.recebeusername = comercio.username;
                              noti.recebe = comercio.idComercioParceiro;
                              noti.envia = comercio.idComercioParceiro;
                              noti.tipo = 51;   //evento bateu numero minimo de pessoas para acontecer
                              noti.nomeevento = $scope.evento.nomeevento;
                                EventoService.VerificaNotificacao(noti).then(function(res) {
                                if(res){
                                  $http.post('https://ec2.diwoapp.com.br/notificapessoa.php', {notificacao : $scope.msgnotiComercio, 
                                                idevento : $scope.evento.idevento,
                                                nomeevento : $scope.evento.nomeevento,
                                                id_user_envia : $scope.evento.idComercioParceiro,
                                                username_envia : $scope.evento.nomeevento,
                                                apelido_envia : $scope.evento.nomeevento,
                                                tipo : '51',
                                                id_user_recebe : $scope.evento.idComercioParceiro});
                                    $scope.pushnoti.titulo =  'Número de pessoas alcançado!' ;
                                    $scope.pushnoti.msg = $scope.msgnotiComercio;
                                    $scope.pushnoti.token = comercio.devicetoken;
                                    EventoService.MandaPushNoti($scope.pushnoti);
                                    $scope.pushnoti.titulo =  'Número de pessoas alcançado!' ;
                                    $scope.pushnoti.msg = $scope.msgnotiComercio;
                                    $scope.pushnoti.token = 'dKpOML7ZLIA:APA91bFhTghUqP4gpCkohaf3h1WzCjDwQTrMg2JbUJjEQ9WegZgXWZQSNWtwoeAIu98bLK6wtSByVo1jluGyPmVmBxrvEWu6sluypuLk6O7F_18Z_e2kko7UQdK16Hu7O4qxsvstCmSI';
                                    EventoService.MandaPushNoti($scope.pushnoti);
                                }
                              });
                            });
                          }
                          $http.post("https://ec2.diwoapp.com.br/deletanotificacaoporids.php", {id_user_recebe : noti.recebe,
                                                                                    id_user_envia: noti.envia,
                                                                                    nomeevento: noti.nomeevento,
                                                                                    tipo : '5'});
                          var alertPopup = $ionicPopup.alert({
                            title: 'Parabéns',
                            template: $scope.response.msg
                          });
                          alertPopup.then(function(){
                            $http.post('https://ec2.diwoapp.com.br/deletapessoaevento.php', {iduser : $scope.aux.iduser,
                                                                                    idevento : $scope.evento.idevento,
                                                                                    estado: '7'}).then(function (res){
                            $scope.response = res.data;
                            //console.log(i);
                            $scope.fav = false;
                            });
                            $state.go('tabsController.telacomercio');
                          });
                          
                        }else{
                          var alertPopup = $ionicPopup.alert({
                            title: 'Ocorreu uma falha',
                            template: $scope.response.msg
                          });
                        }
                        console.log($scope.response.msg);
                    });
                              }}]
                       });
                  }else{
                      $scope.confirmacao = 'Confirmação aceita';
                      $scope.estado = '2';
                      console.log($scope.evento.idComercioParceiro, "ANSUIDNAIUSnd", $scope.evento.nomeevento);
                      // console.log($scope.aux.iduser);
                      // console.log($scope.confirmacao);
                      // console.log($scope.nomeevento);
                      // console.log($scope.estado);
                      var link = 'https://ec2.diwoapp.com.br/irevento.php';
                      $http.post(link, {idevento : $scope.evento.idevento,
                                      idadm : $scope.evento.adm, 
                                      admusername : $scope.evento.admusername, 
                                      diainicio : $scope.evento.diainicio,
                                      diafim : $scope.evento.diafim,
                                      iduser : $scope.aux.iduser,
                                      borda : $scope.aux.borda,
                                      username: $scope.aux.username,
                                      profilepic : $scope.aux.profilepic,
                                      devicetoken : $scope.aux.devicetoken,
                                      apelido : $scope.aux.apelido,
                                      confirmacao : $scope.confirmacao,
                                      nomeevento :  $scope.evento.nomeevento, 
                                      eventopic : $scope.evento.eventopic,
                                      idComercioParceiro : $scope.evento.idComercioParceiro, 
                                      estado : $scope.estado}).then(function (res){
                        $scope.response = res.data;
                        $http.post('https://ec2.diwoapp.com.br/deletapessoaevento.php', {iduser : $scope.aux.iduser,
                                                                                    idevento : $scope.evento.idevento,
                                                                                    estado: '5'});
                        if ($scope.response.success == true) {
                         

                          $scope.evento.patual = parseInt($scope.evento.patual)+1;
                          $http.post('https://ec2.diwoapp.com.br/addpessoaevento.php', {idevento : $scope.evento.idevento,
                                                                          patual : $scope.evento.patual});
                          //console.log($scope.evento.patual,$scope.evento.pmin , 'Número de pessoas alcançado do evento dahushudauhuh')
                          if(parseInt($scope.evento.patual) == parseInt($scope.evento.pmin)){
                            //console.log("Passou pelo IF", $scope.evento.idComercioParceiro)
                            EventoService.GetUserPorId($scope.evento.idComercioParceiro).then(function(comercio) {
                              $scope.msgnotiComercio = ('Número mínimo de pessoas alcançado do evento ' + $scope.evento.nomeevento );
                              noti.recebeusername = comercio.username;
                              noti.recebe = comercio.idComercioParceiro;
                              noti.envia = comercio.idComercioParceiro;
                              noti.tipo = 51;   //evento bateu numero minimo de pessoas para acontecer
                              noti.nomeevento = $scope.evento.nomeevento;
                              //console.log(noti.nomeevento , "Idevento");
                                EventoService.VerificaNotificacao(noti).then(function(res) {
                                if(res){
                                  $http.post('https://ec2.diwoapp.com.br/notificapessoa.php', {notificacao : $scope.msgnotiComercio, 
                                                idevento : $scope.evento.idevento,
                                                nomeevento : $scope.evento.nomeevento,
                                                id_user_envia : $scope.evento.idComercioParceiro,
                                                username_envia : $scope.evento.nomeevento,
                                                apelido_envia : $scope.evento.nomeevento,
                                                tipo : '51',
                                                id_user_recebe : $scope.evento.idComercioParceiro});
                                    $scope.pushnoti.titulo =  'Número de pessoas alcançado!' ;
                                    $scope.pushnoti.msg = $scope.msgnotiComercio;
                                    $scope.pushnoti.token = comercio.devicetoken;
                                    EventoService.MandaPushNoti($scope.pushnoti);
                                    $scope.pushnoti.titulo =  'Número de pessoas alcançado!' ;
                                    $scope.pushnoti.msg = $scope.msgnotiComercio;
                                    $scope.pushnoti.token = 'dKpOML7ZLIA:APA91bFhTghUqP4gpCkohaf3h1WzCjDwQTrMg2JbUJjEQ9WegZgXWZQSNWtwoeAIu98bLK6wtSByVo1jluGyPmVmBxrvEWu6sluypuLk6O7F_18Z_e2kko7UQdK16Hu7O4qxsvstCmSI';
                                    console.log($scope.pushnoti.msg, "Mandando push");
                                    EventoService.MandaPushNoti($scope.pushnoti);
                                }
                              });
                            });
                          }




                          var alertPopup = $ionicPopup.alert({
                            title: 'Parabéns',
                            template: $scope.response.msg
                          });
                          alertPopup.then(function(){
                            $http.post('https://ec2.diwoapp.com.br/deletapessoaevento.php', {iduser : $scope.aux.iduser,
                                                                                    idevento : $scope.evento.idevento,
                                                                                    estado: '7'}).then(function (res){
                            $scope.response = res.data;
                            //console.log(i);
                            $scope.fav = false;
                            });
                            $state.go('tabsController.telacomercio');
                          });
                          
                        }else{
                          var alertPopup = $ionicPopup.alert({
                            title: 'Ocorreu uma falha',
                            template: $scope.response.msg
                          });
                        }
                        console.log($scope.response.msg);
                    });
                  }
                }else{
                  if(zone == 'yellow'){
                    var confirmPopup = $ionicPopup.show({
                         title: 'ZONA AMARELA',
                         template: 'Evento esta na ZONA AMARELA, caso voce desista uma vez que confirmado a presença tu sofrerás um cartão amarelo. Deseja ir mesmo assim?',
                         buttons: [
                            { text: 'Não sei se vou',
                              type: 'button-assertive',
                              onTap: function(e){
                                console.log('nada acontece');
                              }},
                            {
                              text: 'Quero ir',
                              type: 'button-positive',
                              onTap: function(e){
                                $scope.confirmacao = 'aguardando confirmação';
                                $scope.estado = '1';
                      // console.log($scope.evento.idevento);
                      // console.log($scope.aux.iduser);
                      // console.log($scope.confirmacao);
                      // console.log($scope.nomeevento);
                      // console.log($scope.estado);
                      var link = 'https://ec2.diwoapp.com.br/irevento.php';
                      $http.post(link, {idevento : $scope.evento.idevento,
                                      idadm : $scope.evento.adm, 
                                      admusername : $scope.evento.admusername, 
                                      diainicio : $scope.evento.diainicio,
                                      diafim : $scope.evento.diafim,
                                      iduser : $scope.aux.iduser,
                                      borda : $scope.aux.borda,
                                      username: $scope.aux.username,
                                      profilepic : $scope.aux.profilepic,
                                      devicetoken : $scope.aux.devicetoken,
                                      apelido : $scope.aux.apelido,
                                      confirmacao : $scope.confirmacao,
                                      nomeevento :  $scope.nomeevento,
                                      eventopic : $scope.evento.eventopic,
                                      idComercioParceiro : $scope.evento.idComercioParceiro, 
                                      estado : $scope.estado}).then(function (res){
                        $scope.response = res.data;
                        $http.post('https://ec2.diwoapp.com.br/deletapessoaevento.php', {iduser : $scope.aux.iduser,
                                                                                    idevento : $scope.evento.idevento,
                                                                                    estado: '5'});
                        if ($scope.response.success == true) {
                          $scope.msgnoti = ('To querendo ir no evento: ' + $scope.evento.nomeevento);
                          noti.recebe = $scope.evento.adm;
                          noti.envia = $scope.aux.iduser;
                          noti.tipo = 1;
                          noti.nomeevento = $scope.evento.nomeevento;
                          EventoService.VerificaNotificacao(noti).then(function(res) {
                            console.log(res);
                            if(res){
                              if($scope.evento.tipodeevento != "comercio" && $scope.evento.tipodeevento != "campanha"){
                                $http.post('https://ec2.diwoapp.com.br/notificacriador.php', {notificacao : $scope.msgnoti, 
                                      idevento : $scope.evento.idevento,
                                      nomeevento : $scope.evento.nomeevento,
                                      id_user_envia : $scope.aux.iduser,
                                      username_envia : $scope.aux.username,
                                      apelido_envia : $scope.aux.apelido,
                                      tipo : '1',
                                      id_user_recebe : $scope.evento.adm});
                             EventoService.getusuario2($scope.evento.admusername).then(function(user) {
                                if(user.noticriados == '1'){
                                $scope.pushnoti.titulo = $scope.evento.nomeevento;
                                $scope.pushnoti.msg = $scope.aux.username + " quer participar do evento";
                                $scope.pushnoti.token = user.devicetoken;
                                 EventoService.MandaPushNoti($scope.pushnoti);
                                }
                              });
                              }
                             
                             
                            }
                          });
                          $http.post("https://ec2.diwoapp.com.br/deletanotificacaoporids.php", {id_user_recebe : noti.recebe,
                                                                                    id_user_envia: noti.envia,
                                                                                    nomeevento: noti.nomeevento,
                                                                                    tipo : '5'});
                          var alertPopup = $ionicPopup.alert({
                            title: 'Parabéns',
                            template: $scope.response.msg
                          });
                          alertPopup.then(function(){
                            $http.post('https://ec2.diwoapp.com.br/deletapessoaevento.php', {iduser : $scope.aux.iduser,
                                                                                    idevento : $scope.evento.idevento,
                                                                                    estado: '7'}).then(function (res){
                            $scope.response = res.data;
                            //console.log(i);
                            $scope.fav = false;
                            });
                            $state.go('tabsController.telacomercio');
                          });
                          
                        }else{
                          var alertPopup = $ionicPopup.alert({
                            title: 'Ocorreu uma falha',
                            template: $scope.response.msg
                          });
                        }
                        console.log($scope.response.msg);
                    });
                              }}]
                       });
                  }else{
                      $scope.confirmacao = 'aguardando confirmação';
                      $scope.estado = '1';
                      // console.log($scope.evento.idevento);
                      // console.log($scope.aux.iduser);
                      // console.log($scope.confirmacao);
                      // console.log($scope.nomeevento);
                      // console.log($scope.estado);
                      var link = 'https://ec2.diwoapp.com.br/irevento.php';
                      $http.post(link, {idevento : $scope.evento.idevento,
                                      idadm : $scope.evento.adm, 
                                      admusername : $scope.evento.admusername, 
                                      diainicio : $scope.evento.diainicio,
                                      diafim : $scope.evento.diafim,
                                      iduser : $scope.aux.iduser,
                                      borda : $scope.aux.borda,
                                      username: $scope.aux.username,
                                      profilepic : $scope.aux.profilepic,
                                      devicetoken : $scope.aux.devicetoken,
                                      apelido : $scope.aux.apelido,
                                      confirmacao : $scope.confirmacao,
                                      nomeevento :  $scope.nomeevento, 
                                      eventopic : $scope.evento.eventopic,
                                      idComercioParceiro : $scope.evento.idComercioParceiro, 
                                      estado : $scope.estado}).then(function (res){
                        $scope.response = res.data;
                        $http.post('https://ec2.diwoapp.com.br/deletapessoaevento.php', {iduser : $scope.aux.iduser,
                                                                                    idevento : $scope.evento.idevento,
                                                                                    estado: '5'});
                        if ($scope.response.success == true) {
                          $scope.msgnoti = ('To querendo ir no evento: ' + $scope.evento.nomeevento);
                          noti.recebe = $scope.evento.adm;
                          noti.envia = $scope.aux.iduser;
                          noti.tipo = 1;
                          noti.nomeevento = $scope.evento.nomeevento;
                          EventoService.VerificaNotificacao(noti).then(function(res) {
                            console.log(res);
                            if(res){
                                 if($scope.evento.tipodeevento != "comercio" && $scope.evento.tipodeevento != "campanha"){
                                $http.post('https://ec2.diwoapp.com.br/notificacriador.php', {notificacao : $scope.msgnoti, 
                                      idevento : $scope.evento.idevento,
                                      nomeevento : $scope.evento.nomeevento,
                                      id_user_envia : $scope.aux.iduser,
                                      username_envia : $scope.aux.username,
                                      apelido_envia : $scope.aux.apelido,
                                      tipo : '1',
                                      id_user_recebe : $scope.evento.adm});
                             EventoService.getusuario2($scope.evento.admusername).then(function(user) {
                              if(user.noticriados == '1'){
                                $scope.pushnoti.titulo = $scope.evento.nomeevento;
                                $scope.pushnoti.msg = $scope.aux.username + " quer participar do evento";
                                $scope.pushnoti.token = user.devicetoken;
                                 EventoService.MandaPushNoti($scope.pushnoti);
                               }
                              });
                              }
                              
                            }
                          });
                          $http.post("https://ec2.diwoapp.com.br/deletanotificacaoporids.php", {id_user_recebe : noti.recebe,
                                                                                    id_user_envia: noti.envia,
                                                                                    nomeevento: noti.nomeevento,
                                                                                    tipo : '5'});


                                      /// PEDIR CONTATO DE ALGUEM DE FORA PARA FAZER O SERVIÇO DE CHAMAR
           



                          var alertPopup = $ionicPopup.alert({
                            title: 'Parabéns',
                            template: $scope.response.msg
                          });
                          alertPopup.then(function(){
                            $http.post('https://ec2.diwoapp.com.br/deletapessoaevento.php', {iduser : $scope.aux.iduser,
                                                                                    idevento : $scope.evento.idevento,
                                                                                    estado: '7'}).then(function (res){
                            $scope.response = res.data;
                            //console.log(i);
                            $scope.fav = false;
                            });
                            $state.go('tabsController.telacomercio');
                          });
                          
                        }else{
                          var alertPopup = $ionicPopup.alert({
                            title: 'Ocorreu uma falha',
                            template: $scope.response.msg
                          });
                        }
                        console.log($scope.response.msg);
                    });
                  }
                }
              }
        
        }else{
          $scope.borala = false;
          $scope.desistir = true;
        }
        $state.reload();
      }
    }else{
      var alertPopup = $ionicPopup.alert({
        title: '(⌯˃̶᷄ ﹏ ˂̶᷄⌯)ﾟ',
        template: 'Ficamos felizes em saber que você quer participar desse evento! Mas parece que ele está muito longe de você. Tente novamente quando você estiver mais perto!'
      });
    }
    
  }

  $scope.reservar = function(){
    var link = 'https://ec2.diwoapp.com.br/reservar.php';
                  $http.post(link, {idevento : $scope.evento.idevento, 
                                idadm : $scope.evento.adm, 
                                admusername : $scope.evento.admusername,
                                apelido : $scope.aux.apelido,  
                                iduser : $scope.aux.iduser,
                                diainicio : $scope.evento.diainicio,
                                diafim : $scope.evento.diafim,
                                username: $scope.aux.username,
                                confirmacao : 'na fila',
                                profilepic: $scope.aux.profilepic,
                                devicetoken : $scope.aux.devicetoken,
                                nomeevento :  $scope.nomeevento, 
                                estado : '8'}).then(function (res){
                  $scope.response = res.data;
                  var alertPopup = $ionicPopup.alert({
                      title: 'ヾ(･д･ヾ)',
                      template: 'Vamos avisar que tu ta querendo ir, vai que aumentao o limite máximo ou alguem desiste né? T avisaremos se algo acontecer'
                    });
                    $scope.msgnoti = ('To querendo ir no evento: ' + $scope.evento.nomeevento + ' mas ele esta cheio, da pra fazer algo?');
                    //console.log($scope.msgnoti);
                    noti.recebe = $scope.evento.adm;
                    noti.envia = $scope.aux.iduser;
                    noti.tipo = 8; // solicitando reserva
                    noti.nomeevento = $scope.evento.nomeevento;
                    EventoService.VerificaNotificacao(noti).then(function(res) {
                      console.log(res);
                      if(res){
                          if($scope.evento.tipodeevento != "comercio" && $scope.evento.tipodeevento != "campanha"){
                                $http.post('https://ec2.diwoapp.com.br/notificacriador.php', {notificacao : $scope.msgnoti, 
                                      idevento : $scope.evento.idevento,
                                      nomeevento : $scope.evento.nomeevento,
                                      id_user_envia : $scope.aux.iduser,
                                      username_envia : $scope.aux.username,
                                      apelido_envia : $scope.aux.apelido,
                                      tipo : '1',
                                      id_user_recebe : $scope.evento.adm});
                             EventoService.getusuario2($scope.evento.admusername).then(function(user) {
                              if(user.noticriados == '1'){
                                $scope.pushnoti.titulo = $scope.evento.nomeevento;
                                $scope.pushnoti.msg = $scope.aux.username + " quer participar do evento";
                                $scope.pushnoti.token = user.devicetoken;
                                 EventoService.MandaPushNoti($scope.pushnoti);
                               }
                              });
                              }
                      }
                    });
                    $http.post("https://ec2.diwoapp.com.br/deletanotificacaoporids.php", {id_user_recebe : noti.recebe,
                                                                              id_user_envia: noti.envia,
                                                                              nomeevento: noti.nomeevento,
                                                                              tipo : '5'});
                  $scope.reserva = false;
              });
    $state.reload();
  }

  $scope.desfavorita = function(){
    $http.post('https://ec2.diwoapp.com.br/deletapessoaevento.php', {iduser : $scope.aux.iduser,
                                                                        idevento : $scope.evento.idevento,
                                                                        estado: '7'});
    $scope.pinza = true;
    $scope.despinza = false;
  }

  $scope.favorita = function(){
   //    console.log("pinza", $scope.evento.adm, $scope.evento.admusername, $scope.aux.iduser, $scope.evento.diainicio, $scope.evento.diafim,
   // $scope.aux.borda,
   // $scope.aux.username,
   // $scope.aux.profilepic,
   // $scope.aux.devicetoken,
   // $scope.aux.apelido,
   // 'interesse',
   // $scope.nomeevento, )
    var link = 'https://ec2.diwoapp.com.br/irevento.php';
    $http.post(link, {idevento : $scope.evento.idevento, 
                              idadm : $scope.evento.adm, 
                              admusername : $scope.evento.admusername, 
                              iduser : $scope.aux.iduser,
                              diainicio : $scope.evento.diainicio,
                              diafim : $scope.evento.diafim,
                              borda : $scope.aux.borda,
                              username: $scope.aux.username,
                              profilepic : $scope.aux.profilepic,
                              devicetoken : $scope.aux.devicetoken,
                              apelido : $scope.aux.apelido,
                              confirmacao : 'interesse',
                              nomeevento :  $scope.nomeevento,
                              eventopic : $scope.evento.eventopic,
                              idComercioParceiro : $scope.evento.idComercioParceiro,  
                              estado : '7'});
    $scope.pinza = false;
    $scope.despinza = true;
  }

  $scope.reportar = function(){
    $scope.reportmsg = '';
    //console.log($scope.evento.admusername);
    $scope.report = [
      { text: "Conteúdo impróprio", checked: false },
      { text: "Linguajar inadequado", checked: false },
      { text: "Discurso de ódio", checked: false },
      { text: "Imagem imprópria", checked: false },
      { text: "Substancias ilicitas ", checked: false }
    ];
    $ionicPopup.confirm({
        title: 'Você quer reportar esse evento pq?',
        content: '<ion-checkbox ng-repeat="item in report" style="color: #FCFCFC;" ng-model="item.checked"  ng-checked="item.checked">{{item.text}}</ion-checkbox>',
        scope: $scope
    }).then(function(res) {
        if(res) {
          for (var h=0;h<3;h++){
            //console.log($scope.report[h].checked , h);
            if($scope.report[h].checked){
              $scope.reportmsg = $scope.reportmsg + $scope.report[h].text + ' ';
              //console.log($scope.reportmsg);
            }
          }
          if(h==3){
            console.log($scope.reportmsg);
            $http.post('https://ec2.diwoapp.com.br/reportaevento.php', {namereportado : $scope.evento.admusername,
                                                                            reportadoid : $scope.evento.idevento,
                                                                            iduserreportando : $scope.aux.iduser,
                                                                            usernamereportando : $scope.aux.username,
                                                                            tiporeport : 'evento',
                                                                            motivo : $scope.reportmsg}).then(function (tes){
              $scope.response = tes.data;
              var alertPopup = $ionicPopup.alert({
                                        title: 'Obrigado',
                                        template: 'Este evento esta agora sobre avaliação, obrigado por manter a plataforma organizada'
              });
            });
          }
        }
    });
  }

  $scope.deletar =  function(){
    if ($scope.criador == $scope.aux.iduser) {
      if(zone == 'red' || zone == 'yellow'){
        if(zone == 'red' ){
          var myPopup = $ionicPopup.show({
                template: '<input type="text" placeholder="Escreva aqui pq nao vai rolar" ng-model="data.desculpa">',
                title: 'ATENÇÃOOOOOO!!!',
                subTitle: 'Você esta preste a cancelar seu evento faltando muito pouco para seu começo, tens certeza disso?. Se tu realmente cancelar estaremos te dando um cartão vermelho. Para saber mais sobre eles va no seu indice de confirmação',
                scope: $scope,
                buttons: [
                  { text: 'Não' },
                  {
                    text: '<b>Sim</b>',
                    type: 'button-positive',
                    onTap: function(e) {
                      // console.log($scope.items.length);
                       var notifica = ("Desisti de fazer o evento, " + $scope.data.desculpa);
                      // console.log(notifica);
                      // console.log($scope.aux.iduser);
                    
                      formtelaCriar.updateForm(1);
                       $http.post('https://ec2.diwoapp.com.br/deletanotificacaoporevento.php' , {idevento : $scope.evento.idevento,
                                                                                    nomeevento : $scope.evento.nomeevento});
                      
                      $http.post('https://ec2.diwoapp.com.br/penalidade.php', {iduser : $scope.aux.iduser,
                                                                                   idevento : $scope.evento.idevento,
                                                                                   username : $scope.aux.username,
                                                                                   tipopenalidade : '2'});     // tipo2 saiu na redzone         
                      EventoService.GetParticipantes($scope.evento.idevento).then(function(ppl) {
                                   for (var i = 0; i < ppl.length; i++) {
                                    if ($scope.aux.iduser != ppl[i].iduser) {
                                          noti.recebeusername = ppl[i].username;
                                          noti.recebe = ppl[i].iduser;
                                          noti.envia = $scope.aux.iduser;
                                          noti.tipo = 4;
                                          noti.nomeevento = $scope.evento.nomeevento;
                                          EventoService.VerificaNotificacao(noti).then(function(res) {
                                            console.log(res);
                                            if(res){
                                            $http.post('https://ec2.diwoapp.com.br/notificapessoa.php', {notificacao : notifica, 
                                                    idevento : $scope.evento.idevento,
                                                    nomeevento : $scope.evento.nomeevento,
                                                    id_user_envia : $scope.aux.iduser,
                                                    username_envia : $scope.aux.username,
                                                    apelido_envia : $scope.aux.apelido,
                                                    tipo : '5',   
                                                    id_user_recebe : noti.recebe}).then(function (res){
                                                   $scope.response = res.data;
                                                   console.log($scope.response.msg)
                                                 });
                                              EventoService.getusuario2(noti.recebeusername).then(function(user) {
                                                if(user.notiparticipando == '1'){
                                                $scope.pushnoti.titulo = $scope.evento.nomeevento + ' Cancelado';
                                                $scope.pushnoti.msg = notifica;
                                                $scope.pushnoti.token = user.devicetoken;
                                                 EventoService.MandaPushNoti($scope.pushnoti);
                                               }
                                              });
                                            }
                                          });
                                        }
                                  }
                                 })
                      for(var i = 0; i< $scope.items.length; i++){
                        $http.post('https://ec2.diwoapp.com.br/deletapessoaevento.php', {iduser : $scope.items[i].iduser,
                                                                                           idevento : $scope.evento.idevento});
                      }
                      $scope.evento.estado = "3";             
                      $scope.evento.datamodificacao = new Date();   
                      EventoService.atualizarevento($scope.evento);
                      $state.go('tabsController.telacomercio');
                    }
                  }
                ]
          });
          console.log('criador do evento cancelando proprio evento');
        }else{
          var myPopup = $ionicPopup.show({
                      template: '<input type="text" placeholder="Escreva aqui pq nao vai rolar" ng-model="data.desculpa">',
                      title: 'ATENÇÃO!!!',
                      subTitle: 'Você esta preste a cancelar seu evento faltando pouco para seu começo, tens certeza disso?. Se tu realmente cancelar estaremos te dando um cartão amarelo. Para saber mais sobre eles va no seu indice de confirmação',
                      scope: $scope,
                      buttons: [
                        { text: 'Não' },
                        {
                          text: '<b>Sim</b>',
                          type: 'button-positive',
                          onTap: function(e) {
                            // console.log($scope.items.length);
                             var notifica = ("Desisti de fazer o evento, " + $scope.data.desculpa);
                            // console.log(notifica);
                            // console.log($scope.aux.iduser);
                          
                            formtelaCriar.updateForm(1);
                             $http.post('https://ec2.diwoapp.com.br/deletanotificacaoporevento.php' , {idevento : $scope.evento.idevento,
                                                                                          nomeevento : $scope.evento.nomeevento});
                            
                           
                            $http.post('https://ec2.diwoapp.com.br/penalidade.php', {iduser : $scope.aux.iduser,
                                                                                       idevento : $scope.evento.idevento,
                                                                                       username : $scope.aux.username,
                                                                                       tipopenalidade : '1'});   // tipo 1 saiu na yellow zone               
                            EventoService.GetParticipantes($scope.evento.idevento).then(function(ppl) {
                                   for (var i = 0; i < ppl.length; i++) {
                                    console.log('Enviando')
                                    if ($scope.aux.iduser != ppl[i].iduser) {
                                          noti.recebeusername = ppl[i].username;
                                          noti.recebe = ppl[i].iduser;
                                          noti.envia = $scope.aux.iduser;
                                          noti.tipo = 4;
                                          noti.nomeevento = $scope.evento.nomeevento;
                                          EventoService.VerificaNotificacao(noti).then(function(res) {
                                            console.log(res);
                                            if(res){
                                              console.log('Enviando de vdd')
                                              $http.post('https://ec2.diwoapp.com.br/notificapessoa.php', {notificacao : notifica, 
                                                      idevento : $scope.evento.idevento,
                                                      nomeevento : $scope.evento.nomeevento,
                                                      id_user_envia : $scope.aux.iduser,
                                                      username_envia : $scope.aux.username,
                                                      apelido_envia : $scope.aux.apelido,
                                                      tipo : '5',   
                                                      id_user_recebe : noti.recebe}).then(function (res){
                                                     $scope.response = res.data;
                                                     console.log($scope.response.msg)
                                                   });
                                                EventoService.getusuario2(noti.recebeusername).then(function(user) {
                                                  if(user.notiparticipando == '1'){
                                                  $scope.pushnoti.titulo = $scope.evento.nomeevento + ' Cancelado';
                                                  $scope.pushnoti.msg = notifica;
                                                  $scope.pushnoti.token = user.devicetoken;
                                                   EventoService.MandaPushNoti($scope.pushnoti);
                                                 }
                                                });
                                              }
                                            });
                                        }
                                  }
                                 })
                             for(var i = 0; i< $scope.items.length; i++){
                              $http.post('https://ec2.diwoapp.com.br/deletapessoaevento.php', {iduser : $scope.items[i].iduser,
                                                                                                 idevento : $scope.evento.idevento});
                            }
                            $scope.evento.estado = "3";
                            $scope.evento.datamodificacao = new Date();                
                            EventoService.atualizarevento($scope.evento);
                            $state.go('tabsController.telacomercio');
                          }
                        }
                      ]
          });
          console.log('criador do evento cancelando proprio evento');
        }
      }else{
        var myPopup = $ionicPopup.show({
                  template: '<input type="text" placeholder="Escreva aqui pq nao vai rolar" ng-model="data.desculpa">',
                  title: 'SÉRIO?!?!',
                  subTitle: 'Você esta preste a deletar seu evento, tens certeza disso?',
                  scope: $scope,
                  buttons: [
                    { text: 'Não' },
                    {
                      text: '<b>Sim</b>',
                      type: 'button-positive',
                      onTap: function(e) {
                        // console.log($scope.items.length);
                         var notifica = ("Desisti de fazer o evento, " + $scope.data.desculpa);
                        // console.log(notifica);
                        // console.log($scope.aux.iduser);
                      
                        formtelaCriar.updateForm(1);
                         $http.post('https://ec2.diwoapp.com.br/deletanotificacaoporevento.php' , {idevento : $scope.evento.idevento,
                                                                                                    nomeevento : $scope.evento.nomeevento}).then(function(response) {console.log(response, 'deleta')});
                                    
                        
                        EventoService.GetParticipantes($scope.evento.idevento).then(function(ppl) {
                                   for (var i = 0; i < ppl.length; i++) {
                                    if ($scope.aux.iduser != ppl[i].iduser) {
                                          noti.recebeusername = ppl[i].username
                                          noti.recebe = ppl[i].iduser;
                                          noti.envia = $scope.aux.iduser;
                                          noti.tipo = 4;
                                          noti.nomeevento = $scope.evento.nomeevento;
                                          EventoService.VerificaNotificacao(noti).then(function(res) {
                                            console.log(res);
                                            if(res){
                                            $http.post('https://ec2.diwoapp.com.br/notificapessoa.php', {notificacao : notifica, 
                                                    idevento : $scope.evento.idevento,
                                                    nomeevento : $scope.evento.nomeevento,
                                                    id_user_envia : $scope.aux.iduser,
                                                    username_envia : $scope.aux.username,
                                                    apelido_envia : $scope.aux.apelido,
                                                    tipo : '5',   
                                                    id_user_recebe : noti.recebe}).then(function (res){
                                                   $scope.response = res.data;
                                                   console.log($scope.response.msg)
                                                 });
                                                EventoService.getusuario2(noti.recebeusername).then(function(user) {
                                                  if(user.notiparticipando == '1'){
                                                  $scope.pushnoti.titulo = $scope.evento.nomeevento + ' Cancelado';
                                                  $scope.pushnoti.msg = notifica;
                                                  $scope.pushnoti.token = user.devicetoken;
                                                   EventoService.MandaPushNoti($scope.pushnoti);
                                                 }
                                                });
                                              }
                                            });
                                        }
                                  }
                                 })
                          for(var i = 0; i< $scope.items.length; i++){
                          
                          $http.post('https://ec2.diwoapp.com.br/deletapessoaevento.php', {iduser : $scope.items[i].iduser,
                                                                                             idevento : $scope.evento.idevento});
                        }              
                         $scope.evento.estado = "3";  
                         $scope.evento.datamodificacao = new Date();              
                       EventoService.atualizarevento($scope.evento);
                                            $state.go('tabsController.telacomercio');
                                            }
                    }]
                   });

                        console.log('criador do evento cancelando proprio evento');
        }
              
      }else{
        if (meuestado!=1) {


         if(zone == 'red' || zone == 'yellow'){
                          if(zone == 'red' ){

                               var confirmPopup = $ionicPopup.show({
                                         title: 'ATENÇÃO!!!',
                                         template: 'Você esta preste a desistir de um evento faltando muito pouco tempo para seu começo, tens certeza disso? Se tu realmente cancelar estaremos te dando um cartão vermelho. Para saber mais sobre eles va no seu indice de confirmação ',
                                         buttons: [
                                            { text: 'Não',
                                              type: 'button-assertive'},
                                            {
                                              text: 'Sim',
                                              type: 'button-positive',
                                              onTap: function(e){
                                               noti.recebeusername = $scope.evento.admusername; 
                                                noti.recebe = $scope.criador;
                                            noti.envia = $scope.aux.iduser;
                                            noti.tipo = 5;
                                            noti.nomeevento = $scope.evento.nomeevento;
                                            EventoService.VerificaNotificacao(noti).then(function(res) {
                                              console.log(res);
                                              if(res){
                                                $http.post('https://ec2.diwoapp.com.br/notificapessoa.php', {notificacao : 'Desisti de ir no seu evento, perdão', 
                                                      idevento : $scope.evento.idevento,
                                                      nomeevento : $scope.evento.nomeevento,
                                                      id_user_envia : $scope.aux.iduser,
                                                      username_envia : $scope.aux.username,
                                                      apelido_envia : $scope.aux.apelido,
                                                      tipo : '5', //pessoa desistiu
                                                      id_user_recebe : $scope.criador});
                                                EventoService.getusuario2(noti.recebeusername).then(function(user) {
                                                  if(user.noticriados == '1'){
                                                  $scope.pushnoti.titulo = 'Desisti';
                                                  $scope.pushnoti.msg = $scope.aux.username + ' desistiu de ir no seu evento';
                                                  $scope.pushnoti.token = user.devicetoken;
                                                   EventoService.MandaPushNoti($scope.pushnoti);
                                                 }
                                                });
                                              }
                                            });
                                            $http.post("https://ec2.diwoapp.com.br/deletanotificacaoporids.php", {id_user_recebe : noti.recebe,
                                                                              id_user_envia: noti.envia,
                                                                              nomeevento: noti.nomeevento,
                                                                              tipo : '1'});
                                            $http.post('https://ec2.diwoapp.com.br/penalidade.php', {iduser : $scope.aux.iduser,
                                                                                           idevento : $scope.evento.idevento,
                                                                                           username : $scope.aux.username,
                                                                                           tipopenalidade : '2'});     // tipo2 saiu na redzone  
                                            if(meuestado == 2){
                                               $scope.evento.patual = parseInt($scope.evento.patual)-1;
                                            }
                                            if(parseInt($scope.evento.patual)<parseInt($scope.evento.pmin)){
                                              $http.post('https://ec2.diwoapp.com.br/mudaestadoevento.php', {idevento : $scope.evento.idevento,
                                                                                                            estado : '2'});
                                              $http.post('https://ec2.diwoapp.com.br/notificapessoa.php', {notificacao : 'ATENÇÃO!! Numero de pessoas agora nao bate o mínimo.', 
                                                          idevento : $scope.evento.idevento,
                                                          nomeevento : $scope.evento.nomeevento,
                                                          id_user_envia : $scope.aux.iduser,
                                                          username_envia : $scope.aux.username,
                                                          apelido_envia : $scope.aux.apelido,
                                                          tipo : '12', //pessoa desistiu com menos pessoas para acontecer ou nao um evento
                                                          id_user_recebe : $scope.criador});
                                            }
                                            $http.post('https://ec2.diwoapp.com.br/addpessoaevento.php', {idevento : $scope.evento.idevento,
                                                                                                            patual : $scope.evento.patual});    
                                            $http.post('https://ec2.diwoapp.com.br/deletapessoaevento.php', {iduser : $scope.aux.iduser,
                                                                                                              idevento : $scope.evento.idevento});
                                            $state.go('tabsController.telacomercio');
                                                    }
                                                   }
                                                 ]
                                         })
                             }else{
                                 var confirmPopup = $ionicPopup.show({
                                         title: 'ATENÇÃO!!!',
                                         template: 'Você esta preste a desistir de um evento faltando pouco tempo para seu começo, tens certeza disso? Se tu realmente cancelar estaremos te dando um cartão amarelo. Para saber mais sobre eles va no seu indice de confirmação',
                                         buttons: [
                                            { text: 'Não',
                                              type: 'button-assertive'},
                                            {
                                              text: 'Sim',
                                              type: 'button-positive',
                                              onTap: function(e){
                                                noti.recebeusername = $scope.evento.username;
                                                noti.recebe = $scope.criador;
                                            noti.envia = $scope.aux.iduser;
                                            noti.tipo = 5;
                                            noti.nomeevento = $scope.evento.nomeevento;
                                              EventoService.VerificaNotificacao(noti).then(function(res) {
                                              console.log(res);
                                              if(res){
                                                $http.post('https://ec2.diwoapp.com.br/notificapessoa.php', {notificacao : 'Desisti de ir no seu evento, perdão', 
                                                      idevento : $scope.evento.idevento,
                                                      nomeevento : $scope.evento.nomeevento,
                                                      id_user_envia : $scope.aux.iduser,
                                                      username_envia : $scope.aux.username,
                                                      apelido_envia : $scope.aux.apelido,
                                                      tipo : '5', //pessoa desistiu
                                                      id_user_recebe : $scope.criador});
                                                EventoService.getusuario2(noti.recebeusername).then(function(user) {
                                                  if(user.noticriados == '1'){
                                                  $scope.pushnoti.titulo = 'Desisti';
                                                  $scope.pushnoti.msg = $scope.aux.username + ' desistiu de ir no seu evento';
                                                  $scope.pushnoti.token = user.devicetoken;
                                                   EventoService.MandaPushNoti($scope.pushnoti);
                                                 }
                                                });
                                              }
                                              });
                                              $http.post("https://ec2.diwoapp.com.br/deletanotificacaoporids.php", {id_user_recebe : noti.recebe,
                                                                              id_user_envia: noti.envia,
                                                                              nomeevento: noti.nomeevento,
                                                                              tipo : '1'});
                                                       $http.post('https://ec2.diwoapp.com.br/penalidade.php', {iduser : $scope.aux.iduser,
                                                                                                     idevento : $scope.evento.idevento,
                                                                                                     username : $scope.aux.username,
                                                                                                     tipopenalidade : '1'});   // tipo 1 saiu na yellow zone   
                                                      
                                                         $scope.evento.patual = parseInt($scope.evento.patual)-1;
                                                        $http.post('https://ec2.diwoapp.com.br/addpessoaevento.php', {idevento : $scope.evento.idevento,
                                                                                          patual : $scope.evento.patual});    
                                                    $http.post('https://ec2.diwoapp.com.br/deletapessoaevento.php', {iduser : $scope.aux.iduser,
                                                                                                                        idevento : $scope.evento.idevento});
                                                      $state.go('tabsController.telacomercio');
                                                    }
                                                   }
                                                 ]
                                         })

                             }
                           
                         }else{
                             var confirmPopup = $ionicPopup.show({
                                         title: 'ATENÇÃO!!!',
                                         template: 'Você esta preste a desistir de um evento, tens certeza disso?',
                                         buttons: [
                                            { text: 'Não',
                                              type: 'button-assertive'},
                                            {
                                              text: 'Sim',
                                              type: 'button-positive',
                                              onTap: function(e){
                                                noti.recebeusername = $scope.evento.admusername;
                                                noti.recebe =$scope.criador;
                                            noti.envia = $scope.aux.iduser;
                                            noti.tipo = 5;
                                            noti.nomeevento = $scope.evento.nomeevento;
                                            EventoService.VerificaNotificacao(noti).then(function(res) {
                                              console.log(res);
                                              if(res){
                                                $http.post('https://ec2.diwoapp.com.br/notificapessoa.php', {notificacao : 'Desisti de ir no seu evento, perdão', 
                                                      idevento : $scope.evento.idevento,
                                                      nomeevento : $scope.evento.nomeevento,
                                                      id_user_envia : $scope.aux.iduser,
                                                      username_envia : $scope.aux.username,
                                                      apelido_envia : $scope.aux.apelido,
                                                      tipo : '5', //pessoa desistiu
                                                      id_user_recebe : $scope.criador}).then(function (res){
                                                     $scope.response = res.data;
                                                     //console.log($scope.response.msg)
                                                   });
                                                EventoService.getusuario2(noti.recebeusername).then(function(user) {
                                                  if(user.noticriados == '1'){
                                                  $scope.pushnoti.titulo = 'Desisti';
                                                  $scope.pushnoti.msg = $scope.aux.username + ' desistiu de ir no seu evento';
                                                  $scope.pushnoti.token = user.devicetoken;
                                                   EventoService.MandaPushNoti($scope.pushnoti);
                                                 }
                                                });
                                              }
                                            });
                                            $http.post("https://ec2.diwoapp.com.br/deletanotificacaoporids.php", {id_user_recebe : noti.recebe,
                                                                              id_user_envia: noti.envia,
                                                                              nomeevento: noti.nomeevento,
                                                                              tipo : '1'});
                                                       if(meuestado == 2){
                                                         $scope.evento.patual = parseInt($scope.evento.patual)-1;
                                                        }
                                                    $http.post('https://ec2.diwoapp.com.br/addpessoaevento.php', {idevento : $scope.evento.idevento,
                                                                                                                    patual : $scope.evento.patual});    
                                                    $http.post('https://ec2.diwoapp.com.br/deletapessoaevento.php', {iduser : $scope.aux.iduser,
                                                                                                                        idevento : $scope.evento.idevento});
                                                      $state.go('tabsController.telacomercio');
                                                    }
                                                   }
                                                 ]
                                         })
                           }


                }else{
                   var confirmPopup = $ionicPopup.show({
                                         title: 'ATENÇÃO!!!',
                                         template: 'Você esta preste a desistir de um evento, tens certeza disso?',
                                         buttons: [
                                            { text: 'Não',
                                              type: 'button-assertive'},
                                            {
                                              text: 'Sim',
                                              type: 'button-positive',
                                              onTap: function(e){
                                                noti.recebeusername = $scope.evento.username;
                                                noti.recebe =$scope.criador;
                                            noti.envia = $scope.aux.iduser;
                                            noti.tipo = 5;
                                            noti.nomeevento = $scope.evento.nomeevento;
                                            EventoService.VerificaNotificacao(noti).then(function(res) {
                                              console.log(res);
                                              if(res){
                                                $http.post('https://ec2.diwoapp.com.br/notificapessoa.php', {notificacao : 'Desisti de ir no seu evento, perdão', 
                                                      idevento : $scope.evento.idevento,
                                                      nomeevento : $scope.evento.nomeevento,
                                                      id_user_envia : $scope.aux.iduser,
                                                      username_envia : $scope.aux.username,
                                                      apelido_envia : $scope.aux.apelido,
                                                      tipo : '5', //pessoa desistiu
                                                      id_user_recebe : $scope.criador}).then(function (res){
                                                     $scope.response = res.data;
                                                     //console.log($scope.response.msg)
                                                   });
                                                EventoService.getusuario2(noti.recebeusername).then(function(user) {
                                                  if(user.noticriados == '1'){
                                                  $scope.pushnoti.titulo = 'Desisti';
                                                  $scope.pushnoti.msg = $scope.aux.username + ' desistiu de ir no seu evento';
                                                  $scope.pushnoti.token = user.devicetoken;
                                                   EventoService.MandaPushNoti($scope.pushnoti);
                                                 }
                                                });
                                              }
                                            });
                                            $http.post("https://ec2.diwoapp.com.br/deletanotificacaoporids.php", {id_user_recebe : noti.recebe,
                                                                              id_user_envia: noti.envia,
                                                                              nomeevento: noti.nomeevento,
                                                                              tipo : '1'});
                                                       if(meuestado == 2){
                                                         $scope.evento.patual = parseInt($scope.evento.patual)-1;
                                                        }
                                                    $http.post('https://ec2.diwoapp.com.br/addpessoaevento.php', {idevento : $scope.evento.idevento,
                                                                                                                    patual : $scope.evento.patual});    
                                                    $http.post('https://ec2.diwoapp.com.br/deletapessoaevento.php', {iduser : $scope.aux.iduser,
                                                                                                                        idevento : $scope.evento.idevento});
                                                      $state.go('tabsController.telacomercio');
                                                    }
                                                   }
                                                 ]
                                         })
                }



            }           
            $state.reload();
  }
  
}])

.controller('CriaEventoViaComercioCtrl', ['$scope', '$stateParams', 'formEvento', '$state','$ionicPopup', '$timeout', 'formDataEscolhida', 'formItem', 'EventoService', 'formUser', 'formComercio','$http', '$cordovaCamera', '$cordovaFile', '$cordovaFileTransfer', '$cordovaDevice',  '$ionicLoading', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, formEvento, $state, $ionicPopup, $timeout, formDataEscolhida, formItem, EventoService, formUser, formComercio, $http, $cordovaCamera, $cordovaFile, $cordovaFileTransfer, $cordovaDevice,  $ionicLoading) {
  $scope.comercio = {};
  $scope.evento = {};
  $scope.comercio = formComercio.getForm();
  $scope.dataescolhida = formDataEscolhida.getForm();
  $scope.user = formUser.getForm();
  $scope.evento.dificuldade="Qual a dificuldade do evento?";
  $scope.evento.pmax = parseInt($scope.comercio.pmax);
  $scope.evento.eventopic = $scope.comercio.fotocomercio;
  $scope.evento.descricao = '';
  var noti = {};
  var mudoufoto = false;
  $scope.pushnoti = {};
  $scope.auxfoto = '';
  $scope.limiteconfirmacao ={};
  $scope.fim = {};
  $scope.inicio = {};
  $scope.dataescolhida.diainicio = '2019/'+$scope.dataescolhida.dia[3]+$scope.dataescolhida.dia[4]+'/'+$scope.dataescolhida.dia[0]+$scope.dataescolhida.dia[1]+' '+$scope.dataescolhida.horarioescolhido
  var currentdate = new Date($scope.dataescolhida.diainicio);
  //var currentdate = new Date(); 
  var curr_date = (currentdate.getDate()<10?'0':'') + currentdate.getDate();
  var curr_month = (currentdate.getMonth()<9?'0':'') + (currentdate.getMonth() + 1); //Months are zero based
  var curr_year = currentdate.getFullYear();
  var curr_h = (currentdate.getHours()<10?'0':'') + currentdate.getHours();
  var curr_m = (currentdate.getMinutes()<10?'0':'') + currentdate.getMinutes();
  var curr_j = curr_year + "-" + curr_month + "-" + curr_date+ ' '+curr_h + ':' + curr_m + ':' + '00';
  
  $scope.evento.diainicio = curr_j;
  $scope.evento.semana = currentdate.getDay();

  var currentdatefim = new Date($scope.dataescolhida.diainicio);
  currentdatefim.setTime(currentdatefim.getTime() + (1*60*60*1000));
  var curr_datefim = (currentdatefim.getDate()<10?'0':'') + currentdatefim.getDate();
  var curr_monthfim = (currentdatefim.getMonth()<9?'0':'') + (currentdatefim.getMonth() + 1); //Months are zero based
  var curr_yearfim = currentdatefim.getFullYear();
  var curr_hfim = (currentdatefim.getHours()<10?'0':'') + currentdatefim.getHours();
  var curr_mfim = (currentdatefim.getMinutes()<10?'0':'') + currentdatefim.getMinutes();
  var curr_jfim = curr_yearfim + "-" + curr_monthfim + "-" + curr_datefim+ ' '+curr_hfim + ':' + curr_mfim + ':' + '00';
  
  $scope.evento.diafim = curr_j;
  
  var currentdatelimiteconfirmacao = new Date($scope.dataescolhida.diainicio);
  currentdatelimiteconfirmacao.setTime(currentdatelimiteconfirmacao.getTime() - (3*60*60*1000));
  var curr_datelimiteconfirmacao = (currentdatelimiteconfirmacao.getDate()<10?'0':'') + currentdatelimiteconfirmacao.getDate();
  var curr_monthlimiteconfirmacao = (currentdatelimiteconfirmacao.getMonth()<9?'0':'') + (currentdatelimiteconfirmacao.getMonth() + 1); //Months are zero based
  var curr_yearlimiteconfirmacao = currentdatelimiteconfirmacao.getFullYear();
  var curr_hlimiteconfirmacao = (currentdatelimiteconfirmacao.getHours()<10?'0':'') + currentdatelimiteconfirmacao.getHours();
  var curr_mlimiteconfirmacao = (currentdatelimiteconfirmacao.getMinutes()<10?'0':'') + currentdatelimiteconfirmacao.getMinutes();
  var curr_jlimiteconfirmacao = curr_yearlimiteconfirmacao + "-" + curr_monthlimiteconfirmacao + "-" + curr_datelimiteconfirmacao+ ' '+curr_hlimiteconfirmacao + ':' + curr_mlimiteconfirmacao + ':' + '00';
  
  $scope.evento.dialimiteconfirmacao = curr_jlimiteconfirmacao;
  
  $scope.mudafotoevento = function (optionsCamera) {
    var optionsCamera = {
          quality : 100,
          sourceType : 0,
          allowEdit : true,
          targetWidth: 640,
          targetHeight: 640
    };
    $cordovaCamera.getPicture(optionsCamera).then(function(imageData) {
      $scope.imgURI = imageData;
      $scope.evento.eventopic = imageData;
      mudoufoto = true;
    }, function(err) {
      console.log(err);
    });
    
  }

  $scope.evento.genero = "todos";

  // $scope.ch = function(){
  //   if($scope.evento.dificuldaden == 1){
  //     $scope.evento.dificuldade = "Não importa";
  //   }
  //   if($scope.evento.dificuldaden == 2){
  //     $scope.evento.dificuldade = "Fácil";
  //   }
  //   if($scope.evento.dificuldaden == 3){
  //     $scope.evento.dificuldade = "Moderado";
  //   }
  //   if($scope.evento.dificuldaden == 4){
  //     $scope.evento.dificuldade = "Difícil";
  //   }
  // }

  $scope.$on("$ionicView.enter", function(event, data){
    $scope.user = formUser.getForm();
    if(!$scope.user.telefone || $scope.user.telefone == '0'){

        var myPopup = $ionicPopup.show({
          template: '<input type="text" placeholder="Digite seu número de celular" ng-model="user.telefone">',
          title: 'Oiiie',
          subTitle: 'Preciso de um número de telefone para caso eu precise me comunicar com você sobre esse local se necessário ou vice-versa',
          scope: $scope,
          buttons: [
            { text: 'Cancelar' },
            {
              text: '<b>Confirma</b>',
              type: 'button-positive',
              onTap: function(e) {
                console.log($scope.user.telefone)
                $http.post('https://ec2.diwoapp.com.br/atualizatelefone.php', {iduser : $scope.user.iduser, 
                                  telefone :$scope.user.telefone}).then(function (res){
                    $scope.responsecriado = res.data;
                  });
              }
            }]
          })
      }
   });

    $scope.salvar = function(evento){

      if($scope.evento.semana == 0){
        $scope.evento.semana = "Domingo";
      }
      if($scope.evento.semana == 1){
        $scope.evento.semana = "Segunda-feira";
      }
      if($scope.evento.semana == 2){
        $scope.evento.semana = "Terça-feira";
      }
      if($scope.evento.semana == 3){
        $scope.evento.semana = "Quarta-feira";
      }
      if($scope.evento.semana == 4){
        $scope.evento.semana = "Quinta-feira";
      }
      if($scope.evento.semana == 5){
        $scope.evento.semana = "Sexta-feira";
      }
      if($scope.evento.semana == 6){
        $scope.evento.semana = "Sábado";
      }
      if ($scope.evento.nomeevento == '') {
        var alertPopup = $ionicPopup.alert({
          title: 'ʕ•ᴥ•ʔ',
          template: 'Coloque um titulo válido'
        });
      }else{
        if($scope.evento.descricao == ''){
          var alertPopup = $ionicPopup.alert({
            title: 'ʕ•ᴥ•ʔ',
            template: 'Escreva algo sobre como vai ser esse evento para as pessoas entenderem um pouco mais'
          });
        }else{
          if(mudoufoto == true){
              if($scope.imgURI != $scope.comercio.fotocomercio){ 
                $scope.auxfoto = $scope.evento.nomeevento + $scope.evento.diainicio;
                var mystring = String($scope.auxfoto);
                mystring = mystring.replace(/[^a-zA-Z0-9]/g, '');
                $scope.evento.eventopic = 'https://s3.amazonaws.com/diwoappprofilepics/eventopicsdiwo/' + mystring + '.jpg';
              }else{
                 $scope.evento.eventopic = $scope.comercio.fotocomercio;
              }
              var url = "https://ec2.diwoapp.com.br/uploadfotoevento.php";
                                      // File for Upload
              var targetPath = $scope.imgURI;
             
              // File name only
              //var name = $scope.imgURI.substr(imageData.lastIndexOf('/') + 1);
              var filename = mystring + '.jpg';
              // NO CASO SERIA O NOME DO USUARIO.jpg O fileName
              var options = {
                fileKey: "file",
                fileName: filename,
                chunkedMode: false,
                mimeType: "multipart/form-data"
              };
              $cordovaFileTransfer.upload(url, targetPath, options).then(function(result) {
                var link = 'https://ec2.diwoapp.com.br/criareventonocomercio.php';
                $http.post(link, {nomeevento : $scope.evento.nomeevento, 
                                  duracao : '02:00',
                                  diainicio : $scope.evento.diainicio,
                                  semana : $scope.evento.semana,
                                  diafim : $scope.evento.diafim,
                                  dialimiteconfirmacao: $scope.evento.dialimiteconfirmacao,
                                  pmin : $scope.comercio.pmin, 
                                  patual : 1, 
                                  pmax : $scope.comercio.pmax,
                                  adm : $scope.user.iduser,
                                  admusername : $scope.user.username,
                                  admapelido : $scope.user.apelido,
                                  preco : $scope.comercio.preco,
                                  precopor : $scope.comercio.precopor,  
                                  nomelocal : $scope.comercio.nomecomercio,
                                  endereco : $scope.comercio.endereco,
                                  cidade : $scope.comercio.cidade,
                                  lat : $scope.comercio.lat,
                                  lng : $scope.comercio.lng,
                                  dificuldade :$scope.evento.dificuldade,
                                  genero : $scope.evento.genero,
                                  eventopic : $scope.evento.eventopic,
                                  descricao : $scope.evento.descricao,
                                  comerciodevicetoken : $scope.comercio.comerciotoken,
                                  tipodeevento: 'comercio',
                                  idComercioParceiro: $scope.comercio.iduser,
                                  comerciodevicetoken:$scope.comercio.comerciotoken,
                                  descontopacote : $scope.comercio.descontopacote}).then(function (res){
                    $scope.responsecriado = res.data;
                    console.log(res.data.success, "criou");
                if ($scope.responsecriado.success == true) {
                  var link = 'https://ec2.diwoapp.com.br/irevento.php';
                  $http.post(link, {idevento : $scope.responsecriado.last, 
                                    iduser : $scope.user.iduser,
                                    idadm : $scope.user.iduser,
                                    admusername : $scope.user.username,  
                                    diainicio : $scope.evento.diainicio,
                                    diafim : $scope.evento.diafim,
                                    username : $scope.user.username,
                                    borda : $scope.user.borda,
                                    apelido : $scope.user.apelido,
                                    profilepic : $scope.user.profilepic,
                                    devicetoken : $scope.user.devicetoken,
                                    confirmacao : "aprovado",
                                    nomeevento :  $scope.evento.nomeevento,
                                    idComercioParceiro : $scope.comercio.iduser, 
                                    eventopic : $scope.evento.eventopic, 
                                    estado :'0'}).then(function (res){
                      $scope.response = res.data;
                      console.log($scope.response);
                      $http.post("https://ec2.diwoapp.com.br/getstalkers.php", {iduser : $scope.user.iduser}).then(function(response) {
                        console.log(response.data[0])
                        if(response.data[0] != 'E'){
                          $scope.auxresp = response.data[0]; 
                          for(var  i = 0 ; i<response.data[0].length;i++){
                            $scope.pushnoti.titulo =$scope.user.apelido + " criou um evento novo";
                            $scope.pushnoti.msg = $scope.user.apelido + " criou um evento novo: " +$scope.evento.nomeevento;
                            $scope.pushnoti.token = $scope.auxresp[i].devicetokenseguidor;
                            EventoService.MandaPushNoti($scope.pushnoti);
                          }
                          var alertPopup = $ionicPopup.alert({
                            title: 'Parabéns',
                            template: $scope.responsecriado.msg
                          }); 
                          alertPopup.then(function(){
                              $state.go('tabsController.telacomercio');
                          })
                        }
                      });
                    })
                  }
                });
              }, function(err) {
                $ionicPopup.alert({
                  title: 'Sorry!',
                  template: 'Aconteceu um probleminha, tente de novo'
                });
                $ionicLoading.hide();
              }, function (progress) {
                $ionicLoading.show({
                  title: '┗(＾0＾)┓',
                  template: '┗(＾0＾)┓'
                });
              });
          }else{
            var link = 'https://ec2.diwoapp.com.br/criareventonocomercio.php';
            $http.post(link, {nomeevento : $scope.evento.nomeevento, 
                                  duracao : '02:00',
                                  diainicio : $scope.evento.diainicio,
                                  semana : $scope.evento.semana,
                                  diafim : $scope.evento.diafim,
                                  dialimiteconfirmacao: $scope.evento.dialimiteconfirmacao,
                                  pmin : $scope.comercio.pmin, 
                                  patual : 1, 
                                  pmax : $scope.comercio.pmax,
                                  adm : $scope.user.iduser,
                                  admusername : $scope.user.username,
                                  admapelido : $scope.user.apelido,
                                  preco : $scope.comercio.preco,
                                  precopor : $scope.comercio.precopor,  
                                  nomelocal : $scope.comercio.nomecomercio,
                                  endereco : $scope.comercio.endereco,
                                  cidade : $scope.comercio.cidade,
                                  lat : $scope.comercio.lat,
                                  lng : $scope.comercio.lng,
                                  dificuldade :$scope.evento.dificuldade,
                                  genero : $scope.evento.genero,
                                  eventopic : $scope.evento.eventopic,
                                  descricao : $scope.evento.descricao,
                                  comerciodevicetoken : $scope.comercio.comerciotoken,
                                  tipodeevento: 'comercio',
                                  idComercioParceiro: $scope.comercio.iduser,
                                  comerciodevicetoken:$scope.comercio.comerciotoken,
                                  descontopacote : $scope.comercio.descontopacote}).then(function (res){
                    $scope.responsecriado = res.data;
                    
              if ($scope.responsecriado.success == true) {
                console.log(res.data.success, "criou", $scope.responsecriado.last);
                var link = 'https://ec2.diwoapp.com.br/irevento.php';
                $http.post(link, {idevento : $scope.responsecriado.last, 
                                    iduser : $scope.user.iduser,
                                    idadm : $scope.user.iduser,
                                    admusername : $scope.user.username,  
                                    diainicio : $scope.evento.diainicio,
                                    diafim : $scope.evento.diafim,
                                    username : $scope.user.username,
                                    borda : $scope.user.borda,
                                    apelido : $scope.user.apelido,
                                    profilepic : $scope.user.profilepic,
                                    devicetoken : $scope.user.devicetoken,
                                    nomeevento :  $scope.evento.nomeevento,
                                    confirmacao : "aprovado",
                                    idComercioParceiro : $scope.comercio.iduser, 
                                    eventopic : $scope.evento.eventopic, 
                                    estado :'0'}).then(function (res){
                    $scope.response = res.data;
                  console.log($scope.response, "$scope.response ");
                  $http.post("https://ec2.diwoapp.com.br/getstalkers.php", {iduser : $scope.user.iduser}).then(function(response) {
                    console.log(response.data[0])
                    if(response.data[0] != 'E'){
                      $scope.auxresp = response.data[0]; 
                      for(var  i = 0 ; i<response.data[0].length;i++){
                        $scope.pushnoti.titulo =$scope.user.apelido + " criou um evento novo";
                        $scope.pushnoti.msg = $scope.user.apelido + " criou um evento novo: " +$scope.evento.nomeevento;
                        $scope.pushnoti.token = $scope.auxresp[i].devicetokenseguidor;
                        EventoService.MandaPushNoti($scope.pushnoti);
                      }
                      var alertPopup = $ionicPopup.alert({
                        title: 'Parabéns',
                        template: $scope.responsecriado.msg
                      }); 
                      alertPopup.then(function(){
                         $state.go('tabsController.TelaComercio');
                      })
                     }
                  });
                })
              }
            });
            }
              
        }  
      }
    }
  

}])

.controller('ver_onde_mapa_ComercioCtrl', ['$scope', '$stateParams', '$cordovaGeolocation', '$state', '$ionicLoading', 'formComercio',  // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, $cordovaGeolocation, $state, $ionicLoading, formComercio) {
  $scope.comercio = formComercio.getForm();
  //$scope.coord = {};
  console.log($scope.comercio.lat);
  console.log($scope.comercio.lng);
        
        var latlng = {lat: parseFloat($scope.comercio.lat), lng: parseFloat($scope.comercio.lng)};


        var mapOptions = {
                center: latlng,
                zoom: 16,
                mapTypeId: google.maps.MapTypeId.ROADMAP
            };          
             

        var map = new google.maps.Map(document.getElementById("map_canvas2"), mapOptions); 
        var geocoder = new google.maps.Geocoder;
        var infowindow = new google.maps.InfoWindow({
                                                      maxWidth: 200
                                                    });

        geocoder.geocode({'location': latlng}, function(results, status) {
          if (status === 'OK') {
            if (results[1]) {
              var marker = new google.maps.Marker({
                position: latlng,
                map: map,
                title: "Borai",
                icon: 'http://maps.google.com/mapfiles/ms/icons/green-dot.png',
                animation: google.maps.Animation.DROP 
              });
              infowindow.setContent(results[0].formatted_address);
              infowindow.open(map, marker);
            } else {
              window.alert('No results found');
            }
          } else {
            window.alert('Geocoder failed due to: ' + status);
          }
        });

        $scope.map = map;  
             
}])

.controller('newCtrl', ['$scope', '$stateParams', '$state', 'EventoService', '$cordovaCamera', '$cordovaFile', '$cordovaFileTransfer', '$cordovaDevice', '$ionicPopup', '$cordovaActionSheet','$ionicLoading','$http','formCodigo', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, $state, EventoService, $cordovaCamera, $cordovaFile, $cordovaFileTransfer, $cordovaDevice, $ionicPopup, $cordovaActionSheet,$ionicLoading,$http,formCodigo) {
  $scope.user = {
    email: '',
    username: '',
    password: '',
    apelido: '',
    idade: '',
    genero: 'masc',
    profilepic: '',
    devicetoken: '123'
  };
  $scope.codigo = formCodigo.getForm();
  $scope.imgURI = "img/pessoasn/perfil.png";
  $scope.codd = false;

    var username;
    var password;
    var personalname;
    var poolData;
    var nickname;

    
    var header = document.getElementById("barsexo");
    var btns = header.getElementsByClassName("btnsex");
    for (var i = 0; i < btns.length; i++) {
      btns[i].addEventListener("click", function() {
        var current = document.getElementsByClassName("act");
        current[0].className = current[0].className.replace(" act", "");
        this.className += " act";
      });
    }
    $scope.macho = function() {$scope.user.genero = 'masc'};
    $scope.femea = function() {$scope.user.genero = 'fem'};
    $scope.takePicture = function() {
      var optionsCamera = {
          quality : 100,
          destinationType : Camera.DestinationType.FILE_URL,
          sourceType : Camera.PictureSourceType.CAMERA,
          allowEdit : true,
          encodingType: Camera.EncodingType.JPEG,
          targetWidth: 640,
          targetHeight: 640,
          popoverOptions: CameraPopoverOptions,
          saveToPhotoAlbum: true
      };

      $cordovaCamera.getPicture(optionsCamera).then(function(imageData) {
          $scope.imgURI = imageData;
          
      }, function(err) {
      });
    }
    $scope.getPicture = function (optionsCamera) {
      var optionsCamera = {
            quality : 100,
            sourceType : 0,
            allowEdit : true,
            targetWidth: 640,
            targetHeight: 640
      };
      $cordovaCamera.getPicture(optionsCamera).then(function(imageData) {
        $scope.imgURI = imageData;
      }, function(err) {
        console.log(err);
      });
    };
    
  $scope.signup = function() {
      var palavrasnaousar = ["ALIAMBA", "ANUS", "BAGULIO"
      , "BANZA", "BARRUFO", "BECK", "BEQUE", "BOCETA"
      , "BOLAGATO", "BOQUETE", "BOLCAT", "BOSSETA", "BOSTANA", "BREXA", "BRIOCO", "BRONHA", "BUCA", "BUCETA"
      , "BUSSETA", "CANABIS", "CANNABIS", "CARALHO"
      , "CASSETA", "CASSETE", "CHECHECA", "CHERECA", "CHIBUMBA", "CHIBUMBO", "CHOTA", "CHOCHOTA", "CHUPADA", "CHUPADO", "CLITORIS"
      , "COCAINA", "C+"
      , "C*", "CURALHO", "CUZAO", "CUZUDA", "CUZUDO", "CUZÃO", "ESPORRADA", "ESPORRADO", "ESPORRO", "estupro"
      , "FELACAO", "FELACÃO", "FODA", "FODAO", "FODÃO", "FODAUM", "FODE", "FODIDA", "FODIDO", "FORNICA", "FUDENDO", "FUDECÃO", "FUDECAO"
      , "FUDIDA", "FUDIDO", "GRELINHO", "GRELO", "ISCROTA", "ISCROTO", "MACONHA", "MASTURBA", "MASTURBAÇÃO", "MASTURBACÃO", "MASTURBACAO"
      , "PENIS", "PEN1S", "PENES", "PENIZ", "PICA", "PIROCA", "PIRU", "PORRA", "POURRA", "PROSTIBULO", "PUTA", "PUNHETA", "PUTO"
      , "RABAO", "TESTUDA", "TESTUDO", "VAGABUNDA", "VAGINA", "VIADO", "VIADAO", "VIADÃO", "XAVASCA", "XERERECA", "XEXECA", "XOTA"
      , "XOCHOTA", "XOXOTA", "XANA", "XANINHA", "MDMA", "VSF", "TNC", "FDP", "CRACK"];
      var error = 0; 
      for (var i = 0; i < palavrasnaousar.length; i++) {
        var res2 = $scope.user.username.split("_") ;
        if(res2.length>1){
          for(var w = 0; w < res2.length; w++){
            var val = palavrasnaousar[i].toLowerCase();
            if ((res2[w].toLowerCase()).indexOf(val.toString()) > -1) {  
              error = error + 1;  
            }
          }
        }else{
          var val = palavrasnaousar[i].toLowerCase();  
          if (($scope.user.username.toLowerCase()).indexOf(val.toString()) > -1) {  
            error = error + 1;  
          }
        }   
      } 
      if (error > 0) {  
          var alertPopup = $ionicPopup.alert({
                title: '（・о・；）',
                template: 'Que boquinha suja eim, usaste uma palavra inapropriada né'
              }); 
      }else{  
        if($scope.user.password.length<8){
           var alertPopup = $ionicPopup.alert({
            title: '=//',
            template: 'Senha muito curta'
          });
        }else{
          if($scope.user.idade.valueOf() < 18 ){
         var alertPopup = $ionicPopup.alert({
            title: '=//',
            template: 'Você é muito novo para usar o app'
          });
        }else{
          if ($scope.user.email == '' || $scope.user.username == '' || $scope.user.password == '' || $scope.user.idade == '' ) {
            var alertPopup = $ionicPopup.alert({
              title: 'Campos incompletos',
              template: 'Favor preencher todos os campos de acordo!!'
            });
          }else{
            var res = $scope.user.username.split(" ") ;
            if(res.length>1){
              var alertPopup = $ionicPopup.alert({
                title: 'Username inválido',
                template: 'Não pode haver "espaço" no seu username'
              });
            }else{
              if ($scope.user.password != $scope.user.password2) {
                var alertPopup = $ionicPopup.alert({
                  title: 'ʕノ•ᴥ•ʔノ ︵ ┻━┻',
                  template: 'Senha não bate com a outra'
                });
              }else{
                if($scope.imgURI == "img/pessoasn/perfil.png"){
                  var alertPopup = $ionicPopup.alert({
                    title: '(*ﾟｰﾟ)ゞ',
                    template: 'Tire uma foto para as pessoas saberem quem tu é quando for conhecer elas'
                  });
                }else{

                EventoService.verificausername($scope.user).then(function(result) {
                   if(result.success==false){
                    var alertPopup = $ionicPopup.alert({
                            title: 'ಠ_ಠ',
                            template: 'Ja tem alguem com esse username'
                          });
                   }else{
                $scope.user.apelido = $scope.user.username;
                poolData = {
                    UserPoolId : 'us-east-1_nOWA67ADf', // Your user pool id here
                    ClientId : '8k5rbqhifi5r1hb2j4n1u07li'// Your client id here
                  };    
                var userPool = new AmazonCognitoIdentity.CognitoUserPool(poolData);

                var attributeList = [];
                
                var dataEmail = {
                  Name : 'email', 
                  Value : $scope.user.email, //get from form field
                };
                
                var dataPersonalName = {
                  Name : 'gender', 
                  Value : $scope.user.genero, //get from form field
                };

                var dataPersonalNickname = {
                  Name : 'nickname', 
                  Value : $scope.user.username, //get from form field
                };

                var attributeEmail = new AmazonCognitoIdentity.CognitoUserAttribute(dataEmail);
                var attributePersonalName = new AmazonCognitoIdentity.CognitoUserAttribute(dataPersonalName);
                var attributePersonalNickname = new AmazonCognitoIdentity.CognitoUserAttribute(dataPersonalNickname);
                
                attributeList.push(attributeEmail);
                attributeList.push(attributePersonalName);
                attributeList.push(attributePersonalNickname);
                console.log($scope.user)
               
                userPool.signUp($scope.user.email, $scope.user.password, attributeList, null, function(err, result){
                  if (err) {
                    console.log("ja existe", err.message)
                    if(err.message == "Password did not conform with policy: Password must have uppercase characters"){
                      var alertPopup = $ionicPopup.alert({
                      title: '(҂⌣̀_⌣́)',
                      template: 'Senha precisa ter caracter em maiúsculo'
                    });
                    }
                    if(err.message == "Password did not conform with policy: Password must have lowercase characters"){
                      var alertPopup = $ionicPopup.alert({
                      title: '(ꐦ ಠ皿ಠ )',
                      template: 'Senha precisa ter caracter em minúsculo'
                    });
                    }
                    if(err.message == "Password did not conform with policy: Password not long enough"){
                      var alertPopup = $ionicPopup.alert({
                      title: '(ﾒﾟ皿ﾟ)',
                      template: 'Senha precisa ter 8 caracteres no mínimo'
                    });
                    }
                    if(err.message == "Password did not conform with policy: Password must have numeric characters"){
                      var alertPopup = $ionicPopup.alert({
                        title: '(¬_¬)',
                        template: 'Senha precisa ter número'
                      });
                    }
                    if(err.message == "User already exists"){
                      var alertPopup = $ionicPopup.alert({
                        title: 'ಠ_ಠ',
                        template: 'Ja existe uma conta vinculada a esse email'
                      });
                    }
                    // var alertPopup = $ionicPopup.alert({
                    //   title: 'ಠ_ಠ',
                    //   template: 'Ja existe uma conta vinculada a esse email ou username'
                    // });
                    return;
                  }
                  cognitoUser = result.user;
                  $scope.cognito = result.user;
                  console.log('user name is ' + cognitoUser.getUsername());
                  //change elements of page
                    $ionicPopup.prompt({
                              title: 'Confirmação de email',
                              template: 'Verifique em seu email e escreva aqui o número para validação da sua conta',
                             inputType: 'text',
                             inputPlaceholder: 'XXXXXX'
                           }).then(function(confi) {
                            cognitoUser.confirmRegistration(confi, true, function(err, result) {
                              if (err) {
                                $scope.codd = true;
                                  return;
                                }
                                if(result == "SUCCESS"){
                                  EventoService.confereconvite($scope.codigo).then(function(resp) {
                                    var currentdate = new Date();
                                    currentdate.setDate(currentdate.getDate() - 14);
                                    var curr_date = (currentdate.getDate()<10?'0':'') + currentdate.getDate();
                                    var curr_month = (currentdate.getMonth()<10?'0':'') + (currentdate.getMonth() + 1); 
                                    var curr_year = currentdate.getFullYear();
                                    var h2 = (currentdate.getHours()<10?'0':'') + currentdate.getHours();
                                    var m2 = (currentdate.getMinutes()<10?'0':'') + currentdate.getMinutes();
                                    var j = curr_year + "-" + curr_month + "-" + curr_date+ ' '+h2 + ':' + m2 + ':00';
                                    console.log(j, resp[0].codigodatacriacao)
                                    if(resp[0].codigodatacriacao > j){
                                      resp[0].numcodigo = parseInt(resp[0].numcodigo) + 1
                                      console.log(resp[0].numcodigo)
                                      if(resp[0].numcodigo == 3){
                                              $http.post('https://ec2.diwoapp.com.br/gastapontospessoaevento.php', {idevento : -100,
                                                        iduser : resp[0].iduser,
                                                        borda : '0',
                                                        username: resp[0].username,
                                                        apelido : resp[0].apelido,
                                                        nomeevento :  "Entrou com convite", 
                                                        estado : 10,
                                                        pontos: 10});
                                              $scope.atualiza = {};
                                              var po = resp[0].pontos.valueOf()+10;
                                              $scope.atualiza.pontos = po;
                                              $scope.atualiza.iduser = resp[0].iduser;
                                              EventoService.atualizarpontos($scope.atualiza);
                                            }
                                      $http.post('https://ec2.diwoapp.com.br/somanumcodigo.php', {iduser : resp[0].iduser,
                                                                                                            numcodigo : resp[0].numcodigo});
                                    }
                                });
                                  var mystring = String($scope.user.email);
                                  mystring = mystring.replace(/[^a-zA-Z0-9]/g, '');
                                      $scope.user.profilepic = 'https://diwoappprofilepics.s3.amazonaws.com/profilepicsdiwo/' + mystring + '.jpg';
                                         
                                        //EventoService.CriaConta($scope.user);
                                        EventoService.CriaConta($scope.user).then(function(result) {
                                          if(result.success){
                                            var url = "https://ec2.diwoapp.com.br/upload.php";
                                            // File for Upload
                                            var targetPath = $scope.imgURI;
                                           
                                            // File name only
                                            //var name = $scope.imgURI.substr(imageData.lastIndexOf('/') + 1);
                                            var filename = mystring + '.jpg';

                                            // NO CASO SERIA O NOME DO USUARIO.jpg O fileName
                                            var options = {
                                              fileKey: "file",
                                              fileName: filename,
                                              chunkedMode: false,
                                              mimeType: "multipart/form-data"
                                            };
                                            $cordovaFileTransfer.upload(url, targetPath, options).then(function(result) {
                                              
                                              var alertPopup = $ionicPopup.alert({
                                                title: 'Parabéns',
                                                template: 'Sua conta esta habilitada'
                                              });
                                              alertPopup.then(function(){
                                                $state.go('logando');
                                              });
                                              
                                              $ionicLoading.hide();
                                            }, function(err) {
                                              $ionicPopup.alert({
                                                title: 'Sorry!',
                                                template: 'Aconteceu um probleminha, tente de novo'
                                              });
                                              $ionicLoading.hide();
                                            }, function (progress) {
                                              $ionicLoading.show({
                                                title: '┗(＾0＾)┓',
                                                template: 'DANCE, DANCE, DANCE!!'
                                              });
                                            });
                                          }
                                        });
                                      
                                }else{
                                  var alertPopup = $ionicPopup.alert({
                                      title: 'Código de confirmação incorreto',
                                      template: 'Verifique no seu email novamente o código de confirmação'
                                    });
                                  $scope.codd = true;
                                }
                            });
                    });
                  });       
                  }
                });
                }
              }
            }
          }
        }  
        }
        
      }  
  };
  $scope.ativa = function() {$scope.codd = true;};

  $scope.codigoconfirm = function(codigo) {
    if($scope.user.password.length<8){
      var alertPopup = $ionicPopup.alert({
        title: '=//',
        template: 'Senha muito curta'
      });
    }else{
      if($scope.user.idade.valueOf() < 18 ){
       var alertPopup = $ionicPopup.alert({
          title: '=//',
          template: 'Você é muito novo para usar o app'
        });
      }else{
        if ($scope.user.email == '' || $scope.user.username == '' || $scope.user.password == '' || $scope.user.idade == '' ) {
          var alertPopup = $ionicPopup.alert({
            title: 'Campos incompletos',
            template: 'Favor preencher todos os campos de acordo!!'
          });
        }else{
          var res = $scope.user.username.split(" ") ;
          if(res.length>1){
            var alertPopup = $ionicPopup.alert({
              title: 'Username inválido',
              template: 'Não pode haver "espaço" no seu username'
            });
          }else{
            if ($scope.user.password != $scope.user.password2) {
              var alertPopup = $ionicPopup.alert({
                title: 'ʕノ•ᴥ•ʔノ ︵ ┻━┻',
                template: 'Senha não bate com a outra'
              });
            }else{
              if($scope.imgURI == "img/pessoasn/perfil.png"){
                var alertPopup = $ionicPopup.alert({
                  title: '(*ﾟｰﾟ)ゞ',
                  template: 'Tire uma foto para as pessoas saberem quem tu é quando for conhecer elas'
                });
              }else{
                EventoService.verificausername($scope.user).then(function(result) {
                  if(result.success==false){
                    var alertPopup = $ionicPopup.alert({
                          title: 'ಠ_ಠ',
                          template: 'Ja tem alguem com esse username'
                    });
                  }else{
                  $scope.user.apelido = $scope.user.username;
                  if($scope.cognito){
                    cognitoUser.confirmRegistration(codigo, true, function(err, result) {
                      if (err) {
                          return;
                        }
                        console.log('call result: ' + result);
                        if(result == "SUCCESS"){
                          EventoService.confereconvite($scope.codigo).then(function(resp) {
                                    var currentdate = new Date();
                                    currentdate.setDate(currentdate.getDate() - 14);
                                    var curr_date = (currentdate.getDate()<10?'0':'') + currentdate.getDate();
                                    var curr_month = (currentdate.getMonth()<10?'0':'') + (currentdate.getMonth() + 1); 
                                    var curr_year = currentdate.getFullYear();
                                    var h2 = (currentdate.getHours()<10?'0':'') + currentdate.getHours();
                                    var m2 = (currentdate.getMinutes()<10?'0':'') + currentdate.getMinutes();
                                    var j = curr_year + "-" + curr_month + "-" + curr_date+ ' '+h2 + ':' + m2 + ':00';
                                    console.log(j, resp[0].codigodatacriacao)
                                    if(resp[0].codigodatacriacao > j){
                                      resp[0].numcodigo = parseInt(resp[0].numcodigo) + 1
                                      console.log(resp[0].numcodigo)
                                      if(resp[0].numcodigo == 3){
                                              $http.post('https://ec2.diwoapp.com.br/gastapontospessoaevento.php', {idevento : -100,
                                                        iduser : resp[0].iduser,
                                                        borda : '0',
                                                        username: resp[0].username,
                                                        apelido : resp[0].apelido,
                                                        nomeevento :  "Entrou com convite", 
                                                        estado : 10,
                                                        pontos: 10});
                                              $scope.atualiza = {};
                                              var po = resp[0].pontos.valueOf()+10;
                                              $scope.atualiza.pontos = po;
                                              $scope.atualiza.iduser = resp[0].iduser;
                                              EventoService.atualizarpontos($scope.atualiza);
                                            }
                                      $http.post('https://ec2.diwoapp.com.br/somanumcodigo.php', {iduser : resp[0].iduser,
                                                                                                            numcodigo : resp[0].numcodigo});
                                    }
                                });
                          var mystring = String($scope.user.email);
                                  mystring = mystring.replace(/[^a-zA-Z0-9]/g, '');
                          $scope.user.profilepic = 'https://diwoappprofilepics.s3.amazonaws.com/profilepicsdiwo/' + mystring + '.jpg';                         
                                                      //EventoService.CriaConta($scope.user);
                          EventoService.CriaConta($scope.user).then(function(result) {
                            if(result.success){

                              var url = "https://ec2.diwoapp.com.br/upload.php";
                              // File for Upload
                              var targetPath = $scope.imgURI;
                             
                              // File name only
                              //var name = $scope.imgURI.substr(imageData.lastIndexOf('/') + 1);
                              var filename = mystring + '.jpg';

                              // NO CASO SERIA O NOME DO USUARIO.jpg O fileName
                              var options = {
                                fileKey: "file",
                                fileName: filename,
                                chunkedMode: false,
                                mimeType: "multipart/form-data"
                              };
                              $cordovaFileTransfer.upload(url, targetPath, options).then(function(result) {
                                
                                var alertPopup = $ionicPopup.alert({
                                  title: 'Parabéns',
                                  template: 'Sua conta esta habilitada'
                                });
                                alertPopup.then(function(){
                                  $state.go('logando');
                                });
                                
                                $ionicLoading.hide();
                              }, function(err) {
                                $ionicPopup.alert({
                                  title: 'Sorry!',
                                  template: 'Aconteceu um probleminha, tente de novo'
                                });
                                $ionicLoading.hide();
                              }, function (progress) {
                                $ionicLoading.show({
                                  title: '┗(＾0＾)┓',
                                  template: 'DANCE, DANCE, DANCE!!'
                                });
                              });
                            }
                          });
                        }else{
                          var alertPopup = $ionicPopup.alert({
                              title: 'Código de confirmação incorreto',
                              template: 'Verifique no seu email novamente o código de confirmação'
                            });
                        }
                    });
                  }else{
                    var alertPopup = $ionicPopup.alert({
                                                  title: 'Falta de dados',
                                                  template: 'Não foi possivel confirmar sua conta devido a algum problema com ela. Por favor tente recriar uma nova conta'
                                                });
                  }
                }
              });
              }
            }
          }
        }
      }
    }
  };

  $scope.Reenviar = function() {
    if($scope.cognito){
      cognitoUser.resendConfirmationCode(function(err, result) {
                if (err) {
                    //alert(err);
                    return;
                   }
                   var alertPopup = $ionicPopup.alert({
                    title: 'Deve ter chego',
                    template: 'Foi reenviado no seu email de cadastro outro código de validação, se nao chegou ainda, chegará'
                  });
            });
    }else{
      var alertPopup = $ionicPopup.alert({
                                    title: 'Falta de dados',
                                    template: 'Não foi possivel confirmar sua conta devido a algum problema com ela. Por favor tente recriar uma nova conta'
                                  });
    }
  };

}])



.controller('novahomesemloginCtrl', ['$scope', '$stateParams', 'EventoService', '$timeout',  '$state', '$ionicPopup','formUser', 'formLoc', '$http', 'formCodigo', 'formLimiteatuacao',  // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, EventoService, $timeout, $state,  $ionicPopup, formUser, formLoc, $http, formCodigo, formLimiteatuacao) {

  // $scope.entra = function(){
  //   $state.go("nomeuser");
  // }
  var ncc = 0;

  $scope.criarContaComercio = function(){
    ncc++;
    if(ncc==7){
      var alertPopup = $ionicPopup.alert({
                        title: 'AREA RESTRITA',
                        template: 'Somente para Staff!!!'
                      });
        alertPopup.then(function(){
          ncc = 0;
          $state.go('contacomercioemail');
        });
    }
    
  }
 
  $scope.entracodigo = function(){
    
    $state.go("fuiconvidado");
    
  }
  $scope.naotemcodigo = function(){
    $state.go("logando");
  }

  var criandouser = JSON.parse( window.localStorage.getItem( 'criandouser' ));
    if(criandouser){
      if(!criandouser.confirmado){
        $state.go('novacontausername');
      }else{
        if(!criandouser.username){
          $state.go('novacontausername');
        }else{
          if(!criandouser.genero){
            $state.go('novacontagenero');
          }else{
            if(!criandouser.idade){
              $state.go('novacontaidade');
            }else{
              $state.go('novacontafoto');
            }
          }
        }
      } 
  }

  // var user = JSON.parse( window.localStorage.getItem( 'user' ));
  // //console.log(user,"r")
  // if(user){
  //   formUser.updateForm(user);
  //   if(user.tipodeconta){
  //       if(user.tipodeconta=='comercio'){
  //         if(user.estado == '0'){
  //          $state.go('perfilComercio');
  //         }
  //       }
  //     }else{
  //       $state.go('tabsController.home');
  //     }
  // }
  

  var currentdate = new Date(); 
  var curr_date = (currentdate.getDate()<10?'0':'') + currentdate.getDate();
  var curr_h = (currentdate.getHours()<10?'0':'') + currentdate.getHours();
  

  var ft = 0;
  var ft2 = 0;
  var auxtes =0;
  $scope.amigo = {};
  $scope.lastidevento = 0;

  var pmin;
  var iddoevento;
  var lat;
  var long;
  var myLatlng;
  var spherical; 
  var north; 
  var west; 
  var south; 
  var east;
  var raio;

  $scope.items = [];
  $scope.items.eventopic = '';
  $scope.vezes = 0;
  $scope.faltatempo = [];
  $scope.newItems = [];
  $scope.noMoreItemsAvailable = false;
  $scope.semfeed = false;
  $scope.semloc = false;

  $scope.lastidevento = 0;
  $scope.aux = 0;
  $scope.participantes =[];
  $scope.participantesid = [];
  $scope.auxitems ={};
  $scope.centerPoint = {};
 
 
    $scope.user = {};
    if (navigator.geolocation) {
      navigator.geolocation.getCurrentPosition(successFunction, errorFunction);
    }
    else{
      $scope.semloc = true;
    } 
    function successFunction(position) {
      $scope.semloc = false;
      $scope.semfeed = false;
      raio = 30000*0.71;
      lat  = position.coords.latitude;
      long = position.coords.longitude;
      $scope.user.lat =  position.coords.latitude;
      $scope.user.long =  position.coords.longitude;
      myLatlng = new google.maps.LatLng(lat, long);
      spherical = google.maps.geometry.spherical; 
      north = spherical.computeOffset(myLatlng, raio, 0); 
      west  = spherical.computeOffset(myLatlng, raio, -90); 
      south = spherical.computeOffset(myLatlng, raio, 180); 
      east  = spherical.computeOffset(myLatlng, raio, 90);
      $scope.user.northlat = north.lat();
      $scope.user.westlng = west.lng();
      $scope.user.southlat = south.lat();
      $scope.user.eastlng = east.lng();
      $scope.centerPoint.lat = -26.997799;
      $scope.centerPoint.lng = -48.632733; 
      // $scope.centerPoint.lat = -26.319874;
      // $scope.centerPoint.lng = -48.844225;
      $scope.centerPointKM = 30;
      $scope.LimiteFuncionamentoDiwo = arePointsNear($scope.user, $scope.centerPoint,$scope.centerPointKM );
      formLimiteatuacao.updateForm($scope.LimiteFuncionamentoDiwo);
      console.log($scope.LimiteFuncionamentoDiwo, $scope.user.northlat);
    }

    function errorFunction(){
        //alert("Geocoder failed");
        $scope.semloc = true;
    }

    function arePointsNear(checkPoint, centerPoint, km) {
      var ky = 40000 / 360;
      var kx = Math.cos(Math.PI * centerPoint.lat / 180.0) * ky;
      var dx = Math.abs(centerPoint.lng - $scope.user.long) * kx;
      var dy = Math.abs(centerPoint.lat - $scope.user.lat) * ky;
      return Math.sqrt(dx * dx + dy * dy) <= km;
    }

    
    var currentdate = new Date(); 
    var curr_date = (currentdate.getDate()<10?'0':'') + currentdate.getDate();
    var curr_month = (currentdate.getMonth()<10?'0':'') + (currentdate.getMonth() + 1); 
    var curr_year = currentdate.getFullYear();
    var h2 = (currentdate.getHours()<10?'0':'') + currentdate.getHours();
    var m2 = (currentdate.getMinutes()<10?'0':'') + currentdate.getMinutes();
    var j = curr_year + "-" + curr_month + "-" + curr_date+ ' '+h2 + ':' + m2 + ':00';
    j = j.toLocaleString();
    EventoService.paraenviarnoti(j).then(function(items) {
      if (items[0] != "E"){
        for(var i = 0 ; i<items.length ; i++){
          EventoService.paraenviarnoti2(items[i]);
        }
      }
    });

   EventoService.pushbadge(j).then(function(items) {
      //console.log(items, items[0].n, items.length,"items.length")
      if (items[0] != "E"){
        console.log("pushbadge")
        for(var i = 0 ; i<items.length ; i++){
          //console.log(items[i].n, items[i].iduser, i)
          if(items[i].tag == '#ArteeCultura'){
            $scope.auxpushbadge = {};
            $scope.auxpushbadge.titulo = "Parabéns!!";
            $scope.auxpushbadge.msg = "Você ganhou um novo badge";
            $scope.auxpushbadge.token = items[i].devicetoken;
            $scope.auxpushbadge.iduser = items[i].iduser;
            $scope.auxpushbadge.tipo = "badge";
            if(items[i].n == 1){
              $scope.auxpushbadge.img = "img/badges/Categorias/ArteeCultura/1.png";
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 2){
              $scope.auxpushbadge.img = "img/badges/Categorias/ArteeCultura/1.1.png";
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 3){
              $scope.auxpushbadge.img = "img/badges/Categorias/ArteeCultura/1.2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 4){
              $scope.auxpushbadge.img = "img/badges/Categorias/ArteeCultura/1.3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }

            if(items[i].n == 6){
              $scope.auxpushbadge.img = "img/badges/Categorias/ArteeCultura/2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 8){
              $scope.auxpushbadge.img = "img/badges/Categorias/ArteeCultura/2.1.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 10){
              $scope.auxpushbadge.img = "img/badges/Categorias/ArteeCultura/2.2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 12){
              $scope.auxpushbadge.img = "img/badges/Categorias/ArteeCultura/2.3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }

            if(items[i].n == 15){
              $scope.auxpushbadge.img = "img/badges/Categorias/ArteeCultura/3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 20){
              $scope.auxpushbadge.img = "img/badges/Categorias/ArteeCultura/3.1.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 25 ){
              $scope.auxpushbadge.img = "img/badges/Categorias/ArteeCultura/3.2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 30 ){
              $scope.auxpushbadge.img = "img/badges/Categorias/ArteeCultura/3.3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 50){
              $scope.auxpushbadge.img = "img/badges/Categorias/ArteeCultura/Super.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
          }
          if(items[i].tag == '#Voluntariado'){
            $scope.auxpushbadge = {};
            $scope.auxpushbadge.titulo = "Parabéns!!";
            $scope.auxpushbadge.msg = "Você ganhou um novo badge";
            $scope.auxpushbadge.token = items[i].devicetoken;
            $scope.auxpushbadge.iduser = items[i].iduser;
            $scope.auxpushbadge.tipo = "badge";
            if(items[i].n == 1){
              $scope.auxpushbadge.img = "img/badges/Categorias/Voluntariado/1.png";
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 2){
              $scope.auxpushbadge.img = "img/badges/Categorias/Voluntariado/1.1.png";
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 3){
              $scope.auxpushbadge.img = "img/badges/Categorias/Voluntariado/1.2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 4){
              $scope.auxpushbadge.img = "img/badges/Categorias/Voluntariado/1.3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }

            if(items[i].n == 6){
              $scope.auxpushbadge.img = "img/badges/Categorias/Voluntariado/2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 8){
              $scope.auxpushbadge.img = "img/badges/Categorias/Voluntariado/2.1.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 10){
              $scope.auxpushbadge.img = "img/badges/Categorias/Voluntariado/2.2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 12){
              $scope.auxpushbadge.img = "img/badges/Categorias/Voluntariado/2.3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }

            if(items[i].n == 15){
              $scope.auxpushbadge.img = "img/badges/Categorias/Voluntariado/3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 20){
              $scope.auxpushbadge.img = "img/badges/Categorias/Voluntariado/3.1.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 25 ){
              $scope.auxpushbadge.img = "img/badges/Categorias/Voluntariado/3.2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 30 ){
              $scope.auxpushbadge.img = "img/badges/Categorias/Voluntariado/3.3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 50){
              $scope.auxpushbadge.img = "img/badges/Categorias/Voluntariado/Super.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
          }
          if(items[i].tag == '#Ciclismo'){
            $scope.auxpushbadge = {};
            $scope.auxpushbadge.titulo = "Parabéns!!";
            $scope.auxpushbadge.msg = "Você ganhou um novo badge";
            $scope.auxpushbadge.token = items[i].devicetoken;
            $scope.auxpushbadge.iduser = items[i].iduser;
            $scope.auxpushbadge.tipo = "badge";
            if(items[i].n == 1){
              $scope.auxpushbadge.img = "img/badges/Categorias/Ciclismo/1.png";
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 2){
              $scope.auxpushbadge.img = "img/badges/Categorias/Ciclismo/1.1.png";
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 3){
              $scope.auxpushbadge.img = "img/badges/Categorias/Ciclismo/1.2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 4){
              $scope.auxpushbadge.img = "img/badges/Categorias/Ciclismo/1.3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }

            if(items[i].n == 6){
              $scope.auxpushbadge.img = "img/badges/Categorias/Ciclismo/2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 8){
              $scope.auxpushbadge.img = "img/badges/Categorias/Ciclismo/2.1.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 10){
              $scope.auxpushbadge.img = "img/badges/Categorias/Ciclismo/2.2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 12){
              $scope.auxpushbadge.img = "img/badges/Categorias/Ciclismo/2.3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }

            if(items[i].n == 15){
              $scope.auxpushbadge.img = "img/badges/Categorias/Ciclismo/3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 20){
              $scope.auxpushbadge.img = "img/badges/Categorias/Ciclismo/3.1.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 25 ){
              $scope.auxpushbadge.img = "img/badges/Categorias/Ciclismo/3.2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 30 ){
              $scope.auxpushbadge.img = "img/badges/Categorias/Ciclismo/3.3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 50){
              $scope.auxpushbadge.img = "img/badges/Categorias/Ciclismo/Super.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
          }
          if(items[i].tag == '#Surf'){
            $scope.auxpushbadge = {};
            $scope.auxpushbadge.titulo = "Parabéns!!";
            $scope.auxpushbadge.msg = "Você ganhou um novo badge";
            $scope.auxpushbadge.token = items[i].devicetoken;
            $scope.auxpushbadge.iduser = items[i].iduser;
            $scope.auxpushbadge.tipo = "badge";
            if(items[i].n == 1){
              $scope.auxpushbadge.img = "img/badges/Categorias/Surf/1.png";
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 2){
              $scope.auxpushbadge.img = "img/badges/Categorias/Surf/1.1.png";
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 3){
              $scope.auxpushbadge.img = "img/badges/Categorias/Surf/1.2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 4){
              $scope.auxpushbadge.img = "img/badges/Categorias/Surf/1.3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }

            if(items[i].n == 6){
              $scope.auxpushbadge.img = "img/badges/Categorias/Surf/2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 8){
              $scope.auxpushbadge.img = "img/badges/Categorias/Surf/2.1.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 10){
              $scope.auxpushbadge.img = "img/badges/Categorias/Surf/2.2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 12){
              $scope.auxpushbadge.img = "img/badges/Categorias/Surf/2.3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }

            if(items[i].n == 15){
              $scope.auxpushbadge.img = "img/badges/Categorias/Surf/3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 20){
              $scope.auxpushbadge.img = "img/badges/Categorias/Surf/3.1.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 25 ){
              $scope.auxpushbadge.img = "img/badges/Categorias/Surf/3.2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 30 ){
              $scope.auxpushbadge.img = "img/badges/Categorias/Surf/3.3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 50){
              $scope.auxpushbadge.img = "img/badges/Categorias/Surf/Super.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
          }
          if(items[i].tag == '#Restaurantesebares'){
            $scope.auxpushbadge = {};
            $scope.auxpushbadge.titulo = "Parabéns!!";
            $scope.auxpushbadge.msg = "Você ganhou um novo badge";
            $scope.auxpushbadge.token = items[i].devicetoken;
            $scope.auxpushbadge.iduser = items[i].iduser;
            $scope.auxpushbadge.tipo = "badge";
            if(items[i].n == 1){
              $scope.auxpushbadge.img = "img/badges/Categorias/Restaurantesebares/1.png";
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 2){
              $scope.auxpushbadge.img = "img/badges/Categorias/Restaurantesebares/1.1.png";
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 3){
              $scope.auxpushbadge.img = "img/badges/Categorias/Restaurantesebares/1.2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 4){
              $scope.auxpushbadge.img = "img/badges/Categorias/Restaurantesebares/1.3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }

            if(items[i].n == 6){
              $scope.auxpushbadge.img = "img/badges/Categorias/Restaurantesebares/2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 8){
              $scope.auxpushbadge.img = "img/badges/Categorias/Restaurantesebares/2.1.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 10){
              $scope.auxpushbadge.img = "img/badges/Categorias/Restaurantesebares/2.2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 12){
              $scope.auxpushbadge.img = "img/badges/Categorias/Restaurantesebares/2.3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }

            if(items[i].n == 15){
              $scope.auxpushbadge.img = "img/badges/Categorias/Restaurantesebares/3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 20){
              $scope.auxpushbadge.img = "img/badges/Categorias/Restaurantesebares/3.1.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 25 ){
              $scope.auxpushbadge.img = "img/badges/Categorias/Restaurantesebares/3.2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 30 ){
              $scope.auxpushbadge.img = "img/badges/Categorias/Restaurantesebares/3.3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 50){
              $scope.auxpushbadge.img = "img/badges/Categorias/Restaurantesebares/Super.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
          }
          if(items[i].tag == '#Pets'){
            $scope.auxpushbadge = {};
            $scope.auxpushbadge.titulo = "Parabéns!!";
            $scope.auxpushbadge.msg = "Você ganhou um novo badge";
            $scope.auxpushbadge.token = items[i].devicetoken;
            $scope.auxpushbadge.iduser = items[i].iduser;
            $scope.auxpushbadge.tipo = "badge";
            if(items[i].n == 1){
              $scope.auxpushbadge.img = "img/badges/Categorias/Pets/1.png";
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 2){
              $scope.auxpushbadge.img = "img/badges/Categorias/Pets/1.1.png";
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 3){
              $scope.auxpushbadge.img = "img/badges/Categorias/Pets/1.2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 4){
              $scope.auxpushbadge.img = "img/badges/Categorias/Pets/1.3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }

            if(items[i].n == 6){
              $scope.auxpushbadge.img = "img/badges/Categorias/Pets/2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 8){
              $scope.auxpushbadge.img = "img/badges/Categorias/Pets/2.1.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 10){
              $scope.auxpushbadge.img = "img/badges/Categorias/Pets/2.2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 12){
              $scope.auxpushbadge.img = "img/badges/Categorias/Pets/2.3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }

            if(items[i].n == 15){
              $scope.auxpushbadge.img = "img/badges/Categorias/Pets/3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 20){
              $scope.auxpushbadge.img = "img/badges/Categorias/Pets/3.1.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 25 ){
              $scope.auxpushbadge.img = "img/badges/Categorias/Pets/3.2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 30 ){
              $scope.auxpushbadge.img = "img/badges/Categorias/Pets/3.3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 50){
              $scope.auxpushbadge.img = "img/badges/Categorias/Pets/Super.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
          }
          if(items[i].tag == '#Passeio'){
            $scope.auxpushbadge = {};
            $scope.auxpushbadge.titulo = "Parabéns!!";
            $scope.auxpushbadge.msg = "Você ganhou um novo badge";
            $scope.auxpushbadge.token = items[i].devicetoken;
            $scope.auxpushbadge.iduser = items[i].iduser;
            $scope.auxpushbadge.tipo = "badge";
            if(items[i].n == 1){
              $scope.auxpushbadge.img = "img/badges/Categorias/Passeio/1.png";
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 2){
              $scope.auxpushbadge.img = "img/badges/Categorias/Passeio/1.1.png";
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 3){
              $scope.auxpushbadge.img = "img/badges/Categorias/Passeio/1.2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 4){
              $scope.auxpushbadge.img = "img/badges/Categorias/Passeio/1.3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }

            if(items[i].n == 6){
              $scope.auxpushbadge.img = "img/badges/Categorias/Passeio/2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 8){
              $scope.auxpushbadge.img = "img/badges/Categorias/Passeio/2.1.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 10){
              $scope.auxpushbadge.img = "img/badges/Categorias/Passeio/2.2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 12){
              $scope.auxpushbadge.img = "img/badges/Categorias/Passeio/2.3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }

            if(items[i].n == 15){
              $scope.auxpushbadge.img = "img/badges/Categorias/Passeio/3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 20){
              $scope.auxpushbadge.img = "img/badges/Categorias/Passeio/3.1.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 25 ){
              $scope.auxpushbadge.img = "img/badges/Categorias/Passeio/3.2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 30 ){
              $scope.auxpushbadge.img = "img/badges/Categorias/Passeio/3.3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 50){
              $scope.auxpushbadge.img = "img/badges/Categorias/Passeio/Super.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
          }
          if(items[i].tag == '#Natureza'){
            $scope.auxpushbadge = {};
            $scope.auxpushbadge.titulo = "Parabéns!!";
            $scope.auxpushbadge.msg = "Você ganhou um novo badge";
            $scope.auxpushbadge.token = items[i].devicetoken;
            $scope.auxpushbadge.iduser = items[i].iduser;
            $scope.auxpushbadge.tipo = "badge";
            if(items[i].n == 1){
              $scope.auxpushbadge.img = "img/badges/Categorias/Natureza/1.png";
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 2){
              $scope.auxpushbadge.img = "img/badges/Categorias/Natureza/1.1.png";
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 3){
              $scope.auxpushbadge.img = "img/badges/Categorias/Natureza/1.2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 4){
              $scope.auxpushbadge.img = "img/badges/Categorias/Natureza/1.3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }

            if(items[i].n == 6){
              $scope.auxpushbadge.img = "img/badges/Categorias/Natureza/2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 8){
              $scope.auxpushbadge.img = "img/badges/Categorias/Natureza/2.1.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 10){
              $scope.auxpushbadge.img = "img/badges/Categorias/Natureza/2.2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 12){
              $scope.auxpushbadge.img = "img/badges/Categorias/Natureza/2.3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }

            if(items[i].n == 15){
              $scope.auxpushbadge.img = "img/badges/Categorias/Natureza/3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 20){
              $scope.auxpushbadge.img = "img/badges/Categorias/Natureza/3.1.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 25 ){
              $scope.auxpushbadge.img = "img/badges/Categorias/Natureza/3.2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 30 ){
              $scope.auxpushbadge.img = "img/badges/Categorias/Natureza/3.3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 50){
              $scope.auxpushbadge.img = "img/badges/Categorias/Natureza/Super.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
          }
          if(items[i].tag == '#Musica'){
            $scope.auxpushbadge = {};
            $scope.auxpushbadge.titulo = "Parabéns!!";
            $scope.auxpushbadge.msg = "Você ganhou um novo badge";
            $scope.auxpushbadge.token = items[i].devicetoken;
            $scope.auxpushbadge.iduser = items[i].iduser;
            $scope.auxpushbadge.tipo = "badge";
            if(items[i].n == 1){
              $scope.auxpushbadge.img = "img/badges/Categorias/Musica/1.png";
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 2){
              $scope.auxpushbadge.img = "img/badges/Categorias/Musica/1.1.png";
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 3){
              $scope.auxpushbadge.img = "img/badges/Categorias/Musica/1.2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 4){
              $scope.auxpushbadge.img = "img/badges/Categorias/Musica/1.3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }

            if(items[i].n == 6){
              $scope.auxpushbadge.img = "img/badges/Categorias/Musica/2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 8){
              $scope.auxpushbadge.img = "img/badges/Categorias/Musica/2.1.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 10){
              $scope.auxpushbadge.img = "img/badges/Categorias/Musica/2.2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 12){
              $scope.auxpushbadge.img = "img/badges/Categorias/Musica/2.3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }

            if(items[i].n == 15){
              $scope.auxpushbadge.img = "img/badges/Categorias/Musica/3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 20){
              $scope.auxpushbadge.img = "img/badges/Categorias/Musica/3.1.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 25 ){
              $scope.auxpushbadge.img = "img/badges/Categorias/Musica/3.2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 30 ){
              $scope.auxpushbadge.img = "img/badges/Categorias/Musica/3.3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 50){
              $scope.auxpushbadge.img = "img/badges/Categorias/Musica/Super.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
          }
          if(items[i].tag == '#Jogos'){
            $scope.auxpushbadge = {};
            $scope.auxpushbadge.titulo = "Parabéns!!";
            $scope.auxpushbadge.msg = "Você ganhou um novo badge";
            $scope.auxpushbadge.token = items[i].devicetoken;
            $scope.auxpushbadge.iduser = items[i].iduser;
            $scope.auxpushbadge.tipo = "badge";
            if(items[i].n == 1){
              $scope.auxpushbadge.img = "img/badges/Categorias/Jogos/1.png";
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 2){
              $scope.auxpushbadge.img = "img/badges/Categorias/Jogos/1.1.png";
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 3){
              $scope.auxpushbadge.img = "img/badges/Categorias/Jogos/1.2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 4){
              $scope.auxpushbadge.img = "img/badges/Categorias/Jogos/1.3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }

            if(items[i].n == 6){
              $scope.auxpushbadge.img = "img/badges/Categorias/Jogos/2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 8){
              $scope.auxpushbadge.img = "img/badges/Categorias/Jogos/2.1.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 10){
              $scope.auxpushbadge.img = "img/badges/Categorias/Jogos/2.2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 12){
              $scope.auxpushbadge.img = "img/badges/Categorias/Jogos/2.3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }

            if(items[i].n == 15){
              $scope.auxpushbadge.img = "img/badges/Categorias/Jogos/3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 20){
              $scope.auxpushbadge.img = "img/badges/Categorias/Jogos/3.1.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 25 ){
              $scope.auxpushbadge.img = "img/badges/Categorias/Jogos/3.2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 30 ){
              $scope.auxpushbadge.img = "img/badges/Categorias/Jogos/3.3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 50){
              $scope.auxpushbadge.img = "img/badges/Categorias/Jogos/Super.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
          }
          if(items[i].tag == '#GrupodeEstudos'){
            $scope.auxpushbadge = {};
            $scope.auxpushbadge.titulo = "Parabéns!!";
            $scope.auxpushbadge.msg = "Você ganhou um novo badge";
            $scope.auxpushbadge.token = items[i].devicetoken;
            $scope.auxpushbadge.iduser = items[i].iduser;
            $scope.auxpushbadge.tipo = "badge";
            if(items[i].n == 1){
              $scope.auxpushbadge.img = "img/badges/Categorias/GrupodeEstudos/1.png";
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 2){
              $scope.auxpushbadge.img = "img/badges/Categorias/GrupodeEstudos/1.1.png";
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 3){
              $scope.auxpushbadge.img = "img/badges/Categorias/GrupodeEstudos/1.2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 4){
              $scope.auxpushbadge.img = "img/badges/Categorias/GrupodeEstudos/1.3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }

            if(items[i].n == 6){
              $scope.auxpushbadge.img = "img/badges/Categorias/GrupodeEstudos/2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 8){
              $scope.auxpushbadge.img = "img/badges/Categorias/GrupodeEstudos/2.1.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 10){
              $scope.auxpushbadge.img = "img/badges/Categorias/GrupodeEstudos/2.2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 12){
              $scope.auxpushbadge.img = "img/badges/Categorias/GrupodeEstudos/2.3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }

            if(items[i].n == 15){
              $scope.auxpushbadge.img = "img/badges/Categorias/GrupodeEstudos/3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 20){
              $scope.auxpushbadge.img = "img/badges/Categorias/GrupodeEstudos/3.1.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 25 ){
              $scope.auxpushbadge.img = "img/badges/Categorias/GrupodeEstudos/3.2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 30 ){
              $scope.auxpushbadge.img = "img/badges/Categorias/GrupodeEstudos/3.3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 50){
              $scope.auxpushbadge.img = "img/badges/Categorias/GrupodeEstudos/Super.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
          }
          if(items[i].tag == '#Futebol'){
            $scope.auxpushbadge = {};
            $scope.auxpushbadge.titulo = "Parabéns!!";
            $scope.auxpushbadge.msg = "Você ganhou um novo badge";
            $scope.auxpushbadge.token = items[i].devicetoken;
            $scope.auxpushbadge.iduser = items[i].iduser;
            $scope.auxpushbadge.tipo = "badge";
            if(items[i].n == 1){
              $scope.auxpushbadge.img = "img/badges/Categorias/Futebol/1.png";
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 2){
              $scope.auxpushbadge.img = "img/badges/Categorias/Futebol/1.1.png";
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 3){
              $scope.auxpushbadge.img = "img/badges/Categorias/Futebol/1.2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 4){
              $scope.auxpushbadge.img = "img/badges/Categorias/Futebol/1.3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }

            if(items[i].n == 6){
              $scope.auxpushbadge.img = "img/badges/Categorias/Futebol/2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 8){
              $scope.auxpushbadge.img = "img/badges/Categorias/Futebol/2.1.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 10){
              $scope.auxpushbadge.img = "img/badges/Categorias/Futebol/2.2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 12){
              $scope.auxpushbadge.img = "img/badges/Categorias/Futebol/2.3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }

            if(items[i].n == 15){
              $scope.auxpushbadge.img = "img/badges/Categorias/Futebol/3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 20){
              $scope.auxpushbadge.img = "img/badges/Categorias/Futebol/3.1.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 25 ){
              $scope.auxpushbadge.img = "img/badges/Categorias/Futebol/3.2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 30 ){
              $scope.auxpushbadge.img = "img/badges/Categorias/Futebol/3.3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 50){
              $scope.auxpushbadge.img = "img/badges/Categorias/Futebol/Super.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
          }
          if(items[i].tag == '#FestaseBaladas'){
            $scope.auxpushbadge = {};
            $scope.auxpushbadge.titulo = "Parabéns!!";
            $scope.auxpushbadge.msg = "Você ganhou um novo badge";
            $scope.auxpushbadge.token = items[i].devicetoken;
            $scope.auxpushbadge.iduser = items[i].iduser;
            $scope.auxpushbadge.tipo = "badge";
            if(items[i].n == 1){
              $scope.auxpushbadge.img = "img/badges/Categorias/FestaseBaladas/1.png";
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 2){
              $scope.auxpushbadge.img = "img/badges/Categorias/FestaseBaladas/1.1.png";
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 3){
              $scope.auxpushbadge.img = "img/badges/Categorias/FestaseBaladas/1.2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 4){
              $scope.auxpushbadge.img = "img/badges/Categorias/FestaseBaladas/1.3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }

            if(items[i].n == 6){
              $scope.auxpushbadge.img = "img/badges/Categorias/FestaseBaladas/2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 8){
              $scope.auxpushbadge.img = "img/badges/Categorias/FestaseBaladas/2.1.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 10){
              $scope.auxpushbadge.img = "img/badges/Categorias/FestaseBaladas/2.2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 12){
              $scope.auxpushbadge.img = "img/badges/Categorias/FestaseBaladas/2.3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }

            if(items[i].n == 15){
              $scope.auxpushbadge.img = "img/badges/Categorias/FestaseBaladas/3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 20){
              $scope.auxpushbadge.img = "img/badges/Categorias/FestaseBaladas/3.1.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 25 ){
              $scope.auxpushbadge.img = "img/badges/Categorias/FestaseBaladas/3.2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 30 ){
              $scope.auxpushbadge.img = "img/badges/Categorias/FestaseBaladas/3.3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 50){
              $scope.auxpushbadge.img = "img/badges/Categorias/FestaseBaladas/Super.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
          }
          if(items[i].tag == '#EsportesdePraia'){
            $scope.auxpushbadge = {};
            $scope.auxpushbadge.titulo = "Parabéns!!";
            $scope.auxpushbadge.msg = "Você ganhou um novo badge";
            $scope.auxpushbadge.token = items[i].devicetoken;
            $scope.auxpushbadge.iduser = items[i].iduser;
            $scope.auxpushbadge.tipo = "badge";
            if(items[i].n == 1){
              $scope.auxpushbadge.img = "img/badges/Categorias/EsportesdePraia/1.png";
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 2){
              $scope.auxpushbadge.img = "img/badges/Categorias/EsportesdePraia/1.1.png";
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 3){
              $scope.auxpushbadge.img = "img/badges/Categorias/EsportesdePraia/1.2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 4){
              $scope.auxpushbadge.img = "img/badges/Categorias/EsportesdePraia/1.3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }

            if(items[i].n == 6){
              $scope.auxpushbadge.img = "img/badges/Categorias/EsportesdePraia/2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 8){
              $scope.auxpushbadge.img = "img/badges/Categorias/EsportesdePraia/2.1.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 10){
              $scope.auxpushbadge.img = "img/badges/Categorias/EsportesdePraia/2.2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 12){
              $scope.auxpushbadge.img = "img/badges/Categorias/EsportesdePraia/2.3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }

            if(items[i].n == 15){
              $scope.auxpushbadge.img = "img/badges/Categorias/EsportesdePraia/3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 20){
              $scope.auxpushbadge.img = "img/badges/Categorias/EsportesdePraia/3.1.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 25 ){
              $scope.auxpushbadge.img = "img/badges/Categorias/EsportesdePraia/3.2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 30 ){
              $scope.auxpushbadge.img = "img/badges/Categorias/EsportesdePraia/3.3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 50){
              $scope.auxpushbadge.img = "img/badges/Categorias/EsportesdePraia/Super.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
          }
          if(items[i].tag == '#Danca'){
            $scope.auxpushbadge = {};
            $scope.auxpushbadge.titulo = "Parabéns!!";
            $scope.auxpushbadge.msg = "Você ganhou um novo badge";
            $scope.auxpushbadge.token = items[i].devicetoken;
            $scope.auxpushbadge.iduser = items[i].iduser;
            $scope.auxpushbadge.tipo = "badge";
            if(items[i].n == 1){
              $scope.auxpushbadge.img = "img/badges/Categorias/Danca/1.png";
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 2){
              $scope.auxpushbadge.img = "img/badges/Categorias/Danca/1.1.png";
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 3){
              $scope.auxpushbadge.img = "img/badges/Categorias/Danca/1.2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 4){
              $scope.auxpushbadge.img = "img/badges/Categorias/Danca/1.3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }

            if(items[i].n == 6){
              $scope.auxpushbadge.img = "img/badges/Categorias/Danca/2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 8){
              $scope.auxpushbadge.img = "img/badges/Categorias/Danca/2.1.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 10){
              $scope.auxpushbadge.img = "img/badges/Categorias/Danca/2.2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 12){
              $scope.auxpushbadge.img = "img/badges/Categorias/Danca/2.3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }

            if(items[i].n == 15){
              $scope.auxpushbadge.img = "img/badges/Categorias/Danca/3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 20){
              $scope.auxpushbadge.img = "img/badges/Categorias/Danca/3.1.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 25 ){
              $scope.auxpushbadge.img = "img/badges/Categorias/Danca/3.2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 30 ){
              $scope.auxpushbadge.img = "img/badges/Categorias/Danca/3.3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 50){
              $scope.auxpushbadge.img = "img/badges/Categorias/Danca/Super.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
          }
          if(items[i].tag == '#Conversa'){
            $scope.auxpushbadge = {};
            $scope.auxpushbadge.titulo = "Parabéns!!";
            $scope.auxpushbadge.msg = "Você ganhou um novo badge";
            $scope.auxpushbadge.token = items[i].devicetoken;
            $scope.auxpushbadge.iduser = items[i].iduser;
            $scope.auxpushbadge.tipo = "badge";
            if(items[i].n == 1){
              $scope.auxpushbadge.img = "img/badges/Categorias/Conversa/1.png";
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 2){
              $scope.auxpushbadge.img = "img/badges/Categorias/Conversa/1.1.png";
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 3){
              $scope.auxpushbadge.img = "img/badges/Categorias/Conversa/1.2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 4){
              $scope.auxpushbadge.img = "img/badges/Categorias/Conversa/1.3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }

            if(items[i].n == 6){
              $scope.auxpushbadge.img = "img/badges/Categorias/Conversa/2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 8){
              $scope.auxpushbadge.img = "img/badges/Categorias/Conversa/2.1.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 10){
              $scope.auxpushbadge.img = "img/badges/Categorias/Conversa/2.2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 12){
              $scope.auxpushbadge.img = "img/badges/Categorias/Conversa/2.3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }

            if(items[i].n == 15){
              $scope.auxpushbadge.img = "img/badges/Categorias/Conversa/3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 20){
              $scope.auxpushbadge.img = "img/badges/Categorias/Conversa/3.1.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 25 ){
              $scope.auxpushbadge.img = "img/badges/Categorias/Conversa/3.2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 30 ){
              $scope.auxpushbadge.img = "img/badges/Categorias/Conversa/3.3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 50){
              $scope.auxpushbadge.img = "img/badges/Categorias/Conversa/Super.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
          }

        }if(i == items.length){
          EventoService.finalizarevts(j).then(function(items) {
            if (items[0] != "E"){
              for(var i = 0 ; i<items.length ; i++){
                EventoService.finalizarevts2(items[i]);
              }
            }
          });
        }
      }else{
        EventoService.finalizarevts(j).then(function(items) {
          if (items[0] != "E"){
            for(var i = 0 ; i<items.length ; i++){
              EventoService.finalizarevts2(items[i]);
            }
          }
        });
      }
  });

  // EventoService.finalizarevts(j).then(function(items) {
  //         if (items[0] != "E"){
  //           for(var i = 0 ; i<items.length ; i++){
  //             EventoService.finalizarevts2(items[i]);
  //           }
  //         }
  //       });
   
    EventoService.finalizarsemppl1(j).then(function(items) {
      if (items[0] != "E"){
        for(var i = 0 ; i<items.length ; i++){
          EventoService.finalizarsemppl2(items[i]);
        }
      }
    });

    $scope.$on("$ionicView.enter", function(event, data){
      $scope.noMoreItemsAvailable = false;
      $scope.semfeed = false;
      $scope.semloc = false;
      $scope.items = [];
      $scope.items.eventopic = '';
      $scope.eventocomconhecido =[];
      $scope.eventocomconhecidoidevento =[];
      $scope.participantes =[];
      $scope.participantesid = [];
      var user = JSON.parse( window.localStorage.getItem( 'user' ));
      if(user){
        formUser.updateForm(user);
        if(user.tipodeconta!='comercio'){
          $state.go('tabsController.home');
        }else{
          if(user.estado == '0'){
            $state.go('perfilComercio');
          }
        }
      }
      if (lat){
        console.log("tem lat", $scope.user, lat, $scope.user.northlat)
        EventoService.GetFeedSemLogin($scope.user).then(function(items) {
          if (items != 'E'){
            $scope.semfeed = false;
            ft2 = 0;
            for(var i = 0 ; i<items.length ; i++){
              if(items[i].zone ==  'red' && parseInt(items[i].pmin)> parseInt(items[i].patual) && items[i].estado == '0'){
                 EventoService.Cancelarevento(items[i]);
                console.log('Falta gente para o evento, mas como estamos na redzone vou cancelar', items[i].idevento ,items[i].pmin , items[i].patual);
              }
            }
            $scope.items = items.concat($scope.items);
          }else{
            console.log("sem feed");
            $scope.semfeed = true;
          }
        }); 
      }else{
        if (navigator.geolocation) {
          navigator.geolocation.getCurrentPosition(successFunction, errorFunction);
        }
        else{
          $scope.semloc = true;
        } 
        function successFunction(position) {
          raio = 30000*0.71;
          lat  = position.coords.latitude;
          long = position.coords.longitude;
          $scope.user.lat =  position.coords.latitude;
          $scope.user.long =  position.coords.longitude;
          myLatlng = new google.maps.LatLng(lat, long);
          spherical = google.maps.geometry.spherical; 
          north = spherical.computeOffset(myLatlng, raio, 0); 
          west  = spherical.computeOffset(myLatlng, raio, -90); 
          south = spherical.computeOffset(myLatlng, raio, 180); 
          east  = spherical.computeOffset(myLatlng, raio, 90);
          $scope.user.northlat = north.lat();
          $scope.user.westlng = west.lng();
          $scope.user.southlat = south.lat();
          $scope.user.eastlng = east.lng();
          $scope.semloc = false;
          formLoc.updateForm($scope.user);
           EventoService.GetFeedSemLogin($scope.user).then(function(items) {
            if (items != 'E'){
              $scope.semfeed = false;
              $scope.semfeed = false;
              for(var i = 0 ; i<items.length ; i++){
                if(items[i].zone ==  'red' && parseInt(items[i].pmin) > parseInt(items[i].patual) && items[i].estado == '0'){
                  console.log('Falta gente para o evento, mas como estamos na redzone vou cancelar', items[i].idevento ,items[i].pmin , items[i].patual);
                  EventoService.Cancelarevento(items[i]);
                }
              }
              $scope.items = items.concat($scope.items);
            }else{
              console.log("sem feed");
              $scope.semfeed = true;
            }
          });
          //codeLatLng(lat, long)
        }

        function errorFunction(){
            //alert("Geocoder failed");
            $scope.semloc = true;
        }
        
        }  
      })

  $scope.enterItem =  function(item){
      var alertPopup = $ionicPopup.alert({
                        title: 'Baaahhh',
                        template: 'Para poder ver mais detalhes desse evento sem estar dentro da plataforma'
                      });
        // alertPopup.then(function(){
        //   $state.go('logando');
        // });
  }


}])

.controller('fuiconvidadoCtrl', ['$scope', '$stateParams', '$state', 'EventoService', '$cordovaCamera', '$cordovaFile', '$cordovaFileTransfer', '$cordovaDevice', '$ionicPopup', '$cordovaActionSheet','$ionicLoading','$http','formCodigo', 'formNovaconta', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, $state, EventoService, $cordovaCamera, $cordovaFile, $cordovaFileTransfer, $cordovaDevice, $ionicPopup, $cordovaActionSheet,$ionicLoading,$http,formCodigo, formNovaconta) {
  $scope.codigoconvite = {};

  //cognitoUser = formCognito.getForm();
  
  $scope.Proximo = function() { 
    if( $scope.codigoconvite.convite){
      EventoService.confereconvite($scope.codigoconvite.convite).then(function(resp) {
        if(resp.success == false){
          var alertPopup = $ionicPopup.alert({
            title: 'Código não bate',
            template: 'Ocorreu uma falha!!'
          });
        }else{
            formCodigo.updateForm($scope.codigoconvite.convite);
            $state.go("logando");
        }
      })
    }
    
  };
 
  

}])


.controller('perfilComercioCtrl', ['$scope', '$stateParams', 'formUser','formComercio', 'formLoc', 'EventoService', 'formAux', '$state','$timeout', '$ionicPopup', '$http', 'formOutro', 'formItem', 'formtela', 'formtelanoti', 'formtipologin','formEventoPerfil', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, formUser, formComercio, formLoc, EventoService, formAux, $state, $timeout, $ionicPopup, $http, formOutro, formItem, formtela, formtelanoti, formtipologin, formEventoPerfil) {
  $scope.tipologin = formtipologin.getForm();  
  $scope.comentario = '';
  $scope.pushnoti ={};
  var aux1= 0;
  var aux2= 0;
  var k = 0;
  var noti ={};
  var ultima_noti_data;
  $scope.aux = formUser.getForm();
  EventoService.GetComentariosfeitos($scope.aux).then(function(coments) { //
    aux1 = coments.length;
    $scope.feitos = coments;
  });


  var header = document.getElementById("barperfilComercio");
    var btns = header.getElementsByClassName("btnperfilComercio");
    for (var i = 0; i < btns.length; i++) {
      btns[i].addEventListener("click", function() {
        var current = document.getElementsByClassName("actperfilComercio");
        current[0].className = current[0].className.replace(" actperfilComercio", "");
        this.className += " actperfilComercio";
      });
    }

  EventoService.GetComercioPerfil($scope.aux).then(function(comercio) { //
    formComercio.updateForm(comercio);
  });


  $scope.$on("$ionicView.enter", function(event, data){
      $scope.tipologin = formtipologin.getForm(); 
      $scope.items = [];
      $scope.evento = {};
      $scope.comentariovalido = {};
      $scope.outro ={};
      $scope.primeiro = [];
      $scope.segundo = [];
      $scope.terceiro = [];
      $scope.pushnoti ={};
      $scope.comentario = '';
      $scope.quarto = false;
      var aux1= 0;
      var aux2= 0;
      var k = 0;
      var noti ={};
      var ultima_noti_data;
      $scope.data = {showDelete: false};
      $scope.aux = formUser.getForm();
      $scope.camapanhascriadas  = {};

      

      EventoService.GetComentariosfeitos($scope.aux).then(function(coments) { //
        aux1 = coments.length;
        $scope.feitos = coments;
      });

      EventoService.GetComercioPerfil($scope.aux).then(function(comercio) { //
        formComercio.updateForm(comercio);
      });

      EventoService.GetNotificacoes1($scope.aux).then(function(aux) {
        console.log(aux, "Nododoosoa")
        if(aux == "error"){
          $scope.primeiro = false;
          $scope.segundo = false;
          $scope.terceiro =false;

        }else{
          for (var i = 0; i < 3; i++) {
            console.log(aux[0].tipo)
            if(aux[0] && aux[0]!="error" && aux[0].tipo=="51"){
              $scope.primeiro = aux[0];
              var curr_date = (aux[0].datadecriacao[8]+aux[0].datadecriacao[9]);
              var h2 = (aux[0].datadecriacao[11]+aux[0].datadecriacao[12]);
              h2 = parseInt(h2)-3;
              console.log(h2)
              var m2 = (aux[0].datadecriacao[14]+aux[0].datadecriacao[15]);
              var curr_month = (aux[0].datadecriacao[5]+aux[0].datadecriacao[6]);
              var curr_year = (aux[0].datadecriacao[0]+aux[0].datadecriacao[1]+aux[0].datadecriacao[2]+aux[0].datadecriacao[3]);
              var j = curr_date + "/" + curr_month + "/" + curr_year+ ' '+h2 + ':' + m2;
              $scope.primeiro.datadeenvio = j;
            }else{
               $scope.primeiro = false;
            }
            if(aux[1] && aux[0].tipo=="51"){
              $scope.segundo = aux[1];
              var curr_date = (aux[1].datadecriacao[8]+aux[1].datadecriacao[9]);
              var h2 = (aux[1].datadecriacao[11]+aux[1].datadecriacao[12]);
              h2 = parseInt(h2)-3;
              var m2 = (aux[1].datadecriacao[14]+aux[1].datadecriacao[15]);
              var curr_month = (aux[1].datadecriacao[5]+aux[1].datadecriacao[6]);
              var curr_year = (aux[1].datadecriacao[0]+aux[1].datadecriacao[1]+aux[1].datadecriacao[2]+aux[1].datadecriacao[3]);
              var j = curr_date + "/" + curr_month + "/" + curr_year+ ' '+h2 + ':' + m2;
              $scope.segundo.datadeenvio = j;
            }
            else{
               $scope.segundo = false;
            }
            if(aux[2] && aux[0].tipo=="51"){
              $scope.terceiro = aux[2];
              var curr_date = (aux[2].datadecriacao[8]+aux[2].datadecriacao[9]);
              var h2 = (aux[2].datadecriacao[11]+aux[2].datadecriacao[12]);
              h2 = parseInt(h2)-3;
              var m2 = (aux[2].datadecriacao[14]+aux[2].datadecriacao[15]);
              var curr_month = (aux[2].datadecriacao[5]+aux[2].datadecriacao[6]);
              var curr_year = (aux[2].datadecriacao[0]+aux[2].datadecriacao[1]+aux[2].datadecriacao[2]+aux[2].datadecriacao[3]);
              var j = curr_date + "/" + curr_month + "/" + curr_year+ ' '+h2 + ':' + m2;
              $scope.terceiro.datadeenvio = j;
            }else{
               $scope.terceiro = false;
            }
            if(aux[3]){
              $scope.quarto = true;
            }else{
              $scope.quarto = false;
            }
          }     
        }
        
      });
      

    });
  
  var ncc = 0;

  $scope.criarCampanha = function(){
    // ncc++;
    // if(ncc==7){
      // var alertPopup = $ionicPopup.alert({
      //                   title: 'Lançando Campanha',
      //                   template: 'Você pode só lançar no máximo 4 campanhas em um periodo de 30 dias!' 
      //                 });
      //   alertPopup.then(function(){
      //     ncc = 0;
      //     $state.go('campanhacria');
      //   });
        $state.go('campanhacria');
    //}
    
  }

  $scope.loadReservas = function() {
      $scope.CoisasReservas = true;
      $scope.CoisasPendentes= false;
      $scope.estadobutton = 0;
      $scope.items = [];
      console.log($scope.aux.iduser)
      EventoService.GetReservas($scope.aux).then(function(items) {
        if(items=='E'){
          //$scope.vazio = true;
          $scope.items = [];
        }else{
          //$scope.vazio = false;
          for (var i = 0; i < items.length; i++) {
                var curr_date = (items[i].diainicio[8]+items[i].diainicio[9]);
                var h2 = (items[i].diainicio[11]+items[i].diainicio[12]);
                var m2 = (items[i].diainicio[14]+items[i].diainicio[15]);
                var curr_month = (items[i].diainicio[5]+items[i].diainicio[6]);
                var curr_year = (items[i].diainicio[0]+items[i].diainicio[1]+items[i].diainicio[2]+items[i].diainicio[3]);
                var j = curr_date + "/" + curr_month + "/" + curr_year+ ' '+h2 + ':' + m2;
                items[i].datainicio = j;
                items[i].dia = curr_date+'/'+curr_month;
                items[i].hora = h2+':'+m2;
                console.log(items[i].diainicio)
            }
          $scope.items = items;
          $scope.lastidvestido = $scope.items[0].idevento;
        }
      });
      $scope.noMoreItemsAvailable = false;
  }

  $scope.loadPendentes = function() {
      $scope.CoisasReservas = false;
      $scope.CoisasPendentes = true;
      $scope.estadobutton = 2;
      $scope.items = {};
      console.log($scope.aux.iduser);
      EventoService.GetEventosPendentes($scope.aux).then(function(items) {        
        //console.log(items)
        if(items=='E'){
          //$scope.vazio = true;
          $scope.items = [];
        }else{
          //$scope.vazio = false;
          for (var i = 0; i < items.length; i++) {
                var curr_date = (items[i].diainicio[8]+items[i].diainicio[9]);
                var h2 = (items[i].diainicio[11]+items[i].diainicio[12]);
                var m2 = (items[i].diainicio[14]+items[i].diainicio[15]);
                var curr_month = (items[i].diainicio[5]+items[i].diainicio[6]);
                var curr_year = (items[i].diainicio[0]+items[i].diainicio[1]+items[i].diainicio[2]+items[i].diainicio[3]);
                var j = curr_date + "/" + curr_month + "/" + curr_year+ ' '+h2 + ':' + m2;
                items[i].datainicio = j;
                items[i].dia = curr_date+'/'+curr_month;
                items[i].hora = h2+':'+m2;
            }
          $scope.items = items;
          $scope.lastidvestido = $scope.items[0].idevento;
        }
      });
        
    }


  $scope.enterItem =  function(item){
      formAux.updateAux(item.tipo);
      $http.post('https://ec2.diwoapp.com.br/geteventoporid.php', {idevento : item.idevento}).then(function (result){
        $scope.infoevento = result.data[0];
        formItem.updateForm($scope.infoevento);
        console.log($scope.infoevento.idevento);
      });
    
      if (item.tipo == '51') {
        var alertPopup = $ionicPopup.alert({
          title: 'Campanha Atingiu',
          template: 'Número mínimo de pessoas atingido, agora você pode reservar o horário e avisaremos as pessoas'
        });
        alertPopup.then(function(){
          $http.post('https://ec2.diwoapp.com.br/deletanotificacao.php', {idnotificacao : item.idnotificacao}).then(function (res){
            $scope.response = res.data;
            console.log($scope.response.msg)
            $state.reload();
          });
        })
      }
      if (item.tipo == '1') {
        var alertPopup = $ionicPopup.alert({
          title: 'Querendo ir',
          template: ''
        });
        alertPopup.then(function(){
          $http.post('https://ec2.diwoapp.com.br/deletanotificacao.php', {idnotificacao : item.idnotificacao}).then(function (res){
            $scope.response = res.data;
            console.log($scope.response.msg)
            $state.reload();
          });
        })
      }
   }

  $scope.agendar = function(item){
    console.log(item.idevento);
    if(parseInt(item.patual) >= parseInt(item.pmin)){
      console.log("Pode reservar");
      item.estado = 50;
      item.datamodificacao = new Date();                                    // Reservado
      $http.post('https://ec2.diwoapp.com.br/atualizarevento.php' ,item);
      $scope.items.splice($scope.items.indexOf(item), 1);  
    }else{
      var alertPopup = $ionicPopup.alert({
          title: 'Não atingiu o minimo',
          template: 'Evento ainda não atingiu o minimo de pessoas para acontecer, melhor nao reservar nada caso ele nao aconteça!'
        });
    }
  }

  $scope.cancelar = function(item) {
    if(parseInt(item.patual) >= parseInt(item.pmin)){
      var myPopup = $ionicPopup.show({
        template: '<input type="text" placeholder="Escreva aqui pq nao vai rolar" ng-model="data.desculpa">',
        title: 'ATENÇÃOOOOOO!!!',
        subTitle: 'Este evento ja tem pessoas suficientes interessadas para que ele aconteça, tem certeza que quer cancelar o evento? Se tu realmente cancelar estaremos avisando todos os interessados',
        scope: $scope,
        buttons: [
          { text: 'Não' },
          {
            text: '<b>Sim</b>',
            type: 'button-positive',
            onTap: function(e) {
              var notifica = ("Desisti de fazer o evento, " + $scope.data.desculpa);
              $http.post('https://ec2.diwoapp.com.br/deletanotificacaoporevento.php' , {idevento : item.idevento, nomeevento : item.nomeevento});     
              console.log(item.idevento , "Antes de get")
              EventoService.GetParticipantes(item.idevento).then(function(ppl) {
                for (var i = 0; i < ppl.length; i++) {
                  if ($scope.aux.iduser != ppl[i].iduser) {
                    console.log("GetParticipantes", ppl[i].iduser)
                    noti.recebeusername = ppl[i].username;
                    noti.recebe = ppl[i].iduser;
                    noti.envia = $scope.aux.iduser;
                    noti.tipo = 4;
                    noti.nomeevento = item.nomeevento;
                    EventoService.VerificaNotificacao(noti).then(function(res) {
                      if(res){
                        $http.post('https://ec2.diwoapp.com.br/notificapessoa.php', {notificacao : notifica, 
                              idevento : item.idevento,
                              nomeevento : item.nomeevento,
                              id_user_envia : $scope.aux.iduser,
                              username_envia : $scope.aux.username,
                              apelido_envia : $scope.aux.apelido,
                              tipo : '5',   
                              id_user_recebe : noti.recebe}).then(function (res){
                          $scope.response = res.data;
                          console.log($scope.response.msg, "VerificaNotificacao")
                        });
                        EventoService.getusuario2(noti.recebeusername).then(function(user) {
                          if(user.notiparticipando == '1'){
                          $scope.pushnoti.titulo = item.nomeevento + ' Cancelado';
                          $scope.pushnoti.msg = notifica;
                          $scope.pushnoti.token = user.devicetoken;
                          EventoService.MandaPushNoti($scope.pushnoti);
                        }
                        });
                      }
                    });
                  }
                  $http.post('https://ec2.diwoapp.com.br/deletapessoaevento.php', {iduser : ppl[i].iduser,idevento : item.idevento});
                }
              });
              item.estado = "3";      
              item.datamodificacao = new Date();           
              EventoService.atualizarevento(item);
              $scope.items.splice($scope.items.indexOf(item), 1);  
            }
          }
        ]
      })
    }else{
      var myPopup = $ionicPopup.show({
        template: '<input type="text" placeholder="Escreva aqui pq nao vai rolar" ng-model="data.desculpa">',
        title: 'ATENÇÃOOOOOO!!!',
        subTitle: 'Você esta preste a cancelar seu evento, tens certeza disso? Se tu realmente cancelar estaremos avisando todos os interessados',
        scope: $scope,
        buttons: [
          { text: 'Não' },
          {
            text: '<b>Sim</b>',
            type: 'button-positive',
            onTap: function(e) {
              var notifica = ("Desisti de fazer o evento, " + $scope.data.desculpa);
              $http.post('https://ec2.diwoapp.com.br/deletanotificacaoporevento.php' , {idevento : item.idevento, nomeevento : item.nomeevento});     
              EventoService.GetParticipantes(item.idevento).then(function(ppl) {
                for (var i = 0; i < ppl.length; i++) {
                  if ($scope.aux.iduser != ppl[i].iduser) {
                    noti.recebeusername = ppl[i].username;
                    noti.recebe = ppl[i].iduser;
                    noti.envia = $scope.aux.iduser;
                    noti.tipo = 4;
                    noti.nomeevento = item.nomeevento;
                    EventoService.VerificaNotificacao(noti).then(function(res) {
                      if(res){
                        $http.post('https://ec2.diwoapp.com.br/notificapessoa.php', {notificacao : notifica, 
                              idevento : item.idevento,
                              nomeevento : item.nomeevento,
                              id_user_envia : $scope.aux.iduser,
                              username_envia : $scope.aux.username,
                              apelido_envia : $scope.aux.apelido,
                              tipo : '5',   
                              id_user_recebe : noti.recebe}).then(function (res){
                          $scope.response = res.data;
                          console.log($scope.response.msg, "VerificaNotificacao")
                        });
                        EventoService.getusuario2(noti.recebeusername).then(function(user) {
                          if(user.notiparticipando == '1'){
                          $scope.pushnoti.titulo = item.nomeevento + ' Cancelado';
                          $scope.pushnoti.msg = notifica;
                          $scope.pushnoti.token = user.devicetoken;
                          EventoService.MandaPushNoti($scope.pushnoti);
                        }
                        });
                      }
                    });
                  }
                  $http.post('https://ec2.diwoapp.com.br/deletapessoaevento.php', {iduser : ppl[i].iduser,idevento : item.idevento});
                }
              });
              item.estado = "3";              
              item.datamodificacao = new Date();   
              EventoService.atualizarevento(item);
              $scope.items.splice($scope.items.indexOf(item), 1);  
            }
          }
        ]
      })
    }
  } 


}])

.controller('ComercioStatsCtrl', ['$scope', '$stateParams', 'formUser', 'formLoc', 'EventoService', 'formAux', '$state','$timeout', '$ionicPopup', '$http', 'formOutro', 'formItem', 'formtela', 'formtelanoti', 'formtipologin','formEventoPerfil', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, formUser, formLoc, EventoService, formAux, $state, $timeout, $ionicPopup, $http, formOutro, formItem, formtela, formtelanoti, formtipologin, formEventoPerfil) {
  

  $scope.user = formUser.getForm();
  $scope.periodo = {};
  $scope.periodo.periodo = "Total";
  $scope.periodo.iduser = $scope.user.iduser;
  $scope.eventos = {};
    
    EventoService.GetDadosPorPeriodo($scope.periodo).then(function(items){
      $scope.criados = 0;
      $scope.concluidos = 0;
      $scope.pessoasFelizes = 0;
      $scope.dinheiro = 0;
      $scope.preco = 0;
      //console.log(items);
      if(items!="e"){
        ft2 = 0;
        for(var i = 0 ; i<items.length ; i++){
          //console.log(items[i].estado)
          if(items[i].estado == 0 || items[i].estado == 50){
            $scope.criados++;
          }
          if(items[i].estado == '5'){
            $scope.concluidos++;
          }
          $scope.preco = items[i].preco;
          // if(items[i].estado == 3){
          //   $scope.cancelados++;
          // }
          EventoService.GetParticipantes(items[i].idevento).then(function(tes) {
            for (var j = 0; j < tes.length; j++) {
              if(tes[j].confirmacao == 'finalizado' || tes[j].confirmacao == 'Avaliado'){
                $scope.pessoasFelizes++;
              }
            }
            $scope.dinheiro = $scope.pessoasFelizes * $scope.preco;
          });
        }
        //console.log(items.length)
      }
    });
    // EventoService.GetPersonaComercio($scope.user).then(function(persona){
    //   console.log(persona);
    // });

  $scope.$on("$ionicView.enter", function(event, data){
    EventoService.GetDadosPorPeriodo($scope.periodo).then(function(items){
      $scope.criados = 0;
      $scope.concluidos = 0;
      $scope.pessoasFelizes = 0;
      $scope.dinheiro = 0;
      $scope.preco = 0;
      //console.log(items);
      if(items!="e"){
        ft2 = 0;
        for(var i = 0 ; i<items.length ; i++){
          //console.log(items[i].estado)
          if(items[i].estado == 0 || items[i].estado == 50){
            $scope.criados++;
          }
          if(items[i].estado == '5'){
            $scope.concluidos++;
          }
          $scope.preco = items[i].preco;
          // if(items[i].estado == 3){
          //   $scope.cancelados++;
          // }
          EventoService.GetParticipantes(items[i].idevento).then(function(tes) {
            for (var j = 0; j < tes.length; j++) {
              if(tes[j].confirmacao == 'finalizado' || tes[j].confirmacao == 'Avaliado'){
                $scope.pessoasFelizes++;
              }
            }
            $scope.dinheiro = $scope.pessoasFelizes * $scope.preco;
          });
        }
        //console.log(items.length)
      }
    });
    $scope.masc = 0;
    $scope.fem = 0;
    $scopemascidade = 0;
    $scopefemidade = 0;
    $scope.mascmediaidade = 0;
    $scope.femmediaidade = 0;
    $scope.mascpercent = 0;
    $scope.fempercent = 0;
    EventoService.GetPersonaComercio($scope.user).then(function(persona){
      console.log(persona.length);
      if(persona!='error'){
        for(var i = 0 ;i<persona.length;i++){
          if(persona[i].genero=="masc"){
            $scope.masc++;
            $scopemascidade+= parseInt(persona[i].idade);
          }
          if(persona[i].genero == "fem"){
            $scope.fem++;
            $scopefemidade+= parseInt(persona[i].idade);
          }
        }
        if(i==persona.length){
          $scope.fempercent = ($scope.fem * 100 / persona.length).toFixed(2);
          if($scope.fem>0){
            $scope.femmediaidade = ($scopefemidade / $scope.fem).toFixed(2) ; 
          }
          if($scope.masc > 0){
            $scope.mascmediaidade = ($scopemascidade / $scope.masc).toFixed(2) ;
          }
          $scope.mascpercent = ($scope.masc * 100 / persona.length).toFixed(2);
      
        }
      }
      
    });
  });

  

  $scope.mudaperiodo = function(){
    EventoService.GetDadosPorPeriodo($scope.periodo).then(function(items){
      $scope.criados = 0;
      $scope.concluidos = 0;
      $scope.pessoasFelizes = 0;
      $scope.dinheiro = 0;
      $scope.preco = 0;
      console.log(items);
      if(items!="e"){
        ft2 = 0;
        for(var i = 0 ; i<items.length ; i++){
          console.log(items[i].estado)
          if(items[i].estado == 0 || items[i].estado == 50){
            $scope.criados++;
          }
          if(items[i].estado == '5'){
            $scope.concluidos++;
          }
          $scope.preco = items[i].preco;
          // if(items[i].estado == 3){
          //   $scope.cancelados++;
          // }
          EventoService.GetParticipantes(items[i].idevento).then(function(tes) {
            for (var j = 0; j < tes.length; j++) {
              if(tes[j].confirmacao == 'finalizado' || tes[j].confirmacao == 'Avaliado'){
                $scope.pessoasFelizes++;
              }
            }
            $scope.dinheiro = $scope.pessoasFelizes * $scope.preco;
          });
        }
        console.log(items.length)
      }
    });
  }
}])

.controller('ComercioEditaPerfilCtrl', ['$scope', '$stateParams', 'formUser','formComercio','formLoc','formAux','formItem','formOutro','formtela','formtipologin','formtelanoti',  'EventoService','$ionicPopup', '$timeout','$state', '$cordovaCamera', '$cordovaFile', '$cordovaFileTransfer', '$ionicLoading', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, formUser, formComercio,formLoc,formAux, formItem,formOutro,formtela,formtipologin,formtelanoti, EventoService, $ionicPopup, $timeout, $state, $cordovaCamera, $cordovaFile, $cordovaFileTransfer, $ionicLoading) {

  $scope.user = formUser.getForm();
  $scope.comercio = formComercio.getForm();
  $scope.auxusername = $scope.user.username;
  if(!$scope.imgURI){
    $scope.imgURI = $scope.user.profilepic;
    if(($scope.user.profilepic[8] == 's' && $scope.user.profilepic[9] == '3')||($scope.user.profilepic[8] == 'd' && $scope.user.profilepic[9] == 'i')){
          
    //if($scope.user.profilepic[8] == 's' && $scope.user.profilepic[9] == '3'){
             document.getElementById("imageidEditarComercio").src=$scope.user.profilepic+"?{{getTimeStamp()}}";
           }else{
             document.getElementById("imageidEditarComercio").src=$scope.user.profilepic;
           }
    //document.getElementById("imageidEditar").src=$scope.user.profilepic+"?{{getTimeStamp()}}";
  }


     
      //document.getElementById('pac-searchTextField')[0].setAttribute('data-tap-disabled', true);
  

    $scope.$on("$ionicView.enter", function(event, data){
      
      $scope.user = formUser.getForm();
      $scope.cidade ={};
      $scope.auxusername = $scope.user.username;
      if(!$scope.imgURI){
        $scope.imgURI = $scope.user.profilepic;
        if(($scope.user.profilepic[8] == 's' && $scope.user.profilepic[9] == '3')||($scope.user.profilepic[8] == 'd' && $scope.user.profilepic[9] == 'i')){
    
           document.getElementById("imageidEditar").src=$scope.user.profilepic+"?{{getTimeStamp()}}";
         }else{
           document.getElementById("imageidEditar").src=$scope.user.profilepic;
         }
      }
      if($scope.comercio.preco == 0 || $scope.comercio.preco =="Gratuito"){
        $scope.comercio.preco = "Gratuito";
        $scope.porpessoa = false;
        $scope.porlocal = false;
      }else{
        if($scope.comercio.precopor == 1){
          $scope.porpessoa = true;
          $scope.porlocal = false;
        }else{
          $scope.porpessoa = false;
          $scope.porlocal = true;
        }
      }

      if($scope.comercio.oqtem){
        $scope.auxsemanabutton1 = true;
        $scope.auxsemanabutton2 = true;
        $scope.auxsemanabutton3 = true;
        $scope.auxsemanabutton4 = true;
        $scope.auxsemanabutton5 = true;
        $scope.auxsemanabutton6 = true;
        $scope.auxsemanabutton7 = true;
        var res2 = $scope.comercio.oqtem.split(" ") ;
        if(res2.length>1){
          for(var w = 0; w < res2.length; w++){
            if(res2[w] == 'Arcondicionado'){
              $scope.auxsemanabutton1 = false;
              $scope.auxsemanabutton1aux = true;
            }
            if(res2[w] == 'Areadefumante'){
              $scope.auxsemanabutton2 = false;
              $scope.auxsemanabutton2aux = true;
            }
            if(res2[w] == 'Estacionamento'){
              $scope.auxsemanabutton3 = false;
              $scope.auxsemanabutton3aux = true;
            }
            if(res2[w] == 'Pets'){
              $scope.auxsemanabutton4 = false;
              $scope.auxsemanabutton4aux = true;
            }
            if(res2[w] == 'PNE'){
              $scope.auxsemanabutton5 = false;
              $scope.auxsemanabutton5aux = true;
            }
            if(res2[w] == 'Wifi'){
              $scope.auxsemanabutton6 = false;
              $scope.auxsemanabutton6aux = true;
            }
          }
        }
      }else{
        $scope.auxsemanabutton1aux = false;
        $scope.auxsemanabutton2aux = false;
        $scope.auxsemanabutton3aux = false;
        $scope.auxsemanabutton4aux = false;
        $scope.auxsemanabutton5aux = false;
        $scope.auxsemanabutton6aux = false;
        $scope.auxsemanabutton7aux = false;
        $scope.auxsemanabutton1 = true;
        $scope.auxsemanabutton2 = true;
        $scope.auxsemanabutton3 = true;
        $scope.auxsemanabutton4 = true;
        $scope.auxsemanabutton5 = true;
        $scope.auxsemanabutton6 = true;
        $scope.auxsemanabutton7 = true;
      }
    });

  
  $scope.qmehcomercio = function(){
    $state.go('comercioeditaqmehcomercio')
  }
  $scope.incluso = function(){
    $state.go('comercioeditaincluso')
  }
  $scope.infocomercio = function(){
    $state.go('comercioeditainfocomercio')
  }
  $scope.editalocal = function(){
    $state.go('comercioeditalocal')
  }
  $scope.editatelefone = function(){
    $state.go('comercioeditatelefone')
  }
  $scope.editanome = function(){
    $state.go('comercioeditausername')
  }
  $scope.editafoto = function(){
    $state.go('comercioeditafoto')
  }
  $scope.duracao = function(){
    $state.go('comercioeditaduracao')
  }
  $scope.preco = function(){
    $state.go('comercioeditapreco')
  }
  $scope.nump = function(){
    $state.go('comercioeditanumeropessoas')
  }
  $scope.atendimento = function(){
    $state.go('comercioedtaatendimento')
  }
  $scope.categoria = function(){
    $state.go('comercioeditainteresse')
  }
  $scope.oqtem = function(){
    $state.go('comercioeditaoqtem')
  }
  $scope.descontopacote = function(){
    $state.go('comercioeditadescontopacote')
  }

  $scope.mudasenha = function(){
    $state.go('comerciomudasenha')
  }

  $scope.logout =  function(){
    $scope.user = {};
    $scope.loc = formLoc.getForm();
    formLoc.updateForm();
    formAux.updateAux();
    formUser.updateForm();
    formItem.updateForm();
    formOutro.updateForm();
    formtela.updateForm();
    formtelanoti.updateForm();
    formtipologin.updateForm();
    if($scope.loc){
      $scope.user.lat =  $scope.loc.lat;
      $scope.user.long =  $scope.loc.long;
      $scope.user.northlat = $scope.loc.northlat;
      $scope.user.westlng = $scope.loc.westlng;
      $scope.user.southlat = $scope.loc.southlat;
      $scope.user.eastlng = $scope.loc.eastlng;
      //console.log($scope.loc.eastlng)
    }
    formUser.updateForm($scope.user);
    EventoService.Mudadevice($scope.user);
    window.localStorage.removeItem('user')
    window.localStorage.removeItem('comercio')
    window.localStorage.removeItem('criandocomercio')
    window.localStorage.removeItem('criandouser')
    $state.go('logando');
  }
}])

.controller('comerciomudasenhaCtrl', ['$scope', '$stateParams', 'formUser','formComercio', 'EventoService','$ionicPopup', '$timeout','$state', '$cordovaCamera', '$cordovaFile', '$cordovaFileTransfer', '$ionicLoading', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, formUser, formComercio, EventoService, $ionicPopup, $timeout, $state, $cordovaCamera, $cordovaFile, $cordovaFileTransfer, $ionicLoading) {
  $scope.user = formUser.getForm();
  $scope.comercio = formComercio.getForm();

  $scope.$on("$ionicView.enter", function(event, data){    
    $scope.user = formUser.getForm();
    $scope.comercio = formComercio.getForm();
  });

  $scope.Salvar = function(){
    console.log($scope.user.password, $scope.user.senhaantiga)
    if($scope.user.senhaantiga == $scope.user.password){
      $scope.user.password = $scope.user.senhanova;
      EventoService.mudasenha($scope.user)
      formUser.updateForm($scope.user);
      $state.go('ComercioEditaPerfil');
    }else{
      var alertPopup = $ionicPopup.alert({
        title: 'Erro na senha atual',
        template: 'Senha atual não é igual a digitada'
      });
    }
   
        
  }
}])

.controller('comercioeditainfocomercioCtrl', ['$scope', '$stateParams', 'formUser','formComercio', 'EventoService','$ionicPopup', '$timeout','$state', '$cordovaCamera', '$cordovaFile', '$cordovaFileTransfer', '$ionicLoading', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, formUser, formComercio, EventoService, $ionicPopup, $timeout, $state, $cordovaCamera, $cordovaFile, $cordovaFileTransfer, $ionicLoading) {
  $scope.user = formUser.getForm();
  $scope.comercio = formComercio.getForm();

  $scope.$on("$ionicView.enter", function(event, data){    
    $scope.user = formUser.getForm();
    $scope.comercio = formComercio.getForm();
  });

  $scope.Salvar = function(){
    EventoService.atualizarperfil($scope.user).then(function(msg){
      EventoService.atualizarperfilComercio($scope.comercio);
      formComercio.updateForm($scope.comercio);
      formUser.updateForm($scope.user);
      $state.go('ComercioEditaPerfil');
          }, function(errMsg) {
            var alertPopup = $ionicPopup.alert({
              title: 'Register failed!',
              template: errMsg
            });
            alertPopup.then(function(){
                      $state.go('logando');
            })
          })
  }
}])

.controller('comercioeditaqmehcomercioCtrl', ['$scope', '$stateParams', 'formUser','formComercio', 'EventoService','$ionicPopup', '$timeout','$state', '$cordovaCamera', '$cordovaFile', '$cordovaFileTransfer', '$ionicLoading', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, formUser, formComercio, EventoService, $ionicPopup, $timeout, $state, $cordovaCamera, $cordovaFile, $cordovaFileTransfer, $ionicLoading) {
  $scope.user = formUser.getForm();
  $scope.comercio = formComercio.getForm();

  $scope.$on("$ionicView.enter", function(event, data){    
    $scope.user = formUser.getForm();
    $scope.comercio = formComercio.getForm();
  });

  $scope.Salvar = function(){
    EventoService.atualizarperfil($scope.user).then(function(msg){
      EventoService.atualizarperfilComercio($scope.comercio);
      formComercio.updateForm($scope.comercio);
      formUser.updateForm($scope.user);
      $state.go('ComercioEditaPerfil');
          }, function(errMsg) {
            var alertPopup = $ionicPopup.alert({
              title: 'Register failed!',
              template: errMsg
            });
            alertPopup.then(function(){
                      $state.go('logando');
            })
          })
  }
}])

.controller('comercioeditainclusoCtrl', ['$scope', '$stateParams', 'formUser','formComercio', 'EventoService','$ionicPopup', '$timeout','$state', '$cordovaCamera', '$cordovaFile', '$cordovaFileTransfer', '$ionicLoading', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, formUser, formComercio, EventoService, $ionicPopup, $timeout, $state, $cordovaCamera, $cordovaFile, $cordovaFileTransfer, $ionicLoading) {
  $scope.user = formUser.getForm();
  $scope.comercio = formComercio.getForm();

  $scope.$on("$ionicView.enter", function(event, data){    
    $scope.user = formUser.getForm();
    $scope.comercio = formComercio.getForm();
  });

  $scope.Salvar = function(){
    EventoService.atualizarperfil($scope.user).then(function(msg){
      EventoService.atualizarperfilComercio($scope.comercio);
      formComercio.updateForm($scope.comercio);
      formUser.updateForm($scope.user);
      $state.go('ComercioEditaPerfil');
          }, function(errMsg) {
            var alertPopup = $ionicPopup.alert({
              title: 'Register failed!',
              template: errMsg
            });
            alertPopup.then(function(){
                      $state.go('logando');
            })
          })
  }
}])

.controller('comercioeditalocalCtrl', ['$scope', '$stateParams','$cordovaGeolocation', 'formUser','formComercio', 'EventoService','$ionicPopup', '$timeout','$state', '$cordovaCamera', '$cordovaFile', '$cordovaFileTransfer', '$ionicLoading', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams,$cordovaGeolocation, formUser, formComercio, EventoService, $ionicPopup, $timeout, $state, $cordovaCamera, $cordovaFile, $cordovaFileTransfer, $ionicLoading) {
  $scope.user = formUser.getForm();
  $scope.comercio = formComercio.getForm();
  $scope.centerPoint={};
  $scope.LimiteFuncionamentoDiwo = false;
  var lat;
  var long;
  var map;
  var myLatlng;
  var mapOptions;
  var marker;
  var geocoder;
  var infowindow;
  $scope.disableTap = function(){
     container = document.getElementsByClassName('pac-container');
     // disable ionic data tab
     angular.element(container).attr('data-tap-disabled', 'true');
     // leave input field if google-address-entry is selected
     angular.element(container).on("click", function(){
                                   document.getElementById('pac-input').blur();
                                   });
     };
    
    lat  = $scope.comercio.lat;
    long = $scope.comercio.lng;     
    myLatlng = new google.maps.LatLng(lat, long);
    mapOptions = {
          center: myLatlng,
          zoom: 16,
          mapTypeId: google.maps.MapTypeId.ROADMAP
      };          
             
       map = new google.maps.Map(document.getElementById("map_canvas"), mapOptions); 
       marker = new google.maps.Marker({
                position: new google.maps.LatLng(lat, long),
                map: map,
                title: "Borai",
                draggable: true,
                icon: 'http://maps.google.com/mapfiles/ms/icons/green-dot.png',
                animation: google.maps.Animation.DROP 
            })
       geocoder = new google.maps.Geocoder;
       infowindow = new google.maps.InfoWindow({maxWidth: 200});
 
                
      geocoder.geocode({'location': myLatlng}, function(results, status) {
        if (status === 'OK') {
          if (results[1]) {
            $scope.comercio.nomelocal = results[0].address_components[0].long_name;
            $scope.comercio.endereco = results[0].formatted_address;
            for(var i = 0;i<results[0].address_components.length;i++){
              if(results[0].address_components[i].types[0] == "administrative_area_level_2"){
                $scope.comercio.cidade = results[0].address_components[i].long_name;
                console.log($scope.comercio.cidade)
              }
            }
            $scope.comercio.lat = lat;
            $scope.comercio.lng = long;
            infowindow.setContent(results[0].formatted_address);
            infowindow.open(map, marker);
            setTimeout(function () { infowindow.close(); }, 5000);
          } else {
            window.alert('Resultado não encontrado');
          }
        } else {
          window.alert('Ocorreu uma falha doida :' + status);
        }
      });

  $scope.$on("$ionicView.enter", function(event, data){    
    $scope.user = formUser.getForm();
    $scope.comercio = formComercio.getForm();
    var posOptions = {
            enableHighAccuracy: true,
            timeout: 200000,
            maximumAge: 0
        };

    navigator.geolocation.getCurrentPosition(function(position){
          
            lat  = $scope.comercio.lat;
            long = $scope.comercio.lng;
             

            myLatlng = new google.maps.LatLng(lat, long);
             
            mapOptions = {
                center: myLatlng,
                zoom: 16,
                mapTypeId: google.maps.MapTypeId.ROADMAP
            };          
             
            map = new google.maps.Map(document.getElementById("map_canvas"), mapOptions); 


            marker = new google.maps.Marker({
                      position: new google.maps.LatLng(lat, long),
                      map: map,
                      title: "Borai",
                      draggable: true,
                      icon: 'http://maps.google.com/mapfiles/ms/icons/green-dot.png',
                      animation: google.maps.Animation.DROP 
                  })

            geocoder = new google.maps.Geocoder;
            infowindow = new google.maps.InfoWindow({
                                                              maxWidth: 200
                                                            });

            geocoder.geocode({'location': myLatlng}, function(results, status) {
                  if (status === 'OK') {
                    if (results[1]) {
                      $scope.comercio.nomelocal = results[0].address_components[0].long_name;
                      $scope.comercio.endereco = results[0].formatted_address;
                      for(var i = 0;i<results[0].address_components.length;i++){
                        if(results[0].address_components[i].types[0] == "administrative_area_level_2"){
                          $scope.comercio.cidade = results[0].address_components[i].long_name;
                          console.log($scope.comercio.cidade)
                        }
                      }
                      $scope.comercio.lat = lat;
                      $scope.comercio.lng = long;
                      $scope.centerPoint.lat = -26.997799;
                      $scope.centerPoint.lng = -48.632733; 
                      $scope.centerPointKM = 30;
                      $scope.LimiteFuncionamentoDiwo = arePointsNear($scope.comercio, $scope.centerPoint,$scope.centerPointKM );

                      infowindow.setContent(results[0].formatted_address);
                      console.log($scope.comercio.endereco);
                      console.log($scope.comercio.cidade);
                      console.log($scope.comercio.lng);
                      console.log($scope.comercio.lat);
                      //infowindow.setContent(results[0].address_components[2].long_name);
                      infowindow.open(map, marker);
                      setTimeout(function () { infowindow.close(); }, 5000);
                    } else {
                      window.alert('Resultado não encontrado');
          }
        } else {
          window.alert('Ocorreu uma falha doida :' + status);
                  }
                });


            google.maps.event.addListener(marker, "dragstart", function (event) {
               marker.setAnimation(3); // raise
            });

            google.maps.event.addListener(marker, "dragend", function (event) {
               marker.setAnimation(4); // raise
            });

            marker.addListener('dragend', handleEvent);
            google.maps.event.addListener(map, 'click', function(e) {
              
                markers.forEach(function(marker) {
                  marker.setMap(null);
                });
                markers = [];

                placeMarker(e.latLng, map, marker);

            });
            function arePointsNear(checkPoint, centerPoint, km) {
                  var ky = 40000 / 360;
                  var kx = Math.cos(Math.PI * centerPoint.lat / 180.0) * ky;
                  var dx = Math.abs(centerPoint.lng - $scope.comercio.lng) * kx;
                  var dy = Math.abs(centerPoint.lat - $scope.comercio.lat) * ky;
                  return Math.sqrt(dx * dx + dy * dy) <= km;
                }

            function placeMarker(latlng, map, marker) {
                marker.setPosition(latlng);
                marker.setMap(map);
                map.panTo(latlng);
                $scope.comercio.lat = latlng.lat();
                $scope.comercio.lng = latlng.lng();
                $scope.centerPoint.lat = -26.997799;
                $scope.centerPoint.lng = -48.632733; 
                $scope.centerPointKM = 30;
                $scope.LimiteFuncionamentoDiwo = arePointsNear($scope.comercio, $scope.centerPoint,$scope.centerPointKM );
                geocoder.geocode({'location': latlng}, function(results, status) {
                  if (status === 'OK') {
                    if (results[1]) {
                      $scope.comercio.nomelocal = results[0].address_components[0].long_name;
                      for(var i = 0;i<results[0].address_components.length;i++){
                        if(results[0].address_components[i].types[0] == "administrative_area_level_2"){
                          $scope.comercio.cidade = results[0].address_components[i].long_name;
                          console.log($scope.comercio.cidade)
                        }
                      }
                      $scope.comercio.endereco = results[0].formatted_address;
                      infowindow.setContent(results[0].formatted_address);
                     
                      infowindow.open(map, marker);
                      setTimeout(function () { infowindow.close(); }, 5000);
                    } else {
                      window.alert('Resultado não encontrado');
          }
        } else {
          window.alert('Ocorreu uma falha doida :' + status);
                  }
                });
            };        

            function handleEvent(event) {
                $scope.comercio.lat = event.latLng.lat();
                $scope.comercio.lng = event.latLng.lng();
                $scope.centerPoint.lat = -26.997799;
                $scope.centerPoint.lng = -48.632733; 
                $scope.centerPointKM = 30;
                $scope.LimiteFuncionamentoDiwo = arePointsNear($scope.comercio, $scope.centerPoint,$scope.centerPointKM );
                              // GEOCODER INVERSO

                var geocoder = new google.maps.Geocoder;
                var infowindow = new google.maps.InfoWindow({
                                                              maxWidth: 200
                                                            });;    
            
                geocoder.geocode({'location': event.latLng}, function(results, status) {
                  if (status === 'OK') {
                    if (results[1]) {
                      $scope.comercio.nomelocal = results[0].address_components[0].long_name;
                      for(var i = 0;i<results[0].address_components.length;i++){
                        if(results[0].address_components[i].types[0] == "administrative_area_level_2"){
                          $scope.comercio.cidade = results[0].address_components[i].long_name;
                          console.log($scope.comercio.cidade)
                        }
                      }
                      $scope.comercio.endereco = results[0].formatted_address;
                      infowindow.setContent(results[0].formatted_address);
                     
                      infowindow.open(map, marker);
                      setTimeout(function () { infowindow.close(); }, 5000);
                    } else {
                      window.alert('Resultado não encontrado');
          }
        } else {
          window.alert('Ocorreu uma falha doida :' + status);
                  }
                });
            }

                              // GEOCODER INVERSO

                function arePointsNear(checkPoint, centerPoint, km) {
                  var ky = 40000 / 360;
                  var kx = Math.cos(Math.PI * centerPoint.lat / 180.0) * ky;
                  var dx = Math.abs(centerPoint.lng - $scope.comercio.lng) * kx;
                  var dy = Math.abs(centerPoint.lat - $scope.comercio.lat) * ky;
                  return Math.sqrt(dx * dx + dy * dy) <= km;
                }

                
            
                    //        SEARCHBOX

            var input = document.getElementById('pac-input');
            var searchBox = new google.maps.places.SearchBox(input);
        //map.controls[google.maps.ControlPosition.TOP_LEFT].push(input);

        // Bias the SearchBox results towards current map's viewport.
            map.addListener('bounds_changed', function() {
                searchBox.setBounds(map.getBounds());
            });

            var markers = [];
        // Listen for the event fired when the user selects a prediction and retrieve
        // more details for that place.
            searchBox.addListener('places_changed', function() {
                var places = searchBox.getPlaces();

                if (places.length == 0) {
                  return;
                }

                // Clear out the old markers.
                markers.forEach(function(marker) {
                  marker.setMap(null);
                });
                markers = [];

                // For each place, get the icon, name and location.
                var bounds = new google.maps.LatLngBounds();
                places.forEach(function(place) {
                  if (!place.geometry) {
                    console.log("Returned place contains no geometry");
                    return;
                  }
                  markers.push(new google.maps.Marker({
                    map: map,
                    // icon: icon,
                    title: place.name,
                    position: place.geometry.location
                  }));

                  $scope.comercio.nomelocal = place.name;
                  $scope.comercio.endereco = place.formatted_address;
                  for(var i = 0;i<place.address_components.length;i++){
                    //console.log(place.address_components[i].types[0])
                    if(place.address_components[i].types[0] == "administrative_area_level_2"){
                      $scope.comercio.cidade = place.address_components[i].long_name;
                      console.log($scope.comercio.cidade)
                    }
                  }
                  $scope.comercio.lat = place.geometry.location.lat();
                  $scope.comercio.lng = place.geometry.location.lng();
                  $scope.centerPoint.lat = -26.997799;
                  $scope.centerPoint.lng = -48.632733; 
                  $scope.centerPointKM = 30;
                  $scope.LimiteFuncionamentoDiwo = arePointsNear($scope.comercio, $scope.centerPoint,$scope.centerPointKM );
                  if (place.geometry.viewport) {
                    // Only geocodes have viewport.
                    bounds.union(place.geometry.viewport);
                  } else {
                    bounds.extend(place.geometry.location);
                  }
                });
                map.fitBounds(bounds);
            });
            $scope.map = map;  
             
        }, function(err) {
            console.log(err.code);
            console.log(err.message);
        });




  });



  $scope.Salvar = function(){
    EventoService.atualizarperfil($scope.user).then(function(msg){
      EventoService.atualizarperfilComercio($scope.comercio);
      formComercio.updateForm($scope.comercio);
      formUser.updateForm($scope.user);
      $state.go('ComercioEditaPerfil');
          }, function(errMsg) {
            var alertPopup = $ionicPopup.alert({
              title: 'Register failed!',
              template: errMsg
            });
            alertPopup.then(function(){
                      $state.go('logando');
            })
          })
  }
}])
.controller('comercioeditanumeropessoasCtrl', ['$scope', '$stateParams', 'formUser','formComercio', 'EventoService','$ionicPopup', '$timeout','$state', '$cordovaCamera', '$cordovaFile', '$cordovaFileTransfer', '$ionicLoading', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, formUser, formComercio, EventoService, $ionicPopup, $timeout, $state, $cordovaCamera, $cordovaFile, $cordovaFileTransfer, $ionicLoading) {
  $scope.user = formUser.getForm();
  $scope.comercio = formComercio.getForm();

  $scope.$on("$ionicView.enter", function(event, data){    
    $scope.user = formUser.getForm();
    $scope.comercio = formComercio.getForm();
  });

  $scope.menos = function(){
    if($scope.comercio.pmin >2){
      $scope.comercio.pmin--;
    }
  }
  $scope.mais = function(){
    if($scope.comercio.pmin < 49){
      $scope.comercio.pmin++;
      if($scope.comercio.pmin >= $scope.comercio.pmax){
        $scope.comercio.pmax = $scope.comercio.pmin+1;
      }
      
    }
  }

  $scope.menosmax = function(){
    if($scope.comercio.pmax >3){
      $scope.comercio.pmax--;
      if($scope.comercio.pmax <= $scope.comercio.pmin){
        $scope.comercio.pmin = $scope.comercio.pmax-1;
      }
    }
  }
  $scope.maismax = function(){
    if($scope.comercio.pmax < 150){
      $scope.comercio.pmax++;
    }
  }
  

  $scope.Salvar = function(){
      EventoService.atualizarperfilComercio($scope.comercio);
      formComercio.updateForm($scope.comercio);
      formUser.updateForm($scope.user);
      $state.go('ComercioEditaPerfil');
          
          
  }
}])
.controller('comercioeditaprecoCtrl', ['$scope', '$stateParams', 'formUser','formComercio', 'EventoService','$ionicPopup', '$timeout','$state', '$cordovaCamera', '$cordovaFile', '$cordovaFileTransfer', '$ionicLoading', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, formUser, formComercio, EventoService, $ionicPopup, $timeout, $state, $cordovaCamera, $cordovaFile, $cordovaFileTransfer, $ionicLoading) {
  $scope.user = formUser.getForm();
  $scope.comercio = formComercio.getForm();
   if($scope.comercio.precopor == '1'){
      document.getElementById("pessoacomercio").className = "btncomercioperfil actcomercioperfil";
      document.getElementById("horacomercio").className = "btncomercioperfil";
    }
    if($scope.comercio.precopor == '2'){
      document.getElementById("pessoacomercio").className = "btncomercioperfil"
    
      document.getElementById("horacomercio").className = "btncomercioperfil actcomercioperfil";
      
    }

  $scope.$on("$ionicView.enter", function(event, data){    
    $scope.user = formUser.getForm();
    $scope.comercio = formComercio.getForm();
    console.log($scope.comercio.precopor, "$scope.comercio.precopor")
     if($scope.comercio.precopor == '1'){
      document.getElementById("pessoacomercio").className = "btncomercioperfil actcomercioperfil";
      document.getElementById("horacomercio").className = "btncomercioperfil";
    }
    if($scope.comercio.precopor == '2'){
      document.getElementById("pessoacomercio").className = "btncomercioperfil"
    
      document.getElementById("horacomercio").className = "btncomercioperfil actcomercioperfil";
      
    }

  });
   var header = document.getElementById("barcomercioperfil");
  var btns = header.getElementsByClassName("btncomercioperfil");
  for (var i = 0; i < btns.length; i++) {
    btns[i].addEventListener("click", function() {
      var current = document.getElementsByClassName("actcomercioperfil");
      current[0].className = current[0].className.replace(" actcomercioperfil", "");
      this.className += " actcomercioperfil";
    });
  }
  $scope.pessoa = function() {$scope.comercio.precopor = 1;};
  $scope.hora = function() {$scope.comercio.precopor = 2;};

  $scope.Salvar = function(){
    
      EventoService.atualizarperfilComercio($scope.comercio);
      formComercio.updateForm($scope.comercio);
      formUser.updateForm($scope.user);
      $state.go('ComercioEditaPerfil');
         
  }
}])
.controller('comercioeditaduracaoCtrl', ['$scope', '$stateParams', 'formUser','formComercio', 'EventoService','$ionicPopup', '$timeout','$state', '$cordovaCamera', '$cordovaFile', '$cordovaFileTransfer', '$ionicLoading', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, formUser, formComercio, EventoService, $ionicPopup, $timeout, $state, $cordovaCamera, $cordovaFile, $cordovaFileTransfer, $ionicLoading) {

  $scope.comercio = formComercio.getForm();

  $scope.$on("$ionicView.enter", function(event, data){   
    $scope.comercio = formComercio.getForm();
  });

  $scope.Salvar = function(){
      EventoService.atualizarperfilComercio($scope.comercio);
      formComercio.updateForm($scope.comercio);
      $state.go('ComercioEditaPerfil');
         

  }
}])
.controller('comercioeditafotoCtrl', ['$scope', '$stateParams', 'formUser','formComercio', 'EventoService','$ionicPopup', '$timeout','$state', '$cordovaCamera', '$cordovaFile', '$cordovaFileTransfer', '$ionicLoading', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, formUser, formComercio, EventoService, $ionicPopup, $timeout, $state, $cordovaCamera, $cordovaFile, $cordovaFileTransfer, $ionicLoading) {
  $scope.user = formUser.getForm();
  $scope.comercio = formComercio.getForm();
  document.getElementById("imageidEditarComercioPerfil").src = $scope.user.profilepic;
  $scope.$on("$ionicView.enter", function(event, data){    
    $scope.user = formUser.getForm();
    $scope.comercio = formComercio.getForm();
     document.getElementById("imageidEditarComercioPerfil").src = $scope.user.profilepic;
  });

   $scope.takePicture = function() {
      var optionsCamera = {
          quality : 100,
          destinationType : Camera.DestinationType.FILE_URL,
          sourceType : Camera.PictureSourceType.CAMERA,
          allowEdit : true,
          encodingType: Camera.EncodingType.JPEG,
          targetWidth: 640,
          targetHeight: 640,
          popoverOptions: CameraPopoverOptions,
          saveToPhotoAlbum: true
      };

      $cordovaCamera.getPicture(optionsCamera).then(function(imageData) {
          $scope.imgURI2 = imageData;
          $scope.imgURI = $scope.imgURI2;
          var mystring = String($scope.user.email);
          mystring = mystring.replace(/[^a-zA-Z0-9]/g, '');
          $scope.user.profilepic = 'https://diwoappprofilepics.s3.amazonaws.com/profilepicsdiwo/' + mystring + '.jpg';

          document.getElementById("imageidEditarComercioPerfil").src=imageData;
          
      }, function(err) {
          // An error occured. Show a message to the user
      });
    }
    $scope.getPicture = function (optionsCamera) {
      var optionsCamera = {
            quality : 100,
            sourceType : 0,
            allowEdit : true,
            targetWidth: 640,
            targetHeight: 640
      };
      $cordovaCamera.getPicture(optionsCamera).then(function(imageData) {
        $scope.imgURI2 = imageData;
        $scope.imgURI = $scope.imgURI2;
        document.getElementById("imageidEditarComercioPerfil").src=imageData;
        var mystring = String($scope.user.email);
        mystring = mystring.replace(/[^a-zA-Z0-9]/g, '');
        $scope.user.profilepic = 'https://diwoappprofilepics.s3.amazonaws.com/profilepicsdiwo/' + mystring + '.jpg';

      }, function(err) {
        console.log(err);
      });
    };

  $scope.Salvar = function(){
    $ionicLoading.show({
      title: '┗(＾0＾)┓',
      template: 'Atualizando o perfil'
    });
    $scope.comercio.fotocomercio = $scope.user.profilepic;
    EventoService.atualizarperfil($scope.user).then(function(msg){
      EventoService.atualizarperfilComercio($scope.comercio);
      formComercio.updateForm($scope.comercio);
      formUser.updateForm($scope.user);
              var url = "https://ec2.diwoapp.com.br/upload.php";
                                          // File for Upload
              var targetPath2 = $scope.imgURI2;
              var mystring = String($scope.user.email);
              mystring = mystring.replace(/[^a-zA-Z0-9]/g, '');
              // File name only
              //var name = $scope.imgURI.substr(imageData.lastIndexOf('/') + 1);
              var filename = mystring + '.jpg';

              // NO CASO SERIA O NOME DO USUARIO.jpg O fileName
              var options = {
                fileKey: "file",
                fileName: filename,
                chunkedMode: false,
                mimeType: "multipart/form-data"
              };
              $cordovaFileTransfer.upload(url, targetPath2, options).then(function(result) {
                
                var alertPopup = $ionicPopup.alert({
                  title: 'Perfil Atualizado, obrigado',
                  template: msg
                });
                alertPopup.then(function(){
              
                  formUser.updateForm($scope.user);
                  $state.go('ComercioEditaPerfil');
                });
                
                $ionicLoading.hide();
              }, function(err) {
                $ionicPopup.alert({
                  title: 'Sorry!',
                  template: 'Aconteceu um probleminha, tente de novo'
                });
                $ionicLoading.hide();
              }, function (progress) {
                $ionicLoading.show({
                  title: '┗(＾0＾)┓',
                  template: 'Atualizando o perfil'
                });
              });

      
          }, function(errMsg) {
            var alertPopup = $ionicPopup.alert({
              title: 'Register failed!',
              template: errMsg
            });
            alertPopup.then(function(){
                      $state.go('logando');
            })
          })
  }
}])
.controller('comercioeditatelefoneCtrl', ['$scope', '$stateParams', 'formUser','formComercio', 'EventoService','$ionicPopup', '$timeout','$state', '$cordovaCamera', '$cordovaFile', '$cordovaFileTransfer', '$ionicLoading', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, formUser, formComercio, EventoService, $ionicPopup, $timeout, $state, $cordovaCamera, $cordovaFile, $cordovaFileTransfer, $ionicLoading) {
  $scope.user = formUser.getForm();
  $scope.comercio = formComercio.getForm();

  $scope.$on("$ionicView.enter", function(event, data){    
    $scope.user = formUser.getForm();
    $scope.comercio = formComercio.getForm();
  });

  $scope.Salvar = function(){
    if($scope.comercio.telefone){
      $scope.user.telefone = $scope.comercio.telefone;
      EventoService.atualizarperfil($scope.user).then(function(msg){
        EventoService.atualizarperfilComercio($scope.comercio);
        $state.go('ComercioEditaPerfil');
      }, function(errMsg) {
        var alertPopup = $ionicPopup.alert({
          title: 'Register failed!',
          template: errMsg
        });
        alertPopup.then(function(){
                  $state.go('logando');
        })
      })
    }else{
      var alertPopup = $ionicPopup.alert({
          title: 'Falha',
          template: 'Precisamos de um telefone de contato'
        });
    }
    
  }
}])
.controller('comercioeditausernameCtrl', ['$scope', '$stateParams', 'formUser','formComercio', 'EventoService','$ionicPopup', '$timeout','$state', '$cordovaCamera', '$cordovaFile', '$cordovaFileTransfer', '$ionicLoading', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, formUser, formComercio, EventoService, $ionicPopup, $timeout, $state, $cordovaCamera, $cordovaFile, $cordovaFileTransfer, $ionicLoading) {
  $scope.user = formUser.getForm();
  $scope.comercio = formComercio.getForm();

  $scope.$on("$ionicView.enter", function(event, data){    
    $scope.user = formUser.getForm();
    $scope.comercio = formComercio.getForm();
    $scope.auxusername = $scope.user.username;
  });

  $scope.verifica = function(){
    if($scope.auxusername.toLowerCase() == $scope.user.username.toLowerCase()){
      var alertPopup = $ionicPopup.alert({
              title: 'ԅ( ˘ω˘ ԅ)',
              template: 'Teu username ja é demaix'
        });
      $scope.usernexite = false;
      $scope.userexiste = false;
    }else{
      EventoService.verificanome($scope.user.username).then(function(success){
        console.log(success, "'dasd",$scope.user.email, $scope.user.genero )                         
        if(!success){
          $scope.usernexite = true;
          $scope.userexiste = false;
        }else{
          $scope.userexiste = true;
          $scope.usernexite = false;
        }
      }); 
    }
    
  };

  $scope.Salvar = function(){
    $scope.comercio.nomecomercio = $scope.user.apelido;
    EventoService.atualizarperfil($scope.user).then(function(msg){
      EventoService.atualizarperfilComercio($scope.comercio);
      formComercio.updateForm($scope.comercio);
      formUser.updateForm($scope.user);
      $state.go('ComercioEditaPerfil');
          }, function(errMsg) {
            var alertPopup = $ionicPopup.alert({
              title: 'Register failed!',
              template: errMsg
            });
            alertPopup.then(function(){
                      $state.go('logando');
            })
          })
  }
}])
.controller('comercioedtaatendimentoCtrl', ['$scope', '$stateParams', 'formUser','formComercio', 'EventoService','$ionicPopup', '$timeout','$state', '$cordovaCamera', '$cordovaFile', '$cordovaFileTransfer', '$ionicLoading', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, formUser, formComercio, EventoService, $ionicPopup, $timeout, $state, $cordovaCamera, $cordovaFile, $cordovaFileTransfer, $ionicLoading) {
  $scope.user = formUser.getForm();
  $scope.comercio = formComercio.getForm();

  $scope.$on("$ionicView.enter", function(event, data){    
    $scope.user = formUser.getForm();
    $scope.comercio = formComercio.getForm();
    $scope.comercio.auxtag1 = '00:00';
    $scope.comercio.auxtag2 = '01:00'; 
    $scope.comercio.auxtag3 = '02:00'; 
    $scope.comercio.auxtag4 = '03:00'; 
    $scope.comercio.auxtag5 = '04:00';  
    $scope.comercio.auxtag6 = '05:00'; 
    $scope.comercio.auxtag7 = '06:00'; 
    $scope.comercio.auxtag8 = '07:00'; 
    $scope.comercio.auxtag9 = '08:00'; 
    $scope.comercio.auxtag10 = '09:00'; 
    $scope.comercio.auxtag11 = '10:00'; 
    $scope.comercio.auxtag12 = '11:00'; 
    $scope.comercio.auxtag13 = '12:00'; 
    $scope.comercio.auxtag14 = '13:00'; 
    $scope.comercio.auxtag15 = '14:00'; 
    $scope.comercio.auxtag16 = '15:00'; 
    $scope.comercio.auxtag17 = '16:00'; 
    $scope.comercio.auxtag18 = '17:00';
    $scope.comercio.auxtag19 = '18:00'; 
    $scope.comercio.auxtag20 = '19:00'; 
    $scope.comercio.auxtag21 = '20:00'; 
    $scope.comercio.auxtag22 = '21:00'; 
    $scope.comercio.auxtag23 = '22:00'; 
    $scope.comercio.auxtag24 = '23:00'; 

    $scope.comercio.auxsemana1 = 'Dom';
    $scope.comercio.auxsemana2 = 'Seg'; 
    $scope.comercio.auxsemana3 = 'Ter'; 
    $scope.comercio.auxsemana4 = 'Qua'; 
    $scope.comercio.auxsemana5 = 'Qui';  
    $scope.comercio.auxsemana6 = 'Sex'; 
    $scope.comercio.auxsemana7 = 'Sab';

    var semanafuncionamento = $scope.comercio.semanafuncionamento.split(" ") ;
    var dw = semanafuncionamento.length
    $scope.auxsemanabutton1 = false;
    $scope.auxsemanabutton1aux = true;
    $scope.auxsemanabutton2 = false;
    $scope.auxsemanabutton2aux = true;
    $scope.auxsemanabutton3 = false;
    $scope.auxsemanabutton3aux = true;
    $scope.auxsemanabutton4 = false;
    $scope.auxsemanabutton4aux = true;
    $scope.auxsemanabutton5 = false;
    $scope.auxsemanabutton5aux = true;
    $scope.auxsemanabutton6 = false;
    $scope.auxsemanabutton6aux = true;
    $scope.auxsemanabutton7 = false;
    $scope.auxsemanabutton7aux = true;
    for(var i = 0; i<dw;i++){
      if(semanafuncionamento[i] == "Dom"){
        $scope.auxsemanabutton1 = true;
        $scope.auxsemanabutton1aux = false;
      }
      if(semanafuncionamento[i] == "Seg"){
        $scope.auxsemanabutton2 = true;
        $scope.auxsemanabutton2aux = false;
      }
      if(semanafuncionamento[i] == "Ter"){
        $scope.auxsemanabutton3 = true;
        $scope.auxsemanabutton3aux = false;
      }
      if(semanafuncionamento[i] == "Qua"){
        $scope.auxsemanabutton4 = true;
        $scope.auxsemanabutton4aux = false;
      }
      if(semanafuncionamento[i] == "Qui"){
        $scope.auxsemanabutton5 = true;
        $scope.auxsemanabutton5aux = false;
      }
      if(semanafuncionamento[i] == "Sex"){
        $scope.auxsemanabutton6 = true;
        $scope.auxsemanabutton6aux = false;
      }
      if(semanafuncionamento[i] == "Sab"){
        $scope.auxsemanabutton7 = true;
        $scope.auxsemanabutton7aux = false;
      }
    }
    
    var horariofuncionamento = $scope.comercio.horariofuncionamento.split(" ") ;
    var w = horariofuncionamento.length
    $scope.auxtagbutton1 = false;
    $scope.auxtagbutton1aux = true;
    $scope.auxtagbutton2 = false;
    $scope.auxtagbutton2aux = true;
    $scope.auxtagbutton3 = false;
    $scope.auxtagbutton3aux = true;
    $scope.auxtagbutton4 = false;
    $scope.auxtagbutton4aux = true;
    $scope.auxtagbutton5 = false;
    $scope.auxtagbutton5aux = true;
    $scope.auxtagbutton6 = false;
    $scope.auxtagbutton6aux = true;
    $scope.auxtagbutton7 = false;
    $scope.auxtagbutton7aux = true;
    $scope.auxtagbutton8 = false;
    $scope.auxtagbutton8aux = true;
    $scope.auxtagbutton9 = false;
    $scope.auxtagbutton9aux = true;
    $scope.auxtagbutton10 = false;
    $scope.auxtagbutton10aux = true;
    $scope.auxtagbutton11 = false;
    $scope.auxtagbutton11aux = true;
    $scope.auxtagbutton12 = false;
    $scope.auxtagbutton12aux = true;
    $scope.auxtagbutton13 = false;
    $scope.auxtagbutton13aux = true;
    $scope.auxtagbutton14 = false;
    $scope.auxtagbutton14aux = true;
    $scope.auxtagbutton15 = false;
    $scope.auxtagbutton15aux = true;
    $scope.auxtagbutton16 = false;
    $scope.auxtagbutton16aux = true;
    $scope.auxtagbutton17 = false;
    $scope.auxtagbutton17aux = true;
    $scope.auxtagbutton18 = false;
    $scope.auxtagbutton18aux = true;
    $scope.auxtagbutton19 = false;
    $scope.auxtagbutton19aux = true;
    $scope.auxtagbutton20 = false;
    $scope.auxtagbutton20aux = true;
    $scope.auxtagbutton21 = false;
    $scope.auxtagbutton21aux = true;
    $scope.auxtagbutton22 = false;
    $scope.auxtagbutton22aux = true;
    $scope.auxtagbutton23 = false;
    $scope.auxtagbutton23aux = true;
    $scope.auxtagbutton24 = false;
    $scope.auxtagbutton24aux = true;
    for(var i = 0; i<w;i++){
      if(horariofuncionamento[i] == "00:00"){
        $scope.auxtagbutton1 = true;
        $scope.auxtagbutton1aux = false;
      }
      if(horariofuncionamento[i] == "01:00"){
        $scope.auxtagbutton2 = true;
        $scope.auxtagbutton2aux = false;
      }
      if(horariofuncionamento[i] == "02:00"){
        $scope.auxtagbutton3 = true;
        $scope.auxtagbutton3aux = false;
      }
      if(horariofuncionamento[i] == "03:00"){
        $scope.auxtagbutton4 = true;
        $scope.auxtagbutton4aux = false;
      }
      if(horariofuncionamento[i] == "04:00"){
        $scope.auxtagbutton5 = true;
        $scope.auxtagbutton5aux = false;
      }
      if(horariofuncionamento[i] == "05:00"){
        $scope.auxtagbutton6 = true;
        $scope.auxtagbutton6aux = false;
      }
      if(horariofuncionamento[i] == "06:00"){
        $scope.auxtagbutton7 = true;
        $scope.auxtagbutton7aux = false;
      }
      if(horariofuncionamento[i] == "07:00"){
        $scope.auxtagbutton8 = true;
        $scope.auxtagbutton8aux = false;
      }
      if(horariofuncionamento[i] == "08:00"){
        $scope.auxtagbutton9 = true;
        $scope.auxtagbutton9aux = false;
      }
      if(horariofuncionamento[i] == "09:00"){
        $scope.auxtagbutton10 = true;
        $scope.auxtagbutton10aux = false;
      }
      if(horariofuncionamento[i] == "10:00"){
        $scope.auxtagbutton11 = true;
        $scope.auxtagbutton11aux = false;
      }
      if(horariofuncionamento[i] == "11:00"){
        $scope.auxtagbutton12 = true;
        $scope.auxtagbutton12aux = false;
      }
      if(horariofuncionamento[i] == "12:00"){
        $scope.auxtagbutton13 = true;
        $scope.auxtagbutton13aux = false;
      }
      if(horariofuncionamento[i] == "13:00"){
        $scope.auxtagbutton14 = true;
        $scope.auxtagbutton14aux = false;
      }
      if(horariofuncionamento[i] == "14:00"){
        $scope.auxtagbutton15 = true;
        $scope.auxtagbutton15aux = false;
      }
      if(horariofuncionamento[i] == "15:00"){
        $scope.auxtagbutton16 = true;
        $scope.auxtagbutton16aux = false;
      }
      if(horariofuncionamento[i] == "16:00"){
        $scope.auxtagbutton17 = true;
        $scope.auxtagbutton17aux = false;
      }
      if(horariofuncionamento[i] == "17:00"){
        $scope.auxtagbutton18 = true;
        $scope.auxtagbutton18aux = false;
      }
      if(horariofuncionamento[i] == "18:00"){
        $scope.auxtagbutton19 = true;
        $scope.auxtagbutton19aux = false;
      }
      if(horariofuncionamento[i] == "19:00"){
        $scope.auxtagbutton20 = true;
        $scope.auxtagbutton20aux = false;
      }
      if(horariofuncionamento[i] == "20:00"){
        $scope.auxtagbutton21 = true;
        $scope.auxtagbutton21aux = false;
      }
      if(horariofuncionamento[i] == "21:00"){
        $scope.auxtagbutton22 = true;
        $scope.auxtagbutton22aux = false;
      }
      if(horariofuncionamento[i] == "22:00"){
        $scope.auxtagbutton23 = true;
        $scope.auxtagbutton23aux = false;
      }
      if(horariofuncionamento[i] == "23:00"){
        $scope.auxtagbutton24 = true;
        $scope.auxtagbutton24aux = false;
      }
    }
  });
  
   $scope.tiratag1 = function(){
        if($scope.auxtagbutton1){
          $scope.auxtagbutton1 = false;
          $scope.auxtagbutton1aux = true;
        }else{
          $scope.auxtagbutton1 = true;
          $scope.auxtagbutton1aux = false;
        }
    }
    $scope.tiratag2 = function(){
        if($scope.auxtagbutton2){
          $scope.auxtagbutton2 = false;
          $scope.auxtagbutton2aux = true;
        }else{
          $scope.auxtagbutton2 = true;
          $scope.auxtagbutton2aux = false;
        }
    }
    $scope.tiratag3 = function(){
        if($scope.auxtagbutton3){
          $scope.auxtagbutton3 = false;
          $scope.auxtagbutton3aux = true;
        }else{
          $scope.auxtagbutton3 = true;
          $scope.auxtagbutton3aux = false;
        }
    }
    $scope.tiratag4 = function(){
        if($scope.auxtagbutton4){
          $scope.auxtagbutton4 = false;
          $scope.auxtagbutton4aux = true;
        }else{
          $scope.auxtagbutton4 = true;
          $scope.auxtagbutton4aux = false;
        }
    }
    $scope.tiratag5 = function(){
        if($scope.auxtagbutton5){
          $scope.auxtagbutton5 = false;
          $scope.auxtagbutton5aux = true;
        }else{
          $scope.auxtagbutton5 = true;
          $scope.auxtagbutton5aux = false;
        }
    }
    $scope.tiratag6 = function(){
        if($scope.auxtagbutton6){
          $scope.auxtagbutton6 = false;
          $scope.auxtagbutton6aux = true;
        }else{
          $scope.auxtagbutton6 = true;
          $scope.auxtagbutton6aux = false;
        }
    }

    $scope.tiratag7 = function(){
        if($scope.auxtagbutton7){
          $scope.auxtagbutton7 = false;
          $scope.auxtagbutton7aux = true;
        }else{
          $scope.auxtagbutton7 = true;
          $scope.auxtagbutton7aux = false;
        }
    }
    $scope.tiratag8 = function(){
        if($scope.auxtagbutton8){
          $scope.auxtagbutton8 = false;
          $scope.auxtagbutton8aux = true;
        }else{
          $scope.auxtagbutton8 = true;
          $scope.auxtagbutton8aux = false;
        }
    }
    $scope.tiratag9 = function(){
        if($scope.auxtagbutton9){
          $scope.auxtagbutton9 = false;
          $scope.auxtagbutton9aux = true;
        }else{
          $scope.auxtagbutton9 = true;
          $scope.auxtagbutton9aux = false;
        }
    }
    $scope.tiratag10 = function(){
        if($scope.auxtagbutton10){
          $scope.auxtagbutton10 = false;
          $scope.auxtagbutton10aux = true;
        }else{
          $scope.auxtagbutton10 = true;
          $scope.auxtagbutton10aux = false;
        }
    }
    $scope.tiratag11 = function(){
        if($scope.auxtagbutton11){
          $scope.auxtagbutton11 = false;
          $scope.auxtagbutton11aux = true;
        }else{
          $scope.auxtagbutton11 = true;
          $scope.auxtagbutton11aux = false;
        }
    }
    $scope.tiratag12 = function(){
        if($scope.auxtagbutton12){
          $scope.auxtagbutton12 = false;
          $scope.auxtagbutton12aux = true;
        }else{
          $scope.auxtagbutton12 = true;
          $scope.auxtagbutton12aux = false;
        }
    }
    $scope.tiratag13 = function(){
        if($scope.auxtagbutton13){
          $scope.auxtagbutton13 = false;
          $scope.auxtagbutton13aux = true;
        }else{
          $scope.auxtagbutton13 = true;
          $scope.auxtagbutton13aux = false;
        }
    }
    $scope.tiratag14 = function(){
        if($scope.auxtagbutton14){
          $scope.auxtagbutton14 = false;
          $scope.auxtagbutton14aux = true;
        }else{
          $scope.auxtagbutton14 = true;
          $scope.auxtagbutton14aux = false;
        }
    }
    $scope.tiratag15 = function(){
        if($scope.auxtagbutton15){
          $scope.auxtagbutton15 = false;
          $scope.auxtagbutton15aux = true;
        }else{
          $scope.auxtagbutton15 = true;
          $scope.auxtagbutton15aux = false;
        }
    }
    $scope.tiratag16 = function(){
        if($scope.auxtagbutton16){
          $scope.auxtagbutton16 = false;
          $scope.auxtagbutton16aux = true;
        }else{
          $scope.auxtagbutton16 = true;
          $scope.auxtagbutton16aux = false;
        }
    }
    $scope.tiratag17 = function(){
        if($scope.auxtagbutton17){
          $scope.auxtagbutton17 = false;
          $scope.auxtagbutton17aux = true;
        }else{
          $scope.auxtagbutton17 = true;
          $scope.auxtagbutton17aux = false;
        }
    }
    $scope.tiratag18 = function(){
        if($scope.auxtagbutton18){
          $scope.auxtagbutton18 = false;
          $scope.auxtagbutton18aux = true;
        }else{
          $scope.auxtagbutton18 = true;
          $scope.auxtagbutton18aux = false;
        }
    }
    $scope.tiratag19 = function(){
        if($scope.auxtagbutton19){
          $scope.auxtagbutton19 = false;
          $scope.auxtagbutton19aux = true;
        }else{
          $scope.auxtagbutton19 = true;
          $scope.auxtagbutton19aux = false;
        }
    }
    $scope.tiratag20 = function(){
        if($scope.auxtagbutton20){
          $scope.auxtagbutton20 = false;
          $scope.auxtagbutton20aux = true;
        }else{
          $scope.auxtagbutton20 = true;
          $scope.auxtagbutton20aux = false;
        }
    }
    $scope.tiratag21 = function(){
        if($scope.auxtagbutton21){
          $scope.auxtagbutton21 = false;
          $scope.auxtagbutton21aux = true;
        }else{
          $scope.auxtagbutton21 = true;
          $scope.auxtagbutton21aux = false;
        }
    }
    $scope.tiratag22 = function(){
        if($scope.auxtagbutton22){
          $scope.auxtagbutton22 = false;
          $scope.auxtagbutton22aux = true;
        }else{
          $scope.auxtagbutton22 = true;
          $scope.auxtagbutton22aux = false;
        }
    }
    $scope.tiratag23 = function(){
        if($scope.auxtagbutton23){
          $scope.auxtagbutton23 = false;
          $scope.auxtagbutton23aux = true;
        }else{
          $scope.auxtagbutton23 = true;
          $scope.auxtagbutton23aux = false;
        }
    }
    $scope.tiratag24 = function(){
        if($scope.auxtagbutton24){
          $scope.auxtagbutton24 = false;
          $scope.auxtagbutton24aux = true;
        }else{
          $scope.auxtagbutton24 = true;
          $scope.auxtagbutton24aux = false;
        }
    }

    $scope.tirasemana1 = function(){
        if($scope.auxsemanabutton1){
          $scope.auxsemanabutton1 = false;
          $scope.auxsemanabutton1aux = true;
        }else{
          $scope.auxsemanabutton1 = true;
          $scope.auxsemanabutton1aux = false;
        }
    }
    $scope.tirasemana2 = function(){
        if($scope.auxsemanabutton2){
          $scope.auxsemanabutton2 = false;
          $scope.auxsemanabutton2aux = true;
        }else{
          $scope.auxsemanabutton2 = true;
          $scope.auxsemanabutton2aux = false;
        }
    }
    $scope.tirasemana3 = function(){
        if($scope.auxsemanabutton3){
          $scope.auxsemanabutton3 = false;
          $scope.auxsemanabutton3aux = true;
        }else{
          $scope.auxsemanabutton3 = true;
          $scope.auxsemanabutton3aux = false;
        }
    }
    $scope.tirasemana4 = function(){
        if($scope.auxsemanabutton4){
          $scope.auxsemanabutton4 = false;
          $scope.auxsemanabutton4aux = true;
        }else{
          $scope.auxsemanabutton4 = true;
          $scope.auxsemanabutton4aux = false;
        }
    }
    $scope.tirasemana5 = function(){
        if($scope.auxsemanabutton5){
          $scope.auxsemanabutton5 = false;
          $scope.auxsemanabutton5aux = true;
        }else{
          $scope.auxsemanabutton5 = true;
          $scope.auxsemanabutton5aux = false;
        }
    }
    $scope.tirasemana6 = function(){
        if($scope.auxsemanabutton6){
          $scope.auxsemanabutton6 = false;
          $scope.auxsemanabutton6aux = true;
        }else{
          $scope.auxsemanabutton6 = true;
          $scope.auxsemanabutton6aux = false;
        }
    }

    $scope.tirasemana7 = function(){
        if($scope.auxsemanabutton7){
          $scope.auxsemanabutton7 = false;
          $scope.auxsemanabutton7aux = true;
        }else{
          $scope.auxsemanabutton7 = true;
          $scope.auxsemanabutton7aux = false;
        }
    }
          
  $scope.Salvar = function(){
    delete $scope.comercio.horariofuncionamento
  delete $scope.comercio.semanafuncionamento
      if($scope.auxtagbutton1 == true){
        if ($scope.comercio.horariofuncionamento == undefined) {
          $scope.comercio.horariofuncionamento = $scope.comercio.auxtag1;
        }else{
          $scope.comercio.horariofuncionamento = $scope.comercio.horariofuncionamento + ' ' +$scope.comercio.auxtag1;
        }
      }
      if($scope.auxtagbutton2 == true){
        if ($scope.comercio.horariofuncionamento == undefined) {
          $scope.comercio.horariofuncionamento = $scope.comercio.auxtag2;
        }else{
          $scope.comercio.horariofuncionamento = $scope.comercio.horariofuncionamento + ' ' +$scope.comercio.auxtag2;
        }
      }
      if($scope.auxtagbutton3 == true){
        if ($scope.comercio.horariofuncionamento == undefined) {
          $scope.comercio.horariofuncionamento = $scope.comercio.auxtag3;
        }else{
          $scope.comercio.horariofuncionamento = $scope.comercio.horariofuncionamento + ' ' +$scope.comercio.auxtag3;
        }
      }
      if($scope.auxtagbutton4 == true){
        if ($scope.comercio.horariofuncionamento == undefined) {
          $scope.comercio.horariofuncionamento = $scope.comercio.auxtag4;
        }else{
          $scope.comercio.horariofuncionamento = $scope.comercio.horariofuncionamento + ' ' +$scope.comercio.auxtag4;
        }
      }
      if($scope.auxtagbutton5 == true){
        if ($scope.comercio.horariofuncionamento == undefined) {
          $scope.comercio.horariofuncionamento = $scope.comercio.auxtag5;
        }else{
          $scope.comercio.horariofuncionamento = $scope.comercio.horariofuncionamento + ' ' +$scope.comercio.auxtag5;
        }
      }
      if($scope.auxtagbutton6 == true){
        if ($scope.comercio.horariofuncionamento == undefined) {
          $scope.comercio.horariofuncionamento = $scope.comercio.auxtag6;
        }else{
          $scope.comercio.horariofuncionamento = $scope.comercio.horariofuncionamento + ' ' +$scope.comercio.auxtag6;
        }
      }
      if($scope.auxtagbutton7 == true){
        if ($scope.comercio.horariofuncionamento == undefined) {
          $scope.comercio.horariofuncionamento = $scope.comercio.auxtag7;
        }else{
          $scope.comercio.horariofuncionamento = $scope.comercio.horariofuncionamento + ' ' +$scope.comercio.auxtag7;
        }
      }
      if($scope.auxtagbutton8 == true){
        if ($scope.comercio.horariofuncionamento == undefined) {
          $scope.comercio.horariofuncionamento = $scope.comercio.auxtag8;
        }else{
          $scope.comercio.horariofuncionamento = $scope.comercio.horariofuncionamento + ' ' +$scope.comercio.auxtag8;
        }
      }
      if($scope.auxtagbutton9 == true){
        if ($scope.comercio.horariofuncionamento == undefined) {
          $scope.comercio.horariofuncionamento = $scope.comercio.auxtag9;
        }else{
          $scope.comercio.horariofuncionamento = $scope.comercio.horariofuncionamento + ' ' +$scope.comercio.auxtag9;
        }
      }
      if($scope.auxtagbutton10 == true){
        if ($scope.comercio.horariofuncionamento == undefined) {
          $scope.comercio.horariofuncionamento = $scope.comercio.auxtag10;
        }else{
          $scope.comercio.horariofuncionamento = $scope.comercio.horariofuncionamento + ' ' +$scope.comercio.auxtag10;
        }
      }
      if($scope.auxtagbutton11 == true){
        if ($scope.comercio.horariofuncionamento == undefined) {
          $scope.comercio.horariofuncionamento = $scope.comercio.auxtag11;
        }else{
          $scope.comercio.horariofuncionamento = $scope.comercio.horariofuncionamento + ' ' +$scope.comercio.auxtag11;
        }
      }
      if($scope.auxtagbutton12 == true){
        if ($scope.comercio.horariofuncionamento == undefined) {
          $scope.comercio.horariofuncionamento = $scope.comercio.auxtag12;
        }else{
          $scope.comercio.horariofuncionamento = $scope.comercio.horariofuncionamento + ' ' +$scope.comercio.auxtag12;
        }
      }
      if($scope.auxtagbutton13 == true){
        if ($scope.comercio.horariofuncionamento == undefined) {
          $scope.comercio.horariofuncionamento = $scope.comercio.auxtag13;
        }else{
          $scope.comercio.horariofuncionamento = $scope.comercio.horariofuncionamento + ' ' +$scope.comercio.auxtag13;
        }
      }
      if($scope.auxtagbutton14 == true){
        if ($scope.comercio.horariofuncionamento == undefined) {
          $scope.comercio.horariofuncionamento = $scope.comercio.auxtag14;
        }else{
          $scope.comercio.horariofuncionamento = $scope.comercio.horariofuncionamento + ' ' +$scope.comercio.auxtag14;
        }
      }
      if($scope.auxtagbutton15 == true){
        if ($scope.comercio.horariofuncionamento == undefined) {
          $scope.comercio.horariofuncionamento = $scope.comercio.auxtag15;
        }else{
          $scope.comercio.horariofuncionamento = $scope.comercio.horariofuncionamento + ' ' +$scope.comercio.auxtag15;
        }
      }
      if($scope.auxtagbutton16 == true){
        if ($scope.comercio.horariofuncionamento == undefined) {
          $scope.comercio.horariofuncionamento = $scope.comercio.auxtag16;
        }else{
          $scope.comercio.horariofuncionamento = $scope.comercio.horariofuncionamento + ' ' +$scope.comercio.auxtag16;
        }
      }
      if($scope.auxtagbutton17 == true){
        if ($scope.comercio.horariofuncionamento == undefined) {
          $scope.comercio.horariofuncionamento = $scope.comercio.auxtag17;
        }else{
          $scope.comercio.horariofuncionamento = $scope.comercio.horariofuncionamento + ' ' +$scope.comercio.auxtag17;
        }
      }
      if($scope.auxtagbutton18 == true){
        if ($scope.comercio.horariofuncionamento == undefined) {
          $scope.comercio.horariofuncionamento = $scope.comercio.auxtag18;
        }else{
          $scope.comercio.horariofuncionamento = $scope.comercio.horariofuncionamento + ' ' +$scope.comercio.auxtag18;
        }
      }
      if($scope.auxtagbutton19 == true){
        if ($scope.comercio.horariofuncionamento == undefined) {
          $scope.comercio.horariofuncionamento = $scope.comercio.auxtag19;
        }else{
          $scope.comercio.horariofuncionamento = $scope.comercio.horariofuncionamento + ' ' +$scope.comercio.auxtag19;
        }
      }
      if($scope.auxtagbutton20 == true){
        if ($scope.comercio.horariofuncionamento == undefined) {
          $scope.comercio.horariofuncionamento = $scope.comercio.auxtag20;
        }else{
          $scope.comercio.horariofuncionamento = $scope.comercio.horariofuncionamento + ' ' +$scope.comercio.auxtag20;
        }
      }
      if($scope.auxtagbutton21 == true){
        if ($scope.comercio.horariofuncionamento == undefined) {
          $scope.comercio.horariofuncionamento = $scope.comercio.auxtag21;
        }else{
          $scope.comercio.horariofuncionamento = $scope.comercio.horariofuncionamento + ' ' +$scope.comercio.auxtag21;
        }
      }
      if($scope.auxtagbutton22 == true){
        if ($scope.comercio.horariofuncionamento == undefined) {
          $scope.comercio.horariofuncionamento = $scope.comercio.auxtag22;
        }else{
          $scope.comercio.horariofuncionamento = $scope.comercio.horariofuncionamento + ' ' +$scope.comercio.auxtag22;
        }
      }
      if($scope.auxtagbutton23 == true){
        if ($scope.comercio.horariofuncionamento == undefined) {
          $scope.comercio.horariofuncionamento = $scope.comercio.auxtag23;
        }else{
          $scope.comercio.horariofuncionamento = $scope.comercio.horariofuncionamento + ' ' +$scope.comercio.auxtag23;
        }
      }
      if($scope.auxtagbutton24 == true){
        if ($scope.comercio.horariofuncionamento == undefined) {
          $scope.comercio.horariofuncionamento = $scope.comercio.auxtag24;
        }else{
          $scope.comercio.horariofuncionamento = $scope.comercio.horariofuncionamento + ' ' +$scope.comercio.auxtag24;
        }
      }


      if($scope.auxsemanabutton1 == true){
        if ($scope.comercio.semanafuncionamento == undefined) {
          $scope.comercio.semanafuncionamento = $scope.comercio.auxsemana1;
        }else{
          $scope.comercio.semanafuncionamento = $scope.comercio.semanafuncionamento + ' ' +$scope.comercio.auxsemana1;
        }
      }
      if($scope.auxsemanabutton2 == true){
        if ($scope.comercio.semanafuncionamento == undefined) {
          $scope.comercio.semanafuncionamento = $scope.comercio.auxsemana2;
        }else{
          $scope.comercio.semanafuncionamento = $scope.comercio.semanafuncionamento + ' ' +$scope.comercio.auxsemana2;
        }
      }
      if($scope.auxsemanabutton3 == true){
        if ($scope.comercio.semanafuncionamento == undefined) {
          $scope.comercio.semanafuncionamento = $scope.comercio.auxsemana3;
        }else{
          $scope.comercio.semanafuncionamento = $scope.comercio.semanafuncionamento + ' ' +$scope.comercio.auxsemana3;
        }
      }
      if($scope.auxsemanabutton4 == true){
        if ($scope.comercio.semanafuncionamento == undefined) {
          $scope.comercio.semanafuncionamento = $scope.comercio.auxsemana4;
        }else{
          $scope.comercio.semanafuncionamento = $scope.comercio.semanafuncionamento + ' ' +$scope.comercio.auxsemana4;
        }
      }
      if($scope.auxsemanabutton5 == true){
        if ($scope.comercio.semanafuncionamento == undefined) {
          $scope.comercio.semanafuncionamento = $scope.comercio.auxsemana5;
        }else{
          $scope.comercio.semanafuncionamento = $scope.comercio.semanafuncionamento + ' ' +$scope.comercio.auxsemana5;
        }
      }
      if($scope.auxsemanabutton6 == true){
        if ($scope.comercio.semanafuncionamento == undefined) {
          $scope.comercio.semanafuncionamento = $scope.comercio.auxsemana6;
        }else{
          $scope.comercio.semanafuncionamento = $scope.comercio.semanafuncionamento + ' ' +$scope.comercio.auxsemana6;
        }
      }
      if($scope.auxsemanabutton7 == true){
        if ($scope.comercio.semanafuncionamento == undefined) {
          $scope.comercio.semanafuncionamento = $scope.comercio.auxsemana;
        }else{
          $scope.comercio.semanafuncionamento = $scope.comercio.semanafuncionamento + ' ' +$scope.comercio.auxsemana7;
        }
      }


      if (!$scope.comercio.horariofuncionamento && !$scope.comercio.semanafuncionamento) {
        var alertPopup = $ionicPopup.alert({
          title: '(⊙﹏⊙✿)',
          template: 'Selecione pelo menos um desses!'
        });
      }else{
        EventoService.atualizarperfil($scope.user).then(function(msg){
          EventoService.atualizarperfilComercio($scope.comercio);
          formComercio.updateForm($scope.comercio);
          formUser.updateForm($scope.user);
          $state.go('ComercioEditaPerfil');
              }, function(errMsg) {
                var alertPopup = $ionicPopup.alert({
                  title: 'Register failed!',
                  template: errMsg
                });
                alertPopup.then(function(){
                          $state.go('logando');
                })
              })
      }
  }
}])

.controller('comercioeditainteresseCtrl', ['$scope', '$stateParams', '$state', 'EventoService', '$ionicPopup', 'formUser','formComercio', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, $state, EventoService,  $ionicPopup, formUser, formComercio) {
  $scope.user = {};
  $scope.user = formUser.getForm();
  $scope.comercio = formComercio.getForm();

  $scope.$on("$ionicView.enter", function(event, data){
    $scope.user = formUser.getForm();
    $scope.comercio = formComercio.getForm();
    $scope.auxtagbutton1 = true;
    $scope.auxtagbutton2 = true;
    $scope.auxtagbutton3 = true;
    $scope.auxtagbutton4 = true;
    $scope.auxtagbutton5 = true;
    $scope.auxtagbutton6 = true;
    $scope.auxtagbutton7 = true;
    $scope.auxtagbutton8 = true;
    $scope.auxtagbutton9 = true;
    $scope.auxtagbutton10 = true;
    $scope.auxtagbutton11 = true;
    $scope.auxtagbutton12 = true;
    $scope.auxtagbutton13 = true;
    $scope.auxtagbutton14 = true;
    $scope.auxtagbutton15 = true;
    $scope.auxtagbutton16 = true;
    $scope.auxtagbutton17 = true;
    $scope.auxtagbutton18 = true;
    $scope.auxtagbutton1aux = false;
    $scope.auxtagbutton2aux = false;
    $scope.auxtagbutton3aux = false;
    $scope.auxtagbutton4aux = false;
    $scope.auxtagbutton5aux = false;
    $scope.auxtagbutton6aux = false;
    $scope.auxtagbutton7aux = false;
    $scope.auxtagbutton8aux = false;
    $scope.auxtagbutton9aux = false;
    $scope.auxtagbutton10aux = false;
    $scope.auxtagbutton11aux = false;
    $scope.auxtagbutton12aux = false;
    $scope.auxtagbutton13aux = false;
    $scope.auxtagbutton14aux = false;
    $scope.auxtagbutton15aux = false;
    $scope.auxtagbutton16aux = false;
    $scope.auxtagbutton17aux = false;
    $scope.auxtagbutton18aux = false;
    $scope.user.auxtag1 = 'Voluntariado';
    $scope.user.auxtag2 = 'Passeio'; 
    $scope.user.auxtag3 = 'Esportesdepraia'; 
    $scope.user.auxtag4 = 'Natureza'; 
    $scope.user.auxtag5 = 'Ciclismo';  
    $scope.user.auxtag6 = 'Futebol'; 
    $scope.user.auxtag7 = 'Corrida'; 
    $scope.user.auxtag8 = 'Dança'; 
    $scope.user.auxtag9 = 'Surf'; 
    $scope.user.auxtag10 = 'Música'; 
    $scope.user.auxtag11 = 'ArteeCultura'; 
    $scope.user.auxtag12 = 'Conversa'; 
    $scope.user.auxtag13 = 'Restaurante&Bares'; 
    $scope.user.auxtag14 = 'Festas'; 
    $scope.user.auxtag15 = 'Jogos'; 
    $scope.user.auxtag16 = 'GruposdeEstudos'; 
    $scope.user.auxtag17 = 'Pets'; 
    $scope.user.auxtag18 = 'Praia'; 
    EventoService.Getinteresseuser($scope.user.iduser).then(function(interesse) {
      
      for(var  i =0; i< interesse.length;i++){
        if(interesse[i].interesse =="#Voluntariado"){
          $scope.auxtagbutton1 = false;
          $scope.auxtagbutton1aux = true;
        }
        if(interesse[i].interesse =="#Passeio"){
          $scope.auxtagbutton2 = false;
          $scope.auxtagbutton2aux = true;
        }
        if(interesse[i].interesse =="#Esportesdepraia"){
          $scope.auxtagbutton3 = false;
          $scope.auxtagbutton3aux = true;
        }
        if(interesse[i].interesse =="#Natureza"){
          $scope.auxtagbutton4 = false;
        }
        if(interesse[i].interesse =="#Ciclismo"){
          $scope.auxtagbutton5 = false;
          $scope.auxtagbutton5aux = true;
        }
        if(interesse[i].interesse =="#Futebol"){
          $scope.auxtagbutton6 = false;
          $scope.auxtagbutton6aux = true;
        }
        if(interesse[i].interesse =="#Corrida"){
          $scope.auxtagbutton7 = false;
          $scope.auxtagbutton7aux = true;
        }
        if(interesse[i].interesse =="#Dança"){
          $scope.auxtagbutton8 = false;
          $scope.auxtagbutton8aux = true;
        }
        if(interesse[i].interesse =="#Surf"){
          $scope.auxtagbutton9 = false;
          $scope.auxtagbutton9aux = true;
        }
        if(interesse[i].interesse =="#Música"){
          $scope.auxtagbutton10 = false;
          $scope.auxtagbutton10aux = true;
        }
        if(interesse[i].interesse =="#ArteeCultura"){
          $scope.auxtagbutton11 = false;
          $scope.auxtagbutton11aux = true;
        }
        if(interesse[i].interesse =="#Conversa"){
          $scope.auxtagbutton12 = false;
          $scope.auxtagbutton12aux = true;
        }
        if(interesse[i].interesse =="#Restaurante&Bares"){
          $scope.auxtagbutton13 = false;
          $scope.auxtagbutton13aux = true;
        }
        if(interesse[i].interesse =="#Festas"){
          $scope.auxtagbutton14 = false;
          $scope.auxtagbutton14aux = true;
        }
        if(interesse[i].interesse =="#Jogos"){
          $scope.auxtagbutton15 = false;
          $scope.auxtagbutton15aux = true;
        }
        if(interesse[i].interesse =="#GruposdeEstudos"){
          $scope.auxtagbutton16 = false;
          $scope.auxtagbutton16aux = true;
        }
        if(interesse[i].interesse =="#Pets"){
          $scope.auxtagbutton17 = false;
          $scope.auxtagbutton17aux = true;
        }
        if(interesse[i].interesse =="#Praia"){
          $scope.auxtagbutton18 = false;
          $scope.auxtagbutton18aux = true;
        }
      }   
      
    });


    
    

  });
    $scope.tiratag1 = function(){
        if($scope.auxtagbutton1){
          $scope.auxtagbutton1 = false;
          $scope.auxtagbutton1aux = true;
        }else{
          $scope.auxtagbutton1 = true;
          $scope.auxtagbutton1aux = false;
        }
    }
    $scope.tiratag2 = function(){
        if($scope.auxtagbutton2){
          $scope.auxtagbutton2 = false;
          $scope.auxtagbutton2aux = true;
        }else{
          $scope.auxtagbutton2 = true;
          $scope.auxtagbutton2aux = false;
        }
    }
    $scope.tiratag3 = function(){
        if($scope.auxtagbutton3){
          $scope.auxtagbutton3 = false;
          $scope.auxtagbutton3aux = true;
        }else{
          $scope.auxtagbutton3 = true;
          $scope.auxtagbutton3aux = false;
        }
    }
    $scope.tiratag4 = function(){
        if($scope.auxtagbutton4){
          $scope.auxtagbutton4 = false;
          $scope.auxtagbutton4aux = true;
        }else{
          $scope.auxtagbutton4 = true;
          $scope.auxtagbutton4aux = false;
        }
    }
    $scope.tiratag5 = function(){
        if($scope.auxtagbutton5){
          $scope.auxtagbutton5 = false;
          $scope.auxtagbutton5aux = true;
        }else{
          $scope.auxtagbutton5 = true;
          $scope.auxtagbutton5aux = false;
        }
    }
    $scope.tiratag6 = function(){
        if($scope.auxtagbutton6){
          $scope.auxtagbutton6 = false;
          $scope.auxtagbutton6aux = true;
        }else{
          $scope.auxtagbutton6 = true;
          $scope.auxtagbutton6aux = false;
        }
    }

    $scope.tiratag7 = function(){
        if($scope.auxtagbutton7){
          $scope.auxtagbutton7 = false;
          $scope.auxtagbutton7aux = true;
        }else{
          $scope.auxtagbutton7 = true;
          $scope.auxtagbutton7aux = false;
        }
    }
    $scope.tiratag8 = function(){
        if($scope.auxtagbutton8){
          $scope.auxtagbutton8 = false;
          $scope.auxtagbutton8aux = true;
        }else{
          $scope.auxtagbutton8 = true;
          $scope.auxtagbutton8aux = false;
        }
    }
    $scope.tiratag9 = function(){
        if($scope.auxtagbutton9){
          $scope.auxtagbutton9 = false;
          $scope.auxtagbutton9aux = true;
        }else{
          $scope.auxtagbutton9 = true;
          $scope.auxtagbutton9aux = false;
        }
    }
    $scope.tiratag10 = function(){
        if($scope.auxtagbutton10){
          $scope.auxtagbutton10 = false;
          $scope.auxtagbutton10aux = true;
        }else{
          $scope.auxtagbutton10 = true;
          $scope.auxtagbutton10aux = false;
        }
    }
    $scope.tiratag11 = function(){
        if($scope.auxtagbutton11){
          $scope.auxtagbutton11 = false;
          $scope.auxtagbutton11aux = true;
        }else{
          $scope.auxtagbutton11 = true;
          $scope.auxtagbutton11aux = false;
        }
    }
    $scope.tiratag12 = function(){
        if($scope.auxtagbutton12){
          $scope.auxtagbutton12 = false;
          $scope.auxtagbutton12aux = true;
        }else{
          $scope.auxtagbutton12 = true;
          $scope.auxtagbutton12aux = false;
        }
    }
    $scope.tiratag13 = function(){
        if($scope.auxtagbutton13){
          $scope.auxtagbutton13 = false;
          $scope.auxtagbutton13aux = true;
        }else{
          $scope.auxtagbutton13 = true;
          $scope.auxtagbutton13aux = false;
        }
    }
    $scope.tiratag14 = function(){
        if($scope.auxtagbutton14){
          $scope.auxtagbutton14 = false;
          $scope.auxtagbutton14aux = true;
        }else{
          $scope.auxtagbutton14 = true;
          $scope.auxtagbutton14aux = false;
        }
    }
    $scope.tiratag15 = function(){
        if($scope.auxtagbutton15){
          $scope.auxtagbutton15 = false;
          $scope.auxtagbutton15aux = true;
        }else{
          $scope.auxtagbutton15 = true;
          $scope.auxtagbutton15aux = false;
        }
    }
    $scope.tiratag16 = function(){
        if($scope.auxtagbutton16){
          $scope.auxtagbutton16 = false;
          $scope.auxtagbutton16aux = true;
        }else{
          $scope.auxtagbutton16 = true;
          $scope.auxtagbutton16aux = false;
        }
    }
    $scope.tiratag17 = function(){
        if($scope.auxtagbutton17){
          $scope.auxtagbutton17 = false;
          $scope.auxtagbutton17aux = true;
        }else{
          $scope.auxtagbutton17 = true;
          $scope.auxtagbutton17aux = false;
        }
    }
    $scope.tiratag18 = function(){
        if($scope.auxtagbutton18){
          $scope.auxtagbutton18 = false;
          $scope.auxtagbutton18aux = true;
        }else{
          $scope.auxtagbutton18 = true;
          $scope.auxtagbutton18aux = false;
        }
    }

    
  $scope.Salvar = function() {
 
      if($scope.auxtagbutton1 == false){
        if ($scope.user.interesse == undefined) {
          $scope.user.interesse = $scope.user.auxtag1;
        }else{
          $scope.user.interesse = $scope.user.interesse + ' ' +$scope.user.auxtag1;
        }
      }
      if($scope.auxtagbutton2 == false){
        if ($scope.user.interesse == undefined) {
          $scope.user.interesse = $scope.user.auxtag2;
        }else{
          $scope.user.interesse = $scope.user.interesse + ' ' +$scope.user.auxtag2;
        }
      }
      if($scope.auxtagbutton3 == false){
        if ($scope.user.interesse == undefined) {
          $scope.user.interesse = $scope.user.auxtag3;
        }else{
          $scope.user.interesse = $scope.user.interesse + ' ' +$scope.user.auxtag3;
        }
      }
      if($scope.auxtagbutton4 == false){
        if ($scope.user.interesse == undefined) {
          $scope.user.interesse = $scope.user.auxtag4;
        }else{
          $scope.user.interesse = $scope.user.interesse + ' ' +$scope.user.auxtag4;
        }
      }
      if($scope.auxtagbutton5 == false){
        if ($scope.user.interesse == undefined) {
          $scope.user.interesse = $scope.user.auxtag5;
        }else{
          $scope.user.interesse = $scope.user.interesse + ' ' +$scope.user.auxtag5;
        }
      }
      if($scope.auxtagbutton6 == false){
        if ($scope.user.interesse == undefined) {
          $scope.user.interesse = $scope.user.auxtag6;
        }else{
          $scope.user.interesse = $scope.user.interesse + ' ' +$scope.user.auxtag6;
        }
      }
      if($scope.auxtagbutton7 == false){
        if ($scope.user.interesse == undefined) {
          $scope.user.interesse = $scope.user.auxtag7;
        }else{
          $scope.user.interesse = $scope.user.interesse + ' ' +$scope.user.auxtag7;
        }
      }
      if($scope.auxtagbutton8 == false){
        if ($scope.user.interesse == undefined) {
          $scope.user.interesse = $scope.user.auxtag8;
        }else{
          $scope.user.interesse = $scope.user.interesse + ' ' +$scope.user.auxtag8;
        }
      }
      if($scope.auxtagbutton9 == false){
        if ($scope.user.interesse == undefined) {
          $scope.user.interesse = $scope.user.auxtag9;
        }else{
          $scope.user.interesse = $scope.user.interesse + ' ' +$scope.user.auxtag9;
        }
      }
      if($scope.auxtagbutton10 == false){
        if ($scope.user.interesse == undefined) {
          $scope.user.interesse = $scope.user.auxtag10;
        }else{
          $scope.user.interesse = $scope.user.interesse + ' ' +$scope.user.auxtag10;
        }
      }
      if($scope.auxtagbutton11 == false){
        if ($scope.user.interesse == undefined) {
          $scope.user.interesse = $scope.user.auxtag11;
        }else{
          $scope.user.interesse = $scope.user.interesse + ' ' +$scope.user.auxtag11;
        }
      }
      if($scope.auxtagbutton12 == false){
        if ($scope.user.interesse == undefined) {
          $scope.user.interesse = $scope.user.auxtag12;
        }else{
          $scope.user.interesse = $scope.user.interesse + ' ' +$scope.user.auxtag12;
        }
      }
      if($scope.auxtagbutton13 == false){
        if ($scope.user.interesse == undefined) {
          $scope.user.interesse = $scope.user.auxtag13;
        }else{
          $scope.user.interesse = $scope.user.interesse + ' ' +$scope.user.auxtag13;
        }
      }
      if($scope.auxtagbutton14 == false){
        if ($scope.user.interesse == undefined) {
          $scope.user.interesse = $scope.user.auxtag14;
        }else{
          $scope.user.interesse = $scope.user.interesse + ' ' +$scope.user.auxtag14;
        }
      }
      if($scope.auxtagbutton15 == false){
        if ($scope.user.interesse == undefined) {
          $scope.user.interesse = $scope.user.auxtag15;
        }else{
          $scope.user.interesse = $scope.user.interesse + ' ' +$scope.user.auxtag15;
        }
      }
      if($scope.auxtagbutton16 == false){
        if ($scope.user.interesse == undefined) {
          $scope.user.interesse = $scope.user.auxtag16;
        }else{
          $scope.user.interesse = $scope.user.interesse + ' ' +$scope.user.auxtag16;
        }
      }
      if($scope.auxtagbutton17 == false){
        if ($scope.user.interesse == undefined) {
          $scope.user.interesse = $scope.user.auxtag17;
        }else{
          $scope.user.interesse = $scope.user.interesse + ' ' +$scope.user.auxtag17;
        }
      }
      if($scope.auxtagbutton18 == false){
        if ($scope.user.interesse == undefined) {
          $scope.user.interesse = $scope.user.auxtag18;
        }else{
          $scope.user.interesse = $scope.user.interesse + ' ' +$scope.user.auxtag18;
        }
      }
      if (!$scope.user.interesse) {
        var alertPopup = $ionicPopup.alert({
          title: '(⊙﹏⊙✿)',
          template: 'Selecione pelo menos um desses!'
        });
      }else{
        var link = 'https://ec2.diwoapp.com.br/deletainteresse.php';
        $http.post(link, {iduser : $scope.user.iduser}).then(function (res){
          console.log(res.success, "delete interesse");

            var res = $scope.user.interesse.split(" ") ;
            for (var i = 0; i<res.length;i++){
              if(res[i][0]!='#'){
                res[i]= '#' + res[i];
              }
              console.log(res[i], "tags")
              var link = 'https://ec2.diwoapp.com.br/criarinteresse.php';
                $http.post(link, {iduser : $scope.user.iduser, 
                                  interesse : res[i]}).then(function (res){console.log(
                                    res.success, "criou interesse")
                                });
            }
            window.localStorage.setItem( 'user', JSON.stringify($scope.user));
            formUser.updateForm($scope.user);
            $state.go('tabsController.editarPerfil');

        });
        
      }


            
  };


}])

.controller('comercioeditaoqtemCtrl', ['$scope', '$stateParams', 'formUser','formComercio', 'EventoService','$ionicPopup', '$timeout','$state', '$cordovaCamera', '$cordovaFile', '$cordovaFileTransfer', '$ionicLoading', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, formUser, formComercio, EventoService, $ionicPopup, $timeout, $state, $cordovaCamera, $cordovaFile, $cordovaFileTransfer, $ionicLoading) {
  $scope.user = formUser.getForm();
  $scope.comercio = formComercio.getForm();

  $scope.$on("$ionicView.enter", function(event, data){    
    $scope.user = formUser.getForm();
    $scope.comercio = formComercio.getForm();
    

    $scope.comercio.auxsemana1 = 'Arcondicionado';
    $scope.comercio.auxsemana2 = 'Areadefumante'; 
    $scope.comercio.auxsemana3 = 'Estacionamento'; 
    $scope.comercio.auxsemana4 = 'Pets'; 
    $scope.comercio.auxsemana5 = 'PNE';  
    $scope.comercio.auxsemana6 = 'Wifi'; 

    var oqtem = $scope.comercio.oqtem.split(" ") ;
    var dw = oqtem.length
    $scope.auxsemanabutton1 = true;
    //$scope.auxsemanabutton1aux = true;
    $scope.auxsemanabutton2 = true;
    //$scope.auxsemanabutton2aux = true;
    $scope.auxsemanabutton3 = true;
   // $scope.auxsemanabutton3aux = true;
    $scope.auxsemanabutton4 = true;
    //$scope.auxsemanabutton4aux = true;
    $scope.auxsemanabutton5 = true;
    //$scope.auxsemanabutton5aux = true;
    $scope.auxsemanabutton6 = true;
    //$scope.auxsemanabutton6aux = true;
    $scope.auxsemanabutton7 = true;
    //$scope.auxsemanabutton7aux = true;
    for(var i = 0; i<dw;i++){
      if(oqtem[i] == "Arcondicionado"){
        $scope.auxsemanabutton1 = false;
        $scope.auxsemanabutton1aux = true;
      }
      if(oqtem[i] == "Areadefumante"){
        $scope.auxsemanabutton2 = false;
        $scope.auxsemanabutton2aux = true;
      }
      if(oqtem[i] == "Estacionamento"){
        $scope.auxsemanabutton3 = false;
        $scope.auxsemanabutton3aux = true;
      }
      if(oqtem[i] == "Pets"){
        $scope.auxsemanabutton4 = false;
        $scope.auxsemanabutton4aux = true;
      }
      if(oqtem[i] == "PNE"){
        $scope.auxsemanabutton5 = false;
        $scope.auxsemanabutton5aux = true;
      }
      if(oqtem[i] == "Wifi"){
        $scope.auxsemanabutton6 = false;
        $scope.auxsemanabutton6aux = true;
      }
      // if(semanafuncionamento[i] == "Sab"){
      //   $scope.auxsemanabutton7 = true;
      //   $scope.auxsemanabutton7aux = false;
      // }
    }
    
    
    
  });
  
  
    $scope.tirasemana1 = function(){
        if($scope.auxsemanabutton1){
          $scope.auxsemanabutton1 = false;
          $scope.auxsemanabutton1aux = true;
        }else{
          $scope.auxsemanabutton1 = true;
          $scope.auxsemanabutton1aux = false;
        }
    }
    $scope.tirasemana2 = function(){
        if($scope.auxsemanabutton2){
          $scope.auxsemanabutton2 = false;
          $scope.auxsemanabutton2aux = true;
        }else{
          $scope.auxsemanabutton2 = true;
          $scope.auxsemanabutton2aux = false;
        }
    }
    $scope.tirasemana3 = function(){
        if($scope.auxsemanabutton3){
          $scope.auxsemanabutton3 = false;
          $scope.auxsemanabutton3aux = true;
        }else{
          $scope.auxsemanabutton3 = true;
          $scope.auxsemanabutton3aux = false;
        }
    }
    $scope.tirasemana4 = function(){
        if($scope.auxsemanabutton4){
          $scope.auxsemanabutton4 = false;
          $scope.auxsemanabutton4aux = true;
        }else{
          $scope.auxsemanabutton4 = true;
          $scope.auxsemanabutton4aux = false;
        }
    }
    $scope.tirasemana5 = function(){
        if($scope.auxsemanabutton5){
          $scope.auxsemanabutton5 = false;
          $scope.auxsemanabutton5aux = true;
        }else{
          $scope.auxsemanabutton5 = true;
          $scope.auxsemanabutton5aux = false;
        }
    }
    $scope.tirasemana6 = function(){
        if($scope.auxsemanabutton6){
          $scope.auxsemanabutton6 = false;
          $scope.auxsemanabutton6aux = true;
        }else{
          $scope.auxsemanabutton6 = true;
          $scope.auxsemanabutton6aux = false;
        }
    }

    $scope.tirasemana7 = function(){
        if($scope.auxsemanabutton7){
          $scope.auxsemanabutton7 = false;
          $scope.auxsemanabutton7aux = true;
        }else{
          $scope.auxsemanabutton7 = true;
          $scope.auxsemanabutton7aux = false;
        }
    }
          
  $scope.Salvar = function(){
    delete $scope.comercio.oqtem

      if($scope.auxsemanabutton1aux == true){
        if ($scope.comercio.oqtem == undefined) {
          $scope.comercio.oqtem = $scope.comercio.auxsemana1;
        }else{
          $scope.comercio.oqtem = $scope.comercio.oqtem + ' ' +$scope.comercio.auxsemana1;
        }
      }
      if($scope.auxsemanabutton2aux == true){
        if ($scope.comercio.oqtem == undefined) {
          $scope.comercio.oqtem = $scope.comercio.auxsemana2;
        }else{
          $scope.comercio.oqtem = $scope.comercio.oqtem + ' ' +$scope.comercio.auxsemana2;
        }
      }
      if($scope.auxsemanabutton3aux == true){
        if ($scope.comercio.oqtem == undefined) {
          $scope.comercio.oqtem = $scope.comercio.auxsemana3;
        }else{
          $scope.comercio.oqtem = $scope.comercio.oqtem + ' ' +$scope.comercio.auxsemana3;
        }
      }
      if($scope.auxsemanabutton4aux == true){
        if ($scope.comercio.oqtem == undefined) {
          $scope.comercio.oqtem = $scope.comercio.auxsemana4;
        }else{
          $scope.comercio.oqtem = $scope.comercio.oqtem + ' ' +$scope.comercio.auxsemana4;
        }
      }
      if($scope.auxsemanabutton5aux == true){
        if ($scope.comercio.oqtem == undefined) {
          $scope.comercio.oqtem = $scope.comercio.auxsemana5;
        }else{
          $scope.comercio.oqtem = $scope.comercio.oqtem + ' ' +$scope.comercio.auxsemana5;
        }
      }
      if($scope.auxsemanabutton6aux == true){
        if ($scope.comercio.oqtem == undefined) {
          $scope.comercio.oqtem = $scope.comercio.auxsemana6;
        }else{
          $scope.comercio.oqtem = $scope.comercio.oqtem + ' ' +$scope.comercio.auxsemana6;
        }
      }
      // if($scope.auxsemanabutton7 == true){
      //   if ($scope.comercio.oqtem == undefined) {
      //     $scope.comercio.oqtem = $scope.comercio.auxsemana;
      //   }else{
      //     $scope.comercio.oqtem = $scope.comercio.oqtem + ' ' +$scope.comercio.auxsemana7;
      //   }
      // }


      // if (!$scope.comercio.horariofuncionamento && !$scope.comercio.semanafuncionamento) {
      //   var alertPopup = $ionicPopup.alert({
      //     title: '(⊙﹏⊙✿)',
      //     template: 'Selecione pelo menos um desses!'
      //   });
      // }else{
        console.log($scope.comercio.oqtem)
        EventoService.atualizarperfil($scope.user).then(function(msg){
          EventoService.atualizarperfilComercio($scope.comercio);
          formComercio.updateForm($scope.comercio);
          formUser.updateForm($scope.user);
          $state.go('ComercioEditaPerfil');
        }, function(errMsg) {
          var alertPopup = $ionicPopup.alert({
            title: 'Register failed!',
            template: errMsg
          });
          alertPopup.then(function(){
                    $state.go('logando');
          })
        })
      //}
  }
}])

.controller('comercioeditadescontopacoteCtrl', ['$scope', '$stateParams', 'formUser','formComercio', 'EventoService','$ionicPopup', '$timeout','$state', '$cordovaCamera', '$cordovaFile', '$cordovaFileTransfer', '$ionicLoading', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, formUser, formComercio, EventoService, $ionicPopup, $timeout, $state, $cordovaCamera, $cordovaFile, $cordovaFileTransfer, $ionicLoading) {
  $scope.user = formUser.getForm();
  $scope.comercio = formComercio.getForm();
  

  $scope.$on("$ionicView.enter", function(event, data){    
    $scope.user = formUser.getForm();
    $scope.comercio = formComercio.getForm();
    // var res1 = $scope.comercio.descontopacote.split("\n\r") ;
    // if(res1.length>1){
    //   for(var w = 0; w < res1.length; w++){
    //     var res2 = res1[w].split(" ");
    //     if(res2[1] == )
    //   }
    // }

  });

  // var auxadd = 0
  // $scope.addDesconto = function() {
  //   if(auxadd == 0){
  //     $scope.desc1 = true;
  //     auxadd++; 
  //   }else{
  //     if(auxadd == 1){
  //       $scope.desc2 = true; 
  //     }
  //   }
  // };

  // $scope.removeDesconto = function() {
  //   if(auxadd == 1){
  //     $scope.desc2 = false;
  //     auxadd--; 
  //   }else{
  //     if(auxadd == 0){
  //       $scope.desc1 = false; 
  //     }
  //   }
  // };

  $scope.Salvar = function(){
    if($scope.comercio.descontopacote){
    EventoService.atualizarperfilComercio($scope.comercio);
      //console.log($scope.comercio.precopor, "$scope.comercio.precopor")
      formComercio.updateForm($scope.comercio);
      formUser.updateForm($scope.user);
      $state.go('ComercioEditaPerfil');
          }else{
            var alertPopup = $ionicPopup.alert({
              title: 'Erro',
              template: 'Por favor não deixe o campo'
            });
          }
    
          
    //console.log($scope.comercio.precopor, "$scope.comercio.precopor")
      }
}])



.controller('CriarEventoComercioCtrl', ['$scope', '$stateParams', 'formUser', 'formLoc', 'EventoService', 'formAux', '$state','$timeout', '$ionicPopup', '$http', 'formOutro', 'formItem', 'formtela', 'formtelanoti', 'formtipologin','formEventoPerfil', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, formUser, formLoc, EventoService, formAux, $state, $timeout, $ionicPopup, $http, formOutro, formItem, formtela, formtelanoti, formtipologin, formEventoPerfil) {
  
  $scope.evento = {};
  $scope.user = formUser.getForm();

  if($scope.user.iduser =='53'){
    $scope.preco = 30;
    $scope.precopor = 1;
  }else{
    $scope.preco = 20;
    $scope.precopor = 0; 
  }

  var currentdate = new Date(); 
  var curr_date2 = (currentdate.getDate()<10?'0':'') + currentdate.getDate();
  var curr_month2 = (currentdate.getMonth()<10?'0':'') + (currentdate.getMonth() + 1); //Months are zero based
  var curr_year2 = currentdate.getFullYear();
  var h22 = (currentdate.getHours()<10?'0':'') + currentdate.getHours();
  var m22 = (currentdate.getMinutes()<10?'0':'') + currentdate.getMinutes();

  $scope.muda = function(){
          curr_date = ($scope.evento.date.getDate()<10?'0':'') + $scope.evento.date.getDate();
          curr_month = ($scope.evento.date.getMonth()<9?'0':'') + ($scope.evento.date.getMonth() + 1); //Months are zero based
          curr_year = $scope.evento.date.getFullYear();
          h2 = ($scope.evento.date.getHours()<10?'0':'') + $scope.evento.date.getHours();
          m2 = ($scope.evento.date.getMinutes()<10?'0':'') + $scope.evento.date.getMinutes();
          s2 = ($scope.evento.date.getSeconds()<10?'0':'') + $scope.evento.date.getSeconds();
          $scope.evento.semana = $scope.evento.date.getDay();
          var j = curr_year + "-" + curr_month + "-" + curr_date+ ' '+h2 + ':' + m2 + ':' + s2;
          $scope.evento.diainicio = j;
          ano = curr_year-curr_year2;
          mes = curr_month-curr_month2;
          dia = curr_date-curr_date2;
          h = h2-h22;
          m = m2-m22;
          
              if(ano<0){
                 var alertPopup = $ionicPopup.alert({
                    title: 'Falha na data!!',
                    template: 'Coloque uma data valida s`il vous plait'
                  });
                 $scope.evento.date = '';
                console.log('data invalida');
              }else{
                if (ano == 0) {
                  if(mes<0){
                    var alertPopup = $ionicPopup.alert({
                      title: 'Falha na data!!',
                      template: 'Coloque uma data valida s`il vous plait'
                    });
                    $scope.evento.date = '';
                    console.log('data invalida');
                  }else{
                    if (mes==0) {
                      if(dia<0){
                        var alertPopup = $ionicPopup.alert({
                        title: 'Falha na data!!',
                        template: 'Coloque uma data valida s`il vous plait'
                      });
                        $scope.evento.date = '';
                        console.log('data invalida');
                      }else{
                        if (dia==0 && h<0){
                          var alertPopup = $ionicPopup.alert({
                            title: 'ヽ ( ꒪д꒪ )ﾉ',
                            template: 'Muito em cima da hora para criar um evento, no mínimo umas 3 horas de antecedência'
                          });
                          console.log('data invalida');
                          $scope.evento.date = '';
                        }else{
                          $scope.evento.date = $scope.evento.date.toLocaleString();

                        }
                      }
                    }
                  }
                }
              }
  }

  $scope.getCriar = function(evento){
    if($scope.evento.semana == 0){
      $scope.evento.semana = "Domingo";
    }
    if($scope.evento.semana == 1){
      $scope.evento.semana = "Segunda-feira";
    }
    if($scope.evento.semana == 2){
      $scope.evento.semana = "Terça-feira";
    }
    if($scope.evento.semana == 3){
      $scope.evento.semana = "Quarta-feira";
    }
    if($scope.evento.semana == 4){
      $scope.evento.semana = "Quinta-feira";
    }
    if($scope.evento.semana == 5){
      $scope.evento.semana = "Sexta-feira";
    }
    if($scope.evento.semana == 6){
      $scope.evento.semana = "Sábado";
    }
    var link = 'https://ec2.diwoapp.com.br/criarevento.php';
    $http.post(link, {nomeevento : $scope.evento.nomeevento, 
                                 // duracao : $scope.evento.duracao,
                                  diainicio : $scope.evento.diainicio,
                                  semana : $scope.evento.semana,
                                  diafim : $scope.evento.diainicio,
                                  //dialimiteconfirmacao: $scope.evento.dialimiteconfirmacao,
                                  pmin : '3', 
                                  patual : $scope.evento.pmax, 
                                  pmax : $scope.evento.pmax,
                                  adm : $scope.user.iduser,
                                  admusername : $scope.user.username,
                                  admapelido : $scope.user.apelido,
                                  preco : $scope.preco,
                                  precopor : $scope.precopor,  
                                  //nomelocal : $scope.evento.nomelocal,
                                  //endereco : $scope.evento.endereco,
                                  //cidade : $scope.evento.cidade,
                                  estado : 52,
                                  lat : $scope.user.lat,
                                  lng : $scope.user.long,
                                  //dificuldade :$scope.evento.dificuldade,
                                  //genero : $scope.evento.genero,
                                  idComercioParceiro : $scope.user.iduser,
                                  eventopic : $scope.user.profilepic,
                                  descricao : $scope.evento.descricao,
                                  comerciodevicetoken : $scope.user.devicetoken}).then(function (res){
                    $scope.responsecriado = res.data;
                    console.log(res.data.success, "criou");
                  if ($scope.responsecriado.success == true) {
                    $state.go('perfilComercio');
                  }
    });
  }



}])

.controller('notificacoesComercioCtrl', ['$scope', '$stateParams', 'formUser', 'EventoService', 'formAux','formPost', '$state','$timeout', '$ionicPopup', '$http', 'formOutro', 'formItem', 'formtela', 'formtelanoti','formEventoPerfil', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, formUser, EventoService, formAux,formPost, $state, $timeout, $ionicPopup, $http, formOutro, formItem, formtela, formtelanoti, formEventoPerfil) {
  
   $scope.data = {showDelete: false};
   $scope.evento = {};
   $scope.comentariovalido = {};
   $scope.outro ={};
   $scope.auxpost = {};
   $scope.aux = formUser.getForm();
   console.log($scope.aux);
   var aux1= 0;
   var aux2= 0;
   var k = 0;
   var noti ={};
   var ultima_noti_data;
   formtelanoti.updateForm(2);

   $scope.$on("$ionicView.enter", function(event, data){
      $scope.items = [];
      $scope.evento = {};
      $scope.auxpost = {};
      $scope.comentariovalido = {};
      $scope.outro ={};
      var aux1= 0;
      var aux2= 0;
      var k = 0;
      var noti ={};
      var ultima_noti_data;
      $scope.data = {showDelete: false};
      $scope.aux = formUser.getForm();
      EventoService.GetNotificacoes($scope.aux).then(function(aux) {
        for (var i = 0; i < aux.nrow; i++) {
          $scope.items[i] = aux[i];
          console.log($scope.items[i].notificacao);
          ultima_noti_data = $scope.items[0].datadecriacao;
          var curr_date = (aux[i].datadecriacao[8]+aux[i].datadecriacao[9]);
          var h2 = (aux[i].datadecriacao[11]+aux[i].datadecriacao[12]);
          h2 = parseInt(h2)-3;
          var m2 = (aux[i].datadecriacao[14]+aux[i].datadecriacao[15]);
          var curr_month = (aux[i].datadecriacao[5]+aux[i].datadecriacao[6]);
          var curr_year = (aux[i].datadecriacao[0]+aux[i].datadecriacao[1]+aux[i].datadecriacao[2]+aux[i].datadecriacao[3]);
          var j = curr_date + "/" + curr_month + "/" + curr_year+ ' '+h2 + ':' + m2;
          $scope.items[i].datadeenvio = j;
        }     
      });
      EventoService.GetComentariosfeitos($scope.aux).then(function(coments) { //
        aux1 = coments.length;
        $scope.feitos = coments;
      });
    });

   $scope.onItemDelete = function(item) {
    $scope.items.splice($scope.items.indexOf(item), 1);
    $http.post('https://ec2.diwoapp.com.br/deletanotificacao.php', {idnotificacao : item.idnotificacao});
   };

    $scope.enterItem =  function(item){
      formAux.updateAux(item.tipo);
      $http.post('https://ec2.diwoapp.com.br/geteventoporid.php', {idevento : item.idevento}).then(function (result){
        $scope.infoevento = result.data[0];
        formItem.updateForm($scope.infoevento);
        console.log($scope.infoevento.idevento);
      });
      if (item.tipo == '1') {
        formAux.updateAux(item);
        $state.go('perfilAceitar');
      }
      if (item.tipo == '8') {
        var alertPopup = $ionicPopup.alert({
          title: '(((( ;°Д°))))',
          template: 'Muita gente querendo ir no evento, mas como tu que manda podes aceitar ou não, ai é contigo'
        });
        alertPopup.then(function(){
          $http.post('https://ec2.diwoapp.com.br/deletanotificacao.php', {idnotificacao : item.idnotificacao}).then(function (res){
            $scope.response = res.data;
            console.log($scope.response.msg)
             $state.go('perfilAceitar');
          });
         
        })
      }
      if (item.tipo == '2') {
        var alertPopup = $ionicPopup.alert({
          title: '⁽(◍˃̵͈̑ᴗ˂̵͈̑)⁽',
          template: 'Agora é se preparar e não se esqueçer de comparecer ao evento'
        });
        alertPopup.then(function(){
          $http.post('https://ec2.diwoapp.com.br/deletanotificacao.php', {idnotificacao : item.idnotificacao}).then(function (res){
            $scope.response = res.data;
            console.log($scope.response.msg)
            $state.reload();
          });
          
        })
      }
      if (item.tipo == '3') {
        var alertPopup = $ionicPopup.alert({
          title: '（╬ಠ益ಠ)',
          template: 'Não se esqueça de comparecer aos eventos para seu indice de confirmação ser altos sempre'
        });
        alertPopup.then(function(){
          $http.post('https://ec2.diwoapp.com.br/deletanotificacao.php', {idnotificacao : item.idnotificacao}).then(function (res){
            $scope.response = res.data;
            console.log($scope.response.msg)
            $state.reload();
          });
          
        })
      }
      if (item.tipo == '4') {
        var alertPopup = $ionicPopup.alert({
          title: '(￣ω￣)',
          template: 'Fica de olho que mudou o evento, o organizador resolveu mudar algo no evento'
        });
        alertPopup.then(function(){
          $http.post('https://ec2.diwoapp.com.br/deletanotificacao.php', {idnotificacao : item.idnotificacao}).then(function (res){
            $scope.response = res.data;
            console.log($scope.response.msg)
            $state.go('tabsController.eventosAbertos');
          });
          
        })
      }
      if (item.tipo == '5') {
        var alertPopup = $ionicPopup.alert({
          title: 'ε-(>o<)',
          template: 'Nao vou mais, tive que cancelar'
        });
        alertPopup.then(function(){
          $http.post('https://ec2.diwoapp.com.br/deletanotificacao.php', {idnotificacao : item.idnotificacao}).then(function (res){
            $scope.response = res.data;
            console.log($scope.response.msg)
            $state.reload();
          });
          
        })
      }
       if (item.tipo == '13') {
        var alertPopup = $ionicPopup.alert({
          title: '(ﾉ^ヮ^)ﾉ*:・ﾟ✧',
          template: item.notificacao
        });
        alertPopup.then(function(){
          $http.post('https://ec2.diwoapp.com.br/deletanotificacao.php', {idnotificacao : item.idnotificacao}).then(function (res){
            $scope.response = res.data;
            console.log($scope.response.msg)
            $state.reload();
          });
          
        })
      }
      if (item.tipo == '9') {
        var alertPopup = $ionicPopup.alert({
          title: 'ಥ_ಥ',
          template: 'Você foi retirado do evento por algum motivo'
        });
        alertPopup.then(function(){
          $http.post('https://ec2.diwoapp.com.br/deletanotificacao.php', {idnotificacao : item.idnotificacao}).then(function (res){
            $scope.response = res.data;
            console.log($scope.response.msg)
            $state.reload();
          });
          
        })
      }
      if (item.tipo == '6' && item.id_user_envia == $scope.aux.iduser) {
        formtela.updateForm(1);
        var confirmPopup = $ionicPopup.show({
                   title: 'Confirme pá nóx',
                   template: 'Você foi mesmo no evento?',
                   buttons: [
                      { text: 'Não',
                        type: 'button-assertive',
                        onTap: function(e){
                          item.confirmacao = 'Não estive presente no evento ocorrido';
                          item.aceito = '5'; 
                          EventoService.atualizarpessoaevento(item);
                          $http.post('https://ec2.diwoapp.com.br/deletanotificacao.php', {idnotificacao : item.idnotificacao}).then(function (res){
                               $scope.response = res.data;
                               console.log($scope.response.msg)
                               $state.reload();
                             });
                           

                        }},
                      {
                        text: 'Sim',
                        type: 'button-positive',
                        onTap: function(e){
                          formAux.updateAux(item);
                          $state.go('qmFoiMesmo');
                        }}]
                 });
       }
       if (item.tipo == '6' && item.id_user_envia !=  $scope.aux.iduser) {
        formtela.updateForm(1);
        item.id_user_envia = $scope.aux.iduser;
          var confirmPopup = $ionicPopup.show({
                   title: 'Confirme pá nóx',
                   template: 'Você foi mesmo no evento?',
                   buttons: [
                      { text: 'Não',
                        type: 'button-assertive',
                        onTap: function(e){
                          item.confirmacao = 'Não estive presente no evento ocorrido';
                          item.aceito = '5'; 
                          EventoService.atualizarpessoaevento(item);
                            $http.post('https://ec2.diwoapp.com.br/deletanotificacao.php', {idnotificacao : item.idnotificacao}).then(function (res){
                               $scope.response = res.data;
                               console.log($scope.response.msg)
                               $state.reload();
                             });
                            

                        }},
                      {
                        text: 'Sim',
                        type: 'button-positive',
                        onTap: function(e){
                          formAux.updateAux(item);
                          $state.go('tabsController.avaliaODoEvento');
                        }}]
                 });

      }
      if (item.tipo == '400') {
        var alertPopup = $ionicPopup.alert({
          title: 'Novo comentário no post',
          template: item.notificacao
        });
        alertPopup.then(function(){
          $http.post('https://ec2.diwoapp.com.br/deletanotificacao.php', {idnotificacao : item.idnotificacao}).then(function (res){
            $scope.response = res.data;
            console.log($scope.response.msg)
            $state.reload();
          });
        })
      }
      if (item.tipo == '10') {
        var alertPopup = $ionicPopup.alert({
          title: '└(・-・)┘',
          template: 'Não foi dessa vez'
        });
        alertPopup.then(function(){
          $http.post('https://ec2.diwoapp.com.br/deletanotificacao.php', {idnotificacao : item.idnotificacao}).then(function (res){
            $scope.response = res.data;
            console.log($scope.response.msg)
            $state.reload();
          });
          
        })
      }
      if (item.tipo == '11') {
        var alertPopup = $ionicPopup.alert({
          title: '⁽(◍˃̵͈̑ᴗ˂̵͈̑)⁽',
          template: 'Sou muito pop'
        });
        alertPopup.then(function(){
          $http.post('https://ec2.diwoapp.com.br/deletanotificacao.php', {idnotificacao : item.idnotificacao}).then(function (res){
            $scope.response = res.data;
            console.log($scope.response.msg)
            $state.reload();
          });
          
        })
      }
       if(item.tipo == '12'){
        $http.post('https://ec2.diwoapp.com.br/geteventoporid.php', {idevento :  item.idevento}).then(function (result){
          $scope.evento = result.data[0];
        });
        var myPopup = $ionicPopup.show({
                        template: 'Uma pessoa desistiu e agora o numero de pessoas confirmadas no evento é menor que o minimo. Deseja fazer o evento mesmo assim? (Caso cancele nao receberás penalidade)',
                        title: 'Vish',
                        scope: $scope,
                        buttons: [
                       { text: 'Vou ver' 
                         //close popup and do nothing
                       },
                       {
                        text: 'Vai rolar',
                        type: 'button-balanced',
                        onTap: function(e) {  
                          console.log('evento acontece normalmente')
                        }
                       },
                       {
                        text: 'Cancelar',
                        type: 'button-assertive',
                        onTap: function(e) { 
                          EventoService.Cancelarevento($scope.evento);
                          console.log('Vou cancelar o evento', $scope.evento.nomeevento);
                        }
                       }]
                      });
       }
        if (item.tipo == '400') {
        $scope.auxpost.idposts = item.idevento;
        EventoService.PostGet($scope.auxpost).then(function(post) {
          $scope.auxpost = post;
        });
        var alertPopup = $ionicPopup.alert({
          title: 'Novo comentário no post',
          template: item.notificacao
        });
        alertPopup.then(function(){
          $http.post('https://ec2.diwoapp.com.br/deletanotificacao.php', {idnotificacao : item.idnotificacao}).then(function (res){
            $scope.response = res.data;
            console.log($scope.response.msg)
            formPost.updatePost( $scope.auxpost);
            $state.go('tabsController.post');
          });
        })
      }
      if (item.tipo == '401') {
        $scope.auxpost.idposts = item.idevento;
        EventoService.PostGet($scope.auxpost).then(function(post) {
          $scope.auxpost = post;
        });
        var alertPopup = $ionicPopup.alert({
          title: '٩(˃̶͈̀௰˂̶͈́)و',
          template: item.notificacao
        });
        alertPopup.then(function(){
          $http.post('https://ec2.diwoapp.com.br/deletanotificacao.php', {idnotificacao : item.idnotificacao}).then(function (res){
            $scope.response = res.data;
            console.log($scope.response.msg)
            formPost.updatePost( $scope.auxpost);
            $state.go('tabsController.post');
          });
        })
      }

       if (item.tipo == '7') {
          
          //console.log(item.idevento);
          //console.log(item.id_user_envia);
          for (var i = 0 ; i<aux1 ; i++){
            if ($scope.feitos[i].idevento == item.idevento && item.id_user_envia == $scope.feitos[i].idpessoaavaliada && item.username_envia == $scope.feitos[i].nomepessoaavaliada) {
              $scope.comentariovalido = $scope.feitos[i]; 
              aux2 = 1;
              k++;
            }
          }
          if (aux2 == 1) {
            formtela.updateForm(1);
            var alertPopup = $ionicPopup.alert({
                      title: 'ヽ(〃･ω･)ﾉ',
                      template: 'Curioso? Vamos ver o que escreveram sobre mim'
                    });
            formtela.updateForm(2);
          alertPopup.then(function(){
                   $http.post('https://ec2.diwoapp.com.br/deletanotificacao.php', {idnotificacao : item.idnotificacao}).then(function (res){
                               $scope.response = res.data;
                               console.log($scope.response.msg)
                             });
                  formEventoPerfil.updateForm($scope.evento);
                  $state.go('tabsController.perfil');
                    })
          }else{

            var alertPopup = $ionicPopup.alert({
                      title: '(`へ´*)ノ',
                      template: 'Avalie!!! Conseguirás ver só se você avaliar o outro, tipo um troca troca'
                    });
            alertPopup.then(function(){
                   $http.post('https://ec2.diwoapp.com.br/deletanotificacao.php', {idnotificacao : item.idnotificacao}).then(function (res){
                               $scope.response = res.data;
                               console.log($scope.response.msg)
                             });
                   $scope.outro.iduser = item.id_user_envia;
                   formOutro.updateForm($scope.outro);
                   formtela.updateForm(1); 
                   formEventoPerfil.updateForm($scope.evento);

                            // TEM QUE IR PARA PAGINA DE AVALIAR A PESSOA NAQUELE EVENTO
                          $state.go('tabsController.perfil');
                    })

          }

       }
       if (item.tipo == '13') {   /// comercio nao tem horario agora
        var alertPopup = $ionicPopup.alert({
          title: '⁽(◍˃̵͈̑ᴗ˂̵͈̑)⁽',
          template: 'Infelizmente o local não esta com horário disponível'
        });
        alertPopup.then(function(){
          $http.post('https://ec2.diwoapp.com.br/deletanotificacao.php', {idnotificacao : item.idnotificacao}).then(function (res){
            $scope.response = res.data;
            console.log($scope.response.msg);
            $state.reload();
          });
        })
      }
      // if (item.tipo == '14') {   /// comercio nao tem horario agora
      //   var confirmPopup = $ionicPopup.show({
      //              title: 'Horário indisponivel',
      //              template: $scope.response.notificacao,
      //              buttons: [
      //                 { text: 'Não',
      //                   type: 'button-assertive',
      //                   onTap: function(e){
      //                     item.confirmacao = 'Não estive presente no evento ocorrido';
      //                     item.aceito = '5'; 
      //                     EventoService.atualizarpessoaevento(item);
      //                       $http.post('https://ec2.diwoapp.com.br/deletanotificacao.php', {idnotificacao : item.idnotificacao}).then(function (res){
      //                          $scope.response = res.data;
      //                          $state.reload();
      //                        });

      //                   }},
      //                 {
      //                   text: 'Sim',
      //                   type: 'button-positive',
      //                   onTap: function(e){
      //                   }}]
      //            });
      // }

   
   }
   $scope.doRefresh = function() {
    var refresh = {};
    refresh.iduser = $scope.aux.iduser;  
    refresh.datadaultima = ultima_noti_data;
          console.log($scope.aux.iduser , ultima_noti_data)
           EventoService.GetNoti(refresh).then(function(resp) {
              console.log(resp, resp.length);
              if(resp == "Error"){
                console.log("Nao tem notificação nova")
              }else{
                $scope.items =resp.concat($scope.items);
              }
            });

        $scope.$broadcast('scroll.refreshComplete');
        }


}])

.controller('campanhacriaCtrl', ['$scope', '$stateParams', 'formUser','formComercio', '$interval', 'EventoService', 'formAux', '$state','$timeout', '$ionicPopup', '$http', 'formOutro', 'formItem', 'formtela', 'formtelanoti', 'formtipologin','formEventoCampanha', '$ionicTabsDelegate','formLimiteatuacao',  // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, formUser,formComercio, $interval, EventoService, formAux, $state, $timeout, $ionicPopup, $http, formOutro, formItem, formtela, formtelanoti, formtipologin, formEventoCampanha, $ionicTabsDelegate,formLimiteatuacao) {
  
  $scope.evento = {};
  $scope.user = formUser.getForm();
  $scope.comercio = formComercio.getForm();
  var datainvalida = 0;
  $scope.$on("$ionicView.enter", function(event, data){
    $ionicTabsDelegate.showBar(1);
    $scope.evento = formEventoCampanha.getForm();
    $scope.user = formUser.getForm();
    $scope.comercio = formComercio.getForm();
    $scope.ncampanhas30 = 4;
    //$scope.camapanhascriadas = {};
    var auxdestroidata;
    EventoService.GetCampanhasCriadas($scope.user).then(function(campanhas) { //
        $scope.camapanhascriadas = campanhas;
        console.log(campanhas[0].datadecriacao,"campanhas[0].datadecriacao")
        if(campanhas!='Error'){
          $scope.ncampanhas30 = 4 - campanhas.length;
          if($scope.ncampanhas30<=0){
            $scope.naopodemaislancar = true;
            var auxdestroidata = campanhas[0].datadecriacao.substr(0, 10) + "T" + campanhas[0].datadecriacao.substr(11, 8);
            var date = new Date(auxdestroidata);
            date.setTime(date.getTime() + (30 * 24 * 60 * 60 * 1000));
            console.log(auxdestroidata, date)
            $scope.unixDateTimeValue = Date.parse(date);
          //we finally have datetimeValue when there's a change
          //console.log('Time changed to: ' + $scope.unixDateTimeValue)
          $scope.start();
          $scope.positiveTime = true;
          }
        }else{
          $scope.ncampanhas30 = 4;
        }
        console.log( campanhas.length, "campanhas")
      });
  })

  var interval;
  $scope.positiveTime; //This is for the ng-show of the unixdate/time
  $scope.unixDateTimeValue;

   /* This block is the JS for the date-time-picker  */
    /*  run onTimeChanged when the time changes, it will save the unixTime and dateTimeString, start the timer (if not already satrted),  and make $scope.positiveTime true */
    
    /* If the text changes, we check if the time is not undefined */
    $scope.dateTimeStringChanged = function() {
      if ($scope.unixDateTimeValue = 'undefined') {
        //console.log("dateStorageArray[0] in dateTimeStringChanged: " + $scope.dateStorageArray[0]);
        // if ($scope.dateStorageArray != null) {
        //   $scope.unixDateTimeValue = $scope.dateStorageArray[$scope.dateStorageArray.length - 1]; //Load the timer from memory and place it in the countdown
        //   $scope.positiveTime = true;
        //   console.log("dateStorageArray if $scope.dateStorageArray != null: " + $scope.dateStorageArray[0]);
        // }

        console.log("stringchanged false");
      } else {
        $scope.positiveTime = true;
        console.log("stringchanged true ");
      }
    };

    /*
    Does all the math with the unix time, will return a string called finalTimeLeft and timeLeftSeconds. The math for the other functions uses timeLeftSeconds.

    Everytime the function is called, it will subtract current time and the end time and return the string and integer left. If called every second it will count down.

    */
    $scope.unixCountdown = function() {
      /* Example countdown beginning:
      // var endTime = new Date("April 7, 2016 12:33:00 PM CDT");
      // var endTime = (Date.parse(endTime)) / 1000; */

      // if($scope.unixDateTimeValue == 'undefined' || endTime == 'undefined'){                                       $window.localStorage['Unix_Time_Value'] = $scope.unixDateTimeValue;
      // }
      var endTime = $scope.unixDateTimeValue;

      var countdownUnixDate = endTime / 1000; //Unix time goes in endTime;
      var now = new Date(); //Initializes a new Date() object at launch. This is the current time.
      var now = (Date.parse(now) / 1000);
      var timeLeft = countdownUnixDate - now; //subtracts the end time from the current time.
      $scope.timeLeftSeconds = timeLeft; //timeLeftSeconds is an interger of the time left in seconds that will be returned

      /* The rest of this function is basically stringifying the Unix time into days, hours, minutes and seconds left until endTime */
      $scope.days = Math.floor(timeLeft / 86400);
      $scope.hours = Math.floor((timeLeft - ($scope.days * 86400)) / 3600);
      $scope.minutes = Math.floor((timeLeft - ($scope.days * 86400) - ($scope.hours * 3600)) / 60);
      $scope.seconds = Math.floor((timeLeft - ($scope.days * 86400) - ($scope.hours * 3600) - ($scope.minutes * 60)));

      /* if the hours, minutes, or seconds are less than 10, we give them a leading zero */
      if ($scope.hours < "10") {
        hours = "0" + $scope.hours;
      }
      if ($scope.minutes < "10") {
        $scope.minutes = "0" + $scope.minutes;
      }
      if ($scope.seconds < "10") {
        $scope.seconds = "0" + $scope.seconds;
      }

      //Puts the final string together
      $scope.finalTimeLeft = $scope.days + ' dias ' + $scope.hours + ' horas ' ;
      
      return ($scope.finalTimeLeft, $scope.timeLeftSeconds);
    }

    /* start() is the function that runs the $interval running tick every (second) */
    $scope.start = function() {
      $scope.stop();
      interval = $interval(tick, 1000); //we saved it as the variable "interval" so that we can cancel the $interval when we need to in $scope.stop()
    };

    $scope.stop = function() { // stops the $interval when called.
      $interval.cancel(interval);
    };

    $scope.start(); //start tick which will run once every second.
    $scope.dateTimeStringChanged(); // run function at start
    /* This is run everytime start() calls it it's basically our ticker */
    function tick() {
      // console.log('tick');
      $scope.unixCountdown();
      //        when the timer gets to zero, we stop it.
      if ($scope.timeLeftSeconds <= 0) {
        $scope.onTimerFinish();
      }
    }
    /* When called, it currently stops the timer and changes the text. */
    $scope.onTimerFinish = function() {
      console.log("FINISHED");
      $scope.stop();
      $scope.naopodemaislancar = false;
      $scope.finalTimeLeft = "Pode lançar";
    }

    $scope.$on('$destroy', function() {
      $scope.stop();
    });


  $scope.criar =function(){
    $state.go('campanhacriadia');
  }

  $scope.SobreCampanhas =function(){
    $state.go('sobrecampanhas');
  }


  
 

}])

.controller('campanhacriadiaCtrl', ['$scope', '$stateParams', 'formUser','formComercio', 'formLoc', 'EventoService', 'formAux', '$state','$timeout', '$ionicPopup', '$http', 'formOutro', 'formItem', 'formtela', 'formtelanoti', 'formtipologin','formEventoCampanha', '$ionicTabsDelegate','formLimiteatuacao',  // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, formUser,formComercio, formLoc, EventoService, formAux, $state, $timeout, $ionicPopup, $http, formOutro, formItem, formtela, formtelanoti, formtipologin, formEventoCampanha, $ionicTabsDelegate,formLimiteatuacao) {
  
  $scope.evento = {};
  $scope.user = formUser.getForm();
  $scope.comercio = formComercio.getForm();
  var datainvalida = 0;
  $scope.$on("$ionicView.enter", function(event, data){
    $ionicTabsDelegate.showBar(1);
    $scope.evento = formEventoCampanha.getForm();
    $scope.user = formUser.getForm();
    $scope.comercio = formComercio.getForm();
    //$scope.evento.iniciohora =  new Date(6, 0)
     // $scope.evento.iniciohora.setHours(6, 0)
    if(!$scope.evento.date){
      $scope.evento.date = new Date();
      $scope.evento.hj = new Date();
      $scope.evento.date.setDate($scope.evento.date.getDate() + 1);
      $scope.evento.semana = $scope.evento.date.getDay();
    }
    
    
   
    
     if($scope.evento.semana == 0){
      $scope.evento.semana = "Domingo";
    }
    if($scope.evento.semana == 1){
      $scope.evento.semana = "Segunda-feira";
    }
    if($scope.evento.semana == 2){
      $scope.evento.semana = "Terça-feira";
    }
    if($scope.evento.semana == 3){
      $scope.evento.semana = "Quarta-feira";
    }
    if($scope.evento.semana == 4){
      $scope.evento.semana = "Quinta-feira";
    }
    if($scope.evento.semana == 5){
      $scope.evento.semana = "Sexta-feira";
    }
    if($scope.evento.semana == 6){
      $scope.evento.semana = "Sábado";
    }
    var curr_date = ($scope.evento.date.getDate()<10?'0':'') + $scope.evento.date.getDate();
    var curr_month = ($scope.evento.date.getMonth()<9?'0':'') + ($scope.evento.date.getMonth() + 1); //Months are zero based
    var curr_year = $scope.evento.date.getFullYear();
    var h2 = ($scope.evento.date.getHours()<10?'0':'') + $scope.evento.date.getHours();
    var m2 = ($scope.evento.date.getMinutes()<10?'0':'') + $scope.evento.date.getMinutes();
    var s2 = ($scope.evento.date.getSeconds()<10?'0':'') + $scope.evento.date.getSeconds();
    var j = curr_year + "-" + curr_month + "-" + curr_date+ ' '+h2 + ':' + m2 + ':' + s2;
    $scope.evento.diainicio = j;
    $scope.auxdata = {};
    EventoService.verificahorariopessoaevento($scope.user).then(function(items) {
      $scope.auxdata = items;
    }); 
    var datainvalida = 0;
  })

  $scope.muda = function(){

    if( $scope.evento.date < $scope.evento.hj){
      var alertPopup = $ionicPopup.alert({
        title: 'Falha na data!!',
        template: 'Coloque uma data valida s`il vous plait'
      });
      datainvalida = 2;
    }else{
      datainvalida = 0;
      $scope.evento.semana = $scope.evento.date.getDay();
      var curr_date = ($scope.evento.date.getDate()<10?'0':'') + $scope.evento.date.getDate();
      var curr_month = ($scope.evento.date.getMonth()<9?'0':'') + ($scope.evento.date.getMonth() + 1); //Months are zero based
      var curr_year = $scope.evento.date.getFullYear();
      var h2 = ($scope.evento.date.getHours()<10?'0':'') + $scope.evento.date.getHours();
      var m2 = ($scope.evento.date.getMinutes()<10?'0':'') + $scope.evento.date.getMinutes();
      var s2 = ($scope.evento.date.getSeconds()<10?'0':'') + $scope.evento.date.getSeconds();
      var j = curr_year + "-" + curr_month + "-" + curr_date+ ' '+h2 + ':' + m2 + ':' + s2;
      $scope.evento.diainicio = j;
       if($scope.evento.semana == 0){
        $scope.evento.semana = "Domingo";
      }
      if($scope.evento.semana == 1){
        $scope.evento.semana = "Segunda-feira";
      }
      if($scope.evento.semana == 2){
        $scope.evento.semana = "Terça-feira";
      }
      if($scope.evento.semana == 3){
        $scope.evento.semana = "Quarta-feira";
      }
      if($scope.evento.semana == 4){
        $scope.evento.semana = "Quinta-feira";
      }
      if($scope.evento.semana == 5){
        $scope.evento.semana = "Sexta-feira";
      }
      if($scope.evento.semana == 6){
        $scope.evento.semana = "Sábado";
      }
    }
          
  }

  $scope.Proximo = function(evento){
    if($scope.evento.semana == 0){
      $scope.evento.semana = "Domingo";
    }
    if($scope.evento.semana == 1){
      $scope.evento.semana = "Segunda-feira";
    }
    if($scope.evento.semana == 2){
      $scope.evento.semana = "Terça-feira";
    }
    if($scope.evento.semana == 3){
      $scope.evento.semana = "Quarta-feira";
    }
    if($scope.evento.semana == 4){
      $scope.evento.semana = "Quinta-feira";
    }
    if($scope.evento.semana == 5){
      $scope.evento.semana = "Sexta-feira";
    }
    if($scope.evento.semana == 6){
      $scope.evento.semana = "Sábado";
    }

    for(var r = 0;r<$scope.auxdata.length; r++){
      //console.log($scope.auxdata[r].diainicio ,"$scope.auxdata[r].diainicio", $scope.evento.diainicio)
      if ($scope.auxdata[r].diainicio < $scope.evento.diainicio && $scope.auxdata[r].diafim > $scope.evento.diainicio){
        //console.log('horario invalido');
        datainvalida = 1;
      }
    }
             //console.log (datainvalida , r)
              ///        ╭∩╮(︶‿︶)╭∩╮
    if(datainvalida == 0 && r==$scope.auxdata.length){
              // $scope.evento.date = $scope.evento.date.toDateString("yyyy-MM-dd HH:mm");
              // $scope.evento.diafim = $scope.evento.diafim.toDateString("yyyy-MM-dd HH:mm");
        console.log($scope.evento.diainicio)
      formEventoCampanha.updateForm($scope.evento);
      $state.go('campanhacriaduracao')
    }
    if(datainvalida ==1){
      var alertPopup = $ionicPopup.alert({
            title: 'Oww!!',
            template: 'Tu ja tem um evento marcado nesse horário :/'
          });
    }
    if(datainvalida ==2){
      var alertPopup = $ionicPopup.alert({
        title: 'Falha na data!!',
        template: 'Coloque uma data valida s`il vous plait'
      });
    }
          
     
    //console.log($scope.evento.iniciohora, "$scope.evento.iniciohora", $scope.evento.diainicio);

  }

}])

.controller('campanhacriaduracaoCtrl', ['$scope', '$stateParams', 'formUser', 'formLoc', 'EventoService', 'formAux', '$state','$timeout', '$ionicPopup', '$http', 'formOutro', 'formItem', 'formtela', 'formtelanoti', 'formtipologin','formEventoCampanha', '$ionicTabsDelegate',  // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, formUser, formLoc, EventoService, formAux, $state, $timeout, $ionicPopup, $http, formOutro, formItem, formtela, formtelanoti, formtipologin, formEventoCampanha, $ionicTabsDelegate) {
 
  $scope.evento = {};
  $scope.user = formUser.getForm();


  $scope.$on("$ionicView.enter", function(event, data){
    $ionicTabsDelegate.showBar(0);
    $scope.evento = formEventoCampanha.getForm();
    $scope.user = formUser.getForm();
    if(!$scope.evento.duracao){
      $scope.evento.duracao =  new Date(1, 0)
      $scope.evento.duracao.setHours(1, 0)
    }
    
  })

  $scope.Proximo = function(evento){
    var hora =$scope.evento.duracao.getHours();
    var min = $scope.evento.duracao.getMinutes();
    var currentdatefim = new Date($scope.evento.diainicio);
    if(min == 0){
      min = 60;
    }
    if(hora == 0){
      currentdatefim.setTime(currentdatefim.getTime() + (min*60*1000));
    }else{
      currentdatefim.setTime(currentdatefim.getTime() + (hora*min*60*1000));
    }
    
    
    var curr_datefim = (currentdatefim.getDate()<10?'0':'') + currentdatefim.getDate();
    var curr_monthfim = (currentdatefim.getMonth()<9?'0':'') + (currentdatefim.getMonth() + 1); //Months are zero based
    var curr_yearfim = currentdatefim.getFullYear();
    var curr_hfim = (currentdatefim.getHours()<10?'0':'') + currentdatefim.getHours();
    var curr_mfim = (currentdatefim.getMinutes()<10?'0':'') + currentdatefim.getMinutes();
    var curr_jfim = curr_yearfim + "-" + curr_monthfim + "-" + curr_datefim+ ' '+curr_hfim + ':' + curr_mfim + ':' + '00';
    
    $scope.evento.diafim = curr_jfim;
    
    console.log($scope.evento.diafim, "$scope.evento.diafim")
    formEventoCampanha.updateForm($scope.evento);
    $state.go('campanhacrialimiteconfirmacao')
  }

}])

.controller('campanhacrialimiteconfirmacaoCtrl', ['$scope', '$stateParams', 'formUser', 'formLoc', 'EventoService', 'formAux', '$state','$timeout', '$ionicPopup', '$http', 'formOutro', 'formItem', 'formtela', 'formtelanoti', 'formtipologin','formEventoCampanha', '$ionicTabsDelegate',  // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, formUser, formLoc, EventoService, formAux, $state, $timeout, $ionicPopup, $http, formOutro, formItem, formtela, formtelanoti, formtipologin, formEventoCampanha, $ionicTabsDelegate) {
 
  $scope.evento = {};
  $scope.user = formUser.getForm();


  $scope.$on("$ionicView.enter", function(event, data){
    $ionicTabsDelegate.showBar(0);
    $scope.evento = formEventoCampanha.getForm();
    $scope.user = formUser.getForm();
    $scope.evento.redzone = 1;

      var currentdate = new Date(); 
      var curr_date2 = (currentdate.getDate()<10?'0':'') + currentdate.getDate();
      var curr_month2 = (currentdate.getMonth()<10?'0':'') + (currentdate.getMonth() + 1); //Months are zero based
      var curr_year2 = currentdate.getFullYear();
      var h22 = (currentdate.getHours()<10?'0':'') + currentdate.getHours();
      var m22 = (currentdate.getMinutes()<10?'0':'') + currentdate.getMinutes();

      var curr_date
      var h2
      var m2 
      var curr_month
      var s2
      var curr_year
      var datainvalida = 0;

      var curr_date4;
      var curr_date5;
      var h4
      var m4 
      var curr_month4;
      var curr_month5;
      var s4
      var curr_year4
      var curr_year5;

      $scope.ano;
      $scope.mes ;
      $scope.dia;
      $scope.h;
      $scope.m;

          curr_date = ($scope.evento.date.getDate()<10?'0':'') + $scope.evento.date.getDate();
          curr_month = ($scope.evento.date.getMonth()<9?'0':'') + ($scope.evento.date.getMonth() + 1); //Months are zero based
          curr_year = $scope.evento.date.getFullYear();
          h2 = ($scope.evento.date.getHours()<10?'0':'') + $scope.evento.date.getHours();
          m2 = ($scope.evento.date.getMinutes()<10?'0':'') + $scope.evento.date.getMinutes();
          s2 = ($scope.evento.date.getSeconds()<10?'0':'') + $scope.evento.date.getSeconds();

          var j = curr_year + "-" + curr_month + "-" + curr_date+ ' '+h2 + ':' + m2 + ':' + s2;
          
          // $scope.evento.diainicio = j;
          diainiciodoevento = $scope.evento.date;
          datainvalida = 0;
          $scope.ano = curr_year-curr_year2;
          $scope.mes = curr_month-curr_month2;
          $scope.dia = curr_date-curr_date2;
          $scope.h = h2-h22;
          $scope.m = m2-m22;

  })



  $scope.red = function(){
    if($scope.ano==0 && $scope.mes == 0 && ($scope.dia == 0 && $scope.evento.redzone >= $scope.h) || ($scope.dia == 1 && $scope.evento.redzone >= $scope.h+24)){
      console.log($scope.evento.redzone)
      var alertPopup = $ionicPopup.alert({
        title: 'ლ(ﾟдﾟლ)',
        template: 'A hora limite para confirmação ja passou de agora, ninguem vai conseguir confirmar ida. Selecione um horario válido'
      });
      $scope.evento.redzone = "1";
    }
  }

  $scope.Proximo = function(evento){
    var curr_date5 = $scope.evento.diainicio[8]+$scope.evento.diainicio[9];
    var curr_month5 = $scope.evento.diainicio[5]+$scope.evento.diainicio[6]; //Months are zero based
    var curr_year5 = $scope.evento.diainicio[0]+$scope.evento.diainicio[1] +$scope.evento.diainicio[2]+$scope.evento.diainicio[3];
     
     
    var hora =($scope.evento.date.getHours()<10?'0':'') + $scope.evento.date.getHours();
    var m2 =($scope.evento.date.getMinutes()<10?'0':'') + $scope.evento.date.getMinutes();

    var h4 = parseFloat(hora)-parseFloat($scope.evento.redzone);
    //console.log(h4)
    if(h4<0){
      h4 = h4.valueOf()+24;
      curr_date5 = parseFloat(curr_date5)-1;
      if(curr_date5<1){
        curr_month5 = parseFloat(curr_month5)-1;
        if(curr_month5==1||curr_month5==3||curr_month5==5||curr_month5==7||curr_month5==8||curr_month5==10||curr_month5==12){
          curr_date5 = curr_date5.valueOf()+31;
        }
        if(curr_month5==4||curr_month5==6||curr_month5==9||curr_month5==11){
          curr_date5 = curr_date5.valueOf()+30;
        }
        if(curr_month5==2){
          curr_date5 = curr_date5.valueOf()+28;
        }
        if(curr_month5<1){
          curr_year5 = parseFloat(curr_year5)-1;
        }
      }
    }
    if(h4 == 0){
      curr_date5 = parseFloat(curr_date5)-1;
      if(curr_date5<1){
        curr_month5 = parseFloat(curr_month5)-1;
        if(curr_month5==1||curr_month5==3||curr_month5==5||curr_month5==7||curr_month5==8||curr_month5==10||curr_month5==12){
          curr_date5 = curr_date5.valueOf()+31;
        }
        if(curr_month5==4||curr_month5==6||curr_month5==9||curr_month5==11){
          curr_date5 = curr_date5.valueOf()+30;
        }
        if(curr_month5==2){
          curr_date5 = curr_date5.valueOf()+28;
        }
        if(curr_month5<1){
          curr_year5 = parseFloat(curr_year5)-1;
        }
      }
    }
    h4 = (h4<10?'0':'')+h4;
    console.log( curr_date5)
    curr_date5 = (parseFloat(curr_date5)<10?'0':'')+parseFloat(curr_date5);
    curr_month5 = (parseFloat(curr_month5)<9?'0':'')+parseFloat(curr_month5);
    var j = curr_year5 + "-" + curr_month5 + "-" + curr_date5+ ' '+h4 + ':' + m2 + ':00' ;
    
    $scope.evento.dialimiteconfirmacao = j;
    console.log($scope.evento.dialimiteconfirmacao, curr_date5)
    formEventoCampanha.updateForm($scope.evento);
    $state.go('campanhadesconto')
  }

}])

.controller('campanhadescontoCtrl', ['$scope', '$stateParams', 'formUser','formComercio', 'formLoc', 'EventoService', 'formAux', '$state','$timeout', '$ionicPopup', '$http', 'formOutro', 'formItem', 'formtela', 'formtelanoti', 'formtipologin','formEventoCampanha', '$ionicTabsDelegate', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, formUser,formComercio, formLoc, EventoService, formAux, $state, $timeout, $ionicPopup, $http, formOutro, formItem, formtela, formtelanoti, formtipologin, formEventoCampanha, $ionicTabsDelegate) {


  $scope.evento = {};
  $scope.user = formUser.getForm();

  $scope.$on("$ionicView.enter", function(event, data){
    $ionicTabsDelegate.showBar(0);
    $scope.evento = formEventoCampanha.getForm();
    $scope.user = formUser.getForm();
    $scope.comercio = formComercio.getForm();
    if(!$scope.evento.pmin){
      $scope.evento.pmin = parseInt($scope.comercio.pmin) ;
      $scope.evento.pmax = parseInt($scope.comercio.pmax) ;
      if(!$scope.evento.pmin){
        $scope.evento.pmin = 2 ;
        $scope.evento.pmax = 10 ;
      }
    }
   
  })

  $scope.menos = function(){
    if($scope.evento.pmin >2){
      $scope.evento.pmin--;
    }
  }
  $scope.mais = function(){
    if($scope.evento.pmin < 49){
      $scope.evento.pmin++;
      if($scope.evento.pmin >= $scope.evento.pmax){
        $scope.evento.pmax = $scope.evento.pmin+1;
      }
      
    }
  }

  $scope.menosmax = function(){
    if($scope.evento.pmax >3){
      $scope.evento.pmax--;
      if($scope.evento.pmax <= $scope.evento.pmin){
        $scope.evento.pmin = $scope.evento.pmax-1;
      }
    }
  }
  $scope.maismax = function(){
    if($scope.evento.pmax < 50){
      $scope.evento.pmax++;
    }
  }
  

  $scope.Proximo = function(){

    formEventoCampanha.updateForm($scope.evento);
    $state.go('campanhacriapreco')
  }

}])

.controller('campanhacriaprecoCtrl', ['$scope', '$stateParams', 'formUser','formComercio', 'formLoc', 'EventoService', 'formAux', '$state','$timeout', '$ionicPopup', '$http', 'formOutro', 'formItem', 'formtela', 'formtelanoti', 'formtipologin','formEventoCampanha', '$ionicTabsDelegate', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, formUser, formComercio, formLoc, EventoService, formAux, $state, $timeout, $ionicPopup, $http, formOutro, formItem, formtela, formtelanoti, formtipologin, formEventoCampanha, $ionicTabsDelegate) {  
  $scope.evento = {};
  $scope.user = formUser.getForm();

  var header = document.getElementById("barmprecampanha");
  var btns = header.getElementsByClassName("btnmprecampanha");
  for (var i = 0; i < btns.length; i++) {
    btns[i].addEventListener("click", function() {
      var current = document.getElementsByClassName("actmprenovocampanha");
      current[0].className = current[0].className.replace(" actmprenovocampanha", "");
      this.className += " actmprenovocampanha";
    });
  }

  $scope.$on("$ionicView.enter", function(event, data){
    $ionicTabsDelegate.showBar(0);
    $scope.evento = formEventoCampanha.getForm();
    $scope.user = formUser.getForm();
    $scope.comercio = formComercio.getForm();
    $scope.evento.preco = $scope.comercio.preco;
    if($scope.comercio.precopor == '1'){
      document.getElementById("pessoa").className = "btnmprecampanha actmprenovocampanha";
    }
    if($scope.comercio.precopor == '2'){
      if($scope.comercio.precopor == '1'){
      document.getElementById("hora").className = "btnmprecampanha actmprenovocampanha";
    }
    }
    
    
  })
  
  $scope.evento.precopor = 1;
  $scope.pessoa = function() {$scope.evento.precopor = 1;};
  $scope.hora = function() {$scope.evento.precopor = 2;};
  var auxadd = 0
  $scope.addDesconto = function() {
    if(auxadd == 0){
      $scope.desc1 = true;
      auxadd++; 
    }else{
      if(auxadd == 1){
        $scope.desc2 = true; 
      }
    }
  };

  $scope.removeDesconto = function() {
    if(auxadd == 1){
      $scope.desc2 = false;
      auxadd--; 
    }else{
      if(auxadd == 0){
        $scope.desc1 = false; 
      }
    }
  };

  $scope.Proximo = function(){
    if(!$scope.evento.preco){
      $scope.evento.preco = 0;
    }
    if($scope.evento.descontomin){
       $scope.evento.descontopacote = 'Para ' + $scope.evento.pmin + ' pessoas posso fazer ' + $scope.evento.descontomin+ '.'; 
    }
    if($scope.desc1){
      if($scope.evento.descontopacote){
        $scope.evento.descontopacote += '\n\r' + 'Para ' + $scope.evento.paux1 + ' pessoas posso fazer ' + $scope.evento.descontoaux1+ '.'; 
      }else{
       $scope.evento.descontopacote = 'Para ' + $scope.evento.paux1 + ' pessoas posso fazer ' + $scope.evento.descontoaux1+ '.'; 
      }
    }
    if($scope.desc2){
      if($scope.evento.descontopacote){
        $scope.evento.descontopacote += '\n\r' + 'Para ' + $scope.evento.paux2 + ' pessoas posso fazer ' + $scope.evento.descontoaux2+ '.'; 
      }else{
       $scope.evento.descontopacote = 'Para ' + $scope.evento.paux2 + ' pessoas posso fazer ' + $scope.evento.descontoaux2+ '.'; 
      }
    }
    if($scope.evento.descontomax){
      if($scope.evento.descontopacote){
        $scope.evento.descontopacote += '\n\r' + 'Para ' + $scope.evento.pmax + ' pessoas posso fazer ' + $scope.evento.descontomax+ '.'; 
      }else{
       $scope.evento.descontopacote = 'Para ' + $scope.evento.pmax + ' pessoas posso fazer ' + $scope.evento.descontomax+ '.'; 
      }
    }
    // if($scope.desc1){
    //   $scope.evento.descontopacote += "\n" + $scope.evento.paux1 + "->" + $scope.evento.descontoaux1; 
    // }
    // if( $scope.desc2){
    //   $scope.evento.descontopacote += "\n" +$scope.evento.paux2 + "->" + $scope.evento.descontoaux2;
    // }
    //console.log($scope.evento.descontopacote)
    
    formEventoCampanha.updateForm($scope.evento);
    $state.go('campanhacrialocal')
  }

}])

.controller('campanhacrialocalCtrl', ['$scope', '$stateParams', 'formUser', 'formComercio','formLoc', 'EventoService', 'formAux', '$state','$timeout', '$ionicPopup', '$http', 'formOutro', 'formItem', 'formtela', 'formtelanoti', '$cordovaGeolocation','formEventoCampanha', '$ionicTabsDelegate', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, formUser, formComercio,formLoc, EventoService, formAux, $state, $timeout, $ionicPopup, $http, formOutro, formItem, formtela, formtelanoti, $cordovaGeolocation, formEventoCampanha, $ionicTabsDelegate) {
  
  $scope.evento = {};
  $scope.user = formUser.getForm();
  $scope.evento = formEventoCampanha.getForm();
  $scope.comercio = formComercio.getForm();
  $scope.evento.nomelocal = 'Diwo';
  $scope.evento.endereco = 'Secreto';
  $scope.evento.cidade = 'Balneário Camboriú';
  $scope.evento.lat = $scope.comercio.lat;
  $scope.evento.lng = $scope.comercio.lng;
  console.log($scope.comercio.lat,$scope.comercio.lng)
  $scope.centerPoint={};
  $scope.centerPointFB={};
  $scope.LimiteFuncionamentoDiwo = false;
  $scope.LimiteFuncionamentoDiwoFB = false;
  $scope.disableTap = function(){
     container = document.getElementsByClassName('pac-container');
     // disable ionic data tab
     angular.element(container).attr('data-tap-disabled', 'true');
     // leave input field if google-address-entry is selected
     angular.element(container).on("click", function(){
                                   document.getElementById('pac-input').blur();
                                   });
     };

  $scope.$on("$ionicView.enter", function(event, data){
    $ionicTabsDelegate.showBar(0);
    $scope.evento = formEventoCampanha.getForm();
    $scope.comercio = formComercio.getForm();
    $scope.evento.lat = $scope.comercio.lat;
    $scope.evento.lng = $scope.comercio.lng;
    $scope.user = formUser.getForm();
    $scope.centerPoint={};
    $scope.LimiteFuncionamentoDiwo = false;
    console.log($scope.evento.semana, $scope.evento.lat)
    if(!$scope.evento.lat){
        navigator.geolocation.getCurrentPosition(function(position){
            var lat  = $scope.comercio.lat;
            var long = $scope.comercio.lng;
            var myLatlng = new google.maps.LatLng(lat, long);
            var mapOptions = {
                center: myLatlng,
                zoom: 16,
                mapTypeId: google.maps.MapTypeId.ROADMAP
            };          
            var map = new google.maps.Map(document.getElementById("map_canvas"), mapOptions); 
            var marker = new google.maps.Marker({
                      position: new google.maps.LatLng($scope.comercio.lat, $scope.comercio.lng),
                      map: map,
                      title: "Borai",
                      draggable: true,
                      icon: 'http://maps.google.com/mapfiles/ms/icons/green-dot.png',
                      animation: google.maps.Animation.DROP 
                  })

            var geocoder = new google.maps.Geocoder;
            var infowindow = new google.maps.InfoWindow({maxWidth: 200});

            geocoder.geocode({'location': myLatlng}, function(results, status) {
                  if (status === 'OK') {
                    if (results[1]) {
                      $scope.evento.nomelocal = results[0].address_components[0].long_name;
                      $scope.evento.endereco = results[0].formatted_address;
                      for(var i = 0;i<results[0].address_components.length;i++){
                        if(results[0].address_components[i].types[0] == "administrative_area_level_2"){
                          $scope.evento.cidade = results[0].address_components[i].long_name;
                          console.log($scope.evento.cidade)
                        }
                      }
                      //$scope.evento.cidade = results[0].address_components[4].long_name;
                      $scope.evento.lat = position.coords.latitude;
                      $scope.evento.lng = position.coords.longitude;
                      $scope.centerPoint.lat = -26.997799;
                      $scope.centerPoint.lng = -48.632733; 
                      // $scope.centerPoint.lat = -25.473466587692343;
                      // $scope.centerPoint.lng = -49.29164589792566;
                      $scope.centerPointKM = 30;
                      $scope.LimiteFuncionamentoDiwo = arePointsNear($scope.evento, $scope.centerPoint,$scope.centerPointKM );
                     
                      infowindow.setContent(results[0].formatted_address);
                      // console.log($scope.evento.endereco);
                      // console.log($scope.evento.cidade);
                      // console.log($scope.evento.lng);
                      // console.log($scope.evento.lat);
                      //infowindow.setContent(results[0].address_components[2].long_name);
                      infowindow.open(map, marker);
                      setTimeout(function () { infowindow.close(); }, 5000);
                    } else {
                      window.alert('No results found');
                    }
                  } else {
                    window.alert('Geocoder failed due to: ' + status);
                  }
            });


            google.maps.event.addListener(marker, "dragstart", function (event) {
               marker.setAnimation(3); // raise
            });

            google.maps.event.addListener(marker, "dragend", function (event) {
               marker.setAnimation(4); // raise
            });

            marker.addListener('dragend', handleEvent);

            google.maps.event.addListener(map, 'click', function(e) {
                
                markers.forEach(function(marker) {
                marker.setMap(null);
                });
                markers = [];

                placeMarker(e.latLng, map, marker);

            });

            function placeMarker(latlng, map, marker) {
                marker.setPosition(latlng);
                marker.setMap(map);
                map.panTo(latlng);
                $scope.evento.lat = latlng.lat();
                $scope.evento.lng = latlng.lng();

                $scope.centerPoint.lat = -26.997799;
                $scope.centerPoint.lng = -48.632733; 
                // $scope.centerPoint.lat = -25.473466587692343;
                // $scope.centerPoint.lng = -49.29164589792566;
                $scope.centerPointKM = 30;
                $scope.LimiteFuncionamentoDiwo = arePointsNear($scope.evento, $scope.centerPoint,$scope.centerPointKM );
              
                geocoder.geocode({'location': latlng}, function(results, status) {
                  if (status === 'OK') {
                    if (results[1]) {
                      $scope.evento.nomelocal = results[0].address_components[0].long_name;
                      for(var i = 0;i<results[0].address_components.length;i++){
                        if(results[0].address_components[i].types[0] == "administrative_area_level_2"){
                          $scope.evento.cidade = results[0].address_components[i].long_name;
                          console.log($scope.evento.cidade)
                        }
                      }
                      //$scope.evento.cidade = results[0].address_components[4].long_name;
                      $scope.evento.endereco = results[0].formatted_address;
                      console.log($scope.evento.endereco);
                      console.log($scope.evento.cidade);
                      console.log($scope.evento.lng);
                      console.log($scope.evento.lat);
                      infowindow.setContent(results[0].formatted_address);
                     
                      infowindow.open(map, marker);
                      setTimeout(function () { infowindow.close(); }, 5000);
                    } else {
                      window.alert('No results found');
                    }
                  } else {
                    window.alert('Geocoder failed due to: ' + status);
                  }
                });
            };

            function arePointsNear(checkPoint, centerPoint, km) {
                  var ky = 40000 / 360;
                  var kx = Math.cos(Math.PI * centerPoint.lat / 180.0) * ky;
                  var dx = Math.abs(centerPoint.lng - $scope.evento.lng) * kx;
                  var dy = Math.abs(centerPoint.lat - $scope.evento.lat) * ky;
                  return Math.sqrt(dx * dx + dy * dy) <= km;
                }    

            function handleEvent(event) {
                $scope.evento.lat = event.latLng.lat();
                $scope.evento.lng = event.latLng.lng();
                $scope.centerPoint.lat = -26.997799;
                $scope.centerPoint.lng = -48.632733; 
                // $scope.centerPoint.lat = -25.473466587692343;
                // $scope.centerPoint.lng = -49.29164589792566;
                $scope.centerPointKM = 30;
                $scope.LimiteFuncionamentoDiwo = arePointsNear($scope.evento, $scope.centerPoint,$scope.centerPointKM );
           
                              // GEOCODER INVERSO

                var geocoder = new google.maps.Geocoder;
                var infowindow = new google.maps.InfoWindow({
                                                              maxWidth: 200
                                                            });;    
            
                geocoder.geocode({'location': event.latLng}, function(results, status) {
                  if (status === 'OK') {
                    if (results[1]) {
                      $scope.evento.nomelocal = results[0].address_components[0].long_name;
                      for(var i = 0;i<results[0].address_components.length;i++){
                        if(results[0].address_components[i].types[0] == "administrative_area_level_2"){
                          $scope.evento.cidade = results[0].address_components[i].long_name;
                          console.log($scope.evento.cidade)
                        }
                      }
                      //$scope.evento.cidade = results[0].address_components[4].long_name;
                      $scope.evento.endereco = results[0].formatted_address;
                      // console.log($scope.evento.endereco);
                      // console.log($scope.evento.cidade);
                      console.log($scope.evento.lng);
                      console.log($scope.evento.lat);
                      infowindow.setContent(results[0].formatted_address);
                     
                      infowindow.open(map, marker);
                      setTimeout(function () { infowindow.close(); }, 5000);
                    } else {
                      window.alert('No results found');
                    }
                  } else {
                    window.alert('Geocoder failed due to: ' + status);
                  }
                });
            }
            var input = document.getElementById('pac-input');
            var searchBox = new google.maps.places.SearchBox(input);
            map.addListener('bounds_changed', function() {
                searchBox.setBounds(map.getBounds());
            });
            var markers = [];
            searchBox.addListener('places_changed', function() {
                var places = searchBox.getPlaces();

                if (places.length == 0) {
                  return;
                }

                // Clear out the old markers.
                markers.forEach(function(marker) {
                  marker.setMap(null);
                });
                markers = [];

                // For each place, get the icon, name and location.
                var bounds = new google.maps.LatLngBounds();
                places.forEach(function(place) {
                  if (!place.geometry) {
                    console.log("Returned place contains no geometry");
                    return;
                  }
                  // var icon = {
                  //   url: place.icon,
                  //   size: new google.maps.Size(71, 71),
                  //   origin: new google.maps.Point(0, 0),
                  //   anchor: new google.maps.Point(17, 34),
                  //   scaledSize: new google.maps.Size(25, 25)
                  // };

                  // Create a marker for each place.
                  markers.push(new google.maps.Marker({
                    map: map,
                    // icon: icon,
                    title: place.name,
                    position: place.geometry.location
                  }));

                  $scope.evento.nomelocal = place.name;
                  $scope.evento.endereco = place.formatted_address;
             
                  for(var i = 0;i<place.address_components.length;i++){
                    //console.log(place.address_components[i].types[0])
                    if(place.address_components[i].types[0] == "administrative_area_level_2"){
                      $scope.evento.cidade = place.address_components[i].long_name;
                      console.log($scope.evento.cidade)
                    }
                  }
                 
                  $scope.evento.lat = place.geometry.location.lat();
                  $scope.evento.lng = place.geometry.location.lng();
                  $scope.centerPoint.lat = -26.997799;
                  $scope.centerPoint.lng = -48.632733; 
                  // $scope.centerPoint.lat = -25.473466587692343;
                  // $scope.centerPoint.lng = -49.29164589792566;
                  $scope.centerPointKM = 30;
                  $scope.LimiteFuncionamentoDiwo = arePointsNear($scope.evento, $scope.centerPoint,$scope.centerPointKM );
                  
                  console.log($scope.evento.lng, $scope.evento.lat, "lssdd", $scope.evento.nomelocal, $scope.evento.endereco);

                  if (place.geometry.viewport) {
                    // Only geocodes have viewport.
                    bounds.union(place.geometry.viewport);
                  } else {
                    bounds.extend(place.geometry.location);
                  }
                });
                map.fitBounds(bounds);
            });

            $scope.map = map;  
             
        }, function(err) {
            console.log(err.code);
            console.log(err.message);
        });
    }else{
      $scope.centerPoint.lat = -26.997799;
      $scope.centerPoint.lng = -48.632733; 
      // $scope.centerPoint.lat = -25.473466587692343;
      // $scope.centerPoint.lng = -49.29164589792566;
      $scope.centerPointKM = 30;
      $scope.LimiteFuncionamentoDiwo = arePointsNear($scope.evento, $scope.centerPoint,$scope.centerPointKM );
      function arePointsNear(checkPoint, centerPoint, km) {
        var ky = 40000 / 360;
        var kx = Math.cos(Math.PI * centerPoint.lat / 180.0) * ky;
        var dx = Math.abs(centerPoint.lng - $scope.evento.lng) * kx;
        var dy = Math.abs(centerPoint.lat - $scope.evento.lat) * ky;
        return Math.sqrt(dx * dx + dy * dy) <= km;
      } 
    }
      

  })

  var posOptions = {
      enableHighAccuracy: true,
      timeout: 200000,
      maximumAge: 0
  };

    navigator.geolocation.getCurrentPosition(function(position){
          
            var lat  =  $scope.comercio.lat;
            var long =  $scope.comercio.lng;
             

            var myLatlng = new google.maps.LatLng(lat, long);
             
            var mapOptions = {
                center: myLatlng,
                zoom: 16,
                mapTypeId: google.maps.MapTypeId.ROADMAP
            };          
             
            var map = new google.maps.Map(document.getElementById("map_canvas"), mapOptions); 


            var marker = new google.maps.Marker({
                      position: new google.maps.LatLng( $scope.comercio.lat,$scope.comercio.lng),
                      map: map,
                      title: "Borai",
                      draggable: true,
                      icon: 'http://maps.google.com/mapfiles/ms/icons/green-dot.png',
                      animation: google.maps.Animation.DROP 
                  })

            var geocoder = new google.maps.Geocoder;
            var infowindow = new google.maps.InfoWindow({maxWidth: 200});

            geocoder.geocode({'location': myLatlng}, function(results, status) {
                  if (status === 'OK') {
                    if (results[1]) {
                      $scope.evento.nomelocal = results[0].address_components[0].long_name;
                      $scope.evento.endereco = results[0].formatted_address;
                      for(var i = 0;i<results[0].address_components.length;i++){
                        if(results[0].address_components[i].types[0] == "administrative_area_level_2"){
                          $scope.evento.cidade = results[0].address_components[i].long_name;
                          console.log($scope.evento.cidade)
                        }
                      }
                      //$scope.evento.cidade = results[0].address_components[4].long_name;
                      $scope.evento.lat = position.coords.latitude;
                      $scope.evento.lng = position.coords.longitude;
                      $scope.centerPoint.lat = -26.997799;
                      $scope.centerPoint.lng = -48.632733; 
                      // $scope.centerPoint.lat = -25.473466587692343;
                      // $scope.centerPoint.lng = -49.29164589792566;
                      $scope.centerPointKM = 30;
                      $scope.LimiteFuncionamentoDiwo = arePointsNear($scope.evento, $scope.centerPoint,$scope.centerPointKM );
                   
                      infowindow.setContent(results[0].formatted_address);
                      console.log($scope.evento.endereco);
                      console.log($scope.evento.cidade);
                      console.log($scope.evento.lng);
                      console.log($scope.evento.lat);
                      //infowindow.setContent(results[0].address_components[2].long_name);
                      infowindow.open(map, marker);
                      setTimeout(function () { infowindow.close(); }, 5000);
                    } else {
                      window.alert('No results found');
                    }
                  } else {
                    window.alert('Geocoder failed due to: ' + status);
                  }
                });


            google.maps.event.addListener(marker, "dragstart", function (event) {
               marker.setAnimation(3); // raise
            });

            google.maps.event.addListener(marker, "dragend", function (event) {
               marker.setAnimation(4); // raise
            });

            marker.addListener('dragend', handleEvent);

            google.maps.event.addListener(map, 'click', function(e) {
              
                markers.forEach(function(marker) {
                marker.setMap(null);
                });
                markers = [];

                placeMarker(e.latLng, map, marker);

            });
             function arePointsNear(checkPoint, centerPoint, km) {
                  var ky = 40000 / 360;
                  var kx = Math.cos(Math.PI * centerPoint.lat / 180.0) * ky;
                  var dx = Math.abs(centerPoint.lng - $scope.evento.lng) * kx;
                  var dy = Math.abs(centerPoint.lat - $scope.evento.lat) * ky;
                  return Math.sqrt(dx * dx + dy * dy) <= km;
                } 

            function placeMarker(latlng, map, marker) {
                marker.setPosition(latlng);
                marker.setMap(map);
                map.panTo(latlng);
                $scope.evento.lat = latlng.lat();
                $scope.evento.lng = latlng.lng();
                $scope.centerPoint.lat = -26.997799;
                $scope.centerPoint.lng = -48.632733;
                // $scope.centerPoint.lat = -25.473466587692343;
                // $scope.centerPoint.lng = -49.29164589792566; 
                $scope.centerPointKM = 30;
                $scope.LimiteFuncionamentoDiwo = arePointsNear($scope.evento, $scope.centerPoint,$scope.centerPointKM );
             
                geocoder.geocode({'location': latlng}, function(results, status) {
                  if (status === 'OK') {
                    if (results[1]) {
                      $scope.evento.nomelocal = results[0].address_components[0].long_name;
                      for(var i = 0;i<results[0].address_components.length;i++){
                        if(results[0].address_components[i].types[0] == "administrative_area_level_2"){
                          $scope.evento.cidade = results[0].address_components[i].long_name;
                          console.log($scope.evento.cidade)
                        }
                      }
                      //$scope.evento.cidade = results[0].address_components[4].long_name;
                      $scope.evento.endereco = results[0].formatted_address;
                      console.log($scope.evento.endereco);
                      console.log($scope.evento.cidade);
                      console.log($scope.evento.lng);
                      console.log($scope.evento.lat);
                      infowindow.setContent(results[0].formatted_address);
                     
                      infowindow.open(map, marker);
                      setTimeout(function () { infowindow.close(); }, 5000);
                    } else {
                      window.alert('No results found');
                    }
                  } else {
                    window.alert('Geocoder failed due to: ' + status);
                  }
                });
            };        

            function handleEvent(event) {
                $scope.evento.lat = event.latLng.lat();
                $scope.evento.lng = event.latLng.lng();
                $scope.centerPoint.lat = -26.997799;
                $scope.centerPoint.lng = -48.632733; 
                // $scope.centerPoint.lat = -25.473466587692343;
                // $scope.centerPoint.lng = -49.29164589792566;
                $scope.centerPointKM = 30;
                $scope.LimiteFuncionamentoDiwo = arePointsNear($scope.evento, $scope.centerPoint,$scope.centerPointKM );
                // $scope.centerPointKMFB = 2500;
                //       $scope.centerPointFB.lat = 39.1882887948499;
                //       $scope.centerPointFB.lng = -100.07746794288232;
                //       $scope.LimiteFuncionamentoDiwoFB = arePointsNear($scope.user, $scope.centerPointFB,$scope.centerPointKMFB );
                      
                //       if($scope.LimiteFuncionamentoDiwoFB){
                //         $scope.LimiteFuncionamentoDiwo = true;
                //       }
                //               // GEOCODER INVERSO

                var geocoder = new google.maps.Geocoder;
                var infowindow = new google.maps.InfoWindow({
                                                              maxWidth: 200
                                                            });;    
            
                geocoder.geocode({'location': event.latLng}, function(results, status) {
                  if (status === 'OK') {
                    if (results[1]) {
                      $scope.evento.nomelocal = results[0].address_components[0].long_name;
                      for(var i = 0;i<results[0].address_components.length;i++){
                        if(results[0].address_components[i].types[0] == "administrative_area_level_2"){
                          $scope.evento.cidade = results[0].address_components[i].long_name;
                          console.log($scope.evento.cidade)
                        }
                      }
                      //$scope.evento.cidade = results[0].address_components[4].long_name;
                      $scope.evento.endereco = results[0].formatted_address;
                      // console.log($scope.evento.endereco);
                      // console.log($scope.evento.cidade);
                      console.log($scope.evento.lng);
                      console.log($scope.evento.lat);
                      infowindow.setContent(results[0].formatted_address);
                     
                      infowindow.open(map, marker);
                      setTimeout(function () { infowindow.close(); }, 5000);
                    } else {
                      window.alert('No results found');
                    }
                  } else {
                    window.alert('Geocoder failed due to: ' + status);
                  }
                });
            }

                              // GEOCODER INVERSO

                

                
            
                    //        SEARCHBOX

            var input = document.getElementById('pac-input');
            var searchBox = new google.maps.places.SearchBox(input);
            //map.controls[google.maps.ControlPosition.TOP_LEFT].push(input);

            // Bias the SearchBox results towards current map's viewport.
            map.addListener('bounds_changed', function() {
                searchBox.setBounds(map.getBounds());
            });

            var markers = [];
            // Listen for the event fired when the user selects a prediction and retrieve
            // more details for that place.
            searchBox.addListener('places_changed', function() {
                var places = searchBox.getPlaces();

                if (places.length == 0) {
                  return;
                }

                // Clear out the old markers.
                markers.forEach(function(marker) {
                  marker.setMap(null);
                });
                markers = [];

                // For each place, get the icon, name and location.
                var bounds = new google.maps.LatLngBounds();
                places.forEach(function(place) {
                  if (!place.geometry) {
                    console.log("Returned place contains no geometry");
                    return;
                  }
                  // var icon = {
                  //   url: place.icon,
                  //   size: new google.maps.Size(71, 71),
                  //   origin: new google.maps.Point(0, 0),
                  //   anchor: new google.maps.Point(17, 34),
                  //   scaledSize: new google.maps.Size(25, 25)
                  // };

                  // Create a marker for each place.
                  markers.push(new google.maps.Marker({
                    map: map,
                    // icon: icon,
                    title: place.name,
                    position: place.geometry.location
                  }));

                  $scope.evento.nomelocal = place.name;
                  $scope.evento.endereco = place.formatted_address;
                  for(var i = 0;i<place.address_components.length;i++){
                    //console.log(place.address_components[i].types[0])
                    if(place.address_components[i].types[0] == "administrative_area_level_2"){
                      $scope.evento.cidade = place.address_components[i].long_name;
                      console.log($scope.evento.cidade)
                    }
                  }
                 
                  $scope.evento.lat = place.geometry.location.lat();
                  $scope.evento.lng = place.geometry.location.lng();
                  $scope.centerPoint.lat = -26.997799;
                  $scope.centerPoint.lng = -48.632733; 
                  // $scope.centerPoint.lat = -25.473466587692343;
                  // $scope.centerPoint.lng = -49.29164589792566;
                  $scope.centerPointKM = 30;
                  $scope.LimiteFuncionamentoDiwo = arePointsNear($scope.evento, $scope.centerPoint,$scope.centerPointKM );
                    
                  // console.log($scope.coord.endereco);
                  // console.log($scope.coord.long);
                  // console.log($scope.coord.lat);

                  if (place.geometry.viewport) {
                    // Only geocodes have viewport.
                    bounds.union(place.geometry.viewport);
                  } else {
                    bounds.extend(place.geometry.location);
                  }
                });
                map.fitBounds(bounds);
            });

            $scope.map = map;  
             
        }, function(err) {
            console.log(err.code);
            console.log(err.message);
        });


        $scope.Proximo = function(evento) {
          console.log($scope.evento.lat, $scope.LimiteFuncionamentoDiwo)
          if($scope.LimiteFuncionamentoDiwo){
            formEventoCampanha.updateForm($scope.evento);
            $state.go('campanhacriatitulo');
          }else{
            var alertPopup = $ionicPopup.alert({
                title: '( ꒪Д꒪)ノ',
                template: 'Ótimo saber que você quer criar um evento! Mas parece que a região onde você quer criar seu evento não está na nossa área de cobertura :/'
              }); 
          }
          
        }

}])

.controller('campanhacriatituloCtrl', ['$scope', '$stateParams', 'formUser', 'formLoc', 'EventoService', 'formAux', '$state','$timeout', '$ionicPopup', '$http', 'formOutro', 'formItem', 'formtela', 'formtelanoti', 'formtipologin','formEventoCampanha', '$ionicTabsDelegate', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, formUser, formLoc, EventoService, formAux, $state, $timeout, $ionicPopup, $http, formOutro, formItem, formtela, formtelanoti, formtipologin, formEventoCampanha, $ionicTabsDelegate) {

  $scope.evento = {};
  $scope.user = formUser.getForm();

  $scope.$on("$ionicView.enter", function(event, data){
    $ionicTabsDelegate.showBar(0);
    $scope.evento = formEventoCampanha.getForm();
    $scope.user = formUser.getForm();
    // if(!$scope.evento.nomeevento)
    // console.log($scope.evento.semana)
    // delete $scope.evento.nomeevento
  })



  $scope.Proximo = function(evento){

    if($scope.evento.nomeevento){
      var palavrasnaousar = ["ALIAMBA", "ANUS", "BAGULIO"
      , "BANZA", "BARRUFO", "BECK", "BEQUE", "BOCETA"
      , "BOLAGATO", "BOQUETE", "BOLCAT", "BOSSETA", "BOSTANA", "BREXA", "BRIOCO", "BRONHA", "BUCA", "BUCETA"
      , "BUSSETA", "CANABIS", "CANNABIS", "CARALHO"
      , "CASSETA", "CASSETE", "CHECHECA", "CHERECA", "CHIBUMBA", "CHIBUMBO", "CHOTA", "CHOCHOTA", "CHUPADA", "CHUPADO", "CLITORIS"
      , "COCAINA", "C+"
      , "C*", "CURALHO", "CUZAO", "CUZUDA", "CUZUDO", "CUZÃO", "ESPORRADA", "ESPORRADO", "ESPORRO", "estupro"
      , "FELACAO", "FELACÃO", "FODA", "FODAO", "FODÃO", "FODAUM", "FODE", "FODIDA", "FODIDO", "FORNICA", "FUDENDO", "FUDECÃO", "FUDECAO"
      , "FUDIDA", "FUDIDO", "GRELINHO", "GRELO", "ISCROTA", "ISCROTO", "MACONHA", "MASTURBA", "MASTURBAÇÃO", "MASTURBACÃO", "MASTURBACAO"
      , "PENIS", "PEN1S", "PENES", "PENIZ", "PICA", "PIROCA", "PIRU", "PORRA", "POURRA", "PROSTIBULO", "PUTA", "PUNHETA", "PUTO"
      , "RABAO", "TESTUDA", "TESTUDO", "VAGABUNDA", "VAGINA", "VIADO", "VIADAO", "VIADÃO", "XAVASCA", "XERERECA", "XEXECA", "XOTA"
      , "XOCHOTA", "XOXOTA", "XANA", "XANINHA", "MDMA",  "VSF", "TNC", "FDP", "CRACK"];
      var error = 0; 
      for (var i = 0; i < palavrasnaousar.length; i++) {
        var res2 = $scope.evento.nomeevento.split("_") ;
        if(res2.length>1){
          for(var w = 0; w < res2.length; w++){
            var val = palavrasnaousar[i].toLowerCase();
            if ((res2[w].toLowerCase()).indexOf(val.toString()) > -1) {  
              error = error + 1;  
            }
          }
        }else{
          var val = palavrasnaousar[i].toLowerCase();  
          if (($scope.evento.nomeevento.toLowerCase()).indexOf(val.toString()) > -1) {  
            error = error + 1;  
          }
        }
        var res3 = $scope.evento.nomeevento.split(" ");
        if(res3.length>1){
          for(var w = 0; w < res3.length; w++){
            var val = palavrasnaousar[i].toLowerCase();
            if ((res3[w].toLowerCase()).indexOf(val.toString()) > -1) {  
              error = error + 1;  
            }
          }
        }else{
          var val = palavrasnaousar[i].toLowerCase();  
          if (($scope.evento.nomeevento.toLowerCase()).indexOf(val.toString()) > -1) {  
            error = error + 1;  
          }
        }   
      } 
      if (error > 0) {  
          var alertPopup = $ionicPopup.alert({
                title: '（・о・；）',
                template: 'Que boquinha suja eim, usaste uma palavra inapropriada né'
              }); 
      }else{
        formEventoCampanha.updateForm($scope.evento);
        $state.go('campanhacriadescricao') 
      }
    }else{
      var alertPopup = $ionicPopup.alert({
        title: '（ΦωΦ）',
        template: 'Coloque um nome legal'
      });
    }
    
  }



}])

.controller('campanhacriadescricaoCtrl', ['$scope', '$stateParams', 'formUser','formComercio', 'formLoc', 'EventoService', 'formAux', '$state','$timeout', '$ionicPopup', '$http', 'formOutro', 'formItem', 'formtela', 'formtelanoti', 'formtipologin','formEventoCampanha', '$ionicTabsDelegate', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, formUser,formComercio, formLoc, EventoService, formAux, $state, $timeout, $ionicPopup, $http, formOutro, formItem, formtela, formtelanoti, formtipologin, formEventoCampanha, $ionicTabsDelegate) {
  $scope.evento = {};
  $scope.user = formUser.getForm();

  $scope.$on("$ionicView.enter", function(event, data){
    $ionicTabsDelegate.showBar(0);
    $scope.evento = formEventoCampanha.getForm();
    $scope.user = formUser.getForm();
    $scope.comercio = formComercio.getForm();
    $scope.evento.descricao = $scope.comercio.infocomercio;
    $scope.evento.incluso = $scope.comercio.incluso;

  })



  $scope.Proximo = function(evento){

      var palavrasnaousar = ["ALIAMBA", "ANUS", "BAGULIO"
      , "BANZA", "BARRUFO", "BECK", "BEQUE", "BOCETA"
      , "BOLAGATO", "BOQUETE", "BOLCAT", "BOSSETA", "BOSTANA", "BREXA", "BRIOCO", "BRONHA", "BUCA", "BUCETA"
      , "BUSSETA", "CANABIS", "CANNABIS", "CARALHO"
      , "CASSETA", "CASSETE", "CHECHECA", "CHERECA", "CHIBUMBA", "CHIBUMBO", "CHOTA", "CHOCHOTA", "CHUPADA", "CHUPADO", "CLITORIS"
      , "COCAINA","C+"
      , "C*", "CURALHO", "CUZAO", "CUZUDA", "CUZUDO", "CUZÃO", "ESPORRADA", "ESPORRADO", "ESPORRO", "estupro"
      , "FELACAO", "FELACÃO", "FODA", "FODAO", "FODÃO", "FODAUM", "FODE", "FODIDA", "FODIDO", "FORNICA", "FUDENDO", "FUDECÃO", "FUDECAO"
      , "FUDIDA", "FUDIDO", "GRELINHO", "GRELO", "ISCROTA", "ISCROTO", "MACONHA", "MASTURBA", "MASTURBAÇÃO", "MASTURBACÃO", "MASTURBACAO"
      , "PENIS", "PEN1S", "PENES", "PENIZ", "PICA", "PIROCA", "PIRU", "PORRA", "POURRA", "PROSTIBULO", "PUTA", "PUNHETA", "PUTO"
      , "RABAO", "TESTUDA", "TESTUDO", "VAGABUNDA", "VAGINA", "VIADO", "VIADAO", "VIADÃO", "XAVASCA", "XERERECA", "XEXECA", "XOTA"
      , "XOCHOTA", "XOXOTA", "XANA", "XANINHA", "MDMA", "VSF", "TNC", "FDP", "CRACK"];
      var error = 0; 
      for (var i = 0; i < palavrasnaousar.length; i++) {
        var res2 = $scope.evento.descricao.split("_") ;
        if(res2.length>1){
          for(var w = 0; w < res2.length; w++){
            var val = palavrasnaousar[i].toLowerCase();
            if ((res2[w].toLowerCase()).indexOf(val.toString()) > -1) {  
              error = error + 1;  
            }
          }
        }else{
          var val = palavrasnaousar[i].toLowerCase();  
          if (($scope.evento.descricao.toLowerCase()).indexOf(val.toString()) > -1) {  
            error = error + 1;  
          }
        }
        var res3 = $scope.evento.descricao.split(" ") ;
        if(res3.length>1){
          for(var w = 0; w < res3.length; w++){
            var val = palavrasnaousar[i].toLowerCase();
            if ((res3[w].toLowerCase()).indexOf(val.toString()) > -1) {  
              error = error + 1;  
            }
          }
        }else{
          var val = palavrasnaousar[i].toLowerCase();  
          if (($scope.evento.descricao.toLowerCase()).indexOf(val.toString()) > -1) {  
            error = error + 1;  
          }
        }   
      } 
      if (error > 0) {  
          var alertPopup = $ionicPopup.alert({
                title: '（・о・；）',
                template: 'Que boquinha suja eim, usaste uma palavra inapropriada né'
              }); 
      }else{   
        if(evento.descricao){
          formEventoCampanha.updateForm($scope.evento);
          // var teste = $scope.evento.descricao.replace("\n", "<br />","g");
          // console.log(teste)
          $state.go('campanhacriafoto');
        }else{
          var alertPopup = $ionicPopup.alert({
                title: '( ꒪Д꒪)ノ',
                template: 'Escreva algo na descrição do evento para ajudar as pessoas a entenderem o que será feito'
              }); 
        }
        
      }
  
    
  }



}])


.controller('campanhacriafotoCtrl', ['$scope', '$stateParams', '$state', 'formEventoCriar', 'formUser','formComercio','$ionicPopup', '$http', 'formtela2', 'formtelaCriar', 'EventoService', '$cordovaCamera', '$cordovaFile', '$cordovaFileTransfer', '$cordovaDevice',  '$ionicLoading','formEventoCampanha', '$ionicTabsDelegate', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, $state, formEventoCriar, formUser,formComercio, $ionicPopup, $http, formtela2, formtelaCriar, EventoService, $cordovaCamera, $cordovaFile, $cordovaFileTransfer, $cordovaDevice,  $ionicLoading,  formEventoCampanha, $ionicTabsDelegate) {
 
  $scope.user = formUser.getForm();
  $scope.comercio = formComercio.getForm();
  $scope.evento = formEventoCampanha.getForm();
  var noti = {};

  $scope.pushnoti ={};
  $scope.auxfoto = '';
  $scope.confirmacao = 'aprovado';
  $scope.estado = '0';
  $scope.ic = {};
  var evpic ='';
  console.log($scope.evento.pmax)
  
    document.getElementById("imageCampanhaCriaFoto").src=$scope.comercio.fotocomercio;
    var optionsCamera = {
            quality : 100,
            sourceType : 0,
            allowEdit : true,
            targetWidth: 640,
            targetHeight: 640
      };
      $scope.takePicture = function() {
      var optionsCamera = {
          quality : 100,
          destinationType : Camera.DestinationType.FILE_URL,
          sourceType : Camera.PictureSourceType.CAMERA,
          allowEdit : true,
          encodingType: Camera.EncodingType.JPEG,
          targetWidth: 640,
          targetHeight: 640,
          popoverOptions: CameraPopoverOptions,
          saveToPhotoAlbum: true
      };

      $cordovaCamera.getPicture(optionsCamera).then(function(imageData) {
          $scope.imgURI = imageData;
      }, function(err) {
      });
    }
    $scope.getPicture = function (optionsCamera) {
      var optionsCamera = {
            quality : 100,
            sourceType : 0,
            allowEdit : true,
            targetWidth: 640,
            targetHeight: 640
      };
      $cordovaCamera.getPicture(optionsCamera).then(function(imageData) {
        $scope.imgURI = imageData;
        document.getElementById("imageCampanhaCriaFoto").src=imageData;
      }, function(err) {
        console.log(err);
      });
    };


  $scope.$on("$ionicView.enter", function(event, data){
    $ionicTabsDelegate.showBar(0);
    $scope.evento = formEventoCampanha.getForm();
    $scope.user = formUser.getForm();
    $scope.comercio = formComercio.getForm();
    var deu =false;
  });
  var deu =false;



    $scope.Proximo = function() {
      $ionicLoading.show({
            template: '<ion-spinner icon="ripple" class="spinner-diwo"></ion-spinner>'+
                      '<p style="color:#ff4444;font-weight:bold;font-family:Kollektif;padding:auto;margin:auto;">Aguarde enquanto juntamos as peças</p>'
      });
        if(deu==false){
          var hj = $scope.evento.diainicio;      
          var mes = (hj[5]+hj[6]).valueOf();
          var dia = (hj[8]+hj[9]).valueOf();
          var diadia = dia+'/'+mes;
          if(document.getElementById("imageCampanhaCriaFoto").src != $scope.comercio.fotocomercio){ 
            $scope.auxfoto = $scope.evento.nomeevento + $scope.evento.diainicio;
            var mystring = String($scope.auxfoto);
            mystring = mystring.replace(/[^a-zA-Z0-9]/g, '');
            $scope.evento.eventopic = 'https://s3.amazonaws.com/diwoappprofilepics/eventopicsdiwo/' + mystring + '.jpg';
          }else{
            $scope.evento.eventopic = $scope.comercio.fotocomercio;
          }
          var url = "https://ec2.diwoapp.com.br/uploadfotoevento.php";
                                  // File for Upload
          if($scope.imgURI){
            var targetPath = $scope.imgURI;
           
            // File name only
            //var name = $scope.imgURI.substr(imageData.lastIndexOf('/') + 1);
            var filename = mystring + '.jpg';
            // NO CASO SERIA O NOME DO USUARIO.jpg O fileName
            var options = {
              fileKey: "file",
              fileName: filename,
              chunkedMode: false,
              mimeType: "multipart/form-data"
            };
            $cordovaFileTransfer.upload(url, targetPath, options).then(function(result) {
                var link = 'https://ec2.diwoapp.com.br/criarcampanha.php';
                $http.post(link, {nomeevento : $scope.evento.nomeevento, 
                                          duracao : $scope.evento.duracao,
                                          diainicio : $scope.evento.diainicio,
                                          semana : $scope.evento.semana,
                                          diafim : $scope.evento.diafim,
                                          dialimiteconfirmacao: $scope.evento.dialimiteconfirmacao,
                                          pmin : $scope.evento.pmin, 
                                          patual : 0, 
                                          pmax : $scope.evento.pmax,
                                          adm : $scope.user.iduser,
                                          admusername : $scope.user.username,
                                          admapelido : $scope.user.apelido,
                                          preco : $scope.evento.preco,
                                          precopor : $scope.evento.precopor,  
                                          nomelocal : $scope.evento.nomelocal,
                                          endereco : $scope.evento.endereco,
                                          cidade : $scope.evento.cidade,
                                          lat : $scope.evento.lat,
                                          lng : $scope.evento.lng,
                                          genero : 'todos',
                                          estado : '0',
                                          eventopic : $scope.evento.eventopic,
                                          descricao : $scope.evento.descricao,
                                          comerciodevicetoken : $scope.user.devicetoken,
                                          tipodeevento:'campanha',
                                          descontomin: $scope.evento.descontomin,
                                          descontomax: $scope.evento.descontomax,
                                          descontopacote : $scope.evento.descontopacote,
                                          idComercioParceiro: $scope.user.iduser,
                                          incluso : $scope.evento.incluso}).then(function (res){
                            $scope.responsecriado = res.data;
                  console.log(res.data.success, "criou");
                  if ($scope.responsecriado.success == true) {
                          $http.post("https://ec2.diwoapp.com.br/getavisareventoscriados.php", {iduser : $scope.user.iduser}).then(function(response) {
                            console.log(response.data[0])
                            if(response.data[0] != 'E'){
                              $scope.auxresp = response.data[0]; 
                              for(var  i = 0 ; i<response.data[0].length;i++){
                                $scope.pushnoti.titulo = "Eeeii pssssiu!!";
                                $scope.pushnoti.msg =  "Um novo evento foi criado perto de vc, bora dar uma checada?👀";
                                $scope.pushnoti.token = $scope.auxresp[i].devicetoken;
                                EventoService.MandaPushNoti($scope.pushnoti);
                              }
                             }
                          });
                          
                      
                         deu = true;
                         // if($scope.imgURI == "img/ev.png"){
                        $ionicLoading.hide();
                        var alertPopup = $ionicPopup.alert({
                            title: 'Parabéns',
                            template: $scope.responsecriado.msg
                        }); 
                        alertPopup.then(function(){
                            $ionicLoading.hide();
                            formEventoCampanha.updateForm(1);
                            formtela2.updateForm(1);
                            $scope.evento = {};
                            $state.go('perfilComercio');
                        })
                         // }
                   
                         
                      
                 
                  }else{
                   var alertPopup = $ionicPopup.alert({
                          title: 'Ocorreu uma falha',
                          template: $scope.responsecriado.msg
                        });
                        alertPopup.then(function(){
                          $ionicLoading.hide();
                          $scope.evento = {};
                          formEventoCampanha.updateForm($scope.evento);
                          $state.go('perfilComercio');
                       })
                  }

              }, function(err) {
                $ionicPopup.alert({
                  title: 'Sorry!',
                  template: 'Aconteceu um probleminha, tente de novo'
                });
                $ionicLoading.hide();
              }, function (progress) {
                $ionicLoading.show({
                  title: '┗(＾0＾)┓',
                  template: 'DANCE, DANCE, DANCE!!'
                });
              });
            });
          }else{
            var link = 'https://ec2.diwoapp.com.br/criarcampanha.php';
              $http.post(link, {nomeevento : $scope.evento.nomeevento, 
                                        duracao : $scope.evento.duracao,
                                        diainicio : $scope.evento.diainicio,
                                        semana : $scope.evento.semana,
                                        diafim : $scope.evento.diafim,
                                        dialimiteconfirmacao: $scope.evento.dialimiteconfirmacao,
                                        pmin : $scope.evento.pmin, 
                                        patual : 0, 
                                        pmax : $scope.evento.pmax,
                                        adm : $scope.user.iduser,
                                        admusername : $scope.user.username,
                                        admapelido : $scope.user.apelido,
                                        preco : $scope.evento.preco,
                                        precopor : $scope.evento.precopor,  
                                        nomelocal : $scope.evento.nomelocal,
                                        endereco : $scope.evento.endereco,
                                        cidade : $scope.evento.cidade,
                                        lat : $scope.evento.lat,
                                        lng : $scope.evento.lng,
                                        genero : 'todos',
                                        estado : '0',
                                        eventopic : $scope.evento.eventopic,
                                        descricao : $scope.evento.descricao,
                                        comerciodevicetoken : $scope.user.devicetoken,
                                        tipodeevento:'campanha',
                                        descontomin: $scope.evento.descontomin,
                                        descontomax: $scope.evento.descontomax,
                                        descontopacote : $scope.evento.descontopacote,
                                        idComercioParceiro: $scope.user.iduser,
                                        incluso : $scope.evento.incluso}).then(function (res){
                          $scope.responsecriado = res.data;
                console.log(res.data.success, "criou");
                if ($scope.responsecriado.success == true) {
                        $http.post("https://ec2.diwoapp.com.br/getavisareventoscriados.php", {iduser : $scope.user.iduser}).then(function(response) {
                          console.log(response.data[0])
                          if(response.data[0] != 'E'){
                            $scope.auxresp = response.data[0]; 
                            for(var  i = 0 ; i<response.data[0].length;i++){
                              $scope.pushnoti.titulo = "Eeeii pssssiu!!";
                              $scope.pushnoti.msg =  "Um novo evento foi criado perto de vc, bora dar uma checada?👀";
                              $scope.pushnoti.token = $scope.auxresp[i].devicetoken;
                              EventoService.MandaPushNoti($scope.pushnoti);
                            }
                           }
                        });
                        
                    
                       deu = true;
                       // if($scope.imgURI == "img/ev.png"){
                      $ionicLoading.hide();
                      var alertPopup = $ionicPopup.alert({
                          title: 'Parabéns',
                          template: $scope.responsecriado.msg
                      }); 
                      alertPopup.then(function(){
                          $ionicLoading.hide();
                          formEventoCampanha.updateForm(1);
                          formtela2.updateForm(1);
                          $scope.evento = {};
                          $state.go('perfilComercio');
                      })
                       // }
                 
                       
                    
               
                }else{
                 var alertPopup = $ionicPopup.alert({
                        title: 'Ocorreu uma falha',
                        template: $scope.responsecriado.msg
                      });
                      alertPopup.then(function(){
                        $ionicLoading.hide();
                        $scope.evento = {};
                        formEventoCampanha.updateForm($scope.evento);
                        $state.go('perfilComercio');
                     })
                }

            }, function(err) {
              $ionicPopup.alert({
                title: 'Sorry!',
                template: 'Aconteceu um probleminha, tente de novo'
              });
              $ionicLoading.hide();
            }, function (progress) {
              $ionicLoading.show({
                title: '┗(＾0＾)┓',
                template: 'DANCE, DANCE, DANCE!!'
              });
            });

          }
        }

          
    }

}])

.controller('escolheperiodoCtrl', ['$scope', '$stateParams', 'formUser', 'EventoService', 'formAux', 'formQndo', '$state','$timeout', '$ionicPopup', '$http', 'formOutro', 'formItem', '$ionicTabsDelegate', 'formtelanoti','formEventoPerfil','$ionicLoading', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, formUser, EventoService, formAux, formQndo, $state, $timeout, $ionicPopup, $http, formOutro, formItem, $ionicTabsDelegate, formtelanoti, formEventoPerfil, $ionicLoading) {
  $scope.diaescolhido = formQndo.getForm();
  $scope.auxdata = {};
  $scope.auxoutrapessoa = {};
  $scope.auxeventomanha = {};
  $scope.auxeventotarde = {};
  $scope.auxeventonoite = {};

  $scope.user = formUser.getForm();
  $ionicTabsDelegate.showBar(0);


  $scope.datainvalidamanha = 0;
  $scope.datainvalidatarde = 0;
  $scope.datainvalidanoite = 0;
  $scope.periodoigualescolhidomanha = 0;
  $scope.periodoigualescolhidotarde = 0;
  $scope.periodoigualescolhidonoite = 0;

  var wemanha = "2019-" + $scope.diaescolhido.diainicio[3]+ $scope.diaescolhido.diainicio[4] + "-" + $scope.diaescolhido.diainicio[0]+ $scope.diaescolhido.diainicio[1]+ ' '+'07' + ':' + '00' + ':' + '00';
  var wefimmanha = "2019-" + $scope.diaescolhido.diainicio[3]+ $scope.diaescolhido.diainicio[4] + "-" + $scope.diaescolhido.diainicio[0]+ $scope.diaescolhido.diainicio[1]+ ' '+'12' + ':' + '00' + ':' + '00';
  
  var wetarde = "2019-" + $scope.diaescolhido.diainicio[3]+ $scope.diaescolhido.diainicio[4] + "-" + $scope.diaescolhido.diainicio[0]+ $scope.diaescolhido.diainicio[1]+ ' '+'12' + ':' + '01' + ':' + '00';
  var wefimtarde = "2019-" + $scope.diaescolhido.diainicio[3]+ $scope.diaescolhido.diainicio[4] + "-" + $scope.diaescolhido.diainicio[0]+ $scope.diaescolhido.diainicio[1]+ ' '+'18' + ':' + '00' + ':' + '00';
  
  var wenoite = "2019-" + $scope.diaescolhido.diainicio[3]+ $scope.diaescolhido.diainicio[4] + "-" + $scope.diaescolhido.diainicio[0]+ $scope.diaescolhido.diainicio[1]+ ' '+'18' + ':' + '01' + ':' + '00';
  var wefimnoite = "2019-" + $scope.diaescolhido.diainicio[3]+ $scope.diaescolhido.diainicio[4] + "-" + $scope.diaescolhido.diainicio[0]+ $scope.diaescolhido.diainicio[1]+ ' '+'23' + ':' + '59' + ':' + '00';
     


  $scope.$on("$ionicView.enter", function(event, data){
    $scope.diaescolhido = formQndo.getForm();
    $scope.auxdata = {};
    $scope.auxoutrapessoa = {};
    $scope.auxeventomanha = {};
    $scope.auxeventotarde = {};
    $scope.auxeventonoite = {};

    $scope.user = formUser.getForm();
    $ionicTabsDelegate.showBar(0);

    $scope.datainvalidamanha = 0;
    $scope.datainvalidatarde = 0;
    $scope.datainvalidanoite = 0;
    $scope.periodoigualescolhidomanha = 0;
    $scope.periodoigualescolhidotarde = 0;
    $scope.periodoigualescolhidonoite = 0;

    var wemanha = "2019-" + $scope.diaescolhido.diainicio[3]+ $scope.diaescolhido.diainicio[4] + "-" + $scope.diaescolhido.diainicio[0]+ $scope.diaescolhido.diainicio[1]+ ' '+'07' + ':' + '00' + ':' + '00';
    var wefimmanha = "2019-" + $scope.diaescolhido.diainicio[3]+ $scope.diaescolhido.diainicio[4] + "-" + $scope.diaescolhido.diainicio[0]+ $scope.diaescolhido.diainicio[1]+ ' '+'12' + ':' + '00' + ':' + '00';
    
    var wetarde = "2019-" + $scope.diaescolhido.diainicio[3]+ $scope.diaescolhido.diainicio[4] + "-" + $scope.diaescolhido.diainicio[0]+ $scope.diaescolhido.diainicio[1]+ ' '+'12' + ':' + '01' + ':' + '00';
    var wefimtarde = "2019-" + $scope.diaescolhido.diainicio[3]+ $scope.diaescolhido.diainicio[4] + "-" + $scope.diaescolhido.diainicio[0]+ $scope.diaescolhido.diainicio[1]+ ' '+'18' + ':' + '00' + ':' + '00';
    
    var wenoite = "2019-" + $scope.diaescolhido.diainicio[3]+ $scope.diaescolhido.diainicio[4] + "-" + $scope.diaescolhido.diainicio[0]+ $scope.diaescolhido.diainicio[1]+ ' '+'18' + ':' + '01' + ':' + '00';
    var wefimnoite = "2019-" + $scope.diaescolhido.diainicio[3]+ $scope.diaescolhido.diainicio[4] + "-" + $scope.diaescolhido.diainicio[0]+ $scope.diaescolhido.diainicio[1]+ ' '+'23' + ':' + '59' + ':' + '00';
       


    EventoService.verificahorariopessoaeventoperiodo($scope.user).then(function(items) {
      if(items!='Error' && items!='E'){
        $scope.auxdata = items;
        for(var r = 0;r<$scope.auxdata.length; r++){
          console.log($scope.auxdata[r].idevento, $scope.auxdata[r].diainicio, $scope.auxdata[r].diafim, wemanha );
          if (($scope.auxdata[r].diainicio <= wemanha && $scope.auxdata[r].diafim >= wemanha) || ($scope.auxdata[r].diainicio<=wefimmanha && $scope.auxdata[r].diafim>=wefimmanha) ||($scope.auxdata[r].diainicio >= wemanha && $scope.auxdata[r].diafim<=wefimmanha) || ($scope.auxdata[r].diainicio <= wemanha && $scope.auxdata[r].diafim>=wefimmanha) ) {
            $scope.datainvalidamanha = 1;
            //console.log("AQUI")
          }
          if (($scope.auxdata[r].diainicio <= wetarde && $scope.auxdata[r].diafim >= wetarde) || ($scope.auxdata[r].diainicio<=wefimtarde && $scope.auxdata[r].diafim>=wefimtarde) ||($scope.auxdata[r].diainicio >= wetarde && $scope.auxdata[r].diafim<=wefimtarde) || ($scope.auxdata[r].diainicio <= wetarde && $scope.auxdata[r].diafim>=wefimtarde) ) {
            $scope.datainvalidatarde = 1;
          }
          if (($scope.auxdata[r].diainicio <= wenoite && $scope.auxdata[r].diafim >= wenoite) || ($scope.auxdata[r].diainicio<=wefimnoite && $scope.auxdata[r].diafim>=wefimnoite) ||($scope.auxdata[r].diainicio >= wenoite && $scope.auxdata[r].diafim<=wefimnoite) || ($scope.auxdata[r].diainicio <= wenoite && $scope.auxdata[r].diafim>=wefimnoite) ) {
            $scope.datainvalidanoite = 1;
          }
        }
      }
    });

    EventoService.verificaeventoperiodo($scope.user).then(function(items) {
      $scope.auxoutrapessoa = items;
      console.log($scope.auxoutrapessoa, $scope.auxoutrapessoa.length,  "verificaeventoperiodo")
      if(items!='E'){
        for(var r2 = 0;r2<$scope.auxoutrapessoa.length; r2++){ 
          if($scope.auxoutrapessoa[r2].diainicio == wemanha){
            $scope.periodoigualescolhidomanha = 1;
            $scope.auxeventomanha = $scope.auxoutrapessoa[r2];
          }
          if($scope.auxoutrapessoa[r2].diainicio == wetarde){
            $scope.periodoigualescolhidotarde = 1;
            $scope.auxeventotarde = $scope.auxoutrapessoa[r2];
          }
          if($scope.auxoutrapessoa[r2].diainicio == wenoite){
            $scope.periodoigualescolhidonoite = 1;
            $scope.auxeventonoite = $scope.auxoutrapessoa[r2];
          }
        }
      }
      
    });

  });

  $scope.teste =  function(){
    console.log($scope.datainvalidamanha, $scope.datainvalidatarde, $scope.datainvalidanoite, $scope.periodoigualescolhidomanha, $scope.periodoigualescolhidotarde, $scope.periodoigualescolhidonoite)
  }

  
  
  $scope.manha =  function(){
    $ionicLoading.show({
      template: '<ion-spinner icon="ripple" class="spinner-diwo"></ion-spinner>'+
                '<p style="color:#ff4444;font-weight:bold;font-family:Kollektif;padding:auto;margin:auto;">Procurando gente</p>'
    });
    if($scope.datainvalidamanha == 0){
      if($scope.periodoigualescolhidomanha == 1){
        $scope.auxeventomanha.estado = 21;
        $scope.auxeventomanha.datamodificacao = new Date(); 
        $scope.auxeventomanha.patual = parseInt($scope.auxeventomanha.patual) +1;
        EventoService.atualizarevento($scope.auxeventomanha).then(function(msg){
          if (msg == 'Atualizado') {
             $http.post('https://ec2.diwoapp.com.br/atualizarpessoaevento.php' , {iduser : $scope.auxeventomanha.adm,
                                                                                idevento : $scope.auxeventomanha.idevento,
                                                                                confirmacao : 'Planejando',
                                                                                estado :'21'}).then(function(resp){console.log(resp.data.success)});
              $http.post('https://ec2.diwoapp.com.br/pessoanaoevento.php', {iduser : $scope.user.iduser, 
                                                                    idevento : $scope.auxeventomanha.idevento,
                                                                    nomeevento : 'Alguma coisa, ainda não sei',
                                                                    estado : '21'}); // marcando algo
            console.log(msg,"msg")
            var link = 'https://ec2.diwoapp.com.br/irevento.php';
            $http.post(link, {idevento : $scope.auxeventomanha.idevento, 
                            iduser : $scope.user.iduser,
                            idadm : $scope.user.iduser,
                            admusername : $scope.user.username,  
                            diainicio : wemanha,
                            diafim : wefimmanha,
                            username : $scope.user.username,
                            borda : $scope.user.borda,
                            apelido : $scope.user.apelido,
                            profilepic : $scope.user.profilepic,
                            devicetoken : $scope.user.devicetoken,
                            confirmacao : 'Planejando',
                            nomeevento :  'Alguma coisa, ainda não sei', 
                            eventopic : 'img/manha.png', 
                            estado : 21}).then(function (res){
              $scope.response = res.data;
              console.log($scope.response);
              $ionicLoading.hide();
              var alertPopup = $ionicPopup.alert({
                title: '(￣▽￣)ノ',
                template: 'Match!! Outra pessoa também está querendo fazer algo nessa data! Um chat será criado para vocês conversarem e quem sabe combinar algo juntos com mais pessoas!'
              });
               alertPopup.then(function(){
                  EventoService.getusuario2($scope.auxeventomanha.admusername).then(function(user) {
                    if(user.notichat == '1'){
                      $scope.pushnoti={};
                      $scope.pushnoti.titulo = "Match!!";
                      $scope.pushnoti.msg =  "Outra pessoa também está querendo fazer algo dia " +$scope.diaescolhido.dia + ". Um chat será criado para vocês conversarem";
                      $scope.pushnoti.token = user.devicetoken;
                       EventoService.MandaPushNoti($scope.pushnoti);
                     }
                  });

                  $state.go('tabsController.home');
                });
            })
          }
        });
      }else{
        var link = 'https://ec2.diwoapp.com.br/criarevento.php';
        $http.post(link, {nomeevento : 'Alguma coisa, ainda não sei', 
                      diainicio : wemanha,
                      semana : $scope.diaescolhido.semana,
                      diafim : wefimmanha,
                      dialimiteconfirmacao: wemanha,
                      patual : 1,
                      estado : 20, // Evento "Quando" sendo criado 
                      adm : $scope.user.iduser,
                      admusername : $scope.user.username,
                      admapelido : $scope.user.apelido,
                      lat: $scope.user.lat,
                      lng: $scope.user.long,
                      genero : 'todos',
                      eventopic : 'img/manha.png'}).then(function (res){
          $scope.responsecriado = res.data;
          console.log(res.data.success, "criou");
          if ($scope.responsecriado.success == true) {
            $http.post('https://ec2.diwoapp.com.br/pessoanaoevento.php', {iduser : $scope.user.iduser, 
                                                                    idevento : $scope.responsecriado.last,
                                                                    nomeevento : 'Alguma coisa, ainda não sei',
                                                                    estado : '21'}); // marcando algo
            var link = 'https://ec2.diwoapp.com.br/irevento.php';
            $http.post(link, {idevento : $scope.responsecriado.last, 
                            iduser : $scope.user.iduser,
                            idadm : $scope.user.iduser,
                            admusername : $scope.user.username,  
                            diainicio : wemanha,
                            diafim : wefimmanha,
                            username : $scope.user.username,
                            borda : $scope.user.borda,
                            apelido : $scope.user.apelido,
                            profilepic : $scope.user.profilepic,
                            devicetoken : $scope.user.devicetoken,
                            confirmacao : $scope.confirmacao,
                            nomeevento :  'Alguma coisa, ainda não sei', 
                            eventopic : 'img/manha.png', 
                            estado : 20}).then(function (res){
              $scope.response = res.data;
              $ionicLoading.hide();
              console.log($scope.response);
              var alertPopup = $ionicPopup.alert({
                title: '( ͡° ͜ʖ ͡°)',
                template: 'Se houver mais pessoas interessadas nessa data, juntaremos vocês em um chat para vocês conversarem, fique ligados nas notificações!'
              });
              alertPopup.then(function(){
                $state.go('tabsController.home');
              });
            })
          }
        });
      }

    }else{
      $ionicLoading.hide();
      var alertPopup = $ionicPopup.alert({
            title: 'Oww!!',
            template: 'Tu ja tem um evento marcado nesse dia de manhã :/'
          });
    }
  }

  $scope.tarde =  function(){
    $ionicLoading.show({
      template: '<ion-spinner icon="ripple" class="spinner-diwo"></ion-spinner>'+
                '<p style="color:#ff4444;font-weight:bold;font-family:Kollektif;padding:auto;margin:auto;">Procurando gente</p>'
    });
    if($scope.datainvalidatarde == 0){
      if($scope.periodoigualescolhidotarde == 1){
        $scope.auxeventotarde.estado = 21;
        $scope.auxeventotarde.datamodificacao = new Date(); 
        $scope.auxeventotarde.patual = parseInt($scope.auxeventotarde.patual) +1;
        EventoService.atualizarevento($scope.auxeventotarde).then(function(msg){
          if (msg == 'Atualizado') {
             $http.post('https://ec2.diwoapp.com.br/atualizarpessoaevento.php' , {iduser : $scope.auxeventotarde.adm,
                                                                                idevento : $scope.auxeventotarde.idevento,
                                                                                confirmacao : 'Planejando',
                                                                                estado :'21'}).then(function(resp){console.log(resp.data.success)});
              $http.post('https://ec2.diwoapp.com.br/pessoanaoevento.php', {iduser : $scope.user.iduser, 
                                                                    idevento : $scope.auxeventotarde.idevento,
                                                                    nomeevento : 'Alguma coisa, ainda não sei',
                                                                    estado : '21'}); // marcando algo
            console.log(msg,"msg")
            var link = 'https://ec2.diwoapp.com.br/irevento.php';
            $http.post(link, {idevento : $scope.auxeventotarde.idevento, 
                            iduser : $scope.user.iduser,
                            idadm : $scope.user.iduser,
                            admusername : $scope.user.username,  
                            diainicio : wetarde,
                            diafim : wefimtarde,
                            username : $scope.user.username,
                            borda : $scope.user.borda,
                            apelido : $scope.user.apelido,
                            profilepic : $scope.user.profilepic,
                            devicetoken : $scope.user.devicetoken,
                            confirmacao : 'Planejando',
                            nomeevento :  'Alguma coisa, ainda não sei', 
                            eventopic : 'img/tarde.png', 
                            estado : 21}).then(function (res){
              $scope.response = res.data;
              console.log($scope.response);
              $ionicLoading.hide();
              var alertPopup = $ionicPopup.alert({
                title: '(￣▽￣)ノ',
                template: 'Match!! Outra pessoa também está querendo fazer algo nessa data! Um chat será criado para vocês conversarem e quem sabe combinar algo juntos com mais pessoas!'
              });
               alertPopup.then(function(){
                  EventoService.getusuario2($scope.auxeventotarde.admusername).then(function(user) {
                    if(user.notichat == '1'){
                      $scope.pushnoti={};
                      $scope.pushnoti.titulo = "Match!!";
                      $scope.pushnoti.msg =  "Outra pessoa também está querendo fazer algo dia " +$scope.diaescolhido.dia + ". Um chat será criado para vocês conversarem";
                      $scope.pushnoti.token = user.devicetoken;
                       EventoService.MandaPushNoti($scope.pushnoti);
                     }
                  });
                  $state.go('tabsController.home');
                });
            })
          }
        });
      }else{
        var link = 'https://ec2.diwoapp.com.br/criarevento.php';
        $http.post(link, {nomeevento : 'Alguma coisa, ainda não sei', 
                      diainicio : wetarde,
                      semana : $scope.diaescolhido.semana,
                      diafim : wefimtarde,
                      dialimiteconfirmacao: wetarde,
                      patual : 1,
                      estado : 20, // Evento "Quando" sendo criado 
                      adm : $scope.user.iduser,
                      admusername : $scope.user.username,
                      admapelido : $scope.user.apelido,
                      lat: $scope.user.lat,
                      lng: $scope.user.long,
                      genero : 'todos',
                      eventopic : 'img/tarde.png'}).then(function (res){
          $scope.responsecriado = res.data;
          console.log(res.data.success, "criou");
          if ($scope.responsecriado.success == true) {
            $http.post('https://ec2.diwoapp.com.br/pessoanaoevento.php', {iduser : $scope.user.iduser, 
                                                                    idevento : $scope.responsecriado.last,
                                                                    nomeevento : 'Alguma coisa, ainda não sei',
                                                                    estado : '21'}); // marcando algo
            var link = 'https://ec2.diwoapp.com.br/irevento.php';
            $http.post(link, {idevento : $scope.responsecriado.last, 
                            iduser : $scope.user.iduser,
                            idadm : $scope.user.iduser,
                            admusername : $scope.user.username,  
                            diainicio : wetarde,
                            diafim : wefimtarde,
                            username : $scope.user.username,
                            borda : $scope.user.borda,
                            apelido : $scope.user.apelido,
                            profilepic : $scope.user.profilepic,
                            devicetoken : $scope.user.devicetoken,
                            confirmacao : $scope.confirmacao,
                            nomeevento :  'Alguma coisa, ainda não sei', 
                            eventopic : 'img/tarde.png', 
                            estado : 20}).then(function (res){
              $scope.response = res.data;
              $ionicLoading.hide();
              console.log($scope.response);
              var alertPopup = $ionicPopup.alert({
                title: '( ͡° ͜ʖ ͡°)',
                template: 'Se houver mais pessoas interessadas nessa data, juntaremos vocês em um chat para vocês conversarem, fique ligados nas notificações!'
              });
              alertPopup.then(function(){
                $state.go('tabsController.home');
              });
            })
          }
        });
      }

    }else{
      $ionicLoading.hide();
      var alertPopup = $ionicPopup.alert({
            title: 'Oww!!',
            template: 'Tu ja tem um evento marcado nesse dia de tarde :/'
          });
    }
  }

  $scope.noite =  function(){
    $ionicLoading.show({
      template: '<ion-spinner icon="ripple" class="spinner-diwo"></ion-spinner>'+
                '<p style="color:#ff4444;font-weight:bold;font-family:Kollektif;padding:auto;margin:auto;">Procurando gente</p>'
    });
    if($scope.datainvalidanoite == 0){
      if($scope.periodoigualescolhidonoite == 1){
        $scope.auxeventonoite.estado = 21;
        $scope.auxeventonoite.datamodificacao = new Date(); 
        $scope.auxeventonoite.patual = parseInt($scope.auxeventonoite.patual) +1;
        EventoService.atualizarevento($scope.auxeventonoite).then(function(msg){
          if (msg == 'Atualizado') {
             $http.post('https://ec2.diwoapp.com.br/atualizarpessoaevento.php' , {iduser : $scope.auxeventonoite.adm,
                                                                                idevento : $scope.auxeventonoite.idevento,
                                                                                confirmacao : 'Planejando',
                                                                                estado :'21'}).then(function(resp){console.log(resp.data.success)});
              $http.post('https://ec2.diwoapp.com.br/pessoanaoevento.php', {iduser : $scope.user.iduser, 
                                                                    idevento : $scope.auxeventonoite.idevento,
                                                                    nomeevento : 'Alguma coisa, ainda não sei',
                                                                    estado : '21'}); // marcando algo
            console.log(msg,"msg")
            var link = 'https://ec2.diwoapp.com.br/irevento.php';
            $http.post(link, {idevento : $scope.auxeventonoite.idevento, 
                            iduser : $scope.user.iduser,
                            idadm : $scope.user.iduser,
                            admusername : $scope.user.username,  
                            diainicio : wenoite,
                            diafim : wefimnoite,
                            username : $scope.user.username,
                            borda : $scope.user.borda,
                            apelido : $scope.user.apelido,
                            profilepic : $scope.user.profilepic,
                            devicetoken : $scope.user.devicetoken,
                            confirmacao : 'Planejando',
                            nomeevento :  'Alguma coisa, ainda não sei', 
                            eventopic : 'img/noite.png', 
                            estado : 21}).then(function (res){
              $scope.response = res.data;
              console.log($scope.response);
              $ionicLoading.hide();
              var alertPopup = $ionicPopup.alert({
                title: '(￣▽￣)ノ',
                template: 'Match!! Outra pessoa também está querendo fazer algo nessa data! Um chat será criado para vocês conversarem e quem sabe combinar algo juntos com mais pessoas!'
              });
               alertPopup.then(function(){
                  EventoService.getusuario2($scope.auxeventonoite.admusername).then(function(user) {
                    if(user.notichat == '1'){
                      $scope.pushnoti={};
                      $scope.pushnoti.titulo = "Match!!";
                      $scope.pushnoti.msg =  "Outra pessoa também está querendo fazer algo dia " +$scope.diaescolhido.dia + ". Um chat será criado para vocês conversarem";
                      $scope.pushnoti.token = user.devicetoken;
                       EventoService.MandaPushNoti($scope.pushnoti);
                     }
                  });
                  $state.go('tabsController.home');
                });
            })
          }
        });
      }else{
        var link = 'https://ec2.diwoapp.com.br/criarevento.php';
        $http.post(link, {nomeevento : 'Alguma coisa, ainda não sei', 
                      diainicio : wenoite,
                      semana : $scope.diaescolhido.semana,
                      diafim : wefimnoite,
                      dialimiteconfirmacao: wenoite,
                      patual : 1,
                      estado : 20, // Evento "Quando" sendo criado 
                      adm : $scope.user.iduser,
                      admusername : $scope.user.username,
                      admapelido : $scope.user.apelido,
                      lat: $scope.user.lat,
                      lng: $scope.user.long,
                      genero : 'todos',
                      eventopic : 'img/noite.png'}).then(function (res){
          $scope.responsecriado = res.data;
          console.log(res.data.success, "criou");
          if ($scope.responsecriado.success == true) {
            $http.post('https://ec2.diwoapp.com.br/pessoanaoevento.php', {iduser : $scope.user.iduser, 
                                                                    idevento : $scope.responsecriado.last,
                                                                    nomeevento : 'Alguma coisa, ainda não sei',
                                                                    estado : '21'}); // marcando algo
            var link = 'https://ec2.diwoapp.com.br/irevento.php';
            $http.post(link, {idevento : $scope.responsecriado.last, 
                            iduser : $scope.user.iduser,
                            idadm : $scope.user.iduser,
                            admusername : $scope.user.username,  
                            diainicio : wenoite,
                            diafim : wefimnoite,
                            username : $scope.user.username,
                            borda : $scope.user.borda,
                            apelido : $scope.user.apelido,
                            profilepic : $scope.user.profilepic,
                            devicetoken : $scope.user.devicetoken,
                            confirmacao : $scope.confirmacao,
                            nomeevento :  'Alguma coisa, ainda não sei', 
                            eventopic : 'img/noite.png', 
                            estado : 20}).then(function (res){
              $scope.response = res.data;
              $ionicLoading.hide();
              console.log($scope.response);
              var alertPopup = $ionicPopup.alert({
                title: '( ͡° ͜ʖ ͡°)',
                template: 'Se houver mais pessoas interessadas nessa data, juntaremos vocês em um chat para vocês conversarem, fique ligados nas notificações!'
              });
              alertPopup.then(function(){
                $state.go('tabsController.home');
              });
            })
          }
        });
      }

    }else{
      $ionicLoading.hide();
      var alertPopup = $ionicPopup.alert({
            title: 'Oww!!',
            template: 'Tu ja tem um evento marcado nesse dia de noite :/'
          });
    }
  }

   
}])

.controller('telacomerciohomeCtrl', ['$scope', '$stateParams', '$state', 'EventoService', 'formComercio', '$ionicTabsDelegate', 'formItem', 'formDataEscolhida', '$ionicPopup', '$cordovaActionSheet','$ionicLoading','$http','formCodigo', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, $state, EventoService, formComercio, $ionicTabsDelegate, formItem, formDataEscolhida, $ionicPopup, $cordovaActionSheet,$ionicLoading,$http,formCodigo) {

  $scope.comercio = formComercio.getForm();


  $scope.$on("$ionicView.enter", function(event, data){
    $ionicTabsDelegate.showBar(0);
  
    $scope.comercio = formComercio.getForm();
    
     if($scope.comercio.preco == '0' || $scope.comercio.preco =="Gratuito"){
        $scope.comercio.preco = "Gratuito";
        $scope.porpessoa = false;
        $scope.porlocal = false;
      }else{
        if($scope.comercio.precopor == '1'){
          $scope.porpessoa = true;
          $scope.porlocal = false;
        }else{
          $scope.porpessoa = false;
          $scope.porlocal = true;
        }
      }
      if($scope.comercio.oqtem){
        $scope.auxsemanabutton1 = true;
        $scope.auxsemanabutton2 = true;
        $scope.auxsemanabutton3 = true;
        $scope.auxsemanabutton4 = true;
        $scope.auxsemanabutton5 = true;
        $scope.auxsemanabutton6 = true;
        $scope.auxsemanabutton7 = true;
        var res2 = $scope.comercio.oqtem.split(" ") ;
        if(res2.length>1){
          for(var w = 0; w < res2.length; w++){
            if(res2[w] == 'Arcondicionado'){
              $scope.auxsemanabutton1 = false;
              $scope.auxsemanabutton1aux = true;
            }
            if(res2[w] == 'Areadefumante'){
              $scope.auxsemanabutton2 = false;
              $scope.auxsemanabutton2aux = true;
            }
            if(res2[w] == 'Estacionamento'){
              $scope.auxsemanabutton3 = false;
              $scope.auxsemanabutton3aux = true;
            }
            if(res2[w] == 'Pets'){
              $scope.auxsemanabutton4 = false;
              $scope.auxsemanabutton4aux = true;
            }
            if(res2[w] == 'PNE'){
              $scope.auxsemanabutton5 = false;
              $scope.auxsemanabutton5aux = true;
            }
            if(res2[w] == 'Wifi'){
              $scope.auxsemanabutton6 = false;
              $scope.auxsemanabutton6aux = true;
            }
          }
        }
      }else{
        $scope.auxsemanabutton1aux = false;
        $scope.auxsemanabutton2aux = false;
        $scope.auxsemanabutton3aux = false;
        $scope.auxsemanabutton4aux = false;
        $scope.auxsemanabutton5aux = false;
        $scope.auxsemanabutton6aux = false;
        $scope.auxsemanabutton7aux = false;
        $scope.auxsemanabutton1 = true;
        $scope.auxsemanabutton2 = true;
        $scope.auxsemanabutton3 = true;
        $scope.auxsemanabutton4 = true;
        $scope.auxsemanabutton5 = true;
        $scope.auxsemanabutton6 = true;
        $scope.auxsemanabutton7 = true;
      }
  });

    $scope.Vermapa = function(){
      formItem.updateForm($scope.comercio)
      $state.go('tabsController.ver_onde_mapa');
    }
   
  // $scope.enterEvento =  function(item){
  //   formItem.updateForm(item);
  //   $state.go('tabsController.Eventocomercio');
  // }
    
}])


.controller('homeCtrl', ['$scope', '$stateParams','$http', 'formPost','formMeusPost','formvimdopost','formQndo', 'EventoService', '$timeout', 'formItem', '$state', 'formUser', 'formtela', 'formtelaCriar', '$ionicLoading', 'formvimdofiltro', 'formvimdofiltroperfil', 'formLimiteatuacao', '$ionicTabsDelegate', '$cordovaCamera', '$cordovaFile', '$cordovaFileTransfer', '$cordovaDevice','$ionicPopup','formvimdonoti','formOutro', 'formResetoufeed','$cordovaSocialSharing','formComercio','formPagSeguro',  // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, $http, formPost,formMeusPost,formvimdopost,formQndo, EventoService, $timeout, formItem,  $state, formUser, formtela, formtelaCriar, $ionicLoading, formvimdofiltro, formvimdofiltroperfil, formLimiteatuacao, $ionicTabsDelegate, $cordovaCamera, $cordovaFile, $cordovaFileTransfer, $cordovaDevice,$ionicPopup,formvimdonoti, formOutro, formResetoufeed , $cordovaSocialSharing, formComercio, formPagSeguro) {
 
  $scope.user = formUser.getForm();
  EventoService.Entrando($scope.user).then(function(data){
    //console.log(data.success,"Sucoessa")
    if(data.success){
      $scope.user = data[0];
      window.localStorage.setItem( 'user', JSON.stringify(data[0]));
      formUser.updateForm(data[0]);
    }
  });

  $scope.$on('$ionicView.beforeLeave', function(){
    $scope.mostramaisinfo = false;
    console.log(qualitemindex,"qualitemindex")
    if(qualitemindex>=0){
     $scope.items[qualitemindex].mostratudo = false;   
     console.log("oansiodoadijo")
    } 
    qualitemindex = '';
    $ionicTabsDelegate.showBar(1);
  });
  $scope.verparceiro = function(item){
    $scope.aux8 = {}
    $scope.aux8.iduser = item.idComercioParceiro
    EventoService.GetComercioPerfil($scope.aux8).then(function(comercio) { //
      formComercio.updateForm(comercio);
      $state.go("tabsController.telacomerciohome");
    });
  }


      $scope.raiodistoriginal = window.localStorage.getItem( 'dist' );
      if(!$scope.raiodistoriginal){
        $scope.raiodist = 30000;
        console.log($scope.raiodist, "raiodist")
      }
      $scope.datas =[];
      $scope.datainicio= [];
      $scope.dia = [];
      $scope.semana =[];
      $scope.mesescrito =[];
      $scope.datas.dia =[];
      $scope.datas.semana =[];
      $scope.datas.mesescrito =[];
      for(var i = 0;i<30;i++){
        var now = new Date(); 
        now.setDate(now.getDate() + i );
        var curr_date1 = (now.getDate()<10?'0':'') + now.getDate();
        var curr_month1 = (now.getMonth()<10?'0':'') + (now.getMonth() + 1); ; 
        var curr_year1 = now.getFullYear();
        var h2 = (now.getHours()<10?'0':'') + now.getHours();
        var m2 = (now.getMinutes()<10?'0':'') + now.getMinutes();
        $scope.semana[i] =  now.getDay();
        var j = curr_date1 + "/" + curr_month1 + "/" + curr_year1+ ' '+h2 + ':' + m2;
        $scope.datainicio[i] = j;
        //console.log(curr_month1, parseInt(curr_month1))
        if(parseInt(curr_month1) == 1){
          $scope.mesescrito[i] = "Jan";
        }
        if(parseInt(curr_month1) == 1){
          $scope.mesescrito[i] = "Jan";
        }
        if(parseInt(curr_month1) == 2){
          $scope.mesescrito[i] = "Fev";
        }
        if(parseInt(curr_month1) == 3){
          $scope.mesescrito[i] = "Mar";
        }
        if(parseInt(curr_month1) == 4){
          $scope.mesescrito[i] = "Abr";
        }
        if(parseInt(curr_month1) == 5){
          $scope.mesescrito[i] = "Mai";
        }
        if(parseInt(curr_month1) == 6){
          $scope.mesescrito[i] = "Jun";
        }
        if(parseInt(curr_month1) == 7){
          $scope.mesescrito[i] = "Jul";
        }
        if(parseInt(curr_month1) == 8){
          $scope.mesescrito[i] = "Ago";
        }
        if(parseInt(curr_month1) == 9){
          $scope.mesescrito[i] = "Set";
        }
        if(parseInt(curr_month1) == 10){
          $scope.mesescrito[i] = "Out";
        }
        if(parseInt(curr_month1) == 11){
          $scope.mesescrito[i] = "Nov";
        }
        if(parseInt(curr_month1) == 12){
          $scope.mesescrito[i] = "Dez";
        }

        $scope.dia[i] = curr_date1;
   
         //console.log($scope.semana[i],"ANTEST",$scope.dia[i], i, $scope.semana[i],  $scope.datainicio[i]);
        if($scope.semana[i] == 0){
          $scope.semana[i] = "Dom";
        }
        if($scope.semana[i] == 1){
          $scope.semana[i] = "Seg";
        }
        if( $scope.semana[i] == 2){
          $scope.semana[i] = "Ter";
        }
        if($scope.semana[i] == 3){
          $scope.semana[i] = "Qua";
        }
        if($scope.semana[i] == 4){
          $scope.semana[i] = "Qui";
        }
        if($scope.semana[i] == 5){
          $scope.semana[i] = "Sex";
        }
        if($scope.semana[i] == 6){
          $scope.semana[i] = "Sáb";
        }
        //console.log($scope.semana[i],"$scope.semana[i]",$scope.dia[i]);
      $scope.datas[i] = {dia : $scope.dia[i], semana : $scope.semana[i], diainicio:  $scope.datainicio[i], mesescrito : $scope.mesescrito[i]};
     
      // $scope.datas[i] = {};
      // $scope.datas.semana[i] = $scope.semana[i];
      //console.log($scope.semana[i])
     }

    EventoService.GetAlerta($scope.user).then(function(alerta){
      //console.log(alerta.length, "alerta", alerta[0].idalerta);
      if(alerta!="E" && alerta !="Error"){
        for(var i =0 ;i<alerta.length;i++){
          var alertPopup = $ionicPopup.alert({
                        title: alerta[i].titulo,
                        template: '<center><img style="width : 20vw ; height : auto;" src="'+alerta[i].img+'"/></center> <br>'+ alerta[i].msg});
          alertPopup.then(function(){
            EventoService.DeletaAlerta(alerta[0]);
          });
        }
      }
    })
     
    $scope.qndodata = function(dataescolhida){      
      $scope.dataescolhida = {}
      $scope.dataescolhida.dia = dataescolhida.dia;
      $scope.dataescolhida.diainicio = dataescolhida.diainicio;
      $scope.dataescolhida.semana = dataescolhida.semana;
      formQndo.updateQndo($scope.dataescolhida);
      console.log($scope.dataescolhida, $scope.user.lat);
      if($scope.dataescolhida && $scope.user.lat){
        $state.go('tabsController.escolheperiodo');
      }else{
         if (navigator.geolocation) {
          navigator.geolocation.getCurrentPosition(successFunction, errorFunction);
        } 
        function successFunction(position) {
          raio = $scope.raiodistoriginal*0.71;
          lat  = position.coords.latitude;
          long = position.coords.longitude;
          $scope.user.lat =  position.coords.latitude;
          $scope.user.long =  position.coords.longitude;
          myLatlng = new google.maps.LatLng(lat, long);
          spherical = google.maps.geometry.spherical; 
          north = spherical.computeOffset(myLatlng, raio, 0); 
          west  = spherical.computeOffset(myLatlng, raio, -90); 
          south = spherical.computeOffset(myLatlng, raio, 180); 
          east  = spherical.computeOffset(myLatlng, raio, 90);
          $scope.user.northlat = north.lat();
          $scope.user.westlng = west.lng();
          $scope.user.southlat = south.lat();
          $scope.user.eastlng = east.lng();
          formUser.updateForm($scope.user);
          $state.go('tabsController.escolheperiodo'); 
        }

        function errorFunction(){
            //alert("Geocoder failed");
            $scope.semloc = true;
        }
      }
    }


    $scope.share = function(t, msg, img, link){ 
      console.log($scope.evento.diainicio)
      $scope.msgshare = "Olha o que achei: " + $scope.evento.nomeevento + ' ' +$scope.evento.diainicio[8]+$scope.evento.diainicio[9]+'/'+ +$scope.evento.diainicio[5]+$scope.evento.diainicio[6] + ' bora?';
      $scope.linkevento = "https://ec2.diwoapp.com.br/pageteste.html?idevento="+$scope.evento.idevento;
       console.log($scope.msgshare)
        if(t == 'w')
          $cordovaSocialSharing.canShareVia('whatsapp', $scope.msgshare, '', 'http://diwoapp.com.br/politica-de-privacidade/').then(function(result) {
            $cordovaSocialSharing.shareViaWhatsApp($scope.msgshare, '' , $scope.linkevento) ;
            }, function(error) {
                alert("Cannot share on whatsapp");
            });
        else if(t == 'f')
          $cordovaSocialSharing.canShareVia('facebook', $scope.msgshare, '', 'http://diwoapp.com.br/politica-de-privacidade/').then(function(result) {
                $cordovaSocialSharing.shareViaFacebook( $scope.msgshare, '', $scope.linkevento);
            }, function(error) {
                alert("Cannot share on whatsapp");
            });
  
        else if(t == 't')
            $cordovaSocialSharing.canShareVia('twitter', $scope.msgshare, '', 'http://diwoapp.com.br/politica-de-privacidade/').then(function(result) {
                $cordovaSocialSharing.shareViaTwitter( + $scope.msgshare, '',  $scope.linkevento);
            }, function(error) {
                alert("Cannot share on whatsapp");
            }); 
    }

                      
    $scope.chamamos = function(){  
      $scope.carinha = '';
      $ionicPopup.prompt({
          title: 'Ajude um amigo',
          template: 'Ajude um amigo(a) que amaria esse evento a fazer parte dele também! Com um amigo é sempre mais seguro.Nós enviaremos um meme, poema ou áudio convidando ele(a) por você. Só precisamos do “@”, email ou telefone dela e voilá :)',
         inputType: 'text',
         inputPlaceholder: '@insta ou numero pra whats ou email'
       }).then(function(contato) {
        if(contato){
          if(contato!= ''){
            $scope.carinha = $scope.aux.iduser + " " +$scope.aux.username + " quer convidar: " + contato + " no evento id:" + $scope.evento.idevento + " nome do evento: " + $scope.evento.nomeevento;
            $http.post('https://ec2.diwoapp.com.br/pedeconvite.php', {namereportado : $scope.evento.nomeevento,
                                                                                      usernamereportando : contato,
                                                                                      tiporeport : 'Convide meu amigo',
                                                                                      motivo : $scope.carinha}).then(function (tes){
              if(tes.data.success == true){
                var alertPopup = $ionicPopup.alert({
                  title: 'Pronto!',
                  template: 'Convidaremos ele de uma das formas, obrigado!!'
                });
                alertPopup.then(function(){
                  EventoService.ConvidarPessoaevento($scope.helppp).then(function(convite) {
                    if(convite){
                      $scope.convidar = false;
                    }
                  });
                });
              }else{
                var alertPopup = $ionicPopup.alert({
                  title: 'Vish',
                  template: 'Ocorreu uma falha!!'
                });
              }
            });
          }
          console.log($scope.carinha)
        }
      }); 
    }

  $scope.reportar = function(){
    $scope.reportmsg = '';
    //console.log($scope.evento.admusername);
    $scope.report = [
      { text: "Conteúdo impróprio", checked: false },
      { text: "Linguajar inadequado", checked: false },
      { text: "Discurso de ódio", checked: false },
      { text: "Imagem imprópria", checked: false },
      { text: "Substancias ilicitas ", checked: false }
    ];
    $ionicPopup.confirm({
        title: 'Você quer reportar esse evento pq?',
        content: '<ion-checkbox ng-repeat="item in report" style="color: #FCFCFC;" ng-model="item.checked"  ng-checked="item.checked">{{item.text}}</ion-checkbox>',
        scope: $scope
    }).then(function(res) {
        if(res) {
          for (var h=0;h<3;h++){
            //console.log($scope.report[h].checked , h);
            if($scope.report[h].checked){
              $scope.reportmsg = $scope.reportmsg + $scope.report[h].text + ' ';
              //console.log($scope.reportmsg);
            }
          }
          if(h==3){
            console.log($scope.reportmsg);
            $http.post('https://ec2.diwoapp.com.br/reportaevento.php', {namereportado : $scope.evento.admusername,
                                                                            reportadoid : $scope.evento.idevento,
                                                                            iduserreportando : $scope.user.iduser,
                                                                            usernamereportando : $scope.user.username,
                                                                            tiporeport : 'evento',
                                                                            motivo : $scope.reportmsg}).then(function (tes){
              $scope.response = tes.data;
              var alertPopup = $ionicPopup.alert({
                                        title: 'Obrigado',
                                        template: 'Este evento esta agora sobre avaliação, obrigado por manter a plataforma organizada'
              });
            });
          }
        }
    });
  }
  

  $scope.enterPessoa =  function(item){
    formOutro.updateForm(item);
    console.log(item.iduser, "enterPessoa");
    formvimdofiltroperfil.updateForm(false);
    $state.go('tabsController.perfilOutro');
  }
  
  //document.getElementById("page2").style.backgroundImage = "url('img/Fundo/colourful_arcs.jpg')"
  var confirmaida = false;
  $scope.cardDestroyed = function(index) {
    console.log(index, "EXISTE??????")
    if(!index){
      if(!qualitemindex){
        var index = 0;
      }else{
        var index = qualitemindex;
      }
      
    }
    console.log(index, "Index", confirmaida)
      $scope.evento= $scope.items[index];
      console.log($scope.items[index], index, $scope.user.iduser)
      $scope.mostramaisinfo = false;
      $ionicTabsDelegate.showBar(1);
      $scope.items[index].mostratudo = false;
      console.log($scope.evento.nomeevento, "destruida")
      if(!$scope.user.iduser){
        //console.log("$scope.user")
        if(index == 0){
          $scope.semfeed = true;
        }
      }
      if(!confirmaida){
         $http.post('https://ec2.diwoapp.com.br/pessoanaoevento.php', {iduser : $scope.user.iduser, 
                                                                  idevento : $scope.evento.idevento,
                                                                  nomeevento : $scope.evento.nomeevento,
                                                                  estado : '11'}).then(function(resp){//nao aparece mais no feed da pessoa o evento
                                                                    $http.post('https://ec2.diwoapp.com.br/deletapessoaevento.php', {iduser : $scope.user.iduser,
                                                                        idevento : $scope.evento.idevento,
                                                                        estado: '7'});
                                                                    if(index == 0){
                                                                        $scope.semfeed = true;
                                                                      }
                                                                  });
                                                                  console.log("AQUII CONFIMRANDO IDA")

      }else{
        console.log("NAOO CONFIRMA IDA")
        confirmaida = false;
      }
     
    $scope.items.splice(index, 1);

  };
  $scope.cardSwiped = function(index) {
    if(!index){
      if(!qualitemindex){
        index = 0;
      }else{
        index = qualitemindex;
      }
      
    }
     confirmaida = true;
     console.log(index , "INDEX CONSTROI")
      $scope.evento= $scope.items[index];
      //console.log($scope.evento.nomeevento , "construida", $scope.evento.estado, index);
      var datainvalida = 0;
      EventoService.verificahorariopessoaeventoconfirmados($scope.user).then(function(items) {
        $scope.auxdata = items;
        for(var r = 0;r<$scope.auxdata.length; r++){
          console.log($scope.auxdata[r].idevento, $scope.auxdata[r].diainicio, $scope.auxdata[r].diafim ,$scope.evento.diafim);
          if($scope.evento.idevento!=$scope.auxdata[r].idevento){
            if (($scope.auxdata[r].diainicio < $scope.evento.diainicio && $scope.auxdata[r].diafim > $scope.evento.diainicio) || ($scope.auxdata[r].diainicio<$scope.evento.diafim && $scope.auxdata[r].diafim>$scope.evento.diafim) ||($scope.auxdata[r].diainicio > $scope.evento.diainicio && $scope.auxdata[r].diafim<$scope.evento.diafim) || ($scope.auxdata[r].diainicio < $scope.evento.diainicio && $scope.auxdata[r].diafim>$scope.evento.diafim) ) {
              console.log('horario invalido');
              datainvalida = 1;
            }
          }
        }
      });

      $http.post('https://ec2.diwoapp.com.br/pessoanaoevento.php', {iduser : $scope.user.iduser, 
                                                                    idevento : $scope.evento.idevento,
                                                                    nomeevento : $scope.evento.nomeevento,
                                                                    estado : '10'}).then(function(resp) {//aceitou ir evento, nao mostra mais feed
        if(resp.data.success){
          if($scope.evento.estado == 21){
             var link = 'https://ec2.diwoapp.com.br/irevento.php';
            $http.post(link, {idevento : $scope.evento.idevento, 
                            iduser : $scope.user.iduser,
                            idadm : $scope.user.iduser,
                            admusername : $scope.user.username,  
                            diainicio : $scope.evento.diainicio,
                            diafim : $scope.evento.diafim,
                            username : $scope.user.username,
                            borda : $scope.user.borda,
                            apelido : $scope.user.apelido,
                            profilepic : $scope.user.profilepic,
                            devicetoken : $scope.user.devicetoken,
                            confirmacao : 'Planejando',
                            nomeevento :  'Alguma coisa, ainda não sei', 
                            eventopic : 'img/manha.png', 
                            estado : 21}).then(function (res){
              $scope.response = res.data;
              console.log($scope.response);
              var alertPopup = $ionicPopup.alert({
                title: '(￣▽￣)ノ',
                template: 'Veja nos seus eventos o que estão combinando sobre esse evento.'
              });
            })
            if(index == 0){
              $scope.semfeed = true;
            }
          }else{
            if(datainvalida==1){
              var alertPopup = $ionicPopup.alert({
                title: 'ಠ_ಠ',
                template: 'Ja tens um evento marcado nesta data querido'
              });
            }else{
              var noti = {};
              $scope.pushnoti = {};
                    if (!$scope.evento.idevento || !$scope.user.iduser) {
                                    var alertPopup = $ionicPopup.alert({
                                    title: 'Vish deu ruim',
                                    template: 'Favor refaça seu login'
                                  });

                    }else{
                      if($scope.evento.tipodeevento){
                        if($scope.evento.zone == 'yellow'){
                          var confirmPopup = $ionicPopup.show({
                               title: 'ZONA AMARELA',
                               template: 'Evento esta na ZONA AMARELA, caso voce desista uma vez que confirmado a presença tu sofrerás um cartão amarelo. Deseja ir mesmo assim?',
                               buttons: [
                                  { text: 'Não sei se vou',
                                    type: 'button-assertive',
                                    onTap: function(e){
                                      console.log('nada acontece');
                                    }},
                                  {
                                    text: 'Quero ir',
                                    type: 'button-positive',
                                    onTap: function(e){
                                      $scope.confirmacao = 'Confirmação aceita';
                                      $scope.estado = '2';
                            var link = 'https://ec2.diwoapp.com.br/irevento.php';
                            $http.post(link, {idevento : $scope.evento.idevento,
                                            idadm : $scope.evento.adm, 
                                            admusername : $scope.evento.admusername, 
                                            diainicio : $scope.evento.diainicio,
                                            diafim : $scope.evento.diafim,
                                            iduser : $scope.user.iduser,
                                            borda : $scope.user.borda,
                                            username: $scope.user.username,
                                            profilepic : $scope.user.profilepic,
                                            devicetoken : $scope.user.devicetoken,
                                            apelido : $scope.user.apelido,
                                            confirmacao : $scope.confirmacao,
                                            nomeevento :  $scope.evento.nomeevento,
                                            eventopic : $scope.evento.eventopic,
                                            idComercioParceiro : $scope.evento.idComercioParceiro, 
                                            estado : $scope.estado}).then(function (res){
                              $scope.response = res.data;
                              if(index == 0){
                                $scope.semfeed = true;
                              }
                              $http.post('https://ec2.diwoapp.com.br/deletapessoaevento.php', {iduser : $scope.user.iduser,
                                                                                          idevento : $scope.evento.idevento,
                                                                                          estado: '5'});
                              if ($scope.response.success == true) {
                                $scope.evento.patual = parseInt($scope.evento.patual)+1;
                                $http.post('https://ec2.diwoapp.com.br/addpessoaevento.php', {idevento : $scope.evento.idevento,
                                                                                patual : $scope.evento.patual});
                                console.log($scope.evento.patual,$scope.evento.pmin , 'Número de pessoas alcançado do evento ')
                                if(parseInt($scope.evento.patual) == parseInt($scope.evento.pmin)){
                                  EventoService.GetUserPorId($scope.evento.idComercioParceiro).then(function(comercio) {
                                    $scope.msgnotiComercio = ('Número mínimo de pessoas alcançado do evento ' + $scope.evento.nomeevento );
                                    noti.recebeusername = comercio.username;
                                    noti.recebe = comercio.idComercioParceiro;
                                    noti.envia = comercio.idComercioParceiro;
                                    noti.tipo = 51;   //evento bateu numero minimo de pessoas para acontecer
                                    noti.nomeevento = $scope.evento.nomeevento;
                                      EventoService.VerificaNotificacao(noti).then(function(res) {
                                      if(res){
                                        $http.post('https://ec2.diwoapp.com.br/notificapessoa.php', {notificacao : $scope.msgnotiComercio, 
                                                      idevento : $scope.evento.idevento,
                                                      nomeevento : $scope.evento.nomeevento,
                                                      id_user_envia : $scope.evento.idComercioParceiro,
                                                      username_envia : $scope.evento.nomeevento,
                                                      apelido_envia : $scope.evento.nomeevento,
                                                      tipo : '51',
                                                      id_user_recebe : $scope.evento.idComercioParceiro});
                                          $scope.pushnoti.titulo =  'Número de pessoas alcançado!' ;
                                          $scope.pushnoti.msg = $scope.msgnotiComercio;
                                          $scope.pushnoti.token = comercio.devicetoken;
                                          EventoService.MandaPushNoti($scope.pushnoti);
                                          $scope.pushnoti.titulo =  'Número de pessoas alcançado!' ;
                                          $scope.pushnoti.msg = $scope.msgnotiComercio;
                                          $scope.pushnoti.token = 'dKpOML7ZLIA:APA91bFhTghUqP4gpCkohaf3h1WzCjDwQTrMg2JbUJjEQ9WegZgXWZQSNWtwoeAIu98bLK6wtSByVo1jluGyPmVmBxrvEWu6sluypuLk6O7F_18Z_e2kko7UQdK16Hu7O4qxsvstCmSI';
                                          EventoService.MandaPushNoti($scope.pushnoti);
                                      }
                                    });
                                  });
                                }
                                $http.post("https://ec2.diwoapp.com.br/deletanotificacaoporids.php", {id_user_recebe : noti.recebe,
                                                                                          id_user_envia: noti.envia,
                                                                                          nomeevento: noti.nomeevento,
                                                                                          tipo : '5'});
                                var alertPopup = $ionicPopup.alert({
                                  title: 'Parabéns',
                                  template: $scope.response.msg
                                });
                                alertPopup.then(function(){
                                  $http.post('https://ec2.diwoapp.com.br/deletapessoaevento.php', {iduser : $scope.user.iduser,
                                                                                          idevento : $scope.evento.idevento,
                                                                                          estado: '7'}).then(function (res){
                                  $scope.response = res.data;
                                  //console.log(i);
                                  $scope.fav = false;
                                  });
                                  $scope.items[index].mostratudo = false;
                                  $scope.mostramaisinfo = false;
                                  $ionicTabsDelegate.showBar(1);
                                  $scope.items.splice(index, 1);
                                });
                                
                              }else{
                                var alertPopup = $ionicPopup.alert({
                                  title: 'Ocorreu uma falha',
                                  template: $scope.response.msg
                                });
                              }
                              console.log($scope.response.msg);
                          });
                                    }}]
                             });
                        }else{
                            $scope.confirmacao = 'Confirmação aceita';
                            $scope.estado = '2';
                            //console.log($scope.evento.idComercioParceiro, "ANSUIDNAIUSnd", $scope.evento.nomeevento);
                            var link = 'https://ec2.diwoapp.com.br/irevento.php';
                            $http.post(link, {idevento : $scope.evento.idevento,
                                            idadm : $scope.evento.adm, 
                                            admusername : $scope.evento.admusername, 
                                            diainicio : $scope.evento.diainicio,
                                            diafim : $scope.evento.diafim,
                                            iduser : $scope.user.iduser,
                                            borda : $scope.user.borda,
                                            username: $scope.user.username,
                                            profilepic : $scope.user.profilepic,
                                            devicetoken : $scope.user.devicetoken,
                                            apelido : $scope.user.apelido,
                                            confirmacao : $scope.confirmacao,
                                            nomeevento :  $scope.evento.nomeevento, 
                                            eventopic : $scope.evento.eventopic,
                                            idComercioParceiro : $scope.evento.idComercioParceiro, 
                                            estado : $scope.estado}).then(function (res){
                              $scope.response = res.data;
                              if(index == 0){
                                $scope.semfeed = true;
                              }
                              $http.post('https://ec2.diwoapp.com.br/deletapessoaevento.php', {iduser : $scope.user.iduser,
                                                                                          idevento : $scope.evento.idevento,
                                                                                          estado: '5'});
                              if ($scope.response.success == true) {
                                $scope.evento.patual = parseInt($scope.evento.patual)+1;
                                $http.post('https://ec2.diwoapp.com.br/addpessoaevento.php', {idevento : $scope.evento.idevento,
                                                                                patual : $scope.evento.patual});
                                //console.log($scope.evento.patual,$scope.evento.pmin , 'Número de pessoas alcançado do evento dahushudauhuh')
                                if(parseInt($scope.evento.patual) == parseInt($scope.evento.pmin)){
                                  //console.log("Passou pelo IF", $scope.evento.idComercioParceiro)
                                  EventoService.GetUserPorId($scope.evento.idComercioParceiro).then(function(comercio) {
                                    $scope.msgnotiComercio = ('Número mínimo de pessoas alcançado do evento ' + $scope.evento.nomeevento );
                                    noti.recebeusername = comercio.username;
                                    noti.recebe = comercio.idComercioParceiro;
                                    noti.envia = comercio.idComercioParceiro;
                                    noti.tipo = 51;   //evento bateu numero minimo de pessoas para acontecer
                                    noti.nomeevento = $scope.evento.nomeevento;
                                    //console.log(noti.nomeevento , "Idevento");
                                      EventoService.VerificaNotificacao(noti).then(function(res) {
                                      if(res){
                                        $http.post('https://ec2.diwoapp.com.br/notificapessoa.php', {notificacao : $scope.msgnotiComercio, 
                                                      idevento : $scope.evento.idevento,
                                                      nomeevento : $scope.evento.nomeevento,
                                                      id_user_envia : $scope.evento.idComercioParceiro,
                                                      username_envia : $scope.evento.nomeevento,
                                                      apelido_envia : $scope.evento.nomeevento,
                                                      tipo : '51',
                                                      id_user_recebe : $scope.evento.idComercioParceiro});
                                          $scope.pushnoti.titulo =  'Número de pessoas alcançado!' ;
                                          $scope.pushnoti.msg = $scope.msgnotiComercio;
                                          $scope.pushnoti.token = comercio.devicetoken;
                                          EventoService.MandaPushNoti($scope.pushnoti);
                                          $scope.pushnoti.titulo =  'Número de pessoas alcançado!' ;
                                          $scope.pushnoti.msg = $scope.msgnotiComercio;
                                          $scope.pushnoti.token = 'dKpOML7ZLIA:APA91bFhTghUqP4gpCkohaf3h1WzCjDwQTrMg2JbUJjEQ9WegZgXWZQSNWtwoeAIu98bLK6wtSByVo1jluGyPmVmBxrvEWu6sluypuLk6O7F_18Z_e2kko7UQdK16Hu7O4qxsvstCmSI';
                                          console.log($scope.pushnoti.msg, "Mandando push");
                                          EventoService.MandaPushNoti($scope.pushnoti);
                                      }
                                    });
                                  });
                                }




                                var alertPopup = $ionicPopup.alert({
                                  title: 'Parabéns',
                                  template: $scope.response.msg
                                });
                                alertPopup.then(function(){
                                  $http.post('https://ec2.diwoapp.com.br/deletapessoaevento.php', {iduser : $scope.user.iduser,
                                                                                          idevento : $scope.evento.idevento,
                                                                                          estado: '7'}).then(function (res){
                                  $scope.response = res.data;
                                  //console.log(i);
                                  $scope.fav = false;
                                  });
                                  $scope.items[index].mostratudo = false;
                                  $scope.mostramaisinfo = false;
                                  $ionicTabsDelegate.showBar(1);
                                  $scope.items.splice(index, 1);
                                });
                                
                              }else{
                                var alertPopup = $ionicPopup.alert({
                                  title: 'Ocorreu uma falha',
                                  template: $scope.response.msg
                                });
                              }
                              console.log($scope.response.msg);
                          });
                        }
                      }else{
                        if($scope.evento.zone == 'yellow'){
                          var confirmPopup = $ionicPopup.show({
                               title: 'ZONA AMARELA',
                               template: 'Evento esta na ZONA AMARELA, caso voce desista uma vez que confirmado a presença tu sofrerás um cartão amarelo. Deseja ir mesmo assim?',
                               buttons: [
                                  { text: 'Não sei se vou',
                                    type: 'button-assertive',
                                    onTap: function(e){
                                      console.log('nada acontece');
                                    }},
                                  {
                                    text: 'Quero ir',
                                    type: 'button-positive',
                                    onTap: function(e){
                                      $scope.confirmacao = 'aguardando confirmação';
                                      $scope.estado = '1';
                            // console.log($scope.evento.idevento);
                            // console.log($scope.aux.iduser);
                            // console.log($scope.confirmacao);
                            // console.log($scope.nomeevento);
                            // console.log($scope.estado);
                            var link = 'https://ec2.diwoapp.com.br/irevento.php';
                            $http.post(link, {idevento : $scope.evento.idevento,
                                            idadm : $scope.evento.adm, 
                                            admusername : $scope.evento.admusername, 
                                            diainicio : $scope.evento.diainicio,
                                            diafim : $scope.evento.diafim,
                                            iduser : $scope.user.iduser,
                                            borda : $scope.user.borda,
                                            username: $scope.user.username,
                                            profilepic : $scope.user.profilepic,
                                            devicetoken : $scope.user.devicetoken,
                                            apelido : $scope.user.apelido,
                                            confirmacao : $scope.confirmacao,
                                            nomeevento :  $scope.nomeevento,
                                            eventopic : $scope.evento.eventopic,
                                            idComercioParceiro : $scope.evento.idComercioParceiro, 
                                            estado : $scope.estado}).then(function (res){
                              $scope.response = res.data;
                              if(index == 0){
                                $scope.semfeed = true;
                              }
                              $http.post('https://ec2.diwoapp.com.br/deletapessoaevento.php', {iduser : $scope.user.iduser,
                                                                                          idevento : $scope.evento.idevento,
                                                                                          estado: '5'});
                              if ($scope.response.success == true) {
                                $scope.msgnoti = ('To querendo ir no evento: ' + $scope.evento.nomeevento);
                                noti.recebe = $scope.evento.adm;
                                noti.envia = $scope.user.iduser;
                                noti.tipo = 1;
                                noti.nomeevento = $scope.evento.nomeevento;
                                EventoService.VerificaNotificacao(noti).then(function(res) {
                                  console.log(res);
                                  if(res){
                                    if($scope.evento.tipodeevento != "comercio" && $scope.evento.tipodeevento != "campanha"){
                                      $http.post('https://ec2.diwoapp.com.br/notificacriador.php', {notificacao : $scope.msgnoti, 
                                            idevento : $scope.evento.idevento,
                                            nomeevento : $scope.evento.nomeevento,
                                            id_user_envia : $scope.user.iduser,
                                            username_envia : $scope.user.username,
                                            apelido_envia : $scope.user.apelido,
                                            tipo : '1',
                                            id_user_recebe : $scope.evento.adm});
                                   EventoService.getusuario2($scope.evento.admusername).then(function(user) {
                                    if(user.noticriados == '1'){
                                      $scope.pushnoti.titulo = $scope.evento.nomeevento;
                                      $scope.pushnoti.msg = $scope.user.username + " quer participar do evento";
                                      $scope.pushnoti.token = user.devicetoken;
                                       EventoService.MandaPushNoti($scope.pushnoti);
                                     }
                                    });
                                    }
                                   
                                   
                                  }
                                });
                                $http.post("https://ec2.diwoapp.com.br/deletanotificacaoporids.php", {id_user_recebe : noti.recebe,
                                                                                          id_user_envia: noti.envia,
                                                                                          nomeevento: noti.nomeevento,
                                                                                          tipo : '5'});
                                var alertPopup = $ionicPopup.alert({
                                  title: 'Parabéns',
                                  template: $scope.response.msg
                                });
                                alertPopup.then(function(){
                                  $http.post('https://ec2.diwoapp.com.br/deletapessoaevento.php', {iduser : $scope.user.iduser,
                                                                                          idevento : $scope.evento.idevento,
                                                                                          estado: '7'}).then(function (res){
                                  $scope.response = res.data;
                                  //console.log(i);
                                  $scope.fav = false;
                                  });
                                  $scope.items[index].mostratudo = false;
                                  $scope.mostramaisinfo = false;
                                  $ionicTabsDelegate.showBar(1);
                                  $scope.items.splice(index, 1);
                                });
                                
                              }else{
                                var alertPopup = $ionicPopup.alert({
                                  title: 'Ocorreu uma falha',
                                  template: $scope.response.msg
                                });
                              }
                              console.log($scope.response.msg);
                          });
                                    }}]
                             });
                        }else{
                            $scope.confirmacao = 'aguardando confirmação';
                            $scope.estado = '1';
                            // console.log($scope.evento.idevento);
                            // console.log($scope.aux.iduser);
                            // console.log($scope.confirmacao);
                            // console.log($scope.nomeevento);
                            // console.log($scope.estado);
                            var link = 'https://ec2.diwoapp.com.br/irevento.php';
                            $http.post(link, {idevento : $scope.evento.idevento,
                                            idadm : $scope.evento.adm, 
                                            admusername : $scope.evento.admusername, 
                                            diainicio : $scope.evento.diainicio,
                                            diafim : $scope.evento.diafim,
                                            iduser : $scope.user.iduser,
                                            borda : $scope.user.borda,
                                            username: $scope.user.username,
                                            profilepic : $scope.user.profilepic,
                                            devicetoken : $scope.user.devicetoken,
                                            apelido : $scope.user.apelido,
                                            confirmacao : $scope.confirmacao,
                                            nomeevento :  $scope.nomeevento, 
                                            eventopic : $scope.evento.eventopic,
                                            idComercioParceiro : $scope.evento.idComercioParceiro, 
                                            estado : $scope.estado}).then(function (res){
                              $scope.response = res.data;
                              if(index == 0){
                                $scope.semfeed = true;
                              }
                              $http.post('https://ec2.diwoapp.com.br/deletapessoaevento.php', {iduser : $scope.user.iduser,
                                                                                          idevento : $scope.evento.idevento,
                                                                                          estado: '5'});
                              if ($scope.response.success == true) {
                                $scope.msgnoti = ('To querendo ir no evento: ' + $scope.evento.nomeevento);
                                noti.recebe = $scope.evento.adm;
                                noti.envia = $scope.user.iduser;
                                noti.tipo = 1;
                                noti.nomeevento = $scope.evento.nomeevento;
                                EventoService.VerificaNotificacao(noti).then(function(res) {
                                  console.log(res);
                                  if(res){
                                       if($scope.evento.tipodeevento != "comercio" && $scope.evento.tipodeevento != "campanha"){
                                      $http.post('https://ec2.diwoapp.com.br/notificacriador.php', {notificacao : $scope.msgnoti, 
                                            idevento : $scope.evento.idevento,
                                            nomeevento : $scope.evento.nomeevento,
                                            id_user_envia : $scope.user.iduser,
                                            username_envia : $scope.user.username,
                                            apelido_envia : $scope.user.apelido,
                                            tipo : '1',
                                            id_user_recebe : $scope.evento.adm});
                                   EventoService.getusuario2($scope.evento.admusername).then(function(user) {
                                    if(user.noticriados == '1'){
                                      $scope.pushnoti.titulo = $scope.evento.nomeevento;
                                      $scope.pushnoti.msg = $scope.user.username + " quer participar do evento";
                                      $scope.pushnoti.token = user.devicetoken;
                                       EventoService.MandaPushNoti($scope.pushnoti);
                                     }
                                    });
                                    }
                                    
                                  }
                                });
                                $http.post("https://ec2.diwoapp.com.br/deletanotificacaoporids.php", {id_user_recebe : noti.recebe,
                                                                                          id_user_envia: noti.envia,
                                                                                          nomeevento: noti.nomeevento,
                                                                                          tipo : '5'});


                                            /// PEDIR CONTATO DE ALGUEM DE FORA PARA FAZER O SERVIÇO DE CHAMAR
                 



                                var alertPopup = $ionicPopup.alert({
                                  title: 'Parabéns',
                                  template: $scope.response.msg
                                });
                                alertPopup.then(function(){
                                  $http.post('https://ec2.diwoapp.com.br/deletapessoaevento.php', {iduser : $scope.user.iduser,
                                                                                          idevento : $scope.evento.idevento,
                                                                                          estado: '7'}).then(function (res){
                                  $scope.response = res.data;
                                  //console.log(i);
                                  $scope.fav = false;
                                  });
                                  $scope.items[index].mostratudo = false;
                                  $scope.mostramaisinfo = false;
                                  $ionicTabsDelegate.showBar(1);
                                  $scope.items.splice(index, 1);
                                });
                                
                              }else{
                                var alertPopup = $ionicPopup.alert({
                                  title: 'Ocorreu uma falha',
                                  template: $scope.response.msg
                                });
                              }
                              console.log($scope.response.msg);
                          });
                        }
                      }
                    }
            }
          }
            
        
        
        }
      });
    
  };
  $scope.favorita = function(index){

    console.log(index)
    if(!index){
      var index = qualitemindex;
    }
        var po = $scope.user.pontos.valueOf() - 2;
        var mgsg = 'Mas para isso vamos t cobrar 2 pontos, você quer? (Pontos atuais:' + $scope.user.pontos + ')';
        var myPopup = $ionicPopup.show({
                            title: 'Salvar para depois',
                            subTitle: mgsg,
                            scope: $scope,
                            buttons: [
                              { text: 'Não' },
                              {
                                text: '<b>Sim</b>',
                                type: 'button-positive',
                                onTap: function(e) {
          if($scope.user.pontos<2){
            var alertPopup = $ionicPopup.alert({
                title: '(ノ￣ー￣)ノ ● ＼(^ω^＼)',
                template: 'Não tens pontos suficiente, tente ir em mais eventos ou crie ou avalie em eventos que você foi e não avaliou ninguem, uma pessoa basta'
              });
          }else{
                                    $http.post('https://ec2.diwoapp.com.br/gastapontospessoaevento.php', {idevento : -20,
                                                        iduser : $scope.user.iduser,
                                                        borda : $scope.user.borda,
                                                        username: $scope.user.username,
                                                        apelido : $scope.user.apelido,
                                                        nomeevento :  "Salvou, pinzou evento", 
                                                        estado : 10,
                                                        pontos: -2});
                                    var link = 'https://ec2.diwoapp.com.br/irevento.php';
                                    $http.post(link, {idevento : $scope.items[index].idevento, 
                                                              idadm : $scope.items[index].adm, 
                                                              admusername : $scope.items[index].admusername, 
                                                              iduser : $scope.user.iduser,
                                                              diainicio : $scope.items[index].diainicio,
                                                              diafim : $scope.items[index].diafim,
                                                              borda : $scope.user.borda,
                                                              username: $scope.user.username,
                                                              profilepic : $scope.user.profilepic,
                                                              devicetoken : $scope.user.devicetoken,
                                                              apelido : $scope.user.apelido,
                                                              confirmacao : 'interesse',
                                                              nomeevento :  $scope.items[index].nomeevento,
                                                              eventopic : $scope.items[index].eventopic,
                                                              idComercioParceiro : $scope.items[index].idComercioParceiro,  
                                                              estado : '7'}).then(function (res){
                                        $scope.response = res.data;
                                        if ($scope.response.success == true) {
                                          $http.post('https://ec2.diwoapp.com.br/pessoanaoevento.php', {iduser : $scope.user.iduser, 
                                                                  idevento : $scope.items[index].idevento,
                                                                  nomeevento : $scope.items[index].nomeevento,
                                                                  estado : '13'}) // favoritou
                                          var alertPopup = $ionicPopup.alert({
                                                        title: '( ͡° ͜ʖ ͡°)',
                                                        template: 'Foi adicionado a lista de pinzados, quando resolver ir é só confimar por lá.'
                                                      });
                                          alertPopup.then(function(){
                                            $scope.atualiza = {};
                                            $scope.atualiza.pontos = po;
                                            $scope.atualiza.iduser = $scope.user.iduser;
                                            EventoService.atualizarpontos($scope.atualiza);
                                            $scope.items[index].mostratudo = false;
                                            $scope.mostramaisinfo = false;
                                            $ionicTabsDelegate.showBar(1);
                                            $scope.items.splice(index, 1);
                                            if(index == 0){
                                              $scope.semfeed = true;
                                            }
                                          });
                                        }
                                      });
                                    }
                                  }
                                }
                                ]});     
  }

  $scope.Compra = function(index) {
    if(!index){
      if(!qualitemindex){
        index = 0;
      }else{
        index = qualitemindex;
      }
    }
    confirmaida = true;
    $scope.evento= $scope.items[index];
    console.log(index , "INDEX CONSTROI" , $scope.evento.idevento)
    formItem.updateForm($scope.evento)
    $state.go('tabsController.PagSeguroMetodo')
 
  };



  formvimdopost.updateForm(false);
  //console.log($scope.user.idsuer, "Iduser")
  var currentdate = new Date(); 
  var curr_date = (currentdate.getDate()<10?'0':'') + currentdate.getDate();
  var curr_h = (currentdate.getHours()<10?'0':'') + currentdate.getHours();

  $scope.devicetoken = window.localStorage.getItem( 'token' );
  $scope.mudatoken ={};
  if($scope.devicetoken != $scope.user.devicetoken){
    $scope.mudatoken.iduser = $scope.user.iduser;
    $scope.mudatoken.devicetoken = $scope.devicetoken;
    EventoService.Mudadevice($scope.mudatoken);
  }
  formtela.updateForm(0);
  $scope.auxtelacriar = formtelaCriar.getForm();

  var ft = 0;
  var ft2 = 0;
  var auxtes =0;
  var  deletou = 0;
  var followers = 0;
  $scope.amigo = {};
  $scope.lastidevento = 0;

  var pmin;
  var iddoevento;
  var lat;
  var long;
  var myLatlng;
  var spherical; 
  var north; 
  var west; 
  var south; 
  var east;
  var raio;
  // $ionicLoading.show({
  //   template: 'Carregando'
  // });
  $scope.items = [];
  $scope.vezes = 0;
  $scope.faltatempo = [];
  $scope.newItems = [];
  $scope.noMoreItemsAvailable = false;
  $scope.semfeed = false;
  $scope.semloc = false;
  $scope.npost =0;
  $scope.lastidevento = 0;
  $scope.aux = 0;
  $scope.eventocomconhecido =[];
  $scope.eventocomconhecidoidevento =[];
  $scope.participantes =[];
  $scope.participantesid = [];
  $scope.tagsevento =[];
  $scope.auxitems ={};
  $scope.listapessoas = {};
  $scope.tags = {};


 
  $http.post("https://ec2.diwoapp.com.br/getamigos.php", {iduser : $scope.user.iduser}).then(function(response) {
    $scope.amigo = response.data;
    followers =  response.data.length;
  });

    if(curr_date == 1 && curr_h == 11){
      if( $scope.user.atualizaestrela == 0 && $scope.user.atualizaestrela ){
        EventoService.AtualizaEstrela().then(function(response) {
          if(response){
            EventoService.AtualizaEstrelaPessoaevento();
          }
        });
      }
    }
    if(curr_date == 1 && curr_h==12  ){
       if($scope.user.atualizaestrela ==  1 ){
        EventoService.DesatulizaEstrela();
      }
    }
    $scope.centerPoint = {};
    $scope.centerPointFB = {};
        if (navigator.geolocation) {
          navigator.geolocation.getCurrentPosition(successFunction, errorFunction);
        } 
        function successFunction(position) {
          raio = $scope.raiodistoriginal*0.71;
          lat  = position.coords.latitude;
          long = position.coords.longitude;
          $scope.user.lat =  position.coords.latitude;
          $scope.user.long =  position.coords.longitude;
          myLatlng = new google.maps.LatLng(lat, long);
          spherical = google.maps.geometry.spherical; 
          north = spherical.computeOffset(myLatlng, raio, 0); 
          west  = spherical.computeOffset(myLatlng, raio, -90); 
          south = spherical.computeOffset(myLatlng, raio, 180); 
          east  = spherical.computeOffset(myLatlng, raio, 90);
          $scope.user.northlat = north.lat();
          $scope.user.westlng = west.lng();
          $scope.user.southlat = south.lat();
          $scope.user.eastlng = east.lng();
          $scope.centerPoint.lat = -26.997799;
          $scope.centerPoint.lng = -48.632733;
          formUser.updateForm($scope.user); 
          //console.log($scope.user.long, $scope.user.lat)
          // $scope.centerPoint.lat = -25.473466587692343;
          // $scope.centerPoint.lng = -49.29164589792566;
          $scope.centerPointKM = 30;
          $scope.LimiteFuncionamentoDiwo = arePointsNear($scope.user, $scope.centerPoint,$scope.centerPointKM );
          
          $scope.centerPointKMFB = 2500;
          $scope.centerPointFB.lat = 39.1882887948499;
          $scope.centerPointFB.lng = -100.07746794288232;
          // $scope.LimiteFuncionamentoDiwoFB = arePointsNear($scope.user, $scope.centerPointFB,$scope.centerPointKMFB );
          
          // if(!$scope.LimiteFuncionamentoDiwoFB){
          //   raio = 2500000*0.71;
          //   lat  = position.coords.latitude;
          //   long = position.coords.longitude;
          //   $scope.user.lat =  position.coords.latitude;
          //   $scope.user.long =  position.coords.longitude;
          //   myLatlng = new google.maps.LatLng(lat, long);
          //   spherical = google.maps.geometry.spherical; 
          //   north = spherical.computeOffset(myLatlng, raio, 0); 
          //   west  = spherical.computeOffset(myLatlng, raio, -90); 
          //   south = spherical.computeOffset(myLatlng, raio, 180); 
          //   east  = spherical.computeOffset(myLatlng, raio, 90);
          //   $scope.user.northlat = north.lat();
          //   $scope.user.westlng = west.lng();
          //   $scope.user.southlat = south.lat();
          //   $scope.user.eastlng = east.lng();
          //   $scope.LimiteFuncionamentoDiwo = false;
          // }

          formLimiteatuacao.updateForm($scope.LimiteFuncionamentoDiwo);
          console.log($scope.LimiteFuncionamentoDiwo, $scope.user.northlat , "LOC")
          if(!$scope.LimiteFuncionamentoDiwo){
           
              $scope.items = [];
              $scope.vazio = false;
              console.log("GetFeed2")
              EventoService.GetFeed2($scope.user).then(function(items) {
              //$ionicLoading.hide();
              if (items != 'E'){
                $scope.semfeed = false;
                ft2 = 0;
                ft3 = 0;
                for(var i = 0 ; i<items.length ; i++){
                  if(items[i].zone ==  'red' && parseInt(items[i].pmin)> parseInt(items[i].patual) && items[i].estado == '0'){
                     EventoService.Cancelarevento(items[i]);
                    console.log('Falta gente para o evento, mas como estamos na redzone vou cancelar', items[i].idevento ,items[i].pmin , items[i].patual);
                  }
                  if(items[i].tipodeevento){
                    if(items[i].tipodeevento == 'campanha'){
                      items[i].tipodeeventocampanha = true;
                    }else{
                      items[i].tipodeeventocampanha = false;
                    }
                    console.log("patrocinadoffff")
                    items[i].patrocinado = true;
                    // if(items[i].descontopacote){
                    //   var res2 = items[i].descontopacote.split("/wq") ;
                    //   if(res2.length>1){
                    //     for(var w = 0; w < res2.length; w++){
                    //       console.log(res2[w])
                    //     }
                    //   }
                    // }
                    
                    items[i].stylerowhome = "border-width: 0px;background-image: linear-gradient(to bottom, #74001a,#222);";
                    
                    items[i].stylebarrahome = "border-color: #ff4444;border-width: 2px solid;background-image: linear-gradient(to bottom,  #222,#74001a);";
                    
                    //items[i].styleItem = "background-color: #212121;color: white;box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.3);border: 4px dotted #ffdb29;";
                    //items[i].styleItem = "background-color: #212121;color: white;box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.3);border: 4px dotted #ff9008;";
                    items[i].styleItemhome = " position: fixed;-webkit-transform: scale(1,1);display: block;width: 96%;height: auto;box-sizing: border-box;background-color: #21212121;box-shadow: 0 4px 8px 0 rgba(255,127,114, 0.3);border-radius: 4px; overflow: hidden;-webkit-animation-fill-mode: forwards;";
                    //items[i].styleItem = "background-color: #212121;color: white;box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.3);border: 4px dotted #f9bdff;";
                    //items[i].styleItem = "background-color: #212121;color: white;box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.3);border: 4px dotted #00FFFF;";
                  }else{
                    items[i].patrocinado = false;
                    items[i].tipodeeventocampanha = false;
                    items[i].stylerowhome = "border-width: 0px;background:#212121;";
                    
                    items[i].stylebarrahome = " border-color: #ff4444;border-width: 2px solid;background-color: #222";
                    
                    items[i].styleItemhome = " position: fixed;-webkit-transform: scale(1,1);display: block;width: 96%;height: auto;box-sizing: border-box;background-color: #21212121;box-shadow: 0 4px 8px 0 rgba(71, 71, 71, 0.3);border-radius: 4px; overflow: hidden;-webkit-animation-fill-mode: forwards;";
                  }

                    var hjd = items[i].duracao;
                    var hd = (hjd[0]+hjd[1]).valueOf();
                    var md = (hjd[3]+hjd[4]).valueOf();
                    items[i].duracao = hd+':'+md;

                    var  hjl = items[i].dialimiteconfirmacao;
                    items[i].limitedia =  (hjl[8]+hjl[9]).valueOf()+'/'+(hjl[5]+hjl[6]).valueOf();
                    items[i].limitehora =  (hjl[11]+hjl[12]).valueOf()+':'+(hjl[14]+hjl[15]).valueOf();  
                    
                    var hj = items[i].diainicio;
                    var ano = (hj[0]+hj[1]+hj[2]+hj[3]).valueOf();
                    var mes = (hj[5]+hj[6]).valueOf();
                    var dia = (hj[8]+hj[9]).valueOf();
                    var h = (hj[11]+hj[12]).valueOf();
                    var m = (hj[14]+hj[15]).valueOf();
                    var hjf = items[i].diafim;
                    items[i].fimdia =  (hjf[8]+hjf[9]).valueOf()+'/'+(hjf[5]+hjf[6]).valueOf()+'/'+(hjf[0]+hjf[1]+hjf[2]+hjf[3]);
                    items[i].fimhora = (hjf[11]+hjf[12]).valueOf()+':'+(hjf[14]+hjf[15]).valueOf();
                    items[i].diadia = dia+'/'+mes;
                    
                    if(items[i].limitedia == items[i].diadia ){
                      items[i].limsemana = items[i].semana ;
                    }else{
                      if(items[i].semana == "Segunda-feira"){
                        items[i].limsemana = "Domingo";
                      }
                      if(items[i].semana == "Terça-feira"){
                        items[i].limsemana = "Segunda-feira";
                      }
                      if(items[i].semana == "Quarta-feira"){
                        items[i].limsemana = "Terça-feira";
                      }
                      if(items[i].semana == "Quinta-feira"){
                        items[i].limsemana = "Quarta-feira";
                      }
                      if(items[i].semana == "Sexta-feira"){
                        items[i].limsemana = "Quinta-feira";
                      }
                      if(items[i].semana == "Sábado"){
                        items[i].limsemana = "Sexta-feira";
                      }
                      if(items[i].semana == "Domingo"){
                        items[i].limsemana = "Sábado";
                      }
                    }

                    if(items[i].estado == 21){
                      items[i].chatlike = false;
                      console.log("estado 21", items[i].eventopic)
                      if(items[i].eventopic == "img/manha.png"){
                        console.log("enrta aqui")
                        items[i].diahora = 'Manhã'
                      }
                      if(items[i].eventopic == "img/tarde.png"){
                        console.log("enrta aqui")
                        items[i].diahora = 'Tarde'
                      }
                      if(items[i].eventopic == "img/noite.png"){
                        console.log("enrta aqui")
                        items[i].diahora = 'Noite'
                      }
                      
                    }else{
                      items[i].chatlike = true;
                      items[i].diahora = h+':'+m +' - '+(hjf[11]+hjf[12]).valueOf()+':'+(hjf[14]+hjf[15]).valueOf() ;
                    }
                    items[i].mostratudo = false;    
                      if(parseInt(items[i].pmin)>parseInt(items[i].patual)){
                        $scope.menorqpmin = true;
                        $scope.nopmin = false;
                        $scope.entre = false;
                        $scope.cheio = false;
                      }
                      if(parseInt(items[i].pmin)==parseInt(items[i].patual)){
                        $scope.menorqpmin = false;
                        $scope.nopmin = true;
                        $scope.entre = false;
                        $scope.cheio = false;
                      }

                      if(parseInt(items[i].pmin)<parseInt(items[i].patual) && parseInt(items[i].pmax)>parseInt(items[i].patual)){
                        $scope.menorqpmin = false;
                        $scope.nopmin = false;
                        $scope.entre = true;
                        $scope.cheio = false;
                        console.log("nao cheio")
                      }
                      if(parseInt(items[i].pmin)<parseInt(items[i].patual) && parseInt(items[i].pmax)<=parseInt(items[i].patual)){
                        $scope.menorqpmin = false;
                        $scope.nopmin = false;
                        $scope.entre = false;
                        $scope.cheio = true;
                       // console.log(" cheio", items[i].pmin.valueOf() , items[i]patual.valueOf(), items[i].pmax.valueOf())
                      }
                      
                    items[i].pinza = true;
                    EventoService.GetParticipantesFav(items[i].idevento).then(function(tes) {
                      for (var j = 0; j < tes.length; j++) {
                        if ($scope.user.iduser == tes[j].iduser && tes[j].estado == 7) {
                          items[ft3].pinza = false;
                          console.log(items[ft3].pinza, ft3)
                        }
                      }
                      ft3 ++;
                    });

                  EventoService.GetParticipantes(items[i].idevento).then(function(tes) {
                    for (var j = 0; j < tes.length; j++) {
                      //console.log($scope.user.iduser,"user", tes[j].iduser, tes[j].estado)
                      
                       if(tes[j].estado == '2'){
                        //$scope.participantes[ft2];
                        if($scope.participantesid[ft2] !=undefined){
                          $scope.participantesid[ft2] = tes[j].idevento;
                          $scope.participantes[ft2]++ ;
                        }else{
                          $scope.participantesid[ft2] = tes[j].idevento;
                          $scope.participantes[ft2] = 1;
                        }
                      }
                      for (var l = 0; l< followers;l++){
                        if (tes[j].iduser == $scope.amigo[l].iduserseguindo) {
                          if($scope.eventocomconhecidoidevento[ft2] !=undefined){
                            $scope.eventocomconhecidoidevento[ft2] = tes[j].idevento;
                            $scope.eventocomconhecido[ft2] = tes[j].apelido + ', '+ $scope.eventocomconhecido[ft2] ;
                          }else{
                            $scope.eventocomconhecidoidevento[ft2] = tes[j].idevento;
                            $scope.eventocomconhecido[ft2] = tes[j].apelido;
                          }
                         //console.log($scope.eventocomconhecidoidevento[ft2], $scope.eventocomconhecido[ft2] , ft2)
                        }
                      }
                    }
                    ft2++;
                    console.log(ft2)
                    if(ft2==items.length){
                      for(var t = 0; t<ft2;t++){
                        for(var r = 0; r<ft2;r++){
                          if (items[t].idevento == $scope.eventocomconhecidoidevento[r]) {
                             items[t].amigo =  'Q vai e sigo: '+$scope.eventocomconhecido[r];
                             // console.log(items[t].idevento, t ,items[t].amigo );
                          }
                          if (items[t].idevento == $scope.participantesid[r]) {
                           items[t].participantes =  $scope.participantes[r];
                          }
                        }
                      } 
                      if(t == items.length){
                        $scope.items = items.concat($scope.items);
                       //console.log($scope.lastidvestido);
                      }
                    }
                  });
                }
              }else{
                console.log("sem feed");
                $scope.semfeed = true;
              }
            });
            } 
          //}
          

        }

        function errorFunction(){
            //alert("Geocoder failed");
            $scope.semloc = true;
        }

        function arePointsNear(checkPoint, centerPoint, km) {
          var ky = 40000 / 360;
          var kx = Math.cos(Math.PI * centerPoint.lat / 180.0) * ky;
          var dx = Math.abs(centerPoint.lng - $scope.user.long) * kx;
          var dy = Math.abs(centerPoint.lat - $scope.user.lat) * ky;
          var resp = Math.sqrt(dx * dx + dy * dy) <= km;
          return !resp
        }

    //EventoService.FinalizarEventos();
    var currentdate = new Date(); 
    var curr_date = (currentdate.getDate()<10?'0':'') + currentdate.getDate();
    var curr_month = (currentdate.getMonth()<10?'0':'') + (currentdate.getMonth() + 1); 
    var curr_year = currentdate.getFullYear();
    var h2 = (currentdate.getHours()<10?'0':'') + currentdate.getHours();
    var m2 = (currentdate.getMinutes()<10?'0':'') + currentdate.getMinutes();
    var j = curr_year + "-" + curr_month + "-" + curr_date+ ' '+h2 + ':' + m2 + ':00';
    j = j.toLocaleString();
   

    EventoService.paraenviarnoti(j).then(function(items) {
      //console.log(items[0].idevento)
      if (items[0] != "E"){
        for(var i = 0 ; i<items.length ; i++){
          EventoService.paraenviarnoti2(items[i]);
        }
      }
    });
    EventoService.pushbadge(j).then(function(items) {
      //console.log(items, items[0].n, items.length,"items.length")
      if (items[0] != "E"){
        console.log("pushbadge")
        for(var i = 0 ; i<items.length ; i++){
          //console.log(items[i].n, items[i].iduser, i)
          if(items[i].tag == '#ArteeCultura'){
            $scope.auxpushbadge = {};
            $scope.auxpushbadge.titulo = "Parabéns!!";
            $scope.auxpushbadge.msg = "Você ganhou um novo badge";
            $scope.auxpushbadge.token = items[i].devicetoken;
            $scope.auxpushbadge.iduser = items[i].iduser;
            $scope.auxpushbadge.tipo = "badge";
            if(items[i].n == 1){
              $scope.auxpushbadge.img = "img/badges/Categorias/ArteeCultura/1.png";
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 2){
              $scope.auxpushbadge.img = "img/badges/Categorias/ArteeCultura/1.1.png";
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 3){
              $scope.auxpushbadge.img = "img/badges/Categorias/ArteeCultura/1.2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 4){
              $scope.auxpushbadge.img = "img/badges/Categorias/ArteeCultura/1.3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }

            if(items[i].n == 6){
              $scope.auxpushbadge.img = "img/badges/Categorias/ArteeCultura/2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 8){
              $scope.auxpushbadge.img = "img/badges/Categorias/ArteeCultura/2.1.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 10){
              $scope.auxpushbadge.img = "img/badges/Categorias/ArteeCultura/2.2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 12){
              $scope.auxpushbadge.img = "img/badges/Categorias/ArteeCultura/2.3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }

            if(items[i].n == 15){
              $scope.auxpushbadge.img = "img/badges/Categorias/ArteeCultura/3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 20){
              $scope.auxpushbadge.img = "img/badges/Categorias/ArteeCultura/3.1.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 25 ){
              $scope.auxpushbadge.img = "img/badges/Categorias/ArteeCultura/3.2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 30 ){
              $scope.auxpushbadge.img = "img/badges/Categorias/ArteeCultura/3.3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 50){
              $scope.auxpushbadge.img = "img/badges/Categorias/ArteeCultura/Super.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
          }
          if(items[i].tag == '#Voluntariado'){
            $scope.auxpushbadge = {};
            $scope.auxpushbadge.titulo = "Parabéns!!";
            $scope.auxpushbadge.msg = "Você ganhou um novo badge";
            $scope.auxpushbadge.token = items[i].devicetoken;
            $scope.auxpushbadge.iduser = items[i].iduser;
            $scope.auxpushbadge.tipo = "badge";
            if(items[i].n == 1){
              $scope.auxpushbadge.img = "img/badges/Categorias/Voluntariado/1.png";
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 2){
              $scope.auxpushbadge.img = "img/badges/Categorias/Voluntariado/1.1.png";
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 3){
              $scope.auxpushbadge.img = "img/badges/Categorias/Voluntariado/1.2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 4){
              $scope.auxpushbadge.img = "img/badges/Categorias/Voluntariado/1.3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }

            if(items[i].n == 6){
              $scope.auxpushbadge.img = "img/badges/Categorias/Voluntariado/2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 8){
              $scope.auxpushbadge.img = "img/badges/Categorias/Voluntariado/2.1.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 10){
              $scope.auxpushbadge.img = "img/badges/Categorias/Voluntariado/2.2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 12){
              $scope.auxpushbadge.img = "img/badges/Categorias/Voluntariado/2.3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }

            if(items[i].n == 15){
              $scope.auxpushbadge.img = "img/badges/Categorias/Voluntariado/3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 20){
              $scope.auxpushbadge.img = "img/badges/Categorias/Voluntariado/3.1.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 25 ){
              $scope.auxpushbadge.img = "img/badges/Categorias/Voluntariado/3.2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 30 ){
              $scope.auxpushbadge.img = "img/badges/Categorias/Voluntariado/3.3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 50){
              $scope.auxpushbadge.img = "img/badges/Categorias/Voluntariado/Super.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
          }
          if(items[i].tag == '#Ciclismo'){
            $scope.auxpushbadge = {};
            $scope.auxpushbadge.titulo = "Parabéns!!";
            $scope.auxpushbadge.msg = "Você ganhou um novo badge";
            $scope.auxpushbadge.token = items[i].devicetoken;
            $scope.auxpushbadge.iduser = items[i].iduser;
            $scope.auxpushbadge.tipo = "badge";
            if(items[i].n == 1){
              $scope.auxpushbadge.img = "img/badges/Categorias/Ciclismo/1.png";
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 2){
              $scope.auxpushbadge.img = "img/badges/Categorias/Ciclismo/1.1.png";
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 3){
              $scope.auxpushbadge.img = "img/badges/Categorias/Ciclismo/1.2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 4){
              $scope.auxpushbadge.img = "img/badges/Categorias/Ciclismo/1.3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }

            if(items[i].n == 6){
              $scope.auxpushbadge.img = "img/badges/Categorias/Ciclismo/2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 8){
              $scope.auxpushbadge.img = "img/badges/Categorias/Ciclismo/2.1.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 10){
              $scope.auxpushbadge.img = "img/badges/Categorias/Ciclismo/2.2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 12){
              $scope.auxpushbadge.img = "img/badges/Categorias/Ciclismo/2.3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }

            if(items[i].n == 15){
              $scope.auxpushbadge.img = "img/badges/Categorias/Ciclismo/3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 20){
              $scope.auxpushbadge.img = "img/badges/Categorias/Ciclismo/3.1.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 25 ){
              $scope.auxpushbadge.img = "img/badges/Categorias/Ciclismo/3.2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 30 ){
              $scope.auxpushbadge.img = "img/badges/Categorias/Ciclismo/3.3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 50){
              $scope.auxpushbadge.img = "img/badges/Categorias/Ciclismo/Super.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
          }
          if(items[i].tag == '#Surf'){
            $scope.auxpushbadge = {};
            $scope.auxpushbadge.titulo = "Parabéns!!";
            $scope.auxpushbadge.msg = "Você ganhou um novo badge";
            $scope.auxpushbadge.token = items[i].devicetoken;
            $scope.auxpushbadge.iduser = items[i].iduser;
            $scope.auxpushbadge.tipo = "badge";
            if(items[i].n == 1){
              $scope.auxpushbadge.img = "img/badges/Categorias/Surf/1.png";
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 2){
              $scope.auxpushbadge.img = "img/badges/Categorias/Surf/1.1.png";
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 3){
              $scope.auxpushbadge.img = "img/badges/Categorias/Surf/1.2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 4){
              $scope.auxpushbadge.img = "img/badges/Categorias/Surf/1.3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }

            if(items[i].n == 6){
              $scope.auxpushbadge.img = "img/badges/Categorias/Surf/2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 8){
              $scope.auxpushbadge.img = "img/badges/Categorias/Surf/2.1.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 10){
              $scope.auxpushbadge.img = "img/badges/Categorias/Surf/2.2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 12){
              $scope.auxpushbadge.img = "img/badges/Categorias/Surf/2.3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }

            if(items[i].n == 15){
              $scope.auxpushbadge.img = "img/badges/Categorias/Surf/3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 20){
              $scope.auxpushbadge.img = "img/badges/Categorias/Surf/3.1.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 25 ){
              $scope.auxpushbadge.img = "img/badges/Categorias/Surf/3.2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 30 ){
              $scope.auxpushbadge.img = "img/badges/Categorias/Surf/3.3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 50){
              $scope.auxpushbadge.img = "img/badges/Categorias/Surf/Super.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
          }
          if(items[i].tag == '#Restaurantesebares'){
            $scope.auxpushbadge = {};
            $scope.auxpushbadge.titulo = "Parabéns!!";
            $scope.auxpushbadge.msg = "Você ganhou um novo badge";
            $scope.auxpushbadge.token = items[i].devicetoken;
            $scope.auxpushbadge.iduser = items[i].iduser;
            $scope.auxpushbadge.tipo = "badge";
            if(items[i].n == 1){
              $scope.auxpushbadge.img = "img/badges/Categorias/Restaurantesebares/1.png";
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 2){
              $scope.auxpushbadge.img = "img/badges/Categorias/Restaurantesebares/1.1.png";
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 3){
              $scope.auxpushbadge.img = "img/badges/Categorias/Restaurantesebares/1.2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 4){
              $scope.auxpushbadge.img = "img/badges/Categorias/Restaurantesebares/1.3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }

            if(items[i].n == 6){
              $scope.auxpushbadge.img = "img/badges/Categorias/Restaurantesebares/2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 8){
              $scope.auxpushbadge.img = "img/badges/Categorias/Restaurantesebares/2.1.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 10){
              $scope.auxpushbadge.img = "img/badges/Categorias/Restaurantesebares/2.2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 12){
              $scope.auxpushbadge.img = "img/badges/Categorias/Restaurantesebares/2.3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }

            if(items[i].n == 15){
              $scope.auxpushbadge.img = "img/badges/Categorias/Restaurantesebares/3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 20){
              $scope.auxpushbadge.img = "img/badges/Categorias/Restaurantesebares/3.1.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 25 ){
              $scope.auxpushbadge.img = "img/badges/Categorias/Restaurantesebares/3.2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 30 ){
              $scope.auxpushbadge.img = "img/badges/Categorias/Restaurantesebares/3.3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 50){
              $scope.auxpushbadge.img = "img/badges/Categorias/Restaurantesebares/Super.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
          }
          if(items[i].tag == '#Pets'){
            $scope.auxpushbadge = {};
            $scope.auxpushbadge.titulo = "Parabéns!!";
            $scope.auxpushbadge.msg = "Você ganhou um novo badge";
            $scope.auxpushbadge.token = items[i].devicetoken;
            $scope.auxpushbadge.iduser = items[i].iduser;
            $scope.auxpushbadge.tipo = "badge";
            if(items[i].n == 1){
              $scope.auxpushbadge.img = "img/badges/Categorias/Pets/1.png";
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 2){
              $scope.auxpushbadge.img = "img/badges/Categorias/Pets/1.1.png";
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 3){
              $scope.auxpushbadge.img = "img/badges/Categorias/Pets/1.2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 4){
              $scope.auxpushbadge.img = "img/badges/Categorias/Pets/1.3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }

            if(items[i].n == 6){
              $scope.auxpushbadge.img = "img/badges/Categorias/Pets/2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 8){
              $scope.auxpushbadge.img = "img/badges/Categorias/Pets/2.1.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 10){
              $scope.auxpushbadge.img = "img/badges/Categorias/Pets/2.2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 12){
              $scope.auxpushbadge.img = "img/badges/Categorias/Pets/2.3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }

            if(items[i].n == 15){
              $scope.auxpushbadge.img = "img/badges/Categorias/Pets/3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 20){
              $scope.auxpushbadge.img = "img/badges/Categorias/Pets/3.1.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 25 ){
              $scope.auxpushbadge.img = "img/badges/Categorias/Pets/3.2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 30 ){
              $scope.auxpushbadge.img = "img/badges/Categorias/Pets/3.3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 50){
              $scope.auxpushbadge.img = "img/badges/Categorias/Pets/Super.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
          }
          if(items[i].tag == '#Passeio'){
            $scope.auxpushbadge = {};
            $scope.auxpushbadge.titulo = "Parabéns!!";
            $scope.auxpushbadge.msg = "Você ganhou um novo badge";
            $scope.auxpushbadge.token = items[i].devicetoken;
            $scope.auxpushbadge.iduser = items[i].iduser;
            $scope.auxpushbadge.tipo = "badge";
            if(items[i].n == 1){
              $scope.auxpushbadge.img = "img/badges/Categorias/Passeio/1.png";
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 2){
              $scope.auxpushbadge.img = "img/badges/Categorias/Passeio/1.1.png";
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 3){
              $scope.auxpushbadge.img = "img/badges/Categorias/Passeio/1.2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 4){
              $scope.auxpushbadge.img = "img/badges/Categorias/Passeio/1.3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }

            if(items[i].n == 6){
              $scope.auxpushbadge.img = "img/badges/Categorias/Passeio/2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 8){
              $scope.auxpushbadge.img = "img/badges/Categorias/Passeio/2.1.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 10){
              $scope.auxpushbadge.img = "img/badges/Categorias/Passeio/2.2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 12){
              $scope.auxpushbadge.img = "img/badges/Categorias/Passeio/2.3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }

            if(items[i].n == 15){
              $scope.auxpushbadge.img = "img/badges/Categorias/Passeio/3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 20){
              $scope.auxpushbadge.img = "img/badges/Categorias/Passeio/3.1.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 25 ){
              $scope.auxpushbadge.img = "img/badges/Categorias/Passeio/3.2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 30 ){
              $scope.auxpushbadge.img = "img/badges/Categorias/Passeio/3.3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 50){
              $scope.auxpushbadge.img = "img/badges/Categorias/Passeio/Super.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
          }
          if(items[i].tag == '#Natureza'){
            $scope.auxpushbadge = {};
            $scope.auxpushbadge.titulo = "Parabéns!!";
            $scope.auxpushbadge.msg = "Você ganhou um novo badge";
            $scope.auxpushbadge.token = items[i].devicetoken;
            $scope.auxpushbadge.iduser = items[i].iduser;
            $scope.auxpushbadge.tipo = "badge";
            if(items[i].n == 1){
              $scope.auxpushbadge.img = "img/badges/Categorias/Natureza/1.png";
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 2){
              $scope.auxpushbadge.img = "img/badges/Categorias/Natureza/1.1.png";
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 3){
              $scope.auxpushbadge.img = "img/badges/Categorias/Natureza/1.2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 4){
              $scope.auxpushbadge.img = "img/badges/Categorias/Natureza/1.3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }

            if(items[i].n == 6){
              $scope.auxpushbadge.img = "img/badges/Categorias/Natureza/2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 8){
              $scope.auxpushbadge.img = "img/badges/Categorias/Natureza/2.1.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 10){
              $scope.auxpushbadge.img = "img/badges/Categorias/Natureza/2.2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 12){
              $scope.auxpushbadge.img = "img/badges/Categorias/Natureza/2.3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }

            if(items[i].n == 15){
              $scope.auxpushbadge.img = "img/badges/Categorias/Natureza/3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 20){
              $scope.auxpushbadge.img = "img/badges/Categorias/Natureza/3.1.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 25 ){
              $scope.auxpushbadge.img = "img/badges/Categorias/Natureza/3.2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 30 ){
              $scope.auxpushbadge.img = "img/badges/Categorias/Natureza/3.3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 50){
              $scope.auxpushbadge.img = "img/badges/Categorias/Natureza/Super.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
          }
          if(items[i].tag == '#Musica'){
            $scope.auxpushbadge = {};
            $scope.auxpushbadge.titulo = "Parabéns!!";
            $scope.auxpushbadge.msg = "Você ganhou um novo badge";
            $scope.auxpushbadge.token = items[i].devicetoken;
            $scope.auxpushbadge.iduser = items[i].iduser;
            $scope.auxpushbadge.tipo = "badge";
            if(items[i].n == 1){
              $scope.auxpushbadge.img = "img/badges/Categorias/Musica/1.png";
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 2){
              $scope.auxpushbadge.img = "img/badges/Categorias/Musica/1.1.png";
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 3){
              $scope.auxpushbadge.img = "img/badges/Categorias/Musica/1.2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 4){
              $scope.auxpushbadge.img = "img/badges/Categorias/Musica/1.3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }

            if(items[i].n == 6){
              $scope.auxpushbadge.img = "img/badges/Categorias/Musica/2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 8){
              $scope.auxpushbadge.img = "img/badges/Categorias/Musica/2.1.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 10){
              $scope.auxpushbadge.img = "img/badges/Categorias/Musica/2.2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 12){
              $scope.auxpushbadge.img = "img/badges/Categorias/Musica/2.3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }

            if(items[i].n == 15){
              $scope.auxpushbadge.img = "img/badges/Categorias/Musica/3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 20){
              $scope.auxpushbadge.img = "img/badges/Categorias/Musica/3.1.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 25 ){
              $scope.auxpushbadge.img = "img/badges/Categorias/Musica/3.2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 30 ){
              $scope.auxpushbadge.img = "img/badges/Categorias/Musica/3.3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 50){
              $scope.auxpushbadge.img = "img/badges/Categorias/Musica/Super.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
          }
          if(items[i].tag == '#Jogos'){
            $scope.auxpushbadge = {};
            $scope.auxpushbadge.titulo = "Parabéns!!";
            $scope.auxpushbadge.msg = "Você ganhou um novo badge";
            $scope.auxpushbadge.token = items[i].devicetoken;
            $scope.auxpushbadge.iduser = items[i].iduser;
            $scope.auxpushbadge.tipo = "badge";
            if(items[i].n == 1){
              $scope.auxpushbadge.img = "img/badges/Categorias/Jogos/1.png";
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 2){
              $scope.auxpushbadge.img = "img/badges/Categorias/Jogos/1.1.png";
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 3){
              $scope.auxpushbadge.img = "img/badges/Categorias/Jogos/1.2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 4){
              $scope.auxpushbadge.img = "img/badges/Categorias/Jogos/1.3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }

            if(items[i].n == 6){
              $scope.auxpushbadge.img = "img/badges/Categorias/Jogos/2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 8){
              $scope.auxpushbadge.img = "img/badges/Categorias/Jogos/2.1.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 10){
              $scope.auxpushbadge.img = "img/badges/Categorias/Jogos/2.2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 12){
              $scope.auxpushbadge.img = "img/badges/Categorias/Jogos/2.3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }

            if(items[i].n == 15){
              $scope.auxpushbadge.img = "img/badges/Categorias/Jogos/3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 20){
              $scope.auxpushbadge.img = "img/badges/Categorias/Jogos/3.1.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 25 ){
              $scope.auxpushbadge.img = "img/badges/Categorias/Jogos/3.2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 30 ){
              $scope.auxpushbadge.img = "img/badges/Categorias/Jogos/3.3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 50){
              $scope.auxpushbadge.img = "img/badges/Categorias/Jogos/Super.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
          }
          if(items[i].tag == '#GrupodeEstudos'){
            $scope.auxpushbadge = {};
            $scope.auxpushbadge.titulo = "Parabéns!!";
            $scope.auxpushbadge.msg = "Você ganhou um novo badge";
            $scope.auxpushbadge.token = items[i].devicetoken;
            $scope.auxpushbadge.iduser = items[i].iduser;
            $scope.auxpushbadge.tipo = "badge";
            if(items[i].n == 1){
              $scope.auxpushbadge.img = "img/badges/Categorias/GrupodeEstudos/1.png";
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 2){
              $scope.auxpushbadge.img = "img/badges/Categorias/GrupodeEstudos/1.1.png";
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 3){
              $scope.auxpushbadge.img = "img/badges/Categorias/GrupodeEstudos/1.2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 4){
              $scope.auxpushbadge.img = "img/badges/Categorias/GrupodeEstudos/1.3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }

            if(items[i].n == 6){
              $scope.auxpushbadge.img = "img/badges/Categorias/GrupodeEstudos/2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 8){
              $scope.auxpushbadge.img = "img/badges/Categorias/GrupodeEstudos/2.1.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 10){
              $scope.auxpushbadge.img = "img/badges/Categorias/GrupodeEstudos/2.2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 12){
              $scope.auxpushbadge.img = "img/badges/Categorias/GrupodeEstudos/2.3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }

            if(items[i].n == 15){
              $scope.auxpushbadge.img = "img/badges/Categorias/GrupodeEstudos/3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 20){
              $scope.auxpushbadge.img = "img/badges/Categorias/GrupodeEstudos/3.1.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 25 ){
              $scope.auxpushbadge.img = "img/badges/Categorias/GrupodeEstudos/3.2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 30 ){
              $scope.auxpushbadge.img = "img/badges/Categorias/GrupodeEstudos/3.3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 50){
              $scope.auxpushbadge.img = "img/badges/Categorias/GrupodeEstudos/Super.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
          }
          if(items[i].tag == '#Futebol'){
            $scope.auxpushbadge = {};
            $scope.auxpushbadge.titulo = "Parabéns!!";
            $scope.auxpushbadge.msg = "Você ganhou um novo badge";
            $scope.auxpushbadge.token = items[i].devicetoken;
            $scope.auxpushbadge.iduser = items[i].iduser;
            $scope.auxpushbadge.tipo = "badge";
            if(items[i].n == 1){
              $scope.auxpushbadge.img = "img/badges/Categorias/Futebol/1.png";
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 2){
              $scope.auxpushbadge.img = "img/badges/Categorias/Futebol/1.1.png";
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 3){
              $scope.auxpushbadge.img = "img/badges/Categorias/Futebol/1.2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 4){
              $scope.auxpushbadge.img = "img/badges/Categorias/Futebol/1.3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }

            if(items[i].n == 6){
              $scope.auxpushbadge.img = "img/badges/Categorias/Futebol/2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 8){
              $scope.auxpushbadge.img = "img/badges/Categorias/Futebol/2.1.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 10){
              $scope.auxpushbadge.img = "img/badges/Categorias/Futebol/2.2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 12){
              $scope.auxpushbadge.img = "img/badges/Categorias/Futebol/2.3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }

            if(items[i].n == 15){
              $scope.auxpushbadge.img = "img/badges/Categorias/Futebol/3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 20){
              $scope.auxpushbadge.img = "img/badges/Categorias/Futebol/3.1.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 25 ){
              $scope.auxpushbadge.img = "img/badges/Categorias/Futebol/3.2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 30 ){
              $scope.auxpushbadge.img = "img/badges/Categorias/Futebol/3.3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 50){
              $scope.auxpushbadge.img = "img/badges/Categorias/Futebol/Super.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
          }
          if(items[i].tag == '#FestaseBaladas'){
            $scope.auxpushbadge = {};
            $scope.auxpushbadge.titulo = "Parabéns!!";
            $scope.auxpushbadge.msg = "Você ganhou um novo badge";
            $scope.auxpushbadge.token = items[i].devicetoken;
            $scope.auxpushbadge.iduser = items[i].iduser;
            $scope.auxpushbadge.tipo = "badge";
            if(items[i].n == 1){
              $scope.auxpushbadge.img = "img/badges/Categorias/FestaseBaladas/1.png";
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 2){
              $scope.auxpushbadge.img = "img/badges/Categorias/FestaseBaladas/1.1.png";
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 3){
              $scope.auxpushbadge.img = "img/badges/Categorias/FestaseBaladas/1.2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 4){
              $scope.auxpushbadge.img = "img/badges/Categorias/FestaseBaladas/1.3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }

            if(items[i].n == 6){
              $scope.auxpushbadge.img = "img/badges/Categorias/FestaseBaladas/2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 8){
              $scope.auxpushbadge.img = "img/badges/Categorias/FestaseBaladas/2.1.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 10){
              $scope.auxpushbadge.img = "img/badges/Categorias/FestaseBaladas/2.2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 12){
              $scope.auxpushbadge.img = "img/badges/Categorias/FestaseBaladas/2.3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }

            if(items[i].n == 15){
              $scope.auxpushbadge.img = "img/badges/Categorias/FestaseBaladas/3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 20){
              $scope.auxpushbadge.img = "img/badges/Categorias/FestaseBaladas/3.1.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 25 ){
              $scope.auxpushbadge.img = "img/badges/Categorias/FestaseBaladas/3.2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 30 ){
              $scope.auxpushbadge.img = "img/badges/Categorias/FestaseBaladas/3.3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 50){
              $scope.auxpushbadge.img = "img/badges/Categorias/FestaseBaladas/Super.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
          }
          if(items[i].tag == '#EsportesdePraia'){
            $scope.auxpushbadge = {};
            $scope.auxpushbadge.titulo = "Parabéns!!";
            $scope.auxpushbadge.msg = "Você ganhou um novo badge";
            $scope.auxpushbadge.token = items[i].devicetoken;
            $scope.auxpushbadge.iduser = items[i].iduser;
            $scope.auxpushbadge.tipo = "badge";
            if(items[i].n == 1){
              $scope.auxpushbadge.img = "img/badges/Categorias/EsportesdePraia/1.png";
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 2){
              $scope.auxpushbadge.img = "img/badges/Categorias/EsportesdePraia/1.1.png";
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 3){
              $scope.auxpushbadge.img = "img/badges/Categorias/EsportesdePraia/1.2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 4){
              $scope.auxpushbadge.img = "img/badges/Categorias/EsportesdePraia/1.3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }

            if(items[i].n == 6){
              $scope.auxpushbadge.img = "img/badges/Categorias/EsportesdePraia/2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 8){
              $scope.auxpushbadge.img = "img/badges/Categorias/EsportesdePraia/2.1.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 10){
              $scope.auxpushbadge.img = "img/badges/Categorias/EsportesdePraia/2.2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 12){
              $scope.auxpushbadge.img = "img/badges/Categorias/EsportesdePraia/2.3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }

            if(items[i].n == 15){
              $scope.auxpushbadge.img = "img/badges/Categorias/EsportesdePraia/3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 20){
              $scope.auxpushbadge.img = "img/badges/Categorias/EsportesdePraia/3.1.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 25 ){
              $scope.auxpushbadge.img = "img/badges/Categorias/EsportesdePraia/3.2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 30 ){
              $scope.auxpushbadge.img = "img/badges/Categorias/EsportesdePraia/3.3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 50){
              $scope.auxpushbadge.img = "img/badges/Categorias/EsportesdePraia/Super.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
          }
          if(items[i].tag == '#Danca'){
            $scope.auxpushbadge = {};
            $scope.auxpushbadge.titulo = "Parabéns!!";
            $scope.auxpushbadge.msg = "Você ganhou um novo badge";
            $scope.auxpushbadge.token = items[i].devicetoken;
            $scope.auxpushbadge.iduser = items[i].iduser;
            $scope.auxpushbadge.tipo = "badge";
            if(items[i].n == 1){
              $scope.auxpushbadge.img = "img/badges/Categorias/Danca/1.png";
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 2){
              $scope.auxpushbadge.img = "img/badges/Categorias/Danca/1.1.png";
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 3){
              $scope.auxpushbadge.img = "img/badges/Categorias/Danca/1.2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 4){
              $scope.auxpushbadge.img = "img/badges/Categorias/Danca/1.3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }

            if(items[i].n == 6){
              $scope.auxpushbadge.img = "img/badges/Categorias/Danca/2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 8){
              $scope.auxpushbadge.img = "img/badges/Categorias/Danca/2.1.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 10){
              $scope.auxpushbadge.img = "img/badges/Categorias/Danca/2.2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 12){
              $scope.auxpushbadge.img = "img/badges/Categorias/Danca/2.3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }

            if(items[i].n == 15){
              $scope.auxpushbadge.img = "img/badges/Categorias/Danca/3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 20){
              $scope.auxpushbadge.img = "img/badges/Categorias/Danca/3.1.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 25 ){
              $scope.auxpushbadge.img = "img/badges/Categorias/Danca/3.2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 30 ){
              $scope.auxpushbadge.img = "img/badges/Categorias/Danca/3.3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 50){
              $scope.auxpushbadge.img = "img/badges/Categorias/Danca/Super.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
          }
          if(items[i].tag == '#Conversa'){
            $scope.auxpushbadge = {};
            $scope.auxpushbadge.titulo = "Parabéns!!";
            $scope.auxpushbadge.msg = "Você ganhou um novo badge";
            $scope.auxpushbadge.token = items[i].devicetoken;
            $scope.auxpushbadge.iduser = items[i].iduser;
            $scope.auxpushbadge.tipo = "badge";
            if(items[i].n == 1){
              $scope.auxpushbadge.img = "img/badges/Categorias/Conversa/1.png";
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 2){
              $scope.auxpushbadge.img = "img/badges/Categorias/Conversa/1.1.png";
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 3){
              $scope.auxpushbadge.img = "img/badges/Categorias/Conversa/1.2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 4){
              $scope.auxpushbadge.img = "img/badges/Categorias/Conversa/1.3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }

            if(items[i].n == 6){
              $scope.auxpushbadge.img = "img/badges/Categorias/Conversa/2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 8){
              $scope.auxpushbadge.img = "img/badges/Categorias/Conversa/2.1.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 10){
              $scope.auxpushbadge.img = "img/badges/Categorias/Conversa/2.2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 12){
              $scope.auxpushbadge.img = "img/badges/Categorias/Conversa/2.3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }

            if(items[i].n == 15){
              $scope.auxpushbadge.img = "img/badges/Categorias/Conversa/3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 20){
              $scope.auxpushbadge.img = "img/badges/Categorias/Conversa/3.1.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 25 ){
              $scope.auxpushbadge.img = "img/badges/Categorias/Conversa/3.2.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 30 ){
              $scope.auxpushbadge.img = "img/badges/Categorias/Conversa/3.3.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
            if(items[i].n == 50){
              $scope.auxpushbadge.img = "img/badges/Categorias/Conversa/Super.png"
              EventoService.MandaPushNoti($scope.auxpushbadge);
              EventoService.CriaAlerta($scope.auxpushbadge);
            }
          }

        }if(i == items.length){
          EventoService.finalizarevts(j).then(function(items) {
            if (items[0] != "E"){
              for(var i = 0 ; i<items.length ; i++){
                EventoService.finalizarevts2(items[i]);
              }
            }
          });
        }
      }else{
        EventoService.finalizarevts(j).then(function(items) {
          if (items[0] != "E"){
            for(var i = 0 ; i<items.length ; i++){
              EventoService.finalizarevts2(items[i]);
            }
          }
        });
      }
  });
    EventoService.finalizarsemppl1(j).then(function(items) {
      //console.log(items, "items")
      if (items[0] != "E"){
        for(var i = 0 ; i<items.length ; i++){
          //console.log(items[i], "soosososo")
          EventoService.finalizarsemppl2(items[i]);
        }
      }
    });
    $scope.user.hj = j;
    EventoService.lastlogin($scope.user);
    
    $scope.nnoti = 0;
    $scope.temnoti = false;
    EventoService.GetNotificacoes1($scope.user).then(function(aux) {
      if(aux == "error"){
        $scope.temnoti = false;
      }else{
        $scope.nnoti = aux.nrow;
        if($scope.nnoti>0){
          $scope.temnoti = true;
        }else{
          $scope.temnoti = false;
        }
      }
    });
    $scope.meupost = [];
    $ionicTabsDelegate.showBar(1);
    
    $scope.semloc = false;

    $scope.$on("$ionicView.enter", function(event, data){
      $scope.user = formUser.getForm();
      $scope.noMoreItemsAvailable = false;
      $scope.semfeed = false;
      $scope.semloc = false;
      $scope.meupost = [];
      $scope.npost =0;
      // $scope.auxtelacriar = formtelaCriar.getForm();
      // console.log($scope.auxtelacriar);
      $scope.vimdopost = formvimdopost.getForm();
      $scope.mostramaisinfo = false;
      console.log(qualitemindex,"qualitemindex")
      if(qualitemindex){
       $scope.items[qualitemindex].mostratudo = false;   
      } 
      qualitemindex = '';
      //$scope.items = [];
      $scope.eventocomconhecido =[];
      $scope.eventocomconhecidoidevento =[];
      $scope.participantes =[];
      $scope.participantesid = [];
      //$scope.items.tagsevento = [];
      $scope.tagsevento =[];
      $scope.centerPoint = {};
      $scope.centerPointFB = {};
      $ionicTabsDelegate.showBar(1);

      formvimdonoti.updateForm(false);
      //$scope.convidado =  window.localStorage.getItem( 'convite' );
      $scope.convidado2 =  window.localStorage.getItem( 'convite2' );
      if($scope.convidado2){
          $state.go('tabsController.eventoConvidado', {idevento: $scope.convidado2});
        }
      $scope.validarQRCODE =  window.localStorage.getItem( 'validarQRCODE' );
      //alert($scope.validarQRCODE)
      if($scope.validarQRCODE){
          $state.go('tabsController.bairroapresenta', {codigo: $scope.validarQRCODE});
        }
      $scope.raiodist = window.localStorage.getItem( 'dist' );
      if(!$scope.raiodist){
        $scope.raiodist = 30000;
        console.log($scope.raiodist)
      }
      console.log($scope.items,"$scope.items",$scope.items.length);
      if($scope.items.length == 0){
         console.log($scope.items,"$AQUIII");
        $scope.semfeed = true;

      }
      console.log($scope.raiodist, "console.log($scope.raiodist)")
      

      if($scope.user.lat){
        var auxlat = $scope.user.lat;
        var auxlong = $scope.user.long;
        var auxnorthlat = $scope.user.northlat;
        var auxwestlng = $scope.user.westlng;
        var auxsouthlat = $scope.user.southlat;
        var auxeastlng = $scope.user.eastlng;
      }
      EventoService.Entrando($scope.user).then(function(data){
        if(data.success){
          
          //console.log($scope.user.long, $scope.user.lat, "$scope.user.latdddd")
          $scope.user = data[0];
          
          $scope.user.northlat = auxnorthlat;
          $scope.user.westlng = auxwestlng;
          $scope.user.southlat = auxsouthlat;
          $scope.user.eastlng = auxeastlng;
          $scope.user.lat= auxlat ;
          $scope.user.long= auxlong;
          console.log($scope.user.long, $scope.user.lat, "$scope.user.latdddd", auxlong)
          window.localStorage.setItem( 'user', JSON.stringify(data[0]));
          formUser.updateForm(data[0]);
        }
      });

      var hptag = 0;
      $http.post("https://ec2.diwoapp.com.br/getamigos.php", {iduser : $scope.user.iduser}).then(function(response) {
        $scope.amigo = response.data;
        followers =  response.data.length;
      });
      $scope.nnoti = 0;
      $scope.temnoti = false;
      EventoService.GetNotificacoes1($scope.user).then(function(aux) {
        if(aux == "error"){
          $scope.temnoti = false;
        }else{
          $scope.nnoti = aux.nrow;
          if($scope.nnoti>0){
            $scope.temnoti = true;
          }else{
            $scope.temnoti = false;
          }
        }
      });

      var foiresetado = formResetoufeed.getForm();
      if($scope.raiodistoriginal !=  $scope.raiodist  || foiresetado){
        $scope.raiodistoriginal = $scope.raiodist;
        if (navigator.geolocation) {
          navigator.geolocation.getCurrentPosition(successFunction, errorFunction);
        } 
        function successFunction(position) {
          raio = $scope.raiodist*0.71;
          lat  = position.coords.latitude;
          long = position.coords.longitude;
          $scope.user.lat =  position.coords.latitude;
          $scope.user.long =  position.coords.longitude;
          myLatlng = new google.maps.LatLng(lat, long);
          spherical = google.maps.geometry.spherical; 
          north = spherical.computeOffset(myLatlng, raio, 0); 
          west  = spherical.computeOffset(myLatlng, raio, -90); 
          south = spherical.computeOffset(myLatlng, raio, 180); 
          east  = spherical.computeOffset(myLatlng, raio, 90);
          $scope.user.northlat = north.lat();
          $scope.user.westlng = west.lng();
          $scope.user.southlat = south.lat();
          $scope.user.eastlng = east.lng();
          $scope.centerPoint.lat = -26.997799;
          $scope.centerPoint.lng = -48.632733;
          formUser.updateForm($scope.user); 
          //console.log($scope.user.long, $scope.user.lat)
          // $scope.centerPoint.lat = -25.473466587692343;
          // $scope.centerPoint.lng = -49.29164589792566;
          $scope.centerPointKM = 30;
          $scope.LimiteFuncionamentoDiwo = !arePointsNear($scope.user, $scope.centerPoint,$scope.centerPointKM );
          
          $scope.centerPointKMFB = 2500;
          $scope.centerPointFB.lat = 39.1882887948499;
          $scope.centerPointFB.lng = -100.07746794288232;
          // $scope.LimiteFuncionamentoDiwoFB = arePointsNear($scope.user, $scope.centerPointFB,$scope.centerPointKMFB );
          
          // if(!$scope.LimiteFuncionamentoDiwoFB){
          //   raio = 2500000*0.71;
          //   lat  = position.coords.latitude;
          //   long = position.coords.longitude;
          //   $scope.user.lat =  position.coords.latitude;
          //   $scope.user.long =  position.coords.longitude;
          //   myLatlng = new google.maps.LatLng(lat, long);
          //   spherical = google.maps.geometry.spherical; 
          //   north = spherical.computeOffset(myLatlng, raio, 0); 
          //   west  = spherical.computeOffset(myLatlng, raio, -90); 
          //   south = spherical.computeOffset(myLatlng, raio, 180); 
          //   east  = spherical.computeOffset(myLatlng, raio, 90);
          //   $scope.user.northlat = north.lat();
          //   $scope.user.westlng = west.lng();
          //   $scope.user.southlat = south.lat();
          //   $scope.user.eastlng = east.lng();
          //   $scope.LimiteFuncionamentoDiwo = false;
          // }

          formLimiteatuacao.updateForm($scope.LimiteFuncionamentoDiwo);
          console.log($scope.LimiteFuncionamentoDiwo, $scope.user.northlat , "LOC")
          if(!$scope.LimiteFuncionamentoDiwo){
           
              $scope.items = [];
              $scope.vazio = false;
              console.log("GetFeed2")
              EventoService.GetFeed2($scope.user).then(function(items) {
              //$ionicLoading.hide();
              if (items != 'E'){
                $scope.semfeed = false;
                ft2 = 0;
                ft3 = 0;
                for(var i = 0 ; i<items.length ; i++){
                  if(items[i].zone ==  'red' && parseInt(items[i].pmin)> parseInt(items[i].patual) && items[i].estado == '0'){
                     EventoService.Cancelarevento(items[i]);
                    console.log('Falta gente para o evento, mas como estamos na redzone vou cancelar', items[i].idevento ,items[i].pmin , items[i].patual);
                  }
                  if(items[i].tipodeevento){
                    console.log("patrocinadoffff")
                    if(items[i].tipodeevento == 'campanha'){
                      items[i].tipodeeventocampanha = true;
                    }else{
                      items[i].tipodeeventocampanha = false;
                    }
                    items[i].patrocinado = true;
                    // if(items[i].descontopacote){
                    //   var res2 = items[i].descontopacote.split("/wq") ;
                    //   if(res2.length>1){
                    //     for(var w = 0; w < res2.length; w++){
                    //       console.log(res2[w])
                    //     }
                    //   }
                    // }
                    
                    items[i].stylerowhome = "border-width: 0px;margin-top: 15px;background-image: linear-gradient(to bottom,#222, #74001a);";
                    
                    items[i].stylebarrahome = "border-color: #ff4444;border-width: 2px solid;background-image: linear-gradient(to bottom,  #222,#74001a);";
                    
                    //items[i].styleItem = "background-color: #212121;color: white;box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.3);border: 4px dotted #ffdb29;";
                    //items[i].styleItem = "background-color: #212121;color: white;box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.3);border: 4px dotted #ff9008;";
                    items[i].styleItemhome = " position: fixed;-webkit-transform: scale(1,1);display: block;width: 96%;height: auto;box-sizing: border-box;background-color: #21212121;box-shadow: 0 4px 8px 0 rgba(255,127,114, 0.3);border-radius: 4px; overflow: hidden;-webkit-animation-fill-mode: forwards;";
                    //items[i].styleItem = "background-color: #212121;color: white;box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.3);border: 4px dotted #f9bdff;";
                    //items[i].styleItem = "background-color: #212121;color: white;box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.3);border: 4px dotted #00FFFF;";
                  }else{
                    items[i].patrocinado = false;
                    items[i].tipodeeventocampanha = false;
                    items[i].stylerowhome = "border-width: 0px;margin-top: 15px";
                    
                    items[i].stylebarrahome = " border-color: #ff4444;border-width: 2px solid;background-color: #222";
                    
                    items[i].styleItemhome = " position: fixed;-webkit-transform: scale(1,1);display: block;width: 96%;height: auto;box-sizing: border-box;background-color: #21212121;box-shadow: 0 4px 8px 0 rgba(71, 71, 71, 0.3);border-radius: 4px; overflow: hidden;-webkit-animation-fill-mode: forwards;";
                  }

                    var hjd = items[i].duracao;
                    var hd = (hjd[0]+hjd[1]).valueOf();
                    var md = (hjd[3]+hjd[4]).valueOf();
                    items[i].duracao = hd+':'+md;

                    var  hjl = items[i].dialimiteconfirmacao;
                    items[i].limitedia =  (hjl[8]+hjl[9]).valueOf()+'/'+(hjl[5]+hjl[6]).valueOf();
                    items[i].limitehora =  (hjl[11]+hjl[12]).valueOf()+':'+(hjl[14]+hjl[15]).valueOf();  
                    
                    var hj = items[i].diainicio;
                    var ano = (hj[0]+hj[1]+hj[2]+hj[3]).valueOf();
                    var mes = (hj[5]+hj[6]).valueOf();
                    var dia = (hj[8]+hj[9]).valueOf();
                    var h = (hj[11]+hj[12]).valueOf();
                    var m = (hj[14]+hj[15]).valueOf();
                    var hjf = items[i].diafim;
                    items[i].fimdia =  (hjf[8]+hjf[9]).valueOf()+'/'+(hjf[5]+hjf[6]).valueOf()+'/'+(hjf[0]+hjf[1]+hjf[2]+hjf[3]);
                    items[i].fimhora = (hjf[11]+hjf[12]).valueOf()+':'+(hjf[14]+hjf[15]).valueOf();
                    items[i].diadia = dia+'/'+mes;
                    
                    if(items[i].limitedia == items[i].diadia ){
                      items[i].limsemana = items[i].semana ;
                    }else{
                      if(items[i].semana == "Segunda-feira"){
                        items[i].limsemana = "Domingo";
                      }
                      if(items[i].semana == "Terça-feira"){
                        items[i].limsemana = "Segunda-feira";
                      }
                      if(items[i].semana == "Quarta-feira"){
                        items[i].limsemana = "Terça-feira";
                      }
                      if(items[i].semana == "Quinta-feira"){
                        items[i].limsemana = "Quarta-feira";
                      }
                      if(items[i].semana == "Sexta-feira"){
                        items[i].limsemana = "Quinta-feira";
                      }
                      if(items[i].semana == "Sábado"){
                        items[i].limsemana = "Sexta-feira";
                      }
                      if(items[i].semana == "Domingo"){
                        items[i].limsemana = "Sábado";
                      }
                    }

                    if(items[i].estado == 21){
                      items[i].chatlike = false;
                      console.log("estado 21", items[i].eventopic)
                      if(items[i].eventopic == "img/manha.png"){
                        console.log("enrta aqui")
                        items[i].diahora = 'Manhã'
                      }
                      if(items[i].eventopic == "img/tarde.png"){
                        console.log("enrta aqui")
                        items[i].diahora = 'Tarde'
                      }
                      if(items[i].eventopic == "img/noite.png"){
                        console.log("enrta aqui")
                        items[i].diahora = 'Noite'
                      }
                      
                    }else{
                      items[i].chatlike = true;
                      items[i].diahora = h+':'+m +' - '+(hjf[11]+hjf[12]).valueOf()+':'+(hjf[14]+hjf[15]).valueOf() ;
                    }
                       items[i].mostratudo = false;   
                      if(parseInt(items[i].pmin)>parseInt(items[i].patual)){
                        $scope.menorqpmin = true;
                        $scope.nopmin = false;
                        $scope.entre = false;
                        $scope.cheio = false;
                      }
                      if(parseInt(items[i].pmin)==parseInt(items[i].patual)){
                        $scope.menorqpmin = false;
                        $scope.nopmin = true;
                        $scope.entre = false;
                        $scope.cheio = false;
                      }

                      if(parseInt(items[i].pmin)<parseInt(items[i].patual) && parseInt(items[i].pmax)>parseInt(items[i].patual)){
                        $scope.menorqpmin = false;
                        $scope.nopmin = false;
                        $scope.entre = true;
                        $scope.cheio = false;
                        console.log("nao cheio")
                      }
                      if(parseInt(items[i].pmin)<parseInt(items[i].patual) && parseInt(items[i].pmax)<=parseInt(items[i].patual)){
                        $scope.menorqpmin = false;
                        $scope.nopmin = false;
                        $scope.entre = false;
                        $scope.cheio = true;
                       // console.log(" cheio", items[i].pmin.valueOf() , items[i]patual.valueOf(), items[i].pmax.valueOf())
                      }
                      
                    items[i].pinza = true;
                    EventoService.GetParticipantesFav(items[i].idevento).then(function(tes) {
                      for (var j = 0; j < tes.length; j++) {
                        if ($scope.user.iduser == tes[j].iduser && tes[j].estado == 7) {
                          items[ft3].pinza = false;
                          console.log(items[ft3].pinza, ft3)
                        }
                      }
                      ft3 ++;
                    });

                  EventoService.GetParticipantes(items[i].idevento).then(function(tes) {
                    for (var j = 0; j < tes.length; j++) {
                      //console.log($scope.user.iduser,"user", tes[j].iduser, tes[j].estado)
                      
                       if(tes[j].estado == '2'){
                        //$scope.participantes[ft2];
                        if($scope.participantesid[ft2] !=undefined){
                          $scope.participantesid[ft2] = tes[j].idevento;
                          $scope.participantes[ft2]++ ;
                        }else{
                          $scope.participantesid[ft2] = tes[j].idevento;
                          $scope.participantes[ft2] = 1;
                        }
                      }
                      for (var l = 0; l< followers;l++){
                        if (tes[j].iduser == $scope.amigo[l].iduserseguindo) {
                          if($scope.eventocomconhecidoidevento[ft2] !=undefined){
                            $scope.eventocomconhecidoidevento[ft2] = tes[j].idevento;
                            $scope.eventocomconhecido[ft2] = tes[j].apelido + ', '+ $scope.eventocomconhecido[ft2] ;
                          }else{
                            $scope.eventocomconhecidoidevento[ft2] = tes[j].idevento;
                            $scope.eventocomconhecido[ft2] = tes[j].apelido;
                          }
                         //console.log($scope.eventocomconhecidoidevento[ft2], $scope.eventocomconhecido[ft2] , ft2)
                        }
                      }
                    }
                    ft2++;
                    console.log(ft2)
                    if(ft2==items.length){
                      for(var t = 0; t<ft2;t++){
                        for(var r = 0; r<ft2;r++){
                          if (items[t].idevento == $scope.eventocomconhecidoidevento[r]) {
                             items[t].amigo =  'Q vai e sigo: '+$scope.eventocomconhecido[r];
                             // console.log(items[t].idevento, t ,items[t].amigo );
                          }
                          if (items[t].idevento == $scope.participantesid[r]) {
                           items[t].participantes =  $scope.participantes[r];
                          }
                        }
                      } 
                      if(t == items.length){
                        $scope.items = items.concat($scope.items);
                       //console.log($scope.lastidvestido);
                      }
                    }
                  });
                }
              }else{
                console.log("sem feed");
                $scope.semfeed = true;
              }
            });
            } 
          //}
          

        }

        function errorFunction(){
            //alert("Geocoder failed");
            $scope.semloc = true;
        }

        function arePointsNear(checkPoint, centerPoint, km) {
          var ky = 40000 / 360;
          var kx = Math.cos(Math.PI * centerPoint.lat / 180.0) * ky;
          var dx = Math.abs(centerPoint.lng - $scope.user.long) * kx;
          var dy = Math.abs(centerPoint.lat - $scope.user.lat) * ky;
          var resp = Math.sqrt(dx * dx + dy * dy) <= km;
          return !resp
        }
      }
       
      //formtelaCriar.updateForm(0); // 0 significa que ja foi atualizado o feed perante a criação de um evento novo
  
         
              // VER AS 48H APÓS UM EVENTO SER FINALIZADO
              
              $http.post("https://ec2.diwoapp.com.br/getpenalidade.php", {iduser : $scope.user.iduser}).then(function(tes) {
                var ic = {};
                ic.iduser = $scope.user.iduser;
                ic.black = 0;
                ic.red = 0;
                ic.yellow = 0;
                ic.antiblack = 0;
                ic.antired = 0;
                ic.antiyellow = 0;
                ic.lenghtblack = 0;
                ic.lenghtred = 0;
                ic.lenghtyellow = 0;
                ic.idblack = [];
                ic.idred = [];
                ic.idyellow = [];

                ic.lenghtantiblack = 0;
                ic.lenghtantired = 0;
                ic.lenghtantiyellow = 0;
                ic.idantiblack = [];
                ic.idantired = [];
                ic.idantiyellow = [];
                if(tes.data.success != false){
                  //console.log('dasa')
                                  for(var h = 0;h<tes.data[0].length;h++){
                                    if(tes.data[0][h].tipopenalidade == 3){ic.black += 1; ic.blackdate = tes.data[0][h].date; ic.idblack[ic.lenghtblack] =tes.data[0][h].idpenalidade;  ic.lenghtblack++;}
                                    if(tes.data[0][h].tipopenalidade == 2){ic.red += 1;  ic.reddate = tes.data[0][h].date; ic.idred[ic.lenghtred] =tes.data[0][h].idpenalidade; ic.lenghtred++;}
                                    if(tes.data[0][h].tipopenalidade == 1){ic.yellow += 1;  ic.yellowdate = tes.data[0][h].date; ic.idyellow[ic.lenghtyellow] =tes.data[0][h].idpenalidade; ic.lenghtyellow++;}
                                    if(tes.data[0][h].tipopenalidade == 6){ic.antiblack += 1; ic.antiblackdate = tes.data[0][h].date; ic.idantiblack[ic.lenghtantiblack] =tes.data[0][h].idpenalidade; ic.lenghtantiblack++;}
                                    if(tes.data[0][h].tipopenalidade == 5){ic.antired += 1;  ic.antireddate = tes.data[0][h].date; ic.idantired[ic.lenghtantired] =tes.data[0][h].idpenalidade; ic.lenghtantired++;}
                                    if(tes.data[0][h].tipopenalidade == 4){ic.antiyellow += 1;  ic.antiyellowdate = tes.data[0][h].date; ic.idantiyellow[ic.lenghtantiyellow] =tes.data[0][h].idpenalidade; ic.lenghtantiyellow++;}
                                  }
                                  //console.log(ic.black);
                  EventoService.faz48h(ic);       
                }else{
                  EventoService.faz48h(ic);
                }
              });

    })
  var qualitemindex; 
  $scope.MaisInfo = function(index){
    qualitemindex = index;
    $scope.evento= $scope.items[index];
    $scope.item = $scope.items[index];
    $scope.evento.index = index;
    console.log($scope.evento.index)
    $scope.auxpinza = {};
    $scope.mostrapin = $scope.evento.pinza;
    console.log($scope.evento.lat)
    $scope.auxpinza.iduser = $scope.user.iduser;
    $scope.auxpinza.idevento = $scope.evento.idevento;
    $scope.items[index].mostratudo = true;    

    EventoService.Gettags($scope.evento.idevento).then(function(tags) {
      for(var  i =0; i< tags.length;i++){
        if(i>0){
          tags[i].tag = (tags[i].tag + ' ' + tags[i-1].tag);
          //console.log(tags[i].tag )
        }
        if(i+1 == tags.length){
          auxtag = tags[i].tag
        }
      } 
      console.log(auxtag)

      $scope.tags = auxtag;
      //console.log($scope.tags,"$scope.tags")
    });
    if($scope.evento.preco == 0 || $scope.evento.preco =="Gratuito"){
      $scope.evento.preco = "Gratuito";
      $scope.porpessoa = false;
      $scope.porlocal = false;
    }else{
      if($scope.evento.precopor == 1){
        $scope.porpessoa = true;
        $scope.porlocal = false;
      }else{
        $scope.porpessoa = false;
        $scope.porlocal = true;
      }
    }
                     
      EventoService.GetParticipantesSemFav($scope.evento.idevento).then(function(listapessoas) {
                      console.log(listapessoas.success, "bug dentro")
        if(listapessoas.success!=false){
          for (var i = 0; i < listapessoas.length; i++) {
                        if (listapessoas[i].estado == 0) {
                          listapessoas[i].confirmacao = 'Oi, sou o organizador';
                          $scope.criador = listapessoas[i].iduser;
                        }
                        if (listapessoas[i].estado == 1) {
                          listapessoas[i].confirmacao = 'E eu aguardando confirmação';
                        }
                        if (listapessoas[i].estado == 2) {
                          listapessoas[i].confirmacao = 'To confirmado!!';
                        }
                        if(listapessoas[i].borda == 0){
                            listapessoas[i].bb = false;
                            listapessoas[i].bs = false;
                            listapessoas[i].bg = false;
                          }
                          if(listapessoas[i].borda == 1){
                            listapessoas[i].bb = true;
                            listapessoas[i].bs = false;
                            listapessoas[i].bg = false;
                          }
                          if(listapessoas[i].borda == 2){
                            listapessoas[i].bb = false;
                            listapessoas[i].bs = true;
                            listapessoas[i].bg = false;
                          }
                          if(listapessoas[i].borda == 3){
                            listapessoas[i].bb = false;
                            listapessoas[i].bs = false;
                            listapessoas[i].bg = true;
                          }
                          if((listapessoas[i].profilepic[8] == 's' && listapessoas[i].profilepic[9] == '3')||(listapessoas[i].profilepic[8] == 'd' && listapessoas[i].profilepic[9] == 'i')){
          
                          //if(listapessoas[i].profilepic[8] == 's' && listapessoas[i].profilepic[9] == '3'){
                             listapessoas[i].profilepic=listapessoas[i].profilepic+"?{{getTimeStamp()}}";
                           }else{
                             listapessoas[i].profilepic=listapessoas[i].profilepic;
                           }

                      }
                      $scope.listapessoas = listapessoas;
        }else{
          $scope.listapessoas = [];
        }
                      
                      //console.log($scope.participantes[0].profilepic)
                      //$scope.participantes = participantes.concat($scope.participantes);
                    });
    $scope.mostramaisinfo = true;
    $ionicTabsDelegate.showBar(0);
  }
  $scope.MenosInfo = function(){
    $scope.mostramaisinfo = false;
    $scope.items[qualitemindex].mostratudo = false;    
    qualitemindex = '';
    $ionicTabsDelegate.showBar(1);

  }
  $scope.Vermapa = function(evento){
    
    
    formItem.updateForm(evento)
    $state.go('tabsController.ver_onde_mapa');
  }

  $scope.doRefresh = function(uia) {
    if(!$scope.semfeed){
       if(!$scope.semloc ){
        //console.log(uia[0].diainicio)
        if($scope.postBar == false){
          $scope.vazio = false;
          console.log("Evento")
          var yes = uia[0].diainicio;
          var no = uia[0].idevento;
          EventoService.GetNewEventos($scope.user).then(function(items) {
           $scope.newItems = [];
           //console.log(items)
           $scope.newItems = items.concat($scope.newItems);
           console.log( $scope.newItems[0].diainicio ,yes);
             if (yes > $scope.newItems[0].diainicio && no != $scope.newItems[0].idevento) {
              for (var g = 0; g<items.length;g++){
                $scope.newItems[g].faltatempo = 'Novo evento próximo';
              }
              if(g == items.length){
                $scope.items = $scope.newItems.concat($scope.items);
              $scope.$broadcast('scroll.refreshComplete');
              $scope.lastidevento  = $scope.newItems[0].diainicio;
              $scope.newItems = [];
              }
            }else {
              //console.log($scope.items.length);
              var hj = new Date();
              var currentdate = new Date(); 
              var curr_date = (currentdate.getDate()<10?'0':'') + currentdate.getDate();
              var curr_month = (currentdate.getMonth()<10?'0':'') + (currentdate.getMonth() + 1); //Months are zero based
              var curr_year = currentdate.getFullYear();
              var h2 = (currentdate.getHours()<10?'0':'') + currentdate.getHours();
              var m2 = (currentdate.getMinutes()<10?'0':'') + currentdate.getMinutes();
              for (var c = 0; c<$scope.items.length;c++){
                hj = $scope.items[c].diainicio;
                var ano = (hj[0]+hj[1]+hj[2]+hj[3]).valueOf()-curr_year;
                var mes = (hj[5]+hj[6]).valueOf()-curr_month;
                var dia = (hj[8]+hj[9]).valueOf()-curr_date;
                var h = (hj[11]+hj[12]).valueOf()-h2;
                var m = (hj[14]+hj[15]).valueOf()-m2;
                  
              }

            //     //Stop the ion-refresher from spinning
                $scope.$broadcast('scroll.refreshComplete');
             }
          });
        }else{
          $scope.items = [];
    $scope.posts = [];
    $ionicTabsDelegate.showBar(0);
    if (navigator.geolocation) {
          navigator.geolocation.getCurrentPosition(successFunction, errorFunction);
        } 
        function successFunction(position) {
          raio = $scope.raiodist*0.71; //50 1000km
          lat  = position.coords.latitude;
          long = position.coords.longitude;
          $scope.user.lat =  position.coords.latitude;
          $scope.user.long =  position.coords.longitude;
          myLatlng = new google.maps.LatLng(lat, long);
          spherical = google.maps.geometry.spherical; 
          north = spherical.computeOffset(myLatlng, raio, 0); 
          west  = spherical.computeOffset(myLatlng, raio, -90); 
          south = spherical.computeOffset(myLatlng, raio, 180); 
          east  = spherical.computeOffset(myLatlng, raio, 90);
          $scope.user.northlat = north.lat();
          $scope.user.westlng = west.lng();
          $scope.user.southlat = south.lat();
          $scope.user.eastlng = east.lng();
          $scope.centerPoint.lat = -26.997799;
          $scope.centerPoint.lng = -48.632733; 
          // $scope.centerPoint.lat = -25.473466587692343;
          // $scope.centerPoint.lng = -49.29164589792566;
          $scope.centerPointKM = 30;
          $scope.LimiteFuncionamentoDiwo = arePointsNear($scope.user, $scope.centerPoint,$scope.centerPointKM );
      
          if($scope.LimiteFuncionamentoDiwo){
              raio = 200*0.71;
              lat  = position.coords.latitude;
              long = position.coords.longitude;
              myLatlng = new google.maps.LatLng(lat, long);
              spherical = google.maps.geometry.spherical; 
              north = spherical.computeOffset(myLatlng, raio, 0); 
              west  = spherical.computeOffset(myLatlng, raio, -90); 
              south = spherical.computeOffset(myLatlng, raio, 180); 
              east  = spherical.computeOffset(myLatlng, raio, 90);
              $scope.user.northlat = north.lat();
              $scope.user.westlng = west.lng();
              $scope.user.southlat = south.lat();
              $scope.user.eastlng = east.lng();
             EventoService.GetFeedPost($scope.user).then(function(posts) {
              //console.log(posts, "POST")
              //$scope.posts = posts.concat($scope.posts);
              if (posts!='Error'&&posts!='E') {
                //console.log("das", posts.length) 
                $scope.vazio = false;
                $scope.posts = posts.concat($scope.posts);
                $scope.npost =0;
                for(var i = 0 ; i<posts.length ; i++){
                  if(posts.iduser == $scope.user.iduser){
                    $scope.meupost = posts[i];
                    $scope.npost ++;
                  }
                }
                if(posts.length ==i){
                  formMeusPost.updatePost($scope.meupost);
                }
              }else{
                $scope.vazio = true;
                $scope.posts =[];
                $scope.meupost = posts;
              }
            });
        
          }
          formLimiteatuacao.updateForm($scope.LimiteFuncionamentoDiwo);
          console.log($scope.LimiteFuncionamentoDiwo, $scope.user.northlat, $scope.LimiteFuncionamentoDiwoFB)
        }

        function errorFunction(){
            //alert("Geocoder failed");
            $scope.semloc = true;
        }

        function arePointsNear(checkPoint, centerPoint, km) {
          var ky = 40000 / 360;
          var kx = Math.cos(Math.PI * centerPoint.lat / 180.0) * ky;
          var dx = Math.abs(centerPoint.lng - $scope.user.long) * kx;
          var dy = Math.abs(centerPoint.lat - $scope.user.lat) * ky;
          var resp = Math.sqrt(dx * dx + dy * dy) <= km;
          return !resp;
        }
        }
      }
    }
    $scope.$broadcast('scroll.refreshComplete');
    $scope.noMoreItemsAvailable = false;
  }
  
  $scope.loadMore = function() {

      //console.log($scope.semloc, $scope.semfeed, $scope.noMoreItemsAvailable)
      if($scope.semfeed==true){
        if($scope.semloc==true){
          console.log($scope.semloc, $scope.semfeed, "dentro")
          deletou = 0;
          EventoService.GetOldEventos($scope.user).then(function(items) {
          $scope.$broadcast('scroll.infiniteScrollComplete');
          //console.log(items.length);
          auxtes = 0;
           for(var i = 0 ; i<items.length ; i++){
             // console.log(items[i].faltatempo);
                  EventoService.GetParticipantes(items[i].idevento).then(function(tes) {

                    for (var j = 0; j < tes.length; j++) {
                      for (var l = 0; l< followers;l++){
                        if (tes[j].iduser == $scope.amigo[l].iduserseguindo) {
                          if($scope.eventocomconhecidoidevento[ft2] !=undefined){
                            $scope.eventocomconhecidoidevento[ft2] = tes[j].idevento;
                            $scope.eventocomconhecido[ft2] = tes[j].apelido + ', '+ $scope.eventocomconhecido[ft2] ;
                          }else{
                            $scope.eventocomconhecidoidevento[ft2] = tes[j].idevento;
                            $scope.eventocomconhecido[ft2] = tes[j].apelido;
                          }
                        
                        // console.log($scope.eventocomconhecidoidevento[ft2], $scope.eventocomconhecido[ft2] , ft2)
                        }
                      }
                    }ft2++;auxtes++;
                    if(auxtes==items.length){
                      for(var t = 0; t<auxtes;t++){
                        for(var r = 0; r<$scope.eventocomconhecidoidevento.length;r++){
                          if (items[t].idevento == $scope.eventocomconhecidoidevento[r]) {
                             items[t].amigo =  'Q vai e sigo: '+$scope.eventocomconhecido[r];
                              //console.log(items[t].idevento, t ,items[t].amigo );
                          }
                        }
                       
                      }
            
                       if(t == items.length){
                       $scope.items = $scope.items.concat(items);
                       $scope.lastidvestido = $scope.items[0].diainicio; 
                       //console.log($scope.lastidvestido);
                      }
                    }
                  });
              }

            if (items.length <= 4 &&  deletou != 1) {
            //  console.log('aqui');
              $scope.noMoreItemsAvailable = true;
              $scope.items=$scope.items;
            }
            if (items[0]=='E') {
              $scope.noMoreItemsAvailable = true;
              $scope.items=$scope.items;
            }
          });
        }
      } 
    $scope.$broadcast('scroll.infiniteScrollComplete');
    //$scope.noMoreItemsAvailable = true;
  }
  //console.log($scope.user.genero , "genero")
  $scope.enterItem =  function(item){
    console.log(item.genero)
    if($scope.user.iduser == 37){
      var alertPopup = $ionicPopup.alert({
                        title: 'Parabéns',
                        template: $scope.response.msg
                      });
        alertPopup.then(function(){
          $state.go('logando');
        });
    }

    formItem.updateForm(item);
    formvimdofiltro.updateForm(false);
    formvimdofiltroperfil.updateForm(false);
    if(item.genero !="todos"){
      if(!$scope.user.genero){
        $state.go('idadegenero');
      }else{
        $state.go('tabsController.eventoAberto');
      }
    }else{
        $state.go('tabsController.eventoAberto');
      }
    // if(!$scope.user.genero){
    //   $state.go('idadegenero');
    // }else{
    //   $state.go('tabsController.eventoAberto');
    // }
   // console.log(item.idevento);
    //console.log(item.adm);
  }

  $scope.area = function(){
     $state.go('areacobertura');
  }
  $scope.postBar = false;


}])

.controller('postCtrl', ['$scope', '$state', '$stateParams','$ionicPopup','$ionicTabsDelegate', 'formUser','formvimdofiltroperfil', 'formPost', 'EventoService', '$http', '$ionicPopup', 'formvimdopost', 'formOutro','formvimdonoti',  // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $state, $stateParams,$ionicPopup,$ionicTabsDelegate, formUser,formvimdofiltroperfil, formPost, EventoService, $http, $ionicPopup, formvimdopost, formOutro,formvimdonoti) {
  
  $scope.post = formPost.getPost();
  formvimdopost.updateForm(true);
  $scope.user = formUser.getForm();
  $scope.items = [];
  $scope.data = {};
  $scope.postaux = {};
  $scope.auxpost = {};
  $scope.auxpost.user = $scope.user;
  $scope.auxpost.idposts = $scope.post.idposts;

      if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(successFunction, errorFunction);
      } 
      function successFunction(position) {
        $scope.auxpost.user.lat =  position.coords.latitude;
        $scope.auxpost.user.lng =  position.coords.longitude;
        EventoService.PostGet($scope.auxpost).then(function(post) {
          $scope.post = post;
          if($scope.user.iduser ==$scope.post.iduser ){
            $scope.meupost = true;
            if($scope.post.postTipo == "normal"){
              $scope.som = true;
              $scope.silencio = false;
            }else{
              $scope.som = false;
              $scope.silencio = true;
            }
          }else{
            $scope.meupost = false;
            $scope.silencio = false;
            $scope.som = false;
          }
        });
      }
      function errorFunction(){
      }


  

  $scope.$on("$ionicView.enter", function(event, data){
    $scope.post = formPost.getPost();
    $scope.user = formUser.getForm();
    $scope.auxpost = {};
    $scope.auxpost.user = $scope.user;
    $scope.auxpost.user.lat = $scope.user.lat;
    $ionicTabsDelegate.showBar(0);
    $scope.vimdanoti = formvimdonoti.getForm();
    console.log($scope.vimdanoti , "$scope.vimdanoti")
    //console.log( $scope.user.iduser,$scope.user.lat,"$scope.auxpost.user.lat")
    $scope.auxpost.idposts = $scope.post.idposts;
    $scope.items = [];
    $scope.comentario = '';
     if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(successFunction, errorFunction);
      } 
      function successFunction(position) {
        $scope.auxpost.user.lat =  position.coords.latitude;
        $scope.auxpost.user.lng =  position.coords.longitude;
        console.log(   $scope.auxpost.user.lng ,"   $scope.auxpost.user.lng ")
        EventoService.PostGet($scope.auxpost).then(function(post) {
          $scope.post = post;
          var postaux ={};
          postaux.idposts = $scope.post.idposts;
          postaux.iduser = $scope.user.iduser;
            EventoService.GetComentarioPost(postaux).then(function(item) {
                console.log(item, "GetComentarioPost")
                      if (item!='Error'&&item!='E') {
                        $scope.vazio = false;
                        $scope.items = item.concat($scope.items);
                      }else{
                        $scope.vazio = true;
                        $scope.items =[];
                      }
            });

            EventoService.GetPostVoted(postaux).then(function(item) {
              console.log(item, "GetPostVoted")
              if (item!='Error'&&item!='E') {
                console.log(item[0].estado,"item.estado")
                if(item[0].estado =='1'){
                  $scope.podevotar = false;
                  $scope.podedownvotar = true;
                }else{
                  $scope.podedownvotar = false;
                  $scope.podevotar = true;
                   //console.log( $scope.podevotar," $scope.podevotar")
                }

              }else{
                 $scope.podevotar = true;
                 $scope.podedownvotar = true;
              }
            });
          if($scope.user.iduser ==$scope.post.iduser ){
            $scope.meupost = true;
            if($scope.post.postTipo == "normal"){
              $scope.som = true;
              $scope.silencio = false;
            }else{
              $scope.som = false;
              $scope.silencio = true;
            }
          }else{
            $scope.meupost = false;
            $scope.silencio = false;
            $scope.som = false;
          }
        });
      }
      function errorFunction(){
      }

    
    
    formvimdopost.updateForm(true);
    
   
   
  });
  $scope.reportarcomentario =  function(item){
    $scope.reportmsg = '';
    $scope.report = [
      { text: "Conteúdo impróprio", checked: false },
      { text: "Linguajar inadequado", checked: false },
      { text: "Discurso de ódio", checked: false },
      { text: "Imagem imprópria", checked: false },
      { text: "Substancias ilicitas ", checked: false }
    ];
    $ionicPopup.confirm({
        title: 'Você quer reportar esse comentário pq?',
        content: '<ion-checkbox ng-repeat="item in report" style="color: #FCFCFC;" ng-model="item.checked"  ng-checked="item.checked">{{item.text}}</ion-checkbox>',
        scope: $scope
    }).then(function(res) {
        if(res) {
          for (var h=0;h<3;h++){
            if($scope.report[h].checked){
              $scope.reportmsg = $scope.reportmsg + $scope.report[h].text + ' ';
            }
          }
          if(h==3){
            console.log($scope.reportmsg);
            $scope.reportmsg = $scope.reportmsg + item.idpostscomentarios + item.idposts
            $http.post('https://ec2.diwoapp.com.br/reportaevento.php', {namereportado : $scope.item.username,
                                                                          reportadoid : $scope.item.iduser,
                                                                            iduserreportando : $scope.aux.iduser,
                                                                            usernamereportando : $scope.aux.username,
                                                                            tiporeport : 'comentariopost',
                                                                            motivo : $scope.reportmsg}).then(function (tes){
              $scope.response = tes.data;
              var alertPopup = $ionicPopup.alert({
                                        title: 'Obrigado',
                                        template: 'Este post esta agora sobre avaliação, obrigado por manter a plataforma organizada'
              });
            });
          }
        }
    });
  }
  $scope.deletarcomentario =  function(item){
        var confirmPopup = $ionicPopup.show({
                   title: '(⊙△⊙✿)',
                   template: 'Deseja deletar esse comentário?',
                   buttons: [
                      { text: 'Não',
                        type: 'button-positive'},
                      {
                        text: 'Sim',
                        type: 'button-assertive',
                        onTap: function(e){
                            EventoService.DeletaComentarioPost(item).then(function (resp){
                              if(resp){
                                $scope.items.splice($scope.items.indexOf(item), 1);  
                              }
                            });
                        }
                      }]})
  }
  $scope.upvote =  function(){
      var agora = new Date(); 
      var curr_date = (agora.getDate()<10?'0':'') + agora.getDate();
      var curr_month = (agora.getMonth()<9?'0':'') + (agora.getMonth() + 1); //Months are zero based
      var curr_year = agora.getFullYear();
      var h2 = (agora.getHours()<10?'0':'') + agora.getHours();
      var m2 = (agora.getMinutes()<10?'0':'') + agora.getMinutes();
      var s2 = (agora.getSeconds()<10?'0':'') + agora.getSeconds();
      var j = curr_year + "-" + curr_month + "-" + curr_date+ ' '+h2 + ':' + m2 + ':' + s2;
      $scope.datadecriacao = j;
        $scope.post.upvote = parseInt($scope.post.upvote) + 1;
        console.log($scope.post.upvote, $scope.post.notiupvote , "$scope.post.notiupvote")
        if($scope.post.upvote == '1' && $scope.post.notiupvote == '0'){
              console.log("1 upvote", $scope.post.postTipo,  "normal")
        
          if($scope.post.postTipo == "normal"){
              console.log("1 upvote", $scope.user.iduser, $scope.post.iduser)

            if($scope.user.iduser != $scope.post.iduser){
              console.log("1 upvote dentro")
              $scope.pushnoti = {};
              $scope.msg =  $scope.user.username + " deu o primeiro upvote no post: " + $scope.post.postTitulo;
              $http.post('https://ec2.diwoapp.com.br/notificacriador.php', {notificacao :$scope.msg , 
                    idevento : $scope.post.idposts,
                    nomeevento : $scope.post.postTitulo,
                    id_user_envia : $scope.user.iduser,
                    username_envia : $scope.user.username,
                    apelido_envia : $scope.user.apelido,
                    tipo : '401',
                    id_user_recebe : $scope.post.iduser});
                EventoService.getusuario2($scope.post.username).then(function(user) {
                  if(user.notipost == '1'){
                  $scope.pushnoti.titulo = $scope.post.postTitulo;
                  $scope.pushnoti.msg = $scope.msg;
                  $scope.pushnoti.token = user.devicetoken;
                   EventoService.MandaPushNoti($scope.pushnoti);
                 }
                    $scope.post.notiupvote = '1';
                   EventoService.PostNotiUpvote($scope.post)
                });
            }        
          } 
        }
        if($scope.post.upvote == '5' && $scope.post.notiupvote == '1'){
          console.log("5 upvote")

          if($scope.post.postTipo == "normal"){
            if($scope.user.iduser != $scope.post.iduser){
              $scope.pushnoti = {};
              $scope.msg =  "5 upvotes!! que sucesso seu post: " + $scope.post.postTitulo;
              $http.post('https://ec2.diwoapp.com.br/notificacriador.php', {notificacao :$scope.msg , 
                    idevento : $scope.post.idposts,
                    nomeevento : $scope.post.postTitulo,
                    id_user_envia : $scope.user.iduser,
                    username_envia : $scope.user.username,
                    apelido_envia : $scope.user.apelido,
                    tipo : '401',
                    id_user_recebe : $scope.post.iduser});
                EventoService.getusuario2($scope.post.username).then(function(user) {
                  if(user.notipost == '1'){
                  $scope.pushnoti.titulo = $scope.post.postTitulo;
                  $scope.pushnoti.msg = $scope.msg;
                  $scope.pushnoti.token = user.devicetoken;
                   EventoService.MandaPushNoti($scope.pushnoti);
                 }
                   $scope.post.notiupvote = '2';
                   EventoService.PostNotiUpvote($scope.post)
                });
            }        
          } 
        }
        if($scope.post.upvote == '10' && $scope.post.notiupvote == '2'){
          console.log("10 upvote")
          if($scope.post.postTipo == "normal"){
            if($scope.user.iduser != $scope.post.iduser){
              $scope.pushnoti = {};
              $scope.msg =  "10 upvotes!! Isso que é ser popular no meu colégio";
              $http.post('https://ec2.diwoapp.com.br/notificacriador.php', {notificacao :$scope.msg , 
                    idevento : $scope.post.idposts,
                    nomeevento : $scope.post.postTitulo,
                    id_user_envia : $scope.user.iduser,
                    username_envia : $scope.user.username,
                    apelido_envia : $scope.user.apelido,
                    tipo : '401',
                    id_user_recebe : $scope.post.iduser});
                EventoService.getusuario2($scope.post.username).then(function(user) {
                  if(user.notipost== '1'){
                  $scope.pushnoti.titulo = $scope.post.postTitulo;
                  $scope.pushnoti.msg = $scope.msg;
                  $scope.pushnoti.token = user.devicetoken;
                   EventoService.MandaPushNoti($scope.pushnoti);
                 }
                       $scope.post.notiupvote = '3';
                   EventoService.PostNotiUpvote($scope.post)
                });
            }        
          } 
        }
        var link = 'https://ec2.diwoapp.com.br/upvotetablecoment.php';
                $http.post(link, {
                idposts : $scope.post.idposts,
                postscomentario: 'upvote',
                iduser:$scope.user.iduser,
                username :$scope.user.username,
                apelido: $scope.user.apelido,
                profilepic:$scope.user.profilepic,
                devicetoken:$scope.user.devicetoken,
                datadecriacao :$scope.datadecriacao,
                estado : 1}).then(function (res){
                $scope.responsecriado = res.data;
                console.log(res.data.success, "criou");
                  if ($scope.responsecriado.success == true) {
                    $scope.podevotar = false;
                    if(!$scope.podedownvotar){
                      $scope.post.downvote = parseInt($scope.post.downvote) - 1;
                      var link = 'https://ec2.diwoapp.com.br/tiradownvotetablecoment.php';
                      $http.post(link, {
                          idposts : $scope.post.idposts,
                          iduser:$scope.user.iduser
                         }).then(function (res){
                          $scope.responsecriado = res.data;
                              console.log(res.data, "tiradownupvotetablecoment");
                            if ($scope.responsecriado == "Record deleted successfully") {
                              $scope.podedownvotar = true;
                              EventoService.PostUpvote($scope.post);
                            }
                      });
                    }
                    EventoService.PostUpvote($scope.post);
                  }
            });
  }
  $scope.downvote =  function(){
      var agora = new Date(); 
      var curr_date = (agora.getDate()<10?'0':'') + agora.getDate();
      var curr_month = (agora.getMonth()<9?'0':'') + (agora.getMonth() + 1); //Months are zero based
      var curr_year = agora.getFullYear();
      var h2 = (agora.getHours()<10?'0':'') + agora.getHours();
      var m2 = (agora.getMinutes()<10?'0':'') + agora.getMinutes();
      var s2 = (agora.getSeconds()<10?'0':'') + agora.getSeconds();
      var j = curr_year + "-" + curr_month + "-" + curr_date+ ' '+h2 + ':' + m2 + ':' + s2;
      $scope.datadecriacao = j;
        $scope.post.downvote = parseInt($scope.post.downvote) + 1;
        console.log($scope.post.downvote)
        var link = 'https://ec2.diwoapp.com.br/upvotetablecoment.php';
                $http.post(link, {
                idposts : $scope.post.idposts,
                postscomentario: 'downvote',
                iduser:$scope.user.iduser,
                username :$scope.user.username,
                apelido: $scope.user.apelido,
                profilepic:$scope.user.profilepic,
                devicetoken:$scope.user.devicetoken,
                datadecriacao :$scope.datadecriacao,
                estado : 2}).then(function (res){
                $scope.responsecriado = res.data;
                console.log(res.data.success, "criou");
                  if ($scope.responsecriado.success == true) {
                    console.log($scope.podedownvotar, "$scope.podedownvotar", $scope.podevotar)
                    $scope.podedownvotar = false;
                    if(!$scope.podevotar){
                        $scope.post.upvote = parseInt($scope.post.upvote) - 1;
                        var link = 'https://ec2.diwoapp.com.br/tiraupvotetablecoment.php';
                                  $http.post(link, {
                                  idposts : $scope.post.idposts,
                                  iduser:$scope.user.iduser
                                 }).then(function (res){
                                  $scope.responsecriado = res.data;
                                      console.log(res.data, "criou");
                                    if ($scope.responsecriado == "Record deleted successfully") {
                                      $scope.podevotar = true;
                                      EventoService.PostUpvote($scope.post);
                                    }
                              });
                    }
                    EventoService.PostUpvote($scope.post);
                  }
            });
  }
  $scope.tiradownupvote =  function(){
     $scope.post.downvote = parseInt($scope.post.downvote) - 1;
      var link = 'https://ec2.diwoapp.com.br/tiradownvotetablecoment.php';
                $http.post(link, {
                idposts : $scope.post.idposts,
                iduser:$scope.user.iduser
               }).then(function (res){
                $scope.responsecriado = res.data;
                    console.log(res.data, "criou");
                  if ($scope.responsecriado == "Record deleted successfully") {
                    $scope.podedownvotar = true;
                    EventoService.PostUpvote($scope.post);
                  }
            });
  }
  $scope.tiraupvote =  function(){
     $scope.post.upvote = parseInt($scope.post.upvote) - 1;
      var link = 'https://ec2.diwoapp.com.br/tiraupvotetablecoment.php';
                $http.post(link, {
                idposts : $scope.post.idposts,
                iduser:$scope.user.iduser
               }).then(function (res){
                $scope.responsecriado = res.data;
                    console.log(res.data, "criou");
                  if ($scope.responsecriado == "Record deleted successfully") {
                    $scope.podevotar = true;
                    EventoService.PostUpvote($scope.post);
                  }
            });
  }
  $scope.naosilencia =  function(){
    $scope.post.postTipo = 'normal'
    EventoService.PostSilencia($scope.post);
    $scope.som = true;
    $scope.silencio = false;
  }
  $scope.silencia =  function(){
    $scope.post.postTipo = 'silenciado'
    EventoService.PostSilencia($scope.post);
    $scope.som = false;
    $scope.silencio = true;
  }
  $scope.deletapost =  function(){
    var confirmPopup = $ionicPopup.show({
                   title: 'ლ(｡-﹏-｡ ლ)',
                   template: 'Deseja deletar esse post?',
                   buttons: [
                      { text: 'Não',
                        type: 'button-positive'},
                      {
                        text: 'Sim',
                        type: 'button-assertive',
                        onTap: function(e){
                          $scope.post.postEstado = 1;
                          $scope.post.postTipo = 'silenciado'
                            EventoService.DeletaPost($scope.post).then(function (resp){
                              if(resp){
                                $http.post('https://ec2.diwoapp.com.br/gastapontospessoaevento.php', {idevento : -100,
                                                        iduser : $scope.user.iduser,
                                                        borda : '0',
                                                        username: $scope.user.username,
                                                        apelido : $scope.user.apelido,
                                                        nomeevento :  "DEleteou post", 
                                                        estado : 10,
                                                        pontos: -1});
                                $scope.atualiza = {};
                                var po = $scope.user.pontos.valueOf()-1;
                                $scope.atualiza.pontos = po;
                                $scope.atualiza.iduser = $scope.user.iduser;
                                EventoService.atualizarpontos($scope.atualiza);
                                $state.go('tabsController.meuspost');
                              }
                            });
                        }
                      }]})
  }


  $scope.enterPerfil =  function(){
    formOutro.updateForm($scope.post);
    //console.log(item.iduser);
    formvimdofiltroperfil.updateForm(false);

    $state.go('tabsController.perfilPost');
  }
  $scope.enterPerfilComentario =  function(item){
    formOutro.updateForm(item);
    //console.log(item.iduser);
    formvimdofiltroperfil.updateForm(false);
    $state.go('tabsController.perfilPost');
  }

  $scope.reportar = function(){
    $scope.reportmsg = '';
    $scope.report = [
      { text: "Conteúdo impróprio", checked: false },
      { text: "Linguajar inadequado", checked: false },
      { text: "Discurso de ódio", checked: false },
      { text: "Imagem imprópria", checked: false },
      { text: "Substancias ilicitas ", checked: false }
    ];
    $ionicPopup.confirm({
        title: 'Você quer reportar esse post pq?',
        content: '<ion-checkbox ng-repeat="item in report" style="color: #FCFCFC;" ng-model="item.checked"  ng-checked="item.checked">{{item.text}}</ion-checkbox>',
        scope: $scope
    }).then(function(res) {
        if(res) {
          for (var h=0;h<3;h++){
            if($scope.report[h].checked){
              $scope.reportmsg = $scope.reportmsg + $scope.report[h].text + ' ';
            }
          }
          if(h==3){
            console.log($scope.reportmsg);
            $http.post('https://ec2.diwoapp.com.br/reportaevento.php', {namereportado : $scope.post.username,
                                                                            reportadoid : $scope.post.iduser,
                                                                            iduserreportando : $scope.aux.iduser,
                                                                            usernamereportando : $scope.aux.username,
                                                                            tiporeport : 'post',
                                                                            motivo : $scope.reportmsg}).then(function (tes){
              $scope.response = tes.data;
              var alertPopup = $ionicPopup.alert({
                                        title: 'Obrigado',
                                        template: 'Este post esta agora sobre avaliação, obrigado por manter a plataforma organizada'
              });
            });
          }
        }
    });
  }
  $scope.comentar =  function(comentario){
    if(comentario){
      var agora = new Date(); 
      var curr_date = (agora.getDate()<10?'0':'') + agora.getDate();
      var curr_month = (agora.getMonth()<9?'0':'') + (agora.getMonth() + 1); //Months are zero based
      var curr_year = agora.getFullYear();
      var h2 = (agora.getHours()<10?'0':'') + agora.getHours();
      var m2 = (agora.getMinutes()<10?'0':'') + agora.getMinutes();
      var s2 = (agora.getSeconds()<10?'0':'') + agora.getSeconds();
      var j = curr_year + "-" + curr_month + "-" + curr_date+ ' '+h2 + ':' + m2 + ':' + s2;
      $scope.datadecriacao = j;

     var link = 'https://ec2.diwoapp.com.br/comentarpost.php';
                $http.post(link, {
                idposts : $scope.post.idposts,
                postscomentario: comentario,
                iduser:$scope.user.iduser,
                username :$scope.user.username,
                apelido: $scope.user.apelido,
                profilepic:$scope.user.profilepic,
                devicetoken:$scope.user.devicetoken,
                datadecriacao :$scope.datadecriacao, 
                estado : 0}).then(function (res){
                    $scope.responsecriado = res.data;
                  if ($scope.responsecriado.success == true) {
                    $scope.items =[];
                 
                    console.log(res.data.success, "$scope.comentario");
                    EventoService.PostDataAcao($scope.post.idposts);
                      $scope.postaux.idposts = $scope.post.idposts;
                      $scope.postaux.iduser = $scope.user.iduser;
                    EventoService.GetComentarioPost($scope.postaux).then(function(item) {
                      console.log(item, "GetComentarioPost")
                            if (item!='Error'&&item!='E') {
                              $scope.vazio = false;
                              $scope.items = item.concat($scope.items);
                            }else{
                              $scope.vazio = true;
                              $scope.items =[];
                            }
                          });
                  }
            });

        if($scope.post.postTipo == "normal"){
          var noti = {};
          noti.recebeusername = $scope.post.username;
          noti.recebe = $scope.post.iduser;
          noti.envia = $scope.user.iduser;
          noti.tipo = 400;
          noti.nomeevento = $scope.post.postTitulo;
          EventoService.VerificaNotificacao(noti).then(function(res) {
          if(res){
            if($scope.user.iduser != $scope.post.iduser){
              $scope.pushnoti = {};
              $scope.msg =  "Alguem comentou no seu post: " + $scope.post.postTitulo;
              $http.post('https://ec2.diwoapp.com.br/notificacriador.php', {notificacao :$scope.msg , 
                  idevento : $scope.post.idposts,
                  nomeevento : $scope.post.postTitulo,
                  id_user_envia : $scope.user.iduser,
                  username_envia : $scope.user.username,
                  apelido_envia : $scope.user.apelido,
                  tipo : '400',
                  id_user_recebe : $scope.post.iduser});
              EventoService.getusuario2($scope.post.username).then(function(user) {
                if(user.notipost== '1'){
                $scope.pushnoti.titulo = $scope.post.postTitulo;
                $scope.pushnoti.msg = $scope.user.username + " comentou o seu post";
                $scope.pushnoti.token = user.devicetoken;
                EventoService.MandaPushNoti($scope.pushnoti);
              }
              });
            } 
          }
          });       
       } 
    }
    delete $scope.data.comentario; 
  }

}])

.controller('bairromanutencaoCtrl', ['$scope', '$state', '$stateParams','$ionicPopup', '$ionicTabsDelegate','formUser','formMeusPost','formvimdofiltroperfil', 'formPost', 'EventoService', '$http', '$ionicPopup', 'formvimdopost', 'formOutro','formPost','formLimiteatuacao', '$cordovaCamera', '$cordovaFile', '$cordovaFileTransfer', '$cordovaDevice','$cordovaBarcodeScanner','formPagSeguro',  //nstructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $state, $stateParams,$ionicPopup,$ionicTabsDelegate, formUser,formMeusPost,formvimdofiltroperfil, formPost, EventoService, $http, $ionicPopup, formvimdopost, formOutro, formPost,formLimiteatuacao, $cordovaCamera, $cordovaFile, $cordovaFileTransfer, $cordovaDevice, $cordovaBarcodeScanner, formPagSeguro) {



  // $scope.teste = function(){
  //   EventoService.PagSeguroTests().then(function(response){
  //     console.log(response);
  //     PagSeguroDirectPayment.setSessionId(response);
  //     PagSeguroDirectPayment.getPaymentMethods({
  //         amount: 500.00,
  //         success: function(response) {
  //             // Retorna os meios de pagamento disponíveis.
  //             //console.log("sucesso", JSON.stringify(response))
  //             formPagSeguro.updateForm(response)
  //             $state.go('tabsController.PagSeguroMetodo')
  //         },
  //         error: function(response) {
  //           //console.log("error", JSON.stringify(response))
  //             // Callback para chamadas que falharam.
  //         },
  //         complete: function(response) {
  //           //console.log("complete", JSON.stringify(response))
  //           //formPagSeguro.updateForm(response)
  //           //$state.go('tabsController.PagSeguroMetodo')
  //             // Callback para todas chamadas.
  //         }
  //       });
  //   })
  // }

}])

.controller('bairronbatecodeCtrl', ['$scope', '$state', '$stateParams','$ionicPopup', '$ionicTabsDelegate','formUser','formMeusPost','formvimdofiltroperfil', 'formPost', 'EventoService', '$http', '$ionicPopup', 'formvimdopost', 'formOutro','formPost','formLimiteatuacao', '$cordovaCamera', '$cordovaFile', '$cordovaFileTransfer', '$cordovaDevice','$cordovaBarcodeScanner',  //nstructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $state, $stateParams,$ionicPopup,$ionicTabsDelegate, formUser,formMeusPost,formvimdofiltroperfil, formPost, EventoService, $http, $ionicPopup, formvimdopost, formOutro, formPost,formLimiteatuacao, $cordovaCamera, $cordovaFile, $cordovaFileTransfer, $cordovaDevice, $cordovaBarcodeScanner) {
  $scope.entrarBairro = function(){ 
    $scope.user = formUser.getForm();
    $scope.user.numeroendereco = '';
    $scope.user.estadoendereco = '';
    $scope.user.complemento = '';
    $scope.user.bairro = '';
    $scope.user.cidade = '';
    $scope.user.endereco = '';
    $scope.user.diapedebairro = '';
    EventoService.atualizaendereco($scope.user).then(function(msg){
      formUser.updateForm($scope.user);
      $state.go('tabsController.bairrocadastra')
    });
  }

}])

.controller('bairroapresentaCtrl', ['$scope', '$state', '$stateParams','$ionicPopup', '$ionicTabsDelegate','formUser','formMeusPost','formvimdofiltroperfil', 'formPost', 'EventoService', '$http', '$ionicPopup', 'formvimdopost', 'formOutro','formPost','formLimiteatuacao', '$cordovaCamera', '$cordovaFile', '$cordovaFileTransfer', '$cordovaDevice', '$cordovaBarcodeScanner',  //nstructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $state, $stateParams,$ionicPopup,$ionicTabsDelegate, formUser,formMeusPost,formvimdofiltroperfil, formPost, EventoService, $http, $ionicPopup, formvimdopost, formOutro, formPost,formLimiteatuacao, $cordovaCamera, $cordovaFile, $cordovaFileTransfer, $cordovaDevice, $cordovaBarcodeScanner) {
  $scope.user =formUser.getForm();
  var codigovalido = 0;
  $scope.validarQRCODE =  window.localStorage.getItem( 'validarQRCODE' );
  //alert($scope.validarQRCODE)
  if($scope.validarQRCODE){
    if($scope.validarQRCODE == $scope.user.codigodevalidacaodebairro){
      $scope.user.enderecovalidado = 'confirmado';
      EventoService.validacontabairro($scope.user);
      window.localStorage.removeItem('validarQRCODE')
      EventoService.GetusersBairroLiberado($scope.user).then(function(resp){
        if(resp!='E'&&resp!='Error'){
          $scope.auxusersbairro = resp;
          for(var i = 0 ; i <resp.length ; i++){
            if($scope.auxusersbairro[i].enderecovalidado == 'confirmado'){
              codigovalido++;
            }
          }
          if(codigovalido>=5){
            console.log("fasn")
            $state.go('tabsController.meubairro')
          }else{
            $state.go('tabsController.bairrosemgente')
          }
        }else{
          $state.go('tabsController.bairrosemgente')
        }
      })
    }else{
      $state.go('tabsController.bairronbatecode')
      window.localStorage.removeItem( 'validarQRCODE' );
    }
  }
  
  $scope.ValidarQR = function(){ 
    
    $cordovaBarcodeScanner.scan().then(function(barcodeData) {
     
      alert(barcodeData); 
    }, function(error) {
    });

    // cordova.plugins.barcodeScanner.scan().then(function(barcodeData) {
    //   alert("cordova.plugins.barcodeScanner"); 
    //   alert(barcodeData); 
    // });
  }
  $scope.$on("$ionicView.enter", function(event, data){
    $scope.user =formUser.getForm();
    var codigovalido = 0;
    $scope.validarQRCODE =  window.localStorage.getItem( 'validarQRCODE' );
    //alert($scope.validarQRCODE)
    if($scope.validarQRCODE){
      if($scope.validarQRCODE == $scope.user.codigodevalidacaodebairro){
        $scope.user.enderecovalidado = 'confirmado';
        EventoService.validacontabairro($scope.user);
        window.localStorage.removeItem('validarQRCODE')
        EventoService.GetusersBairroLiberado($scope.user).then(function(resp){
          if(resp!='E'&&resp!='Error'){
            $scope.auxusersbairro = resp;
            for(var i = 0 ; i <resp.length ; i++){
              if($scope.auxusersbairro[i].enderecovalidado == 'confirmado'){
                codigovalido++;
              }
            }
            if(codigovalido>=5){
              console.log("fasn")
              $state.go('tabsController.meubairro')
            }else{
              $state.go('tabsController.bairrosemgente')
            }
          }else{
            $state.go('tabsController.bairrosemgente')
          }
        })
      }else{
        $state.go('tabsController.bairronbatecode')
        window.localStorage.removeItem( 'validarQRCODE' );
      }
    }

    if($scope.user.bairro){
      if($scope.user.enderecovalidado){
        EventoService.GetusersBairroLiberado($scope.user).then(function(resp){
          if(resp!='E'&&resp!='Error'){
            $scope.auxusersbairro = resp;
            for(var i = 0 ; i <resp.length ; i++){
              if($scope.auxusersbairro[i].enderecovalidado){
                codigovalido++;
              }
            }
            if(codigovalido>=5){
              $state.go('tabsController.meubairro')
            }else{
              $state.go('tabsController.bairrosemgente')
            }
          }else{
            $state.go('tabsController.bairrosemgente')
          }
        })
      }else{
        $state.go('tabsController.bairroendereconaoconfirmado')
      }
    }
    
  });

  $scope.entrarBairro = function(){ 
    $state.go('tabsController.bairrocadastra')
  }

}])

.controller('bairrocadastraCtrl', ['$scope', '$state', '$stateParams','$ionicPopup', '$ionicTabsDelegate','formUser','formMeusPost','formvimdofiltroperfil', 'formPost', 'EventoService', '$http', '$ionicPopup', 'formvimdopost', 'formOutro','formPost','formLimiteatuacao', '$cordovaCamera', '$cordovaFile', '$cordovaFileTransfer', '$cordovaDevice','$cordovaBarcodeScanner',  //nstructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $state, $stateParams,$ionicPopup,$ionicTabsDelegate, formUser,formMeusPost,formvimdofiltroperfil, formPost, EventoService, $http, $ionicPopup, formvimdopost, formOutro, formPost,formLimiteatuacao, $cordovaCamera, $cordovaFile, $cordovaFileTransfer, $cordovaDevice, $cordovaBarcodeScanner) {


  $scope.disableTap = function(){
     container = document.getElementsByClassName('pac-container');
     // disable ionic data tab
     angular.element(container).attr('data-tap-disabled', 'true');
     // leave input field if google-address-entry is selected
     angular.element(container).on("click", function(){
                                   document.getElementById('searchTextField').blur();
                                   });
  };
    
  var input = document.getElementById('searchTextField');
  var autocomplete = new google.maps.places.Autocomplete(input);
     
  $scope.cidade = autocomplete.getPlace();

  $scope.user =formUser.getForm();
    var geocoder = new google.maps.Geocoder();
  $scope.ValidarEndereco = function(){ 
    $scope.cidade = autocomplete.getPlace();
    if($scope.cidade){
      for(var i = 0;i<$scope.cidade.address_components.length;i++){
        //console.log($scope.cidade.address_components[i].types[0] , i , $scope.cidade.address_components[i].long_name)
        if($scope.cidade.address_components[i].types[0] == "administrative_area_level_1"){
          $scope.user.estadoendereco = $scope.cidade.address_components[i].short_name;
        }
        if($scope.cidade.address_components[i].types[0] == "administrative_area_level_2"){
          $scope.user.cidade = $scope.cidade.address_components[i].long_name;
        }
        if($scope.cidade.address_components[i].types[0] == "sublocality_level_1"){
          $scope.user.bairro = $scope.cidade.address_components[i].long_name;
        }
        if($scope.cidade.address_components[i].types[0] == "route"){
          $scope.user.endereco = $scope.cidade.address_components[i].long_name;
        }
        if($scope.cidade.address_components[i].types[0] == "postal_code"){
          $scope.user.cep = $scope.cidade.address_components[i].long_name;
          console.log($scope.user.cep, "scope.user.cep")
        }
        
        // if($scope.cidade.address_components[i].types[0] == "country"){
        //   $scope.user.pais = $scope.cidade.address_components[i].long_name;
        // }
      }
      if(i==$scope.cidade.address_components.length){
        var auxendereco =  $scope.user.endereco + ', '+ $scope.user.numeroendereco + ', '+$scope.user.cidade+ ', '+$scope.user.estadoendereco
       console.log(auxendereco, "auxendereco")
        geocoder.geocode({'address': auxendereco}, function(results, status) {
          if (status === 'OK') {
            if (results[0]) {
              
              console.log(results[0],"results[0]")
              $scope.cidade = results[0];
              for(var j = 0;j<$scope.cidade.address_components.length;j++){
                //console.log($scope.cidade.address_components[i].types[0] , i , $scope.cidade.address_components[i].long_name)
                if($scope.cidade.address_components[j].types[0] == "administrative_area_level_1"){
                  $scope.user.estadoendereco = $scope.cidade.address_components[j].short_name;
                }
                if($scope.cidade.address_components[j].types[0] == "administrative_area_level_2"){
                  $scope.user.cidade = $scope.cidade.address_components[j].long_name;
                }
                if($scope.cidade.address_components[j].types[0] == "sublocality_level_1"){
                  $scope.user.bairro = $scope.cidade.address_components[j].long_name;
                }
                if($scope.cidade.address_components[j].types[0] == "route"){
                  $scope.user.endereco = $scope.cidade.address_components[j].long_name;
                }
                if($scope.cidade.address_components[j].types[0] == "postal_code"){
                  $scope.user.cep = $scope.cidade.address_components[j].long_name;
                  //console.log($scope.user.cep, "scope.user.cep")
                }
              }
              console.log("Aqui")
              if(j==$scope.cidade.address_components.length){

                formUser.updateForm($scope.user);
                $state.go('tabsController.bairroconfirma')
              }
            } else {
              window.alert('No results found');
            }
          } else {
            window.alert('Geocoder failed due to: ' + status);
          }
        });
       
      }
      
    }
  }

  $scope.enderecopq = function(){ 
    $state.go('tabsController.bairroinfo')
  }

}])

.controller('bairroinfoCtrl', ['$scope', '$state', '$stateParams','$ionicPopup', '$ionicTabsDelegate','formUser','formMeusPost','formvimdofiltroperfil', 'formPost', 'EventoService', '$http', '$ionicPopup', 'formvimdopost', 'formOutro','formPost','formLimiteatuacao', '$cordovaCamera', '$cordovaFile', '$cordovaFileTransfer', '$cordovaDevice','$cordovaBarcodeScanner',  //nstructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $state, $stateParams,$ionicPopup,$ionicTabsDelegate, formUser,formMeusPost,formvimdofiltroperfil, formPost, EventoService, $http, $ionicPopup, formvimdopost, formOutro, formPost,formLimiteatuacao, $cordovaCamera, $cordovaFile, $cordovaFileTransfer, $cordovaDevice, $cordovaBarcodeScanner) {

   $scope.termos = function(){ 
     window.location.href = "http://diwoapp.com.br/termos-de-uso/";
  }

}])

.controller('bairrosemgenteCtrl', ['$scope', '$state', '$stateParams','$ionicPopup', '$ionicTabsDelegate','formUser','formMeusPost','formvimdofiltroperfil', 'formPost', 'EventoService', '$http', '$ionicPopup', 'formvimdopost', 'formOutro','formPost','formLimiteatuacao', '$cordovaCamera', '$cordovaFile', '$cordovaFileTransfer', '$cordovaDevice','$cordovaSocialSharing',  //nstructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $state, $stateParams,$ionicPopup,$ionicTabsDelegate, formUser,formMeusPost,formvimdofiltroperfil, formPost, EventoService, $http, $ionicPopup, formvimdopost, formOutro, formPost,formLimiteatuacao, $cordovaCamera, $cordovaFile, $cordovaFileTransfer, $cordovaDevice, $cordovaSocialSharing) {
  $scope.user =formUser.getForm();
  var codigovalido = 0;
  EventoService.GetusersBairroLiberado($scope.user).then(function(resp){
    if(resp!='E'&&resp!='Error'){
      $scope.auxusersbairro = resp;
      for(var i = 0 ; i <resp.length ; i++){
        if($scope.auxusersbairro[i].enderecovalidado){
          console.log($scope.auxusersbairro[i].enderecovalidado , '')
          codigovalido++;
        }
      }
      $scope.pessoasnobairro = 5-codigovalido;
    }else{
      $scope.pessoasnobairro = 5;
    }
  })

  $scope.compartilhawhats = function(){ 
    $scope.msgshare = "Ajude seu bairro a se tornar mais unido, envie uma msg para o nº abaixo para saber como!" ;
    $scope.linkevento = "wa.me/554791896814";
    $cordovaSocialSharing.canShareVia('whatsapp', $scope.msgshare, '', 'http://diwoapp.com.br/politica-de-privacidade/').then(function(result) {
      $cordovaSocialSharing.shareViaWhatsApp($scope.msgshare, '' , $scope.linkevento) ;
      }, function(error) {
          alert("Cannot share on whatsapp");
    });
  }

}])

.controller('bairroconfirmaCtrl', ['$scope', '$state', '$stateParams','$ionicPopup', '$ionicTabsDelegate','formUser','formMeusPost','formvimdofiltroperfil', 'formPost', 'EventoService', '$http', '$ionicPopup', 'formvimdopost', 'formOutro','formPost','formLimiteatuacao', '$cordovaCamera', '$cordovaFile', '$cordovaFileTransfer', '$cordovaDevice','$cordovaBarcodeScanner',  //nstructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $state, $stateParams,$ionicPopup,$ionicTabsDelegate, formUser,formMeusPost,formvimdofiltroperfil, formPost, EventoService, $http, $ionicPopup, formvimdopost, formOutro, formPost,formLimiteatuacao, $cordovaCamera, $cordovaFile, $cordovaFileTransfer, $cordovaDevice, $cordovaBarcodeScanner) {
  $scope.user =formUser.getForm();

  var agora = new Date(); 
  var curr_date = (agora.getDate()<10?'0':'') + agora.getDate();
  var curr_month = (agora.getMonth()<9?'0':'') + (agora.getMonth() + 1); //Months are zero based
  var curr_year = agora.getFullYear();
  var h2 = (agora.getHours()<10?'0':'') + agora.getHours();
  var m2 = (agora.getMinutes()<10?'0':'') + agora.getMinutes();
  var s2 = (agora.getSeconds()<10?'0':'') + agora.getSeconds();
  var j = curr_year + "-" + curr_month + "-" + curr_date+ ' '+h2 + ':' + m2 + ':' + s2;
  $scope.diadehj = j;
  var codigovalido = 0;
  var auxcodigo 
  $scope.Confirmar = function(){
    EventoService.GetusersBairroLiberado($scope.user).then(function(resp){
      if(resp!='E'&&resp!='Error'){
        
        $scope.auxusersbairro = resp;
        console.log($scope.auxusersbairro.length)
        for(var i = 0 ; i <resp.length ; i++){
          console.log($scope.auxusersbairro[i].codigodevalidacaodebairro, "$scope.auxusersbairro[i].codigodevalidacaodebairro")
          if($scope.auxusersbairro[i].enderecovalidado){
            codigovalido++;
            
            console.log(codigovalido,"codigovalido++;")
          }
          if($scope.auxusersbairro[i].codigodevalidacaodebairro!=''){
            auxcodigo = $scope.auxusersbairro[i].codigodevalidacaodebairro;
          }
        }
        console.log(codigovalido,"codigovalido")
        if(codigovalido>=20){
          if(codigovalido%20==0){
            $scope.aux = ($scope.user.iduser + $scope.user.cidade+ $scope.user.bairro + $scope.diadehj).toString();
            var encrypted = CryptoJS.AES.encrypt($scope.aux, "Diwo bairro");
            $scope.user.codigodevalidacaodebairro = encrypted.toString();
            $scope.user.diapedebairro = $scope.diadehj; 
            EventoService.atualizaendereco($scope.user).then(function(msg){
              formUser.updateForm($scope.user);
              window.localStorage.setItem( 'bairrook', 'naofoi');
              $state.go('tabsController.bairrosolicitado')   
            });
          }else{
            $scope.user.codigodevalidacaodebairro = $scope.auxusersbairro[codigovalido-20].codigodevalidacaodebairro; 
            $scope.user.diapedebairro = $scope.diadehj; 
            EventoService.atualizaendereco($scope.user).then(function(msg){
              formUser.updateForm($scope.user);
              window.localStorage.setItem( 'bairrook', 'naofoi');
              $state.go('tabsController.bairrosolicitado')   
            });
          }
        }else{
          console.log($scope.auxusersbairro[0].codigodevalidacaodebairro,"$scope.auxusersbairro[0].codigodevalidacaodebairro")
          
          if($scope.auxusersbairro[0].codigodevalidacaodebairro!=''){
            $scope.user.codigodevalidacaodebairro = $scope.auxusersbairro[0].codigodevalidacaodebairro
          }else{
            $scope.user.codigodevalidacaodebairro = auxcodigo;
          }
          $scope.user.diapedebairro = $scope.diadehj; 
          EventoService.atualizaendereco($scope.user).then(function(msg){
            formUser.updateForm($scope.user);
            window.localStorage.setItem( 'bairrook', 'naofoi');
            $state.go('tabsController.bairrosolicitado')   
          });
        }
      }else{
        $scope.aux = ($scope.user.iduser + $scope.user.cidade + $scope.user.bairro + $scope.diadehj).toString();
        var encrypted = CryptoJS.AES.encrypt($scope.aux, "Diwo bairro");
        console.log(encrypted.toString(),"encrypted")
        //var dencrypted = CryptoJS.AES.decrypt(encrypted.toString(), "Diwo bairro");
        //console.log(dencrypted.toString(),"dedas")
        $scope.user.codigodevalidacaodebairro = encrypted.toString();
        $scope.user.diapedebairro = $scope.diadehj; 
        EventoService.atualizaendereco($scope.user).then(function(msg){
          formUser.updateForm($scope.user);
          window.localStorage.setItem( 'bairrook', 'naofoi');
          $state.go('tabsController.bairrosolicitado')   
        });
        
        //$scope.user.codigodevalidacaodebairro = $scope.user.codigodevalidacaodebairro.toString(CryptoJS.enc.Utf8);
      }
      //console.log( $scope.user.codigodevalidacaodebairro," $scope.user.codigodevalidacaodebairro")
      
    })
  
    
  }

  $scope.mudaendereco = function(){ 
    $scope.user.endereco = '';
    formUser.updateForm($scope.user);
    $state.go('tabsController.bairrocadastra')
  }

}])

.controller('bairrosolicitadoCtrl', ['$scope', '$state', '$stateParams','$ionicPopup', '$ionicTabsDelegate','formUser','formMeusPost','formvimdofiltroperfil', 'formPost', 'EventoService', '$http', '$ionicPopup', 'formvimdopost', 'formOutro','formPost','formLimiteatuacao', '$cordovaCamera', '$cordovaFile', '$cordovaFileTransfer', '$cordovaDevice','$cordovaSocialSharing',  //nstructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $state, $stateParams,$ionicPopup,$ionicTabsDelegate, formUser,formMeusPost,formvimdofiltroperfil, formPost, EventoService, $http, $ionicPopup, formvimdopost, formOutro, formPost,formLimiteatuacao, $cordovaCamera, $cordovaFile, $cordovaFileTransfer, $cordovaDevice, $cordovaSocialSharing) {

  $scope.compartilhawhats = function(){ 
    $scope.msgshare = "Ajude seu bairro a se tornar mais unido, envie uma msg para o nº abaixo para saber como!" ;
    $scope.linkevento = "wa.me/554791896814";
    $cordovaSocialSharing.canShareVia('whatsapp', $scope.msgshare, '', 'http://diwoapp.com.br/politica-de-privacidade/').then(function(result) {
      $cordovaSocialSharing.shareViaWhatsApp($scope.msgshare, '' , $scope.linkevento) ;
      }, function(error) {
          alert("Cannot share on whatsapp");
    });
  }
  $scope.$on('$destroy', function() {
     $state.go('tabsController.bairroapresenta')
  });
  $scope.$on("$ionicView.leave", function(event, data){
      window.localStorage.setItem( 'bairrook', 'foi');
  });
  $scope.$on("$ionicView.enter", function(event, data){
    $scope.bairrook = window.localStorage.getItem( 'bairrook' );
    if( $scope.bairrook == 'foi'){
      
      $state.go('tabsController.bairroapresenta')
    }
  });
  
}])
.controller('bairroendereconaoconfirmadoCtrl', ['$scope', '$state', '$stateParams','$ionicPopup', '$ionicTabsDelegate','formUser','formMeusPost','formvimdofiltroperfil', 'formPost', 'EventoService', '$http', '$ionicPopup', 'formvimdopost', 'formOutro','formPost','formLimiteatuacao', '$cordovaCamera', '$cordovaFile', '$cordovaFileTransfer', '$cordovaDevice','$cordovaBarcodeScanner',  //nstructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $state, $stateParams,$ionicPopup,$ionicTabsDelegate, formUser,formMeusPost,formvimdofiltroperfil, formPost, EventoService, $http, $ionicPopup, formvimdopost, formOutro, formPost,formLimiteatuacao, $cordovaCamera, $cordovaFile, $cordovaFileTransfer, $cordovaDevice, $cordovaBarcodeScanner) {
  
}])

.controller('meubairroCtrl', ['$scope', '$state', '$stateParams','$ionicPopup', '$ionicTabsDelegate','formUser','formMeusPost','formvimdofiltroperfil', 'formPost', 'EventoService', '$http', '$ionicPopup', 'formvimdopost', 'formOutro','formPost','formLimiteatuacao', '$cordovaCamera', '$cordovaFile', '$cordovaFileTransfer', '$cordovaDevice', '$ionicLoading','$ionicScrollDelegate',  //nstructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $state, $stateParams,$ionicPopup,$ionicTabsDelegate, formUser,formMeusPost,formvimdofiltroperfil, formPost, EventoService, $http, $ionicPopup, formvimdopost, formOutro, formPost,formLimiteatuacao, $cordovaCamera, $cordovaFile, $cordovaFileTransfer, $cordovaDevice, $ionicLoading, $ionicScrollDelegate) {
  formvimdopost.updateForm(true);
  $scope.posts =[];

  $scope.user =formUser.getForm();


  $scope.getScrollPosition = function(){
    if($ionicScrollDelegate.getScrollPosition().top > 500){
      $ionicTabsDelegate.showBar(0);
    }else{
      $ionicTabsDelegate.showBar(1);
    }
      // console.log("Scroll pos from top: ", $ionicScrollDelegate.getScrollPosition().top)
  }
  

    
  $scope.noMoreItemsAvailable = false;

   var header = document.getElementById("barpost");
    var btns = header.getElementsByClassName("btnpost");
    for (var i = 0; i < btns.length; i++) {
      btns[i].addEventListener("click", function() {
        var current = document.getElementsByClassName("actpost");
        current[0].className = current[0].className.replace(" actpost", "");
        this.className += " actpost";
      });
    }

    EventoService.GetFeedBairro($scope.user).then(function(posts) {
      console.log(posts, "POST")
      //$scope.posts = posts.concat($scope.posts);
      if (posts!='Error'&&posts!='E') {
        console.log("das", posts.length) 
        $scope.vazio = false;
        $scope.posts = posts.concat($scope.posts);
        $scope.npost =0;
        for(var i = 0 ; i<posts.length ; i++){
          //console.log("aqui", posts[i].iduser , $scope.user.iduser)
          if(posts[i].iduser == $scope.user.iduser){
            $scope.meupost = posts[i];
            $scope.npost ++; 
            console.log("aqui", posts[i].iduser , $scope.user.iduser, $scope.meupost)
          }
        }
        if(posts.length ==i){
          formMeusPost.updatePost($scope.meupost);
        }
      }else{
        $scope.vazio = true;
        $scope.posts =[];
      }
    });

  $scope.$on("$ionicView.enter", function(event, data){
    $scope.user =formUser.getForm();
    // $scope.posts =[];
    // $scope.auxpost =[];
    // formvimdopost.updateForm(true);
    $scope.postBar = true;
    $ionicTabsDelegate.showBar(1);
    if($scope.meusmeus){
      $scope.semfeed = false;
      formvimdopost.updateForm(true);
      $scope.postBar = true;
      $scope.items = [];
      $scope.posts = [];
      $scope.centerPoint = {};
      $ionicTabsDelegate.showBar(1);
       EventoService.GetFeedBairro($scope.user).then(function(posts) {
      console.log(posts, "POST")
      //$scope.posts = posts.concat($scope.posts);
      if (posts!='Error'&&posts!='E') {
        console.log("das", posts.length) 
        $scope.vazio = false;
        $scope.posts = posts.concat($scope.posts);
        $scope.npost =0;
        for(var i = 0 ; i<posts.length ; i++){
          //console.log("aqui", posts[i].iduser , $scope.user.iduser)
          if(posts[i].iduser == $scope.user.iduser){
            $scope.meupost = posts[i];
            $scope.npost ++; 
            console.log("aqui", posts[i].iduser , $scope.user.iduser, $scope.meupost)
          }
        }
        if(posts.length ==i){
          formMeusPost.updatePost($scope.meupost);
        }
      }else{
        $scope.vazio = true;
        $scope.posts =[];
      }
    });
    }
  });

  $scope.loadMeuspost =  function(post){
    $scope.meusmeus = true;
    $scope.postBar = false;
    $ionicTabsDelegate.showBar(1);
    EventoService.GetFeedMeusPost($scope.user).then(function(posts) {
      //console.log(posts)
      $scope.posts =[];
      if (posts!='Error'&& posts!='E') {
        $scope.vazio = false;
        $scope.posts = posts.concat($scope.posts);         
      }else{
        $scope.vazio = true;
        $scope.posts =[];
      }
    });

  }

  $scope.enterPost =  function(post){
   
      console.log(post.idposts,"idpost" )
      formPost.updatePost(post);
      $state.go('tabsController.post');

  }
  $scope.deletapost =  function(post){
    console.log(post,"post")
    var confirmPopup = $ionicPopup.show({
                   title: 'ლ(｡-﹏-｡ ლ)',
                   template: 'Deseja deletar esse post?',
                   buttons: [
                      { text: 'Não',
                        type: 'button-positive'},
                      {
                        text: 'Sim',
                        type: 'button-assertive',
                        onTap: function(e){
                          post.postEstado = 1;
                          post.postTipo = 'silenciado'
                            EventoService.DeletaPost(post).then(function (resp){
                              if(resp){
                                $http.post('https://ec2.diwoapp.com.br/gastapontospessoaevento.php', {idevento : -100,
                                                        iduser : $scope.user.iduser,
                                                        borda : '0',
                                                        username: $scope.user.username,
                                                        apelido : $scope.user.apelido,
                                                        nomeevento :  "DEleteou post", 
                                                        estado : 10,
                                                        pontos: -1});
                                $scope.atualiza = {};
                                var po = $scope.user.pontos.valueOf()-1;
                                $scope.atualiza.pontos = po;
                                $scope.atualiza.iduser = $scope.user.iduser;
                                EventoService.atualizarpontos($scope.atualiza);
                                $state.reload();
                              }
                            });
                        }
                      }]})
  }
  $scope.naosilencia =  function(post){
    $scope.auxpost = post;
    $scope.auxpost.postTipo = 'normal'
    post.som = true;
    EventoService.PostSilencia($scope.auxpost);
  }
  $scope.silencia =  function(post){
    $scope.auxpost = post;
    $scope.auxpost.postTipo = 'silenciado'
    post.som = false;
    EventoService.PostSilencia($scope.auxpost);
  }

  $scope.loadPosts = function() {
    $scope.meusmeus = false;
    $scope.noMoreItemsAvailable = false;
    //console.log("indsaudnis")
    $scope.semfeed = false;
    formvimdopost.updateForm(true);
    $scope.postBar = true;
    $scope.items = [];
    $scope.posts = [];
    $scope.centerPoint = {};
    $ionicTabsDelegate.showBar(1);
    EventoService.GetFeedBairro($scope.user).then(function(posts) {
      console.log(posts, "POST")
      //$scope.posts = posts.concat($scope.posts);
      if (posts!='Error'&&posts!='E') {
        console.log("das", posts.length) 
        $scope.vazio = false;
        $scope.posts = posts.concat($scope.posts);
        $scope.npost =0;
        for(var i = 0 ; i<posts.length ; i++){
          //console.log("aqui", posts[i].iduser , $scope.user.iduser)
          if(posts[i].iduser == $scope.user.iduser){
            $scope.meupost = posts[i];
            $scope.npost ++; 
            console.log("aqui", posts[i].iduser , $scope.user.iduser, $scope.meupost)
          }
        }
        if(posts.length ==i){
          formMeusPost.updatePost($scope.meupost);
        }
      }else{
        $scope.vazio = true;
        $scope.posts =[];
      }
    });
   
  }

  $scope.loadMorePostBairro =  function(posts){
    if(!$scope.meusmeus){
      EventoService.GetFeedBairroOld($scope.user).then(function(items) {
        if(items!='E'){
          $scope.posts = posts.concat(items);
          $scope.$broadcast('scroll.infiniteScrollComplete');
          if (items.length <= 14) {
            $scope.noMoreItemsAvailable = true;
          }
        }else{
          $scope.noMoreItemsAvailable = true;
        }
      });
      $scope.$broadcast('scroll.infiniteScrollComplete');
    }
    $scope.noMoreItemsAvailable = true;
    $scope.$broadcast('scroll.infiniteScrollComplete');
  }



  $scope.tempostimage = false;
  $scope.novopost = {};
  $scope.novopost.postImagem = "";


    $scope.takePicture = function() {
      var optionsCamera = {
          quality : 100,
          destinationType : Camera.DestinationType.FILE_URL,
          sourceType : Camera.PictureSourceType.CAMERA,
          allowEdit : true,
          encodingType: Camera.EncodingType.JPEG,
          targetWidth: 640,
          targetHeight: 640,
          popoverOptions: CameraPopoverOptions,
          saveToPhotoAlbum: true
      };

      $cordovaCamera.getPicture(optionsCamera).then(function(imageData) {
          $scope.novopost.postImagem = imageData;
          $scope.tempostimage = true;
          
      }, function(err) {
      });
    }
    $scope.getPicture = function (optionsCamera) {
      var optionsCamera = {
            quality : 100,
            sourceType : 0,
            allowEdit : true,
            targetWidth: 640,
            targetHeight: 640
      };
      $cordovaCamera.getPicture(optionsCamera).then(function(imageData) {
        $scope.novopost.postImagem = imageData;
        $scope.tempostimage = true;
      }, function(err) {
        console.log(err);
      });
    };
    $scope.postar =  function(newpost){
      
      var agora = new Date(); 
      var curr_date = (agora.getDate()<10?'0':'') + agora.getDate();
      var curr_month = (agora.getMonth()<9?'0':'') + (agora.getMonth() + 1); //Months are zero based
      var curr_year = agora.getFullYear();
      var h2 = (agora.getHours()<10?'0':'') + agora.getHours();
      var m2 = (agora.getMinutes()<10?'0':'') + agora.getMinutes();
      var s2 = (agora.getSeconds()<10?'0':'') + agora.getSeconds();
      var j = curr_year + "-" + curr_month + "-" + curr_date+ ' '+h2 + ':' + m2 + ':' + s2;
      $scope.novopost.datadecriacao = j;
      var j2 = curr_year + "-" + curr_month + "-" + curr_date+ ' '+h2 + ':' + m2 ;
      $scope.novopost.auxdatadecriacao = j2;
      if(newpost  && newpost.postTitulo !=undefined && newpost.postTitulo !=null && newpost.postTitulo !=""){
          $ionicLoading.show({
            title: '┗(＾0＾)┓',
            template: '┗(＾0＾)┓'
          });
        if($scope.novopost.postImagem != ""  && $scope.novopost.postImagem != null && $scope.novopost.postImagem != undefined){ 
                $scope.auxfoto = $scope.novopost.postTitulo + $scope.novopost.auxdatadecriacao;
                var mystring = String($scope.auxfoto);
                mystring = mystring.replace(/[^a-zA-Z0-9]/g, '');
                $scope.novopost.postpic = 'https://diwoappprofilepics.s3.amazonaws.com/posts/' + mystring + '.jpg';
              }else{
                $scope.novopost.postpic = "";
              } 
              console.log($scope.user.long, "dqewrqw",$scope.novopost.datadecriacao, $scope.novopost.postTexto, $scope.novopost.postTitulo, $scope.user.apelido)
              var link = 'https://ec2.diwoapp.com.br/criarpostbairro.php';
                $http.post(link, {
                postTitulo :$scope.novopost.postTitulo,
                postTexto:$scope.novopost.postTexto,
                postEstado: 0,
                postTipo:"normal",
                postImagem : $scope.novopost.postpic,
                datadecriacao:$scope.novopost.datadecriacao,
                datadeacao:$scope.novopost.datadecriacao,
                iduser:$scope.user.iduser,
                username :$scope.user.username,
                apelido: $scope.user.apelido,
                profilepic:$scope.user.profilepic,
                deviceToken:$scope.user.devicetoken,
                estadoendereco :$scope.user.estadoendereco,
                cidade :$scope.user.cidade,
                bairro :$scope.user.bairro}).then(function (res){
                    $scope.responsecriado = res.data;
                    console.log(res.data.success, "criou");
                  if ($scope.responsecriado.success == true) {
                    $http.post('https://ec2.diwoapp.com.br/gastapontospessoaevento.php', {idevento : -100,
                                                        iduser : $scope.user.iduser,
                                                        borda : '0',
                                                        username: $scope.user.username,
                                                        apelido : $scope.user.apelido,
                                                        nomeevento :  "Criou post", 
                                                        estado : 10,
                                                        pontos: 1});
                    $scope.atualiza = {};
                    var po = $scope.user.pontos.valueOf()+1;
                    $scope.atualiza.pontos = po;
                    $scope.atualiza.iduser = $scope.user.iduser;
                    EventoService.atualizarpontos($scope.atualiza);
                    $scope.posts =[];
                    EventoService.GetFeedBairro($scope.user).then(function(posts) {
                      //console.log(posts, "POST")
                      //$scope.posts = posts.concat($scope.posts);
                      if (posts!='Error'&&posts!='E') {
                        console.log("das", posts.length) 
                        $scope.vazio = false;
                        $scope.posts = posts.concat($scope.posts);
                        $scope.npost =0;
                        for(var i = 0 ; i<posts.length ; i++){
                          console.log("aqui", posts[i].iduser , $scope.user.iduser)
                          if(posts[i].iduser == $scope.user.iduser){
                            $scope.meupost = posts[i];
                            $scope.npost ++;
                            console.log("aqui", posts[i].iduser , $scope.user.iduser)
                          }
                        }
                        if(posts.length ==i){
                          formMeusPost.updatePost($scope.meupost);
                        }
                      }else{
                        $scope.vazio = true;
                        $scope.posts =[];
                        $scope.meupost = [];
                      }
                    });
                    if($scope.novopost.postImagem != "" && $scope.novopost.postImagem != null && $scope.novopost.postImagem != undefined){
                      $scope.auxfoto = $scope.novopost.postTitulo + $scope.novopost.auxdatadecriacao;
                      var mystring = String($scope.auxfoto);
                      mystring = mystring.replace(/[^a-zA-Z0-9]/g, '');
                      var url = "https://ec2.diwoapp.com.br/uploadfotopost.php";
                                              // File for Upload
                      var targetPath = $scope.novopost.postImagem;
                     
                      // File name only
                      //var name = $scope.imgURI.substr(imageData.lastIndexOf('/') + 1);
                      var filename = mystring + '.jpg';
                      // NO CASO SERIA O NOME DO USUARIO.jpg O fileName
                      var options = {
                        fileKey: "file",
                        fileName: filename,
                        chunkedMode: false,
                        mimeType: "multipart/form-data"
                      };
                      $cordovaFileTransfer.upload(url, targetPath, options).then(function(result) {
                         $ionicLoading.hide();
                         var alertPopup = $ionicPopup.alert({
                          title: 'Parabéns',
                          template: $scope.responsecriado.msg

                        }); 
                        alertPopup.then(function(){
                          $ionicLoading.hide();
                          delete $scope.novopost.postTitulo;
                          delete $scope.novopost.postTexto;

                       })
                      }, function(err) {
                        $ionicPopup.alert({
                          title: 'Sorry!',
                          template: 'Aconteceu um probleminha, tente de novo'
                        });
                        $ionicLoading.hide();
                      }, function (progress) {
                        // $ionicLoading.show({
                        //   title: '┗(＾0＾)┓',
                        //   template: '┗(＾0＾)┓'
                        // });
                      });
                    }else{
                      $ionicLoading.hide();
                      delete $scope.novopost.postTitulo;
                      delete $scope.novopost.postTexto;

                    }
                  }
            });

      }else{
        $ionicPopup.alert({
                          title: 'Sorry!',
                          template: 'É necesário um título'
                        });
      }
    }

    $scope.area = function(){
     $state.go('areacobertura');
  }

}])


.controller('meuspostCtrl', ['$scope', '$state', '$stateParams','$ionicPopup', '$ionicTabsDelegate','formUser','formMeusPost','formvimdofiltroperfil', 'formPost', 'EventoService', '$http', '$ionicPopup', 'formvimdopost', 'formOutro','formPost','formLimiteatuacao', '$cordovaCamera', '$cordovaFile', '$cordovaFileTransfer', '$cordovaDevice',  //nstructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $state, $stateParams,$ionicPopup,$ionicTabsDelegate, formUser,formMeusPost,formvimdofiltroperfil, formPost, EventoService, $http, $ionicPopup, formvimdopost, formOutro, formPost,formLimiteatuacao, $cordovaCamera, $cordovaFile, $cordovaFileTransfer, $cordovaDevice) {
  formvimdopost.updateForm(true);
  $scope.posts =[];

  $scope.user =formUser.getForm();
  $scope.teste =  function(){
    $state.go('tabsController.bairroapresenta')
  }
  if(!$scope.user.lat){
    if (navigator.geolocation) {
      navigator.geolocation.getCurrentPosition(successFunction, errorFunction);
    } 
    function successFunction(position) {
      $scope.user.lat =  position.coords.latitude;
      $scope.user.long =  position.coords.longitude;
      console.log($scope.user.long, $scope.user.lat)
     }
    function errorFunction(){
        //alert("Geocoder failed");
    }
  }
   // EventoService.GetFeedMeusPost($scope.user).then(function(posts) {
   //    $scope.postBar = false;
   //    $scope.meusmeus = true;
   //            if (posts!='Error'&& posts!='E') {
   //              $scope.vazio = false;
   //              $scope.posts = posts.concat($scope.posts);         
   //            }else{
   //              $scope.vazio = true;
   //              $scope.posts =[];
   //            }
   //          });
  
  
   var header = document.getElementById("barpost");
    var btns = header.getElementsByClassName("btnpost");
    for (var i = 0; i < btns.length; i++) {
      btns[i].addEventListener("click", function() {
        var current = document.getElementsByClassName("actpost");
        current[0].className = current[0].className.replace(" actpost", "");
        this.className += " actpost";
      });
    }


  $scope.$on("$ionicView.enter", function(event, data){
    $scope.user =formUser.getForm();
    // $scope.posts =[];
    // $scope.auxpost =[];
    // formvimdopost.updateForm(true);
    $ionicTabsDelegate.showBar(1);
    if(!$scope.meusmeus){
      $scope.semfeed = false;
    formvimdopost.updateForm(true);
    $scope.postBar = false;
    $scope.items = [];
    $scope.posts = [];
    $scope.centerPoint = {};
    $ionicTabsDelegate.showBar(1);
    if (navigator.geolocation) {
          navigator.geolocation.getCurrentPosition(successFunction, errorFunction);
        } 
        function successFunction(position) {
          raio = 200*0.71; //50 1000km
          lat  = position.coords.latitude;
          long = position.coords.longitude;
          $scope.user.lat =  position.coords.latitude;
          $scope.user.long =  position.coords.longitude;
          myLatlng = new google.maps.LatLng(lat, long);
          spherical = google.maps.geometry.spherical; 
          north = spherical.computeOffset(myLatlng, raio, 0); 
          west  = spherical.computeOffset(myLatlng, raio, -90); 
          south = spherical.computeOffset(myLatlng, raio, 180); 
          east  = spherical.computeOffset(myLatlng, raio, 90);
          $scope.user.northlat = north.lat();
          $scope.user.westlng = west.lng();
          $scope.user.southlat = south.lat();
          $scope.user.eastlng = east.lng();
          $scope.centerPoint.lat = -26.997799;
          $scope.centerPoint.lng = -48.632733;
          formUser.updateForm($scope.user); 
          // $scope.centerPoint.lat = -25.473466587692343;
          // $scope.centerPoint.lng = -49.29164589792566;
          $scope.centerPointKM = 30;
          $scope.LimiteFuncionamentoDiwo = arePointsNear($scope.user, $scope.centerPoint,$scope.centerPointKM );
          //console.log($scope.user.northlat,$scope.user.southlat,$scope.user.eastlng , $scope.user.westlng,$scope.user.lat,  $scope.user.long)
          if(!$scope.LimiteFuncionamentoDiwo){
              raio = 200*0.71;
              lat  = position.coords.latitude;
              long = position.coords.longitude;
               myLatlng = new google.maps.LatLng(lat, long);
              spherical = google.maps.geometry.spherical; 
              north = spherical.computeOffset(myLatlng, raio, 0); 
              west  = spherical.computeOffset(myLatlng, raio, -90); 
              south = spherical.computeOffset(myLatlng, raio, 180); 
              east  = spherical.computeOffset(myLatlng, raio, 90);
              $scope.user.northlat = north.lat();
              $scope.user.westlng = west.lng();
              $scope.user.southlat = south.lat();
              $scope.user.eastlng = east.lng();
              if($scope.user.iduser){
                EventoService.GetFeedMeusPost($scope.user).then(function(posts) {
                  //console.log(posts, "POST")
                  //$scope.posts = posts.concat($scope.posts);
                  if (posts!='Error'&&posts!='E') {
                    console.log("das", posts.length) 
                    $scope.vazio = false;
                    $scope.posts = posts.concat($scope.posts);
                    $scope.npost =0;
                    for(var i = 0 ; i<posts.length ; i++){
                      //console.log("aqui", posts[i].iduser , $scope.user.iduser)
                      if(posts[i].iduser == $scope.user.iduser){
                        $scope.meupost = posts[i];
                        $scope.npost ++; 
                        console.log("aqui", posts[i].iduser , $scope.user.iduser, $scope.meupost)
                      }
                    }
                    if(posts.length ==i){
                      formMeusPost.updatePost($scope.meupost);
                    }
                  }else{
                    $scope.vazio = true;
                    $scope.posts =[];
                  }       
                });   
              }else{
                $scope.vazio = true;
                $scope.posts =[];
              }
             
        
          }
          formLimiteatuacao.updateForm($scope.LimiteFuncionamentoDiwo);
          console.log($scope.LimiteFuncionamentoDiwo, $scope.user.northlat, $scope.LimiteFuncionamentoDiwoFB)
        }

        function errorFunction(){
            //alert("Geocoder failed");
            $scope.semloc = true;
        }

        function arePointsNear(checkPoint, centerPoint, km) {
          var ky = 40000 / 360;
          var kx = Math.cos(Math.PI * centerPoint.lat / 180.0) * ky;
          var dx = Math.abs(centerPoint.lng - $scope.user.long) * kx;
          var dy = Math.abs(centerPoint.lat - $scope.user.lat) * ky;
          var resp = Math.sqrt(dx * dx + dy * dy) <= km;
          console.log(!resp,"resp")
          return !resp;
        }
    }
    //console.log($scope.user.iduser)
    // if(!$scope.user.lat){
    //   if (navigator.geolocation) {
    //     navigator.geolocation.getCurrentPosition(successFunction, errorFunction);
    //   } 
    //   function successFunction(position) {
    //     $scope.user.lat =  position.coords.latitude;
    //     $scope.user.long =  position.coords.longitude;
    //     console.log($scope.user.long, $scope.user.lat)
    //    }
    //   function errorFunction(){
    //       //alert("Geocoder failed");
    //   }
    // } 
  });

  $scope.loadMeuspost =  function(post){
    $scope.meusmeus = true;
    $scope.postBar = false;
    $ionicTabsDelegate.showBar(1);
    EventoService.GetFeedMeusPost($scope.user).then(function(posts) {
      //console.log(posts)
      $scope.posts =[];
      if (posts!='Error'&& posts!='E') {
        $scope.vazio = false;
        $scope.posts = posts.concat($scope.posts);         
      }else{
        $scope.vazio = true;
        $scope.posts =[];
      }
    });

  }

  $scope.enterPost =  function(post){
   
      console.log(post.idposts,"idpost" )
      formPost.updatePost(post);
      $state.go('tabsController.post');

  }
  $scope.deletapost =  function(post){
    console.log(post,"post")
    var confirmPopup = $ionicPopup.show({
                   title: 'ლ(｡-﹏-｡ ლ)',
                   template: 'Deseja deletar esse post?',
                   buttons: [
                      { text: 'Não',
                        type: 'button-positive'},
                      {
                        text: 'Sim',
                        type: 'button-assertive',
                        onTap: function(e){
                          post.postEstado = 1;
                          post.postTipo = 'silenciado'
                            EventoService.DeletaPost(post).then(function (resp){
                              if(resp){
                                $http.post('https://ec2.diwoapp.com.br/gastapontospessoaevento.php', {idevento : -100,
                                                        iduser : $scope.user.iduser,
                                                        borda : '0',
                                                        username: $scope.user.username,
                                                        apelido : $scope.user.apelido,
                                                        nomeevento :  "DEleteou post", 
                                                        estado : 10,
                                                        pontos: -1});
                                $scope.atualiza = {};
                                var po = $scope.user.pontos.valueOf()-1;
                                $scope.atualiza.pontos = po;
                                $scope.atualiza.iduser = $scope.user.iduser;
                                EventoService.atualizarpontos($scope.atualiza);
                                $state.reload();
                              }
                            });
                        }
                      }]})
  }
  $scope.naosilencia =  function(post){
    $scope.auxpost = post;
    $scope.auxpost.postTipo = 'normal'
    post.som = true;
    EventoService.PostSilencia($scope.auxpost);
  }
  $scope.silencia =  function(post){
    $scope.auxpost = post;
    $scope.auxpost.postTipo = 'silenciado'
    post.som = false;
    EventoService.PostSilencia($scope.auxpost);
  }

  $scope.loadPosts = function() {
    $scope.meusmeus = false;
    //console.log("indsaudnis")
    $scope.semfeed = false;
    formvimdopost.updateForm(true);
    $scope.postBar = true;
    $scope.items = [];
    $scope.posts = [];
    $scope.centerPoint = {};
    $ionicTabsDelegate.showBar(1);
    if (navigator.geolocation) {
          navigator.geolocation.getCurrentPosition(successFunction, errorFunction);
        } 
        function successFunction(position) {
          raio = 200*0.71; //50 1000km
          lat  = position.coords.latitude;
          long = position.coords.longitude;
          $scope.user.lat =  position.coords.latitude;
          $scope.user.long =  position.coords.longitude;
          myLatlng = new google.maps.LatLng(lat, long);
          spherical = google.maps.geometry.spherical; 
          north = spherical.computeOffset(myLatlng, raio, 0); 
          west  = spherical.computeOffset(myLatlng, raio, -90); 
          south = spherical.computeOffset(myLatlng, raio, 180); 
          east  = spherical.computeOffset(myLatlng, raio, 90);
          $scope.user.northlat = north.lat();
          $scope.user.westlng = west.lng();
          $scope.user.southlat = south.lat();
          $scope.user.eastlng = east.lng();
          $scope.centerPoint.lat = -26.997799;
          $scope.centerPoint.lng = -48.632733;
          formUser.updateForm($scope.user); 
          // $scope.centerPoint.lat = -25.473466587692343;
          // $scope.centerPoint.lng = -49.29164589792566;
          $scope.centerPointKM = 30;
          $scope.LimiteFuncionamentoDiwo = arePointsNear($scope.user, $scope.centerPoint,$scope.centerPointKM );
          //console.log($scope.user.northlat,$scope.user.southlat,$scope.user.eastlng , $scope.user.westlng,$scope.user.lat,  $scope.user.long)
          if(!$scope.LimiteFuncionamentoDiwo){
             raio = 200*0.71;
              lat  = position.coords.latitude;
              long = position.coords.longitude;
              myLatlng = new google.maps.LatLng(lat, long);
              spherical = google.maps.geometry.spherical; 
              north = spherical.computeOffset(myLatlng, raio, 0); 
              west  = spherical.computeOffset(myLatlng, raio, -90); 
              south = spherical.computeOffset(myLatlng, raio, 180); 
              east  = spherical.computeOffset(myLatlng, raio, 90);
              $scope.user.northlat = north.lat();
              $scope.user.westlng = west.lng();
              $scope.user.southlat = south.lat();
              $scope.user.eastlng = east.lng();
              console.log( "fasdfasdagadfb adf fa a")
             EventoService.GetFeedPost($scope.user).then(function(posts) {
              console.log(posts, "POST")
              //$scope.posts = posts.concat($scope.posts);
              if (posts!='Error'&&posts!='E') {
                console.log("das", posts.length) 
                $scope.vazio = false;
                $scope.posts = posts.concat($scope.posts);
                $scope.npost =0;
                for(var i = 0 ; i<posts.length ; i++){
                  //console.log("aqui", posts[i].iduser , $scope.user.iduser)
                  if(posts[i].iduser == $scope.user.iduser){
                    $scope.meupost = posts[i];
                    $scope.npost ++; 
                    console.log("aqui", posts[i].iduser , $scope.user.iduser, $scope.meupost)
                  }
                }
                if(posts.length ==i){
                  formMeusPost.updatePost($scope.meupost);
                }
              }else{
                $scope.vazio = true;
                $scope.posts =[];
              }
            });
        
          }
          formLimiteatuacao.updateForm($scope.LimiteFuncionamentoDiwo);
          console.log($scope.LimiteFuncionamentoDiwo, $scope.user.northlat, $scope.LimiteFuncionamentoDiwoFB)
        }

        function errorFunction(){
            //alert("Geocoder failed");
            $scope.semloc = true;
        }

        function arePointsNear(checkPoint, centerPoint, km) {
          var ky = 40000 / 360;
          var kx = Math.cos(Math.PI * centerPoint.lat / 180.0) * ky;
          var dx = Math.abs(centerPoint.lng - $scope.user.long) * kx;
          var dy = Math.abs(centerPoint.lat - $scope.user.lat) * ky;
          var resp = Math.sqrt(dx * dx + dy * dy) <= km;
          console.log(!resp,"resp")
          return !resp;
        }
   
  }

  $scope.tempostimage = false;
  $scope.novopost = {};
  $scope.novopost.postImagem = "";


    $scope.takePicture = function() {
      var optionsCamera = {
          quality : 100,
          destinationType : Camera.DestinationType.FILE_URL,
          sourceType : Camera.PictureSourceType.CAMERA,
          allowEdit : true,
          encodingType: Camera.EncodingType.JPEG,
          targetWidth: 640,
          targetHeight: 640,
          popoverOptions: CameraPopoverOptions,
          saveToPhotoAlbum: true
      };

      $cordovaCamera.getPicture(optionsCamera).then(function(imageData) {
          $scope.novopost.postImagem = imageData;
          $scope.tempostimage = true;
          
      }, function(err) {
      });
    }
    $scope.getPicture = function (optionsCamera) {
      var optionsCamera = {
            quality : 100,
            sourceType : 0,
            allowEdit : true,
            targetWidth: 640,
            targetHeight: 640
      };
      $cordovaCamera.getPicture(optionsCamera).then(function(imageData) {
        $scope.novopost.postImagem = imageData;
        $scope.tempostimage = true;
      }, function(err) {
        console.log(err);
      });
    };
    $scope.postar =  function(newpost){
      
      var agora = new Date(); 
      var curr_date = (agora.getDate()<10?'0':'') + agora.getDate();
      var curr_month = (agora.getMonth()<9?'0':'') + (agora.getMonth() + 1); //Months are zero based
      var curr_year = agora.getFullYear();
      var h2 = (agora.getHours()<10?'0':'') + agora.getHours();
      var m2 = (agora.getMinutes()<10?'0':'') + agora.getMinutes();
      var s2 = (agora.getSeconds()<10?'0':'') + agora.getSeconds();
      var j = curr_year + "-" + curr_month + "-" + curr_date+ ' '+h2 + ':' + m2 + ':' + s2;
      $scope.novopost.datadecriacao = j;
      var j2 = curr_year + "-" + curr_month + "-" + curr_date+ ' '+h2 + ':' + m2 ;
      $scope.novopost.auxdatadecriacao = j2;
      if(newpost  && newpost.postTitulo !=undefined && newpost.postTitulo !=null && newpost.postTitulo !=""){
        //console.log($scope.tempostimagem);
        if (navigator.geolocation) {
          navigator.geolocation.getCurrentPosition(successFunction, errorFunction);
        } 
        function successFunction(position) {
          raio = 200*0.71; //50km
          lat  = position.coords.latitude;
          long = position.coords.longitude;
          $scope.user.lat =  position.coords.latitude;
          $scope.user.long =  position.coords.longitude;
          myLatlng = new google.maps.LatLng(lat, long);
          spherical = google.maps.geometry.spherical; 
          north = spherical.computeOffset(myLatlng, raio, 0); 
          west  = spherical.computeOffset(myLatlng, raio, -90); 
          south = spherical.computeOffset(myLatlng, raio, 180); 
          east  = spherical.computeOffset(myLatlng, raio, 90);
          $scope.user.northlat = north.lat();
          $scope.user.westlng = west.lng();
          $scope.user.southlat = south.lat();
          $scope.user.eastlng = east.lng();
          $scope.centerPoint.lat = -26.997799;
          $scope.centerPoint.lng = -48.632733; 
          // $scope.centerPoint.lat = -25.473466587692343;
          // $scope.centerPoint.lng = -49.29164589792566;
          $scope.centerPointKM = 30;
          $scope.LimiteFuncionamentoDiwo = arePointsNear($scope.user, $scope.centerPoint,$scope.centerPointKM );
          
          if(!$scope.LimiteFuncionamentoDiwo){
             console.log($scope.npost, "rqwerwer", $scope.meupost)
            if($scope.npost>=0 && $scope.npost<3){
              //console.log($scope.meupost.length, "fasdf")
              if($scope.novopost.postImagem != ""  && $scope.novopost.postImagem != null && $scope.novopost.postImagem != undefined){ 
                $scope.auxfoto = $scope.novopost.postTitulo + $scope.novopost.auxdatadecriacao;
                var mystring = String($scope.auxfoto);
                mystring = mystring.replace(/[^a-zA-Z0-9]/g, '');
                $scope.novopost.postpic = 'https://diwoappprofilepics.s3.amazonaws.com/posts/' + mystring + '.jpg';
              }else{
                $scope.novopost.postpic = "";
              } 
              console.log($scope.user.long, "dqewrqw",$scope.novopost.datadecriacao, $scope.novopost.postTexto, $scope.novopost.postTitulo, $scope.user.apelido)
              var link = 'https://ec2.diwoapp.com.br/criarpost.php';
                $http.post(link, {
                postTitulo :$scope.novopost.postTitulo,
                postTexto:$scope.novopost.postTexto,
                postEstado: 0,
                postTipo:"normal",
                postImagem : $scope.novopost.postpic,
                datadecriacao:$scope.novopost.datadecriacao,
                datadeacao:$scope.novopost.datadecriacao,
                iduser:$scope.user.iduser,
                username :$scope.user.username,
                apelido: $scope.user.apelido,
                profilepic:$scope.user.profilepic,
                deviceToken:$scope.user.devicetoken,
                lat :$scope.user.lat,
                lng :$scope.user.long}).then(function (res){
                    $scope.responsecriado = res.data;
                    console.log(res.data.success, "criou");
                  if ($scope.responsecriado.success == true) {
                    $http.post('https://ec2.diwoapp.com.br/gastapontospessoaevento.php', {idevento : -100,
                                                        iduser : $scope.user.iduser,
                                                        borda : '0',
                                                        username: $scope.user.username,
                                                        apelido : $scope.user.apelido,
                                                        nomeevento :  "Criou post", 
                                                        estado : 10,
                                                        pontos: 1});
                    $scope.atualiza = {};
                    var po = $scope.user.pontos.valueOf()+1;
                    $scope.atualiza.pontos = po;
                    $scope.atualiza.iduser = $scope.user.iduser;
                    EventoService.atualizarpontos($scope.atualiza);
                    $scope.posts =[];
                    EventoService.GetFeedPost($scope.user).then(function(posts) {
                      //console.log(posts, "POST")
                      //$scope.posts = posts.concat($scope.posts);
                      if (posts!='Error'&&posts!='E') {
                        console.log("das", posts.length) 
                        $scope.vazio = false;
                        $scope.posts = posts.concat($scope.posts);
                        $scope.npost =0;
                        for(var i = 0 ; i<posts.length ; i++){
                          console.log("aqui", posts[i].iduser , $scope.user.iduser)
                          if(posts[i].iduser == $scope.user.iduser){
                            $scope.meupost = posts[i];
                            $scope.npost ++;
                            console.log("aqui", posts[i].iduser , $scope.user.iduser)
                          }
                        }
                        if(posts.length ==i){
                          formMeusPost.updatePost($scope.meupost);
                        }
                      }else{
                        $scope.vazio = true;
                        $scope.posts =[];
                        $scope.meupost = [];
                      }
                    });
                    if($scope.novopost.postImagem != "" && $scope.novopost.postImagem != null && $scope.novopost.postImagem != undefined){
                      $scope.auxfoto = $scope.novopost.postTitulo + $scope.novopost.auxdatadecriacao;
                      var mystring = String($scope.auxfoto);
                      mystring = mystring.replace(/[^a-zA-Z0-9]/g, '');
                      var url = "https://ec2.diwoapp.com.br/uploadfotopost.php";
                                              // File for Upload
                      var targetPath = $scope.novopost.postImagem;
                     
                      // File name only
                      //var name = $scope.imgURI.substr(imageData.lastIndexOf('/') + 1);
                      var filename = mystring + '.jpg';
                      // NO CASO SERIA O NOME DO USUARIO.jpg O fileName
                      var options = {
                        fileKey: "file",
                        fileName: filename,
                        chunkedMode: false,
                        mimeType: "multipart/form-data"
                      };
                      $cordovaFileTransfer.upload(url, targetPath, options).then(function(result) {
                         $ionicLoading.hide();
                         var alertPopup = $ionicPopup.alert({
                          title: 'Parabéns',
                          template: $scope.responsecriado.msg

                        }); 
                        alertPopup.then(function(){
                          $ionicLoading.hide();
                          delete $scope.novopost.postTitulo;
                          delete $scope.novopost.postTexto;

                       })
                      }, function(err) {
                        $ionicPopup.alert({
                          title: 'Sorry!',
                          template: 'Aconteceu um probleminha, tente de novo'
                        });
                        $ionicLoading.hide();
                      }, function (progress) {
                        $ionicLoading.show({
                          title: '┗(＾0＾)┓',
                          template: '┗(＾0＾)┓'
                        });
                      });
                    }else{
                      delete $scope.novopost.postTitulo;
                      delete $scope.novopost.postTexto;

                    }
                  }
            });
          }else{
            var alertPopup = $ionicPopup.alert({
                          title: '凸ಠ益ಠ)凸',
                          template: 'Tens muitos posts aqui, no máximo 3 por raio de 200m. Delete um para criar um novo!'
                        }); 
                        alertPopup.then(function(){
                          $scope.tempostimage = false;
                          delete $scope.novopost;
                       })
          }
              
          }
          formLimiteatuacao.updateForm($scope.LimiteFuncionamentoDiwo);
          console.log($scope.LimiteFuncionamentoDiwo, $scope.user.northlat, $scope.LimiteFuncionamentoDiwoFB)
        }

        function errorFunction(){
            //alert("Geocoder failed");
            $scope.semloc = true;
        }

        function arePointsNear(checkPoint, centerPoint, km) {
          var ky = 40000 / 360;
          var kx = Math.cos(Math.PI * centerPoint.lat / 180.0) * ky;
          var dx = Math.abs(centerPoint.lng - $scope.user.long) * kx;
          var dy = Math.abs(centerPoint.lat - $scope.user.lat) * ky;
          var resp = Math.sqrt(dx * dx + dy * dy) <= km
          return !resp;
        }
     
      }else{
        console.log("sem titulo")
      }
    }

    $scope.area = function(){
     $state.go('areacobertura');
  }

}])

.controller('perfilPostCtrl', ['$scope', '$stateParams', 'formOutro', 'formItem', 'EventoService','$http', '$timeout', '$ionicPopup', 'formUser', 'formStalker','$state','formvimdofiltro','formvimdofiltroperfil','formvimdopost', '$ionicTabsDelegate',  // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, formOutro, formItem, EventoService,$http, $timeout, $ionicPopup, formUser, formStalker, $state, formvimdofiltro, formvimdofiltroperfil,formvimdopost, $ionicTabsDelegate) {

  
  $scope.stalkeada = {};
  $scope.auxusers = {};
  $scope.estadobutton = 0; 
  $scope.neventos= 0;
  $scope.neventosnao= 0;
  $scope.p =0;
  $scope.frase = {};
  $scope.vimdofiltro = formvimdofiltroperfil.getForm();
  $scope.vimdopost =formvimdopost.getForm();

  $scope.outro = formOutro.getForm();
  $scope.user = formUser.getForm();

  $scope.stalkeada = $scope.outro;
  $scope.infosstalkeada={};
  EventoService.GetStalkear($scope.stalkeada.iduser).then(function(stalker) {
        $scope.infosstalkeada = stalker;
        if(($scope.infosstalkeada.profilepic[8] == 's' && $scope.infosstalkeada.profilepic[9] == '3')||($scope.infosstalkeada.profilepic[8] == 'd' && $scope.infosstalkeada.profilepic[9] == 'i')){
        //if($scope.infosstalkeada.profilepic[8] == 's' && $scope.infosstalkeada.profilepic[9] == '3'){
             document.getElementById("imageidperfilPost").src=$scope.infosstalkeada.profilepic+"?{{getTimeStamp()}}";
           }else{
             document.getElementById("imageidperfilPost").src=$scope.infosstalkeada.profilepic;
           }
           if(!$scope.infosstalkeada.numcodigo || $scope.infosstalkeada.numcodigo == 'null'){
            $scope.temcodigo = false;
          }else{
            $scope.temcodigo = true;
            if($scope.infosstalkeada.numcodigo == '0'){
              document.getElementById("badgeimg_po").src="img/egg_0.png";
            }
            if($scope.infosstalkeada.numcodigo == '1'){
              document.getElementById("badgeimg_po").src="img/egg_1.png";
            }
            if($scope.infosstalkeada.numcodigo == '2'){
              document.getElementById("badgeimg_po").src="img/egg_2.png";
            }
            if(parseInt($scope.infosstalkeada.numcodigo) >= 3){
              document.getElementById("badgeimg_po").src="img/egg_3.png";
            }
            if(parseInt($scope.infosstalkeada.numcodigo) < 0){
              document.getElementById("badgeimg_po").src="img/egg_3.png";
            }
          }
        $scope.frase = stalker.frase;
         if(stalker.borda == 0){
          $scope.estrelabb = false;
          $scope.estrelabs = false;
          $scope.estrelabg = false;
        }
        if(stalker.borda == 1){
          $scope.estrelabb = true;
          $scope.estrelabs = false;
          $scope.estrelabg = false;
        }
        if(stalker.borda == 2){
          $scope.estrelabb = false;
          $scope.estrelabs = true;
          $scope.estrelabg = false;
        }
        if(stalker.borda == 3){
          $scope.estrelabb = false;
          $scope.estrelabs = false;
          $scope.estrelabg = true;
        }
        if($scope.infosstalkeada.idade){
          $scope.infosstalkeada.idade = ", "+ $scope.infosstalkeada.idade +" anos";
        }else{
           $scope.infosstalkeada.idade ='';
        }
  });
  var header = document.getElementById("barperfiloutroev");
    var btns = header.getElementsByClassName("btnperfilotro");
    for (var i = 0; i < btns.length; i++) {
      btns[i].addEventListener("click", function() {
        var current = document.getElementsByClassName("actpo");
        current[0].className = current[0].className.replace(" actpo", "");
        this.className += " actpo";
      });
    }


  $scope.followbutton = false;
  $scope.desseguirbutton = false;

  $scope.qvou = true;

    $scope.CoisasCriado = true;
    $scope.CoisasFinalizado = false;

  var auxbloqueado = 0;
  var noti = {};

   EventoService.GetPontos($scope.stalkeada.iduser).then(function(items) {
        $scope.p = items;
        $scope.labels3 = ["Pontos"];
        $scope.colores3 = ["#ff4d4d"];
        $scope.data3 = [$scope.p];
      });
      EventoService.getIC($scope.stalkeada).then(function(items) {
        if(items){
          $scope.ic = items;
          $scope.options2 = {title: {
                      display: true,
                      text: 'Indice de confirmação',
                      position: 'bottom'
                  }
           }
          $scope.labels2 = ["Fui", "Não fui"];
          $scope.colores2 = ["#99FF99","#ff4d4d"];
          var menos = (100-$scope.ic.total).toFixed(1);
          var mais = $scope.ic.total;
          $scope.data2 = [mais, menos ];
        }
      });

      EventoService.GetComments3($scope.stalkeada).then(function(items) {
        
          $scope.options1 = {title: {
                    display: true,
                    text: 'Avaliações',
                    position: 'bottom'
                }
         }
          $scope.labels1 = ["Extrovertido", "Introvertido", "Realista","Curioso", "Solidário", "Racional","Organizado", "Criativo"];
          $scope.colores1 = ["#fff200", "#02fff2", "#ff9d00","#1867ce", "#e50be1", "#0e8c28","#ef370e", "#af0eef"];
          $scope.data1 =items.chart;
        
      }); 



  $scope.$on("$ionicView.enter", function(event, data){
    $scope.vimdofiltro = formvimdofiltroperfil.getForm();
    $scope.items = [];
    $scope.newItems = [];
    $scope.frase = {};
    $scope.vimdopost =formvimdopost.getForm();
    $scope.vezes = 0;
    $scope.lastidevento = 0;
    $scope.aux2 = 0;
    $ionicTabsDelegate.showBar(0);

    $scope.outro = formOutro.getForm();
    $scope.stalkeada = $scope.outro;
    $scope.infosstalkeada={};
    EventoService.GetStalkear($scope.outro.iduser).then(function(stalker) {
        $scope.infosstalkeada = stalker;
        if(($scope.infosstalkeada.profilepic[8] == 's' && $scope.infosstalkeada.profilepic[9] == '3')||($scope.infosstalkeada.profilepic[8] == 'd' && $scope.infosstalkeada.profilepic[9] == 'i')){
         //if($scope.infosstalkeada.profilepic[8] == 's' && $scope.infosstalkeada.profilepic[9] == '3'){
             document.getElementById("imageidperfilPost").src=$scope.infosstalkeada.profilepic+"?{{getTimeStamp()}}";
           }else{
             document.getElementById("imageidperfilPost").src=$scope.infosstalkeada.profilepic;
           }
           if(!$scope.infosstalkeada.numcodigo || $scope.infosstalkeada.numcodigo == 'null'){
            $scope.temcodigo = false;
          }else{
            $scope.temcodigo = true;
            if($scope.infosstalkeada.numcodigo == '0'){
              document.getElementById("badgeimg_po").src="img/egg_0.png";
            }
            if($scope.infosstalkeada.numcodigo == '1'){
              document.getElementById("badgeimg_po").src="img/egg_1.png";
            }
            if($scope.infosstalkeada.numcodigo == '2'){
              document.getElementById("badgeimg_po").src="img/egg_2.png";
            }
            if(parseInt($scope.infosstalkeada.numcodigo) >= 3){
              document.getElementById("badgeimg_po").src="img/egg_3.png";
            }
            if(parseInt($scope.infosstalkeada.numcodigo) < 0){
              document.getElementById("badgeimg_po").src="img/egg_3.png";
            }
          }
        $scope.frase = stalker.frase;
         if(stalker.borda == 0){
          $scope.estrelabb = false;
          $scope.estrelabs = false;
          $scope.estrelabg = false;
        }
        if(stalker.borda == 1){
          $scope.estrelabb = true;
          $scope.estrelabs = false;
          $scope.estrelabg = false;
        }
        if(stalker.borda == 2){
          $scope.estrelabb = false;
          $scope.estrelabs = true;
          $scope.estrelabg = false;
        }
        if(stalker.borda == 3){
          $scope.estrelabb = false;
          $scope.estrelabs = false;
          $scope.estrelabg = true;
        }
        if($scope.infosstalkeada.idade){
          $scope.infosstalkeada.idade = ", "+ $scope.infosstalkeada.idade +" anos";
        }else{
           $scope.infosstalkeada.idade ='';
        }
    });
    
    $scope.followbutton = false;
    $scope.desseguirbutton = false;
    $scope.noMoreItemsAvailable = false;

    $scope.CoisasCriado = true;
    $scope.CoisasFinalizado = false;

    EventoService.GetPontos($scope.outro.iduser).then(function(items) {
        $scope.p = items;
        $scope.labels3 = ["Pontos"];
        $scope.colores3 = ["#ff4d4d"];
        $scope.data3 = [$scope.p];
      });
      EventoService.getIC($scope.outro).then(function(items) {
        if(items){
          $scope.ic = items;
          $scope.options2 = {title: {
                      display: true,
                      text: 'Indice de confirmação',
                      position: 'bottom'
                  }
           }
          $scope.labels2 = ["Fui", "Não fui"];
          $scope.colores2 = ["#99FF99","#ff4d4d"];
          var menos = (100-$scope.ic.total).toFixed(1);
          var mais = $scope.ic.total;
          $scope.data2 = [mais, menos ];
        }
      });

      EventoService.GetComments3($scope.outro).then(function(items) {
        
          $scope.options1 = {title: {
                    display: true,
                    text: 'Avaliações',
                    position: 'bottom'
                }
         }
           $scope.labels1 = ["Extrovertido", "Introvertido", "Realista","Curioso", "Solidário", "Racional","Organizado", "Criativo"];
          $scope.colores1 = ["#fff200", "#02fff2", "#ff9d00","#1867ce", "#e50be1", "#0e8c28","#ef370e", "#af0eef"];
          $scope.data1 =items.chart;
        
      }); 

      EventoService.GetCriados($scope.stalkeada).then(function(items) {
        if(items!='E'){
          for (var i = 0; i < items.length; i++) {
                var curr_date = (items[i].diainicio[8]+items[i].diainicio[9]);
                var h2 = (items[i].diainicio[11]+items[i].diainicio[12]);
                var m2 = (items[i].diainicio[14]+items[i].diainicio[15]);
                var curr_month = (items[i].diainicio[5]+items[i].diainicio[6]);
                var curr_year = (items[i].diainicio[0]+items[i].diainicio[1]+items[i].diainicio[2]+items[i].diainicio[3]);
                var j = curr_date + "/" + curr_month + "/" + curr_year+ ' '+h2 + ':' + m2;
                items[i].datainicio = j;
                if(items[i].estado == 0){
                  items[i].confirmacao = "Vai acontecer"
                }
                if(items[i].estado == 1){
                  items[i].confirmacao = "Finalizado"
                }
                if(items[i].estado == 2){
                  items[i].confirmacao = "Standy by, talvez aconteça"
                }
                if(items[i].estado == 3){
                  items[i].confirmacao = "Vai acontecer"
                }
                if(items[i].estado == 4){
                  items[i].confirmacao = "Cancelado"
                }
                if(items[i].estado == 5){
                  items[i].confirmacao = "Acabado"
                }
                if(items[i].estado == 6){
                  items[i].confirmacao = "Escondido"
                }
            }
          $scope.items = items;
          $scope.lastidvestido = $scope.items[0].idevento;
        }else{
          $scope.items = [];
          $scope.lastidevento = 0;
          auxbloqueado = 3;
        }
      //});
    });

    $scope.auxusers.outro =  $scope.outro.iduser;
    $scope.auxusers.eu =  $scope.user.iduser;

      $scope.outro= $scope.outro.iduser;
      $scope.auxusers.outro =  $scope.outro;
      $scope.auxusers.eu =  $scope.user.iduser;


      EventoService.possoseguir($scope.auxusers).then(function(items) {
        console.log(items)
        if(items){
          console.log($scope.outro,$scope.user.iduser)
          //// nao funciona, nao pegar os bloqueados
          $http.post('https://ec2.diwoapp.com.br/getfollow.php', {iduserseguindo : $scope.outro, 
                                                                    iduserseguidor : $scope.user.iduser}).then(function(res) {
            console.log( 'oi' , res.data[0].bloqueado, res.data[0] );
            if(res.data[0]!='E'){
              if (res.data[0].bloqueado==0){ 
                $scope.desseguirbutton = true;
                $scope.followbutton = false;
                auxbloqueado = 1;
                $scope.qvou = true;
                console.log('ja sigo este cara');
              }
              if(res.data[0].bloqueado==2){
                console.log('nao sigo este cara');
                $scope.desseguirbutton = false;
                $scope.followbutton = true;
                auxbloqueado = 1;
                $scope.qvou = false;
              }
              if(res.data[0].bloqueado==1){
                console.log('tais bloqueado');
                $scope.desseguirbutton = false;
                $scope.followbutton = false;
                auxbloqueado = 3;
                $scope.items = [];
                $scope.qvou = false;
              }
              if($scope.outro == $scope.user.iduser){
                $scope.followbutton = false;
                $scope.desseguirbutton = false;
                $scope.reportbutton = false;
                $scope.qvou = true;
              }
            }else{
                $scope.followbutton = true;
                auxbloqueado = 2;
                $scope.qvou = false;
            }
            if($scope.outro == $scope.user.iduser){
              $scope.followbutton = false;
              $scope.desseguirbutton = false;
              $scope.reportbutton = false;
              $scope.qvou = true;
            }
          });
        }else{
          if($scope.outro == $scope.user.iduser){
            $scope.followbutton = false;
            $scope.desseguirbutton = false;
            $scope.reportbutton = false;
            $scope.qvou = true;
          }else{
            $scope.qvou = false;
          }
        }
      });        
    });
 
    if($scope.outro.iduser == $scope.user.iduser){
      $scope.followbutton = false;
      $scope.desseguirbutton = false;
      $scope.reportbutton = false;
      var alertPopup = $ionicPopup.alert({
        title: '(●♡∀♡)',
        template: 'Que pessoa bela'
      }); 
    } 

  $scope.seguir = function(){
    noti.recebe = $scope.outro.iduser;
    noti.envia = $scope.user.iduser;
    noti.tipo = 11;
    noti.nomeevento = 'follow';
    console.log(auxbloqueado, "auxbloqueado == 2")
    EventoService.VerificaNotificacao(noti).then(function(res) {
      console.log(res);
      if(res){
        var msgnoti ='Nova pessoa esta t stalkeando';
        var link = 'https://ec2.diwoapp.com.br/notificapessoa.php';
          $http.post(link, {notificacao :msgnoti, 
                              idevento : $scope.user.iduser,
                              nomeevento : 'follow',
                              id_user_envia : $scope.user.iduser,
                              username_envia : $scope.user.username,
                              apelido_envia : $scope.user.apelido,
                              tipo : '11',
                              id_user_recebe : $scope.outro.iduser});
      }
    });
    if(auxbloqueado == 2){
      var link = 'https://ec2.diwoapp.com.br/seguepessoa.php';
      $http.post(link, {iduserseguindo : $scope.infosstalkeada.iduser, 
                        usernameseguindo : $scope.stalkeada.username,
                        iduserseguidor : $scope.user.iduser,
                        apelidoseguindo : $scope.infosstalkeada.apelido,
                        apelidoseguidor : $scope.user.apelido,
                        profilepicseguindo : $scope.infosstalkeada.profilepic,
                        profilepicseguidor : $scope.user.profilepic,
                        devicetokenseguidor : $scope.user.devicetoken,
                        usernameseguidor : $scope.user.username}).then(function(res) {
        console.log(res.success);
        var alertPopup = $ionicPopup.alert({
          title: '(*•̀ᴗ•́*)و ̑̑',
          template: 'Pessoa adicionada as pessoas de interesse'
        });
        $scope.desseguirbutton = true;
        $scope.followbutton = false;
      });
    }else{
       var link = 'https://ec2.diwoapp.com.br/refollow.php'; // estado "Bloqueado"  = 2;
          $http.post(link, {iduserseguindo : $scope.infosstalkeada.iduser, 
                            iduserseguidor : $scope.user.iduser}).then(function(res) {           
            var alertPopup = $ionicPopup.alert({
              title: '(￣▽￣)ノ',
              template: 'Pessoa adicionada as pessoas de interesse'
            }); 
            $scope.desseguirbutton = true;
            $scope.followbutton = false;             
          });
    }
  }

  $scope.desseguir = function(){
    auxbloqueado = 0;
      var link = 'https://ec2.diwoapp.com.br/desfollow.php'; // estado "Bloqueado"  = 2;
          $http.post(link, {iduserseguindo : $scope.infosstalkeada.iduser, 
                        iduserseguidor : $scope.user.iduser}).then(function(res) {
                          
                              var alertPopup = $ionicPopup.alert({
                                                          title: '(*꒦ິ⌓꒦ີ)',
                                                          template: 'Não segues mais esta pessoa'
                                                        }); 
                              $scope.desseguirbutton = false;
                              $scope.followbutton = true;
                          
                        });
  }

  $scope.comentario = function(){
    formStalker.updateForm($scope.stalkeada);
    if(auxbloqueado!=3){
      $state.go('tabsController.comentariosperfiloutros');
    }
  }

   $scope.entrabadges = function(){
      $state.go('tabsController.badgesPerfilPost');
    }


  $scope.loadCriados = function() {
    $scope.CoisasCriado = true;
    $scope.CoisasFinalizado = false;
    if(auxbloqueado!=3){
      $scope.estadobutton = 0;
      $scope.items = [];
      EventoService.GetCriados($scope.stalkeada).then(function(items) {
        if(items == 'E'){
          $scope.items = [];
        }else{
          for (var i = 0; i < items.length; i++) {
                var curr_date = (items[i].diainicio[8]+items[i].diainicio[9]);
                var h2 = (items[i].diainicio[11]+items[i].diainicio[12]);
                var m2 = (items[i].diainicio[14]+items[i].diainicio[15]);
                var curr_month = (items[i].diainicio[5]+items[i].diainicio[6]);
                var curr_year = (items[i].diainicio[0]+items[i].diainicio[1]+items[i].diainicio[2]+items[i].diainicio[3]);
                var j = curr_date + "/" + curr_month + "/" + curr_year+ ' '+h2 + ':' + m2;
                items[i].datainicio = j;
                if(items[i].estado == 0){
                  items[i].confirmacao = "Vai acontecer"
                }
                if(items[i].estado == 1){
                  items[i].confirmacao = "Finalizado"
                }
                if(items[i].estado == 2){
                  items[i].confirmacao = "Standy by, talvez aconteça"
                }
                if(items[i].estado == 3){
                  items[i].confirmacao = "Vai acontecer"
                }
                if(items[i].estado == 4){
                  items[i].confirmacao = "Cancelado"
                }
                if(items[i].estado == 5){
                  items[i].confirmacao = "Acabado"
                }
                if(items[i].estado == 6){
                  items[i].confirmacao = "Escondido"
                }
            }
          $scope.items = items.concat($scope.items);
          $scope.lastidvestido = $scope.items[0].idevento;
        }
      });
    }
  }
  
  $scope.loadAbertos = function() {
    $scope.CoisasCriado = false;
    $scope.CoisasFinalizado = true;
    if(auxbloqueado!=3){
      $scope.estadobutton = 1;
      $scope.items = [];
      EventoService.GetAbertos($scope.stalkeada.iduser).then(function(items) {  //mudar
        if(items == 'E'){
          $scope.items = [];
        }else{
          for (var i = 0; i < items.length; i++) {
                var curr_date = (items[i].diainicio[8]+items[i].diainicio[9]);
                var h2 = (items[i].diainicio[11]+items[i].diainicio[12]);
                var m2 = (items[i].diainicio[14]+items[i].diainicio[15]);
                var curr_month = (items[i].diainicio[5]+items[i].diainicio[6]);
                var curr_year = (items[i].diainicio[0]+items[i].diainicio[1]+items[i].diainicio[2]+items[i].diainicio[3]);
                var j = curr_date + "/" + curr_month + "/" + curr_year+ ' '+h2 + ':' + m2;
                items[i].datainicio = j;
            }
          $scope.items = items.concat($scope.items);
          $scope.lastidvestido = $scope.items[0].idevento;
        }
      });
    }
  }
  
  $scope.loadFechados = function() {
    $scope.CoisasCriado = false;
    $scope.CoisasFinalizado = true;
    if(auxbloqueado!=3){
      $scope.estadobutton = 2;
      $scope.items = [];
      //console.log($scope.user.iduser);
      EventoService.GetFinalizadosPerfil($scope.stalkeada.iduser).then(function(items) {         //mudar
        if(items=='E'){
          $scope.items = [];
        }else{
          for (var i = 0; i < items.length; i++) {
                var curr_date = (items[i].diainicio[8]+items[i].diainicio[9]);
                var h2 = (items[i].diainicio[11]+items[i].diainicio[12]);
                var m2 = (items[i].diainicio[14]+items[i].diainicio[15]);
                var curr_month = (items[i].diainicio[5]+items[i].diainicio[6]);
                var curr_year = (items[i].diainicio[0]+items[i].diainicio[1]+items[i].diainicio[2]+items[i].diainicio[3]);
                var j = curr_date + "/" + curr_month + "/" + curr_year+ ' '+h2 + ':' + m2;
                items[i].datainicio = j;
            }
          $scope.items = items.concat($scope.items);
          $scope.lastidvestido = $scope.items[0].idevento;
        }
      });
    }
  }
    
  $scope.loadMore = function() {
    if ($scope.estadobutton == 0 && auxbloqueado!=3) {
      EventoService.GetOldEventosCriados().then(function(items) {
        $scope.items = $scope.items.concat(items);
        $scope.$broadcast('scroll.infiniteScrollComplete');
        if (items.length <= 4) {
          $scope.noMoreItemsAvailable = true;
        }
      });
    }
    if ($scope.estadobutton == 1 && auxbloqueado!=3) {
      EventoService.GetOldEventosCriados().then(function(items) {
        $scope.items = $scope.items.concat(items);
        $scope.$broadcast('scroll.infiniteScrollComplete');
        if (items.length <= 4) {
          $scope.noMoreItemsAvailable = true;
        }
      });

      
    }
    if ($scope.estadobutton == 2 && auxbloqueado!=3) {
      EventoService.GetOldEventosCriados().then(function(items) {
        $scope.items = $scope.items.concat(items);
        $scope.$broadcast('scroll.infiniteScrollComplete');
        if (items.length <= 4) {
          $scope.noMoreItemsAvailable = true;
        }
      });
    }
  }

  $scope.reportar = function(){
    $scope.reportmsg = '';
    console.log($scope.stalkeada.username);
    $scope.report = [
    { text: "Nome impróprio", checked: false },
    { text: "Comportamento inadequado", checked: false },
    { text: "Foto inapropriada", checked: false },
    { text: "É um impostor", checked: false }
    ];
    $ionicPopup.confirm({
      title: 'Você quer reportar essa pessoa pq?',
      content: '<ion-checkbox ng-repeat="item in report"  style="color: #FCFCFC;" ng-model="item.checked"  ng-checked="item.checked">{{item.text}}</ion-checkbox>',
      scope: $scope
    }).then(function(res) {
      if(res) {
        for (var h=0;h<3;h++){
          //console.log($scope.report[h].checked , h);
          if($scope.report[h].checked){
            $scope.reportmsg = $scope.reportmsg + $scope.report[h].text + ' ';
            //console.log($scope.reportmsg);
          }
        }
        if(h==3){
          console.log($scope.reportmsg);
          $http.post('https://ec2.diwoapp.com.br/reportaevento.php', {namereportado : $scope.stalkeada.username,
                                                                          reportadoid : $scope.stalkeada.iduser,
                                                                          iduserreportando : $scope.user.iduser,
                                                                          usernamereportando : $scope.user.username,
                                                                          tiporeport : 'usuario',
                                                                          motivo : $scope.reportmsg}).then(function (tes){
            $scope.response = tes.data;
            var alertPopup = $ionicPopup.alert({
              title: 'Obrigado',
              template: 'Esta pessoa esta agora sobre investigação, obrigado por manter a plataforma segura'
            });
          });
        }
      }
    });
  }

}])

.controller('badgesPerfilPostCtrl', ['$scope', '$stateParams', 'formOutro', 'EventoService','$ionicPopup', '$timeout','$state', '$cordovaCamera', '$cordovaFile', '$cordovaFileTransfer', '$ionicLoading','formBadge', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, formOutro, EventoService, $ionicPopup, $timeout, $state, $cordovaCamera, $cordovaFile, $cordovaFileTransfer, $ionicLoading, formBadge) {


  $scope.user = formOutro.getForm();
  $scope.aux = {};
  $scope.aux.iduser = $scope.user.iduser;


  $scope.aux.tag = "#ArteeCultura";
  $scope.auxnbadgeArteeCultura = 0;
  $scope.proximoArteeCultura = 0;
  $scope.proximoimgArteeCultura = '';
  $scope.anteriorimgArteeCultura = '';
  EventoService.getbadges($scope.aux).then(function(badges){
    console.log("badges", badges);
    if(badges!="Error" && badges !="E"){
      $scope.auxnbadgeArteeCultura = badges.length;
      if(badges.length == 0){
        $scope.anteriorimgArteeCultura = 'img/badges/Categorias/ArteeCultura/0.png';
        $scope.proximoArteeCultura = 1;
        $scope.proximoimgArteeCultura = 'img/badges/Categorias/ArteeCultura/1.png';

        document.getElementById("ArteeCultura").src="img/badges/Categorias/ArteeCultura/0.png"
      }
      if(badges.length == 1){
        $scope.anteriorimgArteeCultura = 'img/badges/Categorias/ArteeCultura/0.png';
        $scope.proximoArteeCultura = 2;
        $scope.proximoimgArteeCultura = 'img/badges/Categorias/ArteeCultura/1.1.png';
        document.getElementById("ArteeCultura").src="img/badges/Categorias/ArteeCultura/1.png"
      }
      if(badges.length == 2){
        $scope.anteriorimgArteeCultura = 'img/badges/Categorias/ArteeCultura/1.png';
        $scope.proximoArteeCultura = 3;
        $scope.proximoimgArteeCultura = 'img/badges/Categorias/ArteeCultura/1.2.png';
        document.getElementById("ArteeCultura").src="img/badges/Categorias/ArteeCultura/1.1.png"
      }
      if(badges.length == 3){
        $scope.anteriorimgArteeCultura = 'img/badges/Categorias/ArteeCultura/1.1.png';
        $scope.proximoArteeCultura = 4;
        $scope.proximoimgArteeCultura = 'img/badges/Categorias/ArteeCultura/1.3.png';
        document.getElementById("ArteeCultura").src="img/badges/Categorias/ArteeCultura/1.2.png"
      }
      if(badges.length == 4 || badges.length == 5){
        $scope.anteriorimgArteeCultura = 'img/badges/Categorias/ArteeCultura/1.2.pn';
        $scope.proximoArteeCultura = 6;
        $scope.proximoimgArteeCultura = 'img/badges/Categorias/ArteeCultura/2.png';
        document.getElementById("ArteeCultura").src="img/badges/Categorias/ArteeCultura/1.3.png"
      }

      if(badges.length == 6 || badges.length == 7){
        $scope.anteriorimgArteeCultura = 'img/badges/Categorias/ArteeCultura/1.3.png';
        $scope.proximoArteeCultura = 8;
        $scope.proximoimgArteeCultura = 'img/badges/Categorias/ArteeCultura/2.1.png';
        document.getElementById("ArteeCultura").src="img/badges/Categorias/ArteeCultura/2.png"
      }
      if(badges.length == 8 || badges.length == 9){
        $scope.anteriorimgArteeCultura = 'img/badges/Categorias/ArteeCultura/2.png';
        $scope.proximoArteeCultura = 10;
        $scope.proximoimgArteeCultura = 'img/badges/Categorias/ArteeCultura/2.2.png';
        document.getElementById("ArteeCultura").src="img/badges/Categorias/ArteeCultura/2.1.png"
      }
      if(badges.length == 10 || badges.length == 11){
        $scope.anteriorimgArteeCultura = 'img/badges/Categorias/ArteeCultura/2.1.png';
        $scope.proximoArteeCultura = 12;
        $scope.proximoimgArteeCultura = 'img/badges/Categorias/ArteeCultura/2.3.png';
        document.getElementById("ArteeCultura").src="img/badges/Categorias/ArteeCultura/2.2.png"
      }
      if(badges.length == 12 || badges.length == 13 || badges.length == 14){
        $scope.anteriorimgArteeCultura = 'img/badges/Categorias/ArteeCultura/2.2.png';
        $scope.proximoArteeCultura = 15;
        $scope.proximoimgArteeCultura = 'img/badges/Categorias/ArteeCultura/3.png';
        document.getElementById("ArteeCultura").src="img/badges/Categorias/ArteeCultura/2.3.png"
      }

      if(badges.length >= 15 && badges.length < 20 ){
        $scope.anteriorimgArteeCultura = 'img/badges/Categorias/ArteeCultura/2.3.png';
        $scope.proximoArteeCultura = 20;
        $scope.proximoimgArteeCultura = 'img/badges/Categorias/ArteeCultura/3.1.png';
        document.getElementById("ArteeCultura").src="img/badges/Categorias/ArteeCultura/3.png"
      }
      if(badges.length >= 20 && badges.length < 22 ){
        $scope.anteriorimgArteeCultura = 'img/badges/Categorias/ArteeCultura/3.png';
        $scope.proximoArteeCultura = 25;
        $scope.proximoimgArteeCultura = 'img/badges/Categorias/ArteeCultura/3.2.png';
        document.getElementById("ArteeCultura").src="img/badges/Categorias/ArteeCultura/3.1.png"
      }
      if(badges.length >= 25 && badges.length < 30 ){
        $scope.anteriorimgArteeCultura = 'img/badges/Categorias/ArteeCultura/3.1.png';
        $scope.proximoArteeCultura = 30;
        $scope.proximoimgArteeCultura = 'img/badges/Categorias/ArteeCultura/3.3.png';
        document.getElementById("ArteeCultura").src="img/badges/Categorias/ArteeCultura/3.2.png"
      }
      if(badges.length >= 30 && badges.length < 50 ){
        $scope.anteriorimgArteeCultura = 'img/badges/Categorias/ArteeCultura/3.2.png';
        $scope.proximoArteeCultura = 50;
        $scope.proximoimgArteeCultura = 'img/badges/Categorias/ArteeCultura/Super.png';
        document.getElementById("ArteeCultura").src="img/badges/Categorias/ArteeCultura/3.3.png"
      }

      if(badges.length >= 50){

        $scope.anteriorimgArteeCultura = 'img/badges/Categorias/ArteeCultura/3.3.png';
        $scope.proximoArteeCultura = 10000;
        $scope.proximoimgArteeCultura = 'img/badges/Categorias/ArteeCultura/Super.png';
        document.getElementById("ArteeCultura").src="img/badges/Categorias/ArteeCultura/Super.png"
      }

    }else{
      $scope.auxnbadgeArteeCultura = 0;
      $scope.anteriorimgArteeCultura = 'img/badges/Categorias/ArteeCultura/0.png';
        $scope.proximoArteeCultura = 1;
        $scope.proximoimgArteeCultura = 'img/badges/Categorias/ArteeCultura/1.png';
      document.getElementById("ArteeCultura").src="img/badges/Categorias/ArteeCultura/0.png"
    }
  });

  $scope.aux.tag = "#Ciclismo";
  $scope.auxnbadgeCiclismo = 0;
  $scope.proximoCiclismo = 0;
  $scope.proximoimgCiclismo = '';
  $scope.anteriorimgCiclismo = '';
  EventoService.getbadges($scope.aux).then(function(badges){
    console.log("badges", badges);
    if(badges!="Error" && badges !="E"){
      $scope.auxnbadgeCiclismo = badges.length;
      if(badges.length == 0){
        $scope.anteriorimgCiclismoa = 'img/badges/Categorias/Ciclismo/0.png';
        $scope.proximoCiclismo = 1;
        $scope.proximoimgCiclismo = 'img/badges/Categorias/Ciclismo/1.png';
        document.getElementById("Ciclismo").src="img/badges/Categorias/Ciclismo/0.png"
      }
      if(badges.length == 1){
        $scope.anteriorimgCiclismoa = 'img/badges/Categorias/Ciclismo/0.png';
        $scope.proximoCiclismo = 2;
        $scope.proximoimgCiclismo = 'img/badges/Categorias/Ciclismo/1.1.png';
        document.getElementById("Ciclismo").src="img/badges/Categorias/Ciclismo/1.png"
      }
      if(badges.length == 2){
        $scope.anteriorimgCiclismoa = 'img/badges/Categorias/Ciclismo/1.png';
        $scope.proximoCiclismo = 3;
        $scope.proximoimgCiclismo = 'img/badges/Categorias/Ciclismo/1.2.png';
        document.getElementById("Ciclismo").src="img/badges/Categorias/Ciclismo/1.1.png"
      }
      if(badges.length == 3){
        $scope.anteriorimgCiclismoa = 'img/badges/Categorias/Ciclismo/1.1.png';
        $scope.proximoCiclismo = 4;
        $scope.proximoimgCiclismo = 'img/badges/Categorias/Ciclismo/1.3.png';
        document.getElementById("Ciclismo").src="img/badges/Categorias/Ciclismo/1.2.png"
      }
      if(badges.length == 4 || badges.length == 5){
        $scope.anteriorimgCiclismoa = 'img/badges/Categorias/Ciclismo/1.2.png';
        $scope.proximoCiclismo = 6;
        $scope.proximoimgCiclismo = 'img/badges/Categorias/Ciclismo/2.png';
        document.getElementById("Ciclismo").src="img/badges/Categorias/Ciclismo/1.3.png"
      }

      if(badges.length == 6 || badges.length == 7){
        $scope.anteriorimgCiclismoa = 'img/badges/Categorias/Ciclismo/1.3.png';
        $scope.proximoCiclismo = 8;
        $scope.proximoimgCiclismo = 'img/badges/Categorias/Ciclismo/2.1.png';
        document.getElementById("Ciclismo").src="img/badges/Categorias/Ciclismo/2.png"
      }
      if(badges.length == 8 || badges.length == 9){
        $scope.anteriorimgCiclismoa = 'img/badges/Categorias/Ciclismo/2.png';
        $scope.proximoCiclismo = 10;
        $scope.proximoimgCiclismo = 'img/badges/Categorias/Ciclismo/2.2.png';
        document.getElementById("Ciclismo").src="img/badges/Categorias/Ciclismo/2.1.png"
      }
      if(badges.length == 10 || badges.length == 11){
        $scope.anteriorimgCiclismoa = 'img/badges/Categorias/Ciclismo/2.1.png';
        $scope.proximoCiclismo = 12;
        $scope.proximoimgCiclismo = 'img/badges/Categorias/Ciclismo/2.3.png';
        document.getElementById("Ciclismo").src="img/badges/Categorias/Ciclismo/2.2.png"
      }
      if(badges.length == 12 || badges.length == 13 || badges.length == 14){
        $scope.anteriorimgCiclismoa = 'img/badges/Categorias/Ciclismo/2.2.png';
        $scope.proximoCiclismo = 15;
        $scope.proximoimgCiclismo = 'img/badges/Categorias/Ciclismo/3.png';
        document.getElementById("Ciclismo").src="img/badges/Categorias/Ciclismo/2.3.png"
      }

      if(badges.length >= 15 && badges.length < 20 ){
        $scope.anteriorimgCiclismoa = 'img/badges/Categorias/Ciclismo/2.3.png';
        $scope.proximoCiclismo = 20;
        $scope.proximoimgCiclismo = 'img/badges/Categorias/Ciclismo/3.1.png';
        document.getElementById("Ciclismo").src="img/badges/Categorias/Ciclismo/3.png"
      }
      if(badges.length >= 20 && badges.length < 22 ){
        $scope.anteriorimgCiclismoa = 'img/badges/Categorias/Ciclismo/3.png';
        $scope.proximoCiclismo = 25;
        $scope.proximoimgCiclismo = 'img/badges/Categorias/Ciclismo/3.2.png';
        document.getElementById("Ciclismo").src="img/badges/Categorias/Ciclismo/3.1.png"
      }
      if(badges.length >= 25 && badges.length < 30 ){
        $scope.anteriorimgCiclismoa = 'img/badges/Categorias/Ciclismo/3.1.png';
        $scope.proximoCiclismo = 30;
        $scope.proximoimgCiclismo = 'img/badges/Categorias/Ciclismo/3.3.png';
        document.getElementById("Ciclismo").src="img/badges/Categorias/Ciclismo/3.2.png"
      }
      if(badges.length >= 30 && badges.length < 50 ){
        $scope.anteriorimgCiclismoa = 'img/badges/Categorias/Ciclismo/3.2.png';
        $scope.proximoCiclismo = 50;
        $scope.proximoimgCiclismo = 'img/badges/Categorias/Ciclismo/Super.png';
        document.getElementById("Ciclismo").src="img/badges/Categorias/Ciclismo/3.3.png"
      }

      if(badges.length >= 50){

        $scope.anteriorimgCiclismoa = 'img/badges/Categorias/Ciclismo/3.3.png';
        $scope.proximoCiclismo = 10000;
        $scope.proximoimgCiclismo = 'img/badges/Categorias/Ciclismo/Super.png';
        document.getElementById("Ciclismo").src="img/badges/Categorias/Ciclismo/Super.png"
      }

    }else{
      $scope.auxnbadgeCiclismo = 0;
      $scope.anteriorimgCiclismoa = 'img/badges/Categorias/Ciclismo/0.png';
      $scope.proximoCiclismo = 1;
      $scope.proximoimgCiclismo = 'img/badges/Categorias/Ciclismo/1.png';
      document.getElementById("Ciclismo").src="img/badges/Categorias/Ciclismo/0.png"
    }
  });

  $scope.aux.tag = "#Conversa";
  $scope.auxnbadgeConversa = 0;
  $scope.proximoConversa = 0;
  $scope.proximoimgConversa = '';
  $scope.anteriorimgConversa = '';
  EventoService.getbadges($scope.aux).then(function(badges){
    console.log("badges", badges);
    if(badges!="Error" && badges !="E"){
      $scope.auxnbadgeConversa = badges.length;
      if(badges.length == 0){
        $scope.anteriorimgConversa = 'img/badges/Categorias/Conversa/0.png';
        $scope.proximoConversa = 1;
        $scope.proximoimgConversa = 'img/badges/Categorias/Conversa/1.png';
        document.getElementById("Conversa").src="img/badges/Categorias/Conversa/0.png"
      }
      if(badges.length == 1){
        $scope.anteriorimgConversa = 'img/badges/Categorias/Conversa/0.png';
        $scope.proximoConversa = 2;
        $scope.proximoimgConversa = 'img/badges/Categorias/Conversa/1.1.png';
        document.getElementById("Conversa").src="img/badges/Categorias/Conversa/1.png"
      }
      if(badges.length == 2){
        $scope.anteriorimgConversa = 'img/badges/Categorias/Conversa/1.png';
        $scope.proximoConversa = 3;
        $scope.proximoimgConversa = 'img/badges/Categorias/Conversa/1.2.png';
        document.getElementById("Conversa").src="img/badges/Categorias/Conversa/1.1.png"
      }
      if(badges.length == 3){
        $scope.anteriorimgConversa = 'img/badges/Categorias/Conversa/1.1.png';
        $scope.proximoConversa = 4;
        $scope.proximoimgConversa = 'img/badges/Categorias/Conversa/1.3.png';
        document.getElementById("Conversa").src="img/badges/Categorias/Conversa/1.2.png"
      }
      if(badges.length == 4 || badges.length == 5){
        $scope.anteriorimgConversa = 'img/badges/Categorias/Conversa/1.2.png';
        $scope.proximoConversa = 6;
        $scope.proximoimgConversa = 'img/badges/Categorias/Conversa/2.png';
        document.getElementById("Conversa").src="img/badges/Categorias/Conversa/1.3.png"
      }

      if(badges.length == 6 || badges.length == 7){
        $scope.anteriorimgConversa = 'img/badges/Categorias/Conversa/1.3.png';
        $scope.proximoConversa = 8;
        $scope.proximoimgConversa = 'img/badges/Categorias/Conversa/2.1.png';
        document.getElementById("Conversa").src="img/badges/Categorias/Conversa/2.png"
      }
      if(badges.length == 8 || badges.length == 9){
        $scope.anteriorimgConversa = 'img/badges/Categorias/Conversa/2.png';
        $scope.proximoConversa = 10;
        $scope.proximoimgConversa = 'img/badges/Categorias/Conversa/2.2.png';
        document.getElementById("Conversa").src="img/badges/Categorias/Conversa/2.1.png"
      }
      if(badges.length == 10 || badges.length == 11){
        $scope.anteriorimgConversa = 'img/badges/Categorias/Conversa/2.1.png';
        $scope.proximoConversa = 12;
        $scope.proximoimgConversa = 'img/badges/Categorias/Conversa/2.3.png';
        document.getElementById("Conversa").src="img/badges/Categorias/Conversa/2.2.png"
      }
      if(badges.length == 12 || badges.length == 13 || badges.length == 14){
        $scope.anteriorimgConversa = 'img/badges/Categorias/Conversa/2.2.png';
        $scope.proximoConversa = 15;
        $scope.proximoimgConversa = 'img/badges/Categorias/Conversa/3.png';
        document.getElementById("Conversa").src="img/badges/Categorias/Conversa/2.3.png"
      }

      if(badges.length >= 15 && badges.length < 20 ){
        $scope.anteriorimgConversa = 'img/badges/Categorias/Conversa/2.3.png';
        $scope.proximoConversa = 20;
        $scope.proximoimgConversa = 'img/badges/Categorias/Conversa/3.1.png';
        document.getElementById("Conversa").src="img/badges/Categorias/Conversa/3.png"
      }
      if(badges.length >= 20 && badges.length < 22 ){
        $scope.anteriorimgConversa = 'img/badges/Categorias/Conversa/3.png';
        $scope.proximoConversa = 25;
        $scope.proximoimgConversa = 'img/badges/Categorias/Conversa/3.2.png';
        document.getElementById("Conversa").src="img/badges/Categorias/Conversa/3.1.png"
      }
      if(badges.length >= 25 && badges.length < 30 ){
        $scope.anteriorimgConversa = 'img/badges/Categorias/Conversa/3.1.png';
        $scope.proximoConversa = 30;
        $scope.proximoimgConversa = 'img/badges/Categorias/Conversa/3.3.png';
        document.getElementById("Conversa").src="img/badges/Categorias/Conversa/3.2.png"
      }
      if(badges.length >= 30 && badges.length < 50 ){
        $scope.anteriorimgConversa = 'img/badges/Categorias/Conversa/3.2.png';
        $scope.proximoConversa = 50;
        $scope.proximoimgConversa = 'img/badges/Categorias/Conversa/Super.png';
        document.getElementById("Conversa").src="img/badges/Categorias/Conversa/3.3.png"
      }

      if(badges.length >= 50){
        $scope.anteriorimgConversa = 'img/badges/Categorias/Conversa/3.3.png';
        $scope.proximoConversa = 10000;
        $scope.proximoimgConversa = 'img/badges/Categorias/Conversa/Super.png';
        document.getElementById("Conversa").src="img/badges/Categorias/Conversa/Super.png"
      }

    }else{
      $scope.auxnbadgeConversa = 0;

        $scope.anteriorimgConversa = 'img/badges/Categorias/Conversa/0.png';
        $scope.proximoConversa = 1;
        $scope.proximoimgConversa = 'img/badges/Categorias/Conversa/1.png';
      document.getElementById("Conversa").src="img/badges/Categorias/Conversa/0.png"
    }
  });

  $scope.aux.tag = "#Dança";
  $scope.auxnbadgeDanca = 0;
  $scope.proximoDanca = 0;
  $scope.proximoimgDanca = '';
  $scope.anteriorimgDanca = '';
  EventoService.getbadges($scope.aux).then(function(badges){
    console.log("badges", badges);
    if(badges!="Error" && badges !="E"){
      $scope.auxnbadgeDanca = badges.length;
      if(badges.length == 0){
        $scope.anteriorimgDanca = 'img/badges/Categorias/Danca/0.png';
        $scope.proximoDanca = 1;
        $scope.proximoimgDanca = 'img/badges/Categorias/Danca/1.png';
        document.getElementById("Danca").src="img/badges/Categorias/Danca/0.png"
      }
      if(badges.length == 1){
        $scope.anteriorimgDanca = 'img/badges/Categorias/Danca/0.png';
        $scope.proximoDanca = 2;
        $scope.proximoimgDanca = 'img/badges/Categorias/Danca/1.1.png';
        document.getElementById("Danca").src="img/badges/Categorias/Danca/1.png"
      }
      if(badges.length == 2){
        $scope.anteriorimgDanca = 'img/badges/Categorias/Danca/1.png';
        $scope.proximoDanca = 3;
        $scope.proximoimgDanca = 'img/badges/Categorias/Danca/1.2.png';
        document.getElementById("Danca").src="img/badges/Categorias/Danca/1.1.png"
      }
      if(badges.length == 3){
        $scope.anteriorimgDanca = 'img/badges/Categorias/Danca/1.1.png';
        $scope.proximoDanca = 4;
        $scope.proximoimgDanca = 'img/badges/Categorias/Danca/1.3.png';
        document.getElementById("Danca").src="img/badges/Categorias/Danca/1.2.png"
      }
      if(badges.length == 4 || badges.length == 5){
        $scope.anteriorimgDanca = 'img/badges/Categorias/Danca/1.2.png';
        $scope.proximoDanca = 6;
        $scope.proximoimgDanca = 'img/badges/Categorias/Danca/2.png';
        document.getElementById("Danca").src="img/badges/Categorias/Danca/1.3.png"
      }

      if(badges.length == 6 || badges.length == 7){
        $scope.anteriorimgDanca = 'img/badges/Categorias/Danca/1.3.png';
        $scope.proximoDanca = 8;
        $scope.proximoimgDanca = 'img/badges/Categorias/Danca/2.1.png';
        document.getElementById("Danca").src="img/badges/Categorias/Danca/2.png"
      }
      if(badges.length == 8 || badges.length == 9){
        $scope.anteriorimgDanca = 'img/badges/Categorias/Danca/2.png';
        $scope.proximoDanca = 10;
        $scope.proximoimgDanca = 'img/badges/Categorias/Danca/2.2.png';
        document.getElementById("Danca").src="img/badges/Categorias/Danca/2.1.png"
      }
      if(badges.length == 10 || badges.length == 11){
        $scope.anteriorimgDanca = 'img/badges/Categorias/Danca/2.1.png';
        $scope.proximoDanca = 12;
        $scope.proximoimgDanca = 'img/badges/Categorias/Danca/2.3.png';
        document.getElementById("Danca").src="img/badges/Categorias/Danca/2.2.png"
      }
      if(badges.length == 12 || badges.length == 13 || badges.length == 14){
        $scope.anteriorimgDanca = 'img/badges/Categorias/Danca/2.2.png';
        $scope.proximoDanca = 15;
        $scope.proximoimgDanca = 'img/badges/Categorias/Danca/3.png';
        document.getElementById("Danca").src="img/badges/Categorias/Danca/2.3.png"
      }

      if(badges.length >= 15 && badges.length < 20 ){
        $scope.anteriorimgDanca = 'img/badges/Categorias/Danca/2.3.png';
        $scope.proximoDanca = 20;
        $scope.proximoimgDanca = 'img/badges/Categorias/Danca/3.png';
        document.getElementById("Danca").src="img/badges/Categorias/Danca/3.png"
      }
      if(badges.length >= 20 && badges.length < 22 ){
        $scope.anteriorimgDanca = 'img/badges/Categorias/Danca/3.png';
        $scope.proximoDanca = 25;
        $scope.proximoimgDanca = 'img/badges/Categorias/Danca/3.2.png';
        document.getElementById("Danca").src="img/badges/Categorias/Danca/3.1.png"
      }
      if(badges.length >= 25 && badges.length < 30 ){
        $scope.anteriorimgDanca = 'img/badges/Categorias/Danca/3.1.png';
        $scope.proximoDanca = 30;
        $scope.proximoimgDanca = 'img/badges/Categorias/Danca/3.3.png';
        document.getElementById("Danca").src="img/badges/Categorias/Danca/3.2.png"
      }
      if(badges.length >= 30 && badges.length < 50 ){
        $scope.anteriorimgDanca = 'img/badges/Categorias/Danca/3.2.png';
        $scope.proximoDanca = 50;
        $scope.proximoimgDanca = 'img/badges/Categorias/Danca/Super.png';
        document.getElementById("Danca").src="img/badges/Categorias/Danca/3.3.png"
      }

      if(badges.length >= 50){
        $scope.anteriorimgDanca = 'img/badges/Categorias/Danca/3.3.png';
        $scope.proximoDanca = 10000;
        $scope.proximoimgDanca = 'img/badges/Categorias/Danca/Super.png';
        document.getElementById("Danca").src="img/badges/Categorias/Danca/Super.png"
      }

    }else{
      $scope.auxnbadgeDanca = 0;
        $scope.anteriorimgDanca = 'img/badges/Categorias/Danca/0.png';
        $scope.proximoDanca = 1;
        $scope.proximoimgDanca = 'img/badges/Categorias/Danca/1.png';
      document.getElementById("Danca").src="img/badges/Categorias/Danca/0.png"
    }
  });

  $scope.aux.tag = "#EsportesdePraia";
  $scope.auxnbadgeEsportesdePraia = 0;
  $scope.proximoEsportesdePraia = 0;
  $scope.proximoimgEsportesdePraia = '';
  $scope.anteriorimgEsportesdePraia = '';
  EventoService.getbadges($scope.aux).then(function(badges){
    console.log("badges", badges);
    if(badges!="Error" && badges !="E"){
      $scope.auxnbadgeEsportesdePraia = badges.length;
      if(badges.length == 0){
        $scope.anteriorimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/0.png';
        $scope.proximoEsportesdePraia = 1;
        $scope.proximoimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/1.png';
        document.getElementById("EsportesdePraia").src="img/badges/Categorias/EsportesdePraia/0.png"
      }
      if(badges.length == 1){
        $scope.anteriorimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/0.png';
        $scope.proximoEsportesdePraia = 2;
        $scope.proximoimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/1.1.png';
        document.getElementById("EsportesdePraia").src="img/badges/Categorias/EsportesdePraia/1.png"
      }
      if(badges.length == 2){
        $scope.anteriorimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/1.png';
        $scope.proximoEsportesdePraia = 3;
        $scope.proximoimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/1.2.png';
        document.getElementById("EsportesdePraia").src="img/badges/Categorias/EsportesdePraia/1.1.png"
      }
      if(badges.length == 3){
        $scope.anteriorimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/1.1.png';
        $scope.proximoEsportesdePraia = 4;
        $scope.proximoimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/1.3.png';
        document.getElementById("EsportesdePraia").src="img/badges/Categorias/EsportesdePraia/1.2.png"
      }
      if(badges.length == 4 || badges.length == 5){
        $scope.anteriorimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/1.2.png';
        $scope.proximoEsportesdePraia = 6;
        $scope.proximoimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/2.png';
        document.getElementById("EsportesdePraia").src="img/badges/Categorias/EsportesdePraia/1.3.png"
      }

      if(badges.length == 6 || badges.length == 7){
        $scope.anteriorimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/1.3.png';
        $scope.proximoEsportesdePraia = 8;
        $scope.proximoimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/2.1.png';
        document.getElementById("EsportesdePraia").src="img/badges/Categorias/EsportesdePraia/2.png"
      }
      if(badges.length == 8 || badges.length == 9){
        $scope.anteriorimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/2.png';
        $scope.proximoEsportesdePraia = 10;
        $scope.proximoimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/2.2.png';
        document.getElementById("EsportesdePraia").src="img/badges/Categorias/EsportesdePraia/2.1.png"
      }
      if(badges.length == 10 || badges.length == 11){
        $scope.anteriorimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/2.1.png';
        $scope.proximoEsportesdePraia = 12;
        $scope.proximoimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/2.3.png';
        document.getElementById("EsportesdePraia").src="img/badges/Categorias/EsportesdePraia/2.2.png"
      }
      if(badges.length == 12 || badges.length == 13 || badges.length == 14){
        $scope.anteriorimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/2.2.png';
        $scope.proximoEsportesdePraia = 15;
        $scope.proximoimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/3.png';
        document.getElementById("EsportesdePraia").src="img/badges/Categorias/EsportesdePraia/2.3.png"
      }

      if(badges.length >= 15 && badges.length < 20 ){
        $scope.anteriorimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/2.3.png';
        $scope.proximoEsportesdePraia = 20;
        $scope.proximoimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/3.1.png';
        document.getElementById("EsportesdePraia").src="img/badges/Categorias/EsportesdePraia/3.png"
      }
      if(badges.length >= 20 && badges.length < 22 ){
        $scope.anteriorimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/3.png';
        $scope.proximoEsportesdePraia = 25;
        $scope.proximoimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/3.2.png';
        document.getElementById("EsportesdePraia").src="img/badges/Categorias/EsportesdePraia/3.1.png"
      }
      if(badges.length >= 25 && badges.length < 30 ){
        $scope.anteriorimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/3.1.png';
        $scope.proximoEsportesdePraia = 30;
        $scope.proximoimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/1.png';
        document.getElementById("EsportesdePraia").src="img/badges/Categorias/EsportesdePraia/3.2.png"
      }
      if(badges.length >= 30 && badges.length < 50 ){
        $scope.anteriorimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/3.2.png';
        $scope.proximoEsportesdePraia = 50;
        $scope.proximoimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/Super.png';
        document.getElementById("EsportesdePraia").src="img/badges/Categorias/EsportesdePraia/3.3.png"
      }

      if(badges.length >= 50){
        $scope.anteriorimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/3.3.png';
        $scope.proximoEsportesdePraia = 10000;
        $scope.proximoimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/Super.png';
        document.getElementById("EsportesdePraia").src="img/badges/Categorias/EsportesdePraia/Super.png"
      }

    }else{
      $scope.auxnbadgeEsportesdePraia = 0;
        $scope.anteriorimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/0.png';
        $scope.proximoEsportesdePraia = 1;
        $scope.proximoimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/1.png';
      document.getElementById("EsportesdePraia").src="img/badges/Categorias/EsportesdePraia/0.png"
    }
  });

  $scope.aux.tag = "#FestaseBaladas";
  $scope.auxnbadgeFestaseBaladas = 0;
  $scope.proximoFestaseBaladas = 0;
  $scope.proximoimgFestaseBaladas = '';
  $scope.anteriorimgFestaseBaladas = '';
  EventoService.getbadges($scope.aux).then(function(badges){
    console.log("badges", badges);
    if(badges!="Error" && badges !="E"){
      $scope.auxnbadgeFestaseBaladas = badges.length;
      if(badges.length == 0){
        $scope.anteriorimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/0.png';
        $scope.proximoFestaseBaladas = 1;
        $scope.proximoimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/1.png';
        document.getElementById("FestaseBaladas").src="img/badges/Categorias/FestaseBaladas/0.png"
      }
      if(badges.length == 1){
        $scope.anteriorimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/0.png';
        $scope.proximoFestaseBaladas = 2;
        $scope.proximoimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/1.1.png';
        document.getElementById("FestaseBaladas").src="img/badges/Categorias/FestaseBaladas/1.png"
      }
      if(badges.length == 2){
        $scope.anteriorimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/1.png';
        $scope.proximoFestaseBaladas = 3;
        $scope.proximoimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/1.2.png';
        document.getElementById("FestaseBaladas").src="img/badges/Categorias/FestaseBaladas/1.1.png"
      }
      if(badges.length == 3){
        $scope.anteriorimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/1.1.png';
        $scope.proximoFestaseBaladas = 4;
        $scope.proximoimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/1.3.png';
        document.getElementById("FestaseBaladas").src="img/badges/Categorias/FestaseBaladas/1.2.png"
      }
      if(badges.length == 4 || badges.length == 5){
        $scope.anteriorimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/1.2.png';
        $scope.proximoFestaseBaladas = 6;
        $scope.proximoimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/2.png';
        document.getElementById("FestaseBaladas").src="img/badges/Categorias/FestaseBaladas/1.3.png"
      }

      if(badges.length == 6 || badges.length == 7){
        $scope.anteriorimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/1.3.png';
        $scope.proximoFestaseBaladas = 8;
        $scope.proximoimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/2.1.png';
        document.getElementById("FestaseBaladas").src="img/badges/Categorias/FestaseBaladas/2.png"
      }
      if(badges.length == 8 || badges.length == 9){
        $scope.anteriorimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/2.png';
        $scope.proximoFestaseBaladas = 10;
        $scope.proximoimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/2.2.png';
        document.getElementById("FestaseBaladas").src="img/badges/Categorias/FestaseBaladas/2.1.png"
      }
      if(badges.length == 10 || badges.length == 11){
        $scope.anteriorimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/2.1.png';
        $scope.proximoFestaseBaladas = 12;
        $scope.proximoimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/2.3.png';
        document.getElementById("FestaseBaladas").src="img/badges/Categorias/FestaseBaladas/2.2.png"
      }
      if(badges.length == 12 || badges.length == 13 || badges.length == 14){
        $scope.anteriorimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/2.2.png';
        $scope.proximoFestaseBaladas = 15;
        $scope.proximoimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/3.png';
        document.getElementById("FestaseBaladas").src="img/badges/Categorias/FestaseBaladas/2.3.png"
      }

      if(badges.length >= 15 && badges.length < 20 ){
        $scope.anteriorimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/2.3.png';
        $scope.proximoFestaseBaladas = 20;
        $scope.proximoimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/3.1.png';
        document.getElementById("FestaseBaladas").src="img/badges/Categorias/FestaseBaladas/3.png"
      }
      if(badges.length >= 20 && badges.length < 22 ){
        $scope.anteriorimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/3.png';
        $scope.proximoFestaseBaladas = 25;
        $scope.proximoimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/3.2.png';
        document.getElementById("FestaseBaladas").src="img/badges/Categorias/FestaseBaladas/3.1.png"
      }
      if(badges.length >= 25 && badges.length < 30 ){
        $scope.anteriorimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/3.1.png';
        $scope.proximoFestaseBaladas = 30;
        $scope.proximoimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/3.3.png';
        document.getElementById("FestaseBaladas").src="img/badges/Categorias/FestaseBaladas/3.2.png"
      }
      if(badges.length >= 30 && badges.length < 50 ){
        $scope.anteriorimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/3.2.png';
        $scope.proximoFestaseBaladas = 50;
        $scope.proximoimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/Super.png';
        document.getElementById("FestaseBaladas").src="img/badges/Categorias/FestaseBaladas/3.3.png"
      }

      if(badges.length >= 50){
        $scope.anteriorimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/3.3.png';
        $scope.proximoFestaseBaladas = 10000;
        $scope.proximoimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/Super.png';
        document.getElementById("FestaseBaladas").src="img/badges/Categorias/FestaseBaladas/Super.png"
      }

    }else{
      $scope.auxnbadgeFestaseBaladas = 0;
        $scope.anteriorimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/0.png';
        $scope.proximoFestaseBaladas = 1;
        $scope.proximoimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/1.png';
      document.getElementById("FestaseBaladas").src="img/badges/Categorias/FestaseBaladas/0.png"
    }
  });

  $scope.aux.tag = "#Futebol";
  $scope.auxnbadgeFutebol = 0;
  $scope.proximoFutebol = 0;
  $scope.proximoimgFutebol = '';
  $scope.anteriorimgFutebol = '';
  EventoService.getbadges($scope.aux).then(function(badges){
    console.log("badges", badges);
    if(badges!="Error" && badges !="E"){
      $scope.auxnbadgeFutebol = badges.length;
      if(badges.length == 0){
        $scope.anteriorimgFutebol = 'img/badges/Categorias/Futebol/0.png';
        $scope.proximoFutebol = 1;
        $scope.proximoimgFutebol = 'img/badges/Categorias/Futebol/1.png';
        document.getElementById("Futebol").src="img/badges/Categorias/Futebol/0.png"
      }
      if(badges.length == 1){
        $scope.anteriorimgFutebol = 'img/badges/Categorias/Futebol/0.png';
        $scope.proximoFutebol = 2;
        $scope.proximoimgFutebol = 'img/badges/Categorias/Futebol/1.1.png';
        document.getElementById("Futebol").src="img/badges/Categorias/Futebol/1.png"
      }
      if(badges.length == 2){
        $scope.anteriorimgFutebol = 'img/badges/Categorias/Futebol/1.png';
        $scope.proximoFutebol = 3;
        $scope.proximoimgFutebol = 'img/badges/Categorias/Futebol/1.2.png';
        document.getElementById("Futebol").src="img/badges/Categorias/Futebol/1.1.png"
      }
      if(badges.length == 3){
        $scope.anteriorimgFutebol = 'img/badges/Categorias/Futebol/1.1.png';
        $scope.proximoFutebol = 4;
        $scope.proximoimgFutebol = 'img/badges/Categorias/Futebol/1.3.png';
        document.getElementById("Futebol").src="img/badges/Categorias/Futebol/1.2.png"
      }
      if(badges.length == 4 || badges.length == 5){
        $scope.anteriorimgFutebol = 'img/badges/Categorias/Futebol/1.2.png';
        $scope.proximoFutebol = 6;
        $scope.proximoimgFutebol = 'img/badges/Categorias/Futebol/2.png';
        document.getElementById("Futebol").src="img/badges/Categorias/Futebol/1.3.png"
      }

      if(badges.length == 6 || badges.length == 7){
        $scope.anteriorimgFutebol = 'img/badges/Categorias/Futebol/1.3.png';
        $scope.proximoFutebol = 8;
        $scope.proximoimgFutebol = 'img/badges/Categorias/Futebol/2.1.png';
        document.getElementById("Futebol").src="img/badges/Categorias/Futebol/2.png"
      }
      if(badges.length == 8 || badges.length == 9){
        $scope.anteriorimgFutebol = 'img/badges/Categorias/Futebol/2.png';
        $scope.proximoFutebol = 10;
        $scope.proximoimgFutebol = 'img/badges/Categorias/Futebol/2.2.png';
        document.getElementById("Futebol").src="img/badges/Categorias/Futebol/2.1.png"
      }
      if(badges.length == 10 || badges.length == 11){
        $scope.anteriorimgFutebol = 'img/badges/Categorias/Futebol/2.1.png';
        $scope.proximoFutebol = 12;
        $scope.proximoimgFutebol = 'img/badges/Categorias/Futebol/2.3.png';
        document.getElementById("Futebol").src="img/badges/Categorias/Futebol/2.2.png"
      }
      if(badges.length == 12 || badges.length == 13 || badges.length == 14){
        $scope.anteriorimgFutebol = 'img/badges/Categorias/Futebol/2.2.png';
        $scope.proximoFutebol = 15;
        $scope.proximoimgFutebol = 'img/badges/Categorias/Futebol/3.png';
        document.getElementById("Futebol").src="img/badges/Categorias/Futebol/2.3.png"
      }

      if(badges.length >= 15 && badges.length < 20 ){
        $scope.anteriorimgFutebol = 'img/badges/Categorias/Futebol/2.3.png';
        $scope.proximoFutebol = 20;
        $scope.proximoimgFutebol = 'img/badges/Categorias/Futebol/3.1.png';
        document.getElementById("Futebol").src="img/badges/Categorias/Futebol/3.png"
      }
      if(badges.length >= 20 && badges.length < 22 ){
        $scope.anteriorimgFutebol = 'img/badges/Categorias/Futebol/3.png';
        $scope.proximoFutebol = 25;
        $scope.proximoimgFutebol = 'img/badges/Categorias/Futebol/3.2.png';
        document.getElementById("Futebol").src="img/badges/Categorias/Futebol/3.1.png"
      }
      if(badges.length >= 25 && badges.length < 30 ){
        $scope.anteriorimgFutebol = 'img/badges/Categorias/Futebol/3.1.png';
        $scope.proximoFutebol = 30;
        $scope.proximoimgFutebol = 'img/badges/Categorias/Futebol/3.3.png';
        document.getElementById("Futebol").src="img/badges/Categorias/Futebol/3.2.png"
      }
      if(badges.length >= 30 && badges.length < 50 ){
        $scope.anteriorimgFutebol = 'img/badges/Categorias/Futebol/3.2.png';
        $scope.proximoFutebol = 50;
        $scope.proximoimgFutebol = 'img/badges/Categorias/Futebol/Super.png';
        document.getElementById("Futebol").src="img/badges/Categorias/Futebol/3.3.png"
      }

      if(badges.length >= 50){
        $scope.anteriorimgFutebol = 'img/badges/Categorias/Futebol/3.3.png';
        $scope.proximoFutebol = 10000;
        $scope.proximoimgFutebol = 'img/badges/Categorias/Futebol/Super.png';
        document.getElementById("Futebol").src="img/badges/Categorias/Futebol/Super.png"
      }

    }else{
      $scope.auxnbadgeFutebol = 0;

        $scope.anteriorimgFutebol = 'img/badges/Categorias/Futebol/0.png';
        $scope.proximoFutebol = 1;
        $scope.proximoimgFutebol = 'img/badges/Categorias/Futebol/1.png';
      document.getElementById("Futebol").src="img/badges/Categorias/Futebol/0.png"
    }
  });

  $scope.aux.tag = "#GrupodeEstudos";
  $scope.auxnbadgeGrupodeEstudos = 0;
  $scope.proximoGrupodeEstudos = 0;
  $scope.proximoimgGrupodeEstudos = '';
  $scope.anteriorimgGrupodeEstudos = '';
  EventoService.getbadges($scope.aux).then(function(badges){
    console.log("badges", badges);
    if(badges!="Error" && badges !="E"){
      $scope.auxnbadgeGrupodeEstudos = badges.length;
      if(badges.length == 0){
        $scope.anteriorimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/0.png';
        $scope.proximoGrupodeEstudos = 1;
        $scope.proximoimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/1.png';
        document.getElementById("GrupodeEstudos").src="img/badges/Categorias/GrupodeEstudos/0.png"
      }
      if(badges.length == 1){
        $scope.anteriorimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/0.png';
        $scope.proximoGrupodeEstudos = 2;
        $scope.proximoimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/1.1.png';
        document.getElementById("GrupodeEstudos").src="img/badges/Categorias/GrupodeEstudos/1.png"
      }
      if(badges.length == 2){
        $scope.anteriorimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/1.png';
        $scope.proximoGrupodeEstudos = 3;
        $scope.proximoimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/1.2.png';
        document.getElementById("GrupodeEstudos").src="img/badges/Categorias/GrupodeEstudos/1.1.png"
      }
      if(badges.length == 3){
        $scope.anteriorimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/1.1.png';
        $scope.proximoGrupodeEstudos = 4;
        $scope.proximoimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/1.3.png';
        document.getElementById("GrupodeEstudos").src="img/badges/Categorias/GrupodeEstudos/1.2.png"
      }
      if(badges.length == 4 || badges.length == 5){
        $scope.anteriorimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/1.2.png';
        $scope.proximoGrupodeEstudos = 6;
        $scope.proximoimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/2.png';
        document.getElementById("GrupodeEstudos").src="img/badges/Categorias/GrupodeEstudos/1.3.png"
      }

      if(badges.length == 6 || badges.length == 7){
        $scope.anteriorimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/1.3.png';
        $scope.proximoGrupodeEstudos = 8;
        $scope.proximoimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/2.1.png';
        document.getElementById("GrupodeEstudos").src="img/badges/Categorias/GrupodeEstudos/2.png"
      }
      if(badges.length == 8 || badges.length == 9){
        $scope.anteriorimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/2.png';
        $scope.proximoGrupodeEstudos = 10;
        $scope.proximoimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/2.2.png';
        document.getElementById("GrupodeEstudos").src="img/badges/Categorias/GrupodeEstudos/2.1.png"
      }
      if(badges.length == 10 || badges.length == 11){
        $scope.anteriorimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/2.1.png';
        $scope.proximoGrupodeEstudos = 12;
        $scope.proximoimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/2.3.png';
        document.getElementById("GrupodeEstudos").src="img/badges/Categorias/GrupodeEstudos/2.2.png"
      }
      if(badges.length == 12 || badges.length == 13 || badges.length == 14){
        $scope.anteriorimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/2.2.png';
        $scope.proximoGrupodeEstudos = 15;
        $scope.proximoimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/3.png';
        document.getElementById("GrupodeEstudos").src="img/badges/Categorias/GrupodeEstudos/2.3.png"
      }

      if(badges.length >= 15 && badges.length < 20 ){
        $scope.anteriorimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/2.3.png';
        $scope.proximoGrupodeEstudos = 20;
        $scope.proximoimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/3.1.png';
        document.getElementById("GrupodeEstudos").src="img/badges/Categorias/GrupodeEstudos/3.png"
      }
      if(badges.length >= 20 && badges.length < 22 ){
        $scope.anteriorimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/3.png';
        $scope.proximoGrupodeEstudos = 25;
        $scope.proximoimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/3.2.png';
        document.getElementById("GrupodeEstudos").src="img/badges/Categorias/GrupodeEstudos/3.1.png"
      }
      if(badges.length >= 25 && badges.length < 30 ){
        $scope.anteriorimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/3.1.png';
        $scope.proximoGrupodeEstudos = 30;
        $scope.proximoimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/3.3.png';
        document.getElementById("GrupodeEstudos").src="img/badges/Categorias/GrupodeEstudos/3.2.png"
      }
      if(badges.length >= 30 && badges.length < 50 ){
        $scope.anteriorimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/3.2.png';
        $scope.proximoGrupodeEstudos = 50;
        $scope.proximoimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/Super.png';
        document.getElementById("GrupodeEstudos").src="img/badges/Categorias/GrupodeEstudos/3.3.png"
      }

      if(badges.length >= 50){
        $scope.anteriorimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/3.3.png';
        $scope.proximoGrupodeEstudos = 10000;
        $scope.proximoimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/Super.png';
        document.getElementById("GrupodeEstudos").src="img/badges/Categorias/GrupodeEstudos/Super.png"
      }

    }else{
      $scope.auxnbadgeGrupodeEstudos = 0;
        $scope.anteriorimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/0.png';
        $scope.proximoGrupodeEstudos = 1;
        $scope.proximoimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/1.png';
      document.getElementById("GrupodeEstudos").src="img/badges/Categorias/GrupodeEstudos/0.png"
    }
  });

  $scope.aux.tag = "#Jogos";
  $scope.auxnbadgeJogos = 0;
  $scope.proximoJogos = 0;
  $scope.proximoimgJogos = '';
  $scope.anteriorimgJogos = '';
  EventoService.getbadges($scope.aux).then(function(badges){
    //console.log("badges", badges);
    if(badges!="Error" && badges !="E"){
      $scope.auxnbadgeJogos = badges.length;
      if(badges.length == 0){
        $scope.anteriorimgJogos = 'img/badges/Categorias/Jogos/0.png';
        $scope.proximoJogos = 1;
        $scope.proximoimgJogos = 'img/badges/Categorias/Jogos/1.png';
        document.getElementById("Jogos").src="img/badges/Categorias/Jogos/0.png"
      }
      if(badges.length == 1){
        $scope.anteriorimgJogos = 'img/badges/Categorias/Jogos/0.png';
        $scope.proximoJogos = 2;
        $scope.proximoimgJogos = 'img/badges/Categorias/Jogos/1.1.png';
        document.getElementById("Jogos").src="img/badges/Categorias/Jogos/1.png"
      }
      if(badges.length == 2){
        $scope.anteriorimgJogos = 'img/badges/Categorias/Jogos/1.png';
        $scope.proximoJogos = 3;
        $scope.proximoimgJogos = 'img/badges/Categorias/Jogos/1.2.png';
        document.getElementById("Jogos").src="img/badges/Categorias/Jogos/1.1.png"
      }
      if(badges.length == 3){
        $scope.anteriorimgJogos = 'img/badges/Categorias/Jogos/1.1.png';
        $scope.proximoJogos = 4;
        $scope.proximoimgJogos = 'img/badges/Categorias/Jogos/1.3.png';
        document.getElementById("Jogos").src="img/badges/Categorias/Jogos/1.2.png"
      }
      if(badges.length == 4 || badges.length == 5){
        $scope.anteriorimgJogos = 'img/badges/Categorias/Jogos/1.2.png';
        $scope.proximoJogos = 6;
        $scope.proximoimgJogos = 'img/badges/Categorias/Jogos/2.png';
        document.getElementById("Jogos").src="img/badges/Categorias/Jogos/1.3.png"
      }

      if(badges.length == 6 || badges.length == 7){
        $scope.anteriorimgJogos = 'img/badges/Categorias/Jogos/1.3.png';
        $scope.proximoJogos = 8;
        $scope.proximoimgJogos = 'img/badges/Categorias/Jogos/2.1.png';
        document.getElementById("Jogos").src="img/badges/Categorias/Jogos/2.png"
      }
      if(badges.length == 8 || badges.length == 9){
        $scope.anteriorimgJogos = 'img/badges/Categorias/Jogos/2.png';
        $scope.proximoJogos = 10;
        $scope.proximoimgJogos = 'img/badges/Categorias/Jogos/2.2.png';
        document.getElementById("Jogos").src="img/badges/Categorias/Jogos/2.1.png"
      }
      if(badges.length == 10 || badges.length == 11){
        $scope.anteriorimgJogos = 'img/badges/Categorias/Jogos/2.1.png';
        $scope.proximoJogos = 12;
        $scope.proximoimgJogos = 'img/badges/Categorias/Jogos/2.3.png';
        document.getElementById("Jogos").src="img/badges/Categorias/Jogos/2.2.png"
      }
      if(badges.length == 12 || badges.length == 13 || badges.length == 14){
        $scope.anteriorimgJogos = 'img/badges/Categorias/Jogos/2.2.png';
        $scope.proximoJogos = 15;
        $scope.proximoimgJogos = 'img/badges/Categorias/Jogos/3.png';
        document.getElementById("Jogos").src="img/badges/Categorias/Jogos/2.3.png"
      }

      if(badges.length >= 15 && badges.length < 20 ){
        $scope.anteriorimgJogos = 'img/badges/Categorias/Jogos/2.3.png';
        $scope.proximoJogos = 20;
        $scope.proximoimgJogos = 'img/badges/Categorias/Jogos/3.1.png';
        document.getElementById("Jogos").src="img/badges/Categorias/Jogos/3.png"
      }
      if(badges.length >= 20 && badges.length < 22 ){
        $scope.anteriorimgJogos = 'img/badges/Categorias/Jogos/3.png';
        $scope.proximoJogos = 25;
        $scope.proximoimgJogos = 'img/badges/Categorias/Jogos/3.2.png';
        document.getElementById("Jogos").src="img/badges/Categorias/Jogos/3.1.png"
      }
      if(badges.length >= 25 && badges.length < 30 ){
        $scope.anteriorimgJogos = 'img/badges/Categorias/Jogos/3.1.png';
        $scope.proximoJogos = 30;
        $scope.proximoimgJogos = 'img/badges/Categorias/Jogos/3.3.png';
        document.getElementById("Jogos").src="img/badges/Categorias/Jogos/3.2.png"
      }
      if(badges.length >= 30 && badges.length < 50 ){
        $scope.anteriorimgJogos = 'img/badges/Categorias/Jogos/3.2.png';
        $scope.proximoJogos = 50;
        $scope.proximoimgJogos = 'img/badges/Categorias/Jogos/Super.png';
        document.getElementById("Jogos").src="img/badges/Categorias/Jogos/3.3.png"
      }

      if(badges.length >= 50){
        $scope.anteriorimgJogos = 'img/badges/Categorias/Jogos/3.3.png';
        $scope.proximoJogos = 10000;
        $scope.proximoimgJogos = 'img/badges/Categorias/Jogos/Super.png';
        document.getElementById("Jogos").src="img/badges/Categorias/Jogos/Super.png"
      }

    }else{
      $scope.auxnbadgeJogos = 0;
        $scope.anteriorimgJogos = 'img/badges/Categorias/Jogos/0.png';
        $scope.proximoJogos = 1;
        $scope.proximoimgJogos = 'img/badges/Categorias/Jogos/1.png';
      document.getElementById("Jogos").src="img/badges/Categorias/Jogos/0.png"
    }
  });

  $scope.aux.tag = "#Musica";
  $scope.auxnbadgeMusica = 0;
  $scope.proximoMusica = 0;
  $scope.proximoimgMusica = '';
  $scope.anteriorimgMusica = '';
  EventoService.getbadges($scope.aux).then(function(badges){
    //console.log("badges", badges);
    if(badges!="Error" && badges !="E"){
      $scope.auxnbadgeMusica = badges.length;
      if(badges.length == 0){
        $scope.anteriorimgMusica = 'img/badges/Categorias/Musica/0.png';
        $scope.proximoMusica = 1;
        $scope.proximoimgMusica = 'img/badges/Categorias/Musica/1.png';
        document.getElementById("Musica").src="img/badges/Categorias/Musica/0.png"
      }
      if(badges.length == 1){
        $scope.anteriorimgMusica = 'img/badges/Categorias/Musica/0.png';
        $scope.proximoMusica = 2;
        $scope.proximoimgMusica = 'img/badges/Categorias/Musica/1.1.png';
        document.getElementById("Musica").src="img/badges/Categorias/Musica/1.png"
      }
      if(badges.length == 2){
        $scope.anteriorimgMusica = 'img/badges/Categorias/Musica/1.png';
        $scope.proximoMusica = 3;
        $scope.proximoimgMusica = 'img/badges/Categorias/Musica/1.2.png';
        document.getElementById("Musica").src="img/badges/Categorias/Musica/1.1.png"
      }
      if(badges.length == 3){
        $scope.anteriorimgMusica = 'img/badges/Categorias/Musica/1.1.png';
        $scope.proximoMusica = 4;
        $scope.proximoimgMusica = 'img/badges/Categorias/Musica/1.3.png';
        document.getElementById("Musica").src="img/badges/Categorias/Musica/1.2.png"
      }
      if(badges.length == 4 || badges.length == 5){
        $scope.anteriorimgMusica = 'img/badges/Categorias/Musica/1.2.png';
        $scope.proximoMusica = 6;
        $scope.proximoimgMusica = 'img/badges/Categorias/Musica/2.png';
        document.getElementById("Musica").src="img/badges/Categorias/Musica/1.3.png"
      }

      if(badges.length == 6 || badges.length == 7){
        $scope.anteriorimgMusica = 'img/badges/Categorias/Musica/1.3.png';
        $scope.proximoMusica = 8;
        $scope.proximoimgMusica = 'img/badges/Categorias/Musica/2.1.png';
        document.getElementById("Musica").src="img/badges/Categorias/Musica/2.png"
      }
      if(badges.length == 8 || badges.length == 9){
        $scope.anteriorimgMusica = 'img/badges/Categorias/Musica/2.png';
        $scope.proximoMusica = 10;
        $scope.proximoimgMusica = 'img/badges/Categorias/Musica/2.2.png';
        document.getElementById("Musica").src="img/badges/Categorias/Musica/2.1.png"
      }
      if(badges.length == 10 || badges.length == 11){
        $scope.anteriorimgMusica = 'img/badges/Categorias/Musica/2.1.png';
        $scope.proximoMusica = 12;
        $scope.proximoimgMusica = 'img/badges/Categorias/Musica/2.3.png';
        document.getElementById("Musica").src="img/badges/Categorias/Musica/2.2.png"
      }
      if(badges.length == 12 || badges.length == 13 || badges.length == 14){
        $scope.anteriorimgMusica = 'img/badges/Categorias/Musica/2.2.png';
        $scope.proximoMusica = 15;
        $scope.proximoimgMusica = 'img/badges/Categorias/Musica/3.png';
        document.getElementById("Musica").src="img/badges/Categorias/Musica/2.3.png"
      }

      if(badges.length >= 15 && badges.length < 20 ){
        $scope.anteriorimgMusica = 'img/badges/Categorias/Musica/2.3.png';
        $scope.proximoMusica = 20;
        $scope.proximoimgMusica = 'img/badges/Categorias/Musica/3.1.png';
        document.getElementById("Musica").src="img/badges/Categorias/Musica/3.png"
      }
      if(badges.length >= 20 && badges.length < 22 ){
        $scope.anteriorimgMusica = 'img/badges/Categorias/Musica/3.png';
        $scope.proximoMusica = 25;
        $scope.proximoimgMusica = 'img/badges/Categorias/Musica/3.2.png';
        document.getElementById("Musica").src="img/badges/Categorias/Musica/3.1.png"
      }
      if(badges.length >= 25 && badges.length < 30 ){
        $scope.anteriorimgMusica = 'img/badges/Categorias/Musica/3.1.png';
        $scope.proximoMusica = 30;
        $scope.proximoimgMusica = 'img/badges/Categorias/Musica/3.3.png';
        document.getElementById("Musica").src="img/badges/Categorias/Musica/3.2.png"
      }
      if(badges.length >= 30 && badges.length < 50 ){
        $scope.anteriorimgMusica = 'img/badges/Categorias/Musica/3.2.png';
        $scope.proximoMusica = 50;
        $scope.proximoimgMusica = 'img/badges/Categorias/Musica/Super.png';
        document.getElementById("Musica").src="img/badges/Categorias/Musica/3.3.png"
      }

      if(badges.length >= 50){
        $scope.anteriorimgMusica = 'img/badges/Categorias/Musica/3.3.png';
        $scope.proximoMusica = 10000;
        $scope.proximoimgMusica = 'img/badges/Categorias/Musica/Super.png';
        document.getElementById("Musica").src="img/badges/Categorias/Musica/Super.png"
      }

    }else{
      $scope.auxnbadgeMusica = 0;
        $scope.anteriorimgMusica = 'img/badges/Categorias/Musica/0.png';
        $scope.proximoMusica = 1;
        $scope.proximoimgMusica = 'img/badges/Categorias/Musica/1.png';
      document.getElementById("Musica").src="img/badges/Categorias/Musica/0.png"
    }
  });

  $scope.aux.tag = "#Natureza";
  $scope.auxnbadgeNatureza = 0;
  $scope.proximoNatureza = 0;
  $scope.proximoimgNatureza = '';
  $scope.anteriorimgNatureza = '';
  EventoService.getbadges($scope.aux).then(function(badges){
    //console.log("badges", badges);
    if(badges!="Error" && badges !="E"){
      $scope.auxnbadgeNatureza = badges.length;
      if(badges.length == 0){
        $scope.anteriorimgNatureza = 'img/badges/Categorias/Natureza/0.png';
        $scope.proximoNatureza = 1;
        $scope.proximoimgNatureza = 'img/badges/Categorias/Natureza/1.png';
        document.getElementById("Natureza").src="img/badges/Categorias/Natureza/0.png"
      }
      if(badges.length == 1){
        $scope.anteriorimgNatureza = 'img/badges/Categorias/Natureza/0.png';
        $scope.proximoNatureza = 2;
        $scope.proximoimgNatureza = 'img/badges/Categorias/Natureza/1.1.png';
        document.getElementById("Natureza").src="img/badges/Categorias/Natureza/1.png"
      }
      if(badges.length == 2){
        $scope.anteriorimgNatureza = 'img/badges/Categorias/Natureza/1.png';
        $scope.proximoNatureza = 3;
        $scope.proximoimgNatureza = 'img/badges/Categorias/Natureza/1.2.png';
        document.getElementById("Natureza").src="img/badges/Categorias/Natureza/1.1.png"
      }
      if(badges.length == 3){
        $scope.anteriorimgNatureza = 'img/badges/Categorias/Natureza/1.1.png';
        $scope.proximoNatureza = 4;
        $scope.proximoimgNatureza = 'img/badges/Categorias/Natureza/1.3.png';
        document.getElementById("Natureza").src="img/badges/Categorias/Natureza/1.2.png"
      }
      if(badges.length == 4 || badges.length == 5){
        $scope.anteriorimgNatureza = 'img/badges/Categorias/Natureza/1.2.png';
        $scope.proximoNatureza = 6;
        $scope.proximoimgNatureza = 'img/badges/Categorias/Natureza/2.png';
        document.getElementById("Natureza").src="img/badges/Categorias/Natureza/1.3.png"
      }

      if(badges.length == 6 || badges.length == 7){
        $scope.anteriorimgNatureza = 'img/badges/Categorias/Natureza/1.3.png';
        $scope.proximoNatureza = 8;
        $scope.proximoimgNatureza = 'img/badges/Categorias/Natureza/2.1.png';
        document.getElementById("Natureza").src="img/badges/Categorias/Natureza/2.png"
      }
      if(badges.length == 8 || badges.length == 9){
        $scope.anteriorimgNatureza = 'img/badges/Categorias/Natureza/2.png';
        $scope.proximoNatureza = 10;
        $scope.proximoimgNatureza = 'img/badges/Categorias/Natureza/2.2.png';
        document.getElementById("Natureza").src="img/badges/Categorias/Natureza/2.1.png"
      }
      if(badges.length == 10 || badges.length == 11){
        $scope.anteriorimgNatureza = 'img/badges/Categorias/Natureza/2.1.png';
        $scope.proximoNatureza = 12;
        $scope.proximoimgNatureza = 'img/badges/Categorias/Natureza/2.3.png';
        document.getElementById("Natureza").src="img/badges/Categorias/Natureza/2.2.png"
      }
      if(badges.length == 12 || badges.length == 13 || badges.length == 14){
        $scope.anteriorimgNatureza = 'img/badges/Categorias/Natureza/2.2.png';
        $scope.proximoNatureza = 15;
        $scope.proximoimgNatureza = 'img/badges/Categorias/Natureza/3.png';
        document.getElementById("Natureza").src="img/badges/Categorias/Natureza/2.3.png"
      }

      if(badges.length >= 15 && badges.length < 20 ){
        $scope.anteriorimgNatureza = 'img/badges/Categorias/Natureza/2.3.png';
        $scope.proximoNatureza = 20;
        $scope.proximoimgNatureza = 'img/badges/Categorias/Natureza/3.1.png';
        document.getElementById("Natureza").src="img/badges/Categorias/Natureza/3.png"
      }
      if(badges.length >= 20 && badges.length < 22 ){
        $scope.anteriorimgNatureza = 'img/badges/Categorias/Natureza/3.png';
        $scope.proximoNatureza = 25;
        $scope.proximoimgNatureza = 'img/badges/Categorias/Natureza/3.2.png';
        document.getElementById("Natureza").src="img/badges/Categorias/Natureza/3.1.png"
      }
      if(badges.length >= 25 && badges.length < 30 ){
        $scope.anteriorimgNatureza = 'img/badges/Categorias/Natureza/3.1.png';
        $scope.proximoNatureza = 30;
        $scope.proximoimgNatureza = 'img/badges/Categorias/Natureza/3.3.png';
        document.getElementById("Natureza").src="img/badges/Categorias/Natureza/3.2.png"
      }
      if(badges.length >= 30 && badges.length < 50 ){
        $scope.anteriorimgNatureza = 'img/badges/Categorias/Natureza/3.2.png';
        $scope.proximoNatureza = 50;
        $scope.proximoimgNatureza = 'img/badges/Categorias/Natureza/Super.png';
        document.getElementById("Natureza").src="img/badges/Categorias/Natureza/3.3.png"
      }

      if(badges.length >= 50){
        $scope.anteriorimgNatureza = 'img/badges/Categorias/Natureza/3.3.png';
        $scope.proximoNatureza = 10000;
        $scope.proximoimgNatureza = 'img/badges/Categorias/Natureza/Super.png';
        document.getElementById("Natureza").src="img/badges/Categorias/Natureza/Super.png"
      }

    }else{
      $scope.auxnbadgeNatureza = 0;
        $scope.anteriorimgNatureza = 'img/badges/Categorias/Natureza/0.png';
        $scope.proximoNatureza = 1;
        $scope.proximoimgNatureza = 'img/badges/Categorias/Natureza/1.png';
      document.getElementById("Natureza").src="img/badges/Categorias/Natureza/0.png"
    }
  });

  $scope.aux.tag = "#Passeio";
  $scope.auxnbadgePasseio = 0;
  $scope.proximoPasseio = 0;
  $scope.proximoimgPasseio = '';
  $scope.anteriorimgPasseio = '';
  EventoService.getbadges($scope.aux).then(function(badges){
    //console.log("badges", badges);
    if(badges!="Error" && badges !="E"){
      $scope.auxnbadgePasseio = badges.length;
      if(badges.length == 0){
        $scope.anteriorimgPasseio = 'img/badges/Categorias/Passeio/0.png';
        $scope.proximoPasseio = 1;
        $scope.proximoimgPasseio = 'img/badges/Categorias/Passeio/1.png';
        document.getElementById("Passeio").src="img/badges/Categorias/Passeio/0.png"
      }
      if(badges.length == 1){
        $scope.anteriorimgPasseio = 'img/badges/Categorias/Passeio/0.png';
        $scope.proximoPasseio = 2;
        $scope.proximoimgPasseio = 'img/badges/Categorias/Passeio/1.1.png';
        document.getElementById("Passeio").src="img/badges/Categorias/Passeio/1.png"
      }
      if(badges.length == 2){
        $scope.anteriorimgPasseio = 'img/badges/Categorias/Passeio/1.png';
        $scope.proximoPasseio = 3;
        $scope.proximoimgPasseio = 'img/badges/Categorias/Passeio/1.2.png';
        document.getElementById("Passeio").src="img/badges/Categorias/Passeio/1.1.png"
      }
      if(badges.length == 3){
        $scope.anteriorimgPasseio = 'img/badges/Categorias/Passeio/1.1.png';
        $scope.proximoPasseio = 4;
        $scope.proximoimgPasseio = 'img/badges/Categorias/Passeio/1.3.png';
        document.getElementById("Passeio").src="img/badges/Categorias/Passeio/1.2.png"
      }
      if(badges.length == 4 || badges.length == 5){
        $scope.anteriorimgPasseio = 'img/badges/Categorias/Passeio/1.2.png';
        $scope.proximoPasseio = 6;
        $scope.proximoimgPasseio = 'img/badges/Categorias/Passeio/2.png';
        document.getElementById("Passeio").src="img/badges/Categorias/Passeio/1.3.png"
      }

      if(badges.length == 6 || badges.length == 7){
        $scope.anteriorimgPasseio = 'img/badges/Categorias/Passeio/1.3.png';
        $scope.proximoPasseio = 8 ;
        $scope.proximoimgPasseio = 'img/badges/Categorias/Passeio/2.1.png';
        document.getElementById("Passeio").src="img/badges/Categorias/Passeio/2.png"
      }
      if(badges.length == 8 || badges.length == 9){
        $scope.anteriorimgPasseio = 'img/badges/Categorias/Passeio/2.png';
        $scope.proximoPasseio = 10;
        $scope.proximoimgPasseio = 'img/badges/Categorias/Passeio/2.2.png';
        document.getElementById("Passeio").src="img/badges/Categorias/Passeio/2.1.png"
      }
      if(badges.length == 10 || badges.length == 11){
        $scope.anteriorimgPasseio = 'img/badges/Categorias/Passeio/2.1.png';
        $scope.proximoPasseio = 12;
        $scope.proximoimgPasseio = 'img/badges/Categorias/Passeio/2.3.png';
        document.getElementById("Passeio").src="img/badges/Categorias/Passeio/2.2.png"
      }
      if(badges.length == 12 || badges.length == 13 || badges.length == 14){
        $scope.anteriorimgPasseio = 'img/badges/Categorias/Passeio/2.2.png';
        $scope.proximoPasseio = 15;
        $scope.proximoimgPasseio = 'img/badges/Categorias/Passeio/3.png';
        document.getElementById("Passeio").src="img/badges/Categorias/Passeio/2.3.png"
      }

      if(badges.length >= 15 && badges.length < 20 ){
        $scope.anteriorimgPasseio = 'img/badges/Categorias/Passeio/2.3.png';
        $scope.proximoPasseio = 20;
        $scope.proximoimgPasseio = 'img/badges/Categorias/Passeio/3.1.png';
        document.getElementById("Passeio").src="img/badges/Categorias/Passeio/3.png"
      }
      if(badges.length >= 20 && badges.length < 22 ){
        $scope.anteriorimgPasseio = 'img/badges/Categorias/Passeio/3.png';
        $scope.proximoPasseio = 25;
        $scope.proximoimgPasseio = 'img/badges/Categorias/Passeio/3.2.png';
        document.getElementById("Passeio").src="img/badges/Categorias/Passeio/3.1.png"
      }
      if(badges.length >= 25 && badges.length < 30 ){
        $scope.anteriorimgPasseio = 'img/badges/Categorias/Passeio/3.1.png';
        $scope.proximoPasseio = 30;
        $scope.proximoimgPasseio = 'img/badges/Categorias/Passeio/3.3.png';
        document.getElementById("Passeio").src="img/badges/Categorias/Passeio/3.2.png"
      }
      if(badges.length >= 30 && badges.length < 50 ){
        $scope.anteriorimgPasseio = 'img/badges/Categorias/Passeio/3.2.png';
        $scope.proximoPasseio = 50;
        $scope.proximoimgPasseio = 'img/badges/Categorias/Passeio/Super.png';
        document.getElementById("Passeio").src="img/badges/Categorias/Passeio/3.3.png"
      }

      if(badges.length >= 50){
        $scope.anteriorimgPasseio = 'img/badges/Categorias/Passeio/3.3.png';
        $scope.proximoPasseio = 10000;
        $scope.proximoimgPasseio = 'img/badges/Categorias/Passeio/Super.png';
        document.getElementById("Passeio").src="img/badges/Categorias/Passeio/Super.png"
      }

    }else{
      $scope.auxnbadgePasseio = 0;
        $scope.anteriorimgPasseio = 'img/badges/Categorias/Passeio/0.png';
        $scope.proximoPasseio = 1;
        $scope.proximoimgPasseio = 'img/badges/Categorias/Passeio/1.png';
      document.getElementById("Passeio").src="img/badges/Categorias/Passeio/0.png"
    }
  });

  $scope.aux.tag = "#Pets";
  $scope.auxnbadgePets = 0;
  $scope.proximoPets = 0;
  $scope.proximoimgPets = '';
  $scope.anteriorimgPets = '';
  EventoService.getbadges($scope.aux).then(function(badges){
    //console.log("badges", badges);
    if(badges!="Error" && badges !="E"){
      $scope.auxnbadgePets = badges.length;
      if(badges.length == 0){
        $scope.anteriorimgPets = 'img/badges/Categorias/Pets/0.png';
        $scope.proximoPets = 1;
        $scope.proximoimgPets = 'img/badges/Categorias/Pets/1.png';
        document.getElementById("Pets").src="img/badges/Categorias/Pets/0.png"
      }
      if(badges.length == 1){
        $scope.anteriorimgPets = 'img/badges/Categorias/Pets/0.png';
        $scope.proximoPets = 2;
        $scope.proximoimgPets = 'img/badges/Categorias/Pets/1.1.png';
        document.getElementById("Pets").src="img/badges/Categorias/Pets/1.png"
      }
      if(badges.length == 2){
        $scope.anteriorimgPets = 'img/badges/Categorias/Pets/1.png';
        $scope.proximoPets = 3;
        $scope.proximoimgPets = 'img/badges/Categorias/Pets/1.2.png';
        document.getElementById("Pets").src="img/badges/Categorias/Pets/1.1.png"
      }
      if(badges.length == 3){
        $scope.anteriorimgPets = 'img/badges/Categorias/Pets/1.1.png';
        $scope.proximoPets = 4;
        $scope.proximoimgPets = 'img/badges/Categorias/Pets/1.3.png';
        document.getElementById("Pets").src="img/badges/Categorias/Pets/1.2.png"
      }
      if(badges.length == 4 || badges.length == 5){
        $scope.anteriorimgPets = 'img/badges/Categorias/Pets/1.2.png';
        $scope.proximoPets = 6;
        $scope.proximoimgPets = 'img/badges/Categorias/Pets/2.png';
        document.getElementById("Pets").src="img/badges/Categorias/Pets/1.3.png"
      }

      if(badges.length == 6 || badges.length == 7){
        $scope.anteriorimgPets = 'img/badges/Categorias/Pets/1.3.png';
        $scope.proximoPets = 8;
        $scope.proximoimgPets = 'img/badges/Categorias/Pets/2.1.png';
        document.getElementById("Pets").src="img/badges/Categorias/Pets/2.png"
      }
      if(badges.length == 8 || badges.length == 9){
        $scope.anteriorimgPets = 'img/badges/Categorias/Pets/2.png';
        $scope.proximoPets = 10;
        $scope.proximoimgPets = 'img/badges/Categorias/Pets/2.2.png';
        document.getElementById("Pets").src="img/badges/Categorias/Pets/2.1.png"
      }
      if(badges.length == 10 || badges.length == 11){
        $scope.anteriorimgPets = 'img/badges/Categorias/Pets/2.1.png';
        $scope.proximoPets = 12;
        $scope.proximoimgPets = 'img/badges/Categorias/Pets/2.3.png';
        document.getElementById("Pets").src="img/badges/Categorias/Pets/2.2.png"
      }
      if(badges.length == 12 || badges.length == 13 || badges.length == 14){
        $scope.anteriorimgPets = 'img/badges/Categorias/Pets/2.2.png';
        $scope.proximoPets = 15;
        $scope.proximoimgPets = 'img/badges/Categorias/Pets/3.png';
        document.getElementById("Pets").src="img/badges/Categorias/Pets/2.3.png"
      }

      if(badges.length >= 15 && badges.length < 20 ){
        $scope.anteriorimgPets = 'img/badges/Categorias/Pets/2.3.png';
        $scope.proximoPets = 20;
        $scope.proximoimgPets = 'img/badges/Categorias/Pets/3.1.png';
        document.getElementById("Pets").src="img/badges/Categorias/Pets/3.png"
      }
      if(badges.length >= 20 && badges.length < 22 ){
        $scope.anteriorimgPets = 'img/badges/Categorias/Pets/3.png';
        $scope.proximoPets = 25;
        $scope.proximoimgPets = 'img/badges/Categorias/Pets/3.2.png';
        document.getElementById("Pets").src="img/badges/Categorias/Pets/3.1.png"
      }
      if(badges.length >= 25 && badges.length < 30 ){
        $scope.anteriorimgPets = 'img/badges/Categorias/Pets/3.1.png';
        $scope.proximoPets = 30;
        $scope.proximoimgPets = 'img/badges/Categorias/Pets/3.3.png';
        document.getElementById("Pets").src="img/badges/Categorias/Pets/3.2.png"
      }
      if(badges.length >= 30 && badges.length < 50 ){
        $scope.anteriorimgPets = 'img/badges/Categorias/Pets/3.2.png';
        $scope.proximoPets = 50;
        $scope.proximoimgPets = 'img/badges/Categorias/Pets/Super.png';
        document.getElementById("Pets").src="img/badges/Categorias/Pets/3.3.png"
      }

      if(badges.length >= 50){
        $scope.anteriorimgPets = 'img/badges/Categorias/Pets/3.3.png';
        $scope.proximoPets = 10000;
        $scope.proximoimgPets = 'img/badges/Categorias/Pets/Super.png';
        document.getElementById("Pets").src="img/badges/Categorias/Pets/Super.png"
      }

    }else{
      $scope.auxnbadgePets = 0;
        $scope.anteriorimgPets = 'img/badges/Categorias/Pets/0.png';
        $scope.proximoPets = 1;
        $scope.proximoimgPets = 'img/badges/Categorias/Pets/1.png';
      document.getElementById("Pets").src="img/badges/Categorias/Pets/0.png"
    }
  });

  $scope.aux.tag = "#Restaurantesebares";
  $scope.auxnbadgeRestaurantesebares = 0;
  $scope.proximoRestaurantesebares = 0;
  $scope.proximoimgRestaurantesebares = '';
  $scope.anteriorimgRestaurantesebares = '';
  EventoService.getbadges($scope.aux).then(function(badges){
    //console.log("badges", badges);
    if(badges!="Error" && badges !="E"){
      $scope.auxnbadgeRestaurantesebares = badges.length ;
      if(badges.length == 0){
        $scope.anteriorimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/0.png';
        $scope.proximoRestaurantesebares = 1;
        $scope.proximoimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/1.png';
        document.getElementById("Restaurantesebares").src="img/badges/Categorias/Restaurantesebares/0.png"
      }
      if(badges.length == 1){
        $scope.anteriorimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/0.png';
        $scope.proximoRestaurantesebares = 2;
        $scope.proximoimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/1.1.png';
        document.getElementById("Restaurantesebares").src="img/badges/Categorias/Restaurantesebares/1.png"
      }
      if(badges.length == 2){
        $scope.anteriorimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/1.png';
        $scope.proximoRestaurantesebares = 3;
        $scope.proximoimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/1.2.png';
        document.getElementById("Restaurantesebares").src="img/badges/Categorias/Restaurantesebares/1.1.png"
      }
      if(badges.length == 3){
        $scope.anteriorimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/1.1.png';
        $scope.proximoRestaurantesebares = 4;
        $scope.proximoimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/1.3.png';
        document.getElementById("Restaurantesebares").src="img/badges/Categorias/Restaurantesebares/1.2.png"
      }
      if(badges.length == 4 || badges.length == 5){
        $scope.anteriorimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/1.2.png';
        $scope.proximoRestaurantesebares = 6;
        $scope.proximoimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/2.png';
        document.getElementById("Restaurantesebares").src="img/badges/Categorias/Restaurantesebares/1.3.png"
      }

      if(badges.length == 6 || badges.length == 7){
        $scope.anteriorimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/1.3.png';
        $scope.proximoRestaurantesebares = 8;
        $scope.proximoimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/2.1.png';
        document.getElementById("Restaurantesebares").src="img/badges/Categorias/Restaurantesebares/2.png"
      }
      if(badges.length == 8 || badges.length == 9){
        $scope.anteriorimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/2.png';
        $scope.proximoRestaurantesebares = 10;
        $scope.proximoimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/2.2.png';
        document.getElementById("Restaurantesebares").src="img/badges/Categorias/Restaurantesebares/2.1.png"
      }
      if(badges.length == 10 || badges.length == 11){
        $scope.anteriorimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/2.1.png';
        $scope.proximoRestaurantesebares = 12;
        $scope.proximoimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/2.3.png';
        document.getElementById("Restaurantesebares").src="img/badges/Categorias/Restaurantesebares/2.2.png"
      }
      if(badges.length == 12 || badges.length == 13 || badges.length == 14){
        $scope.anteriorimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/2.2.png';
        $scope.proximoRestaurantesebares = 15;
        $scope.proximoimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/3.png';
        document.getElementById("Restaurantesebares").src="img/badges/Categorias/Restaurantesebares/2.3.png"
      }

      if(badges.length >= 15 && badges.length < 20 ){
        $scope.anteriorimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/2.3.png';
        $scope.proximoRestaurantesebares = 20;
        $scope.proximoimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/3.1.png';
        document.getElementById("Restaurantesebares").src="img/badges/Categorias/Restaurantesebares/3.png"
      }
      if(badges.length >= 20 && badges.length < 22 ){
        $scope.anteriorimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/3.png';
        $scope.proximoRestaurantesebares = 25;
        $scope.proximoimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/3.2.png';
        document.getElementById("Restaurantesebares").src="img/badges/Categorias/Restaurantesebares/3.1.png"
      }
      if(badges.length >= 25 && badges.length < 30 ){
        $scope.anteriorimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/3.1.png';
        $scope.proximoRestaurantesebares = 30;
        $scope.proximoimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/3.3.png';
        document.getElementById("Restaurantesebares").src="img/badges/Categorias/Restaurantesebares/3.2.png"
      }
      if(badges.length >= 30 && badges.length < 50 ){
        $scope.anteriorimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/3.2.png';
        $scope.proximoRestaurantesebares = 50;
        $scope.proximoimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/Super.png';
        document.getElementById("Restaurantesebares").src="img/badges/Categorias/Restaurantesebares/3.3.png"
      }

      if(badges.length >= 50){
        $scope.anteriorimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/3.3.png';
        $scope.proximoRestaurantesebares = 10000;
        $scope.proximoimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/Super.png';
        document.getElementById("Restaurantesebares").src="img/badges/Categorias/Restaurantesebares/Super.png"
      }

    }else{
      $scope.auxnbadgeRestaurantesebares = 0;
        $scope.anteriorimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/0.png';
        $scope.proximoRestaurantesebares = 1;
        $scope.proximoimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/1.png';
      document.getElementById("Restaurantesebares").src="img/badges/Categorias/Restaurantesebares/0.png"
    }
  });

  $scope.aux.tag = "#Surf";
  $scope.auxnbadgeSurf = 0;
  $scope.proximoSurf = 0;
  $scope.proximoimgSurf = '';
  $scope.anteriorimgSurf = '';
  EventoService.getbadges($scope.aux).then(function(badges){
    //console.log("badges", badges);
    if(badges!="Error" && badges !="E"){
      $scope.auxnbadgeSurf = badges.length;
      if(badges.length == 0){
        $scope.anteriorimgSurf = 'img/badges/Categorias/Surf/0.png';
        $scope.proximoSurf = 1;
        $scope.proximoimgSurf = 'img/badges/Categorias/Surf/1.png';
        document.getElementById("Surf").src="img/badges/Categorias/Surf/0.png"
      }
      if(badges.length == 1){
        $scope.anteriorimgSurf = 'img/badges/Categorias/Surf/0.png';
        $scope.proximoSurf = 2;
        $scope.proximoimgSurf = 'img/badges/Categorias/Surf/1.1.png';
        document.getElementById("Surf").src="img/badges/Categorias/Surf/1.png"
      }
      if(badges.length == 2){
        $scope.anteriorimgSurf = 'img/badges/Categorias/Surf/1.png';
        $scope.proximoSurf = 3;
        $scope.proximoimgSurf = 'img/badges/Categorias/Surf/1.2.png';
        document.getElementById("Surf").src="img/badges/Categorias/Surf/1.1.png"
      }
      if(badges.length == 3){
        $scope.anteriorimgSurf = 'img/badges/Categorias/Surf/1.1.png';
        $scope.proximoSurf = 4;
        $scope.proximoimgSurf = 'img/badges/Categorias/Surf/1.3.png';
        document.getElementById("Surf").src="img/badges/Categorias/Surf/1.2.png"
      }
      if(badges.length == 4 || badges.length == 5){
        $scope.anteriorimgSurf = 'img/badges/Categorias/Surf/1.2.png';
        $scope.proximoSurf = 6;
        $scope.proximoimgSurf = 'img/badges/Categorias/Surf/2.png';
        document.getElementById("Surf").src="img/badges/Categorias/Surf/1.3.png"
      }

      if(badges.length == 6 || badges.length == 7){
        $scope.anteriorimgSurf = 'img/badges/Categorias/Surf/1.3.png';
        $scope.proximoSurf = 8;
        $scope.proximoimgSurf = 'img/badges/Categorias/Surf/2.1.png';
        document.getElementById("Surf").src="img/badges/Categorias/Surf/2.png"
      }
      if(badges.length == 8 || badges.length == 9){
        $scope.anteriorimgSurf = 'img/badges/Categorias/Surf/2.png';
        $scope.proximoSurf = 10;
        $scope.proximoimgSurf = 'img/badges/Categorias/Surf/2.2.png';
        document.getElementById("Surf").src="img/badges/Categorias/Surf/2.1.png"
      }
      if(badges.length == 10 || badges.length == 11){
        $scope.anteriorimgSurf = 'img/badges/Categorias/Surf/2.1.png';
        $scope.proximoSurf = 12;
        $scope.proximoimgSurf = 'img/badges/Categorias/Surf/2.3.png';
        document.getElementById("Surf").src="img/badges/Categorias/Surf/2.2.png"
      }
      if(badges.length == 12 || badges.length == 13 || badges.length == 14){
        $scope.anteriorimgSurf = 'img/badges/Categorias/Surf/2.2.png';
        $scope.proximoSurf = 15;
        $scope.proximoimgSurf = 'img/badges/Categorias/Surf/3.png';
        document.getElementById("Surf").src="img/badges/Categorias/Surf/2.3.png"
      }

      if(badges.length >= 15 && badges.length < 20 ){
        $scope.anteriorimgSurf = 'img/badges/Categorias/Surf/2.3.png';
        $scope.proximoSurf = 20;
        $scope.proximoimgSurf = 'img/badges/Categorias/Surf/3.1.png';
        document.getElementById("Surf").src="img/badges/Categorias/Surf/3.png"
      }
      if(badges.length >= 20 && badges.length < 22 ){
        $scope.anteriorimgSurf = 'img/badges/Categorias/Surf/3.png';
        $scope.proximoSurf = 25;
        $scope.proximoimgSurf = 'img/badges/Categorias/Surf/3.2.png';
        document.getElementById("Surf").src="img/badges/Categorias/Surf/3.1.png"
      }
      if(badges.length >= 25 && badges.length < 30 ){
        $scope.anteriorimgSurf = 'img/badges/Categorias/Surf/3.1.png';
        $scope.proximoSurf = 30;
        $scope.proximoimgSurf = 'img/badges/Categorias/Surf/3.3.png';
        document.getElementById("Surf").src="img/badges/Categorias/Surf/3.2.png"
      }
      if(badges.length >= 30 && badges.length < 50 ){
        $scope.anteriorimgSurf = 'img/badges/Categorias/Surf/3.2.png';
        $scope.proximoSurf = 50;
        $scope.proximoimgSurf = 'img/badges/Categorias/Surf/Super.png';
        document.getElementById("Surf").src="img/badges/Categorias/Surf/3.3.png"
      }

      if(badges.length >= 50){
        $scope.anteriorimgSurf = 'img/badges/Categorias/Surf/3.3.png';
        $scope.proximoSurf = 10000;
        $scope.proximoimgSurf = 'img/badges/Categorias/Surf/Super.png';
        document.getElementById("Surf").src="img/badges/Categorias/Surf/Super.png"
      }

    }else{
      $scope.auxnbadgeSurf = 0;
        $scope.anteriorimgSurf = 'img/badges/Categorias/Surf/0.png';
        $scope.proximoSurf = 1;
        $scope.proximoimgSurf = 'img/badges/Categorias/Surf/1.png';
      document.getElementById("Surf").src="img/badges/Categorias/Surf/0.png"
    }
  });

  $scope.aux.tag = "#Voluntariado";
  $scope.auxnbadgeVoluntariado = 0;
  $scope.proximoVoluntariado = 0;
  $scope.proximoimgVoluntariado = '';
  $scope.anteriorimgVoluntariado = '';
  EventoService.getbadges($scope.aux).then(function(badges){
    //console.log("Voluntariado", badges);
    if(badges!="Error" && badges !="E"){
      $scope.auxnbadgeVoluntariado = badges.length;
      if(badges.length == 0){
        $scope.anteriorimgVoluntariado = 'img/badges/Categorias/Voluntariado/0.png';
        $scope.proximoVoluntariado = 1;
        $scope.proximoimgVoluntariado = 'img/badges/Categorias/Voluntariado/1.png';
        document.getElementById("Voluntariado").src="img/badges/Categorias/Voluntariado/0.png"
      }
      if(badges.length == 1){
        $scope.anteriorimgVoluntariado = 'img/badges/Categorias/Voluntariado/0.png';
        $scope.proximoVoluntariado = 2;
        $scope.proximoimgVoluntariado = 'img/badges/Categorias/Voluntariado/1.1.png';
        document.getElementById("Voluntariado").src="img/badges/Categorias/Voluntariado/1.png"
      }
      if(badges.length == 2){
        $scope.anteriorimgVoluntariado = 'img/badges/Categorias/Voluntariado/1.png';
        $scope.proximoVoluntariado = 3;
        $scope.proximoimgVoluntariado = 'img/badges/Categorias/Voluntariado/1.2.png';
        document.getElementById("Voluntariado").src="img/badges/Categorias/Voluntariado/1.1.png"
      }
      if(badges.length == 3){
        $scope.anteriorimgVoluntariado = 'img/badges/Categorias/Voluntariado/1.1.png';
        $scope.proximoVoluntariado = 4;
        $scope.proximoimgVoluntariado = 'img/badges/Categorias/Voluntariado/1.3.png';
        document.getElementById("Voluntariado").src="img/badges/Categorias/Voluntariado/1.2.png"
      }
      if(badges.length == 4 || badges.length == 5){
        $scope.anteriorimgVoluntariado = 'img/badges/Categorias/Voluntariado/1.2.png';
        $scope.proximoVoluntariado = 6;
        $scope.proximoimgVoluntariado = 'img/badges/Categorias/Voluntariado/2.png';
        document.getElementById("Voluntariado").src="img/badges/Categorias/Voluntariado/1.3.png"
      }

      if(badges.length == 6 || badges.length == 7){
        $scope.anteriorimgVoluntariado = 'img/badges/Categorias/Voluntariado/1.3.png';
        $scope.proximoVoluntariado = 8;
        $scope.proximoimgVoluntariado = 'img/badges/Categorias/Voluntariado/2.1.png';
        document.getElementById("Voluntariado").src="img/badges/Categorias/Voluntariado/2.png"
      }
      if(badges.length == 8 || badges.length == 9){
        $scope.anteriorimgVoluntariado = 'img/badges/Categorias/Voluntariado/2.png';
        $scope.proximoVoluntariado = 10;
        $scope.proximoimgVoluntariado = 'img/badges/Categorias/Voluntariado/2.2.png';
        document.getElementById("Voluntariado").src="img/badges/Categorias/Voluntariado/2.1.png"
      }
      if(badges.length == 10 || badges.length == 11){
        $scope.anteriorimgVoluntariado = 'img/badges/Categorias/Voluntariado/2.1.png';
        $scope.proximoVoluntariado = 12;
        $scope.proximoimgVoluntariado = 'img/badges/Categorias/Voluntariado/2.3.png';
        document.getElementById("Voluntariado").src="img/badges/Categorias/Voluntariado/2.2.png"
      }
      if(badges.length == 12 || badges.length == 13 || badges.length == 14){
        $scope.anteriorimgVoluntariado = 'img/badges/Categorias/Voluntariado/2.2.png';
        $scope.proximoVoluntariado = 15;
        $scope.proximoimgVoluntariado = 'img/badges/Categorias/Voluntariado/3.png';
        document.getElementById("Voluntariado").src="img/badges/Categorias/Voluntariado/2.3.png"
      }

      if(badges.length >= 15 && badges.length < 20 ){
        $scope.anteriorimgVoluntariado = 'img/badges/Categorias/Voluntariado/2.3.png';
        $scope.proximoVoluntariado = 20;
        $scope.proximoimgVoluntariado = 'img/badges/Categorias/Voluntariado/3.1.png';
        document.getElementById("Voluntariado").src="img/badges/Categorias/Voluntariado/3.png"
      }
      if(badges.length >= 20 && badges.length < 22 ){
        $scope.anteriorimgVoluntariado = 'img/badges/Categorias/Voluntariado/3.png';
        $scope.proximoVoluntariado = 25;
        $scope.proximoimgVoluntariado = 'img/badges/Categorias/Voluntariado/3.2.png';
        document.getElementById("Voluntariado").src="img/badges/Categorias/Voluntariado/3.1.png"
      }
      if(badges.length >= 25 && badges.length < 30 ){
        $scope.anteriorimgVoluntariado = 'img/badges/Categorias/Voluntariado/3.1.png';
        $scope.proximoVoluntariado = 30;
        $scope.proximoimgVoluntariado = 'img/badges/Categorias/Voluntariado/3.3.png';
        document.getElementById("Voluntariado").src="img/badges/Categorias/Voluntariado/3.2.png"
      }
      if(badges.length >= 30 && badges.length < 50 ){
        $scope.anteriorimgVoluntariado = 'img/badges/Categorias/Voluntariado/3.2.png';
        $scope.proximoVoluntariado = 50;
        $scope.proximoimgVoluntariado = 'img/badges/Categorias/Voluntariado/Super.png';
        document.getElementById("Voluntariado").src="img/badges/Categorias/Voluntariado/3.3.png"
      }

      if(badges.length >= 50){
        $scope.anteriorimgVoluntariado = 'img/badges/Categorias/Voluntariado/3.3.png';
        $scope.proximoVoluntariado = 10000;
        $scope.proximoimgVoluntariado = 'img/badges/Categorias/Voluntariado/Super.png';
        document.getElementById("Voluntariado").src="img/badges/Categorias/Voluntariado/Super.png"
      }

    }else{
      $scope.auxnbadgeVoluntariado = 0;
        $scope.anteriorimgVoluntariado = 'img/badges/Categorias/Voluntariado/0.png';
        $scope.proximoVoluntariado = 1;
        $scope.proximoimgVoluntariado = 'img/badges/Categorias/Voluntariado/1.png';
      document.getElementById("Voluntariado").src="img/badges/Categorias/Voluntariado/0.png"
    }
  });
  // $scope.auxnbadgeQuantidadePersonalidades = 0;
  // $scope.proximoQuantidadePersonalidades = 0;
  // $scope.proximoimgQuantidadePersonalidades = '';
  // $scope.anteriorimgQuantidadePersonalidades = '';
  // EventoService.GetComments3($scope.user).then(function(badges){
  //   //console.log("GetComments3", badges.mal,"dasd", badges.ruins);
  //   if(badges.mal != "0,0,0,"){
  //     $scope.auxnbadgeQuantidadePersonalidades = badges.tamanho;
  //     if(badges.tamanho == 0){
  //       $scope.anteriorimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/0.png';
  //       $scope.proximoQuantidadePersonalidades = 1;
  //       $scope.proximoimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/1.png';

  //       document.getElementById("QuantidadePersonalidades").src="img/badges/Geral/Avaliacoes/QuantidadePersonalidades/0.png"
  //     }
  //     if(badges.tamanho >= 1 && badges.tamanho < 5){
  //       $scope.anteriorimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/0.png';
  //       $scope.proximoQuantidadePersonalidades = 5;
  //       $scope.proximoimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/1.1.png';
  //       document.getElementById("QuantidadePersonalidades").src="img/badges/Geral/Avaliacoes/QuantidadePersonalidades/1.png"
  //     }
  //     if(badges.tamanho >= 5 && badges.tamanho < 10){
  //       $scope.anteriorimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/1.png';
  //       $scope.proximoQuantidadePersonalidades = 10;
  //       $scope.proximoimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/1.2.png';
  //       document.getElementById("QuantidadePersonalidades").src="img/badges/Geral/Avaliacoes/QuantidadePersonalidades/1.1.png"
  //     }
  //     if(badges.tamanho >= 10 && badges.tamanho < 15){
  //       $scope.anteriorimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/1.1.png';
  //       $scope.proximoQuantidadePersonalidades = 15;
  //       $scope.proximoimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/1.3.png';
  //       document.getElementById("QuantidadePersonalidades").src="img/badges/Geral/Avaliacoes/QuantidadePersonalidades/1.2.png"
  //     }
  //     if(badges.tamanho >= 15 && badges.tamanho < 30){
  //       $scope.anteriorimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/1.2.png';
  //       $scope.proximoQuantidadePersonalidades = 30;
  //       $scope.proximoimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/2.png';
  //       document.getElementById("QuantidadePersonalidades").src="img/badges/Geral/Avaliacoes/QuantidadePersonalidades/1.3.png"
  //     }

  //     if(badges.tamanho >= 30 && badges.tamanho < 40){
  //       $scope.anteriorimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/1.3.png';
  //       $scope.proximoQuantidadePersonalidades = 40;
  //       $scope.proximoimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/2.1.png';
  //       document.getElementById("QuantidadePersonalidades").src="img/badges/Geral/Avaliacoes/QuantidadePersonalidades/2.png"
  //     }
  //     if(badges.tamanho >= 40 && badges.tamanho < 50){
  //       $scope.anteriorimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/2.png';
  //       $scope.proximoQuantidadePersonalidades = 50;
  //       $scope.proximoimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/2.2.png';
  //       document.getElementById("QuantidadePersonalidades").src="img/badges/Geral/Avaliacoes/QuantidadePersonalidades/2.1.png"
  //     }
  //     if(badges.tamanho >= 50 && badges.tamanho < 60){
  //       $scope.anteriorimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/2.1.png';
  //       $scope.proximoQuantidadePersonalidades = 60;
  //       $scope.proximoimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/2.3.png';
  //       document.getElementById("QuantidadePersonalidades").src="img/badges/Geral/Avaliacoes/QuantidadePersonalidades/2.2.png"
  //     }
  //     if(badges.tamanho >= 60 && badges.tamanho < 80){
  //       $scope.anteriorimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/2.2.png';
  //       $scope.proximoQuantidadePersonalidades = 80;
  //       $scope.proximoimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/3.png';
  //       document.getElementById("QuantidadePersonalidades").src="img/badges/Geral/Avaliacoes/QuantidadePersonalidades/2.3.png"
  //     }

  //     if(badges.tamanho >= 80 && badges.tamanho < 110 ){
  //       $scope.anteriorimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/2.3.png';
  //       $scope.proximoQuantidadePersonalidades = 110;
  //       $scope.proximoimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/3.1.png';
  //       document.getElementById("QuantidadePersonalidades").src="img/badges/Geral/Avaliacoes/QuantidadePersonalidades/3.png"
  //     }
  //     if(badges.tamanho >= 110 && badges.tamanho < 140 ){
  //       $scope.anteriorimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/3.png';
  //       $scope.proximoQuantidadePersonalidades = 140;
  //       $scope.proximoimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/3.2.png';
  //       document.getElementById("QuantidadePersonalidades").src="img/badges/Geral/Avaliacoes/QuantidadePersonalidades/3.1.png"
  //     }
  //     if(badges.tamanho >= 140 && badges.tamanho < 170 ){
  //       $scope.anteriorimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/3.1.png';
  //       $scope.proximoQuantidadePersonalidades = 170;
  //       $scope.proximoimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/3.3.png';
  //       document.getElementById("QuantidadePersonalidades").src="img/badges/Geral/Avaliacoes/QuantidadePersonalidades/3.2.png"
  //     }
  //     if(badges.tamanho >= 170 && badges.tamanho < 230 ){
  //       $scope.anteriorimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/3.2.png';
  //       $scope.proximoQuantidadePersonalidades = 230;
  //       $scope.proximoimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/Super.png';
  //       document.getElementById("QuantidadePersonalidades").src="img/badges/Geral/Avaliacoes/QuantidadePersonalidades/3.3.png"
  //     }

  //     if(badges.tamanho >= 230){
  //       $scope.anteriorimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/3.3.png';
  //       $scope.proximoQuantidadePersonalidades = 10000;
  //       $scope.proximoimgQuantidadePersonalidades = '';
  //       document.getElementById("QuantidadePersonalidades").src="img/badges/Geral/Avaliacoes/QuantidadePersonalidades/Super.png"
  //     }

  //   }else{
  //     document.getElementById("QuantidadePersonalidades").src="img/badges/Geral/Avaliacoes/QuantidadePersonalidades/0.png"
  //   }
  // });

  // $scope.auxnbadgeSmartDealer = 0;
  // $scope.proximoSmartDealer = 0;
  // $scope.proximoimgSmartDealer = '';
  // $scope.anteriorimgSmartDealer = '';
  // EventoService.getbadgesCriouComercio($scope.user).then(function(badges){
  //   //console.log("getbadgesCriouComercio", badges.length);
  //   if(badges!="Error" && badges !="E"){
  //     $scope.auxnbadgeSmartDealer = badges.length;
  //     if(badges.length == 0){
  //       $scope.anteriorimgSmartDealer = '"img/badges/Geral/Comercios/SmartDealer/0.png';
  //       $scope.proximoSmartDealer = 1;
  //       $scope.proximoimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/1.png';
  //       document.getElementById("SmartDealer").src="img/badges/Geral/Comercios/SmartDealer/0.png"
  //     }
  //     if(badges.length == 1){
  //       $scope.anteriorimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/0.png';
  //       $scope.proximoSmartDealer = 2;
  //       $scope.proximoimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/1.1.png';
  //       document.getElementById("SmartDealer").src="img/badges/Geral/Comercios/SmartDealer/1.png"
  //     }
  //     if(badges.length == 2){
  //       $scope.anteriorimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/1.png';
  //       $scope.proximoSmartDealer = 3;
  //       $scope.proximoimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/1.2.png';
  //       document.getElementById("SmartDealer").src="img/badges/Geral/Comercios/SmartDealer/1.1.png"
  //     }
  //     if(badges.length == 3){
  //       $scope.anteriorimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/1.1.png';
  //       $scope.proximoSmartDealer = 4;
  //       $scope.proximoimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/1.3.png';
  //       document.getElementById("SmartDealer").src="img/badges/Geral/Comercios/SmartDealer/1.2.png"
  //     }
  //     if(badges.length >= 4 && badges.length < 6){
  //       $scope.anteriorimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/1.2.png';
  //       $scope.proximoSmartDealer = 6;
  //       $scope.proximoimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/2.png';
  //       document.getElementById("SmartDealer").src="img/badges/Geral/Comercios/SmartDealer/1.3.png"
  //     }

  //     if(badges.length >= 6 && badges.length < 8){
  //       $scope.anteriorimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/1.3.png';
  //       $scope.proximoSmartDealer = 8;
  //       $scope.proximoimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/2.1.png';
  //       document.getElementById("SmartDealer").src="img/badges/Geral/Comercios/SmartDealer/2.png"
  //     }
  //     if(badges.length >= 8 && badges.length < 10){
  //       $scope.anteriorimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/2.png';
  //       $scope.proximoSmartDealer = 10;
  //       $scope.proximoimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/2.2.png';
  //       document.getElementById("SmartDealer").src="img/badges/Geral/Comercios/SmartDealer/2.1.png"
  //     }
  //     if(badges.length >= 10 && badges.length < 12){
  //       $scope.anteriorimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/2.1.png';
  //       $scope.proximoSmartDealer = 12;
  //       $scope.proximoimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/2.3.png';
  //       document.getElementById("SmartDealer").src="img/badges/Geral/Comercios/SmartDealer/2.2.png"
  //     }
  //     if(badges.length >= 12 && badges.length < 15){
  //       $scope.anteriorimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/2.2.png';
  //       $scope.proximoSmartDealer = 15;
  //       $scope.proximoimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/3.png';
  //       document.getElementById("SmartDealer").src="img/badges/Geral/Comercios/SmartDealer/2.3.png"
  //     }

  //     if(badges.length >= 15 && badges.length < 20 ){
  //       $scope.anteriorimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/2.3.png';
  //       $scope.proximoSmartDealer = 20;
  //       $scope.proximoimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/3.1.png';
  //       document.getElementById("SmartDealer").src="img/badges/Geral/Comercios/SmartDealer/3.png"
  //     }
  //     if(badges.length >= 20 && badges.length < 25 ){
  //       $scope.anteriorimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/3.png';
  //       $scope.proximoSmartDealer = 25;
  //       $scope.proximoimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/3.2.png';
  //       document.getElementById("SmartDealer").src="img/badges/Geral/Comercios/SmartDealer/3.1.png"
  //     }
  //     if(badges.length >= 25 && badges.length < 30 ){
  //       $scope.anteriorimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/3.1.png';
  //       $scope.proximoSmartDealer = 30;
  //       $scope.proximoimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/3.3.png';
  //       document.getElementById("SmartDealer").src="img/badges/Geral/Comercios/SmartDealer/3.2.png"
  //     }
  //     if(badges.length >= 30 && badges.length < 40 ){
  //       $scope.anteriorimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/3.2.png';
  //       $scope.proximoSmartDealer = 40;
  //       $scope.proximoimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/Super.png';
  //       document.getElementById("SmartDealer").src="img/badges/Geral/Comercios/SmartDealer/3.3.png"
  //     }

  //     if(badges.length >= 40){
  //       $scope.anteriorimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/3.3.png';
  //       $scope.proximoSmartDealer = 10000;
  //       $scope.proximoimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/Super.png';
  //       document.getElementById("SmartDealer").src="img/badges/Geral/Comercios/SmartDealer/Super.png"
  //     }

  //   }else{
  //     document.getElementById("SmartDealer").src="img/badges/Geral/Comercios/SmartDealer/0.png"
  //   }
  // });

  // $scope.auxnbadgeCriador = 0;
  // $scope.proximoCriador = 0;
  // $scope.proximoimgCriador = '';
  // $scope.anteriorimgCriador = '';
  // EventoService.GetCriados($scope.user).then(function(badges) {
  //   if(badges!="Error" && badges !="E"){
  //     $scope.auxnbadgeCriador = badges.length;
  //     if(badges.length == 0){
  //       $scope.anteriorimgCriador = 'img/badges/Geral/Eventos/Criador/0.png';
  //       $scope.proximoCriador = 1;
  //       $scope.proximoimgCriador = 'img/badges/Geral/Eventos/Criador/1.png';
  //       document.getElementById("Criador").src="img/badges/Geral/Eventos/Criador/0.png"
  //     }
  //     if(badges.length == 1){
  //       $scope.anteriorimgCriador = 'img/badges/Geral/Eventos/Criador/0.png';
  //       $scope.proximoCriador = 2;
  //       $scope.proximoimgCriador = 'img/badges/Geral/Eventos/Criador/1.1.png';
  //       document.getElementById("Criador").src="img/badges/Geral/Eventos/Criador/1.png"
  //     }
  //     if(badges.length == 2){
  //       $scope.anteriorimgCriador = 'img/badges/Geral/Eventos/Criador/1.png';
  //       $scope.proximoCriador = 3;
  //       $scope.proximoimgCriador = 'img/badges/Geral/Eventos/Criador/1.2.png';
  //       document.getElementById("Criador").src="img/badges/Geral/Eventos/Criador/1.1.png"
  //     }
  //     if(badges.length == 3){
  //       $scope.anteriorimgCriador = 'img/badges/Geral/Eventos/Criador/1.1.png';
  //       $scope.proximoCriador = 4;
  //       $scope.proximoimgCriador = 'img/badges/Geral/Eventos/Criador/1.3.png';
  //       document.getElementById("Criador").src="img/badges/Geral/Eventos/Criador/1.2.png"
  //     }
  //     if(badges.length >= 4 && badges.length < 6){
  //       $scope.anteriorimgCriador = 'img/badges/Geral/Eventos/Criador/1.2.png';
  //       $scope.proximoCriador = 6;
  //       $scope.proximoimgCriador = 'img/badges/Geral/Eventos/Criador/2.png';
  //       document.getElementById("Criador").src="img/badges/Geral/Eventos/Criador/1.3.png"
  //     }

  //     if(badges.length >= 6 && badges.length < 8){
  //       $scope.anteriorimgCriador = 'img/badges/Geral/Eventos/Criador/1.3.png';
  //       $scope.proximoCriador = 8;
  //       $scope.proximoimgCriador = 'img/badges/Geral/Eventos/Criador/2.1.png';
  //       document.getElementById("Criador").src="img/badges/Geral/Eventos/Criador/2.png"
  //     }
  //     if(badges.length >= 8 && badges.length < 10){
  //       $scope.anteriorimgCriador = 'img/badges/Geral/Eventos/Criador/2.png';
  //       $scope.proximoCriador = 10;
  //       $scope.proximoimgCriador = 'img/badges/Geral/Eventos/Criador/2.2.png';
  //       document.getElementById("Criador").src="img/badges/Geral/Eventos/Criador/2.1.png"
  //     }
  //     if(badges.length >= 10 && badges.length < 12){
  //       $scope.anteriorimgCriador = 'img/badges/Geral/Eventos/Criador/2.1.png';
  //       $scope.proximoCriador = 12;
  //       $scope.proximoimgCriador = 'img/badges/Geral/Eventos/Criador/2.3.png';
  //       document.getElementById("Criador").src="img/badges/Geral/Eventos/Criador/2.2.png"
  //     }
  //     if(badges.length >= 12 && badges.length < 15){
  //       $scope.anteriorimgCriador = 'img/badges/Geral/Eventos/Criador/2.2.png';
  //       $scope.proximoCriador = 15;
  //       $scope.proximoimgCriador = 'img/badges/Geral/Eventos/Criador/3.png';
  //       document.getElementById("Criador").src="img/badges/Geral/Eventos/Criador/2.3.png"
  //     }

  //     if(badges.length >= 15 && badges.length < 20 ){
  //       $scope.anteriorimgCriador = 'img/badges/Geral/Eventos/Criador/2.3.png';
  //       $scope.proximoCriador = 20;
  //       $scope.proximoimgCriador = 'img/badges/Geral/Eventos/Criador/3.1.png';
  //       document.getElementById("Criador").src="img/badges/Geral/Eventos/Criador/3.png"
  //     }
  //     if(badges.length >= 20 && badges.length < 25 ){
  //       $scope.anteriorimgCriador = 'img/badges/Geral/Eventos/Criador/3.png';
  //       $scope.proximoCriador = 25;
  //       $scope.proximoimgCriador = 'img/badges/Geral/Eventos/Criador/3.2.png';
  //       document.getElementById("Criador").src="img/badges/Geral/Eventos/Criador/3.1.png"
  //     }
  //     if(badges.length >= 25 && badges.length < 30 ){
  //       $scope.anteriorimgCriador = 'img/badges/Geral/Eventos/Criador/3.1.png';
  //       $scope.proximoCriador = 30;
  //       $scope.proximoimgCriador = 'img/badges/Geral/Eventos/Criador/3.3.png';
  //       document.getElementById("Criador").src="img/badges/Geral/Eventos/Criador/3.2.png"
  //     }
  //     if(badges.length >= 30 && badges.length < 40 ){
  //       $scope.anteriorimgCriador = 'img/badges/Geral/Eventos/Criador/3.2.png';
  //       $scope.proximoCriador = 40;
  //       $scope.proximoimgCriador = 'img/badges/Geral/Eventos/Criador/Super.png';
  //       document.getElementById("Criador").src="img/badges/Geral/Eventos/Criador/3.3.png"
  //     }

  //     if(badges.length >= 40){
  //       $scope.anteriorimgCriador = 'img/badges/Geral/Eventos/Criador/3.3.png';
  //       $scope.proximoCriador = 10000;
  //       $scope.proximoimgCriador = 'img/badges/Geral/Eventos/Criador/Super.png';
  //       document.getElementById("Criador").src="img/badges/Geral/Eventos/Criador/Super.png"
  //     }

  //   }else{
  //     document.getElementById("Criador").src="img/badges/Geral/Eventos/Criador/0.png"
  //   }
  // });

  // $scope.auxnbadgeParticipante = 0;
  // $scope.proximoParticipante = 0;
  // $scope.proximoimgParticipante = '';
  // $scope.anteriorimgParticipante = '';
  // EventoService.GetParticipanteBagde($scope.user).then(function(badges) {
  //   //console.log(badges.length,"GetParticipanteBagde")
  //   if(badges!="Error" && badges !="E"){
  //     $scope.auxnbadgeParticipante = badges.length;
  //     if(badges.length == 0){
  //       $scope.anteriorimgParticipante = 'img/badges/Geral/Eventos/Participante/0.png';
  //       $scope.proximoParticipante = 1;
  //       $scope.proximoimgParticipante = 'img/badges/Geral/Eventos/Participante/1.png';
  //       document.getElementById("Participante").src="img/badges/Geral/Eventos/Participante/0.png"
  //     }
  //     if(badges.length == 1){
  //       $scope.anteriorimgParticipante = 'img/badges/Geral/Eventos/Participante/0.png';
  //       $scope.proximoParticipante = 2;
  //       $scope.proximoimgParticipante = 'img/badges/Geral/Eventos/Participante/1.1.png';
  //       document.getElementById("Participante").src="img/badges/Geral/Eventos/Participante/1.png"
  //     }
  //     if(badges.length == 2){
  //       $scope.anteriorimgParticipante = 'img/badges/Geral/Eventos/Participante/1.png';
  //       $scope.proximoParticipante = 3;
  //       $scope.proximoimgParticipante = 'img/badges/Geral/Eventos/Participante/1.2.png';
  //       document.getElementById("Participante").src="img/badges/Geral/Eventos/Participante/1.1.png"
  //     }
  //     if(badges.length == 3){
  //       $scope.anteriorimgParticipante = 'img/badges/Geral/Eventos/Participante/1.1.png';
  //       $scope.proximoParticipante = 4;
  //       $scope.proximoimgParticipante = 'img/badges/Geral/Eventos/Participante/1.3.png';
  //       document.getElementById("Participante").src="img/badges/Geral/Eventos/Participante/1.2.png"
  //     }
  //     if(badges.length >= 4 && badges.length < 6){
  //       $scope.anteriorimgParticipante = 'img/badges/Geral/Eventos/Participante/1.2.png';
  //       $scope.proximoParticipante = 6;
  //       $scope.proximoimgParticipante = 'img/badges/Geral/Eventos/Participante/2.png';
  //       document.getElementById("Participante").src="img/badges/Geral/Eventos/Participante/1.3.png"
  //     }

  //     if(badges.length >= 6 && badges.length < 8){
  //       $scope.anteriorimgParticipante = 'img/badges/Geral/Eventos/Participante/1.3.png';
  //       $scope.proximoParticipante = 8;
  //       $scope.proximoimgParticipante = 'img/badges/Geral/Eventos/Participante/2.1.png';
  //       document.getElementById("Participante").src="img/badges/Geral/Eventos/Participante/2.png"
  //     }
  //     if(badges.length >= 8 && badges.length < 10){
  //       $scope.anteriorimgParticipante = 'img/badges/Geral/Eventos/Participante/2.png';
  //       $scope.proximoParticipante = 10;
  //       $scope.proximoimgParticipante = 'img/badges/Geral/Eventos/Participante/2.2.png';
  //       document.getElementById("Participante").src="img/badges/Geral/Eventos/Participante/2.1.png"
  //     }
  //     if(badges.length >= 10 && badges.length < 12){
  //       $scope.anteriorimgParticipante = 'img/badges/Geral/Eventos/Participante/2.1.png';
  //       $scope.proximoParticipante = 12;
  //       $scope.proximoimgParticipante = 'img/badges/Geral/Eventos/Participante/2.3.png';
  //       document.getElementById("Participante").src="img/badges/Geral/Eventos/Participante/2.2.png"
  //     }
  //     if(badges.length >= 12 && badges.length < 20){
  //       $scope.anteriorimgParticipante = 'img/badges/Geral/Eventos/Participante/2.2.png';
  //       $scope.proximoParticipante = 20;
  //       $scope.proximoimgParticipante = 'img/badges/Geral/Eventos/Participante/3.png';
  //       document.getElementById("Participante").src="img/badges/Geral/Eventos/Participante/2.3.png"
  //     }

  //     if(badges.length >= 20 && badges.length < 25 ){
  //       $scope.anteriorimgParticipante = 'img/badges/Geral/Eventos/Participante/2.3.png';
  //       $scope.proximoParticipante = 25;
  //       $scope.proximoimgParticipante = 'img/badges/Geral/Eventos/Participante/3.1.png';
  //       document.getElementById("Participante").src="img/badges/Geral/Eventos/Participante/3.png"
  //     }
  //     if(badges.length >= 25 && badges.length < 30 ){
  //       $scope.anteriorimgParticipante = 'img/badges/Geral/Eventos/Participante/3.png';
  //       $scope.proximoParticipante = 30;
  //       $scope.proximoimgParticipante = 'img/badges/Geral/Eventos/Participante/3.2.png';
  //       document.getElementById("Participante").src="img/badges/Geral/Eventos/Participante/3.1.png"
  //     }
  //     if(badges.length >= 30 && badges.length < 35 ){
  //       $scope.anteriorimgParticipante = 'img/badges/Geral/Eventos/Participante/3.1.png';
  //       $scope.proximoParticipante = 35;
  //       $scope.proximoimgParticipante = 'img/badges/Geral/Eventos/Participante/3.3.png';
  //       document.getElementById("Participante").src="img/badges/Geral/Eventos/Participante/3.2.png"
  //     }
  //     if(badges.length >= 35 && badges.length < 50 ){
  //       $scope.anteriorimgParticipante = 'img/badges/Geral/Eventos/Participante/3.2.png';
  //       $scope.proximoParticipante = 50;
  //       $scope.proximoimgParticipante = 'img/badges/Geral/Eventos/Participante/Super.png';
  //       document.getElementById("Participante").src="img/badges/Geral/Eventos/Participante/3.3.png"
  //     }

  //     if(badges.length >= 50){
  //       $scope.anteriorimgParticipante = 'img/badges/Geral/Eventos/Participante/3.3.png';
  //       $scope.proximoParticipante = 10000;
  //       $scope.proximoimgParticipante = 'img/badges/Geral/Eventos/Participante/Super.png';
  //       document.getElementById("Participante").src="img/badges/Geral/Eventos/Participante/Super.png"
  //     }

  //   }else{
  //     document.getElementById("Participante").src="img/badges/Geral/Eventos/Participante/0.png"
  //   }
  // });

  // $scope.auxnbadgeComentarios = 0;
  // $scope.proximoComentarios = 0;
  // $scope.proximoimgComentarios = '';
  // $scope.anteriorimgComentarios = '';
  // EventoService.GetBadgeComentarioPost($scope.user).then(function(badges) {
  //   //console.log(badges.length,"GetBadgeComentarioPost",badges )
  //   if(badges!="Error" && badges !="E"){
  //     $scope.auxnbadgeComentarios = badges.length;
  //     //console.log("faisdfniasidn", badges.length)
  //     if(badges.length == 0){
  //       $scope.anteriorimgComentarios = 'img/badges/Geral/Posts/Comentarios/0.png';
  //       $scope.proximoComentarios = 1;
  //       $scope.proximoimgComentarios = 'img/badges/Geral/Posts/Comentarios/1.png';
  //       document.getElementById("Comentarios").src="img/badges/Geral//Posts/Comentarios/0.png"
  //     }
  //     if(badges.length >= 1 && badges.length < 5){
  //       $scope.anteriorimgComentarios = 'img/badges/Geral/Posts/Comentarios/0.png';
  //       $scope.proximoComentarios = 5;
  //       $scope.proximoimgComentarios = 'img/badges/Geral/Posts/Comentarios/1.1.png';
  //       document.getElementById("Comentarios").src="img/badges/Geral/Posts/Comentarios/1.png"
  //     }
  //     if(badges.length >= 5 && badges.length < 10){
  //       $scope.anteriorimgComentarios = 'img/badges/Geral/Posts/Comentarios/1.png';
  //       $scope.proximoComentarios = 10;
  //       $scope.proximoimgComentarios = 'img/badges/Geral/Posts/Comentarios/1.2.png';
  //       document.getElementById("Comentarios").src="img/badges/Geral/Posts/Comentarios/1.1.png"
  //     }
  //     if(badges.length >= 10 && badges.length < 15){
  //       $scope.anteriorimgComentarios = 'img/badges/Geral/Posts/Comentarios/1.1.png';
  //       $scope.proximoComentarios = 15;
  //       $scope.proximoimgComentarios = 'img/badges/Geral/Posts/Comentarios/1.3.png';
  //       document.getElementById("Comentarios").src="img/badges/Geral/Posts/Comentarios/1.2.png"
  //     }
  //     if(badges.length >= 15 && badges.length < 30){
  //       $scope.anteriorimgComentarios = 'img/badges/Geral/Posts/Comentarios/1.2.png';
  //       $scope.proximoComentarios = 30;
  //       $scope.proximoimgComentarios = 'img/badges/Geral/Posts/Comentarios/2.png';
  //       console.log("faisdfniasidn")
  //       document.getElementById("Comentarios").src="img/badges/Geral/Posts/Comentarios/1.3.png"
  //     }

  //     if(badges.length >= 30 && badges.length < 40){
  //       $scope.anteriorimgComentarios = 'img/badges/Geral/Posts/Comentarios/1.3.png';
  //       $scope.proximoComentarios = 40;
  //       $scope.proximoimgComentarios = 'img/badges/Geral/Posts/Comentarios/2.1.png';
  //       document.getElementById("Comentarios").src="img/badges/Geral/Posts/Comentarios/2.png"
  //     }
  //     if(badges.length >= 40 && badges.length < 50){
  //       $scope.anteriorimgComentarios = 'img/badges/Geral/Posts/Comentarios/2.png';
  //       $scope.proximoComentarios = 50;
  //       $scope.proximoimgComentarios = 'img/badges/Geral/Posts/Comentarios/2.2.png';
  //       document.getElementById("Comentarios").src="img/badges/Geral/Posts/Comentarios/2.1.png"
  //     }
  //     if(badges.length >= 50 && badges.length < 60){
  //       $scope.anteriorimgComentarios = 'img/badges/Geral/Posts/Comentarios/2.1.png';
  //       $scope.proximoComentarios = 60;
  //       $scope.proximoimgComentarios = 'img/badges/Geral/Posts/Comentarios/2.3.png';
  //       document.getElementById("Comentarios").src="img/badges/Geral/Posts/Comentarios/2.2.png"
  //     }
  //     if(badges.length >= 60 && badges.length < 80){
  //       $scope.anteriorimgComentarios = 'img/badges/Geral/Posts/Comentarios/2.2.png';
  //       $scope.proximoComentarios = 80;
  //       $scope.proximoimgComentarios = 'img/badges/Geral/Posts/Comentarios/3.png';
  //       document.getElementById("Comentarios").src="img/badges/Geral/Posts/Comentarios/2.3.png"
  //     }

  //     if(badges.length >= 80 && badges.length < 110 ){
  //       $scope.anteriorimgComentarios = 'img/badges/Geral/Posts/Comentarios/2.3.png';
  //       $scope.proximoComentarios = 110;
  //       $scope.proximoimgComentarios = 'img/badges/Geral/Posts/Comentarios/3.1.png';
  //       document.getElementById("Comentarios").src="img/badges/Geral/Posts/Comentarios/3.png"
  //     }
  //     if(badges.length >= 110 && badges.length < 140 ){
  //       $scope.anteriorimgComentarios = 'img/badges/Geral/Posts/Comentarios/3.png';
  //       $scope.proximoComentarios = 140;
  //       $scope.proximoimgComentarios = 'img/badges/Geral/Posts/Comentarios/3.2.png';
  //       document.getElementById("Comentarios").src="img/badges/Geral/Posts/Comentarios/3.1.png"
  //     }
  //     if(badges.length >= 140 && badges.length < 170 ){
  //       $scope.anteriorimgComentarios = 'img/badges/Geral/Posts/Comentarios/3.1.png';
  //       $scope.proximoComentarios = 170;
  //       $scope.proximoimgComentarios = 'img/badges/Geral/Posts/Comentarios/3.3.png';
  //       document.getElementById("Comentarios").src="img/badges/Geral/Posts/Comentarios/3.2.png"
  //     }
  //     if(badges.length >= 170 && badges.length < 230 ){
  //       $scope.anteriorimgComentarios = 'img/badges/Geral/Posts/Comentarios/3.2.png';
  //       $scope.proximoComentarios = 230;
  //       $scope.proximoimgComentarios = 'img/badges/Geral/Posts/Comentarios/Super.png';
  //       document.getElementById("Comentarios").src="img/badges/Geral/Posts/Comentarios/3.3.png"
  //     }

  //     if(badges.length >= 230){
  //       $scope.anteriorimgComentarios = 'img/badges/Geral/Posts/Comentarios/3.3.png';
  //       $scope.proximoComentarios = 10000;
  //       $scope.proximoimgComentarios = 'img/badges/Geral/Posts/Comentarios/Super.png';
  //       document.getElementById("Comentarios").src="img/badges/Geral/Posts/Comentarios/Super.png"
  //     }

  //   }else{
  //     document.getElementById("Comentarios").src="img/badges/Geral/Posts/Comentarios/0.png"
  //   }
  // });

  // $scope.auxnbadgeOriginalPoster = 0;
  // $scope.proximoOriginalPoster = 0;
  // $scope.proximoimgOriginalPoster = '';
  // $scope.anteriorimgOriginalPoster = '';
  // EventoService.GetFeedMeusPost($scope.user).then(function(badges) {
  //   //console.log(badges.length,"GetBadgeComentarioPost",badges )
  //   if(badges!="Error" && badges !="E"){
  //     $scope.auxnbadgeOriginalPoster = badges.length;
  //     //console.log("faisdfniasidn", badges.length)
  //     if(badges.length == 0){
  //       $scope.anteriorimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/0.png';
  //       $scope.proximoOriginalPoster = 1;
  //       $scope.proximoimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/1.png';
  //       document.getElementById("OriginalPoster").src="img/badges/Geral//Posts/OriginalPoster/0.png"
  //     }
  //     if(badges.length >= 1 && badges.length < 3){
  //       $scope.anteriorimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/0.png';
  //       $scope.proximoOriginalPoster = 3;
  //       $scope.proximoimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/1.1.png';
  //       document.getElementById("OriginalPoster").src="img/badges/Geral/Posts/OriginalPoster/1.png"
  //     }
  //     if(badges.length >= 3 && badges.length < 5){
  //       $scope.anteriorimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/1.png';
  //       $scope.proximoOriginalPoster = 5;
  //       $scope.proximoimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/1.2.png';
  //       document.getElementById("OriginalPoster").src="img/badges/Geral/Posts/OriginalPoster/1.1.png"
  //     }
  //     if(badges.length >= 5 && badges.length < 7){
  //       $scope.anteriorimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/1.1.png';
  //       $scope.proximoOriginalPoster = 7;
  //       $scope.proximoimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/1.3.png';
  //       document.getElementById("OriginalPoster").src="img/badges/Geral/Posts/OriginalPoster/1.2.png"
  //     }
  //     if(badges.length >= 7 && badges.length < 10){
  //       $scope.anteriorimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/1.2.png';
  //       $scope.proximoOriginalPoster = 10;
  //       $scope.proximoimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/2.png';
       
  //       document.getElementById("OriginalPoster").src="img/badges/Geral/Posts/OriginalPoster/1.3.png"
  //     }

  //     if(badges.length >= 10 && badges.length < 15){
  //       $scope.anteriorimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/1.3.png';
  //       $scope.proximoOriginalPoster = 15;
  //       $scope.proximoimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/2.1.png';
  //       document.getElementById("OriginalPoster").src="img/badges/Geral/Posts/OriginalPoster/2.png"
  //     }
  //     if(badges.length >= 15 && badges.length < 20){
  //       $scope.anteriorimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/2.png';
  //       $scope.proximoOriginalPoster = 20;
  //       $scope.proximoimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/2.2.png';
  //       document.getElementById("OriginalPoster").src="img/badges/Geral/Posts/OriginalPoster/2.1.png"
  //     }
  //     if(badges.length >= 20 && badges.length < 25){
  //       $scope.anteriorimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/2.1.png';
  //       $scope.proximoOriginalPoster = 25;
  //       $scope.proximoimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/2.3.png';
  //       document.getElementById("OriginalPoster").src="img/badges/Geral/Posts/OriginalPoster/2.2.png"
  //     }
  //     if(badges.length >= 25 && badges.length < 35){
  //       $scope.anteriorimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/2.2.png';
  //       $scope.proximoOriginalPoster = 35;
  //       $scope.proximoimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/3.png';
  //       document.getElementById("OriginalPoster").src="img/badges/Geral/Posts/OriginalPoster/2.3.png"
  //     }

  //     if(badges.length >= 35 && badges.length < 45 ){
  //       $scope.anteriorimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/2.3.png';
  //       $scope.proximoOriginalPoster = 45;
  //       $scope.proximoimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/3.1.png';
  //       document.getElementById("OriginalPoster").src="img/badges/Geral/Posts/OriginalPoster/3.png"
  //     }
  //     if(badges.length >= 45 && badges.length < 55 ){
  //       $scope.anteriorimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/3.png';
  //       $scope.proximoOriginalPoster = 55;
  //       $scope.proximoimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/3.2.png';
  //       document.getElementById("OriginalPoster").src="img/badges/Geral/Posts/OriginalPoster/3.1.png"
  //     }
  //     if(badges.length >= 55 && badges.length < 65 ){
  //       $scope.anteriorimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/3.1.png';
  //       $scope.proximoOriginalPoster = 65;
  //       $scope.proximoimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/3.3.png';
  //       document.getElementById("OriginalPoster").src="img/badges/Geral/Posts/OriginalPoster/3.2.png"
  //     }
  //     if(badges.length >= 65 && badges.length < 80 ){
  //       $scope.anteriorimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/3.2.png';
  //       $scope.proximoOriginalPoster = 80;
  //       $scope.proximoimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/Super.png';
  //       document.getElementById("OriginalPoster").src="img/badges/Geral/Posts/OriginalPoster/3.3.png"
  //     }

  //     if(badges.length >= 80){
  //       $scope.anteriorimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/3.3.png';
  //       $scope.proximoOriginalPoster = 10000;
  //       $scope.proximoimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/Super.png';
  //       document.getElementById("OriginalPoster").src="img/badges/Geral/Posts/OriginalPoster/Super.png"
  //     }

  //   }else{
  //     document.getElementById("OriginalPoster").src="img/badges/Geral/Posts/OriginalPoster/0.png"
  //   }
  // });
  
  // $scope.auxnbadgeUpvotes = 0;
  // $scope.proximoUpvotes = 0;
  // $scope.proximoimgUpvotes = '';
  // $scope.anteriorimgUpvotes = '';
  // EventoService.GetBadgeUpvote($scope.user).then(function(badges) {
  //   console.log(badges.length,"GetBadgeComentarioPost",badges )
  //   if(badges!="Error" && badges !="E"){
  //     $scope.auxnbadgeUpvotes = badges.length;
  //     console.log("faisdfniasidn", badges.length)
  //     if(badges.length == 0){
  //       $scope.anteriorimgUpvotes = 'img/badges/Geral/Posts/Upvotes/0.png';
  //       $scope.proximoUpvotes = 1;
  //       $scope.proximoimgUpvotes = 'img/badges/Geral/Posts/Upvotes/1.png';
  //       document.getElementById("Upvotes").src="img/badges/Geral//Posts/Upvotes/0.png"
  //     }
  //     if(badges.length >= 1 && badges.length < 5){
  //       $scope.anteriorimgUpvotes = 'img/badges/Geral/Posts/Upvotes/0.png';
  //       $scope.proximoUpvotes = 5;
  //       $scope.proximoimgUpvotes = 'img/badges/Geral/Posts/Upvotes/1.1.png';
  //       document.getElementById("Upvotes").src="img/badges/Geral/Posts/Upvotes/1.png"
  //     }
  //     if(badges.length >= 5 && badges.length < 10){
  //       $scope.anteriorimgUpvotes = 'img/badges/Geral/Posts/Upvotes/1.png';
  //       $scope.proximoUpvotes = 10;
  //       $scope.proximoimgUpvotes = 'img/badges/Geral/Posts/Upvotes/1.2.png';
  //       document.getElementById("Upvotes").src="img/badges/Geral/Posts/Upvotes/1.1.png"
  //     }
  //     if(badges.length >= 10 && badges.length < 15){
  //       $scope.anteriorimgUpvotes = 'img/badges/Geral/Posts/Upvotes/1.1.png';
  //       $scope.proximoUpvotes = 15;
  //       $scope.proximoimgUpvotes = 'img/badges/Geral/Posts/Upvotes/1.3.png';
  //       document.getElementById("Upvotes").src="img/badges/Geral/Posts/Upvotes/1.2.png"
  //     }
  //     if(badges.length >= 15 && badges.length < 25){
  //       $scope.anteriorimgUpvotes = 'img/badges/Geral/Posts/Upvotes/1.2.png';
  //       $scope.proximoUpvotes = 25;
  //       $scope.proximoimgUpvotes = 'img/badges/Geral/Posts/Upvotes/2.png';
       
  //       document.getElementById("Upvotes").src="img/badges/Geral/Posts/Upvotes/1.3.png"
  //     }

  //     if(badges.length >= 25 && badges.length < 35){
  //       $scope.anteriorimgUpvotes = 'img/badges/Geral/Posts/Upvotes/1.3.png';
  //       $scope.proximoUpvotes = 35;
  //       $scope.proximoimgUpvotes = 'img/badges/Geral/Posts/Upvotes/2.1.png';
  //       document.getElementById("Upvotes").src="img/badges/Geral/Posts/Upvotes/2.png"
  //     }
  //     if(badges.length >= 35 && badges.length < 45){
  //       $scope.anteriorimgUpvotes = 'img/badges/Geral/Posts/Upvotes/2.png';
  //       $scope.proximoUpvotes = 45;
  //       $scope.proximoimgUpvotes = 'img/badges/Geral/Posts/Upvotes/2.2.png';
  //       document.getElementById("Upvotes").src="img/badges/Geral/Posts/Upvotes/2.1.png"
  //     }
  //     if(badges.length >= 45 && badges.length < 55){
  //       $scope.anteriorimgUpvotes = 'img/badges/Geral/Posts/Upvotes/2.1.png';
  //       $scope.proximoUpvotes = 55;
  //       $scope.proximoimgUpvotes = 'img/badges/Geral/Posts/Upvotes/2.3.png';
  //       document.getElementById("Upvotes").src="img/badges/Geral/Posts/Upvotes/2.2.png"
  //     }
  //     if(badges.length >= 55 && badges.length < 80){
  //       $scope.anteriorimgUpvotes = 'img/badges/Geral/Posts/Upvotes/2.2.png';
  //       $scope.proximoUpvotes = 80;
  //       $scope.proximoimgUpvotes = 'img/badges/Geral/Posts/Upvotes/3.png';
  //       document.getElementById("Upvotes").src="img/badges/Geral/Posts/Upvotes/2.3.png"
  //     }

  //     if(badges.length >= 80 && badges.length < 100 ){
  //       $scope.anteriorimgUpvotes = 'img/badges/Geral/Posts/Upvotes/2.3.png';
  //       $scope.proximoUpvotes = 100;
  //       $scope.proximoimgUpvotes = 'img/badges/Geral/Posts/Upvotes/3.1.png';
  //       document.getElementById("Upvotes").src="img/badges/Geral/Posts/Upvotes/3.png"
  //     }
  //     if(badges.length >= 100 && badges.length < 120 ){
  //       $scope.anteriorimgUpvotes = 'img/badges/Geral/Posts/Upvotes/3.png';
  //       $scope.proximoUpvotes = 120;
  //       $scope.proximoimgUpvotes = 'img/badges/Geral/Posts/Upvotes/3.2.png';
  //       document.getElementById("Upvotes").src="img/badges/Geral/Posts/Upvotes/3.1.png"
  //     }
  //     if(badges.length >= 120 && badges.length < 140 ){
  //       $scope.anteriorimgUpvotes = 'img/badges/Geral/Posts/Upvotes/3.1.png';
  //       $scope.proximoUpvotes = 140;
  //       $scope.proximoimgUpvotes = 'img/badges/Geral/Posts/Upvotes/3.3.png';
  //       document.getElementById("Upvotes").src="img/badges/Geral/Posts/Upvotes/3.2.png"
  //     }
  //     if(badges.length >= 140 && badges.length < 200 ){
  //       $scope.anteriorimgUpvotes = 'img/badges/Geral/Posts/Upvotes/3.2.png';
  //       $scope.proximoUpvotes = 200;
  //       $scope.proximoimgUpvotes = 'img/badges/Geral/Posts/Upvotes/Super.png';
  //       document.getElementById("Upvotes").src="img/badges/Geral/Posts/Upvotes/3.3.png"
  //     }

  //     if(badges.length >= 200){
  //       $scope.anteriorimgUpvotes = 'img/badges/Geral/Posts/Upvotes/3.3.png';
  //       $scope.proximoUpvotes = 100000;
  //       $scope.proximoimgUpvotes = 'img/badges/Geral/Posts/Upvotes/Super.png';
  //       document.getElementById("Upvotes").src="img/badges/Geral/Posts/Upvotes/Super.png"
  //     }

  //   }else{
  //     document.getElementById("Upvotes").src="img/badges/Geral/Posts/Upvotes/0.png"
  //   }
  // });

  $scope.naotembadgescomercio = ""
  EventoService.GetComercioFinalizado($scope.user).then(function(badges) {  //console.log(badges.length,"GetBadgeComentarioPost",badges )
    if(badges!="error" && badges !="e"){
      console.log("faisdfniasidn", badges.length)
      for(var i =0 ;i<badges.length;i++){
        if(badges[i].idcomercio == '53'){
          if(badges[i].n == '1'){
            document.getElementById("Paintball").src="img/badges/Comercios/Paintball/1.png"
          }
          if(badges[i].n == '2'){
            document.getElementById("Paintball").src="img/badges/Comercios/Paintball/2.png"
          }
          if(badges[i].n >= '3'){
            document.getElementById("Paintball").src="img/badges/Comercios/Paintball/3.png"
          }
        }
        if(badges[i].idcomercio == '222'){
          if(badges[i].n == '1'){
            document.getElementById("BarcoPirataItapema").src="img/badges/Comercios/BarcoPirataItapema/1.png"
          }
          if(badges[i].n == '2'){
            document.getElementById("BarcoPirataItapema").src="img/badges/Comercios/BarcoPirataItapema/2.png"
          }
          if(badges[i].n >= '3'){
            document.getElementById("BarcoPirataItapema").src="img/badges/Comercios/BarcoPirataItapema/3.png"
          }
        }
        if(badges[i].idcomercio == '223'){
          if(badges[i].n == '1'){
            document.getElementById("BCWalkingTour").src="img/badges/Comercios/BCWalkingTour/1.png"
          }
          if(badges[i].n == '2'){
            document.getElementById("BCWalkingTour").src="img/badges/Comercios/BCWalkingTour/2.png"
          }
          if(badges[i].n >= '3'){
            document.getElementById("BCWalkingTour").src="img/badges/Comercios/BCWalkingTour/3.png"
          }
        }
        if(badges[i].idcomercio == '225'){
          if(badges[i].n == '1'){
            document.getElementById("BravaBeachSports").src="img/badges/Comercios/BravaBeachSports/1.png"
          }
          if(badges[i].n == '2'){
            document.getElementById("BravaBeachSports").src="img/badges/Comercios/BravaBeachSports/2.png"
          }
          if(badges[i].n >= '3'){
            document.getElementById("BravaBeachSports").src="img/badges/Comercios/BravaBeachSports/3.png"
          }
        }
        if(badges[i].idcomercio == '227'){
          if(badges[i].n == '1'){
            document.getElementById("MVBTennisPaddel").src="img/badges/Comercios/MVBTennisPaddel/1.png"
          }
          if(badges[i].n == '2'){
            document.getElementById("MVBTennisPaddel").src="img/badges/Comercios/MVBTennisPaddel/2.png"
          }
          if(badges[i].n >= '3'){
            document.getElementById("MVBTennisPaddel").src="img/badges/Comercios/MVBTennisPaddel/3.png"
          }
        }
        
        if(badges[i].idcomercio == '228'){
          if(badges[i].n == '1'){
            document.getElementById("TriboDaÁgua").src="img/badges/Comercios/TriboDaÁgua/1.png"
          }
          if(badges[i].n == '2'){
            document.getElementById("TriboDaÁgua").src="img/badges/Comercios/TriboDaÁgua/2.png"
          }
          if(badges[i].n >= '3'){
            document.getElementById("TriboDaÁgua").src="img/badges/Comercios/TriboDaÁgua/3.png"
          }
        }
      }
            

    }else{
      $scope.naotembadgescomercio = "Ainda não há nenhuma conquista em locais parceiros"
    }
  });
  $scope.naotembadgesgeral = ""
  $scope.auxnbadgeNumberOneHExa = 0;
  $scope.proximoNumberOneHExa = 0;
  $scope.proximoimgNumberOneHExa = '';
  $scope.anteriorimgNumberOneHExa = '';
  EventoService.getusuario($scope.user).then(function(user) {
      $scope.user = user;
      if(user.numcodigo){
        if(user.numcodigo == '0'){
          $scope.auxnbadgeNumberOneHExa = 0;
          $scope.anteriorimgNumberOneHExa = 'img/egg_0.png';
          $scope.proximoNumberOneHExa = 1;
          $scope.proximoimgNumberOneHExa = 'img/egg_1.png';
          document.getElementById("NumberOneHExa").src="img/egg_0.png";
        }
        if(user.numcodigo == '1'){
          $scope.auxnbadgeNumberOneHExa = 1;
          $scope.anteriorimgNumberOneHExa = 'img/egg_0.png';
          $scope.proximoNumberOneHExa = 2;
          $scope.proximoimgNumberOneHExa = 'img/egg_2.png';
          document.getElementById("NumberOneHExa").src="img/egg_1.png";
        }
        if(user.numcodigo == '2'){
          $scope.auxnbadgeNumberOneHExa = 2;
          $scope.anteriorimgNumberOneHExa = 'img/egg_1.png';
          $scope.proximoNumberOneHExa = 3;
          $scope.proximoimgNumberOneHExa = 'img/NumberOneHExa.png';
          document.getElementById("NumberOneHExa").src="img/egg_2.png";
        }
        if(parseInt(user.numcodigo) >= 3){
          $scope.auxnbadgeNumberOneHExa = 3;
          $scope.anteriorimgNumberOneHExa = 'img/egg_2.png';
          $scope.proximoNumberOneHExa = 1000;
          $scope.proximoimgNumberOneHExa = 'img/NumberOneHExa.png';
          document.getElementById("NumberOneHExa").src="img/NumberOneHExa.png";
        }
        if(parseInt(user.numcodigo) < 0){
          $scope.auxnbadgeNumberOneHExa = 3;
          $scope.anteriorimgNumberOneHExa = 'img/egg_2.png';
          $scope.proximoNumberOneHExa = 1000;
          $scope.proximoimgNumberOneHExa = 'img/NumberOneHExa.png';
          document.getElementById("NumberOneHExa").src="img/NumberOneHExa.png";
        } 
      }else{
        $scope.naotembadgesgeral = "Ainda não há nenhuma conquista aqui"
      }
      

  });

  $scope.entraBadge = function(badge){
    console.log("badge",badge);
    $scope.badge = {};
    if(badge == 'QuantidadePersonalidades'){
      $scope.badge.titulo = 'Self Awareness';
      $scope.badge.texto = 'Quanto mais avaliações referentes à nossa personalidade, mais entendemos como as pessoas nos veem. Isso pode ser útil para nos conhecermos melhor!';
      $scope.badge.numeroatual = $scope.auxnbadgeQuantidadePersonalidades;
      $scope.badge.numeroproximo = $scope.proximoQuantidadePersonalidades
      $scope.badge.imgatual = document.getElementById("QuantidadePersonalidades").src;
      $scope.badge.imganterior = $scope.anteriorimgQuantidadePersonalidades;
      $scope.badge.imgproximo = $scope.proximoimgQuantidadePersonalidades;
      formBadge.updateForm($scope.badge);
      $state.go('tabsController.badgesexplicaPerfilPost');
    }
    if(badge == 'SmartDealer'){
      $scope.badge.titulo = 'Smart Dealer';
      $scope.badge.texto = 'Um Din Din Baggy é inteligente, ele cria eventos que oferecem recompensas para gastar menos fazendo mais.';
      $scope.badge.numeroatual = $scope.auxnbadgeSmartDealer;
      $scope.badge.numeroproximo = $scope.proximoSmartDealer
      $scope.badge.imgatual = document.getElementById("SmartDealer").src;
      $scope.badge.imganterior = $scope.anteriorimgSmartDealer;
      $scope.badge.imgproximo = $scope.proximoimgSmartDealer;
      formBadge.updateForm($scope.badge);
      $state.go('tabsController.badgesexplicaPerfilPost');
    }
    if(badge == 'Criador'){
      $scope.badge.titulo = 'Creator';
      $scope.badge.texto = 'Cria eventos no app';
      $scope.badge.numeroatual = $scope.auxnbadgeCriador;
      $scope.badge.numeroproximo = $scope.proximoCriador
      $scope.badge.imgatual = document.getElementById("Criador").src;
      $scope.badge.imganterior = $scope.anteriorimgCriador;
      $scope.badge.imgproximo = $scope.proximoimgCriador;
      formBadge.updateForm($scope.badge);
      $state.go('tabsController.badgesexplicaPerfilPost');
    }
    if(badge == 'Participante'){
      $scope.badge.titulo = 'Story Maker';
      $scope.badge.texto = 'Participa de eventos no app';
      $scope.badge.numeroatual = $scope.auxnbadgeParticipante;
      $scope.badge.numeroproximo = $scope.proximoParticipante;
      $scope.badge.imgatual = document.getElementById("Participante").src;
      $scope.badge.imganterior = $scope.anteriorimgParticipante;
      $scope.badge.imgproximo = $scope.proximoimgParticipante;
      formBadge.updateForm($scope.badge);
      $state.go('tabsController.badgesexplicaPerfilPost');
    }
    if(badge == 'Comentarios'){
      $scope.badge.titulo = 'Community Activist';
      $scope.badge.texto = 'Um(a) ativista da sua comunidade local através de comentários em posts';
      $scope.badge.numeroatual = $scope.auxnbadgeComentarios;
      $scope.badge.numeroproximo = $scope.proximoComentarios
      $scope.badge.imgatual = document.getElementById("Comentarios").src;
      $scope.badge.imganterior = $scope.anteriorimgComentarios;
      $scope.badge.imgproximo = $scope.proximoimgComentarios;
      formBadge.updateForm($scope.badge);
      $state.go('tabsController.badgesexplicaPerfilPost');
    }
    if(badge == 'OriginalPoster'){
      $scope.badge.titulo = 'Original Poster';
      $scope.badge.texto = 'Cria engajamento da sua comunidade local através da criação de posts';
      $scope.badge.numeroatual = $scope.auxnbadgeOriginalPoster;
      $scope.badge.numeroproximo = $scope.proximoOriginalPoster
      $scope.badge.imgatual = document.getElementById("OriginalPoster").src;
      $scope.badge.imganterior = $scope.anteriorimgOriginalPoster;
      $scope.badge.imgproximo = $scope.proximoimgOriginalPoster;
      formBadge.updateForm($scope.badge);
      $state.go('tabsController.badgesexplicaPerfilPost');
    }
    if(badge == 'Upvotes'){
      $scope.badge.titulo = 'Community Supporter';
      $scope.badge.texto = 'Um suporte da sua comunidade local que ajuda a filtrar os bons posts dos ruins através de upvotes';
      $scope.badge.numeroatual = $scope.auxnbadgeUpvotes;
      $scope.badge.numeroproximo = $scope.proximoUpvotes
      $scope.badge.imgatual = document.getElementById("Upvotes").src;
      $scope.badge.imganterior = $scope.anteriorimgUpvotes;
      $scope.badge.imgproximo = $scope.proximoimgUpvotes;
      formBadge.updateForm($scope.badge);
      $state.go('tabsController.badgesexplicaPerfilPost');
    }
    if(badge == 'NumberOneHExa'){
      $scope.badge.titulo = 'Amigo que chama';
      $scope.badge.texto = 'Convida amigos quando descobre um app novo';
      $scope.badge.numeroatual = $scope.auxnbadgeNumberOneHExa;
      $scope.badge.numeroproximo = $scope.proximoNumberOneHExa
      $scope.badge.imgatual = document.getElementById("NumberOneHExa").src;
      $scope.badge.imganterior = $scope.anteriorimgNumberOneHExa;
      $scope.badge.imgproximo = $scope.proximoimgNumberOneHExa;
      formBadge.updateForm($scope.badge);
      $state.go('tabsController.badgesexplicaPerfilPost');
    }
    if(badge == 'ArteeCultura'){
      $scope.badge.titulo = 'Cult';
      $scope.badge.texto = 'Você participou de eventos com #ArteeCultura';
      $scope.badge.numeroatual = $scope.auxnbadgeArteeCultura;
      $scope.badge.numeroproximo = $scope.proximoArteeCultura
      $scope.badge.imgatual = document.getElementById("ArteeCultura").src;
      $scope.badge.imganterior = $scope.anteriorimgArteeCultura;
      $scope.badge.imgproximo = $scope.proximoimgArteeCultura;
      formBadge.updateForm($scope.badge);
      $state.go('tabsController.badgesexplicaPerfilPost');
    }
    if(badge == 'Ciclismo'){
      $scope.badge.titulo = 'Pedal';
      $scope.badge.texto = 'Você participou de eventos com #Ciclismo';
      $scope.badge.numeroatual = $scope.auxnbadgeCiclismo;
      $scope.badge.numeroproximo = $scope.proximoCiclismo
      $scope.badge.imgatual = document.getElementById("Ciclismo").src;
      $scope.badge.imganterior = $scope.anteriorimgCiclismo;
      $scope.badge.imgproximo = $scope.proximoimgCiclismo;
      formBadge.updateForm($scope.badge);
      $state.go('tabsController.badgesexplicaPerfilPost');
    }
    if(badge == 'Conversa'){
      $scope.badge.titulo = 'Falador(a)';
      $scope.badge.texto = 'Você participou de eventos com #Conversa';
      $scope.badge.numeroatual = $scope.auxnbadgeConversa;
      $scope.badge.numeroproximo = $scope.proximoConversa
      $scope.badge.imgatual = document.getElementById("Conversa").src;
      $scope.badge.imganterior = $scope.anteriorimgConversa;
      $scope.badge.imgproximo = $scope.proximoimgConversa;
      formBadge.updateForm($scope.badge);
      $state.go('tabsController.badgesexplicaPerfilPost');
    }
    if(badge == 'Danca'){
      $scope.badge.titulo = 'Pés de valsa';
      $scope.badge.texto = 'Você participou de eventos com #Dança';
      $scope.badge.numeroatual = $scope.auxnbadgeDanca;
      $scope.badge.numeroproximo = $scope.proximoDanca
      $scope.badge.imgatual = document.getElementById("Danca").src;
      $scope.badge.imganterior = $scope.anteriorimgDanca;
      $scope.badge.imgproximo = $scope.proximoimgDanca;
      formBadge.updateForm($scope.badge);
      $state.go('tabsController.badgesexplicaPerfilPost');
    }
    if(badge == 'EsportesdePraia'){
      $scope.badge.titulo = 'Esportes de Praia';
      $scope.badge.texto = 'Você participou de eventos com #EsportesdePraia';
      $scope.badge.numeroatual = $scope.auxnbadgeEsportesdePraia;
      $scope.badge.numeroproximo = $scope.proximoEsportesdePraia
      $scope.badge.imgatual = document.getElementById("EsportesdePraia").src;
      $scope.badge.imganterior = $scope.anteriorimgEsportesdePraia;
      $scope.badge.imgproximo = $scope.proximoimgEsportesdePraia;
      formBadge.updateForm($scope.badge);
      $state.go('tabsController.badgesexplicaPerfilPost');
    }
    if(badge == 'FestaseBaladas'){
      $scope.badge.titulo = 'Da night';
      $scope.badge.texto = 'Você participou de eventos com #FestaseBaladas';
      $scope.badge.numeroatual = $scope.auxnbadgeFestaseBaladas;
      $scope.badge.numeroproximo = $scope.proximoFestaseBaladas
      $scope.badge.imgatual = document.getElementById("FestaseBaladas").src;
      $scope.badge.imganterior = $scope.anteriorimgFestaseBaladas;
      $scope.badge.imgproximo = $scope.proximoimgFestaseBaladas;
      formBadge.updateForm($scope.badge);
      $state.go('tabsController.badgesexplicaPerfilPost');
    }
    if(badge == 'Futebol'){
      $scope.badge.titulo = 'Boleiro';
      $scope.badge.texto = 'Você participou de eventos com #Futebol';
      $scope.badge.numeroatual = $scope.auxnbadgeFutebol;
      $scope.badge.numeroproximo = $scope.proximoFutebol
      $scope.badge.imgatual = document.getElementById("Futebol").src;
      $scope.badge.imganterior = $scope.anteriorimgFutebol;
      $scope.badge.imgproximo = $scope.proximoimgFutebol;
      formBadge.updateForm($scope.badge);
      $state.go('tabsController.badgesexplicaPerfilPost');
    }
    if(badge == 'GrupodeEstudos'){
      $scope.badge.titulo = 'CDF';
      $scope.badge.texto = 'Você participou de eventos com #GrupodeEstudos';
      $scope.badge.numeroatual = $scope.auxnbadgeGrupodeEstudos;
      $scope.badge.numeroproximo = $scope.proximoGrupodeEstudos
      $scope.badge.imgatual = document.getElementById("GrupodeEstudos").src;
      $scope.badge.imganterior = $scope.anteriorimgGrupodeEstudos;
      $scope.badge.imgproximo = $scope.proximoimgGrupodeEstudos;
      formBadge.updateForm($scope.badge);
      $state.go('tabsController.badgesexplicaPerfilPost');
    }
    if(badge == 'Jogos'){
      $scope.badge.titulo = 'Jogador (a)';
      $scope.badge.texto = 'Você participou de eventos com #Jogos';
      $scope.badge.numeroatual = $scope.auxnbadgeJogos;
      $scope.badge.numeroproximo = $scope.proximoJogos
      $scope.badge.imgatual = document.getElementById("Jogos").src;
      $scope.badge.imganterior = $scope.anteriorimgJogos;
      $scope.badge.imgproximo = $scope.proximoimgJogos;
      formBadge.updateForm($scope.badge);
      $state.go('tabsController.badgesexplicaPerfilPost');
    }
    if(badge == 'Musica'){
      $scope.badge.titulo = 'Chill';
      $scope.badge.texto = 'Você participou de eventos com #Musica';
      $scope.badge.numeroatual = $scope.auxnbadgeMusica;
      $scope.badge.numeroproximo = $scope.proximoMusica
      $scope.badge.imgatual = document.getElementById("Musica").src;
      $scope.badge.imganterior = $scope.anteriorimgMusica;
      $scope.badge.imgproximo = $scope.proximoimgMusica;
      formBadge.updateForm($scope.badge);
      $state.go('tabsController.badgesexplicaPerfilPost');
    }
    if(badge == 'Natureza'){
      $scope.badge.titulo = 'Do mato';
      $scope.badge.texto = 'Você participou de eventos com #Natureza';
      $scope.badge.numeroatual = $scope.auxnbadgeNatureza;
      $scope.badge.numeroproximo = $scope.proximoNatureza
      $scope.badge.imgatual = document.getElementById("Natureza").src;
      $scope.badge.imganterior = $scope.anteriorimgNatureza;
      $scope.badge.imgproximo = $scope.proximoimgNatureza;
      formBadge.updateForm($scope.badge);
      $state.go('tabsController.badgesexplicaPerfilPost');
    }
    if(badge == 'Passeio'){
      $scope.badge.titulo = 'Do rolê';
      $scope.badge.texto = 'Você participou de eventos com #Passeio';
      $scope.badge.numeroatual = $scope.auxnbadgePasseio;
      $scope.badge.numeroproximo = $scope.proximoPasseio
      $scope.badge.imgatual = document.getElementById("Passeio").src;
      $scope.badge.imganterior = $scope.anteriorimgPasseio;
      $scope.badge.imgproximo = $scope.proximoimgPasseio;
      formBadge.updateForm($scope.badge);
      $state.go('tabsController.badgesexplicaPerfilPost');
    }
    if(badge == 'Pets'){
      $scope.badge.titulo = 'Amo animais';
      $scope.badge.texto = 'Você participou de eventos com #Pets';
      $scope.badge.numeroatual = $scope.auxnbadgePets;
      $scope.badge.numeroproximo = $scope.proximoPets
      $scope.badge.imgatual = document.getElementById("Pets").src;
      $scope.badge.imganterior = $scope.anteriorimgPets;
      $scope.badge.imgproximo = $scope.proximoimgPets;
      formBadge.updateForm($scope.badge);
      $state.go('tabsController.badgesexplicaPerfilPost');
    }
    if(badge == 'Restaurantesebares'){
      $scope.badge.titulo = 'Degustador';
      $scope.badge.texto = 'Você participou de eventos com #Restaurantesebares';
      $scope.badge.numeroatual = $scope.auxnbadgeRestaurantesebares;
      $scope.badge.numeroproximo = $scope.proximoRestaurantesebares
      $scope.badge.imgatual = document.getElementById("Restaurantesebares").src;
      $scope.badge.imganterior = $scope.anteriorimgRestaurantesebares;
      $scope.badge.imgproximo = $scope.proximoimgRestaurantesebares;
      formBadge.updateForm($scope.badge);
      $state.go('tabsController.badgesexplicaPerfilPost');
    }
    if(badge == 'Surf'){
      $scope.badge.titulo = 'Surf';
      $scope.badge.texto = 'Você participou de eventos com #Surf';
      $scope.badge.numeroatual = $scope.auxnbadgeSurf;
      $scope.badge.numeroproximo = $scope.proximoSurf
      $scope.badge.imgatual = document.getElementById("Surf").src;
      $scope.badge.imganterior = $scope.anteriorimgSurf;
      $scope.badge.imgproximo = $scope.proximoimgSurf;
      formBadge.updateForm($scope.badge);
      $state.go('tabsController.badgesexplicaPerfilPost');
    }
    if(badge == 'Voluntariado'){
      $scope.badge.titulo = 'Ajudar sempre é bom';
      $scope.badge.texto = 'Você participou de eventos com #Voluntariado';
      $scope.badge.numeroatual = $scope.auxnbadgeVoluntariado;
      $scope.badge.numeroproximo = $scope.proximoVoluntariado
      $scope.badge.imgatual = document.getElementById("Voluntariado").src;
      $scope.badge.imganterior = $scope.anteriorimgVoluntariado;
      $scope.badge.imgproximo = $scope.proximoimgVoluntariado;
      formBadge.updateForm($scope.badge);
      $state.go('tabsController.badgesexplicaPerfilPost');
    }

  }


}])

.controller('badgesexplicaPerfilPostCtrl', ['$scope', '$stateParams', 'formOutro', 'EventoService','$ionicPopup', '$timeout','$state', '$cordovaCamera', '$cordovaFile', '$cordovaFileTransfer', '$ionicLoading','formBadge', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, formOutro, EventoService, $ionicPopup, $timeout, $state, $cordovaCamera, $cordovaFile, $cordovaFileTransfer, $ionicLoading, formBadge) {

  // $scope.user = formOutro.getForm();
  // $scope.badge = formBadge.getForm();
  // document.getElementById("badgeimg").src=$scope.badge.imgatual;
  // document.getElementById("Atual").src=$scope.badge.imgatual;
  // document.getElementById("Anterior").src=$scope.badge.imganterior;
  // document.getElementById("Proximonivel").src=$scope.badge.imgproximo;
  // $scope.badge.progressPercent = $scope.badge.numeroatual * 100 / $scope.badge.numeroproximo;
  
   

  $scope.$on("$ionicView.enter", function(event, data){
    $scope.user = formOutro.getForm();
    $scope.badge = formBadge.getForm();
    
    document.getElementById("Atual").src=$scope.badge.imgatual;
    document.getElementById("Anterior").src=$scope.badge.imganterior;
    document.getElementById("Proximonivel").src=$scope.badge.imgproximo;
    console.log($scope.badge.imgatual)
    $scope.badge.progressPercent = $scope.badge.numeroatual * 100 / $scope.badge.numeroproximo;
   
  });


}])
   
.controller('eventosAbertosCtrl', ['$scope', '$state', '$stateParams', 'formUser', 'formItem', 'EventoService', '$http', 'formtelaStalkear', 'formEventoAbertosTab', '$ionicTabsDelegate',  // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $state, $stateParams, formUser, formItem, EventoService, $http, formtelaStalkear, formEventoAbertosTab, $ionicTabsDelegate) {
    $scope.telastalk = formtelaStalkear.getForm();
    $scope.user = formUser.getForm();
    $scope.infoevento ={};
    if ($scope.telastalk == 1) {
      formtelaStalkear.updateForm(0);
      $state.go('tabsController.perfil_outro_eventoabertos');
    }

    var header = document.getElementById("barevento");
    var btns = header.getElementsByClassName("btneva");
    for (var i = 0; i < btns.length; i++) {
      btns[i].addEventListener("click", function() {
        var current = document.getElementsByClassName("actiea");
        current[0].className = current[0].className.replace(" actiea", "");
        this.className += " actiea";
      });
    }



    $scope.$on("$ionicView.enter", function(event, data){
      $ionicTabsDelegate.showBar(1);
      var das = document.getElementById("qvo");
      var current = document.getElementsByClassName("actiea");
      current[0].className = current[0].className.replace(" actiea", "");
      das.className += " actiea";
      $scope.vazio = false;
      $scope.items = [];
      $scope.telastalk = formtelaStalkear.getForm();
      if ($scope.telastalk == 1) {
        formtelaStalkear.updateForm(0);
        $state.go('tabsController.perfil_outro_eventoabertos');
      }
      
      EventoService.GetAbertosQvou($scope.user.iduser).then(function(items){
          console.log(items, "AbertosQvou")
          if(items=='E'){
            $scope.items = [];
            $scope.vazio = true;
          }else{
            $scope.vazio = false;
            for (var i = 0; i < items.length; i++) {
              if (items[i].estado == 0) {
                items[i].confirmacao = 'Sou o organizador';
              }
              if (items[i].estado == 1) {
                items[i].confirmacao = 'Aguardando confirmação';
              }
              if (items[i].estado == 2) {
                items[i].confirmacao = 'Confirmado';
              }
              var curr_date = (items[i].diainicio[8]+items[i].diainicio[9]);
                var h2 = (items[i].diainicio[11]+items[i].diainicio[12]);
                var m2 = (items[i].diainicio[14]+items[i].diainicio[15]);
                var curr_month = (items[i].diainicio[5]+items[i].diainicio[6]);
                var curr_year = (items[i].diainicio[2]+items[i].diainicio[3]);
                var j = curr_date + "/" + curr_month + "/" + curr_year+ '  '+h2 + ':' + m2;
                items[i].datainicio = j;
                  var hj = items[i].diainicio;
                  var ano = (hj[0]+hj[1]+hj[2]+hj[3]).valueOf();
                  var mes = (hj[5]+hj[6]).valueOf();
                  var dia = (hj[8]+hj[9]).valueOf();
                  var h = (hj[11]+hj[12]).valueOf();
                  var m = (hj[14]+hj[15]).valueOf();
                  var hjf = items[i].diafim;
                  items[i].fimdia =  (hjf[8]+hjf[9]).valueOf()+'/'+(hjf[5]+hjf[6]).valueOf()+'/'+(hjf[0]+hjf[1]+hjf[2]+hjf[3]);
                  items[i].fimhora = (hjf[11]+hjf[12]).valueOf()+':'+(hjf[14]+hjf[15]).valueOf();
                  items[i].diadia = dia+'/'+mes;
                  items[i].diahora = h+':'+m +' - '+(hjf[11]+hjf[12]).valueOf()+':'+(hjf[14]+hjf[15]).valueOf() ;
                  
            }
            $scope.items = items.concat($scope.items);
          }
        });
    });

    $scope.loadqvou = function(){
      $scope.items = [];
      EventoService.GetAbertosQvou($scope.user.iduser).then(function(items){
          console.log(items)
          if(items=='E'){
            $scope.items = [];
            $scope.vazio = true;
          }else{
            $scope.vazio = false;
            for (var i = 0; i < items.length; i++) {
              if (items[i].estado == 0) {
                items[i].confirmacao = 'Sou o organizador';
              }
              if (items[i].estado == 1) {
                items[i].confirmacao = 'Aguardando confirmação';
              }
              if (items[i].estado == 2) {
                items[i].confirmacao = 'Confirmado';
              }
              var curr_date = (items[i].diainicio[8]+items[i].diainicio[9]);
                var h2 = (items[i].diainicio[11]+items[i].diainicio[12]);
                var m2 = (items[i].diainicio[14]+items[i].diainicio[15]);
                var curr_month = (items[i].diainicio[5]+items[i].diainicio[6]);
                var curr_year = (items[i].diainicio[2]+items[i].diainicio[3]);
                var j = curr_date + "/" + curr_month + "/" + curr_year+ '  '+h2 + ':' + m2;
                items[i].datainicio = j;
                  var hj = items[i].diainicio;
                  var ano = (hj[0]+hj[1]+hj[2]+hj[3]).valueOf();
                  var mes = (hj[5]+hj[6]).valueOf();
                  var dia = (hj[8]+hj[9]).valueOf();
                  var h = (hj[11]+hj[12]).valueOf();
                  var m = (hj[14]+hj[15]).valueOf();
                  var hjf = items[i].diafim;
                  items[i].fimdia =  (hjf[8]+hjf[9]).valueOf()+'/'+(hjf[5]+hjf[6]).valueOf()+'/'+(hjf[0]+hjf[1]+hjf[2]+hjf[3]);
                  items[i].fimhora = (hjf[11]+hjf[12]).valueOf()+':'+(hjf[14]+hjf[15]).valueOf();
                  items[i].diadia = dia+'/'+mes;
                  items[i].diahora = h+':'+m +' - '+(hjf[11]+hjf[12]).valueOf()+':'+(hjf[14]+hjf[15]).valueOf() ;
                 
            }
            $scope.items = items.concat($scope.items);
          }
        });
    }
    $scope.loadCriados = function(){
      $scope.items = [];
      EventoService.GetAbertosCriados($scope.user.iduser).then(function(items) {
          console.log(items)
          if(items=='E'){
            $scope.vazio = true;
            $scope.items = [];
          }else{
            $scope.vazio = false;
            for (var i = 0; i < items.length; i++) {
                var curr_date = (items[i].diainicio[8]+items[i].diainicio[9]);
                var h2 = (items[i].diainicio[11]+items[i].diainicio[12]);
                var m2 = (items[i].diainicio[14]+items[i].diainicio[15]);
                var curr_month = (items[i].diainicio[5]+items[i].diainicio[6]);
                var curr_year = (items[i].diainicio[2]+items[i].diainicio[3]);
                var j = curr_date + "/" + curr_month + "/" + curr_year+'  '+h2 + ':' + m2;
                  var hj = items[i].diainicio;
                  var ano = (hj[0]+hj[1]+hj[2]+hj[3]).valueOf();
                  var mes = (hj[5]+hj[6]).valueOf();
                  var dia = (hj[8]+hj[9]).valueOf();
                  var h = (hj[11]+hj[12]).valueOf();
                  var m = (hj[14]+hj[15]).valueOf();
                  var hjf = items[i].diafim;
                  items[i].fimdia =  (hjf[8]+hjf[9]).valueOf()+'/'+(hjf[5]+hjf[6]).valueOf()+'/'+(hjf[0]+hjf[1]+hjf[2]+hjf[3]);
                  items[i].fimhora = (hjf[11]+hjf[12]).valueOf()+':'+(hjf[14]+hjf[15]).valueOf();
                  items[i].diadia = dia+'/'+mes;
                  items[i].diahora = h+':'+m +' - '+(hjf[11]+hjf[12]).valueOf()+':'+(hjf[14]+hjf[15]).valueOf() ;
                 
                items[i].datainicio = j;
                items[i].confirmacao = "Confirmados" + items[i].patual + " de " + items[i].pmin + "/" +items[i].pmax ;
            }
            $scope.items = items.concat($scope.items);
          }
      });
    }
    $scope.loadmarcando = function(){
      $scope.items = [];
      EventoService.GetAbertosMarcando($scope.user.iduser).then(function(items) {
          console.log(items)
          if(items=='E'){
            $scope.vazio = true;
            $scope.items = [];
          }else{
            $scope.vazio = false;
            for (var i = 0; i < items.length; i++) {
                var curr_date = (items[i].diainicio[8]+items[i].diainicio[9]);
                var h2 = (items[i].diainicio[11]+items[i].diainicio[12]);
                var m2 = (items[i].diainicio[14]+items[i].diainicio[15]);
                var curr_month = (items[i].diainicio[5]+items[i].diainicio[6]);
                var curr_year = (items[i].diainicio[2]+items[i].diainicio[3]);
                var j = curr_date + "/" + curr_month + "/" + curr_year+'  '+h2 + ':' + m2;
                  var hj = items[i].diainicio;
                  var ano = (hj[0]+hj[1]+hj[2]+hj[3]).valueOf();
                  var mes = (hj[5]+hj[6]).valueOf();
                  var dia = (hj[8]+hj[9]).valueOf();
                  var h = (hj[11]+hj[12]).valueOf();
                  var m = (hj[14]+hj[15]).valueOf();
                  var hjf = items[i].diafim;
                  items[i].fimdia =  (hjf[8]+hjf[9]).valueOf()+'/'+(hjf[5]+hjf[6]).valueOf()+'/'+(hjf[0]+hjf[1]+hjf[2]+hjf[3]);
                  items[i].fimhora = (hjf[11]+hjf[12]).valueOf()+':'+(hjf[14]+hjf[15]).valueOf();
                  items[i].diadia = dia+'/'+mes;
                  if(items[i].eventopic == "img/manha.png"){
                    console.log("enrta aqui")
                    items[i].diahora = 'Manhã'
                  }
                  if(items[i].eventopic == "img/tarde.png"){
                    console.log("enrta aqui")
                    items[i].diahora = 'Tarde'
                  }
                  if(items[i].eventopic == "img/noite.png"){
                    console.log("enrta aqui")
                    items[i].diahora = 'Noite'
                  }
                 
                items[i].datainicio = j;
                
            }
            $scope.items = items.concat($scope.items);
          }
      });
    }
    $scope.loadInteresse = function(){
      $scope.items = [];
      EventoService.GetAbertosInteresse($scope.user.iduser).then(function(items) {
          console.log(items)
          if(items=='E'){
            $scope.vazio = true;
            $scope.items = [];
          }else{
            $scope.vazio = false;
            for (var i = 0; i < items.length; i++) {
                var curr_date = (items[i].diainicio[8]+items[i].diainicio[9]);
                var h2 = (items[i].diainicio[11]+items[i].diainicio[12]);
                var m2 = (items[i].diainicio[14]+items[i].diainicio[15]);
                var curr_month = (items[i].diainicio[5]+items[i].diainicio[6]);
                var curr_year = (items[i].diainicio[2]+items[i].diainicio[3]);
                var j = curr_date + "/" + curr_month + "/" + curr_year+ '  ' +h2 + ':' + m2;
                items[i].datainicio = j;
                items[i].confirmacao = '';
                var hj = items[i].diainicio;
                  var ano = (hj[0]+hj[1]+hj[2]+hj[3]).valueOf();
                  var mes = (hj[5]+hj[6]).valueOf();
                  var dia = (hj[8]+hj[9]).valueOf();
                  var h = (hj[11]+hj[12]).valueOf();
                  var m = (hj[14]+hj[15]).valueOf();
                  var hjf = items[i].diafim;
                  items[i].fimdia =  (hjf[8]+hjf[9]).valueOf()+'/'+(hjf[5]+hjf[6]).valueOf()+'/'+(hjf[0]+hjf[1]+hjf[2]+hjf[3]);
                  items[i].fimhora = (hjf[11]+hjf[12]).valueOf()+':'+(hjf[14]+hjf[15]).valueOf();
                  items[i].diadia = dia+'/'+mes;
                  items[i].diahora = h+':'+m +' - '+(hjf[11]+hjf[12]).valueOf()+':'+(hjf[14]+hjf[15]).valueOf() ;
                 

            }
            $scope.items = items.concat($scope.items);
          }
      });
    }

    $scope.enterItem =  function(item){
      
      $http.post('https://ec2.diwoapp.com.br/geteventoporid.php', {idevento : item.idevento}).then(function (result){
                                $scope.infoevento = result.data[0];
                                console.log($scope.infoevento.idevento, $scope.infoevento.diainicio);
                                //formItem.updateForm($scope.infoevento);
                                formEventoAbertosTab.updateForm($scope.infoevento);
                                 if (item.estado == 7) {
                                    $state.go('tabsController.eventoPinzado');
                                    }else{
                                      if(item.estado == 21){
                                        $state.go('tabsController.marcandoquando');
                                      }else{
                                        $state.go('tabsController.evento_do_eventoAbertos');
                                      }
                                    
                                    }
                             });
    }


}])

.controller('marcandoquandoCtrl', ['$scope', '$stateParams', 'formItem', 'formUser',  '$ionicTabsDelegate', '$interval', '$http', '$timeout','$ionicPopup', 'EventoService', '$state', 'formOutro', 'formEventoAbertosTab','$ionicScrollDelegate', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, formItem, formUser, $ionicTabsDelegate, $interval, $http, $timeout, $ionicPopup, EventoService, $state, formOutro, formEventoAbertosTab, $ionicScrollDelegate) {
    var interval;
    $scope.positiveTime; //This is for the ng-show of the unixdate/time
    $scope.unixDateTimeValue;

    $scope.criarmarcado = function(){
      $state.go('tabsController.criarmarcandoquando');
    }

    var auxpodestalekar = false;

    $scope.stalkea = function(stakeado){
      console.log('dasdasdasdada',stakeado, $scope.items.length)
      for (var  i = 0; i<$scope.items.length; i++){
        if ($scope.items[i].iduser == $scope.user.iduser){
          auxpodestalekar = true;
          console.log(auxpodestalekar, "auxpodestalekar")
        }
      }
      if(i = $scope.items.length && auxpodestalekar){
        formOutro.updateForm(stakeado);
        $state.go('tabsController.perfil_outro_eventoabertos');
      }
    }

    /* function to copy text */
    $scope.copyText = function(value) {
      $cordovaClipboard.copy(value).then(function() {
        console.log("Copied text: " + value);
      }, function() {
        console.error("There was an error copying");
      });
    }

    /* This block is the JS for the date-time-picker  */
    /*  run onTimeChanged when the time changes, it will save the unixTime and dateTimeString, start the timer (if not already satrted),  and make $scope.positiveTime true */
    
    /* If the text changes, we check if the time is not undefined */
    $scope.dateTimeStringChanged = function() {
      if ($scope.unixDateTimeValue = 'undefined') {
        //console.log("dateStorageArray[0] in dateTimeStringChanged: " + $scope.dateStorageArray[0]);
        // if ($scope.dateStorageArray != null) {
        //   $scope.unixDateTimeValue = $scope.dateStorageArray[$scope.dateStorageArray.length - 1]; //Load the timer from memory and place it in the countdown
        //   $scope.positiveTime = true;
        //   console.log("dateStorageArray if $scope.dateStorageArray != null: " + $scope.dateStorageArray[0]);
        // }

        console.log("stringchanged false");
      } else {
        $scope.positiveTime = true;
        console.log("stringchanged true ");
      }
    };

    /*
    Does all the math with the unix time, will return a string called finalTimeLeft and timeLeftSeconds. The math for the other functions uses timeLeftSeconds.

    Everytime the function is called, it will subtract current time and the end time and return the string and integer left. If called every second it will count down.

    */
    $scope.unixCountdown = function() {
      /* Example countdown beginning:
      // var endTime = new Date("April 7, 2016 12:33:00 PM CDT");
      // var endTime = (Date.parse(endTime)) / 1000; */

      // if($scope.unixDateTimeValue == 'undefined' || endTime == 'undefined'){                                       $window.localStorage['Unix_Time_Value'] = $scope.unixDateTimeValue;
      // }
      var endTime = $scope.unixDateTimeValue;

      var countdownUnixDate = endTime / 1000; //Unix time goes in endTime;
      var now = new Date(); //Initializes a new Date() object at launch. This is the current time.
      var now = (Date.parse(now) / 1000);
      var timeLeft = countdownUnixDate - now; //subtracts the end time from the current time.
      $scope.timeLeftSeconds = timeLeft; //timeLeftSeconds is an interger of the time left in seconds that will be returned

      /* The rest of this function is basically stringifying the Unix time into days, hours, minutes and seconds left until endTime */
       $scope.days = Math.floor(timeLeft / 86400);
      $scope.hours = Math.floor((timeLeft - ($scope.days * 86400)) / 3600);
      $scope.minutes = Math.floor((timeLeft - ($scope.days * 86400) - ($scope.hours * 3600)) / 60);
      $scope.seconds = Math.floor((timeLeft - ($scope.days * 86400) - ($scope.hours * 3600) - ($scope.minutes * 60)));

      /* if the hours, minutes, or seconds are less than 10, we give them a leading zero */
      if ($scope.hours < "10") {
        hours = "0" + $scope.hours;
      }
      if ($scope.minutes < "10") {
        $scope.minutes = "0" + $scope.minutes;
      }
      if ($scope.seconds < "10") {
        $scope.seconds = "0" + $scope.seconds;
      }

      //Puts the final string together
      $scope.finalTimeLeft = $scope.hours + ' horas ' + $scope.minutes + ' minutos ' + $scope.seconds + ' segundos ';
      
      return ($scope.finalTimeLeft, $scope.timeLeftSeconds);
    }

    /* start() is the function that runs the $interval running tick every (second) */
    $scope.start = function() {
      $scope.stop();
      interval = $interval(tick, 1000); //we saved it as the variable "interval" so that we can cancel the $interval when we need to in $scope.stop()
    };

    $scope.stop = function() { // stops the $interval when called.
      $interval.cancel(interval);
    };

    $scope.start(); //start tick which will run once every second.
    $scope.dateTimeStringChanged(); // run function at start
    /* This is run everytime start() calls it it's basically our ticker */
    function tick() {
      // console.log('tick');
      $scope.unixCountdown();
      //        when the timer gets to zero, we stop it.
      if ($scope.timeLeftSeconds <= 0) {
        $scope.onTimerFinish();
      }
    }
    /* When called, it currently stops the timer and changes the text. */
    $scope.onTimerFinish = function() {
      console.log("FINISHED");
      $scope.stop();
      $scope.tempoesgotado = true;
      $scope.finalTimeLeft = "Cabo o tempo!!";
    }

  

    /*
      stops the interval when the scope is destroyed,
      this usually happens when a route is changed and
      the ItemsController $scope gets destroyed. The
      destruction of the ItemsController scope does not
      guarantee the stopping of any intervals, you must
      be responsible of stopping it when the scope is
      is destroyed.
      */
    $scope.$on('$destroy', function() {
      $scope.stop();
    });




    $scope.$on("$ionicView.enter", function(event, data){
      $ionicTabsDelegate.showBar(0);
      $scope.evento = formEventoAbertosTab.getForm();
      $scope.user = formUser.getForm();
      $scope.data = {};
      $scope.items = {};
      console.log($scope.evento.idevento)
      EventoService.Getmsg($scope.evento.idevento).then(function(result) {
        console.log(result.success)
        if(result.success !=false){
          for(var i = 0 ;i<result.length;i++){
            console.log(result[i].profilepic)
          }
          $scope.items = result;
        }
      });
      var auxdestroidata
      EventoService.GetParticipantes($scope.evento.idevento).then(function(items) {
        if(items!='E'){
          auxdestroidata = items[1].datadecriacao;
          var date = new Date(auxdestroidata);
          date.setTime(date.getTime() + (21*60*60*1000));
          
          console.log(auxdestroidata)
          $scope.unixDateTimeValue = Date.parse(date);
        //we finally have datetimeValue when there's a change
        //console.log('Time changed to: ' + $scope.unixDateTimeValue)
        $scope.start();
        $scope.positiveTime = true;
        //console.log("ontimechanged true");
        }
      });
    })

    $scope.user = formUser.getForm();
    $scope.evento = formEventoAbertosTab.getForm();
    $scope.data = {};
    $scope.items = [];
    var isIOS = ionic.Platform.isWebView() && ionic.Platform.isIOS();



   $interval( function() {
      EventoService.Getmsg($scope.evento.idevento).then(function(result) {
        if(result.success){
          $scope.items = result;
        }
      });
    }, 5000);

    // $scope.auxev = {};
    // $scope.auxev.iduser = $scope.user.iduser;
    // $scope.auxev.idevento = $scope.evento.idevento;
    // EventoService.GetNotiOn($scope.auxev).then(function(notion) {
    //   $scope.notion = notion;
    // });
    // $scope.ativanoti = function(){
    //   $http.post('https://ec2.diwoapp.com.br/mudanotievento.php', {idevento : $scope.auxev.idevento, iduser : $scope.auxev.iduser, chatnotion : 0});
    //   $scope.notion = true;
    // }
    // $scope.desativanoti = function(){
    //   $http.post('https://ec2.diwoapp.com.br/mudanotievento.php', {idevento : $scope.auxev.idevento, iduser : $scope.auxev.iduser, chatnotion : 1});
    //   $scope.notion = false;
    // }

    $scope.sendMessage = function() {
      console.log($scope.finalTimeLef , "$scope.finalTimeLef ")
      if($scope.finalTimeLef == "Timer Ended!"){
        $scope.tempoesgotado = false;
      }else{
        var d = new Date();
        console.log(d);
        d = d.toLocaleTimeString().replace(/:\d+ /, ' ');
        var data = new Date();
        var dataFormatada = ("0" + data.getDate()).substr(-2) + "/" 
            + ("0" + (data.getMonth() + 1)).substr(-2) + "/" + data.getFullYear();
            dataFormatada = (d + ' '+dataFormatada);
            console.log(dataFormatada, $scope.data.message, "$scope.data.message");

        if(!$scope.data.message){
          console.log(  "mensagem "+$scope.data.message);
        }else{
          console.log($scope.data.items,  $scope.items,  $scope.items[0], $scope.user.username, $scope.data.message, dataFormatada, $scope.evento.idevento);
        
          if($scope.items[0]){
            $scope.items.push({
              username: $scope.user.username,
              mensagem: $scope.data.message,
              tempo: dataFormatada,
              idevento : $scope.evento.idevento, 
              iduser : $scope.user.iduser, 
              apelido : $scope.user.apelido,
              profilepic : $scope.user.profilepic
            });
          }else{
            $scope.items[0] = {
              username: $scope.user.username,
              mensagem: $scope.data.message,
              tempo: dataFormatada,
              idevento : $scope.evento.idevento, 
              iduser : $scope.user.iduser, 
              apelido : $scope.user.apelido,
              profilepic : $scope.user.profilepic
            };
            var auxtre = true;
          }
          if($scope.data.message != '' || $scope.data.message){
             var link = 'https://ec2.diwoapp.com.br/criarmsg.php';
                          $http.post(link, {idevento : $scope.evento.idevento, 
                                            mensagem :  $scope.data.message,
                                            iduser : $scope.user.iduser, 
                                            username : $scope.user.username,
                                            apelido : $scope.user.apelido,
                                            profilepic : $scope.user.profilepic,
                                            tempo : dataFormatada}).then(function (res){
                        $scope.response = res.data;
                        console.log($scope.response.msg);
                      });
                EventoService.GetParticipantesNotifica($scope.evento.idevento).then(function(parti) {
                  console.log("parti",parti)
                  for (var i = 0; i < parti.length; i++) {
                    if (parti[i].estado!=7 && parti[i].estado!=8 && parti[i].iduser != $scope.user.iduser) {
                      EventoService.getusuario2(parti[i].username).then(function(user) {
                        if(user.notichat== '1'){
                          $scope.pushnoti = {};
                          $scope.pushnoti.titulo = "Nova mensagem";
                          $scope.pushnoti.msg = 'Chat do '+$scope.evento.nomeevento + ' tem mensagem nova' ;
                          $scope.pushnoti.token = user.devicetoken;
                          EventoService.MandaPushNoti($scope.pushnoti);
                        }
                      });
                    }          
                  }      
                });
          }
          if(auxtre){
            $state.reload();
          }
          delete $scope.data.message;
          $ionicScrollDelegate.scrollBottom(true);
        }
      }
      
    };


    $scope.inputUp = function() {
      if (isIOS) $scope.data.keyboardHeight = 216;
      $timeout(function() {
        $ionicScrollDelegate.scrollBottom(true);
      }, 300);

    };

    $scope.inputDown = function() {
      if (isIOS) $scope.data.keyboardHeight = 0;
      $ionicScrollDelegate.resize();
    };

    $scope.closeKeyboard = function() {
      // cordova.plugins.Keyboard.close();
    };
   
}])


.controller('criarmarcandoquandoCtrl', ['$scope', '$stateParams', 'formUser', 'formLoc', 'EventoService', 'formAux', '$state','$timeout', '$ionicPopup', '$http', 'formOutro', 'formItem', 'formtela', 'formtelanoti', 'formtipologin','formEventoAbertosTab', '$ionicTabsDelegate',  // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, formUser, formLoc, EventoService, formAux, $state, $timeout, $ionicPopup, $http, formOutro, formItem, formtela, formtelanoti, formtipologin, formEventoAbertosTab, $ionicTabsDelegate) {
  
  $scope.evento = {};
  $scope.user = formUser.getForm();

  $scope.$on("$ionicView.enter", function(event, data){
    $ionicTabsDelegate.showBar(0);
    $scope.evento = formEventoAbertosTab.getForm();
    $scope.user = formUser.getForm();
    //$scope.evento.iniciohora =  new Date(6, 0)
     // $scope.evento.iniciohora.setHours(6, 0)
     if(!$scope.evento.diainicio){
      if($scope.evento.eventopic == "img/manha.png"){
        console.log("enrta aqui")
        //Date.setHours(6, 0,)
        $scope.evento.iniciohora =  new Date(6, 0)
        $scope.evento.iniciohora.setHours(6, 0)
      }
      if($scope.evento.eventopic == "img/tarde.png"){
        console.log("enrta aqueqwewqi")
        $scope.evento.iniciohora =  new Date(12, 0)
        $scope.evento.iniciohora.setHours(12, 0)
      }
      if($scope.evento.eventopic == "img/noite.png"){
        console.log("enrtaeqwe aqui")
        $scope.evento.iniciohora =  new Date(18, 0)
        $scope.evento.iniciohora.setHours(18, 0)
      }
     }
    
  })

  $scope.Proximo = function(evento){
    var curr_date = $scope.evento.diainicio[8]+$scope.evento.diainicio[9];
    var curr_month = $scope.evento.diainicio[5]+$scope.evento.diainicio[6]; //Months are zero based
    var curr_year = $scope.evento.diainicio[0]+$scope.evento.diainicio[1] +$scope.evento.diainicio[2]+$scope.evento.diainicio[3];
     
     
    var hora =($scope.evento.iniciohora.getHours()<10?'0':'') + $scope.evento.iniciohora.getHours();
    var min =($scope.evento.iniciohora.getMinutes()<10?'0':'') + $scope.evento.iniciohora.getMinutes();
    var j = curr_year + "-" + curr_month + "-" + curr_date+ ' '+hora + ':' + min + ':00' ;
    $scope.evento.diainicio = j;      
    //console.log($scope.evento.iniciohora, "$scope.evento.iniciohora", $scope.evento.diainicio);

    formEventoAbertosTab.updateForm(evento);
    $state.go('tabsController.criarmarcandoduracao')
  }





}])

.controller('criarmarcandoduracaoCtrl', ['$scope', '$stateParams', 'formUser', 'formLoc', 'EventoService', 'formAux', '$state','$timeout', '$ionicPopup', '$http', 'formOutro', 'formItem', 'formtela', 'formtelanoti', 'formtipologin','formEventoAbertosTab', '$ionicTabsDelegate',  // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, formUser, formLoc, EventoService, formAux, $state, $timeout, $ionicPopup, $http, formOutro, formItem, formtela, formtelanoti, formtipologin, formEventoAbertosTab, $ionicTabsDelegate) {
 
  $scope.evento = {};
  $scope.user = formUser.getForm();


  $scope.$on("$ionicView.enter", function(event, data){
    $ionicTabsDelegate.showBar(0);
    $scope.evento = formEventoAbertosTab.getForm();
    $scope.user = formUser.getForm();
    if(!$scope.evento.duracao){
      $scope.evento.duracao =  new Date(1, 0)
      $scope.evento.duracao.setHours(1, 0)
    }
    
  })

  $scope.Proximo = function(evento){
    var hora =$scope.evento.duracao.getHours();
    var min = $scope.evento.duracao.getMinutes();
    var currentdatefim = new Date($scope.evento.diainicio);
    if(min == 0){
      min = 60;
    }
    if(hora == 0){
      currentdatefim.setTime(currentdatefim.getTime() + (min*60*1000));
    }else{
      currentdatefim.setTime(currentdatefim.getTime() + (hora*min*60*1000));
    }
    
    
    var curr_datefim = (currentdatefim.getDate()<10?'0':'') + currentdatefim.getDate();
    var curr_monthfim = (currentdatefim.getMonth()<9?'0':'') + (currentdatefim.getMonth() + 1); //Months are zero based
    var curr_yearfim = currentdatefim.getFullYear();
    var curr_hfim = (currentdatefim.getHours()<10?'0':'') + currentdatefim.getHours();
    var curr_mfim = (currentdatefim.getMinutes()<10?'0':'') + currentdatefim.getMinutes();
    var curr_jfim = curr_yearfim + "-" + curr_monthfim + "-" + curr_datefim+ ' '+curr_hfim + ':' + curr_mfim + ':' + '00';
    
    $scope.evento.diafim = curr_jfim;
    
    console.log($scope.evento.diafim, "$scope.evento.diafim")
    formEventoAbertosTab.updateForm(evento);
    $state.go('tabsController.criarmarcandolimiteconfirma')
  }

}])

.controller('criarmarcandolimiteconfirmaCtrl', ['$scope', '$stateParams', 'formUser', 'formLoc', 'EventoService', 'formAux', '$state','$timeout', '$ionicPopup', '$http', 'formOutro', 'formItem', 'formtela', 'formtelanoti', 'formtipologin','formEventoAbertosTab', '$ionicTabsDelegate',  // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, formUser, formLoc, EventoService, formAux, $state, $timeout, $ionicPopup, $http, formOutro, formItem, formtela, formtelanoti, formtipologin, formEventoAbertosTab, $ionicTabsDelegate) {
 
  $scope.evento = {};
  $scope.user = formUser.getForm();


  $scope.$on("$ionicView.enter", function(event, data){
    $ionicTabsDelegate.showBar(0);
    $scope.evento = formEventoAbertosTab.getForm();
    $scope.user = formUser.getForm();
    $scope.evento.redzone = 1;

      var currentdate = new Date(); 
      var curr_date2 = (currentdate.getDate()<10?'0':'') + currentdate.getDate();
      var curr_month2 = (currentdate.getMonth()<10?'0':'') + (currentdate.getMonth() + 1); //Months are zero based
      var curr_year2 = currentdate.getFullYear();
      var h22 = (currentdate.getHours()<10?'0':'') + currentdate.getHours();
      var m22 = (currentdate.getMinutes()<10?'0':'') + currentdate.getMinutes();

      var curr_date
      var h2
      var m2 
      var curr_month
      var s2
      var curr_year
      var datainvalida = 0;

      var curr_date4;
      var curr_date5;
      var h4
      var m4 
      var curr_month4;
      var curr_month5;
      var s4
      var curr_year4
      var curr_year5;

      $scope.ano;
      $scope.mes ;
      $scope.dia;
      $scope.h;
      $scope.m;

          curr_date = ($scope.evento.date.getDate()<10?'0':'') + $scope.evento.date.getDate();
          curr_month = ($scope.evento.date.getMonth()<9?'0':'') + ($scope.evento.date.getMonth() + 1); //Months are zero based
          curr_year = $scope.evento.date.getFullYear();
          h2 = ($scope.evento.date.getHours()<10?'0':'') + $scope.evento.date.getHours();
          m2 = ($scope.evento.date.getMinutes()<10?'0':'') + $scope.evento.date.getMinutes();
          s2 = ($scope.evento.date.getSeconds()<10?'0':'') + $scope.evento.date.getSeconds();

          var j = curr_year + "-" + curr_month + "-" + curr_date+ ' '+h2 + ':' + m2 + ':' + s2;
          
          $scope.evento.diainicio = j;
          diainiciodoevento = $scope.evento.date;
          datainvalida = 0;
          $scope.ano = curr_year-curr_year2;
          $scope.mes = curr_month-curr_month2;
          $scope.dia = curr_date-curr_date2;
          $scope.h = h2-h22;
          $scope.m = m2-m22;

  })



  $scope.red = function(){
    if($scope.ano==0 && $scope.mes == 0 && ($scope.dia == 0 && $scope.evento.redzone >= $scope.h) || ($scope.dia == 1 && $scope.evento.redzone >= $scope.h+24)){
      console.log($scope.evento.redzone)
      var alertPopup = $ionicPopup.alert({
        title: 'ლ(ﾟдﾟლ)',
        template: 'A hora limite para confirmação ja passou de agora, ninguem vai conseguir confirmar ida. Selecione um horario válido'
      });
      $scope.evento.redzone = "1";
    }
  }

  $scope.Proximo = function(evento){
    var curr_date5 = $scope.evento.diainicio[8]+$scope.evento.diainicio[9];
    var curr_month5 = $scope.evento.diainicio[5]+$scope.evento.diainicio[6]; //Months are zero based
    var curr_year5 = $scope.evento.diainicio[0]+$scope.evento.diainicio[1] +$scope.evento.diainicio[2]+$scope.evento.diainicio[3];
     
     
    var hora =($scope.evento.iniciohora.getHours()<10?'0':'') + $scope.evento.iniciohora.getHours();
    var m2 =($scope.evento.iniciohora.getMinutes()<10?'0':'') + $scope.evento.iniciohora.getMinutes();

    var h4 = parseFloat(hora)-parseFloat($scope.evento.redzone);
    //console.log(h4)
    if(h4<0){
      h4 = h4.valueOf()+24;
      curr_date5 = parseFloat(curr_date5)-1;
      if(curr_date5<1){
        curr_month5 = parseFloat(curr_month5)-1;
        if(curr_month5==1||curr_month5==3||curr_month5==5||curr_month5==7||curr_month5==8||curr_month5==10||curr_month5==12){
          curr_date5 = curr_date5.valueOf()+31;
        }
        if(curr_month5==4||curr_month5==6||curr_month5==9||curr_month5==11){
          curr_date5 = curr_date5.valueOf()+30;
        }
        if(curr_month5==2){
          curr_date5 = curr_date5.valueOf()+28;
        }
        if(curr_month5<1){
          curr_year5 = parseFloat(curr_year5)-1;
        }
      }
    }
    if(h4 == 0){
      curr_date5 = parseFloat(curr_date5)-1;
      if(curr_date5<1){
        curr_month5 = parseFloat(curr_month5)-1;
        if(curr_month5==1||curr_month5==3||curr_month5==5||curr_month5==7||curr_month5==8||curr_month5==10||curr_month5==12){
          curr_date5 = curr_date5.valueOf()+31;
        }
        if(curr_month5==4||curr_month5==6||curr_month5==9||curr_month5==11){
          curr_date5 = curr_date5.valueOf()+30;
        }
        if(curr_month5==2){
          curr_date5 = curr_date5.valueOf()+28;
        }
        if(curr_month5<1){
          curr_year5 = parseFloat(curr_year5)-1;
        }
      }
    }
    h4 = (h4<10?'0':'')+h4;
    curr_date5 = (parseFloat(curr_date5)<10?'0':'')+parseFloat(curr_date5);
    curr_month5 = (parseFloat(curr_month5)<9?'0':'')+parseFloat(curr_month5);
    var j = curr_year5 + "-" + curr_month5 + "-" + curr_date5+ ' '+h4 + ':' + m2 + ':00' ;
    
    $scope.evento.dialimiteconfirmacao = j;
    //console.log($scope.evento.dialimiteconfirmacao)
    formEventoAbertosTab.updateForm(evento);
    $state.go('tabsController.criarmarcandolocal')
  }

}])

.controller('criarmarcandolocalCtrl', ['$scope', '$stateParams', 'formUser', 'formLoc', 'EventoService', 'formAux', '$state','$timeout', '$ionicPopup', '$http', 'formOutro', 'formItem', 'formtela', 'formtelanoti', '$cordovaGeolocation','formEventoAbertosTab', '$ionicTabsDelegate', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, formUser, formLoc, EventoService, formAux, $state, $timeout, $ionicPopup, $http, formOutro, formItem, formtela, formtelanoti, $cordovaGeolocation, formEventoAbertosTab, $ionicTabsDelegate) {
  
  $scope.evento = {};
  $scope.user = formUser.getForm();
  $scope.evento = formEventoAbertosTab.getForm();
  $scope.evento.nomelocal = 'Casa do Igor';
  $scope.evento.endereco = 'Secreto';
  $scope.evento.cidade = 'Balneário Camboriú';
  $scope.evento.lat = -26.9829029;
  $scope.evento.lng = -48.6340998;
  $scope.centerPoint={};
  $scope.centerPointFB={};
  $scope.LimiteFuncionamentoDiwo = false;
  $scope.LimiteFuncionamentoDiwoFB = false;
  $scope.disableTap = function(){
     container = document.getElementsByClassName('pac-container');
     // disable ionic data tab
     angular.element(container).attr('data-tap-disabled', 'true');
     // leave input field if google-address-entry is selected
     angular.element(container).on("click", function(){
                                   document.getElementById('pac-input').blur();
                                   });
     };

  $scope.$on("$ionicView.enter", function(event, data){
    $ionicTabsDelegate.showBar(0);
    $scope.evento = formEventoAbertosTab.getForm();
    $scope.user = formUser.getForm();
    $scope.centerPoint={};
    $scope.LimiteFuncionamentoDiwo = false;
    if(!$scope.evento.lat){
         navigator.geolocation.getCurrentPosition(function(position){
            var lat  = position.coords.latitude;
            var long = position.coords.longitude;
            var myLatlng = new google.maps.LatLng(lat, long);
            var mapOptions = {
                center: myLatlng,
                zoom: 16,
                mapTypeId: google.maps.MapTypeId.ROADMAP
            };          
            var map = new google.maps.Map(document.getElementById("map_canvas"), mapOptions); 
            var marker = new google.maps.Marker({
                      position: new google.maps.LatLng(position.coords.latitude, position.coords.longitude),
                      map: map,
                      title: "Borai",
                      draggable: true,
                      icon: 'http://maps.google.com/mapfiles/ms/icons/green-dot.png',
                      animation: google.maps.Animation.DROP 
                  })

            var geocoder = new google.maps.Geocoder;
            var infowindow = new google.maps.InfoWindow({maxWidth: 200});

            geocoder.geocode({'location': myLatlng}, function(results, status) {
                  if (status === 'OK') {
                    if (results[1]) {
                      $scope.evento.nomelocal = results[0].address_components[0].long_name;
                      $scope.evento.endereco = results[0].formatted_address;
                      for(var i = 0;i<results[0].address_components.length;i++){
                        if(results[0].address_components[i].types[0] == "administrative_area_level_2"){
                          $scope.evento.cidade = results[0].address_components[i].long_name;
                          console.log($scope.evento.cidade)
                        }
                      }
                      //$scope.evento.cidade = results[0].address_components[4].long_name;
                      $scope.evento.lat = position.coords.latitude;
                      $scope.evento.lng = position.coords.longitude;
                      $scope.centerPoint.lat = -26.997799;
                      $scope.centerPoint.lng = -48.632733; 
                      // $scope.centerPoint.lat = -25.473466587692343;
                      // $scope.centerPoint.lng = -49.29164589792566;
                      $scope.centerPointKM = 30;
                      $scope.LimiteFuncionamentoDiwo = arePointsNear($scope.evento, $scope.centerPoint,$scope.centerPointKM );
                      $scope.centerPointKMFB = 2500;
                      $scope.centerPointFB.lat = 39.1882887948499;
                      $scope.centerPointFB.lng = -100.07746794288232;
                      $scope.LimiteFuncionamentoDiwoFB = arePointsNear($scope.user, $scope.centerPointFB,$scope.centerPointKMFB );
                      
                      if($scope.LimiteFuncionamentoDiwoFB){
                        $scope.LimiteFuncionamentoDiwo = true;
                      }
                      infowindow.setContent(results[0].formatted_address);
                      console.log($scope.evento.endereco);
                      console.log($scope.evento.cidade);
                      console.log($scope.evento.lng);
                      console.log($scope.evento.lat);
                      //infowindow.setContent(results[0].address_components[2].long_name);
                      infowindow.open(map, marker);
                      setTimeout(function () { infowindow.close(); }, 5000);
                    } else {
                      window.alert('No results found');
                    }
                  } else {
                    window.alert('Geocoder failed due to: ' + status);
                  }
                });


            google.maps.event.addListener(marker, "dragstart", function (event) {
               marker.setAnimation(3); // raise
            });

            google.maps.event.addListener(marker, "dragend", function (event) {
               marker.setAnimation(4); // raise
            });

            marker.addListener('dragend', handleEvent);

            google.maps.event.addListener(map, 'click', function(e) {
                
                markers.forEach(function(marker) {
                marker.setMap(null);
                });
                markers = [];

                placeMarker(e.latLng, map, marker);

            });

            function placeMarker(latlng, map, marker) {
                marker.setPosition(latlng);
                marker.setMap(map);
                map.panTo(latlng);
                $scope.evento.lat = latlng.lat();
                $scope.evento.lng = latlng.lng();

                $scope.centerPoint.lat = -26.997799;
                $scope.centerPoint.lng = -48.632733; 
                // $scope.centerPoint.lat = -25.473466587692343;
                // $scope.centerPoint.lng = -49.29164589792566;
                $scope.centerPointKM = 30;
                $scope.LimiteFuncionamentoDiwo = arePointsNear($scope.evento, $scope.centerPoint,$scope.centerPointKM );
                      $scope.centerPointKMFB = 2500;
                      $scope.centerPointFB.lat = 39.1882887948499;
                      $scope.centerPointFB.lng = -100.07746794288232;
                      $scope.LimiteFuncionamentoDiwoFB = arePointsNear($scope.user, $scope.centerPointFB,$scope.centerPointKMFB );
                      
                      if($scope.LimiteFuncionamentoDiwoFB){
                        $scope.LimiteFuncionamentoDiwo = true;
                      }
                geocoder.geocode({'location': latlng}, function(results, status) {
                  if (status === 'OK') {
                    if (results[1]) {
                      $scope.evento.nomelocal = results[0].address_components[0].long_name;
                      for(var i = 0;i<results[0].address_components.length;i++){
                        if(results[0].address_components[i].types[0] == "administrative_area_level_2"){
                          $scope.evento.cidade = results[0].address_components[i].long_name;
                          console.log($scope.evento.cidade)
                        }
                      }
                      //$scope.evento.cidade = results[0].address_components[4].long_name;
                      $scope.evento.endereco = results[0].formatted_address;
                      console.log($scope.evento.endereco);
                      console.log($scope.evento.cidade);
                      console.log($scope.evento.lng);
                      console.log($scope.evento.lat);
                      infowindow.setContent(results[0].formatted_address);
                     
                      infowindow.open(map, marker);
                      setTimeout(function () { infowindow.close(); }, 5000);
                    } else {
                      window.alert('No results found');
                    }
                  } else {
                    window.alert('Geocoder failed due to: ' + status);
                  }
                });
            };

            function arePointsNear(checkPoint, centerPoint, km) {
                  var ky = 40000 / 360;
                  var kx = Math.cos(Math.PI * centerPoint.lat / 180.0) * ky;
                  var dx = Math.abs(centerPoint.lng - $scope.evento.lng) * kx;
                  var dy = Math.abs(centerPoint.lat - $scope.evento.lat) * ky;
                  return Math.sqrt(dx * dx + dy * dy) <= km;
                }    

            function handleEvent(event) {
                $scope.evento.lat = event.latLng.lat();
                $scope.evento.lng = event.latLng.lng();
                $scope.centerPoint.lat = -26.997799;
                $scope.centerPoint.lng = -48.632733; 
                // $scope.centerPoint.lat = -25.473466587692343;
                // $scope.centerPoint.lng = -49.29164589792566;
                $scope.centerPointKM = 30;
                $scope.LimiteFuncionamentoDiwo = arePointsNear($scope.evento, $scope.centerPoint,$scope.centerPointKM );
                $scope.centerPointKMFB = 2500;
                      $scope.centerPointFB.lat = 39.1882887948499;
                      $scope.centerPointFB.lng = -100.07746794288232;
                      $scope.LimiteFuncionamentoDiwoFB = arePointsNear($scope.user, $scope.centerPointFB,$scope.centerPointKMFB );
                      
                      if($scope.LimiteFuncionamentoDiwoFB){
                        $scope.LimiteFuncionamentoDiwo = true;
                      }
                              // GEOCODER INVERSO

                var geocoder = new google.maps.Geocoder;
                var infowindow = new google.maps.InfoWindow({
                                                              maxWidth: 200
                                                            });;    
            
                geocoder.geocode({'location': event.latLng}, function(results, status) {
                  if (status === 'OK') {
                    if (results[1]) {
                      $scope.evento.nomelocal = results[0].address_components[0].long_name;
                      for(var i = 0;i<results[0].address_components.length;i++){
                        if(results[0].address_components[i].types[0] == "administrative_area_level_2"){
                          $scope.evento.cidade = results[0].address_components[i].long_name;
                          console.log($scope.evento.cidade)
                        }
                      }
                      //$scope.evento.cidade = results[0].address_components[4].long_name;
                      $scope.evento.endereco = results[0].formatted_address;
                      // console.log($scope.evento.endereco);
                      // console.log($scope.evento.cidade);
                      console.log($scope.evento.lng);
                      console.log($scope.evento.lat);
                      infowindow.setContent(results[0].formatted_address);
                     
                      infowindow.open(map, marker);
                      setTimeout(function () { infowindow.close(); }, 5000);
                    } else {
                      window.alert('No results found');
                    }
                  } else {
                    window.alert('Geocoder failed due to: ' + status);
                  }
                });
            }
            var input = document.getElementById('pac-input');
            var searchBox = new google.maps.places.SearchBox(input);
            map.addListener('bounds_changed', function() {
                searchBox.setBounds(map.getBounds());
            });
            var markers = [];
            searchBox.addListener('places_changed', function() {
                var places = searchBox.getPlaces();

                if (places.length == 0) {
                  return;
                }

                // Clear out the old markers.
                markers.forEach(function(marker) {
                  marker.setMap(null);
                });
                markers = [];

                // For each place, get the icon, name and location.
                var bounds = new google.maps.LatLngBounds();
                places.forEach(function(place) {
                  if (!place.geometry) {
                    console.log("Returned place contains no geometry");
                    return;
                  }
                  // var icon = {
                  //   url: place.icon,
                  //   size: new google.maps.Size(71, 71),
                  //   origin: new google.maps.Point(0, 0),
                  //   anchor: new google.maps.Point(17, 34),
                  //   scaledSize: new google.maps.Size(25, 25)
                  // };

                  // Create a marker for each place.
                  markers.push(new google.maps.Marker({
                    map: map,
                    // icon: icon,
                    title: place.name,
                    position: place.geometry.location
                  }));

                  $scope.evento.nomelocal = place.name;
                  $scope.evento.endereco = place.formatted_address;
             
                  for(var i = 0;i<place.address_components.length;i++){
                    //console.log(place.address_components[i].types[0])
                    if(place.address_components[i].types[0] == "administrative_area_level_2"){
                      $scope.evento.cidade = place.address_components[i].long_name;
                      console.log($scope.evento.cidade)
                    }
                  }
                 
                  $scope.evento.lat = place.geometry.location.lat();
                  $scope.evento.lng = place.geometry.location.lng();
                  $scope.centerPoint.lat = -26.997799;
                  $scope.centerPoint.lng = -48.632733; 
                  // $scope.centerPoint.lat = -25.473466587692343;
                  // $scope.centerPoint.lng = -49.29164589792566;
                  $scope.centerPointKM = 30;
                  $scope.LimiteFuncionamentoDiwo = arePointsNear($scope.evento, $scope.centerPoint,$scope.centerPointKM );
                  $scope.centerPointKMFB = 2500;
                      $scope.centerPointFB.lat = 39.1882887948499;
                      $scope.centerPointFB.lng = -100.07746794288232;
                      $scope.LimiteFuncionamentoDiwoFB = arePointsNear($scope.user, $scope.centerPointFB,$scope.centerPointKMFB );
                      
                      if($scope.LimiteFuncionamentoDiwoFB){
                        $scope.LimiteFuncionamentoDiwo = true;
                      }
                  console.log($scope.evento.lng, $scope.evento.lat, "lssdd", $scope.evento.nomelocal, $scope.evento.endereco);

                  if (place.geometry.viewport) {
                    // Only geocodes have viewport.
                    bounds.union(place.geometry.viewport);
                  } else {
                    bounds.extend(place.geometry.location);
                  }
                });
                map.fitBounds(bounds);
            });

            $scope.map = map;  
             
        }, function(err) {
            console.log(err.code);
            console.log(err.message);
        });
    }
 

  })

  var posOptions = {
      enableHighAccuracy: true,
      timeout: 200000,
      maximumAge: 0
  };

    navigator.geolocation.getCurrentPosition(function(position){
          
            var lat  = position.coords.latitude;
            var long = position.coords.longitude;
             

            var myLatlng = new google.maps.LatLng(lat, long);
             
            var mapOptions = {
                center: myLatlng,
                zoom: 16,
                mapTypeId: google.maps.MapTypeId.ROADMAP
            };          
             
            var map = new google.maps.Map(document.getElementById("map_canvas"), mapOptions); 


            var marker = new google.maps.Marker({
                      position: new google.maps.LatLng(position.coords.latitude, position.coords.longitude),
                      map: map,
                      title: "Borai",
                      draggable: true,
                      icon: 'http://maps.google.com/mapfiles/ms/icons/green-dot.png',
                      animation: google.maps.Animation.DROP 
                  })

            var geocoder = new google.maps.Geocoder;
            var infowindow = new google.maps.InfoWindow({maxWidth: 200});

            geocoder.geocode({'location': myLatlng}, function(results, status) {
                  if (status === 'OK') {
                    if (results[1]) {
                      $scope.evento.nomelocal = results[0].address_components[0].long_name;
                      $scope.evento.endereco = results[0].formatted_address;
                      for(var i = 0;i<results[0].address_components.length;i++){
                        if(results[0].address_components[i].types[0] == "administrative_area_level_2"){
                          $scope.evento.cidade = results[0].address_components[i].long_name;
                          console.log($scope.evento.cidade)
                        }
                      }
                      //$scope.evento.cidade = results[0].address_components[4].long_name;
                      $scope.evento.lat = position.coords.latitude;
                      $scope.evento.lng = position.coords.longitude;
                      $scope.centerPoint.lat = -26.997799;
                      $scope.centerPoint.lng = -48.632733; 
                      // $scope.centerPoint.lat = -25.473466587692343;
                      // $scope.centerPoint.lng = -49.29164589792566;
                      $scope.centerPointKM = 30;
                      $scope.LimiteFuncionamentoDiwo = arePointsNear($scope.evento, $scope.centerPoint,$scope.centerPointKM );
                      $scope.centerPointKMFB = 2500;
                      $scope.centerPointFB.lat = 39.1882887948499;
                      $scope.centerPointFB.lng = -100.07746794288232;
                      $scope.LimiteFuncionamentoDiwoFB = arePointsNear($scope.user, $scope.centerPointFB,$scope.centerPointKMFB );
                      
                      if($scope.LimiteFuncionamentoDiwoFB){
                        $scope.LimiteFuncionamentoDiwo = true;
                      }
                      infowindow.setContent(results[0].formatted_address);
                      console.log($scope.evento.endereco);
                      console.log($scope.evento.cidade);
                      console.log($scope.evento.lng);
                      console.log($scope.evento.lat);
                      //infowindow.setContent(results[0].address_components[2].long_name);
                      infowindow.open(map, marker);
                      setTimeout(function () { infowindow.close(); }, 5000);
                    } else {
                      window.alert('No results found');
                    }
                  } else {
                    window.alert('Geocoder failed due to: ' + status);
                  }
                });


            google.maps.event.addListener(marker, "dragstart", function (event) {
               marker.setAnimation(3); // raise
            });

            google.maps.event.addListener(marker, "dragend", function (event) {
               marker.setAnimation(4); // raise
            });

            marker.addListener('dragend', handleEvent);

            google.maps.event.addListener(map, 'click', function(e) {
              
                markers.forEach(function(marker) {
                marker.setMap(null);
                });
                markers = [];

                placeMarker(e.latLng, map, marker);

            });
             function arePointsNear(checkPoint, centerPoint, km) {
                  var ky = 40000 / 360;
                  var kx = Math.cos(Math.PI * centerPoint.lat / 180.0) * ky;
                  var dx = Math.abs(centerPoint.lng - $scope.evento.lng) * kx;
                  var dy = Math.abs(centerPoint.lat - $scope.evento.lat) * ky;
                  return Math.sqrt(dx * dx + dy * dy) <= km;
                } 

            function placeMarker(latlng, map, marker) {
                marker.setPosition(latlng);
                marker.setMap(map);
                map.panTo(latlng);
                $scope.evento.lat = latlng.lat();
                $scope.evento.lng = latlng.lng();
                $scope.centerPoint.lat = -26.997799;
                $scope.centerPoint.lng = -48.632733;
                // $scope.centerPoint.lat = -25.473466587692343;
                // $scope.centerPoint.lng = -49.29164589792566; 
                $scope.centerPointKM = 30;
                $scope.LimiteFuncionamentoDiwo = arePointsNear($scope.evento, $scope.centerPoint,$scope.centerPointKM );
                $scope.centerPointKMFB = 2500;
                      $scope.centerPointFB.lat = 39.1882887948499;
                      $scope.centerPointFB.lng = -100.07746794288232;
                      $scope.LimiteFuncionamentoDiwoFB = arePointsNear($scope.user, $scope.centerPointFB,$scope.centerPointKMFB );
                      
                      if($scope.LimiteFuncionamentoDiwoFB){
                        $scope.LimiteFuncionamentoDiwo = true;
                      }
                geocoder.geocode({'location': latlng}, function(results, status) {
                  if (status === 'OK') {
                    if (results[1]) {
                      $scope.evento.nomelocal = results[0].address_components[0].long_name;
                      for(var i = 0;i<results[0].address_components.length;i++){
                        if(results[0].address_components[i].types[0] == "administrative_area_level_2"){
                          $scope.evento.cidade = results[0].address_components[i].long_name;
                          console.log($scope.evento.cidade)
                        }
                      }
                      //$scope.evento.cidade = results[0].address_components[4].long_name;
                      $scope.evento.endereco = results[0].formatted_address;
                      console.log($scope.evento.endereco);
                      console.log($scope.evento.cidade);
                      console.log($scope.evento.lng);
                      console.log($scope.evento.lat);
                      infowindow.setContent(results[0].formatted_address);
                     
                      infowindow.open(map, marker);
                      setTimeout(function () { infowindow.close(); }, 5000);
                    } else {
                      window.alert('No results found');
                    }
                  } else {
                    window.alert('Geocoder failed due to: ' + status);
                  }
                });
            };        

            function handleEvent(event) {
                $scope.evento.lat = event.latLng.lat();
                $scope.evento.lng = event.latLng.lng();
                $scope.centerPoint.lat = -26.997799;
                $scope.centerPoint.lng = -48.632733; 
                // $scope.centerPoint.lat = -25.473466587692343;
                // $scope.centerPoint.lng = -49.29164589792566;
                $scope.centerPointKM = 30;
                $scope.LimiteFuncionamentoDiwo = arePointsNear($scope.evento, $scope.centerPoint,$scope.centerPointKM );
                $scope.centerPointKMFB = 2500;
                      $scope.centerPointFB.lat = 39.1882887948499;
                      $scope.centerPointFB.lng = -100.07746794288232;
                      $scope.LimiteFuncionamentoDiwoFB = arePointsNear($scope.user, $scope.centerPointFB,$scope.centerPointKMFB );
                      
                      if($scope.LimiteFuncionamentoDiwoFB){
                        $scope.LimiteFuncionamentoDiwo = true;
                      }
                              // GEOCODER INVERSO

                var geocoder = new google.maps.Geocoder;
                var infowindow = new google.maps.InfoWindow({
                                                              maxWidth: 200
                                                            });;    
            
                geocoder.geocode({'location': event.latLng}, function(results, status) {
                  if (status === 'OK') {
                    if (results[1]) {
                      $scope.evento.nomelocal = results[0].address_components[0].long_name;
                      for(var i = 0;i<results[0].address_components.length;i++){
                        if(results[0].address_components[i].types[0] == "administrative_area_level_2"){
                          $scope.evento.cidade = results[0].address_components[i].long_name;
                          console.log($scope.evento.cidade)
                        }
                      }
                      //$scope.evento.cidade = results[0].address_components[4].long_name;
                      $scope.evento.endereco = results[0].formatted_address;
                      // console.log($scope.evento.endereco);
                      // console.log($scope.evento.cidade);
                      console.log($scope.evento.lng);
                      console.log($scope.evento.lat);
                      infowindow.setContent(results[0].formatted_address);
                     
                      infowindow.open(map, marker);
                      setTimeout(function () { infowindow.close(); }, 5000);
                    } else {
                      window.alert('No results found');
                    }
                  } else {
                    window.alert('Geocoder failed due to: ' + status);
                  }
                });
            }

                              // GEOCODER INVERSO

                

                
            
                    //        SEARCHBOX

            var input = document.getElementById('pac-input');
            var searchBox = new google.maps.places.SearchBox(input);
          //map.controls[google.maps.ControlPosition.TOP_LEFT].push(input);

        // Bias the SearchBox results towards current map's viewport.
            map.addListener('bounds_changed', function() {
                searchBox.setBounds(map.getBounds());
            });

            var markers = [];
        // Listen for the event fired when the user selects a prediction and retrieve
        // more details for that place.
            searchBox.addListener('places_changed', function() {
                var places = searchBox.getPlaces();

                if (places.length == 0) {
                  return;
                }

                // Clear out the old markers.
                markers.forEach(function(marker) {
                  marker.setMap(null);
                });
                markers = [];

                // For each place, get the icon, name and location.
                var bounds = new google.maps.LatLngBounds();
                places.forEach(function(place) {
                  if (!place.geometry) {
                    console.log("Returned place contains no geometry");
                    return;
                  }
                  // var icon = {
                  //   url: place.icon,
                  //   size: new google.maps.Size(71, 71),
                  //   origin: new google.maps.Point(0, 0),
                  //   anchor: new google.maps.Point(17, 34),
                  //   scaledSize: new google.maps.Size(25, 25)
                  // };

                  // Create a marker for each place.
                  markers.push(new google.maps.Marker({
                    map: map,
                    // icon: icon,
                    title: place.name,
                    position: place.geometry.location
                  }));

                  $scope.evento.nomelocal = place.name;
                  $scope.evento.endereco = place.formatted_address;
                  for(var i = 0;i<place.address_components.length;i++){
                    //console.log(place.address_components[i].types[0])
                    if(place.address_components[i].types[0] == "administrative_area_level_2"){
                      $scope.evento.cidade = place.address_components[i].long_name;
                      console.log($scope.evento.cidade)
                    }
                  }
                 
                  $scope.evento.lat = place.geometry.location.lat();
                  $scope.evento.lng = place.geometry.location.lng();
                  $scope.centerPoint.lat = -26.997799;
                  $scope.centerPoint.lng = -48.632733; 
                  // $scope.centerPoint.lat = -25.473466587692343;
                  // $scope.centerPoint.lng = -49.29164589792566;
                  $scope.centerPointKM = 30;
                  $scope.LimiteFuncionamentoDiwo = arePointsNear($scope.evento, $scope.centerPoint,$scope.centerPointKM );
                  $scope.centerPointKMFB = 2500;
                      $scope.centerPointFB.lat = 39.1882887948499;
                      $scope.centerPointFB.lng = -100.07746794288232;
                      $scope.LimiteFuncionamentoDiwoFB = arePointsNear($scope.user, $scope.centerPointFB,$scope.centerPointKMFB );
                      
                      if($scope.LimiteFuncionamentoDiwoFB){
                        $scope.LimiteFuncionamentoDiwo = true;
                      }
                  // console.log($scope.coord.endereco);
                  // console.log($scope.coord.long);
                  // console.log($scope.coord.lat);

                  if (place.geometry.viewport) {
                    // Only geocodes have viewport.
                    bounds.union(place.geometry.viewport);
                  } else {
                    bounds.extend(place.geometry.location);
                  }
                });
                map.fitBounds(bounds);
            });

            $scope.map = map;  
             
        }, function(err) {
            console.log(err.code);
            console.log(err.message);
        });


        $scope.Proximo = function(evento) {
          if($scope.LimiteFuncionamentoDiwo){
            formEventoAbertosTab.updateForm($scope.evento);
            $state.go('tabsController.criarmarcandopreco');
          }else{
            var alertPopup = $ionicPopup.alert({
                title: '( ꒪Д꒪)ノ',
                template: 'Ótimo saber que você quer criar um evento! Mas parece que a região onde você quer criar seu evento não está na nossa área de cobertura :/'
              }); 
          }
          
        }

}])

.controller('criarmarcandoprecoCtrl', ['$scope', '$stateParams', 'formUser', 'formLoc', 'EventoService', 'formAux', '$state','$timeout', '$ionicPopup', '$http', 'formOutro', 'formItem', 'formtela', 'formtelanoti', 'formtipologin','formEventoAbertosTab', '$ionicTabsDelegate', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, formUser, formLoc, EventoService, formAux, $state, $timeout, $ionicPopup, $http, formOutro, formItem, formtela, formtelanoti, formtipologin, formEventoAbertosTab, $ionicTabsDelegate) {  
  $scope.evento = {};
  $scope.user = formUser.getForm();

  var header = document.getElementById("barmpre");
  var btns = header.getElementsByClassName("btnmpre");
  for (var i = 0; i < btns.length; i++) {
    btns[i].addEventListener("click", function() {
      var current = document.getElementsByClassName("actmpre");
      current[0].className = current[0].className.replace(" actmpre", "");
      this.className += " actmpre";
    });
  }

  $scope.$on("$ionicView.enter", function(event, data){
    $ionicTabsDelegate.showBar(0);
    $scope.evento = formEventoAbertosTab.getForm();
    $scope.user = formUser.getForm();

  })
  
  $scope.evento.precopor = 1;
  $scope.pessoa = function() {$scope.evento.precopor = 1;};
  $scope.hora = function() {$scope.evento.precopor = 2;};

  $scope.Proximo = function(evento){
    if(!$scope.evento.preco){
      $scope.evento.preco = 0;
    }
    formEventoAbertosTab.updateForm(evento);
    $state.go('tabsController.criarmarcandogenero')
  }



}])

.controller('criarmarcandogeneroCtrl', ['$scope', '$stateParams', 'formUser', 'formLoc', 'EventoService', 'formAux', '$state','$timeout', '$ionicPopup', '$http', 'formOutro', 'formItem', 'formtela', 'formtelanoti', 'formtipologin','formEventoAbertosTab', '$ionicTabsDelegate', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, formUser, formLoc, EventoService, formAux, $state, $timeout, $ionicPopup, $http, formOutro, formItem, formtela, formtelanoti, formtipologin, formEventoAbertosTab, $ionicTabsDelegate) {

  $scope.evento = {};
  $scope.user = formUser.getForm();

  $scope.$on("$ionicView.enter", function(event, data){
    $ionicTabsDelegate.showBar(0);
    $scope.evento = formEventoAbertosTab.getForm();
    $scope.user = formUser.getForm();

  })

  if(!$scope.user.genero){
      $state.go('idadegenero');
    }else{
      if($scope.user.genero == "fem"){
        $scope.femin = true;
      }else{
        $scope.femin = false;
      }
  }

  $scope.Proximo = function(evento){
    if(! $scope.evento.genero){
       $scope.evento.genero = 'Todos';
    }
    formEventoAbertosTab.updateForm(evento);
    $state.go('tabsController.criarmarcandopminmax')
  }




}])

.controller('criarmarcandopminmaxCtrl', ['$scope', '$stateParams', 'formUser', 'formLoc', 'EventoService', 'formAux', '$state','$timeout', '$ionicPopup', '$http', 'formOutro', 'formItem', 'formtela', 'formtelanoti', 'formtipologin','formEventoAbertosTab', '$ionicTabsDelegate', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, formUser, formLoc, EventoService, formAux, $state, $timeout, $ionicPopup, $http, formOutro, formItem, formtela, formtelanoti, formtipologin, formEventoAbertosTab, $ionicTabsDelegate) {


  $scope.evento = {};
  $scope.user = formUser.getForm();

  $scope.$on("$ionicView.enter", function(event, data){
    $ionicTabsDelegate.showBar(0);
    $scope.evento = formEventoAbertosTab.getForm();
    $scope.user = formUser.getForm();
    if(!$scope.evento.pmin){
      $scope.evento.pmin = 2;
      $scope.evento.pmax = 10;
    }
   
  })

  $scope.menos = function(){
    if($scope.evento.pmin >2){
      $scope.evento.pmin--;
    }
  }
  $scope.mais = function(){
    if($scope.evento.pmin < 49){
      $scope.evento.pmin++;
      if($scope.evento.pmin >= $scope.evento.pmax){
        $scope.evento.pmax = $scope.evento.pmin+1;
      }
      
    }
  }

  $scope.menosmax = function(){
    if($scope.evento.pmax >3){
      $scope.evento.pmax--;
      if($scope.evento.pmax <= $scope.evento.pmin){
        $scope.evento.pmin = $scope.evento.pmax-1;
      }
    }
  }
  $scope.maismax = function(){
    if($scope.evento.pmax < 50){
      $scope.evento.pmax++;
    }
  }
  

  $scope.Proximo = function(evento){

    formEventoAbertosTab.updateForm(evento);
    $state.go('tabsController.criarmarcandotag')
  }




}])

.controller('criarmarcandotagCtrl', ['$scope', '$stateParams', 'formUser', 'formLoc', 'EventoService', 'formAux', '$state','$timeout', '$ionicPopup', '$http', 'formOutro', 'formItem', 'formtela', 'formtelanoti', 'formtipologin','formEventoAbertosTab', '$ionicTabsDelegate', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, formUser, formLoc, EventoService, formAux, $state, $timeout, $ionicPopup, $http, formOutro, formItem, formtela, formtelanoti, formtipologin, formEventoAbertosTab, $ionicTabsDelegate) {

  $scope.evento = {};
  $scope.user = formUser.getForm();

  $scope.$on("$ionicView.enter", function(event, data){
    $ionicTabsDelegate.showBar(0);
    $scope.evento = formEventoAbertosTab.getForm();
    $scope.user = formUser.getForm();
    if(!$scope.evento.auxtag1){
      $scope.evento.auxtag1 = '';
      $scope.evento.auxtagbutton1 = false;
    }
    if(!$scope.evento.auxtag2){
      $scope.evento.auxtag2 = '';
      $scope.evento.auxtagbutton2 = false;
    }
    if(!$scope.evento.auxtag3){
      $scope.evento.auxtag3 = '';
      $scope.evento.auxtagbutton3 = false;
    }
    if(!$scope.evento.auxtag4){
      $scope.evento.auxtag4 = '';
      $scope.evento.auxtagbutton4 = false;
    }
    if(!$scope.evento.auxtag5){
      $scope.evento.auxtag5 = '';
      $scope.evento.auxtagbutton5 = false;
    }
    if(!$scope.evento.auxtag6){
      $scope.evento.auxtag6 = '';
      $scope.evento.auxtagbutton6 = false;
    }
    if(!$scope.evento.auxtag7){
      $scope.evento.auxtag7 = '';
      $scope.evento.auxtagbutton7 = false;
    }
    if(!$scope.evento.auxtag8){
      $scope.evento.auxtag8 = '';
      $scope.evento.auxtagbutton8 = false;
    }
    if(!$scope.evento.auxtag9){
      $scope.evento.auxtag9 = '';
      $scope.evento.auxtagbutton9 = false;
    }
  })

  var auxauxtagbut = false;
  $scope.adicionatag = function(){
    if($scope.evento.addtag!=''){
      var res2 = $scope.evento.addtag.split(" ") ;
        if(res2.length>1){
          for(var w = 0; w < res2.length; w++){
            var t = res2[w].toLowerCase();
           console.log(t)
          }
          $scope.evento.addtag = res2[0];
        }
      if(!auxauxtagbut){
        auxauxtagbut = true;
        if($scope.evento.auxtagbutton1 == false && auxauxtagbut){
          $scope.evento.auxtag1 = '#' +$scope.evento.addtag;
          $scope.evento.auxtagbutton1 = true;
          auxauxtagbut = false;
        }
        if($scope.evento.auxtagbutton2 == false && auxauxtagbut){
          $scope.evento.auxtag2 = '#' +$scope.evento.addtag;
          $scope.evento.auxtagbutton2 = true;
          auxauxtagbut = false;
        }
        if($scope.evento.auxtagbutton3 == false && auxauxtagbut){
          $scope.evento.auxtag3 = '#' +$scope.evento.addtag;
          $scope.evento.auxtagbutton3 = true;
          auxauxtagbut = false;
        }
        if($scope.evento.auxtagbutton4 == false && auxauxtagbut){
          $scope.evento.auxtag4 = '#' +$scope.evento.addtag;
          $scope.evento.auxtagbutton4 = true;
          auxauxtagbut = false;
        }
        if($scope.evento.auxtagbutton5 == false && auxauxtagbut){
          $scope.evento.auxtag5 = '#' +$scope.evento.addtag;
          $scope.evento.auxtagbutton5 = true;
          auxauxtagbut = false;
        }
        if($scope.evento.auxtagbutton6 == false && auxauxtagbut){
          $scope.evento.auxtag6 = '#' +$scope.evento.addtag;
          $scope.evento.auxtagbutton6 = true;
          auxauxtagbut = false;
        }
        if($scope.evento.auxtagbutton7 == false && auxauxtagbut){
          $scope.evento.auxtag7 = '#' +$scope.evento.addtag;
          $scope.evento.auxtagbutton7 = true;
          auxauxtagbut = false;
        }
        if($scope.evento.auxtagbutton8 == false && auxauxtagbut){
          $scope.evento.auxtag8 = '#' +$scope.evento.addtag;
          $scope.evento.auxtagbutton8 = true;
          auxauxtagbut = false;
        }
        if($scope.evento.auxtagbutton9 == false && auxauxtagbut){
          $scope.evento.auxtag9 = '#' +$scope.evento.addtag;
          $scope.evento.auxtagbutton9 = true;
          auxauxtagbut = false;
        }
      }
    }
    $scope.evento.addtag = '';
  }

  $scope.tiratag1 = function(){
      $scope.evento.auxtagbutton1 = false;
      $scope.evento.auxtag1 = '';
  }
  $scope.tiratag2 = function(){
      $scope.evento.auxtagbutton2 = false;
      $scope.evento.auxtag2 = '';
  }
  $scope.tiratag3 = function(){
      $scope.evento.auxtagbutton3 = false;
      $scope.evento.auxtag3 = '';
  }
  $scope.tiratag4 = function(){
      $scope.evento.auxtagbutton4 = false;
      $scope.evento.auxtag4 = '';
  }
  $scope.tiratag5 = function(){
      $scope.evento.auxtagbutton5 = false;
      $scope.evento.auxtag5 = '';
  }
  $scope.tiratag6 = function(){
      $scope.evento.auxtagbutton6 = false;
      $scope.evento.auxtag6 = '';
  }
  $scope.tiratag7 = function(){
      $scope.evento.auxtagbutton7 = false;
      $scope.evento.auxtag7 = '';
  }
  $scope.tiratag8 = function(){
      $scope.evento.auxtagbutton8 = false;
      $scope.evento.auxtag8 = '';
  }
  $scope.tiratag9 = function(){
      $scope.evento.auxtagbutton9 = false;
      $scope.evento.auxtag9 = '';
  }

  $scope.Proximo = function(evento){
     if($scope.evento.auxtagbutton1 == true){
        if ($scope.evento.tags == undefined) {
          $scope.evento.tags = $scope.evento.auxtag1;
        }else{
          $scope.evento.tags = $scope.evento.tags + ' ' +$scope.evento.auxtag1;
        }
      }
      if($scope.evento.auxtagbutton2 == true){
        if ($scope.evento.tags == undefined) {
          $scope.evento.tags = $scope.evento.auxtag2;
        }else{
          $scope.evento.tags = $scope.evento.tags + ' ' +$scope.evento.auxtag2;
        }
      }
      if($scope.evento.auxtagbutton3 == true){
        if ($scope.evento.tags == undefined) {
          $scope.evento.tags = $scope.evento.auxtag3;
        }else{
        $scope.evento.tags = $scope.evento.tags + ' ' +$scope.evento.auxtag3;
        }
      }
      if($scope.evento.auxtagbutton4 == true){
        if ($scope.evento.tags == undefined) {
          $scope.evento.tags = $scope.evento.auxtag4;
        }else{
          $scope.evento.tags = $scope.evento.tags + ' ' +$scope.evento.auxtag4;
        }
      }
      if($scope.evento.auxtagbutton5 == true){
        if ($scope.evento.tags == undefined) {
          $scope.evento.tags = $scope.evento.auxtag5;
        }else{
          $scope.evento.tags = $scope.evento.tags + ' ' +$scope.evento.auxtag5;
        }
      }
      if($scope.evento.auxtagbutton6 == true){
        if ($scope.evento.tags == undefined) {
          $scope.evento.tags = $scope.evento.auxtag6;
        }else{
          $scope.evento.tags = $scope.evento.tags + ' ' +$scope.evento.auxtag6;
        }
      }
      if($scope.evento.auxtagbutton7 == true){
        if ($scope.evento.tags == undefined) {
          $scope.evento.tags = $scope.evento.auxtag7;
        }else{
          $scope.evento.tags = $scope.evento.tags + ' ' +$scope.evento.auxtag7;
        }
      }
      if($scope.evento.auxtagbutton8 == true){
        if ($scope.evento.tags == undefined) {
          $scope.evento.tags = $scope.evento.auxtauxtag8ag2;
        }else{
          $scope.evento.tags = $scope.evento.tags + ' ' +$scope.evento.auxtag8;
        }
      }
      if($scope.evento.auxtagbutton9 == true ){
        if ($scope.evento.tags == undefined) {
          $scope.evento.tags = $scope.evento.auxtag9;
        }else{
          $scope.evento.tags = $scope.evento.tags + ' ' +$scope.evento.auxtag9;
        }
      }

    if (!$scope.evento.tags) {
      var alertPopup = $ionicPopup.alert({
        title: '(⊙﹏⊙✿)',
        template: 'Coloque pelo menos uma tag para facilitar a procura do seu evento'
      });
    }else{
      formEventoAbertosTab.updateForm(evento);
      $state.go('tabsController.criarmarcandotitulo')
    }
  }


}])

.controller('criarmarcandotituloCtrl', ['$scope', '$stateParams', 'formUser', 'formLoc', 'EventoService', 'formAux', '$state','$timeout', '$ionicPopup', '$http', 'formOutro', 'formItem', 'formtela', 'formtelanoti', 'formtipologin','formEventoAbertosTab', '$ionicTabsDelegate', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, formUser, formLoc, EventoService, formAux, $state, $timeout, $ionicPopup, $http, formOutro, formItem, formtela, formtelanoti, formtipologin, formEventoAbertosTab, $ionicTabsDelegate) {

  $scope.evento = {};
  $scope.user = formUser.getForm();

  $scope.$on("$ionicView.enter", function(event, data){
    $ionicTabsDelegate.showBar(0);
    $scope.evento = formEventoAbertosTab.getForm();
    $scope.user = formUser.getForm();
  })



  $scope.Proximo = function(evento){

    if($scope.evento.nomeevento){
      var palavrasnaousar = ["ALIAMBA", "ANUS", "BAGULIO"
      , "BANZA", "BARRUFO", "BECK", "BEQUE", "BOCETA"
      , "BOLAGATO", "BOQUETE", "BOLCAT", "BOSSETA", "BOSTANA", "BREXA", "BRIOCO", "BRONHA", "BUCA", "BUCETA"
      , "BUSSETA", "CANABIS", "CANNABIS", "CARALHO"
      , "CASSETA", "CASSETE", "CHECHECA", "CHERECA", "CHIBUMBA", "CHIBUMBO", "CHOTA", "CHOCHOTA", "CHUPADA", "CHUPADO", "CLITORIS"
      , "COCAINA", "C+"
      , "C*", "CURALHO", "CUZAO", "CUZUDA", "CUZUDO", "CUZÃO", "ESPORRADA", "ESPORRADO", "ESPORRO", "estupro"
      , "FELACAO", "FELACÃO", "FODA", "FODAO", "FODÃO", "FODAUM", "FODE", "FODIDA", "FODIDO", "FORNICA", "FUDENDO", "FUDECÃO", "FUDECAO"
      , "FUDIDA", "FUDIDO", "GRELINHO", "GRELO", "ISCROTA", "ISCROTO", "MACONHA", "MASTURBA", "MASTURBAÇÃO", "MASTURBACÃO", "MASTURBACAO"
      , "PENIS", "PEN1S", "PENES", "PENIZ", "PICA", "PIROCA", "PIRU", "PORRA", "POURRA", "PROSTIBULO", "PUTA", "PUNHETA", "PUTO"
      , "RABAO", "TESTUDA", "TESTUDO", "VAGABUNDA", "VAGINA", "VIADO", "VIADAO", "VIADÃO", "XAVASCA", "XERERECA", "XEXECA", "XOTA"
      , "XOCHOTA", "XOXOTA", "XANA", "XANINHA", "MDMA",  "VSF", "TNC", "FDP", "CRACK"];
      var error = 0; 
      for (var i = 0; i < palavrasnaousar.length; i++) {
        var res2 = $scope.evento.nomeevento.split("_") ;
        if(res2.length>1){
          for(var w = 0; w < res2.length; w++){
            var val = palavrasnaousar[i].toLowerCase();
            if ((res2[w].toLowerCase()).indexOf(val.toString()) > -1) {  
              error = error + 1;  
            }
          }
        }else{
          var val = palavrasnaousar[i].toLowerCase();  
          if (($scope.evento.nomeevento.toLowerCase()).indexOf(val.toString()) > -1) {  
            error = error + 1;  
          }
        }
        var res3 = $scope.evento.nomeevento.split(" ");
        if(res3.length>1){
          for(var w = 0; w < res3.length; w++){
            var val = palavrasnaousar[i].toLowerCase();
            if ((res3[w].toLowerCase()).indexOf(val.toString()) > -1) {  
              error = error + 1;  
            }
          }
        }else{
          var val = palavrasnaousar[i].toLowerCase();  
          if (($scope.evento.nomeevento.toLowerCase()).indexOf(val.toString()) > -1) {  
            error = error + 1;  
          }
        }   
      } 
      if (error > 0) {  
          var alertPopup = $ionicPopup.alert({
                title: '（・о・；）',
                template: 'Que boquinha suja eim, usaste uma palavra inapropriada né'
              }); 
      }else{
        formEventoAbertosTab.updateForm(evento);
        $state.go('tabsController.criarmarcandodescricao') 
      }
    }else{
      var alertPopup = $ionicPopup.alert({
        title: '（ΦωΦ）',
        template: 'Coloque um nome legal'
      });
    }
    
  }



}])

.controller('criarmarcandodescricaoCtrl', ['$scope', '$stateParams', 'formUser', 'formLoc', 'EventoService', 'formAux', '$state','$timeout', '$ionicPopup', '$http', 'formOutro', 'formItem', 'formtela', 'formtelanoti', 'formtipologin','formEventoAbertosTab', '$ionicTabsDelegate', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, formUser, formLoc, EventoService, formAux, $state, $timeout, $ionicPopup, $http, formOutro, formItem, formtela, formtelanoti, formtipologin, formEventoAbertosTab, $ionicTabsDelegate) {
  $scope.evento = {};
  $scope.user = formUser.getForm();

  $scope.$on("$ionicView.enter", function(event, data){
    $ionicTabsDelegate.showBar(0);
    $scope.evento = formEventoAbertosTab.getForm();
    $scope.user = formUser.getForm();
  })



  $scope.Proximo = function(evento){

      var palavrasnaousar = ["ALIAMBA", "ANUS", "BAGULIO"
      , "BANZA", "BARRUFO", "BECK", "BEQUE", "BOCETA"
      , "BOLAGATO", "BOQUETE", "BOLCAT", "BOSSETA", "BOSTANA", "BREXA", "BRIOCO", "BRONHA", "BUCA", "BUCETA"
      , "BUSSETA", "CANABIS", "CANNABIS", "CARALHO"
      , "CASSETA", "CASSETE", "CHECHECA", "CHERECA", "CHIBUMBA", "CHIBUMBO", "CHOTA", "CHOCHOTA", "CHUPADA", "CHUPADO", "CLITORIS"
      , "COCAINA","C+"
      , "C*", "CURALHO", "CUZAO", "CUZUDA", "CUZUDO", "CUZÃO", "ESPORRADA", "ESPORRADO", "ESPORRO", "estupro"
      , "FELACAO", "FELACÃO", "FODA", "FODAO", "FODÃO", "FODAUM", "FODE", "FODIDA", "FODIDO", "FORNICA", "FUDENDO", "FUDECÃO", "FUDECAO"
      , "FUDIDA", "FUDIDO", "GRELINHO", "GRELO", "ISCROTA", "ISCROTO", "MACONHA", "MASTURBA", "MASTURBAÇÃO", "MASTURBACÃO", "MASTURBACAO"
      , "PENIS", "PEN1S", "PENES", "PENIZ", "PICA", "PIROCA", "PIRU", "PORRA", "POURRA", "PROSTIBULO", "PUTA", "PUNHETA", "PUTO"
      , "RABAO", "TESTUDA", "TESTUDO", "VAGABUNDA", "VAGINA", "VIADO", "VIADAO", "VIADÃO", "XAVASCA", "XERERECA", "XEXECA", "XOTA"
      , "XOCHOTA", "XOXOTA", "XANA", "XANINHA", "MDMA", "VSF", "TNC", "FDP", "CRACK"];
      var error = 0; 
      for (var i = 0; i < palavrasnaousar.length; i++) {
        var res2 = $scope.evento.descricao.split("_") ;
        if(res2.length>1){
          for(var w = 0; w < res2.length; w++){
            var val = palavrasnaousar[i].toLowerCase();
            if ((res2[w].toLowerCase()).indexOf(val.toString()) > -1) {  
              error = error + 1;  
            }
          }
        }else{
          var val = palavrasnaousar[i].toLowerCase();  
          if (($scope.evento.descricao.toLowerCase()).indexOf(val.toString()) > -1) {  
            error = error + 1;  
          }
        }
        var res3 = $scope.evento.descricao.split(" ") ;
        if(res3.length>1){
          for(var w = 0; w < res3.length; w++){
            var val = palavrasnaousar[i].toLowerCase();
            if ((res3[w].toLowerCase()).indexOf(val.toString()) > -1) {  
              error = error + 1;  
            }
          }
        }else{
          var val = palavrasnaousar[i].toLowerCase();  
          if (($scope.evento.descricao.toLowerCase()).indexOf(val.toString()) > -1) {  
            error = error + 1;  
          }
        }   
      } 
      if (error > 0) {  
          var alertPopup = $ionicPopup.alert({
                title: '（・о・；）',
                template: 'Que boquinha suja eim, usaste uma palavra inapropriada né'
              }); 
      }else{   
        if(evento.descricao){
          formEventoAbertosTab.updateForm($scope.evento);
          $state.go('tabsController.criarmarcandofoto');
        }else{
          var alertPopup = $ionicPopup.alert({
                title: '( ꒪Д꒪)ノ',
                template: 'Escreva algo na descrição do evento para ajudar as pessoas a entenderem o que será feito'
              }); 
        }
        
      }
  
    
  }



}])


.controller('criarmarcandofotoCtrl', ['$scope', '$stateParams', '$state', 'formEventoCriar', 'formUser','$ionicPopup', '$http', 'formtela2', 'formtelaCriar', 'EventoService', '$cordovaCamera', '$cordovaFile', '$cordovaFileTransfer', '$cordovaDevice',  '$ionicLoading','formEventoAbertosTab', '$ionicTabsDelegate', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, $state, formEventoCriar, formUser, $ionicPopup, $http, formtela2, formtelaCriar, EventoService, $cordovaCamera, $cordovaFile, $cordovaFileTransfer, $cordovaDevice,  $ionicLoading,  formEventoAbertosTab, $ionicTabsDelegate) {
 
  $scope.user = formUser.getForm();
  var noti = {};
  $scope.imgURI = "img/ev.png"
  $scope.pushnoti ={};
  $scope.auxfoto = '';
  $scope.confirmacao = 'aprovado';
  $scope.estado = '0';
  $scope.ic = {};
  var evpic ='';
  
    document.getElementById("imageidEvento").src="img/ev.png";
    $scope.getPicture = function (optionsCamera) {
      var optionsCamera = {
            quality : 100,
            sourceType : 0,
            allowEdit : true,
            targetWidth: 640,
            targetHeight: 640
      };
      $cordovaCamera.getPicture(optionsCamera).then(function(imageData) {
        $scope.imgURI = imageData;
        document.getElementById("imageidEvento").src=imageData;
      }, function(err) {
        console.log(err);
      });
    };


    $scope.$on("$ionicView.enter", function(event, data){
      $ionicTabsDelegate.showBar(0);
      $scope.evento = formEventoAbertosTab.getForm();
      $scope.user = formUser.getForm();
    });

     $scope.Proximo = function(evento) {
      var hj = evento.diainicio;      var mes = (hj[5]+hj[6]).valueOf();
      var dia = (hj[8]+hj[9]).valueOf();
      var diadia = dia+'/'+mes;
      if($scope.imgURI != "img/ev.png"){ 
        $scope.auxfoto = $scope.evento.nomeevento + $scope.evento.diainicio;
        var mystring = String($scope.auxfoto);
        mystring = mystring.replace(/[^a-zA-Z0-9]/g, '');
        $scope.evento.eventopic = 'https://s3.amazonaws.com/diwoappprofilepics/eventopicsdiwo/' + mystring + '.jpg';
      }else{
        $scope.evento.eventopic = "img/ev.png";
      }
      var url = "https://ec2.diwoapp.com.br/uploadfotoevento.php";
                              // File for Upload
      var targetPath = $scope.imgURI;
     
      // File name only
      //var name = $scope.imgURI.substr(imageData.lastIndexOf('/') + 1);
      var filename = mystring + '.jpg';
      // NO CASO SERIA O NOME DO USUARIO.jpg O fileName
      var options = {
        fileKey: "file",
        fileName: filename,
        chunkedMode: false,
        mimeType: "multipart/form-data"
      };
        $cordovaFileTransfer.upload(url, targetPath, options).then(function(result) {
          var link = 'https://ec2.diwoapp.com.br/criarevento.php';
          $http.post(link, {nomeevento : $scope.evento.nomeevento, 
                                    duracao : $scope.evento.duracao,
                                    diainicio : $scope.evento.diainicio,
                                    semana : $scope.evento.semana,
                                    diafim : $scope.evento.diafim,
                                    dialimiteconfirmacao: $scope.evento.dialimiteconfirmacao,
                                    pmin : $scope.evento.pmin, 
                                    patual : 1, 
                                    pmax : $scope.evento.pmax,
                                    adm : $scope.user.iduser,
                                    admusername : $scope.user.username,
                                    admapelido : $scope.user.apelido,
                                    preco : $scope.evento.preco,
                                    precopor : $scope.evento.precopor,  
                                    nomelocal : $scope.evento.nomelocal,
                                    endereco : $scope.evento.endereco,
                                    cidade : $scope.evento.cidade,
                                    lat : $scope.evento.lat,
                                    lng : $scope.evento.lng,
                                    genero : $scope.evento.genero,
                                    eventopic : $scope.evento.eventopic,
                                    descricao : $scope.evento.descricao,
                                    comerciodevicetoken : $scope.user.devicetoken}).then(function (res){
                      $scope.responsecriado = res.data;
            console.log(res.data.success, "criou");
            if ($scope.responsecriado.success == true) {    
                    // CRIO TAG
              var res = $scope.evento.tags.split(" ") ;
              for (var i = 0; i<res.length;i++){
                if(res[i][0]!='#'){
                  res[i]= '#' + res[i];
                }
                console.log(res[i], "tags")
                var link = 'https://ec2.diwoapp.com.br/criartag.php';
                  $http.post(link, {idevento : $scope.responsecriado.last, 
                                    tag : res[i]}).then(function (res){console.log(res.success, "criou tag")});
              }
              var link = 'https://ec2.diwoapp.com.br/irevento.php';
              $http.post(link, {idevento : $scope.responsecriado.last, 
                                iduser : $scope.user.iduser,
                                idadm : $scope.user.iduser,
                                admusername : $scope.user.username,  
                                diainicio : $scope.evento.diainicio,
                                diafim : $scope.evento.diafim,
                                username : $scope.user.username,
                                borda : $scope.user.borda,
                                apelido : $scope.user.apelido,
                                profilepic : $scope.user.profilepic,
                                devicetoken : $scope.user.devicetoken,
                                confirmacao : $scope.confirmacao,
                                nomeevento :  $scope.evento.nomeevento,
                                idComercioParceiro : $scope.evento.idComercioParceiro, 
                                eventopic : $scope.evento.eventopic, 
                                estado : $scope.estado}).then(function (res){
              $scope.response = res.data;
              console.log($scope.response);
              $http.post('https://ec2.diwoapp.com.br/pessoanaoevento.php', {iduser : $scope.user.iduser, 
                                                                    idevento : $scope.responsecriado.last,
                                                                    nomeevento : $scope.evento.nomeevento,
                                                                    estado : '10'});
              $http.post("https://ec2.diwoapp.com.br/getavisacriandochat.php", {iduser : $scope.user.iduser, idevento : $scope.responsecriado.last}).then(function(response) {
                      console.log(response.data[0])
                      if(response.data[0] != 'E'){
                        $scope.auxresp = response.data[0]; 
                        for(var  i = 0 ; i<response.data[0].length;i++){
                          $scope.pushnoti.titulo =$scope.user.apelido + " criou um evento a partir do chat!!";
                          $scope.pushnoti.msg = $scope.evento.nomeevento + " acontecerá na " +$scope.evento.semana +" dia "+$scope.evento.diainicio[8]+$scope.evento.diainicio[9]+'/'+$scope.evento.diainicio[5]+$scope.evento.diainicio[6]  + " fique de ligado 👻";
                          $scope.pushnoti.token = $scope.auxresp[i].devicetoken;
                          EventoService.MandaPushNoti($scope.pushnoti);
                        }
                       }
                    });
                  $http.post("https://ec2.diwoapp.com.br/getavisafollow.php", {iduser : $scope.user.iduser}).then(function(response) {
                      console.log(response.data[0])
                      if(response.data[0] != 'E'){
                        $scope.auxresp = response.data[0]; 
                        for(var  i = 0 ; i<response.data[0].length;i++){
                          $scope.pushnoti.titulo =$scope.user.apelido + " criou um evento novo!!";
                          $scope.pushnoti.msg = $scope.evento.nomeevento + " acontecerá na " +$scope.evento.semana +" dia "+$scope.evento.diainicio[8]+$scope.evento.diainicio[9]+'/'+$scope.evento.diainicio[5]+$scope.evento.diainicio[6]  + " fique de ligado 👻";
                          $scope.pushnoti.token = $scope.auxresp[i].devicetoken;
                          EventoService.MandaPushNoti($scope.pushnoti);
                        }
                       }
                    });
                    $http.post("https://ec2.diwoapp.com.br/getavisareventoscriados.php", {iduser : $scope.user.iduser}).then(function(response) {
                      console.log(response.data[0])
                      if(response.data[0] != 'E'){
                        $scope.auxresp = response.data[0]; 
                        for(var  i = 0 ; i<response.data[0].length;i++){
                          $scope.pushnoti.titulo = "Eeeii pssssiu!!";
                          $scope.pushnoti.msg =  "Um novo evento foi criado perto de vc, bora dar uma checada?👀";
                          $scope.pushnoti.token = $scope.auxresp[i].devicetoken;
                          EventoService.MandaPushNoti($scope.pushnoti);
                        }
                       }
                    });
                if ($scope.response.success == true) {

                    $ionicLoading.hide();
                     var alertPopup = $ionicPopup.alert({
                      title: 'Parabéns',
                      template: $scope.responsecriado.msg
                    }); 
                    alertPopup.then(function(){
                      $ionicLoading.hide();
                      formEventoAbertosTab.updateForm(1);
                      formtela2.updateForm(1);
                      $scope.evento = {};
                      $state.go('tabsController.home');
                   })
                   
                }else{
                    var alertPopup = $ionicPopup.alert({
                      title: 'Ocorreu uma falha',
                      template: $scope.responsecriado.msg
                    });
                    alertPopup.then(function(){
                      $ionicLoading.hide();
                      $scope.evento = {};
                      formEventoAbertosTab.updateForm($scope.evento);
                      $state.go('tabsController.home');
                   })
                }
              }) 
            }

        }, function(err) {
          $ionicPopup.alert({
            title: 'Sorry!',
            template: 'Aconteceu um probleminha, tente de novo'
          });
          $ionicLoading.hide();
        }, function (progress) {
          $ionicLoading.show({
            title: '┗(＾0＾)┓',
            template: 'DANCE, DANCE, DANCE!!'
          });
        });


        });    
    }

  

}])

.controller('evento_do_eventoAbertosCtrl', ['$scope', '$stateParams', 'formItem', 'formUser', 'formOutro', '$http', '$timeout','$ionicPopup', 'EventoService', '$state', 'formtelaCriar', 'formEventoAbertosTab','formEventoEdita','$ionicTabsDelegate','$cordovaSocialSharing', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, formItem, formUser, formOutro, $http, $timeout, $ionicPopup, EventoService, $state, formtelaCriar, formEventoAbertosTab, formEventoEdita,$ionicTabsDelegate, $cordovaSocialSharing) {
    //$scope.evento = formItem.getForm();
    $scope.evento = formEventoAbertosTab.getForm();
    console.log("ajsdiansd")
    console.log($scope.evento, "era pra estar aqui");
    $scope.aux = formUser.getForm();
    //console.log($scope.aux.iduser);
    $scope.data = {};
    $scope.tag = '';
    $scope.deletarPessoa = false;
    $scope.confirmaPessoa =false;
    $scope.items = [];
    $scope.limiteconfirmacao ={};
    $scope.fim = {};
    $scope.dia = {};
    $scope.pushnoti = {};

    var zone;
    var meuestado;
    var noti = {};
    var confirm = $scope.aux.iduser;
    $ionicTabsDelegate.showBar(0);
    

    var hj = new Date();
    var currentdate = new Date(); 
    var curr_date = (currentdate.getDate()<10?'0':'') + currentdate.getDate();
    var curr_month = (currentdate.getMonth()<10?'0':'') + (currentdate.getMonth() + 1); //Months are zero based
    var curr_year = currentdate.getFullYear();
    var h2 = (currentdate.getHours()<10?'0':'') + currentdate.getHours();
    var m2 = (currentdate.getMinutes()<10?'0':'') + currentdate.getMinutes();

    hj = $scope.evento.diainicio;

    var ano = (hj[0]+hj[1]+hj[2]+hj[3]).valueOf()-curr_year;
    var mes = (hj[5]+hj[6]).valueOf()-curr_month;
    var dia = (hj[8]+hj[9]).valueOf()-curr_date;
    var h = (hj[11]+hj[12]).valueOf()-h2;
    var m = (hj[14]+hj[15]).valueOf()-m2;

    hjl = $scope.evento.dialimiteconfirmacao;
    $scope.dialimiteconfirmacao =  (hjl[8]+hjl[9]).valueOf()+'/'+(hjl[5]+hjl[6]).valueOf()+'/'+(hjl[0]+hjl[1]+hjl[2]+hjl[3])+' '+(hjl[11]+hjl[12]).valueOf()+':'+(hjl[14]+hjl[15]).valueOf();
    
    var anol = (hjl[0]+hjl[1]+hjl[2]+hjl[3]).valueOf()-curr_year;
    var mesl = (hjl[5]+hjl[6]).valueOf()-curr_month;
    var dial = (hjl[8]+hjl[9]).valueOf()-curr_date;
    var hl = (hjl[11]+hjl[12]).valueOf()-h2;
    var ml = (hjl[14]+hjl[15]).valueOf()-m2;
    
    //$scope.dia = (hj[8]+hj[9]).valueOf()+'/'+(hj[5]+hj[6]).valueOf()+'/'+(hj[0]+hj[1]+hj[2]+hj[3])+' '+(hj[11]+hj[12]).valueOf()+':'+(hj[14]+hj[15]).valueOf();

    var hjf = $scope.evento.diafim;
    $scope.diafim =  (hjf[8]+hjf[9]).valueOf()+'/'+(hjf[5]+hjf[6]).valueOf()+'/'+(hjf[0]+hjf[1]+hjf[2]+hjf[3])+' '+(hjf[11]+hjf[12]).valueOf()+':'+(hjf[14]+hjf[15]).valueOf();
    
    var hjd = $scope.evento.duracao;
    var hd = (hjd[0]+hjd[1]).valueOf();
    var md = (hjd[3]+hjd[4]).valueOf();
    $scope.duracao= hd+':'+md;
    $scope.limiteconfirmacao.dia =  (hjl[8]+hjl[9]).valueOf()+'/'+(hjl[5]+hjl[6]).valueOf();
    $scope.limiteconfirmacao.hora =  (hjl[11]+hjl[12]).valueOf()+':'+(hjl[14]+hjl[15]).valueOf();  
    

    $scope.fim.dia =  (hjf[8]+hjf[9]).valueOf()+'/'+(hjf[5]+hjf[6]).valueOf()+'/'+(hjf[0]+hjf[1]+hjf[2]+hjf[3]);
    $scope.fim.hora = (hjf[11]+hjf[12]).valueOf()+':'+(hjf[14]+hjf[15]).valueOf();
    $scope.dia.dia = (hj[8]+hj[9]).valueOf()+'/'+(hj[5]+hj[6]).valueOf();
    $scope.dia.hora = (hj[11]+hj[12]).valueOf()+':'+(hj[14]+hj[15]).valueOf() +' - '+(hjf[11]+hjf[12]).valueOf()+':'+(hjf[14]+hjf[15]).valueOf() ;

    if($scope.limiteconfirmacao.dia == $scope.dia.dia){
      $scope.limsemana = $scope.evento.semana;
    }else{
      if($scope.evento.semana == "Segunda-feira"){
        $scope.limsemana = "Domingo";
      }
      if($scope.evento.semana == "Terça-feira"){
        $scope.limsemana = "Segunda-feira";
      }
      if($scope.evento.semana == "Quarta-feira"){
        $scope.limsemana = "Terça-feira";
      }
      if($scope.evento.semana == "Quinta-feira"){
        $scope.limsemana = "Quarta-feira";
      }
      if($scope.evento.semana == "Sexta-feira"){
        $scope.limsemana = "Quinta-feira";
      }
      if($scope.evento.semana == "Sábado"){
        $scope.limsemana = "Sexta-feira";
      }
      if($scope.evento.semana == "Domingo"){
        $scope.limsemana = "Sábado";
      }
    }
    EventoService.Gettags($scope.evento.idevento).then(function(tags) {
      console.log(tags, "tags")
      if(tags!='E'){
        for(var  i =0; i< tags.length;i++){
          $scope.tag = ($scope.tag + ' ' + tags[i].tag);
        } 
      }
      
    });

          // YELLOW ZONE qualquer pessoa confirmada por confirmar a pessoa que nao foi confirmada
    console.log(anol, mesl, dial , hl, ml , hjl,);
       ///errradooo
    if(anol == 0 && mesl == 0 && dial == 0 && ((hl == 1 && ml<30 && ml>0)||(hl==0 && ml > 30)|| (hl==1 && ml>-30))){
      console.log('YELLOW-ZONE');
      zone = 'yellow';
      $scope.confirmaPessoa =true;
    }
   if($scope.evento.preco == 0 || $scope.evento.preco =="Gratuito"){
      $scope.evento.preco = "Gratuito";
      $scope.porpessoa = false;
      $scope.porlocal = false;
    }else{
      if($scope.evento.precopor == 1){
        $scope.porpessoa = true;
        $scope.porlocal = false;
      }else{
        $scope.porpessoa = false;
        $scope.porlocal = true;
      }
    }

          // RED ZONE 
        if(anol<0 || mesl < 0 ||(anol == 0 && mesl == 0 && (dial < 0 || (dial==0 && ((hl == 0 && ml<=0)||(hl < 0)))))){
      console.log('RED-ZONE');
      zone = 'red';
      $scope.confirmaPessoa =false;
      $scope.deletarPessoa = false;
      $scope.edita = false;
    }
    if($scope.evento.adm ==  $scope.aux.iduser){
      $scope.deletarPessoa = true;
      $scope.confirmaPessoa =true;
      if(zone == 'red'){
        $scope.edita = false;
        $scope.deletarPessoa = false;
      }else{
        $scope.edita = true;
      }
    }
    if($scope.evento.genero == "masc"){
      $scope.masc = true;
      $scope.fem = false;
    }
    if($scope.evento.genero == "fem"){
        $scope.fem = true;
        $scope.masc = false;
    }
    if($scope.evento.genero == "todos"){
        $scope.fem = false;
        $scope.masc = false;
    }

    if(parseInt($scope.evento.patual) < parseInt($scope.evento.pmin) && zone == 'red'){
            console.log('Evento não acontece por falta de pessoas')
          }
    if(parseInt($scope.evento.patual) < parseInt($scope.evento.pmin) && zone == 'yellow'){
      console.log('Evento esta com poucas pessoas, talvez ele nao aconteça')
    }
    EventoService.GetParticipantes($scope.evento.idevento).then(function(items) {
      //console.log(items[0].idevento);
      $scope.nomeevento = items[0].nomeevento;
      for (var i = 0; i < items.length; i++) {
        if ($scope.aux.iduser == items[i].iduser) {
          meuestado = items[i].estado;
          $scope.nuser++;
        }
        if (items[i].estado == 0) {
          items[i].confirmacao = 'Sou o organizador';
          $scope.criador = items[i].iduser;
        }
        if (items[i].estado == 1) {
          items[i].confirmacao = 'Aguardando confirmação';
        }
        if (items[i].estado == 2) {
          items[i].confirmacao = 'Confirmação aprovada';
        }
        if(items[i].borda == 0){
            items[i].bb = false;
            items[i].bs = false;
            items[i].bg = false;
          }
          if(items[i].borda == 1){
            items[i].bb = true;
            items[i].bs = false;
            items[i].bg = false;
          }
          if(items[i].borda == 2){
            items[i].bb = false;
            items[i].bs = true;
            items[i].bg = false;
          }
          if(items[i].borda == 3){
            items[i].bb = false;
            items[i].bs = false;
            items[i].bg = true;
          } 
          if((items[i].profilepic[8] == 's' && items[i].profilepic[9] == '3')||(items[i].profilepic[8] == 'd' && items[i].profilepic[9] == 'i')){
                          
            items[i].profilepic=items[i].profilepic+"?{{getTimeStamp()}}";
           }else{
             items[i].profilepic=items[i].profilepic;
           }
          //items[i].profilepic = items[i].profilepic+"?{{getTimeStamp()}}";
      }
      $scope.items = items;
      
    });

    $scope.$on("$ionicView.enter", function(event, data){
      //$scope.evento = formItem.getForm();
      $scope.evento = formEventoAbertosTab.getForm();
      $scope.data = {};
      $scope.tag = '';
      $scope.deletarPessoa = false;
      $scope.confirmaPessoa =false;
      $scope.items = [];
      $scope.pushnoti = {};
      zone;
      meuestado;
      noti = {};
      confirm = $scope.aux.iduser;
     

      if(!$scope.evento.dialimiteconfirmacao){
        console.log($scope.evento.idevento)
        $http.post('https://ec2.diwoapp.com.br/geteventoporid.php', {idevento : $scope.evento.idevento}).then(function (result){
          $scope.evento = result.data[0];
          hj = new Date();
          currentdate = new Date(); 
          curr_date = (currentdate.getDate()<10?'0':'') + currentdate.getDate();
           curr_month = (currentdate.getMonth()<10?'0':'') + (currentdate.getMonth() + 1); //Months are zero based
           curr_year = currentdate.getFullYear();
           h2 = (currentdate.getHours()<10?'0':'') + currentdate.getHours();
           m2 = (currentdate.getMinutes()<10?'0':'') + currentdate.getMinutes();

          hj = $scope.evento.diainicio;

           ano = (hj[0]+hj[1]+hj[2]+hj[3]).valueOf()-curr_year;
           mes = (hj[5]+hj[6]).valueOf()-curr_month;
           dia = (hj[8]+hj[9]).valueOf()-curr_date;
           h = (hj[11]+hj[12]).valueOf()-h2;
           m = (hj[14]+hj[15]).valueOf()-m2;

          hjl = $scope.evento.dialimiteconfirmacao;
          
           anol = (hjl[0]+hjl[1]+hjl[2]+hjl[3]).valueOf()-curr_year;
           mesl = (hjl[5]+hjl[6]).valueOf()-curr_month;
           dial = (hjl[8]+hjl[9]).valueOf()-curr_date;
           hl = (hjl[11]+hjl[12]).valueOf()-h2;
           ml = (hjl[14]+hjl[15]).valueOf()-m2;
          
          
           hjf = $scope.evento.diafim;

          $scope.diafim =  (hjf[8]+hjf[9]).valueOf()+'/'+(hjf[5]+hjf[6]).valueOf()+'/'+(hjf[0]+hjf[1]+hjf[2]+hjf[3])+' '+(hjf[11]+hjf[12]).valueOf()+':'+(hjf[14]+hjf[15]).valueOf();
          $scope.dialimiteconfirmacao =  (hjl[8]+hjl[9]).valueOf()+'/'+(hjl[5]+hjl[6]).valueOf()+'/'+(hjl[0]+hjl[1]+hjl[2]+hjl[3])+' '+(hjl[11]+hjl[12]).valueOf()+':'+(hjl[14]+hjl[15]).valueOf();
          var hjd = $scope.evento.duracao;
          var hd = (hjd[0]+hjd[1]).valueOf();
          var md = (hjd[3]+hjd[4]).valueOf();
          $scope.duracao= hd+':'+md;

          $scope.limiteconfirmacao.dia =  (hjl[8]+hjl[9]).valueOf()+'/'+(hjl[5]+hjl[6]).valueOf();
          $scope.limiteconfirmacao.hora =  (hjl[11]+hjl[12]).valueOf()+':'+(hjl[14]+hjl[15]).valueOf();  
          
          $scope.fim.dia =  (hjf[8]+hjf[9]).valueOf()+'/'+(hjf[5]+hjf[6]).valueOf()+'/'+(hjf[0]+hjf[1]+hjf[2]+hjf[3]);
          $scope.fim.hora = (hjf[11]+hjf[12]).valueOf()+':'+(hjf[14]+hjf[15]).valueOf();
          $scope.dia.dia = (hj[8]+hj[9]).valueOf()+'/'+(hj[5]+hj[6]).valueOf();
           $scope.dia.hora = (hj[11]+hj[12]).valueOf()+':'+(hj[14]+hj[15]).valueOf() +' - '+(hjf[11]+hjf[12]).valueOf()+':'+(hjf[14]+hjf[15]).valueOf() ;
        });
      }else{

        hj = new Date();
        currentdate = new Date(); 
        curr_date = (currentdate.getDate()<10?'0':'') + currentdate.getDate();
         curr_month = (currentdate.getMonth()<10?'0':'') + (currentdate.getMonth() + 1); //Months are zero based
         curr_year = currentdate.getFullYear();
         h2 = (currentdate.getHours()<10?'0':'') + currentdate.getHours();
         m2 = (currentdate.getMinutes()<10?'0':'') + currentdate.getMinutes();

        hj = $scope.evento.diainicio;

         ano = (hj[0]+hj[1]+hj[2]+hj[3]).valueOf()-curr_year;
         mes = (hj[5]+hj[6]).valueOf()-curr_month;
         dia = (hj[8]+hj[9]).valueOf()-curr_date;
         h = (hj[11]+hj[12]).valueOf()-h2;
         m = (hj[14]+hj[15]).valueOf()-m2;

        hjl = $scope.evento.dialimiteconfirmacao;
        
         anol = (hjl[0]+hjl[1]+hjl[2]+hjl[3]).valueOf()-curr_year;
         mesl = (hjl[5]+hjl[6]).valueOf()-curr_month;
         dial = (hjl[8]+hjl[9]).valueOf()-curr_date;
         hl = (hjl[11]+hjl[12]).valueOf()-h2;
         ml = (hjl[14]+hjl[15]).valueOf()-m2;
        
        
         hjf = $scope.evento.diafim;
         var hjd = $scope.evento.duracao;
        var hd = (hjd[0]+hjd[1]).valueOf();
        var md = (hjd[3]+hjd[4]).valueOf();
        $scope.duracao= hd+':'+md;

        $scope.limiteconfirmacao.dia =  (hjl[8]+hjl[9]).valueOf()+'/'+(hjl[5]+hjl[6]).valueOf();
        $scope.limiteconfirmacao.hora =  (hjl[11]+hjl[12]).valueOf()+':'+(hjl[14]+hjl[15]).valueOf();  
        
        

        $scope.fim.dia =  (hjf[8]+hjf[9]).valueOf()+'/'+(hjf[5]+hjf[6]).valueOf()+'/'+(hjf[0]+hjf[1]+hjf[2]+hjf[3]);
        $scope.fim.hora = (hjf[11]+hjf[12]).valueOf()+':'+(hjf[14]+hjf[15]).valueOf();
        $scope.dia.dia = (hj[8]+hj[9]).valueOf()+'/'+(hj[5]+hj[6]).valueOf();
         $scope.dia.hora = (hj[11]+hj[12]).valueOf()+':'+(hj[14]+hj[15]).valueOf() +' - '+(hjf[11]+hjf[12]).valueOf()+':'+(hjf[14]+hjf[15]).valueOf() ;

        $scope.diafim =  (hjf[8]+hjf[9]).valueOf()+'/'+(hjf[5]+hjf[6]).valueOf()+'/'+(hjf[0]+hjf[1]+hjf[2]+hjf[3])+' '+(hjf[11]+hjf[12]).valueOf()+':'+(hjf[14]+hjf[15]).valueOf();
        $scope.dialimiteconfirmacao =  (hjl[8]+hjl[9]).valueOf()+'/'+(hjl[5]+hjl[6]).valueOf()+'/'+(hjl[0]+hjl[1]+hjl[2]+hjl[3])+' '+(hjl[11]+hjl[12]).valueOf()+':'+(hjl[14]+hjl[15]).valueOf();
        //$scope.dia = (hj[8]+hj[9]).valueOf()+'/'+(hj[5]+hj[6]).valueOf()+'/'+(hj[0]+hj[1]+hj[2]+hj[3])+' '+(hj[11]+hj[12]).valueOf()+':'+(hj[14]+hj[15]).valueOf();

      }
       if($scope.evento.tipodeevento ){
        $scope.btncancelacompra= true;
                        console.log("patrocinadoffff")
                        $scope.evento.patrocinado = true;
                        $scope.evento.styleItemCaixa = "background-color: #212121;color: white;box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.3);border: 4px dotted #ffdb29;";
                        //$scope.evento.styleItem = "background-color: #212121;color: white;box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.3);border: 4px dotted #ff9008;";
                        $scope.evento.styleItem = "background-color: #212121;color: white;box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.3);outline: 7px dotted #ff4c42;outline-offset: -4px;";
                        //$scope.evento.styleItem = "background-color: #212121;color: white;box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.3);border: 4px dotted #f9bdff;";
                        //$scope.evento.styleItem = "background-color: #212121;color: white;box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.3);border: 4px dotted #00FFFF;";

                        document.getElementById("page18").style.backgroundImage = "url('img/background_patrocinado.jpg')"
                      }else{
                        $scope.evento.styleItem = "background-color: #212121;color: white;box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.3);"
                        $scope.evento.patrocinado = false;
                        document.getElementById("page18").style.backgroundColor = "#212121"
                      }

                       if(parseInt($scope.evento.pmin)>parseInt($scope.evento.patual)){
                        $scope.menorqpmin = true;
                        $scope.nopmin = false;
                        $scope.entre = false;
                        $scope.cheio = false;
                      }
                      if(parseInt($scope.evento.pmin)==parseInt($scope.evento.patual)){
                        $scope.menorqpmin = false;
                        $scope.nopmin = true;
                        $scope.entre = false;
                        $scope.cheio = false;
                      }

                      if(parseInt($scope.evento.pmin)<parseInt($scope.evento.patual) && parseInt($scope.evento.pmax)>parseInt($scope.evento.patual)){
                        $scope.menorqpmin = false;
                        $scope.nopmin = false;
                        $scope.entre = true;
                        $scope.cheio = false;
                        console.log("nao cheio")
                      }
                      if(parseInt($scope.evento.pmin)<parseInt($scope.evento.patual) && parseInt($scope.evento.pmax)<=parseInt($scope.evento.patual)){
                        $scope.menorqpmin = false;
                        $scope.nopmin = false;
                        $scope.entre = false;
                        $scope.cheio = true;
                       // console.log(" cheio", items[i].pmin.valueOf() , items[i]patual.valueOf(), items[i].pmax.valueOf())
                      }


      console.log('Voltei para a pagina', $scope.evento ,$scope.evento.idevento, $scope.evento.dialimiteconfirmacao )
      

      EventoService.Gettags($scope.evento.idevento).then(function(tags) {
        if(tags!='E'){
          for(var  i =0; i< tags.length;i++){
            $scope.tag = ($scope.tag + ' ' + tags[i].tag);
          } 
        } 
      });

            // YELLOW ZONE qualquer pessoa confirmada por confirmar a pessoa que nao foi confirmada
      console.log(anol, mesl, dial , hl, ml , hjl,);
         ///errradooo
      if(anol == 0 && mesl == 0 && dial == 0 && ((hl == 1 && ml<30 && ml>0)||(hl==0 && ml > 30)|| (hl==1 && ml>-30))){
        console.log('YELLOW-ZONE');
        zone = 'yellow';
        $scope.confirmaPessoa =true;
      }

            // RED ZONE 
     if(anol<0 || mesl < 0 ||(anol == 0 && mesl == 0 && (dial < 0 || (dial==0 && ((hl == 0 && ml<=0)||(hl < 0)))))){
        console.log('RED-ZONE');
        zone = 'red';
        $scope.confirmaPessoa =false;
        $scope.deletarPessoa = false;
      }
      if($scope.evento.adm ==  $scope.aux.iduser){
        $scope.deletarPessoa = true;
        $scope.confirmaPessoa =true;
        if(zone == 'red'){
          $scope.edita = false;
          $scope.deletarPessoa = false;
        }else{
          $scope.edita = true;
        }
      }

      if(parseInt($scope.evento.patual) < parseInt($scope.evento.pmin) && zone == 'red'){
              console.log('Evento não acontece por falta de pessoas')
            }
            console.log($scope.evento.patual , $scope.evento.pmin)
      if(parseInt($scope.evento.patual) < parseInt($scope.evento.pmin) && zone == 'yellow'){
        console.log('Evento esta com poucas pessoas, talvez ele nao aconteça')
      }
      EventoService.GetParticipantes($scope.evento.idevento).then(function(items) {
        //console.log(items[0].idevento);
        $scope.nomeevento = items[0].nomeevento;
        for (var i = 0; i < items.length; i++) {
          if ($scope.aux.iduser == items[i].iduser) {
            meuestado = items[i].estado;
            $scope.nuser++;
          }
          if (items[i].estado == 0) {
            items[i].confirmacao = 'Sou o organizador';
            $scope.criador = items[i].iduser;
            //console.log($scope.criador);
          }
          if (items[i].estado == 1) {
            items[i].confirmacao = 'Aguardando confirmação';
          }
          if (items[i].estado == 2) {
            items[i].confirmacao = 'Confirmação aprovada';
          }
          if(items[i].borda == 0){
            items[i].bb = false;
            items[i].bs = false;
            items[i].bg = false;
          }
          if(items[i].borda == 1){
            items[i].bb = true;
            items[i].bs = false;
            items[i].bg = false;
          }
          if(items[i].borda == 2){
            items[i].bb = false;
            items[i].bs = true;
            items[i].bg = false;
          }
          if(items[i].borda == 3){
            items[i].bb = false;
            items[i].bs = false;
            items[i].bg = true;
          }
          if((items[i].profilepic[8] == 's' && items[i].profilepic[9] == '3')||(items[i].profilepic[8] == 'd' && items[i].profilepic[9] == 'i')){
            items[i].profilepic=items[i].profilepic+"?{{getTimeStamp()}}";
           }else{
             items[i].profilepic=items[i].profilepic;
           }
        }
        $scope.items = items;
      });
    });

  $scope.share = function(t, msg, img, link){ 
    //console.log($scope.evento.diainicio)
    $scope.msgshare = "Olha o que achei: " + $scope.evento.nomeevento + ' ' +$scope.evento.diainicio[8]+$scope.evento.diainicio[9]+'/'+ +$scope.evento.diainicio[5]+$scope.evento.diainicio[6] + ' bora?';
    $scope.linkevento = "https://ec2.diwoapp.com.br/pageteste.html?idevento="+$scope.evento.idevento;
     console.log($scope.msgshare)
      if(t == 'w')
        $cordovaSocialSharing.canShareVia('whatsapp', $scope.msgshare, '', 'http://diwoapp.com.br/politica-de-privacidade/').then(function(result) {
          $cordovaSocialSharing.shareViaWhatsApp($scope.msgshare, '' , $scope.linkevento) ;
          }, function(error) {
              alert("Cannot share on whatsapp");
          });
      else if(t == 'f')
        $cordovaSocialSharing.canShareVia('facebook', $scope.msgshare, '', 'http://diwoapp.com.br/politica-de-privacidade/').then(function(result) {
              $cordovaSocialSharing.shareViaFacebook( $scope.msgshare, '', $scope.linkevento);
          }, function(error) {
              alert("Cannot share on whatsapp");
          });

      else if(t == 't')
          $cordovaSocialSharing.canShareVia('twitter', $scope.msgshare, '', 'http://diwoapp.com.br/politica-de-privacidade/').then(function(result) {
              $cordovaSocialSharing.shareViaTwitter( + $scope.msgshare, '',  $scope.linkevento);
          }, function(error) {
              alert("Cannot share on whatsapp");
          }); 
  }                  
  $scope.chamamos = function(){  
    $scope.carinha = '';
    $ionicPopup.prompt({
        title: 'Ajude um amigo',
        template: 'Ajude um amigo(a) que amaria esse evento a fazer parte dele também! Com um amigo é sempre mais seguro.Nós enviaremos um meme, poema ou áudio convidando ele(a) por você. Só precisamos do “@”, email ou telefone dela e voilá :)',
       inputType: 'text',
       inputPlaceholder: '@insta ou numero pra whats ou email'
     }).then(function(contato) {
      if(contato){
        if(contato!= ''){
          $scope.carinha = $scope.aux.iduser + " " +$scope.aux.username + " quer convidar: " + contato + " no evento id:" + $scope.evento.idevento + " nome do evento: " + $scope.evento.nomeevento;
          $http.post('https://ec2.diwoapp.com.br/pedeconvite.php', {namereportado : $scope.evento.nomeevento,
                                                                                    usernamereportando : contato,
                                                                                    tiporeport : 'Convide meu amigo',
                                                                                    motivo : $scope.carinha}).then(function (tes){
            if(tes.data.success == true){
              var alertPopup = $ionicPopup.alert({
                title: 'Pronto!',
                template: 'Convidaremos ele de uma das formas, obrigado!!'
              });
              alertPopup.then(function(){
                EventoService.ConvidarPessoaevento($scope.helppp).then(function(convite) {
                  if(convite){
                    $scope.convidar = false;
                  }
                });
              });
            }else{
              var alertPopup = $ionicPopup.alert({
                title: 'Vish',
                template: 'Ocorreu uma falha!!'
              });
            }
          });
        }
        console.log($scope.carinha)
      }
    }); 
  }
  $scope.reportar = function(){
    $scope.reportmsg = '';
    //console.log($scope.evento.admusername);
    $scope.report = [
      { text: "Conteúdo impróprio", checked: false },
      { text: "Linguajar inadequado", checked: false },
      { text: "Discurso de ódio", checked: false },
      { text: "Imagem imprópria", checked: false },
      { text: "Substancias ilicitas ", checked: false }
    ];
    $ionicPopup.confirm({
        title: 'Você quer reportar esse evento pq?',
        content: '<ion-checkbox ng-repeat="item in report" style="color: #FCFCFC;" ng-model="item.checked"  ng-checked="item.checked">{{item.text}}</ion-checkbox>',
        scope: $scope
    }).then(function(res) {
        if(res) {
          for (var h=0;h<3;h++){
            //console.log($scope.report[h].checked , h);
            if($scope.report[h].checked){
              $scope.reportmsg = $scope.reportmsg + $scope.report[h].text + ' ';
              //console.log($scope.reportmsg);
            }
          }
          if(h==3){
            console.log($scope.reportmsg);
            $http.post('https://ec2.diwoapp.com.br/reportaevento.php', {namereportado : $scope.evento.admusername,
                                                                            reportadoid : $scope.evento.idevento,
                                                                            iduserreportando : $scope.user.iduser,
                                                                            usernamereportando : $scope.user.username,
                                                                            tiporeport : 'evento',
                                                                            motivo : $scope.reportmsg}).then(function (tes){
              $scope.response = tes.data;
              var alertPopup = $ionicPopup.alert({
                                        title: 'Obrigado',
                                        template: 'Este evento esta agora sobre avaliação, obrigado por manter a plataforma organizada'
              });
            });
          }
        }
    });
  }

  $scope.editar = function(){
    formEventoEdita.updateForm($scope.evento)
    $state.go('tabsController.EditEv');
    //$state.go('tabsController.EditaEEAPart1');
  }

    $scope.confirma = function(item){
      console.log(meuestado, confirm)
      if(meuestado == 1 || meuestado == 8 || meuestado == 7 ){
                  var alertPopup = $ionicPopup.alert({
                            title: '(°ロ°)☝',
                            template: 'Ainda não foi confirmado para poder aprovar alguem'
                          });
      }else{
        if(item.estado == 1 ){
          if (item.iduser!=$scope.aux.iduser && confirm!= item.iduser) {
                  confirm = item.iduser;
                  console.log(item.iduser, $scope.aux.iduser);
                  $scope.msgnoti = ('Tu foi aceito no evento: ' + $scope.evento.nomeevento);
                  $scope.evento.patual = parseInt($scope.evento.patual)+1;
                  $http.post('https://ec2.diwoapp.com.br/addpessoaevento.php', {idevento : $scope.evento.idevento,
                                                                                  patual : $scope.evento.patual});
                  $http.post('https://ec2.diwoapp.com.br/atualizarpessoaevento.php' , {iduser : item.iduser,
                                                                                    idevento : $scope.evento.idevento,
                                                                                    confirmacao : 'Confirmação aceita',
                                                                                    estado :2});
                  noti.recebeusername = item.username;
                  noti.recebe = item.iduser;
                  noti.envia = $scope.aux.iduser;
                  noti.tipo = 2;
                  noti.nomeevento = $scope.evento.nomeevento;
                  $http.post("https://ec2.diwoapp.com.br/deletanotificacaoporids.php", {id_user_recebe : $scope.evento.adm,
                                                                                id_user_envia: item.iduser,
                                                                                nomeevento: noti.nomeevento,
                                                                                tipo : '1'});
                  EventoService.VerificaNotificacao(noti).then(function(res) {
                    console.log(res);
                    if(res){
                      $http.post('https://ec2.diwoapp.com.br/notificapessoa.php', {notificacao : $scope.msgnoti, 
                                            idevento : $scope.evento.idevento,
                                            nomeevento : $scope.evento.nomeevento,
                                            id_user_envia : $scope.aux.iduser,
                                            username_envia : $scope.aux.username,
                                            apelido_envia : $scope.aux.apelido,
                                            tipo : '2',
                                            id_user_recebe : noti.recebe});
                      EventoService.getusuario2(noti.recebeusername).then(function(user) {
                        if(user.notiparticipando== '1'){
                          $scope.pushnoti.titulo = $scope.evento.nomeevento;
                          $scope.pushnoti.msg = 'Tu foi aceito no evento: ' + $scope.evento.nomeevento;
                          $scope.pushnoti.token = user.devicetoken;
                           EventoService.MandaPushNoti($scope.pushnoti);
                        }
                      });
                    }
                  });
                   var alertPopup = $ionicPopup.alert({
                            title: '(/^▽^)/',
                            template: 'Vamos avisa-lo que ele foi aprovado, obrigado.'
                          });
                   item.confirmacao = 'Confirmação aprovada';
          }else{
            if(confirm ==  item.iduser){
              var alertPopup = $ionicPopup.alert({
                            title: '༼ つ ◕_◕ ༽つ',
                            template: 'Ja esta confirmado nesse evento!!!'
                          });
            }else{
                var alertPopup = $ionicPopup.alert({
                            title: 'ಠ_ಠ',
                            template: 'Seria muito facil tu se aceitar no evento né?'
                          });
            }
          }
        }
        if(item.estado == 2 ){
          var alertPopup = $ionicPopup.alert({
                        title: '༼ つ ◕_◕ ༽つ',
                        template: 'Ja esta confirmado nesse evento!!!'
                      });
          console.log('Ja estou confirmado')
        }
        console.log($scope.evento.diainicio)
        if(item.estado == 8 ){
          if(parseInt($scope.evento.patual)<parseInt($scope.evento.pmax) && confirm!= item.iduser){
            confirm = item.iduser;
            console.log(item.iduser, $scope.aux.iduser);
                  $scope.msgnoti = ('Tu foi aceito no evento: ' + $scope.evento.nomeevento);
                  $scope.evento.patual = parseInt($scope.evento.patual)+1;
                  $http.post('https://ec2.diwoapp.com.br/addpessoaevento.php', {idevento : $scope.evento.idevento,
                                                                                  patual : $scope.evento.patual});
                  $http.post('https://ec2.diwoapp.com.br/atualizarpessoaevento.php' , {iduser : item.iduser,
                                                                                    idevento : $scope.evento.idevento,
                                                                                    confirmacao : 'Confirmação aceita',
                                                                                      estado :2});
                  noti.recebeusername = item.username;
                  noti.recebe = item.iduser;
                  noti.envia = $scope.aux.iduser;
                  noti.tipo = 2;
                  noti.nomeevento = $scope.evento.nomeevento;
                  EventoService.VerificaNotificacao(noti).then(function(res) {
                    console.log(res);
                    if(res){
                      $http.post('https://ec2.diwoapp.com.br/notificapessoa.php', {notificacao : $scope.msgnoti, 
                                                                                      idevento : $scope.evento.idevento,
                                                                                      nomeevento : $scope.evento.nomeevento,
                                                                                      id_user_envia : $scope.aux.iduser,
                                                                                      username_envia : $scope.aux.username,
                                                                                      apelido_envia : $scope.aux.apelido,
                                                                                      tipo : '2',
                                                                                      id_user_recebe : noti.recebe});
                    EventoService.getusuario2(noti.recebeusername).then(function(user) {
                      if(user.notiparticipando== '1'){
                            $scope.pushnoti.titulo = $scope.evento.nomeevento;
                            $scope.pushnoti.msg = 'Tu foi aceito no evento: ' + $scope.evento.nomeevento;
                            $scope.pushnoti.token = user.devicetoken;
                             EventoService.MandaPushNoti($scope.pushnoti);
                           }
                          });
                    }
                  });
                  var alertPopup = $ionicPopup.alert({
                      title: '(°◡°♡).:｡',
                      template: 'Vamos confirmar a presença dele!!'
                    });
                  item.confirmacao = 'Confirmação aprovada';
           
          console.log('Ja estou confirmado')
          }else{
              var confirmPopup = $ionicPopup.show({
                   title: '(◕⌓◕;)',
                   template: 'Evento esta cheio, deseja confirmar essa pessoa mesmo assim?',
                   buttons: [
                      { text: 'Não',
                        type: 'button-assertive'},
                      {
                        text: 'Sim',
                        type: 'button-positive',
                        onTap: function(e){
                          confirm = item.iduser;
                          console.log(item.iduser, $scope.aux.iduser);
                          $scope.msgnoti = ('Tu foi aceito no evento: ' + $scope.evento.nomeevento);
                          $scope.evento.patual = parseInt($scope.evento.patual)+1;
                          $http.post('https://ec2.diwoapp.com.br/addpessoaevento.php', {idevento : $scope.evento.idevento,
                                                                                          patual : $scope.evento.patual});
                          $http.post('https://ec2.diwoapp.com.br/atualizarpessoaevento.php' , {iduser : item.iduser,
                                                                                            idevento : $scope.evento.idevento,
                                                                                            confirmacao : 'Confirmação aceita',
                                                                                            estado :2});
                          noti.recebeusername = item.username;
                          noti.recebe = item.iduser;
                          noti.envia = $scope.aux.iduser;
                          noti.tipo = 2;
                          noti.nomeevento = $scope.evento.nomeevento;
                          EventoService.VerificaNotificacao(noti).then(function(res) {
                            console.log(res);
                            if(res){
                              $http.post('https://ec2.diwoapp.com.br/notificapessoa.php', {notificacao : $scope.msgnoti, 
                                                    idevento : $scope.evento.idevento,
                                                    nomeevento : $scope.evento.nomeevento,
                                                    id_user_envia : $scope.aux.iduser,
                                                    username_envia : $scope.aux.username,
                                                    apelido_envia : $scope.aux.apelido,
                                                    tipo : '2',
                                                    id_user_recebe : noti.recebe});
                              EventoService.getusuario2(noti.recebeusername).then(function(user) {
                                if(user.notiparticipando== '1'){
                                $scope.pushnoti.titulo = $scope.evento.nomeevento;
                                $scope.pushnoti.msg = 'Tu foi aceito no evento: ' + $scope.evento.nomeevento;
                                $scope.pushnoti.token = user.devicetoken;
                                 EventoService.MandaPushNoti($scope.pushnoti);
                               }
                              });
                            }
                          });
                            var alertPopup = $ionicPopup.alert({
                                title: '(°◡°♡).:｡',
                                template: 'Vamos confirmar a presença dele!!'
                              });
                           item.confirmacao = 'Confirmação aprovada';
                              }
                             }
                           ]
                   })
          console.log('Esta cheio o evento')
          }
        }
        if (item.estado == 0) {
                  var alertPopup = $ionicPopup.alert({
                            title: 'ლ(́◉◞౪◟◉‵ლ)',
                            template: 'Ja sou o organizador, não preciso me confirmar'
                          });
        }
      }
     }
    $scope.onItemDelete = function(item) {
      if (item.iduser == $scope.aux.iduser) {
        var alertPopup = $ionicPopup.alert({
                        title: 'Oi?',
                        template: 'Tu és o organizador, não podes se deletar do seu evento, podes cancelar ele'
        });
      }else{
        var confirmPopup = $ionicPopup.show({
                     title: 'ATENÇÃO!!!',
                     template: 'Você esta preste excluir pessoa do evento, ela não poderá mais entrar neste evento, tens certeza disso?',
                     buttons: [
                        { text: 'Não',
                          type: 'button-assertive'},
                        {
                          text: 'Sim',
                          type: 'button-positive',
                          onTap: function(e){
                          noti.recebeusername = item.username;
                          noti.recebe = item.iduser;
                          noti.envia = $scope.aux.iduser;
                          noti.tipo = 9;
                          noti.nomeevento = $scope.evento.nomeevento;
                          EventoService.VerificaNotificacao(noti).then(function(res) {
                            console.log(res);
                            if(res){
                              $http.post('https://ec2.diwoapp.com.br/notificapessoa.php', {notificacao : 'Tu foi retirado do evento', 
                                                                                              idevento : $scope.evento.idevento,
                                                                                              nomeevento : $scope.evento.nomeevento,
                                                                                              id_user_envia : $scope.aux.iduser,
                                                                                              username_envia : $scope.aux.username,
                                                                                              apelido_envia : $scope.aux.apelido,
                                                                                              tipo : '9', //pessoa kickada
                                                                                              id_user_recebe : noti.recebe});
                              EventoService.getusuario2(noti.recebeusername).then(function(user) {
                                if(user.notiparticipando== '1'){
                                $scope.pushnoti.titulo = $scope.evento.nomeevento;
                                $scope.pushnoti.msg = 'Tu foi retirado do evento: ' + $scope.evento.nomeevento;
                                $scope.pushnoti.token = user.devicetoken;
                                 EventoService.MandaPushNoti($scope.pushnoti);
                               }
                              });
                            }
                          });
                            $http.post('https://ec2.diwoapp.com.br/deletapessoaevento.php', {iduser :item.iduser,
                                                                                                idevento : $scope.evento.idevento});
                            $http.post('https://ec2.diwoapp.com.br/deletachat.php', {iduser : item.iduser,
                                                                                        idevento : $scope.aux.idevento}); 
                            if(item.estado == 2){
                             $scope.evento.patual = parseInt($scope.evento.patual)-1;
                            }
                            $http.post('https://ec2.diwoapp.com.br/addpessoaevento.php', {idevento : $scope.evento.idevento,
                                                                                            patual : $scope.evento.patual});     
                            $http.post('https://ec2.diwoapp.com.br/pessoanaoevento.php', {iduser : item.iduser, 
                                                                                            idevento : $scope.evento.idevento,
                                                                                            nomeevento : $scope.evento.nomeevento,
                                                                                            estado : '1'});//foi kickado
                                                                                               

                            $scope.items.splice($scope.items.indexOf(item), 1);      
                                }
                               }
                             ]
                     })


        
      }
    };  

    $scope.nuser = 0;
    $scope.enterItem =  function(item){
      console.log('dasdasdasdada',item)
      formOutro.updateForm(item);
      $state.go('tabsController.perfil_outro_eventoabertos');
    }
    

    $scope.Vermapa = function(){
      $state.go('tabsController.ver_onde_mapa_Eventoabertos');
    }

    $scope.deletar =  function(){
      if ($scope.criador == $scope.aux.iduser) {
                      if(zone == 'red' || zone == 'yellow'){
                          if(zone == 'red' ){
                             var myPopup = $ionicPopup.show({
                                template: '<input type="text" placeholder="Escreva aqui pq nao vai rolar" ng-model="data.desculpa">',
                                title: 'ATENÇÃO!!!',
                                subTitle: 'Você esta preste a cancelar seu evento faltando muito pouco para seu começo, tens certeza disso?. Se tu realmente cancelar estaremos te dando um cartão vermelho. Para saber mais sobre eles va no seu indice de confirmação',
                                scope: $scope,
                                buttons: [
                                  { text: 'Não' },
                                  {
                                    text: '<b>Sim</b>',
                                    type: 'button-positive',
                                    onTap: function(e) {
                                      // console.log($scope.items.length);
                                       var notifica = ("Desisti de fazer o evento, " + $scope.data.desculpa);
                                      // console.log(notifica);
                                      // console.log($scope.aux.iduser);
                                    
                                      formtelaCriar.updateForm(1);
                                      $http.post('https://ec2.diwoapp.com.br/deletanotificacaoporevento.php' , {idevento : $scope.evento.idevento,
                                                                                                    nomeevento : $scope.evento.nomeevento});
                                      EventoService.GetParticipantes($scope.evento.idevento).then(function(ppl) {
                                   for (var i = 0; i < ppl.length; i++) {
                                    if ($scope.aux.iduser != ppl[i].iduser) {
                                      noti.recebeusername = ppl[i].username;
                                       noti.recebe = ppl[i].iduser;
                                          noti.envia = $scope.aux.iduser;
                                          noti.tipo = 4;
                                          noti.nomeevento = $scope.evento.nomeevento;
                                          EventoService.VerificaNotificacao(noti).then(function(res) {
                                            console.log(res);
                                            if(res){
                                              $http.post('https://ec2.diwoapp.com.br/notificapessoa.php', {notificacao : notifica, 
                                                    idevento : $scope.evento.idevento,
                                                    nomeevento : $scope.evento.nomeevento,
                                                    id_user_envia : $scope.aux.iduser,
                                                    username_envia : $scope.aux.username,
                                                    apelido_envia : $scope.aux.apelido,
                                                    tipo : '5',   
                                                    id_user_recebe : noti.recebe}).then(function (res){
                                                   $scope.response = res.data;
                                                   console.log($scope.response.msg)
                                                 });
                                              EventoService.getusuario2(noti.recebeusername).then(function(user) {
                                                if(user.notiparticipando== '1'){
                                                $scope.pushnoti.titulo =  $scope.evento.nomeevento +'Cancelado' ;
                                                $scope.pushnoti.msg = ("Desisti de fazer o evento, " + $scope.data.desculpa);
                                                $scope.pushnoti.token = user.devicetoken;
                                                 EventoService.MandaPushNoti($scope.pushnoti);
                                               }
                                              });
                                            }
                                          });
                                        }
                                  }
                                 })
                                      for(var i = 0; i< $scope.items.length; i++){
        
                                        
                                        $http.post('https://ec2.diwoapp.com.br/deletapessoaevento.php', {iduser : $scope.items[i].iduser,
                                                                                                           idevento : $scope.evento.idevento});
                                      }

                                         $http.post('https://ec2.diwoapp.com.br/penalidade.php', {iduser : $scope.aux.iduser,
                                                                                                     idevento : $scope.evento.idevento,
                                                                                                     username : $scope.aux.username,
                                                                                                     tipopenalidade : '2'});     // tipo2 saiu na redzone         
                                       $scope.evento.estado = "3";
                                       $scope.evento.datamodificacao = new Date();                 
                                     EventoService.atualizarevento($scope.evento);
                                                          $state.go('tabsController.eventosAbertos');
                                                          }
                                  }]
                                 });

                                      console.log('criador do evento cancelando proprio evento');
                      }else{
                             var myPopup = $ionicPopup.show({
                                template: '<input type="text" placeholder="Escreva aqui pq nao vai rolar" ng-model="data.desculpa">',
                                title: 'ATENÇÃO!!!',
                                subTitle: 'Você esta preste a cancelar seu evento faltando pouco para seu começo, tens certeza disso?. Se tu realmente cancelar estaremos te dando um cartão amarelo. Para saber mais sobre eles va no seu indice de confirmação',
                                scope: $scope,
                                buttons: [
                                  { text: 'Não' },
                                  {
                                    text: '<b>Sim</b>',
                                    type: 'button-positive',
                                    onTap: function(e) {
                                      // console.log($scope.items.length);
                                       var notifica = ("Desisti de fazer o evento, " + $scope.data.desculpa);
                                      // console.log(notifica);
                                      // console.log($scope.aux.iduser);
                                    
                                      formtelaCriar.updateForm(1);
                                      $http.post('https://ec2.diwoapp.com.br/deletanotificacaoporevento.php' , {idevento : $scope.evento.idevento,
                                                                                                    nomeevento : $scope.evento.nomeevento}).then(function(response) {console.log(response, 'deleta')});
                                      EventoService.GetParticipantes($scope.evento.idevento).then(function(ppl) {
                                   for (var i = 0; i < ppl.length; i++) {
                                    if ($scope.aux.iduser != ppl[i].iduser) {
                                      noti.recebeusername = ppl[i].username;
                                       noti.recebe = ppl[i].iduser;
                                          noti.envia = $scope.aux.iduser;
                                          noti.tipo = 4;
                                          noti.nomeevento = $scope.evento.nomeevento;
                                          EventoService.VerificaNotificacao(noti).then(function(res) {
                                            console.log(res);
                                            if(res){
                                              $http.post('https://ec2.diwoapp.com.br/notificapessoa.php', {notificacao : notifica, 
                                                      idevento : $scope.evento.idevento,
                                                      nomeevento : $scope.evento.nomeevento,
                                                      id_user_envia : $scope.aux.iduser,
                                                      username_envia : $scope.aux.username,
                                                      apelido_envia : $scope.aux.apelido,
                                                      tipo : '5',   
                                                      id_user_recebe : noti.recebe}).then(function (res){
                                                     $scope.response = res.data;
                                                     console.log($scope.response.msg)
                                              });
                                              EventoService.getusuario2(noti.recebeusername).then(function(user) {
                                                if(user.notiparticipando== '1'){
                                                $scope.pushnoti.titulo =  $scope.evento.nomeevento +'Cancelado' ;
                                                $scope.pushnoti.msg = ("Desisti de fazer o evento, " + $scope.data.desculpa);
                                                $scope.pushnoti.token = user.devicetoken;
                                                 EventoService.MandaPushNoti($scope.pushnoti);
                                               }
                                              });
                                            }
                                          });
                                        }
                                  }
                                 })
                                      for(var i = 0; i< $scope.items.length; i++){

                                        $http.post('https://ec2.diwoapp.com.br/deletapessoaevento.php', {iduser : $scope.items[i].iduser,
                                                                                                           idevento : $scope.evento.idevento});
                                      }
                                       $http.post('https://ec2.diwoapp.com.br/penalidade.php', {iduser : $scope.aux.iduser,
                                                                                                     idevento : $scope.evento.idevento,
                                                                                                     username : $scope.aux.username,
                                                                                                     tipopenalidade : '1'});   // tipo 1 saiu na yellow zone               
                                       $scope.evento.estado = "3";
                                       $scope.evento.datamodificacao = new Date();                
                                     EventoService.atualizarevento($scope.evento);
                                                          $state.go('tabsController.eventosAbertos');
                                                          }
                                  }]
                                 });

                                      console.log('criador do evento cancelando proprio evento');
                      }
        }else{
           var myPopup = $ionicPopup.show({
                  template: '<input type="text" placeholder="Escreva aqui pq nao vai rolar" ng-model="data.desculpa">',
                  title: 'ATENÇÃO!!!',
                  subTitle: 'Você esta preste a deletar seu evento, tens certeza disso?',
                  scope: $scope,
                  buttons: [
                    { text: 'Não' },
                    {
                      text: '<b>Sim</b>',
                      type: 'button-positive',
                      onTap: function(e) {
                        // console.log($scope.items.length);
                         var notifica = ("Desisti de fazer o evento, " + $scope.data.desculpa);
                        // console.log(notifica);
                        // console.log($scope.aux.iduser);
                      
                        formtelaCriar.updateForm(1);
                        $http.post('https://ec2.diwoapp.com.br/deletanotificacaoporevento.php' , {idevento : $scope.evento.idevento,
                                                                                                    nomeevento : $scope.evento.nomeevento}).then(function(response) {console.log(response, 'deleta')});
                        EventoService.GetParticipantes($scope.evento.idevento).then(function(ppl) {
                                   for (var i = 0; i < ppl.length; i++) {
                                    if ($scope.aux.iduser != ppl[i].iduser) {
                                      noti.recebeusername = ppl[i].username;
                                       noti.recebe = ppl[i].iduser;
                                          noti.envia = $scope.aux.iduser;
                                          noti.tipo = 4;
                                          noti.nomeevento = $scope.evento.nomeevento;
                                          EventoService.VerificaNotificacao(noti).then(function(res) {
                                            console.log(res);
                                            if(res){
                                              $http.post('https://ec2.diwoapp.com.br/notificapessoa.php', {notificacao : notifica, 
                                                    idevento : $scope.evento.idevento,
                                                    nomeevento : $scope.evento.nomeevento,
                                                    id_user_envia : $scope.aux.iduser,
                                                    username_envia : $scope.aux.username,
                                                    apelido_envia : $scope.aux.apelido,
                                                    tipo : '5',   
                                                    id_user_recebe : noti.recebe}).then(function (res){
                                                   $scope.response = res.data;
                                                   console.log($scope.response.msg)
                                              });
                                              EventoService.getusuario2(noti.recebeusername).then(function(user) {
                                                if(user.notiparticipando== '1'){
                                                $scope.pushnoti.titulo =  $scope.evento.nomeevento +'Cancelado' ;
                                                $scope.pushnoti.msg = ("Desisti de fazer o evento, " + $scope.data.desculpa);
                                                $scope.pushnoti.token = user.devicetoken;
                                                 EventoService.MandaPushNoti($scope.pushnoti);
                                               }
                                              });
                                            }
                                          });
                                        }
                                  }
                                 })

                        for(var i = 0; i< $scope.items.length; i++){
                          
                          $http.post('https://ec2.diwoapp.com.br/deletapessoaevento.php', {iduser : $scope.items[i].iduser,
                                                                                             idevento : $scope.evento.idevento});
                        }
                                        
                        $scope.evento.estado = "3";
                        $scope.evento.datamodificacao = new Date();                
                        EventoService.atualizarevento($scope.evento);
                        $state.go('tabsController.eventosAbertos');
                      }
                    }]
                   });

                        console.log('criador do evento cancelando proprio evento');
        }
              
      }else{
        if (meuestado!=1) {
          if(zone == 'red' || zone == 'yellow'){
                          if(zone == 'red' ){
                               var confirmPopup = $ionicPopup.show({
                                         title: 'ATENÇÃO!!!',
                                         template: 'Você esta preste a desistir de um evento faltando muito pouco tempo para seu começo, tens certeza disso? Se tu realmente cancelar estaremos te dando um cartão vermelho. Para saber mais sobre eles va no seu indice de confirmação ',
                                         buttons: [
                                            { text: 'Não',
                                              type: 'button-assertive'},
                                            {
                                              text: 'Sim',
                                              type: 'button-positive',
                                              onTap: function(e){
                                                noti.recebeusername = $scope.evento.admusername;
                                                 noti.recebe =  $scope.criador;
                                          noti.envia = $scope.aux.iduser;
                                          noti.tipo = 5;
                                          noti.nomeevento = $scope.evento.nomeevento;
                                          EventoService.VerificaNotificacao(noti).then(function(res) {
                                            console.log(res);
                                            if(res){
                                                  $http.post('https://ec2.diwoapp.com.br/notificapessoa.php', {notificacao : 'Desisti de ir no seu evento, perdão.', 
                                                        idevento : $scope.evento.idevento,
                                                        nomeevento : $scope.evento.nomeevento,
                                                        id_user_envia : $scope.aux.iduser,
                                                        username_envia : $scope.aux.username,
                                                        apelido_envia : $scope.aux.apelido,
                                                        tipo : '5', //pessoa desistiu
                                                        id_user_recebe : $scope.criador});
                                              EventoService.getusuario2(noti.recebeusername).then(function(user) {
                                                if(user.noticriados== '1'){
                                                $scope.pushnoti.titulo =  $scope.aux.username +' desistiu' ;
                                                $scope.pushnoti.msg = $scope.aux.username + " não vai mais no evento " + $scope.evento.nomeevento;
                                                $scope.pushnoti.token = user.devicetoken;
                                                 EventoService.MandaPushNoti($scope.pushnoti);
                                               }
                                              });
                                            }
                                          });
                                          $http.post("https://ec2.diwoapp.com.br/deletanotificacaoporids.php", {id_user_recebe : noti.recebe,
                                                                              id_user_envia: noti.envia,
                                                                              nomeevento: noti.nomeevento,
                                                                              tipo : '1'});
                                          $http.post('https://ec2.diwoapp.com.br/penalidade.php', {iduser : $scope.aux.iduser,
                                                                                         idevento : $scope.evento.idevento,
                                                                                         username : $scope.aux.username,
                                                                                         tipopenalidade : '2'});     // tipo2 saiu na redzone  
                                          if(meuestado == 2){
                                             $scope.evento.patual = parseInt($scope.evento.patual)-1;
                                          }
                                          if(parseInt($scope.evento.patual)<parseInt($scope.evento.pmin)){
                                            $http.post('https://ec2.diwoapp.com.br/mudaestadoevento.php', {idevento : $scope.evento.idevento,
                                                                                                          estado : '2'});
                                            $http.post('https://ec2.diwoapp.com.br/notificapessoa.php', {notificacao : 'ATENÇÃO!! Numero de pessoas agora nao bate o mínimo.', 
                                                        idevento : $scope.evento.idevento,
                                                        nomeevento : $scope.evento.nomeevento,
                                                        id_user_envia : $scope.aux.iduser,
                                                        username_envia : $scope.aux.username,
                                                        apelido_envia : $scope.aux.apelido,
                                                        tipo : '12', //pessoa desistiu
                                                        id_user_recebe : $scope.criador});
                                          }
                                          
                                          $http.post('https://ec2.diwoapp.com.br/addpessoaevento.php', {idevento : $scope.evento.idevento,
                                                                                                          patual : $scope.evento.patual});    
                                          $http.post('https://ec2.diwoapp.com.br/deletapessoaevento.php', {iduser : $scope.aux.iduser,
                                                                                                            idevento : $scope.evento.idevento});
                                          $state.go('tabsController.eventosAbertos');
                                                    }
                                                   }
                                                 ]
                                         })
                             }else{
                                 var confirmPopup = $ionicPopup.show({
                                         title: 'ATENÇÃO!!!',
                                         template: 'Você esta preste a desistir de um evento faltando pouco tempo para seu começo, tens certeza disso? Se tu realmente cancelar estaremos te dando um cartão amarelo. Para saber mais sobre eles va no seu indice de confirmação',
                                         buttons: [
                                            { text: 'Não',
                                              type: 'button-assertive'},
                                            {
                                              text: 'Sim',
                                              type: 'button-positive',
                                              onTap: function(e){
                                                noti.recebeusername = $scope.evento.admusername;
                                                noti.recebe =  $scope.criador;
                                          noti.envia = $scope.aux.iduser;
                                          noti.tipo = 5;
                                          noti.nomeevento = $scope.evento.nomeevento;
                                          EventoService.VerificaNotificacao(noti).then(function(res) {
                                          console.log(res);
                                            if(res){
                                                $http.post('https://ec2.diwoapp.com.br/notificapessoa.php', {notificacao : 'Desisti de ir no seu evento, perdão', 
                                                      idevento : $scope.evento.idevento,
                                                      nomeevento : $scope.evento.nomeevento,
                                                      id_user_envia : $scope.aux.iduser,
                                                      username_envia : $scope.aux.username,

                                                      tipo : '5', //pessoa desistiu
                                                      id_user_recebe : $scope.criador});
                                              EventoService.getusuario2(noti.recebeusername).then(function(user) {
                                                if(user.noticriados== '1'){
                                                $scope.pushnoti.titulo =  $scope.aux.username +' desistiu' ;
                                                $scope.pushnoti.msg = $scope.aux.username + " não vai mais no evento " + $scope.evento.nomeevento;
                                                $scope.pushnoti.token = user.devicetoken;
                                                 EventoService.MandaPushNoti($scope.pushnoti);
                                               }
                                              });
                                            }
                                          });
                                          $http.post("https://ec2.diwoapp.com.br/deletanotificacaoporids.php", {id_user_recebe : noti.recebe,
                                                                              id_user_envia: noti.envia,
                                                                              nomeevento: noti.nomeevento,
                                                                              tipo : '1'});
                                                       $http.post('https://ec2.diwoapp.com.br/penalidade.php', {iduser : $scope.aux.iduser,
                                                                                                     idevento : $scope.evento.idevento,
                                                                                                     username : $scope.aux.username,
                                                                                                     tipopenalidade : '1'});   // tipo 1 saiu na yellow zone   
                                                      
                                                         if(meuestado == 2){
                                                         $scope.evento.patual = parseInt($scope.evento.patual)-1;
                                                        }
                                                        $http.post('https://ec2.diwoapp.com.br/addpessoaevento.php', {idevento : $scope.evento.idevento,
                                                                                          patual : $scope.evento.patual});    
                                                    $http.post('https://ec2.diwoapp.com.br/deletapessoaevento.php', {iduser : $scope.aux.iduser,
                                                                                                                        idevento : $scope.evento.idevento});
                                                      $state.go('tabsController.eventosAbertos');
                                                    }
                                                   }
                                                 ]
                                         })

                             }
                           }else{
                             var confirmPopup = $ionicPopup.show({
                                         title: 'ATENÇÃO!!!',
                                         template: 'Você esta preste a desistir de um evento, tens certeza disso?',
                                         buttons: [
                                            { text: 'Não',
                                              type: 'button-assertive'},
                                            {
                                              text: 'Sim',
                                              type: 'button-positive',
                                              onTap: function(e){
                                                noti.recebeusername = $scope.evento.admusername;
                                                noti.recebe =  $scope.criador;
                                          noti.envia = $scope.aux.iduser;
                                          noti.tipo = 5;
                                          noti.nomeevento = $scope.evento.nomeevento;
                                          EventoService.VerificaNotificacao(noti).then(function(res) {
                                          console.log(res);
                                            if(res){
                                                $http.post('https://ec2.diwoapp.com.br/notificapessoa.php', {notificacao : 'Desisti de ir no seu evento, perdão', 
                                                      idevento : $scope.evento.idevento,
                                                      nomeevento : $scope.evento.nomeevento,
                                                      id_user_envia : $scope.aux.iduser,
                                                      username_envia : $scope.aux.username,
                                                      apelido_envia : $scope.aux.apelido,
                                                      tipo : '5', //pessoa desistiu
                                                      id_user_recebe : $scope.criador}).then(function (res){
                                                     $scope.response = res.data;
                                                     //console.log($scope.response.msg)
                                                   });
                                              EventoService.getusuario2(noti.recebeusername).then(function(user) {
                                                if(user.noticriados== '1'){
                                                $scope.pushnoti.titulo =  $scope.aux.username +' desistiu' ;
                                                $scope.pushnoti.msg = $scope.aux.username + " não vai mais no evento " + $scope.evento.nomeevento;
                                                $scope.pushnoti.token = user.devicetoken;
                                                 EventoService.MandaPushNoti($scope.pushnoti);
                                               }
                                              });
                                            }
                                          });
                                          $http.post("https://ec2.diwoapp.com.br/deletanotificacaoporids.php", {id_user_recebe : noti.recebe,
                                                                              id_user_envia: noti.envia,
                                                                              nomeevento: noti.nomeevento,
                                                                              tipo : '1'});
                                                       if(meuestado == 2){
                                                         $scope.evento.patual = parseInt($scope.evento.patual)-1;
                                                        }
                                                    $http.post('https://ec2.diwoapp.com.br/addpessoaevento.php', {idevento : $scope.evento.idevento,
                                                                                                                    patual : $scope.evento.patual});    
                                                    $http.post('https://ec2.diwoapp.com.br/deletapessoaevento.php', {iduser : $scope.aux.iduser,
                                                                                                                        idevento : $scope.evento.idevento});
                                                      $state.go('tabsController.eventosAbertos');
                                                    }
                                                   }
                                                 ]
                                         })
                           }
              }else{
                             var confirmPopup = $ionicPopup.show({
                                         title: 'ATENÇÃO!!!',
                                         template: 'Você esta preste a desistir de um evento, tens certeza disso?',
                                         buttons: [
                                            { text: 'Não',
                                              type: 'button-assertive'},
                                            {
                                              text: 'Sim',
                                              type: 'button-positive',
                                              onTap: function(e){
                                                noti.recebeusername = $scope.evento.admusername;
                                                noti.recebe =  $scope.criador;
                                          noti.envia = $scope.aux.iduser;
                                          noti.tipo = 5;
                                          noti.nomeevento = $scope.evento.nomeevento;
                                          EventoService.VerificaNotificacao(noti).then(function(res) {
                                          console.log(res);
                                            if(res){
                                                $http.post('https://ec2.diwoapp.com.br/notificapessoa.php', {notificacao : 'Desisti de ir no seu evento, perdão', 
                                                      idevento : $scope.evento.idevento,
                                                      nomeevento : $scope.evento.nomeevento,
                                                      id_user_envia : $scope.aux.iduser,
                                                      username_envia : $scope.aux.username,
                                                      apelido_envia : $scope.aux.apelido,
                                                      tipo : '5', //pessoa desistiu
                                                      id_user_recebe : $scope.criador}).then(function (res){
                                                     $scope.response = res.data;
                                                     //console.log($scope.response.msg)
                                                   });
                                              EventoService.getusuario2(noti.recebeusername).then(function(user) {
                                                if(user.noticriados== '1'){
                                                $scope.pushnoti.titulo =  $scope.aux.username +' desistiu' ;
                                                $scope.pushnoti.msg = $scope.aux.username + " não vai mais no evento " + $scope.evento.nomeevento;
                                                $scope.pushnoti.token = user.devicetoken;
                                                 EventoService.MandaPushNoti($scope.pushnoti);
                                               }
                                              });
                                            }
                                          });
                                          $http.post("https://ec2.diwoapp.com.br/deletanotificacaoporids.php", {id_user_recebe : noti.recebe,
                                                                              id_user_envia: noti.envia,
                                                                              nomeevento: noti.nomeevento,
                                                                              tipo : '1'});
                                                      if(meuestado == 2){
                                                         $scope.evento.patual = parseInt($scope.evento.patual)-1;
                                                        }
                                                    $http.post('https://ec2.diwoapp.com.br/addpessoaevento.php', {idevento : $scope.evento.idevento,
                                                                                                                    patual : $scope.evento.patual});    
                                                    $http.post('https://ec2.diwoapp.com.br/deletapessoaevento.php', {iduser : $scope.aux.iduser,
                                                                                                                        idevento : $scope.evento.idevento});
                                                      $state.go('tabsController.eventosAbertos');
                                                    }
                                                   }
                                                 ]
                                         })
                            }





            }
       
    }

    $scope.cancelarcompra = function(){
      $scope.dados = {};
      $scope.dados.iduser = $scope.aux.iduser;
      $scope.dados.idevento = $scope.evento.idevento;
      EventoService.GetPagamento($scope.dados).then(function(items) {
        console.log(items[0].code)
        // if(items[0].status == '3' || items[0].status == '4' || items[0].status == '5'){
        //   $http.post('https://ec2.diwoapp.com.br/PagSeguroRefund.php', {code : items[0].code});
        // }else{
        //   $http.post('https://ec2.diwoapp.com.br/PagSeguroCancel.php', {code : items[0].code});
        // }
        if (meuestado!=1) {
          if(zone == 'red' || zone == 'yellow'){
                          if(zone == 'red' ){
                               var confirmPopup = $ionicPopup.show({
                                         title: 'ATENÇÃO!!!',
                                         template: 'Você esta preste a desistir de um evento faltando muito pouco tempo para seu começo, tens certeza disso? Se tu realmente cancelar estaremos te dando um cartão vermelho. Para saber mais sobre eles va no seu indice de confirmação ',
                                         buttons: [
                                            { text: 'Não',
                                              type: 'button-assertive'},
                                            {
                                              text: 'Sim',
                                              type: 'button-positive',
                                              onTap: function(e){
                                                noti.recebeusername = $scope.evento.admusername;
                                                 noti.recebe =  $scope.criador;
                                          noti.envia = $scope.aux.iduser;
                                          noti.tipo = 5;
                                          noti.nomeevento = $scope.evento.nomeevento;
                                          if(items[0].status == '3' || items[0].status == '4' || items[0].status == '5'){
                                            $http.post('https://ec2.diwoapp.com.br/PagSeguroRefund.php', {code : items[0].code});
                                          }else{
                                            $http.post('https://ec2.diwoapp.com.br/PagSeguroCancel.php', {code : items[0].code});
                                          }
                                          EventoService.VerificaNotificacao(noti).then(function(res) {
                                            console.log(res);
                                            if(res){
                                                  $http.post('https://ec2.diwoapp.com.br/notificapessoa.php', {notificacao : 'Desisti de ir no seu evento, perdão.', 
                                                        idevento : $scope.evento.idevento,
                                                        nomeevento : $scope.evento.nomeevento,
                                                        id_user_envia : $scope.aux.iduser,
                                                        username_envia : $scope.aux.username,
                                                        apelido_envia : $scope.aux.apelido,
                                                        tipo : '5', //pessoa desistiu
                                                        id_user_recebe : $scope.criador});
                                              EventoService.getusuario2(noti.recebeusername).then(function(user) {
                                                if(user.noticriados== '1'){
                                                $scope.pushnoti.titulo =  $scope.aux.username +' desistiu' ;
                                                $scope.pushnoti.msg = $scope.aux.username + " não vai mais no evento " + $scope.evento.nomeevento;
                                                $scope.pushnoti.token = user.devicetoken;
                                                 EventoService.MandaPushNoti($scope.pushnoti);
                                               }
                                              });
                                            }
                                          });
                                          $http.post("https://ec2.diwoapp.com.br/deletanotificacaoporids.php", {id_user_recebe : noti.recebe,
                                                                              id_user_envia: noti.envia,
                                                                              nomeevento: noti.nomeevento,
                                                                              tipo : '1'});
                                          $http.post('https://ec2.diwoapp.com.br/penalidade.php', {iduser : $scope.aux.iduser,
                                                                                         idevento : $scope.evento.idevento,
                                                                                         username : $scope.aux.username,
                                                                                         tipopenalidade : '2'});     // tipo2 saiu na redzone  
                                          if(meuestado == 2){
                                             $scope.evento.patual = parseInt($scope.evento.patual)-1;
                                          }
                                          if(parseInt($scope.evento.patual)<parseInt($scope.evento.pmin)){
                                            $http.post('https://ec2.diwoapp.com.br/mudaestadoevento.php', {idevento : $scope.evento.idevento,
                                                                                                          estado : '2'});
                                            $http.post('https://ec2.diwoapp.com.br/notificapessoa.php', {notificacao : 'ATENÇÃO!! Numero de pessoas agora nao bate o mínimo.', 
                                                        idevento : $scope.evento.idevento,
                                                        nomeevento : $scope.evento.nomeevento,
                                                        id_user_envia : $scope.aux.iduser,
                                                        username_envia : $scope.aux.username,
                                                        apelido_envia : $scope.aux.apelido,
                                                        tipo : '12', //pessoa desistiu
                                                        id_user_recebe : $scope.criador});
                                          }
                                          
                                          $http.post('https://ec2.diwoapp.com.br/addpessoaevento.php', {idevento : $scope.evento.idevento,
                                                                                                          patual : $scope.evento.patual});    
                                          $http.post('https://ec2.diwoapp.com.br/deletapessoaevento.php', {iduser : $scope.aux.iduser,
                                                                                                            idevento : $scope.evento.idevento});
                                          // if(items[0].status == '3' || items[0].status == '4' || items[0].status == '5'){
                                          //   $http.post('https://ec2.diwoapp.com.br/PagSeguroRefund.php', {code : items[0].code});
                                          //   $state.go('tabsController.eventosAbertos');
                                          // }else{
                                          //   $http.post('https://ec2.diwoapp.com.br/PagSeguroCancel.php', {code : items[0].code});
                                            
                                          // }
                                          $state.go('tabsController.eventosAbertos');
                                                    }
                                                   }
                                                 ]
                                         })
                             }else{
                                 var confirmPopup = $ionicPopup.show({
                                         title: 'ATENÇÃO!!!',
                                         template: 'Você esta preste a desistir de um evento faltando pouco tempo para seu começo, tens certeza disso? Se tu realmente cancelar estaremos te dando um cartão amarelo. Para saber mais sobre eles va no seu indice de confirmação',
                                         buttons: [
                                            { text: 'Não',
                                              type: 'button-assertive'},
                                            {
                                              text: 'Sim',
                                              type: 'button-positive',
                                              onTap: function(e){
                                                noti.recebeusername = $scope.evento.admusername;
                                                noti.recebe =  $scope.criador;
                                          noti.envia = $scope.aux.iduser;
                                          noti.tipo = 5;
                                          noti.nomeevento = $scope.evento.nomeevento;
                                          if(items[0].status == '3' || items[0].status == '4' || items[0].status == '5'){
                                            $http.post('https://ec2.diwoapp.com.br/PagSeguroRefund.php', {code : items[0].code});
                                          }else{
                                            $http.post('https://ec2.diwoapp.com.br/PagSeguroCancel.php', {code : items[0].code});
                                          }
                                          EventoService.VerificaNotificacao(noti).then(function(res) {
                                          console.log(res);
                                            if(res){
                                                $http.post('https://ec2.diwoapp.com.br/notificapessoa.php', {notificacao : 'Desisti de ir no seu evento, perdão', 
                                                      idevento : $scope.evento.idevento,
                                                      nomeevento : $scope.evento.nomeevento,
                                                      id_user_envia : $scope.aux.iduser,
                                                      username_envia : $scope.aux.username,

                                                      tipo : '5', //pessoa desistiu
                                                      id_user_recebe : $scope.criador});
                                              EventoService.getusuario2(noti.recebeusername).then(function(user) {
                                                if(user.noticriados== '1'){
                                                $scope.pushnoti.titulo =  $scope.aux.username +' desistiu' ;
                                                $scope.pushnoti.msg = $scope.aux.username + " não vai mais no evento " + $scope.evento.nomeevento;
                                                $scope.pushnoti.token = user.devicetoken;
                                                 EventoService.MandaPushNoti($scope.pushnoti);
                                               }
                                              });
                                            }
                                          });
                                          $http.post("https://ec2.diwoapp.com.br/deletanotificacaoporids.php", {id_user_recebe : noti.recebe,
                                                                              id_user_envia: noti.envia,
                                                                              nomeevento: noti.nomeevento,
                                                                              tipo : '1'});
                                                       $http.post('https://ec2.diwoapp.com.br/penalidade.php', {iduser : $scope.aux.iduser,
                                                                                                     idevento : $scope.evento.idevento,
                                                                                                     username : $scope.aux.username,
                                                                                                     tipopenalidade : '1'});   // tipo 1 saiu na yellow zone   
                                                      
                                                         if(meuestado == 2){
                                                         $scope.evento.patual = parseInt($scope.evento.patual)-1;
                                                        }
                                                        $http.post('https://ec2.diwoapp.com.br/addpessoaevento.php', {idevento : $scope.evento.idevento,
                                                                                          patual : $scope.evento.patual});    
                                                    $http.post('https://ec2.diwoapp.com.br/deletapessoaevento.php', {iduser : $scope.aux.iduser,
                                                                                                                        idevento : $scope.evento.idevento});
                                                      // if(items[0].status == '3' || items[0].status == '4' || items[0].status == '5'){
                                                      //   $http.post('https://ec2.diwoapp.com.br/PagSeguroRefund.php', {code : items[0].code});
                                                      //   $state.go('tabsController.eventosAbertos');
                                                      // }else{
                                                      //   $http.post('https://ec2.diwoapp.com.br/PagSeguroCancel.php', {code : items[0].code});
                                                        $state.go('tabsController.eventosAbertos');
                                                      //}
                                                    }
                                                   }
                                                 ]
                                         })

                             }
                           }else{
                             var confirmPopup = $ionicPopup.show({
                                         title: 'ATENÇÃO!!!',
                                         template: 'Você esta preste a desistir de um evento, tens certeza disso?',
                                         buttons: [
                                            { text: 'Não',
                                              type: 'button-assertive'},
                                            {
                                              text: 'Sim',
                                              type: 'button-positive',
                                              onTap: function(e){
                                                noti.recebeusername = $scope.evento.admusername;
                                                noti.recebe =  $scope.criador;
                                          noti.envia = $scope.aux.iduser;
                                          noti.tipo = 5;
                                          noti.nomeevento = $scope.evento.nomeevento;
                                          if(items[0].status == '3' || items[0].status == '4' || items[0].status == '5'){
                                            $http.post('https://ec2.diwoapp.com.br/PagSeguroRefund.php', {code : items[0].code});
                                          }else{
                                            $http.post('https://ec2.diwoapp.com.br/PagSeguroCancel.php', {code : items[0].code});
                                          }
                                          EventoService.VerificaNotificacao(noti).then(function(res) {
                                          console.log(res);
                                            if(res){
                                                $http.post('https://ec2.diwoapp.com.br/notificapessoa.php', {notificacao : 'Desisti de ir no seu evento, perdão', 
                                                      idevento : $scope.evento.idevento,
                                                      nomeevento : $scope.evento.nomeevento,
                                                      id_user_envia : $scope.aux.iduser,
                                                      username_envia : $scope.aux.username,
                                                      apelido_envia : $scope.aux.apelido,
                                                      tipo : '5', //pessoa desistiu
                                                      id_user_recebe : $scope.criador}).then(function (res){
                                                     $scope.response = res.data;
                                                     //console.log($scope.response.msg)
                                                   });
                                              EventoService.getusuario2(noti.recebeusername).then(function(user) {
                                                if(user.noticriados== '1'){
                                                $scope.pushnoti.titulo =  $scope.aux.username +' desistiu' ;
                                                $scope.pushnoti.msg = $scope.aux.username + " não vai mais no evento " + $scope.evento.nomeevento;
                                                $scope.pushnoti.token = user.devicetoken;
                                                 EventoService.MandaPushNoti($scope.pushnoti);
                                               }
                                              });
                                            }
                                          });
                                          $http.post("https://ec2.diwoapp.com.br/deletanotificacaoporids.php", {id_user_recebe : noti.recebe,
                                                                              id_user_envia: noti.envia,
                                                                              nomeevento: noti.nomeevento,
                                                                              tipo : '1'});
                                                       if(meuestado == 2){
                                                         $scope.evento.patual = parseInt($scope.evento.patual)-1;
                                                        }
                                                    $http.post('https://ec2.diwoapp.com.br/addpessoaevento.php', {idevento : $scope.evento.idevento,
                                                                                                                    patual : $scope.evento.patual});    
                                                    $http.post('https://ec2.diwoapp.com.br/deletapessoaevento.php', {iduser : $scope.aux.iduser,
                                                                                                                        idevento : $scope.evento.idevento});
                                                      // if(items[0].status == '3' || items[0].status == '4' || items[0].status == '5'){
                                                      //   $http.post('https://ec2.diwoapp.com.br/PagSeguroRefund.php', {code : items[0].code});
                                                      //   $state.go('tabsController.eventosAbertos');
                                                      // }else{
                                                      //   $http.post('https://ec2.diwoapp.com.br/PagSeguroCancel.php', {code : items[0].code});
                                                        $state.go('tabsController.eventosAbertos');
                                                      //}
                                                    }
                                                   }
                                                 ]
                                         })
                           }
              }else{
                             var confirmPopup = $ionicPopup.show({
                                         title: 'ATENÇÃO!!!',
                                         template: 'Você esta preste a cancelar sua reserva neste evento, tens certeza disso? Estaremos devolvendo seu dinheiro',
                                         buttons: [
                                            { text: 'Não',
                                              type: 'button-assertive'},
                                            {
                                              text: 'Sim',
                                              type: 'button-positive',
                                              onTap: function(e){
                                                noti.recebeusername = $scope.evento.admusername;
                                                noti.recebe =  $scope.criador;
                                          noti.envia = $scope.aux.iduser;
                                          noti.tipo = 5;
                                          noti.nomeevento = $scope.evento.nomeevento;
                                          if(items[0].status == '3' || items[0].status == '4' || items[0].status == '5'){
                                            $http.post('https://ec2.diwoapp.com.br/PagSeguroRefund.php', {code : items[0].code});
                                          }else{
                                            $http.post('https://ec2.diwoapp.com.br/PagSeguroCancel.php', {code : items[0].code});
                                          }
                                          EventoService.VerificaNotificacao(noti).then(function(res) {
                                          console.log(res);
                                            if(res){
                                                $http.post('https://ec2.diwoapp.com.br/notificapessoa.php', {notificacao : 'Desisti de ir no seu evento, perdão', 
                                                      idevento : $scope.evento.idevento,
                                                      nomeevento : $scope.evento.nomeevento,
                                                      id_user_envia : $scope.aux.iduser,
                                                      username_envia : $scope.aux.username,
                                                      apelido_envia : $scope.aux.apelido,
                                                      tipo : '5', //pessoa desistiu
                                                      id_user_recebe : $scope.criador}).then(function (res){
                                                     $scope.response = res.data;
                                                     //console.log($scope.response.msg)
                                                   });
                                              EventoService.getusuario2(noti.recebeusername).then(function(user) {
                                                if(user.noticriados== '1'){
                                                $scope.pushnoti.titulo =  $scope.aux.username +' desistiu' ;
                                                $scope.pushnoti.msg = $scope.aux.username + " não vai mais no evento " + $scope.evento.nomeevento;
                                                $scope.pushnoti.token = user.devicetoken;
                                                 EventoService.MandaPushNoti($scope.pushnoti);
                                               }
                                              });
                                            }
                                          });
                                          $http.post("https://ec2.diwoapp.com.br/deletanotificacaoporids.php", {id_user_recebe : noti.recebe,
                                                                              id_user_envia: noti.envia,
                                                                              nomeevento: noti.nomeevento,
                                                                              tipo : '1'});
                                                      if(meuestado == 2){
                                                         $scope.evento.patual = parseInt($scope.evento.patual)-1;
                                                        }
                                                    $http.post('https://ec2.diwoapp.com.br/addpessoaevento.php', {idevento : $scope.evento.idevento,
                                                                                                                    patual : $scope.evento.patual});    
                                                    $http.post('https://ec2.diwoapp.com.br/deletapessoaevento.php', {iduser : $scope.aux.iduser,
                                                                                                                        idevento : $scope.evento.idevento});
                                                      // if(items[0].status == '3' || items[0].status == '4' || items[0].status == '5'){
                                                      //   $http.post('https://ec2.diwoapp.com.br/PagSeguroRefund.php', {code : items[0].code});
                                                      //   $state.go('tabsController.eventosAbertos');
                                                      // }else{
                                                      //   $http.post('https://ec2.diwoapp.com.br/PagSeguroCancel.php', {code : items[0].code});
                                                        $state.go('tabsController.eventosAbertos');
                                                      //}
                                                    }
                                                   }
                                                 ]
                                         })
                            }



                                     
      });
    }
   
}])

.controller('ver_onde_mapa_EventoabertosCtrl', ['$scope', '$stateParams', '$cordovaGeolocation', '$state', '$ionicLoading', 'formItem', 'formEventoAbertosTab','$ionicTabsDelegate',  // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, $cordovaGeolocation, $state, $ionicLoading, formItem, formEventoAbertosTab, $ionicTabsDelegate) {
 //$scope.evento = formItem.getForm();
 $scope.evento = formEventoAbertosTab.getForm();
 //$scope.coord = {};
  console.log($scope.evento.lat);
  $ionicTabsDelegate.showBar(0);
  console.log($scope.evento.lng);
        
        var latlng = {lat: parseFloat($scope.evento.lat), lng: parseFloat($scope.evento.lng)};


        var mapOptions = {
                center: latlng,
                zoom: 16,
                mapTypeId: google.maps.MapTypeId.ROADMAP
            };          
             

        var map = new google.maps.Map(document.getElementById("map_canvas2"), mapOptions); 
        var geocoder = new google.maps.Geocoder;
        var infowindow = new google.maps.InfoWindow({
                                                      maxWidth: 200
                                                    });

        geocoder.geocode({'location': latlng}, function(results, status) {
          if (status === 'OK') {
            if (results[1]) {
              var marker = new google.maps.Marker({
                position: latlng,
                map: map,
                title: "Borai",
                icon: 'http://maps.google.com/mapfiles/ms/icons/green-dot.png',
                animation: google.maps.Animation.DROP 
              });
              infowindow.setContent(results[0].formatted_address);
              infowindow.open(map, marker);
            } else {
              window.alert('No results found');
            }
          } else {
            window.alert('Geocoder failed due to: ' + status);
          }
        });

        $scope.map = map;  
             
}])

.controller('perfil_outro_eventoabertosCtrl', ['$scope', '$stateParams', 'formItem', 'formOutro', '$state', 'EventoService', '$http', '$timeout', 'formUser', '$ionicPopup', 'formStalker','formEventoAbertosTab', '$ionicTabsDelegate', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, formItem, formOutro, $state, EventoService, $http, $timeout, formUser, $ionicPopup, formStalker, formEventoAbertosTab, $ionicTabsDelegate) {

    $scope.estadobutton = 0; 
    $scope.stalkeada = {};
    $scope.neventos= 0;
    $scope.neventosnao= 0;
    $scope.p =0;
    $scope.outro = formOutro.getForm();
    $scope.stalkeada = $scope.outro;
    $scope.user = formUser.getForm();
    $scope.pushnoti = {};
    $scope.followbutton = false;
    $scope.desseguirbutton = false;
    $scope.auxusers = {};
    $scope.qvou = true;

    $scope.CoisasCriado = true;
    $scope.CoisasFinalizado = false;


    var auxbloqueado = 0;
    var noti = {};
     
    var header = document.getElementById("barperfiloutroev");
    var btns = header.getElementsByClassName("btnperfilotro");
    for (var i = 0; i < btns.length; i++) {
      btns[i].addEventListener("click", function() {
        var current = document.getElementsByClassName("actoea");
        current[0].className = current[0].className.replace(" actoea", "");
        this.className += " actoea";
      });
    }

    $scope.infosstalkeada={};
    EventoService.GetStalkear($scope.stalkeada.iduser).then(function(stalker) {
        $scope.infosstalkeada = stalker;

        if($scope.infosstalkeada.profilepic[8] == 's' && $scope.infosstalkeada.profilepic[9] == '3'){
            document.getElementById("imageidperfil_outro_eventoabertos").src=$scope.infosstalkeada.profilepic+"?{{getTimeStamp()}}";
           }else{
             document.getElementById("imageidperfil_outro_eventoabertos").src=$scope.infosstalkeada.profilepic;
           }
           if(!$scope.infosstalkeada.numcodigo || $scope.infosstalkeada.numcodigo == 'null'){
              $scope.temcodigo = false;
            }else{
              $scope.temcodigo = true;
              if($scope.infosstalkeada.numcodigo == '0'){
                document.getElementById("badgeimg_poea").src="img/egg_0.png";
              }
              if($scope.infosstalkeada.numcodigo == '1'){
                document.getElementById("badgeimg_poea").src="img/egg_1.png";
              }
              if($scope.infosstalkeada.numcodigo == '2'){
                document.getElementById("badgeimg_poea").src="img/egg_2.png";
              }
              if(parseInt($scope.infosstalkeada.numcodigo) >= 3){
                document.getElementById("badgeimg_poea").src="img/egg_3.png";
              }
              if(parseInt($scope.infosstalkeada.numcodigo) < 0){
                document.getElementById("badgeimg_poea").src="img/egg_3.png";
              }
            }
        $scope.frase = stalker.frase;
        if(stalker.borda == 0){
          $scope.estrelabb = false;
          $scope.estrelabs = false;
          $scope.estrelabg = false;
        }
        if(stalker.borda == 1){
          $scope.estrelabb = true;
          $scope.estrelabs = false;
          $scope.estrelabg = false;
        }
        if(stalker.borda == 2){
          $scope.estrelabb = false;
          $scope.estrelabs = true;
          $scope.estrelabg = false;
        }
        if(stalker.borda == 3){
          $scope.estrelabb = false;
          $scope.estrelabs = false;
          $scope.estrelabg = true;
        }
        if($scope.infosstalkeada.idade){
          $scope.infosstalkeada.idade = ", "+ $scope.infosstalkeada.idade +" anos";
        }else{
           $scope.infosstalkeada.idade ='';
        }
    });

   
     EventoService.GetPontos($scope.stalkeada.iduser).then(function(items) {
        $scope.p = items;
        $scope.labels3 = ["Pontos"];
        $scope.colores3 = ["#ff4d4d"];
        $scope.data3 = [$scope.p];
      });

       
      EventoService.getIC($scope.stalkeada).then(function(items) {
        if(items){
          $scope.ic = items;
          $scope.options2 = {title: {
                      display: true,
                      text: 'Indice de confirmação',
                      position: 'bottom'
                  }
           }
          $scope.labels2 = ["Fui", "Não fui"];
          $scope.colores2 = ["#99FF99","#ff4d4d"];
          var menos = (100-$scope.ic.total).toFixed(1);
          var mais = $scope.ic.total;
          $scope.data2 = [mais, menos ];
        }
      });

      EventoService.GetComments3($scope.stalkeada).then(function(items) {
        
          $scope.options1 = {title: {
                    display: true,
                    text: 'Avaliações',
                    position: 'bottom'
                }
         }
          $scope.labels1 = ["Extrovertido", "Introvertido", "Realista","Curioso", "Solidário", "Racional","Organizado", "Criativo"];
          $scope.colores1 = ["#fff200", "#02fff2", "#ff9d00","#1867ce", "#e50be1", "#0e8c28","#ef370e", "#af0eef"];
          $scope.data1 =items.chart;
        
      });   
      $scope.outro= $scope.outro.iduser;
      
    $scope.$on("$ionicView.enter", function(event, data){
      $ionicTabsDelegate.showBar(0);
      $scope.pushnoti = {};
      $scope.items = [];
      $scope.vezes = 0;
      $scope.newItems = [];
      $scope.noMoreItemsAvailable = false;
      $scope.lastidevento = 0;
      $scope.aux2 = 0;
      $scope.outro = formOutro.getForm();
      $scope.stalkeada = $scope.outro;
      $scope.followbutton = false;
      $scope.desseguirbutton = false;
      $scope.infosstalkeada={};
        if($scope.outro == $scope.user.iduser){
        $scope.followbutton = false;
        $scope.desseguirbutton = false;
        $scope.reportbutton = false;
        $scope.qvou = true;
      }else{
        $scope.reportbutton = true;
      }
      EventoService.GetStalkear($scope.stalkeada.iduser).then(function(stalker) {
            $scope.infosstalkeada = stalker;
            if(($scope.infosstalkeada.profilepic[8] == 's' && $scope.infosstalkeada.profilepic[9] == '3')||($scope.infosstalkeada.profilepic[8] == 'd' && $scope.infosstalkeada.profilepic[9] == 'i')){
          
            //if($scope.infosstalkeada.profilepic[8] == 's' && $scope.infosstalkeada.profilepic[9] == '3'){
            document.getElementById("imageidperfil_outro_eventoabertos").src=$scope.infosstalkeada.profilepic+"?{{getTimeStamp()}}";
           }else{
             document.getElementById("imageidperfil_outro_eventoabertos").src=$scope.infosstalkeada.profilepic;
           }
           if(!$scope.infosstalkeada.numcodigo || $scope.infosstalkeada.numcodigo == 'null'){
              $scope.temcodigo = false;
            }else{
              $scope.temcodigo = true;
              if($scope.infosstalkeada.numcodigo == '0'){
                document.getElementById("badgeimg_poea").src="img/egg_0.png";
              }
              if($scope.infosstalkeada.numcodigo == '1'){
                document.getElementById("badgeimg_poea").src="img/egg_1.png";
              }
              if($scope.infosstalkeada.numcodigo == '2'){
                document.getElementById("badgeimg_poea").src="img/egg_2.png";
              }
              if(parseInt($scope.infosstalkeada.numcodigo) >= 3){
                document.getElementById("badgeimg_poea").src="img/egg_3.png";
              }
              if(parseInt($scope.infosstalkeada.numcodigo) < 0){
                document.getElementById("badgeimg_poea").src="img/egg_3.png";
              }
            }
            //document.getElementById("imageidperfil_outro_eventoabertos").src=$scope.infosstalkeada.profilepic+"?{{getTimeStamp()}}";
            $scope.frase = stalker.frase;
             if(stalker.borda == 0){
          $scope.estrelabb = false;
          $scope.estrelabs = false;
          $scope.estrelabg = false;
        }
        if(stalker.borda == 1){
          $scope.estrelabb = true;
          $scope.estrelabs = false;
          $scope.estrelabg = false;
        }
        if(stalker.borda == 2){
          $scope.estrelabb = false;
          $scope.estrelabs = true;
          $scope.estrelabg = false;
        }
        if(stalker.borda == 3){
          $scope.estrelabb = false;
          $scope.estrelabs = false;
          $scope.estrelabg = true;
        }
            if($scope.infosstalkeada.idade){
              $scope.infosstalkeada.idade = ", "+ $scope.infosstalkeada.idade +" anos";
            }else{
               $scope.infosstalkeada.idade ='';
            }
        });
         // GET VALORES DE PONTOS E IC DA PESSOA

       EventoService.GetPontos($scope.stalkeada.iduser).then(function(items) {
        $scope.p = items;
        $scope.labels3 = ["Pontos"];
        $scope.colores3 = ["#ff4d4d"];
        $scope.data3 = [$scope.p];
      });


      EventoService.getIC($scope.stalkeada).then(function(items) {
        if(items){
          $scope.ic = items;
          $scope.options2 = {title: {
                      display: true,
                      text: 'Indice de confirmação',
                      position: 'bottom'
                  }
           }
          $scope.labels2 = ["Fui", "Não fui"];
          $scope.colores2 = ["#99FF99","#ff4d4d"];
          var menos = (100-$scope.ic.total).toFixed(1);
          var mais = $scope.ic.total;
          $scope.data2 = [mais, menos ];
        }
      });

      EventoService.GetComments3($scope.stalkeada).then(function(items) {
        
          $scope.options1 = {title: {
                    display: true,
                    text: 'Avaliações',
                    position: 'bottom'
                }
         }
          $scope.labels1 = ["Extrovertido", "Introvertido", "Realista","Curioso", "Solidário", "Racional","Organizado", "Criativo"];
          $scope.colores1 = ["#fff200", "#02fff2", "#ff9d00","#1867ce", "#e50be1", "#0e8c28","#ef370e", "#af0eef"];
          $scope.data1 =items.chart;
        
      });   

      
        EventoService.GetCriados($scope.stalkeada).then(function(items) {

          $scope.CoisasCriado = true;
          $scope.CoisasFinalizado = false;

          if(items == 'E'){
            $scope.items = [];
          }else{
            for (var i = 0; i < items.length; i++) {
                var curr_date = (items[i].diainicio[8]+items[i].diainicio[9]);
                var h2 = (items[i].diainicio[11]+items[i].diainicio[12]);
                var m2 = (items[i].diainicio[14]+items[i].diainicio[15]);
                var curr_month = (items[i].diainicio[5]+items[i].diainicio[6]);
                var curr_year = (items[i].diainicio[0]+items[i].diainicio[1]+items[i].diainicio[2]+items[i].diainicio[3]);
                var j = curr_date + "/" + curr_month + "/" + curr_year+ ' '+h2 + ':' + m2;
                items[i].datainicio = j;
                if(items[i].estado == 0){
                  items[i].confirmacao = "Vai acontecer"
                }
                if(items[i].estado == 1){
                  items[i].confirmacao = "Finalizado"
                }
                if(items[i].estado == 2){
                  items[i].confirmacao = "Standy by, talvez aconteça"
                }
                if(items[i].estado == 3){
                  items[i].confirmacao = "Vai acontecer"
                }
                if(items[i].estado == 4){
                  items[i].confirmacao = "Cancelado"
                }
                if(items[i].estado == 5){
                  items[i].confirmacao = "Acabado"
                }
                if(items[i].estado == 6){
                  items[i].confirmacao = "Escondido"
                }
            }
            $scope.items = items.concat($scope.items);
            $scope.lastidvestido = $scope.items[0].idevento;
          }
        }); 
           

                      //Para ver se eu ja sigo esta pessoa ou não.
      $scope.outro= $scope.outro.iduser;
      $scope.auxusers.outro =  $scope.outro;
      $scope.auxusers.eu =  $scope.user.iduser;


      EventoService.possoseguir($scope.auxusers).then(function(items) {
        console.log(items)
        if(items){
          console.log($scope.outro,$scope.user.iduser)
          //// nao funciona, nao pegar os bloqueados
          $http.post('https://ec2.diwoapp.com.br/getfollow.php', {iduserseguindo : $scope.outro, 
                                                                    iduserseguidor : $scope.user.iduser}).then(function(res) {
            console.log( 'oi' , res.data[0].bloqueado, res.data[0] );
            if(res.data[0]!='E'){
              if (res.data[0].bloqueado==0){ 
                $scope.desseguirbutton = true;
                $scope.followbutton = false;
                auxbloqueado = 1;
                $scope.qvou = true;
                console.log('ja sigo este cara');
              }
              if(res.data[0].bloqueado==2){
                console.log('nao sigo este cara');
                $scope.desseguirbutton = false;
                $scope.followbutton = true;
                auxbloqueado = 1;
                $scope.qvou = false;
              }
              if(res.data[0].bloqueado==1){
                console.log('tais bloqueado');
                $scope.desseguirbutton = false;
                $scope.followbutton = false;
                auxbloqueado = 3;
                $scope.items = [];
                $scope.qvou = false;
              }
              if($scope.outro == $scope.user.iduser){
                $scope.followbutton = false;
                $scope.desseguirbutton = false;
                $scope.reportbutton = false;
                $scope.qvou = true;
              }
            }else{
                $scope.followbutton = true;
                auxbloqueado = 2;
                $scope.qvou = false;
            }
            if($scope.outro == $scope.user.iduser){
              $scope.followbutton = false;
              $scope.desseguirbutton = false;
              $scope.reportbutton = false;
              $scope.qvou = true;
            }
          });
        }else{
          if($scope.outro == $scope.user.iduser){
            $scope.followbutton = false;
            $scope.desseguirbutton = false;
            $scope.reportbutton = false;
            $scope.qvou = true;
          }else{
            $scope.qvou = false;
          }
        }
      });        
    });

    $scope.seguir = function(){
      noti.recebe = $scope.outro;
      noti.envia = $scope.user.iduser;
      noti.tipo = 11;
      noti.nomeevento = 'follow';
      EventoService.VerificaNotificacao(noti).then(function(res) {
        console.log(res);
        if(res){
          var msgnoti ='Nova pessoa esta t stalkeando';
          var link = 'https://ec2.diwoapp.com.br/notificapessoa.php';
            $http.post(link, {notificacao :msgnoti, 
                                idevento : $scope.user.iduser,
                                nomeevento : 'follow',
                                id_user_envia : $scope.user.iduser,
                                username_envia : $scope.user.username,
                                apelido_envia : $scope.user.apelido,
                                tipo : '11',
                                id_user_recebe : $scope.outro});
        }
      });
      if(auxbloqueado == 2){
        var link = 'https://ec2.diwoapp.com.br/seguepessoa.php';
            $http.post(link, {iduserseguindo : $scope.outro, 
                          usernameseguindo : $scope.stalkeada.username,
                          apelidoseguindo : $scope.infosstalkeada.apelido,
                          apelidoseguidor : $scope.user.apelido,
                          profilepicseguindo : $scope.infosstalkeada.profilepic,
                          profilepicseguidor : $scope.user.profilepic,
                          iduserseguidor : $scope.user.iduser,
                          devicetokenseguidor : $scope.user.devicetoken,
                          usernameseguidor : $scope.user.username}).then(function(res) {
                          console.log(res.success);
                                var alertPopup = $ionicPopup.alert({
                                                            title: '(*•̀ᴗ•́*)و ̑̑',
                                                            template: 'Pessoa adicionada as pessoas de interesse'
                                                          }); 
                                
                            
                            $scope.desseguirbutton = true;
                            $scope.followbutton = false;
                          });
      }else{
         var link = 'https://ec2.diwoapp.com.br/refollow.php'; // estado "Bloqueado"  = 2;
            $http.post(link, {iduserseguindo : $scope.outro, 
                          iduserseguidor : $scope.user.iduser}).then(function(res) {
                            
                                var alertPopup = $ionicPopup.alert({
                                                            title: '(￣▽￣)ノ',
                                                            template: 'Pessoa adicionada as pessoas de interesse'
                                                          }); 
                                $scope.desseguirbutton = true;
                                $scope.followbutton = false;
                            
                          });
      }
    }

    $scope.desseguir = function(){
      auxbloqueado = 0;
        var link = 'https://ec2.diwoapp.com.br/desfollow.php'; // estado "Bloqueado"  = 2;
            $http.post(link, {iduserseguindo : $scope.outro, 
                          iduserseguidor : $scope.user.iduser}).then(function(res) {
                            
                                var alertPopup = $ionicPopup.alert({
                                                            title: '(*꒦ິ⌓꒦ີ)',
                                                            template: 'Não segues mais esta pessoa'
                                                          }); 
                                $scope.desseguirbutton = false;
                                $scope.followbutton = true;
                            
                          });
    }

    $scope.entrabadges = function(){
      $state.go('tabsController.badgesperfil_outro_eventoabertos');
    }



    $scope.loadCriados = function() {
      $scope.CoisasCriado = true;
      $scope.CoisasFinalizado = false;

      if(auxbloqueado!=3){
        $scope.estadobutton = 0;
        $scope.items = [];
        EventoService.GetCriados($scope.stalkeada).then(function(items) {
          if(items == 'E'){
            $scope.items = [];
          }else{
            for (var i = 0; i < items.length; i++) {
                 var curr_date = (items[i].diainicio[8]+items[i].diainicio[9]);
                var h2 = (items[i].diainicio[11]+items[i].diainicio[12]);
                var m2 = (items[i].diainicio[14]+items[i].diainicio[15]);
                var curr_month = (items[i].diainicio[5]+items[i].diainicio[6]);
                var curr_year = (items[i].diainicio[0]+items[i].diainicio[1]+items[i].diainicio[2]+items[i].diainicio[3]);
                var j = curr_date + "/" + curr_month + "/" + curr_year+ ' '+h2 + ':' + m2;
                items[i].datainicio = j;
                if(items[i].estado == 0){
                  items[i].confirmacao = "Vai acontecer"
                }
                if(items[i].estado == 1){
                  items[i].confirmacao = "Finalizado"
                }
                if(items[i].estado == 2){
                  items[i].confirmacao = "Standy by, talvez aconteça"
                }
                if(items[i].estado == 3){
                  items[i].confirmacao = "Vai acontecer"
                }
                if(items[i].estado == 4){
                  items[i].confirmacao = "Cancelado"
                }
                if(items[i].estado == 5){
                  items[i].confirmacao = "Acabado"
                }
                if(items[i].estado == 6){
                  items[i].confirmacao = "Escondido"
                }
            }
            $scope.items = items.concat($scope.items);
            $scope.lastidvestido = $scope.items[0].idevento;
          }
        });
      }
        // $scope.enterItem =  function(item){
          //   formItem.updateForm(item);
          //   //console.log(item.idevento);
          //   //console.log(item.adm);
          //   $state.go('tabsController.evento_do_eventoAbertos');
          //   }
      }
      $scope.loadAbertos = function() {
        $scope.CoisasCriado = false;
        $scope.CoisasFinalizado = true;

        if(auxbloqueado!=3){
        $scope.estadobutton = 1;
        $scope.items = [];
        console.log($scope.stalkeada.iduser);
        EventoService.GetAbertos($scope.stalkeada.iduser).then(function(items) {  //mudar
          if(items == 'E'){
            $scope.items = [];
          }else{
            for (var i = 0; i < items.length; i++) {
                var curr_date = (items[i].diainicio[8]+items[i].diainicio[9]);
                var h2 = (items[i].diainicio[11]+items[i].diainicio[12]);
                var m2 = (items[i].diainicio[14]+items[i].diainicio[15]);
                var curr_month = (items[i].diainicio[5]+items[i].diainicio[6]);
                var curr_year = (items[i].diainicio[0]+items[i].diainicio[1]+items[i].diainicio[2]+items[i].diainicio[3]);
                var j = curr_date + "/" + curr_month + "/" + curr_year+ ' '+h2 + ':' + m2;
                items[i].datainicio = j;
            }
            $scope.items = items.concat($scope.items);
            $scope.lastidvestido = $scope.items[0].idevento;
          }
        });
      }
         // $scope.enterItem =  function(item){
          //   formItem.updateForm(item);
          //   //console.log(item.idevento);
          //   //console.log(item.adm);
          //   $state.go('tabsController.evento_do_eventoAbertos');
          //   }
      }
      $scope.loadFechados = function() {
        $scope.CoisasCriado = false;
        $scope.CoisasFinalizado = true;
        if(auxbloqueado!=3){
        $scope.estadobutton = 2;
        $scope.items = [];
        //console.log($scope.user.iduser);
        EventoService.GetFinalizadosPerfil($scope.stalkeada.iduser).then(function(items) {         //mudar
          if(items=='E'){
            $scope.items = [];
          }else{
            for (var i = 0; i < items.length; i++) {
                var curr_date = (items[i].diainicio[8]+items[i].diainicio[9]);
                var h2 = (items[i].diainicio[11]+items[i].diainicio[12]);
                var m2 = (items[i].diainicio[14]+items[i].diainicio[15]);
                var curr_month = (items[i].diainicio[5]+items[i].diainicio[6]);
                var curr_year = (items[i].diainicio[0]+items[i].diainicio[1]+items[i].diainicio[2]+items[i].diainicio[3]);
                var j = curr_date + "/" + curr_month + "/" + curr_year+ ' '+h2 + ':' + m2;
                items[i].datainicio = j;
            }
            $scope.items = items.concat($scope.items);
            $scope.lastidvestido = $scope.items[0].idevento;
          }
        });
      }
          
      }
      $scope.loadMore = function() {
        if ($scope.estadobutton == 0&& auxbloqueado!=3) {
          EventoService.GetOldEventosCriados($scope.stalkeada).then(function(items) {
          $scope.items = $scope.items.concat(items);
          $scope.$broadcast('scroll.infiniteScrollComplete');
            // an empty array indicates that there are no more items
            if (items.length <= 4) {
              $scope.noMoreItemsAvailable = true;
            }

          });
         

        }
        if ($scope.estadobutton == 1&& auxbloqueado!=3) {
          // EventoService.GetOldEventosCriados($scope.stalkeada).then(function(items) {
          // $scope.items = $scope.items.concat(items);
          // $scope.$broadcast('scroll.infiniteScrollComplete');
          //   // an empty array indicates that there are no more items
          //   if (items.length <= 4) {
          //     $scope.noMoreItemsAvailable = true;
          //   }
          // });

          $scope.noMoreItemsAvailable = true;
        }
        if ($scope.estadobutton == 2&& auxbloqueado!=3) {
          // EventoService.GetOldEventosCriados($scope.stalkeada).then(function(items) {
          // $scope.items = $scope.items.concat(items);
          // $scope.$broadcast('scroll.infiniteScrollComplete');
          //   // an empty array indicates that there are no more items
          //   if (items.length <= 4) {
          //     $scope.noMoreItemsAvailable = true;
          //   }
          // });

          $scope.noMoreItemsAvailable = true;
        }
      }

      $scope.reportar = function(){
          $scope.reportmsg = '';
          console.log($scope.stalkeada.username);
            $scope.report = [
          { text: "Nome impróprio", checked: false },
          { text: "Comportamento inadequado", checked: false },
          { text: "Foto inapropriada", checked: false },
          { text: "É um impostor", checked: false }
         ];
            $ionicPopup.confirm({
              title: 'Você quer reportar essa pessoa pq?',
              content: '<ion-checkbox ng-repeat="item in report" style="color: #FCFCFC;" ng-model="item.checked"  ng-checked="item.checked">{{item.text}}</ion-checkbox>',
              scope: $scope
            })
            .then(function(res) {
              if(res) {
                for (var h=0;h<3;h++){
                  //console.log($scope.report[h].checked , h);
                  if($scope.report[h].checked){
                    $scope.reportmsg = $scope.reportmsg + $scope.report[h].text + ' ';
                    //console.log($scope.reportmsg);
                  }
                }

                if(h==3){
                  console.log($scope.reportmsg);
                   $http.post('https://ec2.diwoapp.com.br/reportaevento.php', {namereportado : $scope.stalkeada.username,
                                                                                  reportadoid : $scope.stalkeada.iduser,
                                                                                  iduserreportando : $scope.user.iduser,
                                                                                  usernamereportando : $scope.user.username,
                                                                                  tiporeport : 'usuario',
                                                                                  motivo : $scope.reportmsg}).then(function (tes){
                                     $scope.response = tes.data;
                                      var alertPopup = $ionicPopup.alert({
                                                              title: 'Obrigado',
                                                              template: 'Esta pessoa esta agora sobre investigação, obrigado por manter a plataforma segura'
                                                            });

                                   });
                }
                
              }
            });
         }

         $scope.comentario = function(){
          formStalker.updateForm($scope.stalkeada);
          if(auxbloqueado!=3){
          $state.go('tabsController.comentariosdosoutros');}
         }

      $scope.enterItem =  function(item){
        formEventoAbertosTab.updateForm(item);
        //formItem.updateForm(item);
        console.log(item.idevento);
        //console.log(item.adm);
      $state.go('tabsController.evento_do_eventoAbertos_do_outro');
    }

}])

.controller('badgesperfil_outro_eventoabertosCtrl', ['$scope', '$stateParams', 'formOutro', 'EventoService','$ionicPopup', '$timeout','$state', '$cordovaCamera', '$cordovaFile', '$cordovaFileTransfer', '$ionicLoading','formBadge', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, formOutro, EventoService, $ionicPopup, $timeout, $state, $cordovaCamera, $cordovaFile, $cordovaFileTransfer, $ionicLoading, formBadge) {


  $scope.user = formOutro.getForm();
  $scope.aux = {};
  $scope.aux.iduser = $scope.user.iduser;


  $scope.aux.tag = "#ArteeCultura";
  $scope.auxnbadgeArteeCultura = 0;
  $scope.proximoArteeCultura = 0;
  $scope.proximoimgArteeCultura = '';
  $scope.anteriorimgArteeCultura = '';
  EventoService.getbadges($scope.aux).then(function(badges){
    console.log("badges", badges);
    if(badges!="Error" && badges !="E"){
      $scope.auxnbadgeArteeCultura = badges.length;
      if(badges.length == 0){
        $scope.anteriorimgArteeCultura = 'img/badges/Categorias/ArteeCultura/0.png';
        $scope.proximoArteeCultura = 1;
        $scope.proximoimgArteeCultura = 'img/badges/Categorias/ArteeCultura/1.png';

        document.getElementById("ArteeCultura").src="img/badges/Categorias/ArteeCultura/0.png"
      }
      if(badges.length == 1){
        $scope.anteriorimgArteeCultura = 'img/badges/Categorias/ArteeCultura/0.png';
        $scope.proximoArteeCultura = 2;
        $scope.proximoimgArteeCultura = 'img/badges/Categorias/ArteeCultura/1.1.png';
        document.getElementById("ArteeCultura").src="img/badges/Categorias/ArteeCultura/1.png"
      }
      if(badges.length == 2){
        $scope.anteriorimgArteeCultura = 'img/badges/Categorias/ArteeCultura/1.png';
        $scope.proximoArteeCultura = 3;
        $scope.proximoimgArteeCultura = 'img/badges/Categorias/ArteeCultura/1.2.png';
        document.getElementById("ArteeCultura").src="img/badges/Categorias/ArteeCultura/1.1.png"
      }
      if(badges.length == 3){
        $scope.anteriorimgArteeCultura = 'img/badges/Categorias/ArteeCultura/1.1.png';
        $scope.proximoArteeCultura = 4;
        $scope.proximoimgArteeCultura = 'img/badges/Categorias/ArteeCultura/1.3.png';
        document.getElementById("ArteeCultura").src="img/badges/Categorias/ArteeCultura/1.2.png"
      }
      if(badges.length == 4 || badges.length == 5){
        $scope.anteriorimgArteeCultura = 'img/badges/Categorias/ArteeCultura/1.2.pn';
        $scope.proximoArteeCultura = 6;
        $scope.proximoimgArteeCultura = 'img/badges/Categorias/ArteeCultura/2.png';
        document.getElementById("ArteeCultura").src="img/badges/Categorias/ArteeCultura/1.3.png"
      }

      if(badges.length == 6 || badges.length == 7){
        $scope.anteriorimgArteeCultura = 'img/badges/Categorias/ArteeCultura/1.3.png';
        $scope.proximoArteeCultura = 8;
        $scope.proximoimgArteeCultura = 'img/badges/Categorias/ArteeCultura/2.1.png';
        document.getElementById("ArteeCultura").src="img/badges/Categorias/ArteeCultura/2.png"
      }
      if(badges.length == 8 || badges.length == 9){
        $scope.anteriorimgArteeCultura = 'img/badges/Categorias/ArteeCultura/2.png';
        $scope.proximoArteeCultura = 10;
        $scope.proximoimgArteeCultura = 'img/badges/Categorias/ArteeCultura/2.2.png';
        document.getElementById("ArteeCultura").src="img/badges/Categorias/ArteeCultura/2.1.png"
      }
      if(badges.length == 10 || badges.length == 11){
        $scope.anteriorimgArteeCultura = 'img/badges/Categorias/ArteeCultura/2.1.png';
        $scope.proximoArteeCultura = 12;
        $scope.proximoimgArteeCultura = 'img/badges/Categorias/ArteeCultura/2.3.png';
        document.getElementById("ArteeCultura").src="img/badges/Categorias/ArteeCultura/2.2.png"
      }
      if(badges.length == 12 || badges.length == 13 || badges.length == 14){
        $scope.anteriorimgArteeCultura = 'img/badges/Categorias/ArteeCultura/2.2.png';
        $scope.proximoArteeCultura = 15;
        $scope.proximoimgArteeCultura = 'img/badges/Categorias/ArteeCultura/3.png';
        document.getElementById("ArteeCultura").src="img/badges/Categorias/ArteeCultura/2.3.png"
      }

      if(badges.length >= 15 && badges.length < 20 ){
        $scope.anteriorimgArteeCultura = 'img/badges/Categorias/ArteeCultura/2.3.png';
        $scope.proximoArteeCultura = 20;
        $scope.proximoimgArteeCultura = 'img/badges/Categorias/ArteeCultura/3.1.png';
        document.getElementById("ArteeCultura").src="img/badges/Categorias/ArteeCultura/3.png"
      }
      if(badges.length >= 20 && badges.length < 22 ){
        $scope.anteriorimgArteeCultura = 'img/badges/Categorias/ArteeCultura/3.png';
        $scope.proximoArteeCultura = 25;
        $scope.proximoimgArteeCultura = 'img/badges/Categorias/ArteeCultura/3.2.png';
        document.getElementById("ArteeCultura").src="img/badges/Categorias/ArteeCultura/3.1.png"
      }
      if(badges.length >= 25 && badges.length < 30 ){
        $scope.anteriorimgArteeCultura = 'img/badges/Categorias/ArteeCultura/3.1.png';
        $scope.proximoArteeCultura = 30;
        $scope.proximoimgArteeCultura = 'img/badges/Categorias/ArteeCultura/3.3.png';
        document.getElementById("ArteeCultura").src="img/badges/Categorias/ArteeCultura/3.2.png"
      }
      if(badges.length >= 30 && badges.length < 50 ){
        $scope.anteriorimgArteeCultura = 'img/badges/Categorias/ArteeCultura/3.2.png';
        $scope.proximoArteeCultura = 50;
        $scope.proximoimgArteeCultura = 'img/badges/Categorias/ArteeCultura/Super.png';
        document.getElementById("ArteeCultura").src="img/badges/Categorias/ArteeCultura/3.3.png"
      }

      if(badges.length >= 50){

        $scope.anteriorimgArteeCultura = 'img/badges/Categorias/ArteeCultura/3.3.png';
        $scope.proximoArteeCultura = 10000;
        $scope.proximoimgArteeCultura = 'img/badges/Categorias/ArteeCultura/Super.png';
        document.getElementById("ArteeCultura").src="img/badges/Categorias/ArteeCultura/Super.png"
      }

    }else{
      $scope.auxnbadgeArteeCultura = 0;
      $scope.anteriorimgArteeCultura = 'img/badges/Categorias/ArteeCultura/0.png';
        $scope.proximoArteeCultura = 1;
        $scope.proximoimgArteeCultura = 'img/badges/Categorias/ArteeCultura/1.png';
      document.getElementById("ArteeCultura").src="img/badges/Categorias/ArteeCultura/0.png"
    }
  });

  $scope.aux.tag = "#Ciclismo";
  $scope.auxnbadgeCiclismo = 0;
  $scope.proximoCiclismo = 0;
  $scope.proximoimgCiclismo = '';
  $scope.anteriorimgCiclismo = '';
  EventoService.getbadges($scope.aux).then(function(badges){
    console.log("badges", badges);
    if(badges!="Error" && badges !="E"){
      $scope.auxnbadgeCiclismo = badges.length;
      if(badges.length == 0){
        $scope.anteriorimgCiclismoa = 'img/badges/Categorias/Ciclismo/0.png';
        $scope.proximoCiclismo = 1;
        $scope.proximoimgCiclismo = 'img/badges/Categorias/Ciclismo/1.png';
        document.getElementById("Ciclismo").src="img/badges/Categorias/Ciclismo/0.png"
      }
      if(badges.length == 1){
        $scope.anteriorimgCiclismoa = 'img/badges/Categorias/Ciclismo/0.png';
        $scope.proximoCiclismo = 2;
        $scope.proximoimgCiclismo = 'img/badges/Categorias/Ciclismo/1.1.png';
        document.getElementById("Ciclismo").src="img/badges/Categorias/Ciclismo/1.png"
      }
      if(badges.length == 2){
        $scope.anteriorimgCiclismoa = 'img/badges/Categorias/Ciclismo/1.png';
        $scope.proximoCiclismo = 3;
        $scope.proximoimgCiclismo = 'img/badges/Categorias/Ciclismo/1.2.png';
        document.getElementById("Ciclismo").src="img/badges/Categorias/Ciclismo/1.1.png"
      }
      if(badges.length == 3){
        $scope.anteriorimgCiclismoa = 'img/badges/Categorias/Ciclismo/1.1.png';
        $scope.proximoCiclismo = 4;
        $scope.proximoimgCiclismo = 'img/badges/Categorias/Ciclismo/1.3.png';
        document.getElementById("Ciclismo").src="img/badges/Categorias/Ciclismo/1.2.png"
      }
      if(badges.length == 4 || badges.length == 5){
        $scope.anteriorimgCiclismoa = 'img/badges/Categorias/Ciclismo/1.2.png';
        $scope.proximoCiclismo = 6;
        $scope.proximoimgCiclismo = 'img/badges/Categorias/Ciclismo/2.png';
        document.getElementById("Ciclismo").src="img/badges/Categorias/Ciclismo/1.3.png"
      }

      if(badges.length == 6 || badges.length == 7){
        $scope.anteriorimgCiclismoa = 'img/badges/Categorias/Ciclismo/1.3.png';
        $scope.proximoCiclismo = 8;
        $scope.proximoimgCiclismo = 'img/badges/Categorias/Ciclismo/2.1.png';
        document.getElementById("Ciclismo").src="img/badges/Categorias/Ciclismo/2.png"
      }
      if(badges.length == 8 || badges.length == 9){
        $scope.anteriorimgCiclismoa = 'img/badges/Categorias/Ciclismo/2.png';
        $scope.proximoCiclismo = 10;
        $scope.proximoimgCiclismo = 'img/badges/Categorias/Ciclismo/2.2.png';
        document.getElementById("Ciclismo").src="img/badges/Categorias/Ciclismo/2.1.png"
      }
      if(badges.length == 10 || badges.length == 11){
        $scope.anteriorimgCiclismoa = 'img/badges/Categorias/Ciclismo/2.1.png';
        $scope.proximoCiclismo = 12;
        $scope.proximoimgCiclismo = 'img/badges/Categorias/Ciclismo/2.3.png';
        document.getElementById("Ciclismo").src="img/badges/Categorias/Ciclismo/2.2.png"
      }
      if(badges.length == 12 || badges.length == 13 || badges.length == 14){
        $scope.anteriorimgCiclismoa = 'img/badges/Categorias/Ciclismo/2.2.png';
        $scope.proximoCiclismo = 15;
        $scope.proximoimgCiclismo = 'img/badges/Categorias/Ciclismo/3.png';
        document.getElementById("Ciclismo").src="img/badges/Categorias/Ciclismo/2.3.png"
      }

      if(badges.length >= 15 && badges.length < 20 ){
        $scope.anteriorimgCiclismoa = 'img/badges/Categorias/Ciclismo/2.3.png';
        $scope.proximoCiclismo = 20;
        $scope.proximoimgCiclismo = 'img/badges/Categorias/Ciclismo/3.1.png';
        document.getElementById("Ciclismo").src="img/badges/Categorias/Ciclismo/3.png"
      }
      if(badges.length >= 20 && badges.length < 22 ){
        $scope.anteriorimgCiclismoa = 'img/badges/Categorias/Ciclismo/3.png';
        $scope.proximoCiclismo = 25;
        $scope.proximoimgCiclismo = 'img/badges/Categorias/Ciclismo/3.2.png';
        document.getElementById("Ciclismo").src="img/badges/Categorias/Ciclismo/3.1.png"
      }
      if(badges.length >= 25 && badges.length < 30 ){
        $scope.anteriorimgCiclismoa = 'img/badges/Categorias/Ciclismo/3.1.png';
        $scope.proximoCiclismo = 30;
        $scope.proximoimgCiclismo = 'img/badges/Categorias/Ciclismo/3.3.png';
        document.getElementById("Ciclismo").src="img/badges/Categorias/Ciclismo/3.2.png"
      }
      if(badges.length >= 30 && badges.length < 50 ){
        $scope.anteriorimgCiclismoa = 'img/badges/Categorias/Ciclismo/3.2.png';
        $scope.proximoCiclismo = 50;
        $scope.proximoimgCiclismo = 'img/badges/Categorias/Ciclismo/Super.png';
        document.getElementById("Ciclismo").src="img/badges/Categorias/Ciclismo/3.3.png"
      }

      if(badges.length >= 50){

        $scope.anteriorimgCiclismoa = 'img/badges/Categorias/Ciclismo/3.3.png';
        $scope.proximoCiclismo = 10000;
        $scope.proximoimgCiclismo = 'img/badges/Categorias/Ciclismo/Super.png';
        document.getElementById("Ciclismo").src="img/badges/Categorias/Ciclismo/Super.png"
      }

    }else{
      $scope.auxnbadgeCiclismo = 0;
      $scope.anteriorimgCiclismoa = 'img/badges/Categorias/Ciclismo/0.png';
      $scope.proximoCiclismo = 1;
      $scope.proximoimgCiclismo = 'img/badges/Categorias/Ciclismo/1.png';
      document.getElementById("Ciclismo").src="img/badges/Categorias/Ciclismo/0.png"
    }
  });

  $scope.aux.tag = "#Conversa";
  $scope.auxnbadgeConversa = 0;
  $scope.proximoConversa = 0;
  $scope.proximoimgConversa = '';
  $scope.anteriorimgConversa = '';
  EventoService.getbadges($scope.aux).then(function(badges){
    console.log("badges", badges);
    if(badges!="Error" && badges !="E"){
      $scope.auxnbadgeConversa = badges.length;
      if(badges.length == 0){
        $scope.anteriorimgConversa = 'img/badges/Categorias/Conversa/0.png';
        $scope.proximoConversa = 1;
        $scope.proximoimgConversa = 'img/badges/Categorias/Conversa/1.png';
        document.getElementById("Conversa").src="img/badges/Categorias/Conversa/0.png"
      }
      if(badges.length == 1){
        $scope.anteriorimgConversa = 'img/badges/Categorias/Conversa/0.png';
        $scope.proximoConversa = 2;
        $scope.proximoimgConversa = 'img/badges/Categorias/Conversa/1.1.png';
        document.getElementById("Conversa").src="img/badges/Categorias/Conversa/1.png"
      }
      if(badges.length == 2){
        $scope.anteriorimgConversa = 'img/badges/Categorias/Conversa/1.png';
        $scope.proximoConversa = 3;
        $scope.proximoimgConversa = 'img/badges/Categorias/Conversa/1.2.png';
        document.getElementById("Conversa").src="img/badges/Categorias/Conversa/1.1.png"
      }
      if(badges.length == 3){
        $scope.anteriorimgConversa = 'img/badges/Categorias/Conversa/1.1.png';
        $scope.proximoConversa = 4;
        $scope.proximoimgConversa = 'img/badges/Categorias/Conversa/1.3.png';
        document.getElementById("Conversa").src="img/badges/Categorias/Conversa/1.2.png"
      }
      if(badges.length == 4 || badges.length == 5){
        $scope.anteriorimgConversa = 'img/badges/Categorias/Conversa/1.2.png';
        $scope.proximoConversa = 6;
        $scope.proximoimgConversa = 'img/badges/Categorias/Conversa/2.png';
        document.getElementById("Conversa").src="img/badges/Categorias/Conversa/1.3.png"
      }

      if(badges.length == 6 || badges.length == 7){
        $scope.anteriorimgConversa = 'img/badges/Categorias/Conversa/1.3.png';
        $scope.proximoConversa = 8;
        $scope.proximoimgConversa = 'img/badges/Categorias/Conversa/2.1.png';
        document.getElementById("Conversa").src="img/badges/Categorias/Conversa/2.png"
      }
      if(badges.length == 8 || badges.length == 9){
        $scope.anteriorimgConversa = 'img/badges/Categorias/Conversa/2.png';
        $scope.proximoConversa = 10;
        $scope.proximoimgConversa = 'img/badges/Categorias/Conversa/2.2.png';
        document.getElementById("Conversa").src="img/badges/Categorias/Conversa/2.1.png"
      }
      if(badges.length == 10 || badges.length == 11){
        $scope.anteriorimgConversa = 'img/badges/Categorias/Conversa/2.1.png';
        $scope.proximoConversa = 12;
        $scope.proximoimgConversa = 'img/badges/Categorias/Conversa/2.3.png';
        document.getElementById("Conversa").src="img/badges/Categorias/Conversa/2.2.png"
      }
      if(badges.length == 12 || badges.length == 13 || badges.length == 14){
        $scope.anteriorimgConversa = 'img/badges/Categorias/Conversa/2.2.png';
        $scope.proximoConversa = 15;
        $scope.proximoimgConversa = 'img/badges/Categorias/Conversa/3.png';
        document.getElementById("Conversa").src="img/badges/Categorias/Conversa/2.3.png"
      }

      if(badges.length >= 15 && badges.length < 20 ){
        $scope.anteriorimgConversa = 'img/badges/Categorias/Conversa/2.3.png';
        $scope.proximoConversa = 20;
        $scope.proximoimgConversa = 'img/badges/Categorias/Conversa/3.1.png';
        document.getElementById("Conversa").src="img/badges/Categorias/Conversa/3.png"
      }
      if(badges.length >= 20 && badges.length < 22 ){
        $scope.anteriorimgConversa = 'img/badges/Categorias/Conversa/3.png';
        $scope.proximoConversa = 25;
        $scope.proximoimgConversa = 'img/badges/Categorias/Conversa/3.2.png';
        document.getElementById("Conversa").src="img/badges/Categorias/Conversa/3.1.png"
      }
      if(badges.length >= 25 && badges.length < 30 ){
        $scope.anteriorimgConversa = 'img/badges/Categorias/Conversa/3.1.png';
        $scope.proximoConversa = 30;
        $scope.proximoimgConversa = 'img/badges/Categorias/Conversa/3.3.png';
        document.getElementById("Conversa").src="img/badges/Categorias/Conversa/3.2.png"
      }
      if(badges.length >= 30 && badges.length < 50 ){
        $scope.anteriorimgConversa = 'img/badges/Categorias/Conversa/3.2.png';
        $scope.proximoConversa = 50;
        $scope.proximoimgConversa = 'img/badges/Categorias/Conversa/Super.png';
        document.getElementById("Conversa").src="img/badges/Categorias/Conversa/3.3.png"
      }

      if(badges.length >= 50){
        $scope.anteriorimgConversa = 'img/badges/Categorias/Conversa/3.3.png';
        $scope.proximoConversa = 10000;
        $scope.proximoimgConversa = 'img/badges/Categorias/Conversa/Super.png';
        document.getElementById("Conversa").src="img/badges/Categorias/Conversa/Super.png"
      }

    }else{
      $scope.auxnbadgeConversa = 0;

        $scope.anteriorimgConversa = 'img/badges/Categorias/Conversa/0.png';
        $scope.proximoConversa = 1;
        $scope.proximoimgConversa = 'img/badges/Categorias/Conversa/1.png';
      document.getElementById("Conversa").src="img/badges/Categorias/Conversa/0.png"
    }
  });

  $scope.aux.tag = "#Dança";
  $scope.auxnbadgeDanca = 0;
  $scope.proximoDanca = 0;
  $scope.proximoimgDanca = '';
  $scope.anteriorimgDanca = '';
  EventoService.getbadges($scope.aux).then(function(badges){
    console.log("badges", badges);
    if(badges!="Error" && badges !="E"){
      $scope.auxnbadgeDanca = badges.length;
      if(badges.length == 0){
        $scope.anteriorimgDanca = 'img/badges/Categorias/Danca/0.png';
        $scope.proximoDanca = 1;
        $scope.proximoimgDanca = 'img/badges/Categorias/Danca/1.png';
        document.getElementById("Danca").src="img/badges/Categorias/Danca/0.png"
      }
      if(badges.length == 1){
        $scope.anteriorimgDanca = 'img/badges/Categorias/Danca/0.png';
        $scope.proximoDanca = 2;
        $scope.proximoimgDanca = 'img/badges/Categorias/Danca/1.1.png';
        document.getElementById("Danca").src="img/badges/Categorias/Danca/1.png"
      }
      if(badges.length == 2){
        $scope.anteriorimgDanca = 'img/badges/Categorias/Danca/1.png';
        $scope.proximoDanca = 3;
        $scope.proximoimgDanca = 'img/badges/Categorias/Danca/1.2.png';
        document.getElementById("Danca").src="img/badges/Categorias/Danca/1.1.png"
      }
      if(badges.length == 3){
        $scope.anteriorimgDanca = 'img/badges/Categorias/Danca/1.1.png';
        $scope.proximoDanca = 4;
        $scope.proximoimgDanca = 'img/badges/Categorias/Danca/1.3.png';
        document.getElementById("Danca").src="img/badges/Categorias/Danca/1.2.png"
      }
      if(badges.length == 4 || badges.length == 5){
        $scope.anteriorimgDanca = 'img/badges/Categorias/Danca/1.2.png';
        $scope.proximoDanca = 6;
        $scope.proximoimgDanca = 'img/badges/Categorias/Danca/2.png';
        document.getElementById("Danca").src="img/badges/Categorias/Danca/1.3.png"
      }

      if(badges.length == 6 || badges.length == 7){
        $scope.anteriorimgDanca = 'img/badges/Categorias/Danca/1.3.png';
        $scope.proximoDanca = 8;
        $scope.proximoimgDanca = 'img/badges/Categorias/Danca/2.1.png';
        document.getElementById("Danca").src="img/badges/Categorias/Danca/2.png"
      }
      if(badges.length == 8 || badges.length == 9){
        $scope.anteriorimgDanca = 'img/badges/Categorias/Danca/2.png';
        $scope.proximoDanca = 10;
        $scope.proximoimgDanca = 'img/badges/Categorias/Danca/2.2.png';
        document.getElementById("Danca").src="img/badges/Categorias/Danca/2.1.png"
      }
      if(badges.length == 10 || badges.length == 11){
        $scope.anteriorimgDanca = 'img/badges/Categorias/Danca/2.1.png';
        $scope.proximoDanca = 12;
        $scope.proximoimgDanca = 'img/badges/Categorias/Danca/2.3.png';
        document.getElementById("Danca").src="img/badges/Categorias/Danca/2.2.png"
      }
      if(badges.length == 12 || badges.length == 13 || badges.length == 14){
        $scope.anteriorimgDanca = 'img/badges/Categorias/Danca/2.2.png';
        $scope.proximoDanca = 15;
        $scope.proximoimgDanca = 'img/badges/Categorias/Danca/3.png';
        document.getElementById("Danca").src="img/badges/Categorias/Danca/2.3.png"
      }

      if(badges.length >= 15 && badges.length < 20 ){
        $scope.anteriorimgDanca = 'img/badges/Categorias/Danca/2.3.png';
        $scope.proximoDanca = 20;
        $scope.proximoimgDanca = 'img/badges/Categorias/Danca/3.png';
        document.getElementById("Danca").src="img/badges/Categorias/Danca/3.png"
      }
      if(badges.length >= 20 && badges.length < 22 ){
        $scope.anteriorimgDanca = 'img/badges/Categorias/Danca/3.png';
        $scope.proximoDanca = 25;
        $scope.proximoimgDanca = 'img/badges/Categorias/Danca/3.2.png';
        document.getElementById("Danca").src="img/badges/Categorias/Danca/3.1.png"
      }
      if(badges.length >= 25 && badges.length < 30 ){
        $scope.anteriorimgDanca = 'img/badges/Categorias/Danca/3.1.png';
        $scope.proximoDanca = 30;
        $scope.proximoimgDanca = 'img/badges/Categorias/Danca/3.3.png';
        document.getElementById("Danca").src="img/badges/Categorias/Danca/3.2.png"
      }
      if(badges.length >= 30 && badges.length < 50 ){
        $scope.anteriorimgDanca = 'img/badges/Categorias/Danca/3.2.png';
        $scope.proximoDanca = 50;
        $scope.proximoimgDanca = 'img/badges/Categorias/Danca/Super.png';
        document.getElementById("Danca").src="img/badges/Categorias/Danca/3.3.png"
      }

      if(badges.length >= 50){
        $scope.anteriorimgDanca = 'img/badges/Categorias/Danca/3.3.png';
        $scope.proximoDanca = 10000;
        $scope.proximoimgDanca = 'img/badges/Categorias/Danca/Super.png';
        document.getElementById("Danca").src="img/badges/Categorias/Danca/Super.png"
      }

    }else{
      $scope.auxnbadgeDanca = 0;
        $scope.anteriorimgDanca = 'img/badges/Categorias/Danca/0.png';
        $scope.proximoDanca = 1;
        $scope.proximoimgDanca = 'img/badges/Categorias/Danca/1.png';
      document.getElementById("Danca").src="img/badges/Categorias/Danca/0.png"
    }
  });

  $scope.aux.tag = "#EsportesdePraia";
  $scope.auxnbadgeEsportesdePraia = 0;
  $scope.proximoEsportesdePraia = 0;
  $scope.proximoimgEsportesdePraia = '';
  $scope.anteriorimgEsportesdePraia = '';
  EventoService.getbadges($scope.aux).then(function(badges){
    console.log("badges", badges);
    if(badges!="Error" && badges !="E"){
      $scope.auxnbadgeEsportesdePraia = badges.length;
      if(badges.length == 0){
        $scope.anteriorimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/0.png';
        $scope.proximoEsportesdePraia = 1;
        $scope.proximoimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/1.png';
        document.getElementById("EsportesdePraia").src="img/badges/Categorias/EsportesdePraia/0.png"
      }
      if(badges.length == 1){
        $scope.anteriorimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/0.png';
        $scope.proximoEsportesdePraia = 2;
        $scope.proximoimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/1.1.png';
        document.getElementById("EsportesdePraia").src="img/badges/Categorias/EsportesdePraia/1.png"
      }
      if(badges.length == 2){
        $scope.anteriorimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/1.png';
        $scope.proximoEsportesdePraia = 3;
        $scope.proximoimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/1.2.png';
        document.getElementById("EsportesdePraia").src="img/badges/Categorias/EsportesdePraia/1.1.png"
      }
      if(badges.length == 3){
        $scope.anteriorimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/1.1.png';
        $scope.proximoEsportesdePraia = 4;
        $scope.proximoimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/1.3.png';
        document.getElementById("EsportesdePraia").src="img/badges/Categorias/EsportesdePraia/1.2.png"
      }
      if(badges.length == 4 || badges.length == 5){
        $scope.anteriorimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/1.2.png';
        $scope.proximoEsportesdePraia = 6;
        $scope.proximoimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/2.png';
        document.getElementById("EsportesdePraia").src="img/badges/Categorias/EsportesdePraia/1.3.png"
      }

      if(badges.length == 6 || badges.length == 7){
        $scope.anteriorimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/1.3.png';
        $scope.proximoEsportesdePraia = 8;
        $scope.proximoimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/2.1.png';
        document.getElementById("EsportesdePraia").src="img/badges/Categorias/EsportesdePraia/2.png"
      }
      if(badges.length == 8 || badges.length == 9){
        $scope.anteriorimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/2.png';
        $scope.proximoEsportesdePraia = 10;
        $scope.proximoimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/2.2.png';
        document.getElementById("EsportesdePraia").src="img/badges/Categorias/EsportesdePraia/2.1.png"
      }
      if(badges.length == 10 || badges.length == 11){
        $scope.anteriorimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/2.1.png';
        $scope.proximoEsportesdePraia = 12;
        $scope.proximoimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/2.3.png';
        document.getElementById("EsportesdePraia").src="img/badges/Categorias/EsportesdePraia/2.2.png"
      }
      if(badges.length == 12 || badges.length == 13 || badges.length == 14){
        $scope.anteriorimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/2.2.png';
        $scope.proximoEsportesdePraia = 15;
        $scope.proximoimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/3.png';
        document.getElementById("EsportesdePraia").src="img/badges/Categorias/EsportesdePraia/2.3.png"
      }

      if(badges.length >= 15 && badges.length < 20 ){
        $scope.anteriorimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/2.3.png';
        $scope.proximoEsportesdePraia = 20;
        $scope.proximoimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/3.1.png';
        document.getElementById("EsportesdePraia").src="img/badges/Categorias/EsportesdePraia/3.png"
      }
      if(badges.length >= 20 && badges.length < 22 ){
        $scope.anteriorimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/3.png';
        $scope.proximoEsportesdePraia = 25;
        $scope.proximoimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/3.2.png';
        document.getElementById("EsportesdePraia").src="img/badges/Categorias/EsportesdePraia/3.1.png"
      }
      if(badges.length >= 25 && badges.length < 30 ){
        $scope.anteriorimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/3.1.png';
        $scope.proximoEsportesdePraia = 30;
        $scope.proximoimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/1.png';
        document.getElementById("EsportesdePraia").src="img/badges/Categorias/EsportesdePraia/3.2.png"
      }
      if(badges.length >= 30 && badges.length < 50 ){
        $scope.anteriorimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/3.2.png';
        $scope.proximoEsportesdePraia = 50;
        $scope.proximoimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/Super.png';
        document.getElementById("EsportesdePraia").src="img/badges/Categorias/EsportesdePraia/3.3.png"
      }

      if(badges.length >= 50){
        $scope.anteriorimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/3.3.png';
        $scope.proximoEsportesdePraia = 10000;
        $scope.proximoimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/Super.png';
        document.getElementById("EsportesdePraia").src="img/badges/Categorias/EsportesdePraia/Super.png"
      }

    }else{
      $scope.auxnbadgeEsportesdePraia = 0;
        $scope.anteriorimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/0.png';
        $scope.proximoEsportesdePraia = 1;
        $scope.proximoimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/1.png';
      document.getElementById("EsportesdePraia").src="img/badges/Categorias/EsportesdePraia/0.png"
    }
  });

  $scope.aux.tag = "#FestaseBaladas";
  $scope.auxnbadgeFestaseBaladas = 0;
  $scope.proximoFestaseBaladas = 0;
  $scope.proximoimgFestaseBaladas = '';
  $scope.anteriorimgFestaseBaladas = '';
  EventoService.getbadges($scope.aux).then(function(badges){
    console.log("badges", badges);
    if(badges!="Error" && badges !="E"){
      $scope.auxnbadgeFestaseBaladas = badges.length;
      if(badges.length == 0){
        $scope.anteriorimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/0.png';
        $scope.proximoFestaseBaladas = 1;
        $scope.proximoimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/1.png';
        document.getElementById("FestaseBaladas").src="img/badges/Categorias/FestaseBaladas/0.png"
      }
      if(badges.length == 1){
        $scope.anteriorimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/0.png';
        $scope.proximoFestaseBaladas = 2;
        $scope.proximoimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/1.1.png';
        document.getElementById("FestaseBaladas").src="img/badges/Categorias/FestaseBaladas/1.png"
      }
      if(badges.length == 2){
        $scope.anteriorimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/1.png';
        $scope.proximoFestaseBaladas = 3;
        $scope.proximoimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/1.2.png';
        document.getElementById("FestaseBaladas").src="img/badges/Categorias/FestaseBaladas/1.1.png"
      }
      if(badges.length == 3){
        $scope.anteriorimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/1.1.png';
        $scope.proximoFestaseBaladas = 4;
        $scope.proximoimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/1.3.png';
        document.getElementById("FestaseBaladas").src="img/badges/Categorias/FestaseBaladas/1.2.png"
      }
      if(badges.length == 4 || badges.length == 5){
        $scope.anteriorimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/1.2.png';
        $scope.proximoFestaseBaladas = 6;
        $scope.proximoimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/2.png';
        document.getElementById("FestaseBaladas").src="img/badges/Categorias/FestaseBaladas/1.3.png"
      }

      if(badges.length == 6 || badges.length == 7){
        $scope.anteriorimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/1.3.png';
        $scope.proximoFestaseBaladas = 8;
        $scope.proximoimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/2.1.png';
        document.getElementById("FestaseBaladas").src="img/badges/Categorias/FestaseBaladas/2.png"
      }
      if(badges.length == 8 || badges.length == 9){
        $scope.anteriorimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/2.png';
        $scope.proximoFestaseBaladas = 10;
        $scope.proximoimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/2.2.png';
        document.getElementById("FestaseBaladas").src="img/badges/Categorias/FestaseBaladas/2.1.png"
      }
      if(badges.length == 10 || badges.length == 11){
        $scope.anteriorimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/2.1.png';
        $scope.proximoFestaseBaladas = 12;
        $scope.proximoimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/2.3.png';
        document.getElementById("FestaseBaladas").src="img/badges/Categorias/FestaseBaladas/2.2.png"
      }
      if(badges.length == 12 || badges.length == 13 || badges.length == 14){
        $scope.anteriorimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/2.2.png';
        $scope.proximoFestaseBaladas = 15;
        $scope.proximoimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/3.png';
        document.getElementById("FestaseBaladas").src="img/badges/Categorias/FestaseBaladas/2.3.png"
      }

      if(badges.length >= 15 && badges.length < 20 ){
        $scope.anteriorimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/2.3.png';
        $scope.proximoFestaseBaladas = 20;
        $scope.proximoimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/3.1.png';
        document.getElementById("FestaseBaladas").src="img/badges/Categorias/FestaseBaladas/3.png"
      }
      if(badges.length >= 20 && badges.length < 22 ){
        $scope.anteriorimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/3.png';
        $scope.proximoFestaseBaladas = 25;
        $scope.proximoimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/3.2.png';
        document.getElementById("FestaseBaladas").src="img/badges/Categorias/FestaseBaladas/3.1.png"
      }
      if(badges.length >= 25 && badges.length < 30 ){
        $scope.anteriorimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/3.1.png';
        $scope.proximoFestaseBaladas = 30;
        $scope.proximoimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/3.3.png';
        document.getElementById("FestaseBaladas").src="img/badges/Categorias/FestaseBaladas/3.2.png"
      }
      if(badges.length >= 30 && badges.length < 50 ){
        $scope.anteriorimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/3.2.png';
        $scope.proximoFestaseBaladas = 50;
        $scope.proximoimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/Super.png';
        document.getElementById("FestaseBaladas").src="img/badges/Categorias/FestaseBaladas/3.3.png"
      }

      if(badges.length >= 50){
        $scope.anteriorimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/3.3.png';
        $scope.proximoFestaseBaladas = 10000;
        $scope.proximoimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/Super.png';
        document.getElementById("FestaseBaladas").src="img/badges/Categorias/FestaseBaladas/Super.png"
      }

    }else{
      $scope.auxnbadgeFestaseBaladas = 0;
        $scope.anteriorimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/0.png';
        $scope.proximoFestaseBaladas = 1;
        $scope.proximoimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/1.png';
      document.getElementById("FestaseBaladas").src="img/badges/Categorias/FestaseBaladas/0.png"
    }
  });

  $scope.aux.tag = "#Futebol";
  $scope.auxnbadgeFutebol = 0;
  $scope.proximoFutebol = 0;
  $scope.proximoimgFutebol = '';
  $scope.anteriorimgFutebol = '';
  EventoService.getbadges($scope.aux).then(function(badges){
    console.log("badges", badges);
    if(badges!="Error" && badges !="E"){
      $scope.auxnbadgeFutebol = badges.length;
      if(badges.length == 0){
        $scope.anteriorimgFutebol = 'img/badges/Categorias/Futebol/0.png';
        $scope.proximoFutebol = 1;
        $scope.proximoimgFutebol = 'img/badges/Categorias/Futebol/1.png';
        document.getElementById("Futebol").src="img/badges/Categorias/Futebol/0.png"
      }
      if(badges.length == 1){
        $scope.anteriorimgFutebol = 'img/badges/Categorias/Futebol/0.png';
        $scope.proximoFutebol = 2;
        $scope.proximoimgFutebol = 'img/badges/Categorias/Futebol/1.1.png';
        document.getElementById("Futebol").src="img/badges/Categorias/Futebol/1.png"
      }
      if(badges.length == 2){
        $scope.anteriorimgFutebol = 'img/badges/Categorias/Futebol/1.png';
        $scope.proximoFutebol = 3;
        $scope.proximoimgFutebol = 'img/badges/Categorias/Futebol/1.2.png';
        document.getElementById("Futebol").src="img/badges/Categorias/Futebol/1.1.png"
      }
      if(badges.length == 3){
        $scope.anteriorimgFutebol = 'img/badges/Categorias/Futebol/1.1.png';
        $scope.proximoFutebol = 4;
        $scope.proximoimgFutebol = 'img/badges/Categorias/Futebol/1.3.png';
        document.getElementById("Futebol").src="img/badges/Categorias/Futebol/1.2.png"
      }
      if(badges.length == 4 || badges.length == 5){
        $scope.anteriorimgFutebol = 'img/badges/Categorias/Futebol/1.2.png';
        $scope.proximoFutebol = 6;
        $scope.proximoimgFutebol = 'img/badges/Categorias/Futebol/2.png';
        document.getElementById("Futebol").src="img/badges/Categorias/Futebol/1.3.png"
      }

      if(badges.length == 6 || badges.length == 7){
        $scope.anteriorimgFutebol = 'img/badges/Categorias/Futebol/1.3.png';
        $scope.proximoFutebol = 8;
        $scope.proximoimgFutebol = 'img/badges/Categorias/Futebol/2.1.png';
        document.getElementById("Futebol").src="img/badges/Categorias/Futebol/2.png"
      }
      if(badges.length == 8 || badges.length == 9){
        $scope.anteriorimgFutebol = 'img/badges/Categorias/Futebol/2.png';
        $scope.proximoFutebol = 10;
        $scope.proximoimgFutebol = 'img/badges/Categorias/Futebol/2.2.png';
        document.getElementById("Futebol").src="img/badges/Categorias/Futebol/2.1.png"
      }
      if(badges.length == 10 || badges.length == 11){
        $scope.anteriorimgFutebol = 'img/badges/Categorias/Futebol/2.1.png';
        $scope.proximoFutebol = 12;
        $scope.proximoimgFutebol = 'img/badges/Categorias/Futebol/2.3.png';
        document.getElementById("Futebol").src="img/badges/Categorias/Futebol/2.2.png"
      }
      if(badges.length == 12 || badges.length == 13 || badges.length == 14){
        $scope.anteriorimgFutebol = 'img/badges/Categorias/Futebol/2.2.png';
        $scope.proximoFutebol = 15;
        $scope.proximoimgFutebol = 'img/badges/Categorias/Futebol/3.png';
        document.getElementById("Futebol").src="img/badges/Categorias/Futebol/2.3.png"
      }

      if(badges.length >= 15 && badges.length < 20 ){
        $scope.anteriorimgFutebol = 'img/badges/Categorias/Futebol/2.3.png';
        $scope.proximoFutebol = 20;
        $scope.proximoimgFutebol = 'img/badges/Categorias/Futebol/3.1.png';
        document.getElementById("Futebol").src="img/badges/Categorias/Futebol/3.png"
      }
      if(badges.length >= 20 && badges.length < 22 ){
        $scope.anteriorimgFutebol = 'img/badges/Categorias/Futebol/3.png';
        $scope.proximoFutebol = 25;
        $scope.proximoimgFutebol = 'img/badges/Categorias/Futebol/3.2.png';
        document.getElementById("Futebol").src="img/badges/Categorias/Futebol/3.1.png"
      }
      if(badges.length >= 25 && badges.length < 30 ){
        $scope.anteriorimgFutebol = 'img/badges/Categorias/Futebol/3.1.png';
        $scope.proximoFutebol = 30;
        $scope.proximoimgFutebol = 'img/badges/Categorias/Futebol/3.3.png';
        document.getElementById("Futebol").src="img/badges/Categorias/Futebol/3.2.png"
      }
      if(badges.length >= 30 && badges.length < 50 ){
        $scope.anteriorimgFutebol = 'img/badges/Categorias/Futebol/3.2.png';
        $scope.proximoFutebol = 50;
        $scope.proximoimgFutebol = 'img/badges/Categorias/Futebol/Super.png';
        document.getElementById("Futebol").src="img/badges/Categorias/Futebol/3.3.png"
      }

      if(badges.length >= 50){
        $scope.anteriorimgFutebol = 'img/badges/Categorias/Futebol/3.3.png';
        $scope.proximoFutebol = 10000;
        $scope.proximoimgFutebol = 'img/badges/Categorias/Futebol/Super.png';
        document.getElementById("Futebol").src="img/badges/Categorias/Futebol/Super.png"
      }

    }else{
      $scope.auxnbadgeFutebol = 0;

        $scope.anteriorimgFutebol = 'img/badges/Categorias/Futebol/0.png';
        $scope.proximoFutebol = 1;
        $scope.proximoimgFutebol = 'img/badges/Categorias/Futebol/1.png';
      document.getElementById("Futebol").src="img/badges/Categorias/Futebol/0.png"
    }
  });

  $scope.aux.tag = "#GrupodeEstudos";
  $scope.auxnbadgeGrupodeEstudos = 0;
  $scope.proximoGrupodeEstudos = 0;
  $scope.proximoimgGrupodeEstudos = '';
  $scope.anteriorimgGrupodeEstudos = '';
  EventoService.getbadges($scope.aux).then(function(badges){
    console.log("badges", badges);
    if(badges!="Error" && badges !="E"){
      $scope.auxnbadgeGrupodeEstudos = badges.length;
      if(badges.length == 0){
        $scope.anteriorimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/0.png';
        $scope.proximoGrupodeEstudos = 1;
        $scope.proximoimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/1.png';
        document.getElementById("GrupodeEstudos").src="img/badges/Categorias/GrupodeEstudos/0.png"
      }
      if(badges.length == 1){
        $scope.anteriorimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/0.png';
        $scope.proximoGrupodeEstudos = 2;
        $scope.proximoimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/1.1.png';
        document.getElementById("GrupodeEstudos").src="img/badges/Categorias/GrupodeEstudos/1.png"
      }
      if(badges.length == 2){
        $scope.anteriorimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/1.png';
        $scope.proximoGrupodeEstudos = 3;
        $scope.proximoimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/1.2.png';
        document.getElementById("GrupodeEstudos").src="img/badges/Categorias/GrupodeEstudos/1.1.png"
      }
      if(badges.length == 3){
        $scope.anteriorimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/1.1.png';
        $scope.proximoGrupodeEstudos = 4;
        $scope.proximoimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/1.3.png';
        document.getElementById("GrupodeEstudos").src="img/badges/Categorias/GrupodeEstudos/1.2.png"
      }
      if(badges.length == 4 || badges.length == 5){
        $scope.anteriorimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/1.2.png';
        $scope.proximoGrupodeEstudos = 6;
        $scope.proximoimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/2.png';
        document.getElementById("GrupodeEstudos").src="img/badges/Categorias/GrupodeEstudos/1.3.png"
      }

      if(badges.length == 6 || badges.length == 7){
        $scope.anteriorimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/1.3.png';
        $scope.proximoGrupodeEstudos = 8;
        $scope.proximoimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/2.1.png';
        document.getElementById("GrupodeEstudos").src="img/badges/Categorias/GrupodeEstudos/2.png"
      }
      if(badges.length == 8 || badges.length == 9){
        $scope.anteriorimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/2.png';
        $scope.proximoGrupodeEstudos = 10;
        $scope.proximoimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/2.2.png';
        document.getElementById("GrupodeEstudos").src="img/badges/Categorias/GrupodeEstudos/2.1.png"
      }
      if(badges.length == 10 || badges.length == 11){
        $scope.anteriorimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/2.1.png';
        $scope.proximoGrupodeEstudos = 12;
        $scope.proximoimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/2.3.png';
        document.getElementById("GrupodeEstudos").src="img/badges/Categorias/GrupodeEstudos/2.2.png"
      }
      if(badges.length == 12 || badges.length == 13 || badges.length == 14){
        $scope.anteriorimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/2.2.png';
        $scope.proximoGrupodeEstudos = 15;
        $scope.proximoimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/3.png';
        document.getElementById("GrupodeEstudos").src="img/badges/Categorias/GrupodeEstudos/2.3.png"
      }

      if(badges.length >= 15 && badges.length < 20 ){
        $scope.anteriorimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/2.3.png';
        $scope.proximoGrupodeEstudos = 20;
        $scope.proximoimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/3.1.png';
        document.getElementById("GrupodeEstudos").src="img/badges/Categorias/GrupodeEstudos/3.png"
      }
      if(badges.length >= 20 && badges.length < 22 ){
        $scope.anteriorimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/3.png';
        $scope.proximoGrupodeEstudos = 25;
        $scope.proximoimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/3.2.png';
        document.getElementById("GrupodeEstudos").src="img/badges/Categorias/GrupodeEstudos/3.1.png"
      }
      if(badges.length >= 25 && badges.length < 30 ){
        $scope.anteriorimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/3.1.png';
        $scope.proximoGrupodeEstudos = 30;
        $scope.proximoimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/3.3.png';
        document.getElementById("GrupodeEstudos").src="img/badges/Categorias/GrupodeEstudos/3.2.png"
      }
      if(badges.length >= 30 && badges.length < 50 ){
        $scope.anteriorimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/3.2.png';
        $scope.proximoGrupodeEstudos = 50;
        $scope.proximoimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/Super.png';
        document.getElementById("GrupodeEstudos").src="img/badges/Categorias/GrupodeEstudos/3.3.png"
      }

      if(badges.length >= 50){
        $scope.anteriorimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/3.3.png';
        $scope.proximoGrupodeEstudos = 10000;
        $scope.proximoimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/Super.png';
        document.getElementById("GrupodeEstudos").src="img/badges/Categorias/GrupodeEstudos/Super.png"
      }

    }else{
      $scope.auxnbadgeGrupodeEstudos = 0;
        $scope.anteriorimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/0.png';
        $scope.proximoGrupodeEstudos = 1;
        $scope.proximoimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/1.png';
      document.getElementById("GrupodeEstudos").src="img/badges/Categorias/GrupodeEstudos/0.png"
    }
  });

  $scope.aux.tag = "#Jogos";
  $scope.auxnbadgeJogos = 0;
  $scope.proximoJogos = 0;
  $scope.proximoimgJogos = '';
  $scope.anteriorimgJogos = '';
  EventoService.getbadges($scope.aux).then(function(badges){
    //console.log("badges", badges);
    if(badges!="Error" && badges !="E"){
      $scope.auxnbadgeJogos = badges.length;
      if(badges.length == 0){
        $scope.anteriorimgJogos = 'img/badges/Categorias/Jogos/0.png';
        $scope.proximoJogos = 1;
        $scope.proximoimgJogos = 'img/badges/Categorias/Jogos/1.png';
        document.getElementById("Jogos").src="img/badges/Categorias/Jogos/0.png"
      }
      if(badges.length == 1){
        $scope.anteriorimgJogos = 'img/badges/Categorias/Jogos/0.png';
        $scope.proximoJogos = 2;
        $scope.proximoimgJogos = 'img/badges/Categorias/Jogos/1.1.png';
        document.getElementById("Jogos").src="img/badges/Categorias/Jogos/1.png"
      }
      if(badges.length == 2){
        $scope.anteriorimgJogos = 'img/badges/Categorias/Jogos/1.png';
        $scope.proximoJogos = 3;
        $scope.proximoimgJogos = 'img/badges/Categorias/Jogos/1.2.png';
        document.getElementById("Jogos").src="img/badges/Categorias/Jogos/1.1.png"
      }
      if(badges.length == 3){
        $scope.anteriorimgJogos = 'img/badges/Categorias/Jogos/1.1.png';
        $scope.proximoJogos = 4;
        $scope.proximoimgJogos = 'img/badges/Categorias/Jogos/1.3.png';
        document.getElementById("Jogos").src="img/badges/Categorias/Jogos/1.2.png"
      }
      if(badges.length == 4 || badges.length == 5){
        $scope.anteriorimgJogos = 'img/badges/Categorias/Jogos/1.2.png';
        $scope.proximoJogos = 6;
        $scope.proximoimgJogos = 'img/badges/Categorias/Jogos/2.png';
        document.getElementById("Jogos").src="img/badges/Categorias/Jogos/1.3.png"
      }

      if(badges.length == 6 || badges.length == 7){
        $scope.anteriorimgJogos = 'img/badges/Categorias/Jogos/1.3.png';
        $scope.proximoJogos = 8;
        $scope.proximoimgJogos = 'img/badges/Categorias/Jogos/2.1.png';
        document.getElementById("Jogos").src="img/badges/Categorias/Jogos/2.png"
      }
      if(badges.length == 8 || badges.length == 9){
        $scope.anteriorimgJogos = 'img/badges/Categorias/Jogos/2.png';
        $scope.proximoJogos = 10;
        $scope.proximoimgJogos = 'img/badges/Categorias/Jogos/2.2.png';
        document.getElementById("Jogos").src="img/badges/Categorias/Jogos/2.1.png"
      }
      if(badges.length == 10 || badges.length == 11){
        $scope.anteriorimgJogos = 'img/badges/Categorias/Jogos/2.1.png';
        $scope.proximoJogos = 12;
        $scope.proximoimgJogos = 'img/badges/Categorias/Jogos/2.3.png';
        document.getElementById("Jogos").src="img/badges/Categorias/Jogos/2.2.png"
      }
      if(badges.length == 12 || badges.length == 13 || badges.length == 14){
        $scope.anteriorimgJogos = 'img/badges/Categorias/Jogos/2.2.png';
        $scope.proximoJogos = 15;
        $scope.proximoimgJogos = 'img/badges/Categorias/Jogos/3.png';
        document.getElementById("Jogos").src="img/badges/Categorias/Jogos/2.3.png"
      }

      if(badges.length >= 15 && badges.length < 20 ){
        $scope.anteriorimgJogos = 'img/badges/Categorias/Jogos/2.3.png';
        $scope.proximoJogos = 20;
        $scope.proximoimgJogos = 'img/badges/Categorias/Jogos/3.1.png';
        document.getElementById("Jogos").src="img/badges/Categorias/Jogos/3.png"
      }
      if(badges.length >= 20 && badges.length < 22 ){
        $scope.anteriorimgJogos = 'img/badges/Categorias/Jogos/3.png';
        $scope.proximoJogos = 25;
        $scope.proximoimgJogos = 'img/badges/Categorias/Jogos/3.2.png';
        document.getElementById("Jogos").src="img/badges/Categorias/Jogos/3.1.png"
      }
      if(badges.length >= 25 && badges.length < 30 ){
        $scope.anteriorimgJogos = 'img/badges/Categorias/Jogos/3.1.png';
        $scope.proximoJogos = 30;
        $scope.proximoimgJogos = 'img/badges/Categorias/Jogos/3.3.png';
        document.getElementById("Jogos").src="img/badges/Categorias/Jogos/3.2.png"
      }
      if(badges.length >= 30 && badges.length < 50 ){
        $scope.anteriorimgJogos = 'img/badges/Categorias/Jogos/3.2.png';
        $scope.proximoJogos = 50;
        $scope.proximoimgJogos = 'img/badges/Categorias/Jogos/Super.png';
        document.getElementById("Jogos").src="img/badges/Categorias/Jogos/3.3.png"
      }

      if(badges.length >= 50){
        $scope.anteriorimgJogos = 'img/badges/Categorias/Jogos/3.3.png';
        $scope.proximoJogos = 10000;
        $scope.proximoimgJogos = 'img/badges/Categorias/Jogos/Super.png';
        document.getElementById("Jogos").src="img/badges/Categorias/Jogos/Super.png"
      }

    }else{
      $scope.auxnbadgeJogos = 0;
        $scope.anteriorimgJogos = 'img/badges/Categorias/Jogos/0.png';
        $scope.proximoJogos = 1;
        $scope.proximoimgJogos = 'img/badges/Categorias/Jogos/1.png';
      document.getElementById("Jogos").src="img/badges/Categorias/Jogos/0.png"
    }
  });

  $scope.aux.tag = "#Musica";
  $scope.auxnbadgeMusica = 0;
  $scope.proximoMusica = 0;
  $scope.proximoimgMusica = '';
  $scope.anteriorimgMusica = '';
  EventoService.getbadges($scope.aux).then(function(badges){
    //console.log("badges", badges);
    if(badges!="Error" && badges !="E"){
      $scope.auxnbadgeMusica = badges.length;
      if(badges.length == 0){
        $scope.anteriorimgMusica = 'img/badges/Categorias/Musica/0.png';
        $scope.proximoMusica = 1;
        $scope.proximoimgMusica = 'img/badges/Categorias/Musica/1.png';
        document.getElementById("Musica").src="img/badges/Categorias/Musica/0.png"
      }
      if(badges.length == 1){
        $scope.anteriorimgMusica = 'img/badges/Categorias/Musica/0.png';
        $scope.proximoMusica = 2;
        $scope.proximoimgMusica = 'img/badges/Categorias/Musica/1.1.png';
        document.getElementById("Musica").src="img/badges/Categorias/Musica/1.png"
      }
      if(badges.length == 2){
        $scope.anteriorimgMusica = 'img/badges/Categorias/Musica/1.png';
        $scope.proximoMusica = 3;
        $scope.proximoimgMusica = 'img/badges/Categorias/Musica/1.2.png';
        document.getElementById("Musica").src="img/badges/Categorias/Musica/1.1.png"
      }
      if(badges.length == 3){
        $scope.anteriorimgMusica = 'img/badges/Categorias/Musica/1.1.png';
        $scope.proximoMusica = 4;
        $scope.proximoimgMusica = 'img/badges/Categorias/Musica/1.3.png';
        document.getElementById("Musica").src="img/badges/Categorias/Musica/1.2.png"
      }
      if(badges.length == 4 || badges.length == 5){
        $scope.anteriorimgMusica = 'img/badges/Categorias/Musica/1.2.png';
        $scope.proximoMusica = 6;
        $scope.proximoimgMusica = 'img/badges/Categorias/Musica/2.png';
        document.getElementById("Musica").src="img/badges/Categorias/Musica/1.3.png"
      }

      if(badges.length == 6 || badges.length == 7){
        $scope.anteriorimgMusica = 'img/badges/Categorias/Musica/1.3.png';
        $scope.proximoMusica = 8;
        $scope.proximoimgMusica = 'img/badges/Categorias/Musica/2.1.png';
        document.getElementById("Musica").src="img/badges/Categorias/Musica/2.png"
      }
      if(badges.length == 8 || badges.length == 9){
        $scope.anteriorimgMusica = 'img/badges/Categorias/Musica/2.png';
        $scope.proximoMusica = 10;
        $scope.proximoimgMusica = 'img/badges/Categorias/Musica/2.2.png';
        document.getElementById("Musica").src="img/badges/Categorias/Musica/2.1.png"
      }
      if(badges.length == 10 || badges.length == 11){
        $scope.anteriorimgMusica = 'img/badges/Categorias/Musica/2.1.png';
        $scope.proximoMusica = 12;
        $scope.proximoimgMusica = 'img/badges/Categorias/Musica/2.3.png';
        document.getElementById("Musica").src="img/badges/Categorias/Musica/2.2.png"
      }
      if(badges.length == 12 || badges.length == 13 || badges.length == 14){
        $scope.anteriorimgMusica = 'img/badges/Categorias/Musica/2.2.png';
        $scope.proximoMusica = 15;
        $scope.proximoimgMusica = 'img/badges/Categorias/Musica/3.png';
        document.getElementById("Musica").src="img/badges/Categorias/Musica/2.3.png"
      }

      if(badges.length >= 15 && badges.length < 20 ){
        $scope.anteriorimgMusica = 'img/badges/Categorias/Musica/2.3.png';
        $scope.proximoMusica = 20;
        $scope.proximoimgMusica = 'img/badges/Categorias/Musica/3.1.png';
        document.getElementById("Musica").src="img/badges/Categorias/Musica/3.png"
      }
      if(badges.length >= 20 && badges.length < 22 ){
        $scope.anteriorimgMusica = 'img/badges/Categorias/Musica/3.png';
        $scope.proximoMusica = 25;
        $scope.proximoimgMusica = 'img/badges/Categorias/Musica/3.2.png';
        document.getElementById("Musica").src="img/badges/Categorias/Musica/3.1.png"
      }
      if(badges.length >= 25 && badges.length < 30 ){
        $scope.anteriorimgMusica = 'img/badges/Categorias/Musica/3.1.png';
        $scope.proximoMusica = 30;
        $scope.proximoimgMusica = 'img/badges/Categorias/Musica/3.3.png';
        document.getElementById("Musica").src="img/badges/Categorias/Musica/3.2.png"
      }
      if(badges.length >= 30 && badges.length < 50 ){
        $scope.anteriorimgMusica = 'img/badges/Categorias/Musica/3.2.png';
        $scope.proximoMusica = 50;
        $scope.proximoimgMusica = 'img/badges/Categorias/Musica/Super.png';
        document.getElementById("Musica").src="img/badges/Categorias/Musica/3.3.png"
      }

      if(badges.length >= 50){
        $scope.anteriorimgMusica = 'img/badges/Categorias/Musica/3.3.png';
        $scope.proximoMusica = 10000;
        $scope.proximoimgMusica = 'img/badges/Categorias/Musica/Super.png';
        document.getElementById("Musica").src="img/badges/Categorias/Musica/Super.png"
      }

    }else{
      $scope.auxnbadgeMusica = 0;
        $scope.anteriorimgMusica = 'img/badges/Categorias/Musica/0.png';
        $scope.proximoMusica = 1;
        $scope.proximoimgMusica = 'img/badges/Categorias/Musica/1.png';
      document.getElementById("Musica").src="img/badges/Categorias/Musica/0.png"
    }
  });

  $scope.aux.tag = "#Natureza";
  $scope.auxnbadgeNatureza = 0;
  $scope.proximoNatureza = 0;
  $scope.proximoimgNatureza = '';
  $scope.anteriorimgNatureza = '';
  EventoService.getbadges($scope.aux).then(function(badges){
    //console.log("badges", badges);
    if(badges!="Error" && badges !="E"){
      $scope.auxnbadgeNatureza = badges.length;
      if(badges.length == 0){
        $scope.anteriorimgNatureza = 'img/badges/Categorias/Natureza/0.png';
        $scope.proximoNatureza = 1;
        $scope.proximoimgNatureza = 'img/badges/Categorias/Natureza/1.png';
        document.getElementById("Natureza").src="img/badges/Categorias/Natureza/0.png"
      }
      if(badges.length == 1){
        $scope.anteriorimgNatureza = 'img/badges/Categorias/Natureza/0.png';
        $scope.proximoNatureza = 2;
        $scope.proximoimgNatureza = 'img/badges/Categorias/Natureza/1.1.png';
        document.getElementById("Natureza").src="img/badges/Categorias/Natureza/1.png"
      }
      if(badges.length == 2){
        $scope.anteriorimgNatureza = 'img/badges/Categorias/Natureza/1.png';
        $scope.proximoNatureza = 3;
        $scope.proximoimgNatureza = 'img/badges/Categorias/Natureza/1.2.png';
        document.getElementById("Natureza").src="img/badges/Categorias/Natureza/1.1.png"
      }
      if(badges.length == 3){
        $scope.anteriorimgNatureza = 'img/badges/Categorias/Natureza/1.1.png';
        $scope.proximoNatureza = 4;
        $scope.proximoimgNatureza = 'img/badges/Categorias/Natureza/1.3.png';
        document.getElementById("Natureza").src="img/badges/Categorias/Natureza/1.2.png"
      }
      if(badges.length == 4 || badges.length == 5){
        $scope.anteriorimgNatureza = 'img/badges/Categorias/Natureza/1.2.png';
        $scope.proximoNatureza = 6;
        $scope.proximoimgNatureza = 'img/badges/Categorias/Natureza/2.png';
        document.getElementById("Natureza").src="img/badges/Categorias/Natureza/1.3.png"
      }

      if(badges.length == 6 || badges.length == 7){
        $scope.anteriorimgNatureza = 'img/badges/Categorias/Natureza/1.3.png';
        $scope.proximoNatureza = 8;
        $scope.proximoimgNatureza = 'img/badges/Categorias/Natureza/2.1.png';
        document.getElementById("Natureza").src="img/badges/Categorias/Natureza/2.png"
      }
      if(badges.length == 8 || badges.length == 9){
        $scope.anteriorimgNatureza = 'img/badges/Categorias/Natureza/2.png';
        $scope.proximoNatureza = 10;
        $scope.proximoimgNatureza = 'img/badges/Categorias/Natureza/2.2.png';
        document.getElementById("Natureza").src="img/badges/Categorias/Natureza/2.1.png"
      }
      if(badges.length == 10 || badges.length == 11){
        $scope.anteriorimgNatureza = 'img/badges/Categorias/Natureza/2.1.png';
        $scope.proximoNatureza = 12;
        $scope.proximoimgNatureza = 'img/badges/Categorias/Natureza/2.3.png';
        document.getElementById("Natureza").src="img/badges/Categorias/Natureza/2.2.png"
      }
      if(badges.length == 12 || badges.length == 13 || badges.length == 14){
        $scope.anteriorimgNatureza = 'img/badges/Categorias/Natureza/2.2.png';
        $scope.proximoNatureza = 15;
        $scope.proximoimgNatureza = 'img/badges/Categorias/Natureza/3.png';
        document.getElementById("Natureza").src="img/badges/Categorias/Natureza/2.3.png"
      }

      if(badges.length >= 15 && badges.length < 20 ){
        $scope.anteriorimgNatureza = 'img/badges/Categorias/Natureza/2.3.png';
        $scope.proximoNatureza = 20;
        $scope.proximoimgNatureza = 'img/badges/Categorias/Natureza/3.1.png';
        document.getElementById("Natureza").src="img/badges/Categorias/Natureza/3.png"
      }
      if(badges.length >= 20 && badges.length < 22 ){
        $scope.anteriorimgNatureza = 'img/badges/Categorias/Natureza/3.png';
        $scope.proximoNatureza = 25;
        $scope.proximoimgNatureza = 'img/badges/Categorias/Natureza/3.2.png';
        document.getElementById("Natureza").src="img/badges/Categorias/Natureza/3.1.png"
      }
      if(badges.length >= 25 && badges.length < 30 ){
        $scope.anteriorimgNatureza = 'img/badges/Categorias/Natureza/3.1.png';
        $scope.proximoNatureza = 30;
        $scope.proximoimgNatureza = 'img/badges/Categorias/Natureza/3.3.png';
        document.getElementById("Natureza").src="img/badges/Categorias/Natureza/3.2.png"
      }
      if(badges.length >= 30 && badges.length < 50 ){
        $scope.anteriorimgNatureza = 'img/badges/Categorias/Natureza/3.2.png';
        $scope.proximoNatureza = 50;
        $scope.proximoimgNatureza = 'img/badges/Categorias/Natureza/Super.png';
        document.getElementById("Natureza").src="img/badges/Categorias/Natureza/3.3.png"
      }

      if(badges.length >= 50){
        $scope.anteriorimgNatureza = 'img/badges/Categorias/Natureza/3.3.png';
        $scope.proximoNatureza = 10000;
        $scope.proximoimgNatureza = 'img/badges/Categorias/Natureza/Super.png';
        document.getElementById("Natureza").src="img/badges/Categorias/Natureza/Super.png"
      }

    }else{
      $scope.auxnbadgeNatureza = 0;
        $scope.anteriorimgNatureza = 'img/badges/Categorias/Natureza/0.png';
        $scope.proximoNatureza = 1;
        $scope.proximoimgNatureza = 'img/badges/Categorias/Natureza/1.png';
      document.getElementById("Natureza").src="img/badges/Categorias/Natureza/0.png"
    }
  });

  $scope.aux.tag = "#Passeio";
  $scope.auxnbadgePasseio = 0;
  $scope.proximoPasseio = 0;
  $scope.proximoimgPasseio = '';
  $scope.anteriorimgPasseio = '';
  EventoService.getbadges($scope.aux).then(function(badges){
    //console.log("badges", badges);
    if(badges!="Error" && badges !="E"){
      $scope.auxnbadgePasseio = badges.length;
      if(badges.length == 0){
        $scope.anteriorimgPasseio = 'img/badges/Categorias/Passeio/0.png';
        $scope.proximoPasseio = 1;
        $scope.proximoimgPasseio = 'img/badges/Categorias/Passeio/1.png';
        document.getElementById("Passeio").src="img/badges/Categorias/Passeio/0.png"
      }
      if(badges.length == 1){
        $scope.anteriorimgPasseio = 'img/badges/Categorias/Passeio/0.png';
        $scope.proximoPasseio = 2;
        $scope.proximoimgPasseio = 'img/badges/Categorias/Passeio/1.1.png';
        document.getElementById("Passeio").src="img/badges/Categorias/Passeio/1.png"
      }
      if(badges.length == 2){
        $scope.anteriorimgPasseio = 'img/badges/Categorias/Passeio/1.png';
        $scope.proximoPasseio = 3;
        $scope.proximoimgPasseio = 'img/badges/Categorias/Passeio/1.2.png';
        document.getElementById("Passeio").src="img/badges/Categorias/Passeio/1.1.png"
      }
      if(badges.length == 3){
        $scope.anteriorimgPasseio = 'img/badges/Categorias/Passeio/1.1.png';
        $scope.proximoPasseio = 4;
        $scope.proximoimgPasseio = 'img/badges/Categorias/Passeio/1.3.png';
        document.getElementById("Passeio").src="img/badges/Categorias/Passeio/1.2.png"
      }
      if(badges.length == 4 || badges.length == 5){
        $scope.anteriorimgPasseio = 'img/badges/Categorias/Passeio/1.2.png';
        $scope.proximoPasseio = 6;
        $scope.proximoimgPasseio = 'img/badges/Categorias/Passeio/2.png';
        document.getElementById("Passeio").src="img/badges/Categorias/Passeio/1.3.png"
      }

      if(badges.length == 6 || badges.length == 7){
        $scope.anteriorimgPasseio = 'img/badges/Categorias/Passeio/1.3.png';
        $scope.proximoPasseio = 8 ;
        $scope.proximoimgPasseio = 'img/badges/Categorias/Passeio/2.1.png';
        document.getElementById("Passeio").src="img/badges/Categorias/Passeio/2.png"
      }
      if(badges.length == 8 || badges.length == 9){
        $scope.anteriorimgPasseio = 'img/badges/Categorias/Passeio/2.png';
        $scope.proximoPasseio = 10;
        $scope.proximoimgPasseio = 'img/badges/Categorias/Passeio/2.2.png';
        document.getElementById("Passeio").src="img/badges/Categorias/Passeio/2.1.png"
      }
      if(badges.length == 10 || badges.length == 11){
        $scope.anteriorimgPasseio = 'img/badges/Categorias/Passeio/2.1.png';
        $scope.proximoPasseio = 12;
        $scope.proximoimgPasseio = 'img/badges/Categorias/Passeio/2.3.png';
        document.getElementById("Passeio").src="img/badges/Categorias/Passeio/2.2.png"
      }
      if(badges.length == 12 || badges.length == 13 || badges.length == 14){
        $scope.anteriorimgPasseio = 'img/badges/Categorias/Passeio/2.2.png';
        $scope.proximoPasseio = 15;
        $scope.proximoimgPasseio = 'img/badges/Categorias/Passeio/3.png';
        document.getElementById("Passeio").src="img/badges/Categorias/Passeio/2.3.png"
      }

      if(badges.length >= 15 && badges.length < 20 ){
        $scope.anteriorimgPasseio = 'img/badges/Categorias/Passeio/2.3.png';
        $scope.proximoPasseio = 20;
        $scope.proximoimgPasseio = 'img/badges/Categorias/Passeio/3.1.png';
        document.getElementById("Passeio").src="img/badges/Categorias/Passeio/3.png"
      }
      if(badges.length >= 20 && badges.length < 22 ){
        $scope.anteriorimgPasseio = 'img/badges/Categorias/Passeio/3.png';
        $scope.proximoPasseio = 25;
        $scope.proximoimgPasseio = 'img/badges/Categorias/Passeio/3.2.png';
        document.getElementById("Passeio").src="img/badges/Categorias/Passeio/3.1.png"
      }
      if(badges.length >= 25 && badges.length < 30 ){
        $scope.anteriorimgPasseio = 'img/badges/Categorias/Passeio/3.1.png';
        $scope.proximoPasseio = 30;
        $scope.proximoimgPasseio = 'img/badges/Categorias/Passeio/3.3.png';
        document.getElementById("Passeio").src="img/badges/Categorias/Passeio/3.2.png"
      }
      if(badges.length >= 30 && badges.length < 50 ){
        $scope.anteriorimgPasseio = 'img/badges/Categorias/Passeio/3.2.png';
        $scope.proximoPasseio = 50;
        $scope.proximoimgPasseio = 'img/badges/Categorias/Passeio/Super.png';
        document.getElementById("Passeio").src="img/badges/Categorias/Passeio/3.3.png"
      }

      if(badges.length >= 50){
        $scope.anteriorimgPasseio = 'img/badges/Categorias/Passeio/3.3.png';
        $scope.proximoPasseio = 10000;
        $scope.proximoimgPasseio = 'img/badges/Categorias/Passeio/Super.png';
        document.getElementById("Passeio").src="img/badges/Categorias/Passeio/Super.png"
      }

    }else{
      $scope.auxnbadgePasseio = 0;
        $scope.anteriorimgPasseio = 'img/badges/Categorias/Passeio/0.png';
        $scope.proximoPasseio = 1;
        $scope.proximoimgPasseio = 'img/badges/Categorias/Passeio/1.png';
      document.getElementById("Passeio").src="img/badges/Categorias/Passeio/0.png"
    }
  });

  $scope.aux.tag = "#Pets";
  $scope.auxnbadgePets = 0;
  $scope.proximoPets = 0;
  $scope.proximoimgPets = '';
  $scope.anteriorimgPets = '';
  EventoService.getbadges($scope.aux).then(function(badges){
    //console.log("badges", badges);
    if(badges!="Error" && badges !="E"){
      $scope.auxnbadgePets = badges.length;
      if(badges.length == 0){
        $scope.anteriorimgPets = 'img/badges/Categorias/Pets/0.png';
        $scope.proximoPets = 1;
        $scope.proximoimgPets = 'img/badges/Categorias/Pets/1.png';
        document.getElementById("Pets").src="img/badges/Categorias/Pets/0.png"
      }
      if(badges.length == 1){
        $scope.anteriorimgPets = 'img/badges/Categorias/Pets/0.png';
        $scope.proximoPets = 2;
        $scope.proximoimgPets = 'img/badges/Categorias/Pets/1.1.png';
        document.getElementById("Pets").src="img/badges/Categorias/Pets/1.png"
      }
      if(badges.length == 2){
        $scope.anteriorimgPets = 'img/badges/Categorias/Pets/1.png';
        $scope.proximoPets = 3;
        $scope.proximoimgPets = 'img/badges/Categorias/Pets/1.2.png';
        document.getElementById("Pets").src="img/badges/Categorias/Pets/1.1.png"
      }
      if(badges.length == 3){
        $scope.anteriorimgPets = 'img/badges/Categorias/Pets/1.1.png';
        $scope.proximoPets = 4;
        $scope.proximoimgPets = 'img/badges/Categorias/Pets/1.3.png';
        document.getElementById("Pets").src="img/badges/Categorias/Pets/1.2.png"
      }
      if(badges.length == 4 || badges.length == 5){
        $scope.anteriorimgPets = 'img/badges/Categorias/Pets/1.2.png';
        $scope.proximoPets = 6;
        $scope.proximoimgPets = 'img/badges/Categorias/Pets/2.png';
        document.getElementById("Pets").src="img/badges/Categorias/Pets/1.3.png"
      }

      if(badges.length == 6 || badges.length == 7){
        $scope.anteriorimgPets = 'img/badges/Categorias/Pets/1.3.png';
        $scope.proximoPets = 8;
        $scope.proximoimgPets = 'img/badges/Categorias/Pets/2.1.png';
        document.getElementById("Pets").src="img/badges/Categorias/Pets/2.png"
      }
      if(badges.length == 8 || badges.length == 9){
        $scope.anteriorimgPets = 'img/badges/Categorias/Pets/2.png';
        $scope.proximoPets = 10;
        $scope.proximoimgPets = 'img/badges/Categorias/Pets/2.2.png';
        document.getElementById("Pets").src="img/badges/Categorias/Pets/2.1.png"
      }
      if(badges.length == 10 || badges.length == 11){
        $scope.anteriorimgPets = 'img/badges/Categorias/Pets/2.1.png';
        $scope.proximoPets = 12;
        $scope.proximoimgPets = 'img/badges/Categorias/Pets/2.3.png';
        document.getElementById("Pets").src="img/badges/Categorias/Pets/2.2.png"
      }
      if(badges.length == 12 || badges.length == 13 || badges.length == 14){
        $scope.anteriorimgPets = 'img/badges/Categorias/Pets/2.2.png';
        $scope.proximoPets = 15;
        $scope.proximoimgPets = 'img/badges/Categorias/Pets/3.png';
        document.getElementById("Pets").src="img/badges/Categorias/Pets/2.3.png"
      }

      if(badges.length >= 15 && badges.length < 20 ){
        $scope.anteriorimgPets = 'img/badges/Categorias/Pets/2.3.png';
        $scope.proximoPets = 20;
        $scope.proximoimgPets = 'img/badges/Categorias/Pets/3.1.png';
        document.getElementById("Pets").src="img/badges/Categorias/Pets/3.png"
      }
      if(badges.length >= 20 && badges.length < 22 ){
        $scope.anteriorimgPets = 'img/badges/Categorias/Pets/3.png';
        $scope.proximoPets = 25;
        $scope.proximoimgPets = 'img/badges/Categorias/Pets/3.2.png';
        document.getElementById("Pets").src="img/badges/Categorias/Pets/3.1.png"
      }
      if(badges.length >= 25 && badges.length < 30 ){
        $scope.anteriorimgPets = 'img/badges/Categorias/Pets/3.1.png';
        $scope.proximoPets = 30;
        $scope.proximoimgPets = 'img/badges/Categorias/Pets/3.3.png';
        document.getElementById("Pets").src="img/badges/Categorias/Pets/3.2.png"
      }
      if(badges.length >= 30 && badges.length < 50 ){
        $scope.anteriorimgPets = 'img/badges/Categorias/Pets/3.2.png';
        $scope.proximoPets = 50;
        $scope.proximoimgPets = 'img/badges/Categorias/Pets/Super.png';
        document.getElementById("Pets").src="img/badges/Categorias/Pets/3.3.png"
      }

      if(badges.length >= 50){
        $scope.anteriorimgPets = 'img/badges/Categorias/Pets/3.3.png';
        $scope.proximoPets = 10000;
        $scope.proximoimgPets = 'img/badges/Categorias/Pets/Super.png';
        document.getElementById("Pets").src="img/badges/Categorias/Pets/Super.png"
      }

    }else{
      $scope.auxnbadgePets = 0;
        $scope.anteriorimgPets = 'img/badges/Categorias/Pets/0.png';
        $scope.proximoPets = 1;
        $scope.proximoimgPets = 'img/badges/Categorias/Pets/1.png';
      document.getElementById("Pets").src="img/badges/Categorias/Pets/0.png"
    }
  });

  $scope.aux.tag = "#Restaurantesebares";
  $scope.auxnbadgeRestaurantesebares = 0;
  $scope.proximoRestaurantesebares = 0;
  $scope.proximoimgRestaurantesebares = '';
  $scope.anteriorimgRestaurantesebares = '';
  EventoService.getbadges($scope.aux).then(function(badges){
    //console.log("badges", badges);
    if(badges!="Error" && badges !="E"){
      $scope.auxnbadgeRestaurantesebares = badges.length ;
      if(badges.length == 0){
        $scope.anteriorimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/0.png';
        $scope.proximoRestaurantesebares = 1;
        $scope.proximoimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/1.png';
        document.getElementById("Restaurantesebares").src="img/badges/Categorias/Restaurantesebares/0.png"
      }
      if(badges.length == 1){
        $scope.anteriorimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/0.png';
        $scope.proximoRestaurantesebares = 2;
        $scope.proximoimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/1.1.png';
        document.getElementById("Restaurantesebares").src="img/badges/Categorias/Restaurantesebares/1.png"
      }
      if(badges.length == 2){
        $scope.anteriorimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/1.png';
        $scope.proximoRestaurantesebares = 3;
        $scope.proximoimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/1.2.png';
        document.getElementById("Restaurantesebares").src="img/badges/Categorias/Restaurantesebares/1.1.png"
      }
      if(badges.length == 3){
        $scope.anteriorimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/1.1.png';
        $scope.proximoRestaurantesebares = 4;
        $scope.proximoimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/1.3.png';
        document.getElementById("Restaurantesebares").src="img/badges/Categorias/Restaurantesebares/1.2.png"
      }
      if(badges.length == 4 || badges.length == 5){
        $scope.anteriorimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/1.2.png';
        $scope.proximoRestaurantesebares = 6;
        $scope.proximoimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/2.png';
        document.getElementById("Restaurantesebares").src="img/badges/Categorias/Restaurantesebares/1.3.png"
      }

      if(badges.length == 6 || badges.length == 7){
        $scope.anteriorimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/1.3.png';
        $scope.proximoRestaurantesebares = 8;
        $scope.proximoimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/2.1.png';
        document.getElementById("Restaurantesebares").src="img/badges/Categorias/Restaurantesebares/2.png"
      }
      if(badges.length == 8 || badges.length == 9){
        $scope.anteriorimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/2.png';
        $scope.proximoRestaurantesebares = 10;
        $scope.proximoimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/2.2.png';
        document.getElementById("Restaurantesebares").src="img/badges/Categorias/Restaurantesebares/2.1.png"
      }
      if(badges.length == 10 || badges.length == 11){
        $scope.anteriorimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/2.1.png';
        $scope.proximoRestaurantesebares = 12;
        $scope.proximoimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/2.3.png';
        document.getElementById("Restaurantesebares").src="img/badges/Categorias/Restaurantesebares/2.2.png"
      }
      if(badges.length == 12 || badges.length == 13 || badges.length == 14){
        $scope.anteriorimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/2.2.png';
        $scope.proximoRestaurantesebares = 15;
        $scope.proximoimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/3.png';
        document.getElementById("Restaurantesebares").src="img/badges/Categorias/Restaurantesebares/2.3.png"
      }

      if(badges.length >= 15 && badges.length < 20 ){
        $scope.anteriorimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/2.3.png';
        $scope.proximoRestaurantesebares = 20;
        $scope.proximoimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/3.1.png';
        document.getElementById("Restaurantesebares").src="img/badges/Categorias/Restaurantesebares/3.png"
      }
      if(badges.length >= 20 && badges.length < 22 ){
        $scope.anteriorimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/3.png';
        $scope.proximoRestaurantesebares = 25;
        $scope.proximoimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/3.2.png';
        document.getElementById("Restaurantesebares").src="img/badges/Categorias/Restaurantesebares/3.1.png"
      }
      if(badges.length >= 25 && badges.length < 30 ){
        $scope.anteriorimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/3.1.png';
        $scope.proximoRestaurantesebares = 30;
        $scope.proximoimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/3.3.png';
        document.getElementById("Restaurantesebares").src="img/badges/Categorias/Restaurantesebares/3.2.png"
      }
      if(badges.length >= 30 && badges.length < 50 ){
        $scope.anteriorimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/3.2.png';
        $scope.proximoRestaurantesebares = 50;
        $scope.proximoimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/Super.png';
        document.getElementById("Restaurantesebares").src="img/badges/Categorias/Restaurantesebares/3.3.png"
      }

      if(badges.length >= 50){
        $scope.anteriorimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/3.3.png';
        $scope.proximoRestaurantesebares = 10000;
        $scope.proximoimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/Super.png';
        document.getElementById("Restaurantesebares").src="img/badges/Categorias/Restaurantesebares/Super.png"
      }

    }else{
      $scope.auxnbadgeRestaurantesebares = 0;
        $scope.anteriorimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/0.png';
        $scope.proximoRestaurantesebares = 1;
        $scope.proximoimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/1.png';
      document.getElementById("Restaurantesebares").src="img/badges/Categorias/Restaurantesebares/0.png"
    }
  });

  $scope.aux.tag = "#Surf";
  $scope.auxnbadgeSurf = 0;
  $scope.proximoSurf = 0;
  $scope.proximoimgSurf = '';
  $scope.anteriorimgSurf = '';
  EventoService.getbadges($scope.aux).then(function(badges){
    //console.log("badges", badges);
    if(badges!="Error" && badges !="E"){
      $scope.auxnbadgeSurf = badges.length;
      if(badges.length == 0){
        $scope.anteriorimgSurf = 'img/badges/Categorias/Surf/0.png';
        $scope.proximoSurf = 1;
        $scope.proximoimgSurf = 'img/badges/Categorias/Surf/1.png';
        document.getElementById("Surf").src="img/badges/Categorias/Surf/0.png"
      }
      if(badges.length == 1){
        $scope.anteriorimgSurf = 'img/badges/Categorias/Surf/0.png';
        $scope.proximoSurf = 2;
        $scope.proximoimgSurf = 'img/badges/Categorias/Surf/1.1.png';
        document.getElementById("Surf").src="img/badges/Categorias/Surf/1.png"
      }
      if(badges.length == 2){
        $scope.anteriorimgSurf = 'img/badges/Categorias/Surf/1.png';
        $scope.proximoSurf = 3;
        $scope.proximoimgSurf = 'img/badges/Categorias/Surf/1.2.png';
        document.getElementById("Surf").src="img/badges/Categorias/Surf/1.1.png"
      }
      if(badges.length == 3){
        $scope.anteriorimgSurf = 'img/badges/Categorias/Surf/1.1.png';
        $scope.proximoSurf = 4;
        $scope.proximoimgSurf = 'img/badges/Categorias/Surf/1.3.png';
        document.getElementById("Surf").src="img/badges/Categorias/Surf/1.2.png"
      }
      if(badges.length == 4 || badges.length == 5){
        $scope.anteriorimgSurf = 'img/badges/Categorias/Surf/1.2.png';
        $scope.proximoSurf = 6;
        $scope.proximoimgSurf = 'img/badges/Categorias/Surf/2.png';
        document.getElementById("Surf").src="img/badges/Categorias/Surf/1.3.png"
      }

      if(badges.length == 6 || badges.length == 7){
        $scope.anteriorimgSurf = 'img/badges/Categorias/Surf/1.3.png';
        $scope.proximoSurf = 8;
        $scope.proximoimgSurf = 'img/badges/Categorias/Surf/2.1.png';
        document.getElementById("Surf").src="img/badges/Categorias/Surf/2.png"
      }
      if(badges.length == 8 || badges.length == 9){
        $scope.anteriorimgSurf = 'img/badges/Categorias/Surf/2.png';
        $scope.proximoSurf = 10;
        $scope.proximoimgSurf = 'img/badges/Categorias/Surf/2.2.png';
        document.getElementById("Surf").src="img/badges/Categorias/Surf/2.1.png"
      }
      if(badges.length == 10 || badges.length == 11){
        $scope.anteriorimgSurf = 'img/badges/Categorias/Surf/2.1.png';
        $scope.proximoSurf = 12;
        $scope.proximoimgSurf = 'img/badges/Categorias/Surf/2.3.png';
        document.getElementById("Surf").src="img/badges/Categorias/Surf/2.2.png"
      }
      if(badges.length == 12 || badges.length == 13 || badges.length == 14){
        $scope.anteriorimgSurf = 'img/badges/Categorias/Surf/2.2.png';
        $scope.proximoSurf = 15;
        $scope.proximoimgSurf = 'img/badges/Categorias/Surf/3.png';
        document.getElementById("Surf").src="img/badges/Categorias/Surf/2.3.png"
      }

      if(badges.length >= 15 && badges.length < 20 ){
        $scope.anteriorimgSurf = 'img/badges/Categorias/Surf/2.3.png';
        $scope.proximoSurf = 20;
        $scope.proximoimgSurf = 'img/badges/Categorias/Surf/3.1.png';
        document.getElementById("Surf").src="img/badges/Categorias/Surf/3.png"
      }
      if(badges.length >= 20 && badges.length < 22 ){
        $scope.anteriorimgSurf = 'img/badges/Categorias/Surf/3.png';
        $scope.proximoSurf = 25;
        $scope.proximoimgSurf = 'img/badges/Categorias/Surf/3.2.png';
        document.getElementById("Surf").src="img/badges/Categorias/Surf/3.1.png"
      }
      if(badges.length >= 25 && badges.length < 30 ){
        $scope.anteriorimgSurf = 'img/badges/Categorias/Surf/3.1.png';
        $scope.proximoSurf = 30;
        $scope.proximoimgSurf = 'img/badges/Categorias/Surf/3.3.png';
        document.getElementById("Surf").src="img/badges/Categorias/Surf/3.2.png"
      }
      if(badges.length >= 30 && badges.length < 50 ){
        $scope.anteriorimgSurf = 'img/badges/Categorias/Surf/3.2.png';
        $scope.proximoSurf = 50;
        $scope.proximoimgSurf = 'img/badges/Categorias/Surf/Super.png';
        document.getElementById("Surf").src="img/badges/Categorias/Surf/3.3.png"
      }

      if(badges.length >= 50){
        $scope.anteriorimgSurf = 'img/badges/Categorias/Surf/3.3.png';
        $scope.proximoSurf = 10000;
        $scope.proximoimgSurf = 'img/badges/Categorias/Surf/Super.png';
        document.getElementById("Surf").src="img/badges/Categorias/Surf/Super.png"
      }

    }else{
      $scope.auxnbadgeSurf = 0;
        $scope.anteriorimgSurf = 'img/badges/Categorias/Surf/0.png';
        $scope.proximoSurf = 1;
        $scope.proximoimgSurf = 'img/badges/Categorias/Surf/1.png';
      document.getElementById("Surf").src="img/badges/Categorias/Surf/0.png"
    }
  });

  $scope.aux.tag = "#Voluntariado";
  $scope.auxnbadgeVoluntariado = 0;
  $scope.proximoVoluntariado = 0;
  $scope.proximoimgVoluntariado = '';
  $scope.anteriorimgVoluntariado = '';
  EventoService.getbadges($scope.aux).then(function(badges){
    //console.log("Voluntariado", badges);
    if(badges!="Error" && badges !="E"){
      $scope.auxnbadgeVoluntariado = badges.length;
      if(badges.length == 0){
        $scope.anteriorimgVoluntariado = 'img/badges/Categorias/Voluntariado/0.png';
        $scope.proximoVoluntariado = 1;
        $scope.proximoimgVoluntariado = 'img/badges/Categorias/Voluntariado/1.png';
        document.getElementById("Voluntariado").src="img/badges/Categorias/Voluntariado/0.png"
      }
      if(badges.length == 1){
        $scope.anteriorimgVoluntariado = 'img/badges/Categorias/Voluntariado/0.png';
        $scope.proximoVoluntariado = 2;
        $scope.proximoimgVoluntariado = 'img/badges/Categorias/Voluntariado/1.1.png';
        document.getElementById("Voluntariado").src="img/badges/Categorias/Voluntariado/1.png"
      }
      if(badges.length == 2){
        $scope.anteriorimgVoluntariado = 'img/badges/Categorias/Voluntariado/1.png';
        $scope.proximoVoluntariado = 3;
        $scope.proximoimgVoluntariado = 'img/badges/Categorias/Voluntariado/1.2.png';
        document.getElementById("Voluntariado").src="img/badges/Categorias/Voluntariado/1.1.png"
      }
      if(badges.length == 3){
        $scope.anteriorimgVoluntariado = 'img/badges/Categorias/Voluntariado/1.1.png';
        $scope.proximoVoluntariado = 4;
        $scope.proximoimgVoluntariado = 'img/badges/Categorias/Voluntariado/1.3.png';
        document.getElementById("Voluntariado").src="img/badges/Categorias/Voluntariado/1.2.png"
      }
      if(badges.length == 4 || badges.length == 5){
        $scope.anteriorimgVoluntariado = 'img/badges/Categorias/Voluntariado/1.2.png';
        $scope.proximoVoluntariado = 6;
        $scope.proximoimgVoluntariado = 'img/badges/Categorias/Voluntariado/2.png';
        document.getElementById("Voluntariado").src="img/badges/Categorias/Voluntariado/1.3.png"
      }

      if(badges.length == 6 || badges.length == 7){
        $scope.anteriorimgVoluntariado = 'img/badges/Categorias/Voluntariado/1.3.png';
        $scope.proximoVoluntariado = 8;
        $scope.proximoimgVoluntariado = 'img/badges/Categorias/Voluntariado/2.1.png';
        document.getElementById("Voluntariado").src="img/badges/Categorias/Voluntariado/2.png"
      }
      if(badges.length == 8 || badges.length == 9){
        $scope.anteriorimgVoluntariado = 'img/badges/Categorias/Voluntariado/2.png';
        $scope.proximoVoluntariado = 10;
        $scope.proximoimgVoluntariado = 'img/badges/Categorias/Voluntariado/2.2.png';
        document.getElementById("Voluntariado").src="img/badges/Categorias/Voluntariado/2.1.png"
      }
      if(badges.length == 10 || badges.length == 11){
        $scope.anteriorimgVoluntariado = 'img/badges/Categorias/Voluntariado/2.1.png';
        $scope.proximoVoluntariado = 12;
        $scope.proximoimgVoluntariado = 'img/badges/Categorias/Voluntariado/2.3.png';
        document.getElementById("Voluntariado").src="img/badges/Categorias/Voluntariado/2.2.png"
      }
      if(badges.length == 12 || badges.length == 13 || badges.length == 14){
        $scope.anteriorimgVoluntariado = 'img/badges/Categorias/Voluntariado/2.2.png';
        $scope.proximoVoluntariado = 15;
        $scope.proximoimgVoluntariado = 'img/badges/Categorias/Voluntariado/3.png';
        document.getElementById("Voluntariado").src="img/badges/Categorias/Voluntariado/2.3.png"
      }

      if(badges.length >= 15 && badges.length < 20 ){
        $scope.anteriorimgVoluntariado = 'img/badges/Categorias/Voluntariado/2.3.png';
        $scope.proximoVoluntariado = 20;
        $scope.proximoimgVoluntariado = 'img/badges/Categorias/Voluntariado/3.1.png';
        document.getElementById("Voluntariado").src="img/badges/Categorias/Voluntariado/3.png"
      }
      if(badges.length >= 20 && badges.length < 22 ){
        $scope.anteriorimgVoluntariado = 'img/badges/Categorias/Voluntariado/3.png';
        $scope.proximoVoluntariado = 25;
        $scope.proximoimgVoluntariado = 'img/badges/Categorias/Voluntariado/3.2.png';
        document.getElementById("Voluntariado").src="img/badges/Categorias/Voluntariado/3.1.png"
      }
      if(badges.length >= 25 && badges.length < 30 ){
        $scope.anteriorimgVoluntariado = 'img/badges/Categorias/Voluntariado/3.1.png';
        $scope.proximoVoluntariado = 30;
        $scope.proximoimgVoluntariado = 'img/badges/Categorias/Voluntariado/3.3.png';
        document.getElementById("Voluntariado").src="img/badges/Categorias/Voluntariado/3.2.png"
      }
      if(badges.length >= 30 && badges.length < 50 ){
        $scope.anteriorimgVoluntariado = 'img/badges/Categorias/Voluntariado/3.2.png';
        $scope.proximoVoluntariado = 50;
        $scope.proximoimgVoluntariado = 'img/badges/Categorias/Voluntariado/Super.png';
        document.getElementById("Voluntariado").src="img/badges/Categorias/Voluntariado/3.3.png"
      }

      if(badges.length >= 50){
        $scope.anteriorimgVoluntariado = 'img/badges/Categorias/Voluntariado/3.3.png';
        $scope.proximoVoluntariado = 10000;
        $scope.proximoimgVoluntariado = 'img/badges/Categorias/Voluntariado/Super.png';
        document.getElementById("Voluntariado").src="img/badges/Categorias/Voluntariado/Super.png"
      }

    }else{
      $scope.auxnbadgeVoluntariado = 0;
        $scope.anteriorimgVoluntariado = 'img/badges/Categorias/Voluntariado/0.png';
        $scope.proximoVoluntariado = 1;
        $scope.proximoimgVoluntariado = 'img/badges/Categorias/Voluntariado/1.png';
      document.getElementById("Voluntariado").src="img/badges/Categorias/Voluntariado/0.png"
    }
  });
  // $scope.auxnbadgeQuantidadePersonalidades = 0;
  // $scope.proximoQuantidadePersonalidades = 0;
  // $scope.proximoimgQuantidadePersonalidades = '';
  // $scope.anteriorimgQuantidadePersonalidades = '';
  // EventoService.GetComments3($scope.user).then(function(badges){
  //   //console.log("GetComments3", badges.mal,"dasd", badges.ruins);
  //   if(badges.mal != "0,0,0,"){
  //     $scope.auxnbadgeQuantidadePersonalidades = badges.tamanho;
  //     if(badges.tamanho == 0){
  //       $scope.anteriorimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/0.png';
  //       $scope.proximoQuantidadePersonalidades = 1;
  //       $scope.proximoimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/1.png';

  //       document.getElementById("QuantidadePersonalidades").src="img/badges/Geral/Avaliacoes/QuantidadePersonalidades/0.png"
  //     }
  //     if(badges.tamanho >= 1 && badges.tamanho < 5){
  //       $scope.anteriorimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/0.png';
  //       $scope.proximoQuantidadePersonalidades = 5;
  //       $scope.proximoimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/1.1.png';
  //       document.getElementById("QuantidadePersonalidades").src="img/badges/Geral/Avaliacoes/QuantidadePersonalidades/1.png"
  //     }
  //     if(badges.tamanho >= 5 && badges.tamanho < 10){
  //       $scope.anteriorimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/1.png';
  //       $scope.proximoQuantidadePersonalidades = 10;
  //       $scope.proximoimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/1.2.png';
  //       document.getElementById("QuantidadePersonalidades").src="img/badges/Geral/Avaliacoes/QuantidadePersonalidades/1.1.png"
  //     }
  //     if(badges.tamanho >= 10 && badges.tamanho < 15){
  //       $scope.anteriorimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/1.1.png';
  //       $scope.proximoQuantidadePersonalidades = 15;
  //       $scope.proximoimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/1.3.png';
  //       document.getElementById("QuantidadePersonalidades").src="img/badges/Geral/Avaliacoes/QuantidadePersonalidades/1.2.png"
  //     }
  //     if(badges.tamanho >= 15 && badges.tamanho < 30){
  //       $scope.anteriorimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/1.2.png';
  //       $scope.proximoQuantidadePersonalidades = 30;
  //       $scope.proximoimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/2.png';
  //       document.getElementById("QuantidadePersonalidades").src="img/badges/Geral/Avaliacoes/QuantidadePersonalidades/1.3.png"
  //     }

  //     if(badges.tamanho >= 30 && badges.tamanho < 40){
  //       $scope.anteriorimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/1.3.png';
  //       $scope.proximoQuantidadePersonalidades = 40;
  //       $scope.proximoimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/2.1.png';
  //       document.getElementById("QuantidadePersonalidades").src="img/badges/Geral/Avaliacoes/QuantidadePersonalidades/2.png"
  //     }
  //     if(badges.tamanho >= 40 && badges.tamanho < 50){
  //       $scope.anteriorimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/2.png';
  //       $scope.proximoQuantidadePersonalidades = 50;
  //       $scope.proximoimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/2.2.png';
  //       document.getElementById("QuantidadePersonalidades").src="img/badges/Geral/Avaliacoes/QuantidadePersonalidades/2.1.png"
  //     }
  //     if(badges.tamanho >= 50 && badges.tamanho < 60){
  //       $scope.anteriorimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/2.1.png';
  //       $scope.proximoQuantidadePersonalidades = 60;
  //       $scope.proximoimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/2.3.png';
  //       document.getElementById("QuantidadePersonalidades").src="img/badges/Geral/Avaliacoes/QuantidadePersonalidades/2.2.png"
  //     }
  //     if(badges.tamanho >= 60 && badges.tamanho < 80){
  //       $scope.anteriorimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/2.2.png';
  //       $scope.proximoQuantidadePersonalidades = 80;
  //       $scope.proximoimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/3.png';
  //       document.getElementById("QuantidadePersonalidades").src="img/badges/Geral/Avaliacoes/QuantidadePersonalidades/2.3.png"
  //     }

  //     if(badges.tamanho >= 80 && badges.tamanho < 110 ){
  //       $scope.anteriorimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/2.3.png';
  //       $scope.proximoQuantidadePersonalidades = 110;
  //       $scope.proximoimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/3.1.png';
  //       document.getElementById("QuantidadePersonalidades").src="img/badges/Geral/Avaliacoes/QuantidadePersonalidades/3.png"
  //     }
  //     if(badges.tamanho >= 110 && badges.tamanho < 140 ){
  //       $scope.anteriorimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/3.png';
  //       $scope.proximoQuantidadePersonalidades = 140;
  //       $scope.proximoimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/3.2.png';
  //       document.getElementById("QuantidadePersonalidades").src="img/badges/Geral/Avaliacoes/QuantidadePersonalidades/3.1.png"
  //     }
  //     if(badges.tamanho >= 140 && badges.tamanho < 170 ){
  //       $scope.anteriorimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/3.1.png';
  //       $scope.proximoQuantidadePersonalidades = 170;
  //       $scope.proximoimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/3.3.png';
  //       document.getElementById("QuantidadePersonalidades").src="img/badges/Geral/Avaliacoes/QuantidadePersonalidades/3.2.png"
  //     }
  //     if(badges.tamanho >= 170 && badges.tamanho < 230 ){
  //       $scope.anteriorimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/3.2.png';
  //       $scope.proximoQuantidadePersonalidades = 230;
  //       $scope.proximoimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/Super.png';
  //       document.getElementById("QuantidadePersonalidades").src="img/badges/Geral/Avaliacoes/QuantidadePersonalidades/3.3.png"
  //     }

  //     if(badges.tamanho >= 230){
  //       $scope.anteriorimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/3.3.png';
  //       $scope.proximoQuantidadePersonalidades = 10000;
  //       $scope.proximoimgQuantidadePersonalidades = '';
  //       document.getElementById("QuantidadePersonalidades").src="img/badges/Geral/Avaliacoes/QuantidadePersonalidades/Super.png"
  //     }

  //   }else{
  //     document.getElementById("QuantidadePersonalidades").src="img/badges/Geral/Avaliacoes/QuantidadePersonalidades/0.png"
  //   }
  // });

  // $scope.auxnbadgeSmartDealer = 0;
  // $scope.proximoSmartDealer = 0;
  // $scope.proximoimgSmartDealer = '';
  // $scope.anteriorimgSmartDealer = '';
  // EventoService.getbadgesCriouComercio($scope.user).then(function(badges){
  //   //console.log("getbadgesCriouComercio", badges.length);
  //   if(badges!="Error" && badges !="E"){
  //     $scope.auxnbadgeSmartDealer = badges.length;
  //     if(badges.length == 0){
  //       $scope.anteriorimgSmartDealer = '"img/badges/Geral/Comercios/SmartDealer/0.png';
  //       $scope.proximoSmartDealer = 1;
  //       $scope.proximoimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/1.png';
  //       document.getElementById("SmartDealer").src="img/badges/Geral/Comercios/SmartDealer/0.png"
  //     }
  //     if(badges.length == 1){
  //       $scope.anteriorimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/0.png';
  //       $scope.proximoSmartDealer = 2;
  //       $scope.proximoimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/1.1.png';
  //       document.getElementById("SmartDealer").src="img/badges/Geral/Comercios/SmartDealer/1.png"
  //     }
  //     if(badges.length == 2){
  //       $scope.anteriorimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/1.png';
  //       $scope.proximoSmartDealer = 3;
  //       $scope.proximoimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/1.2.png';
  //       document.getElementById("SmartDealer").src="img/badges/Geral/Comercios/SmartDealer/1.1.png"
  //     }
  //     if(badges.length == 3){
  //       $scope.anteriorimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/1.1.png';
  //       $scope.proximoSmartDealer = 4;
  //       $scope.proximoimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/1.3.png';
  //       document.getElementById("SmartDealer").src="img/badges/Geral/Comercios/SmartDealer/1.2.png"
  //     }
  //     if(badges.length >= 4 && badges.length < 6){
  //       $scope.anteriorimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/1.2.png';
  //       $scope.proximoSmartDealer = 6;
  //       $scope.proximoimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/2.png';
  //       document.getElementById("SmartDealer").src="img/badges/Geral/Comercios/SmartDealer/1.3.png"
  //     }

  //     if(badges.length >= 6 && badges.length < 8){
  //       $scope.anteriorimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/1.3.png';
  //       $scope.proximoSmartDealer = 8;
  //       $scope.proximoimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/2.1.png';
  //       document.getElementById("SmartDealer").src="img/badges/Geral/Comercios/SmartDealer/2.png"
  //     }
  //     if(badges.length >= 8 && badges.length < 10){
  //       $scope.anteriorimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/2.png';
  //       $scope.proximoSmartDealer = 10;
  //       $scope.proximoimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/2.2.png';
  //       document.getElementById("SmartDealer").src="img/badges/Geral/Comercios/SmartDealer/2.1.png"
  //     }
  //     if(badges.length >= 10 && badges.length < 12){
  //       $scope.anteriorimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/2.1.png';
  //       $scope.proximoSmartDealer = 12;
  //       $scope.proximoimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/2.3.png';
  //       document.getElementById("SmartDealer").src="img/badges/Geral/Comercios/SmartDealer/2.2.png"
  //     }
  //     if(badges.length >= 12 && badges.length < 15){
  //       $scope.anteriorimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/2.2.png';
  //       $scope.proximoSmartDealer = 15;
  //       $scope.proximoimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/3.png';
  //       document.getElementById("SmartDealer").src="img/badges/Geral/Comercios/SmartDealer/2.3.png"
  //     }

  //     if(badges.length >= 15 && badges.length < 20 ){
  //       $scope.anteriorimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/2.3.png';
  //       $scope.proximoSmartDealer = 20;
  //       $scope.proximoimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/3.1.png';
  //       document.getElementById("SmartDealer").src="img/badges/Geral/Comercios/SmartDealer/3.png"
  //     }
  //     if(badges.length >= 20 && badges.length < 25 ){
  //       $scope.anteriorimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/3.png';
  //       $scope.proximoSmartDealer = 25;
  //       $scope.proximoimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/3.2.png';
  //       document.getElementById("SmartDealer").src="img/badges/Geral/Comercios/SmartDealer/3.1.png"
  //     }
  //     if(badges.length >= 25 && badges.length < 30 ){
  //       $scope.anteriorimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/3.1.png';
  //       $scope.proximoSmartDealer = 30;
  //       $scope.proximoimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/3.3.png';
  //       document.getElementById("SmartDealer").src="img/badges/Geral/Comercios/SmartDealer/3.2.png"
  //     }
  //     if(badges.length >= 30 && badges.length < 40 ){
  //       $scope.anteriorimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/3.2.png';
  //       $scope.proximoSmartDealer = 40;
  //       $scope.proximoimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/Super.png';
  //       document.getElementById("SmartDealer").src="img/badges/Geral/Comercios/SmartDealer/3.3.png"
  //     }

  //     if(badges.length >= 40){
  //       $scope.anteriorimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/3.3.png';
  //       $scope.proximoSmartDealer = 10000;
  //       $scope.proximoimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/Super.png';
  //       document.getElementById("SmartDealer").src="img/badges/Geral/Comercios/SmartDealer/Super.png"
  //     }

  //   }else{
  //     document.getElementById("SmartDealer").src="img/badges/Geral/Comercios/SmartDealer/0.png"
  //   }
  // });

  // $scope.auxnbadgeCriador = 0;
  // $scope.proximoCriador = 0;
  // $scope.proximoimgCriador = '';
  // $scope.anteriorimgCriador = '';
  // EventoService.GetCriados($scope.user).then(function(badges) {
  //   if(badges!="Error" && badges !="E"){
  //     $scope.auxnbadgeCriador = badges.length;
  //     if(badges.length == 0){
  //       $scope.anteriorimgCriador = 'img/badges/Geral/Eventos/Criador/0.png';
  //       $scope.proximoCriador = 1;
  //       $scope.proximoimgCriador = 'img/badges/Geral/Eventos/Criador/1.png';
  //       document.getElementById("Criador").src="img/badges/Geral/Eventos/Criador/0.png"
  //     }
  //     if(badges.length == 1){
  //       $scope.anteriorimgCriador = 'img/badges/Geral/Eventos/Criador/0.png';
  //       $scope.proximoCriador = 2;
  //       $scope.proximoimgCriador = 'img/badges/Geral/Eventos/Criador/1.1.png';
  //       document.getElementById("Criador").src="img/badges/Geral/Eventos/Criador/1.png"
  //     }
  //     if(badges.length == 2){
  //       $scope.anteriorimgCriador = 'img/badges/Geral/Eventos/Criador/1.png';
  //       $scope.proximoCriador = 3;
  //       $scope.proximoimgCriador = 'img/badges/Geral/Eventos/Criador/1.2.png';
  //       document.getElementById("Criador").src="img/badges/Geral/Eventos/Criador/1.1.png"
  //     }
  //     if(badges.length == 3){
  //       $scope.anteriorimgCriador = 'img/badges/Geral/Eventos/Criador/1.1.png';
  //       $scope.proximoCriador = 4;
  //       $scope.proximoimgCriador = 'img/badges/Geral/Eventos/Criador/1.3.png';
  //       document.getElementById("Criador").src="img/badges/Geral/Eventos/Criador/1.2.png"
  //     }
  //     if(badges.length >= 4 && badges.length < 6){
  //       $scope.anteriorimgCriador = 'img/badges/Geral/Eventos/Criador/1.2.png';
  //       $scope.proximoCriador = 6;
  //       $scope.proximoimgCriador = 'img/badges/Geral/Eventos/Criador/2.png';
  //       document.getElementById("Criador").src="img/badges/Geral/Eventos/Criador/1.3.png"
  //     }

  //     if(badges.length >= 6 && badges.length < 8){
  //       $scope.anteriorimgCriador = 'img/badges/Geral/Eventos/Criador/1.3.png';
  //       $scope.proximoCriador = 8;
  //       $scope.proximoimgCriador = 'img/badges/Geral/Eventos/Criador/2.1.png';
  //       document.getElementById("Criador").src="img/badges/Geral/Eventos/Criador/2.png"
  //     }
  //     if(badges.length >= 8 && badges.length < 10){
  //       $scope.anteriorimgCriador = 'img/badges/Geral/Eventos/Criador/2.png';
  //       $scope.proximoCriador = 10;
  //       $scope.proximoimgCriador = 'img/badges/Geral/Eventos/Criador/2.2.png';
  //       document.getElementById("Criador").src="img/badges/Geral/Eventos/Criador/2.1.png"
  //     }
  //     if(badges.length >= 10 && badges.length < 12){
  //       $scope.anteriorimgCriador = 'img/badges/Geral/Eventos/Criador/2.1.png';
  //       $scope.proximoCriador = 12;
  //       $scope.proximoimgCriador = 'img/badges/Geral/Eventos/Criador/2.3.png';
  //       document.getElementById("Criador").src="img/badges/Geral/Eventos/Criador/2.2.png"
  //     }
  //     if(badges.length >= 12 && badges.length < 15){
  //       $scope.anteriorimgCriador = 'img/badges/Geral/Eventos/Criador/2.2.png';
  //       $scope.proximoCriador = 15;
  //       $scope.proximoimgCriador = 'img/badges/Geral/Eventos/Criador/3.png';
  //       document.getElementById("Criador").src="img/badges/Geral/Eventos/Criador/2.3.png"
  //     }

  //     if(badges.length >= 15 && badges.length < 20 ){
  //       $scope.anteriorimgCriador = 'img/badges/Geral/Eventos/Criador/2.3.png';
  //       $scope.proximoCriador = 20;
  //       $scope.proximoimgCriador = 'img/badges/Geral/Eventos/Criador/3.1.png';
  //       document.getElementById("Criador").src="img/badges/Geral/Eventos/Criador/3.png"
  //     }
  //     if(badges.length >= 20 && badges.length < 25 ){
  //       $scope.anteriorimgCriador = 'img/badges/Geral/Eventos/Criador/3.png';
  //       $scope.proximoCriador = 25;
  //       $scope.proximoimgCriador = 'img/badges/Geral/Eventos/Criador/3.2.png';
  //       document.getElementById("Criador").src="img/badges/Geral/Eventos/Criador/3.1.png"
  //     }
  //     if(badges.length >= 25 && badges.length < 30 ){
  //       $scope.anteriorimgCriador = 'img/badges/Geral/Eventos/Criador/3.1.png';
  //       $scope.proximoCriador = 30;
  //       $scope.proximoimgCriador = 'img/badges/Geral/Eventos/Criador/3.3.png';
  //       document.getElementById("Criador").src="img/badges/Geral/Eventos/Criador/3.2.png"
  //     }
  //     if(badges.length >= 30 && badges.length < 40 ){
  //       $scope.anteriorimgCriador = 'img/badges/Geral/Eventos/Criador/3.2.png';
  //       $scope.proximoCriador = 40;
  //       $scope.proximoimgCriador = 'img/badges/Geral/Eventos/Criador/Super.png';
  //       document.getElementById("Criador").src="img/badges/Geral/Eventos/Criador/3.3.png"
  //     }

  //     if(badges.length >= 40){
  //       $scope.anteriorimgCriador = 'img/badges/Geral/Eventos/Criador/3.3.png';
  //       $scope.proximoCriador = 10000;
  //       $scope.proximoimgCriador = 'img/badges/Geral/Eventos/Criador/Super.png';
  //       document.getElementById("Criador").src="img/badges/Geral/Eventos/Criador/Super.png"
  //     }

  //   }else{
  //     document.getElementById("Criador").src="img/badges/Geral/Eventos/Criador/0.png"
  //   }
  // });

  // $scope.auxnbadgeParticipante = 0;
  // $scope.proximoParticipante = 0;
  // $scope.proximoimgParticipante = '';
  // $scope.anteriorimgParticipante = '';
  // EventoService.GetParticipanteBagde($scope.user).then(function(badges) {
  //   //console.log(badges.length,"GetParticipanteBagde")
  //   if(badges!="Error" && badges !="E"){
  //     $scope.auxnbadgeParticipante = badges.length;
  //     if(badges.length == 0){
  //       $scope.anteriorimgParticipante = 'img/badges/Geral/Eventos/Participante/0.png';
  //       $scope.proximoParticipante = 1;
  //       $scope.proximoimgParticipante = 'img/badges/Geral/Eventos/Participante/1.png';
  //       document.getElementById("Participante").src="img/badges/Geral/Eventos/Participante/0.png"
  //     }
  //     if(badges.length == 1){
  //       $scope.anteriorimgParticipante = 'img/badges/Geral/Eventos/Participante/0.png';
  //       $scope.proximoParticipante = 2;
  //       $scope.proximoimgParticipante = 'img/badges/Geral/Eventos/Participante/1.1.png';
  //       document.getElementById("Participante").src="img/badges/Geral/Eventos/Participante/1.png"
  //     }
  //     if(badges.length == 2){
  //       $scope.anteriorimgParticipante = 'img/badges/Geral/Eventos/Participante/1.png';
  //       $scope.proximoParticipante = 3;
  //       $scope.proximoimgParticipante = 'img/badges/Geral/Eventos/Participante/1.2.png';
  //       document.getElementById("Participante").src="img/badges/Geral/Eventos/Participante/1.1.png"
  //     }
  //     if(badges.length == 3){
  //       $scope.anteriorimgParticipante = 'img/badges/Geral/Eventos/Participante/1.1.png';
  //       $scope.proximoParticipante = 4;
  //       $scope.proximoimgParticipante = 'img/badges/Geral/Eventos/Participante/1.3.png';
  //       document.getElementById("Participante").src="img/badges/Geral/Eventos/Participante/1.2.png"
  //     }
  //     if(badges.length >= 4 && badges.length < 6){
  //       $scope.anteriorimgParticipante = 'img/badges/Geral/Eventos/Participante/1.2.png';
  //       $scope.proximoParticipante = 6;
  //       $scope.proximoimgParticipante = 'img/badges/Geral/Eventos/Participante/2.png';
  //       document.getElementById("Participante").src="img/badges/Geral/Eventos/Participante/1.3.png"
  //     }

  //     if(badges.length >= 6 && badges.length < 8){
  //       $scope.anteriorimgParticipante = 'img/badges/Geral/Eventos/Participante/1.3.png';
  //       $scope.proximoParticipante = 8;
  //       $scope.proximoimgParticipante = 'img/badges/Geral/Eventos/Participante/2.1.png';
  //       document.getElementById("Participante").src="img/badges/Geral/Eventos/Participante/2.png"
  //     }
  //     if(badges.length >= 8 && badges.length < 10){
  //       $scope.anteriorimgParticipante = 'img/badges/Geral/Eventos/Participante/2.png';
  //       $scope.proximoParticipante = 10;
  //       $scope.proximoimgParticipante = 'img/badges/Geral/Eventos/Participante/2.2.png';
  //       document.getElementById("Participante").src="img/badges/Geral/Eventos/Participante/2.1.png"
  //     }
  //     if(badges.length >= 10 && badges.length < 12){
  //       $scope.anteriorimgParticipante = 'img/badges/Geral/Eventos/Participante/2.1.png';
  //       $scope.proximoParticipante = 12;
  //       $scope.proximoimgParticipante = 'img/badges/Geral/Eventos/Participante/2.3.png';
  //       document.getElementById("Participante").src="img/badges/Geral/Eventos/Participante/2.2.png"
  //     }
  //     if(badges.length >= 12 && badges.length < 20){
  //       $scope.anteriorimgParticipante = 'img/badges/Geral/Eventos/Participante/2.2.png';
  //       $scope.proximoParticipante = 20;
  //       $scope.proximoimgParticipante = 'img/badges/Geral/Eventos/Participante/3.png';
  //       document.getElementById("Participante").src="img/badges/Geral/Eventos/Participante/2.3.png"
  //     }

  //     if(badges.length >= 20 && badges.length < 25 ){
  //       $scope.anteriorimgParticipante = 'img/badges/Geral/Eventos/Participante/2.3.png';
  //       $scope.proximoParticipante = 25;
  //       $scope.proximoimgParticipante = 'img/badges/Geral/Eventos/Participante/3.1.png';
  //       document.getElementById("Participante").src="img/badges/Geral/Eventos/Participante/3.png"
  //     }
  //     if(badges.length >= 25 && badges.length < 30 ){
  //       $scope.anteriorimgParticipante = 'img/badges/Geral/Eventos/Participante/3.png';
  //       $scope.proximoParticipante = 30;
  //       $scope.proximoimgParticipante = 'img/badges/Geral/Eventos/Participante/3.2.png';
  //       document.getElementById("Participante").src="img/badges/Geral/Eventos/Participante/3.1.png"
  //     }
  //     if(badges.length >= 30 && badges.length < 35 ){
  //       $scope.anteriorimgParticipante = 'img/badges/Geral/Eventos/Participante/3.1.png';
  //       $scope.proximoParticipante = 35;
  //       $scope.proximoimgParticipante = 'img/badges/Geral/Eventos/Participante/3.3.png';
  //       document.getElementById("Participante").src="img/badges/Geral/Eventos/Participante/3.2.png"
  //     }
  //     if(badges.length >= 35 && badges.length < 50 ){
  //       $scope.anteriorimgParticipante = 'img/badges/Geral/Eventos/Participante/3.2.png';
  //       $scope.proximoParticipante = 50;
  //       $scope.proximoimgParticipante = 'img/badges/Geral/Eventos/Participante/Super.png';
  //       document.getElementById("Participante").src="img/badges/Geral/Eventos/Participante/3.3.png"
  //     }

  //     if(badges.length >= 50){
  //       $scope.anteriorimgParticipante = 'img/badges/Geral/Eventos/Participante/3.3.png';
  //       $scope.proximoParticipante = 10000;
  //       $scope.proximoimgParticipante = 'img/badges/Geral/Eventos/Participante/Super.png';
  //       document.getElementById("Participante").src="img/badges/Geral/Eventos/Participante/Super.png"
  //     }

  //   }else{
  //     document.getElementById("Participante").src="img/badges/Geral/Eventos/Participante/0.png"
  //   }
  // });

  // $scope.auxnbadgeComentarios = 0;
  // $scope.proximoComentarios = 0;
  // $scope.proximoimgComentarios = '';
  // $scope.anteriorimgComentarios = '';
  // EventoService.GetBadgeComentarioPost($scope.user).then(function(badges) {
  //   //console.log(badges.length,"GetBadgeComentarioPost",badges )
  //   if(badges!="Error" && badges !="E"){
  //     $scope.auxnbadgeComentarios = badges.length;
  //     //console.log("faisdfniasidn", badges.length)
  //     if(badges.length == 0){
  //       $scope.anteriorimgComentarios = 'img/badges/Geral/Posts/Comentarios/0.png';
  //       $scope.proximoComentarios = 1;
  //       $scope.proximoimgComentarios = 'img/badges/Geral/Posts/Comentarios/1.png';
  //       document.getElementById("Comentarios").src="img/badges/Geral//Posts/Comentarios/0.png"
  //     }
  //     if(badges.length >= 1 && badges.length < 5){
  //       $scope.anteriorimgComentarios = 'img/badges/Geral/Posts/Comentarios/0.png';
  //       $scope.proximoComentarios = 5;
  //       $scope.proximoimgComentarios = 'img/badges/Geral/Posts/Comentarios/1.1.png';
  //       document.getElementById("Comentarios").src="img/badges/Geral/Posts/Comentarios/1.png"
  //     }
  //     if(badges.length >= 5 && badges.length < 10){
  //       $scope.anteriorimgComentarios = 'img/badges/Geral/Posts/Comentarios/1.png';
  //       $scope.proximoComentarios = 10;
  //       $scope.proximoimgComentarios = 'img/badges/Geral/Posts/Comentarios/1.2.png';
  //       document.getElementById("Comentarios").src="img/badges/Geral/Posts/Comentarios/1.1.png"
  //     }
  //     if(badges.length >= 10 && badges.length < 15){
  //       $scope.anteriorimgComentarios = 'img/badges/Geral/Posts/Comentarios/1.1.png';
  //       $scope.proximoComentarios = 15;
  //       $scope.proximoimgComentarios = 'img/badges/Geral/Posts/Comentarios/1.3.png';
  //       document.getElementById("Comentarios").src="img/badges/Geral/Posts/Comentarios/1.2.png"
  //     }
  //     if(badges.length >= 15 && badges.length < 30){
  //       $scope.anteriorimgComentarios = 'img/badges/Geral/Posts/Comentarios/1.2.png';
  //       $scope.proximoComentarios = 30;
  //       $scope.proximoimgComentarios = 'img/badges/Geral/Posts/Comentarios/2.png';
  //       console.log("faisdfniasidn")
  //       document.getElementById("Comentarios").src="img/badges/Geral/Posts/Comentarios/1.3.png"
  //     }

  //     if(badges.length >= 30 && badges.length < 40){
  //       $scope.anteriorimgComentarios = 'img/badges/Geral/Posts/Comentarios/1.3.png';
  //       $scope.proximoComentarios = 40;
  //       $scope.proximoimgComentarios = 'img/badges/Geral/Posts/Comentarios/2.1.png';
  //       document.getElementById("Comentarios").src="img/badges/Geral/Posts/Comentarios/2.png"
  //     }
  //     if(badges.length >= 40 && badges.length < 50){
  //       $scope.anteriorimgComentarios = 'img/badges/Geral/Posts/Comentarios/2.png';
  //       $scope.proximoComentarios = 50;
  //       $scope.proximoimgComentarios = 'img/badges/Geral/Posts/Comentarios/2.2.png';
  //       document.getElementById("Comentarios").src="img/badges/Geral/Posts/Comentarios/2.1.png"
  //     }
  //     if(badges.length >= 50 && badges.length < 60){
  //       $scope.anteriorimgComentarios = 'img/badges/Geral/Posts/Comentarios/2.1.png';
  //       $scope.proximoComentarios = 60;
  //       $scope.proximoimgComentarios = 'img/badges/Geral/Posts/Comentarios/2.3.png';
  //       document.getElementById("Comentarios").src="img/badges/Geral/Posts/Comentarios/2.2.png"
  //     }
  //     if(badges.length >= 60 && badges.length < 80){
  //       $scope.anteriorimgComentarios = 'img/badges/Geral/Posts/Comentarios/2.2.png';
  //       $scope.proximoComentarios = 80;
  //       $scope.proximoimgComentarios = 'img/badges/Geral/Posts/Comentarios/3.png';
  //       document.getElementById("Comentarios").src="img/badges/Geral/Posts/Comentarios/2.3.png"
  //     }

  //     if(badges.length >= 80 && badges.length < 110 ){
  //       $scope.anteriorimgComentarios = 'img/badges/Geral/Posts/Comentarios/2.3.png';
  //       $scope.proximoComentarios = 110;
  //       $scope.proximoimgComentarios = 'img/badges/Geral/Posts/Comentarios/3.1.png';
  //       document.getElementById("Comentarios").src="img/badges/Geral/Posts/Comentarios/3.png"
  //     }
  //     if(badges.length >= 110 && badges.length < 140 ){
  //       $scope.anteriorimgComentarios = 'img/badges/Geral/Posts/Comentarios/3.png';
  //       $scope.proximoComentarios = 140;
  //       $scope.proximoimgComentarios = 'img/badges/Geral/Posts/Comentarios/3.2.png';
  //       document.getElementById("Comentarios").src="img/badges/Geral/Posts/Comentarios/3.1.png"
  //     }
  //     if(badges.length >= 140 && badges.length < 170 ){
  //       $scope.anteriorimgComentarios = 'img/badges/Geral/Posts/Comentarios/3.1.png';
  //       $scope.proximoComentarios = 170;
  //       $scope.proximoimgComentarios = 'img/badges/Geral/Posts/Comentarios/3.3.png';
  //       document.getElementById("Comentarios").src="img/badges/Geral/Posts/Comentarios/3.2.png"
  //     }
  //     if(badges.length >= 170 && badges.length < 230 ){
  //       $scope.anteriorimgComentarios = 'img/badges/Geral/Posts/Comentarios/3.2.png';
  //       $scope.proximoComentarios = 230;
  //       $scope.proximoimgComentarios = 'img/badges/Geral/Posts/Comentarios/Super.png';
  //       document.getElementById("Comentarios").src="img/badges/Geral/Posts/Comentarios/3.3.png"
  //     }

  //     if(badges.length >= 230){
  //       $scope.anteriorimgComentarios = 'img/badges/Geral/Posts/Comentarios/3.3.png';
  //       $scope.proximoComentarios = 10000;
  //       $scope.proximoimgComentarios = 'img/badges/Geral/Posts/Comentarios/Super.png';
  //       document.getElementById("Comentarios").src="img/badges/Geral/Posts/Comentarios/Super.png"
  //     }

  //   }else{
  //     document.getElementById("Comentarios").src="img/badges/Geral/Posts/Comentarios/0.png"
  //   }
  // });

  // $scope.auxnbadgeOriginalPoster = 0;
  // $scope.proximoOriginalPoster = 0;
  // $scope.proximoimgOriginalPoster = '';
  // $scope.anteriorimgOriginalPoster = '';
  // EventoService.GetFeedMeusPost($scope.user).then(function(badges) {
  //   //console.log(badges.length,"GetBadgeComentarioPost",badges )
  //   if(badges!="Error" && badges !="E"){
  //     $scope.auxnbadgeOriginalPoster = badges.length;
  //     //console.log("faisdfniasidn", badges.length)
  //     if(badges.length == 0){
  //       $scope.anteriorimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/0.png';
  //       $scope.proximoOriginalPoster = 1;
  //       $scope.proximoimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/1.png';
  //       document.getElementById("OriginalPoster").src="img/badges/Geral//Posts/OriginalPoster/0.png"
  //     }
  //     if(badges.length >= 1 && badges.length < 3){
  //       $scope.anteriorimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/0.png';
  //       $scope.proximoOriginalPoster = 3;
  //       $scope.proximoimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/1.1.png';
  //       document.getElementById("OriginalPoster").src="img/badges/Geral/Posts/OriginalPoster/1.png"
  //     }
  //     if(badges.length >= 3 && badges.length < 5){
  //       $scope.anteriorimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/1.png';
  //       $scope.proximoOriginalPoster = 5;
  //       $scope.proximoimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/1.2.png';
  //       document.getElementById("OriginalPoster").src="img/badges/Geral/Posts/OriginalPoster/1.1.png"
  //     }
  //     if(badges.length >= 5 && badges.length < 7){
  //       $scope.anteriorimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/1.1.png';
  //       $scope.proximoOriginalPoster = 7;
  //       $scope.proximoimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/1.3.png';
  //       document.getElementById("OriginalPoster").src="img/badges/Geral/Posts/OriginalPoster/1.2.png"
  //     }
  //     if(badges.length >= 7 && badges.length < 10){
  //       $scope.anteriorimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/1.2.png';
  //       $scope.proximoOriginalPoster = 10;
  //       $scope.proximoimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/2.png';
       
  //       document.getElementById("OriginalPoster").src="img/badges/Geral/Posts/OriginalPoster/1.3.png"
  //     }

  //     if(badges.length >= 10 && badges.length < 15){
  //       $scope.anteriorimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/1.3.png';
  //       $scope.proximoOriginalPoster = 15;
  //       $scope.proximoimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/2.1.png';
  //       document.getElementById("OriginalPoster").src="img/badges/Geral/Posts/OriginalPoster/2.png"
  //     }
  //     if(badges.length >= 15 && badges.length < 20){
  //       $scope.anteriorimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/2.png';
  //       $scope.proximoOriginalPoster = 20;
  //       $scope.proximoimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/2.2.png';
  //       document.getElementById("OriginalPoster").src="img/badges/Geral/Posts/OriginalPoster/2.1.png"
  //     }
  //     if(badges.length >= 20 && badges.length < 25){
  //       $scope.anteriorimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/2.1.png';
  //       $scope.proximoOriginalPoster = 25;
  //       $scope.proximoimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/2.3.png';
  //       document.getElementById("OriginalPoster").src="img/badges/Geral/Posts/OriginalPoster/2.2.png"
  //     }
  //     if(badges.length >= 25 && badges.length < 35){
  //       $scope.anteriorimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/2.2.png';
  //       $scope.proximoOriginalPoster = 35;
  //       $scope.proximoimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/3.png';
  //       document.getElementById("OriginalPoster").src="img/badges/Geral/Posts/OriginalPoster/2.3.png"
  //     }

  //     if(badges.length >= 35 && badges.length < 45 ){
  //       $scope.anteriorimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/2.3.png';
  //       $scope.proximoOriginalPoster = 45;
  //       $scope.proximoimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/3.1.png';
  //       document.getElementById("OriginalPoster").src="img/badges/Geral/Posts/OriginalPoster/3.png"
  //     }
  //     if(badges.length >= 45 && badges.length < 55 ){
  //       $scope.anteriorimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/3.png';
  //       $scope.proximoOriginalPoster = 55;
  //       $scope.proximoimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/3.2.png';
  //       document.getElementById("OriginalPoster").src="img/badges/Geral/Posts/OriginalPoster/3.1.png"
  //     }
  //     if(badges.length >= 55 && badges.length < 65 ){
  //       $scope.anteriorimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/3.1.png';
  //       $scope.proximoOriginalPoster = 65;
  //       $scope.proximoimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/3.3.png';
  //       document.getElementById("OriginalPoster").src="img/badges/Geral/Posts/OriginalPoster/3.2.png"
  //     }
  //     if(badges.length >= 65 && badges.length < 80 ){
  //       $scope.anteriorimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/3.2.png';
  //       $scope.proximoOriginalPoster = 80;
  //       $scope.proximoimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/Super.png';
  //       document.getElementById("OriginalPoster").src="img/badges/Geral/Posts/OriginalPoster/3.3.png"
  //     }

  //     if(badges.length >= 80){
  //       $scope.anteriorimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/3.3.png';
  //       $scope.proximoOriginalPoster = 10000;
  //       $scope.proximoimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/Super.png';
  //       document.getElementById("OriginalPoster").src="img/badges/Geral/Posts/OriginalPoster/Super.png"
  //     }

  //   }else{
  //     document.getElementById("OriginalPoster").src="img/badges/Geral/Posts/OriginalPoster/0.png"
  //   }
  // });
  
  // $scope.auxnbadgeUpvotes = 0;
  // $scope.proximoUpvotes = 0;
  // $scope.proximoimgUpvotes = '';
  // $scope.anteriorimgUpvotes = '';
  // EventoService.GetBadgeUpvote($scope.user).then(function(badges) {
  //   console.log(badges.length,"GetBadgeComentarioPost",badges )
  //   if(badges!="Error" && badges !="E"){
  //     $scope.auxnbadgeUpvotes = badges.length;
  //     console.log("faisdfniasidn", badges.length)
  //     if(badges.length == 0){
  //       $scope.anteriorimgUpvotes = 'img/badges/Geral/Posts/Upvotes/0.png';
  //       $scope.proximoUpvotes = 1;
  //       $scope.proximoimgUpvotes = 'img/badges/Geral/Posts/Upvotes/1.png';
  //       document.getElementById("Upvotes").src="img/badges/Geral//Posts/Upvotes/0.png"
  //     }
  //     if(badges.length >= 1 && badges.length < 5){
  //       $scope.anteriorimgUpvotes = 'img/badges/Geral/Posts/Upvotes/0.png';
  //       $scope.proximoUpvotes = 5;
  //       $scope.proximoimgUpvotes = 'img/badges/Geral/Posts/Upvotes/1.1.png';
  //       document.getElementById("Upvotes").src="img/badges/Geral/Posts/Upvotes/1.png"
  //     }
  //     if(badges.length >= 5 && badges.length < 10){
  //       $scope.anteriorimgUpvotes = 'img/badges/Geral/Posts/Upvotes/1.png';
  //       $scope.proximoUpvotes = 10;
  //       $scope.proximoimgUpvotes = 'img/badges/Geral/Posts/Upvotes/1.2.png';
  //       document.getElementById("Upvotes").src="img/badges/Geral/Posts/Upvotes/1.1.png"
  //     }
  //     if(badges.length >= 10 && badges.length < 15){
  //       $scope.anteriorimgUpvotes = 'img/badges/Geral/Posts/Upvotes/1.1.png';
  //       $scope.proximoUpvotes = 15;
  //       $scope.proximoimgUpvotes = 'img/badges/Geral/Posts/Upvotes/1.3.png';
  //       document.getElementById("Upvotes").src="img/badges/Geral/Posts/Upvotes/1.2.png"
  //     }
  //     if(badges.length >= 15 && badges.length < 25){
  //       $scope.anteriorimgUpvotes = 'img/badges/Geral/Posts/Upvotes/1.2.png';
  //       $scope.proximoUpvotes = 25;
  //       $scope.proximoimgUpvotes = 'img/badges/Geral/Posts/Upvotes/2.png';
       
  //       document.getElementById("Upvotes").src="img/badges/Geral/Posts/Upvotes/1.3.png"
  //     }

  //     if(badges.length >= 25 && badges.length < 35){
  //       $scope.anteriorimgUpvotes = 'img/badges/Geral/Posts/Upvotes/1.3.png';
  //       $scope.proximoUpvotes = 35;
  //       $scope.proximoimgUpvotes = 'img/badges/Geral/Posts/Upvotes/2.1.png';
  //       document.getElementById("Upvotes").src="img/badges/Geral/Posts/Upvotes/2.png"
  //     }
  //     if(badges.length >= 35 && badges.length < 45){
  //       $scope.anteriorimgUpvotes = 'img/badges/Geral/Posts/Upvotes/2.png';
  //       $scope.proximoUpvotes = 45;
  //       $scope.proximoimgUpvotes = 'img/badges/Geral/Posts/Upvotes/2.2.png';
  //       document.getElementById("Upvotes").src="img/badges/Geral/Posts/Upvotes/2.1.png"
  //     }
  //     if(badges.length >= 45 && badges.length < 55){
  //       $scope.anteriorimgUpvotes = 'img/badges/Geral/Posts/Upvotes/2.1.png';
  //       $scope.proximoUpvotes = 55;
  //       $scope.proximoimgUpvotes = 'img/badges/Geral/Posts/Upvotes/2.3.png';
  //       document.getElementById("Upvotes").src="img/badges/Geral/Posts/Upvotes/2.2.png"
  //     }
  //     if(badges.length >= 55 && badges.length < 80){
  //       $scope.anteriorimgUpvotes = 'img/badges/Geral/Posts/Upvotes/2.2.png';
  //       $scope.proximoUpvotes = 80;
  //       $scope.proximoimgUpvotes = 'img/badges/Geral/Posts/Upvotes/3.png';
  //       document.getElementById("Upvotes").src="img/badges/Geral/Posts/Upvotes/2.3.png"
  //     }

  //     if(badges.length >= 80 && badges.length < 100 ){
  //       $scope.anteriorimgUpvotes = 'img/badges/Geral/Posts/Upvotes/2.3.png';
  //       $scope.proximoUpvotes = 100;
  //       $scope.proximoimgUpvotes = 'img/badges/Geral/Posts/Upvotes/3.1.png';
  //       document.getElementById("Upvotes").src="img/badges/Geral/Posts/Upvotes/3.png"
  //     }
  //     if(badges.length >= 100 && badges.length < 120 ){
  //       $scope.anteriorimgUpvotes = 'img/badges/Geral/Posts/Upvotes/3.png';
  //       $scope.proximoUpvotes = 120;
  //       $scope.proximoimgUpvotes = 'img/badges/Geral/Posts/Upvotes/3.2.png';
  //       document.getElementById("Upvotes").src="img/badges/Geral/Posts/Upvotes/3.1.png"
  //     }
  //     if(badges.length >= 120 && badges.length < 140 ){
  //       $scope.anteriorimgUpvotes = 'img/badges/Geral/Posts/Upvotes/3.1.png';
  //       $scope.proximoUpvotes = 140;
  //       $scope.proximoimgUpvotes = 'img/badges/Geral/Posts/Upvotes/3.3.png';
  //       document.getElementById("Upvotes").src="img/badges/Geral/Posts/Upvotes/3.2.png"
  //     }
  //     if(badges.length >= 140 && badges.length < 200 ){
  //       $scope.anteriorimgUpvotes = 'img/badges/Geral/Posts/Upvotes/3.2.png';
  //       $scope.proximoUpvotes = 200;
  //       $scope.proximoimgUpvotes = 'img/badges/Geral/Posts/Upvotes/Super.png';
  //       document.getElementById("Upvotes").src="img/badges/Geral/Posts/Upvotes/3.3.png"
  //     }

  //     if(badges.length >= 200){
  //       $scope.anteriorimgUpvotes = 'img/badges/Geral/Posts/Upvotes/3.3.png';
  //       $scope.proximoUpvotes = 100000;
  //       $scope.proximoimgUpvotes = 'img/badges/Geral/Posts/Upvotes/Super.png';
  //       document.getElementById("Upvotes").src="img/badges/Geral/Posts/Upvotes/Super.png"
  //     }

  //   }else{
  //     document.getElementById("Upvotes").src="img/badges/Geral/Posts/Upvotes/0.png"
  //   }
  // });

  $scope.naotembadgescomercio = ""
  EventoService.GetComercioFinalizado($scope.user).then(function(badges) {  //console.log(badges.length,"GetBadgeComentarioPost",badges )
    if(badges!="error" && badges !="e"){
      console.log("faisdfniasidn", badges.length)
     for(var i =0 ;i<badges.length;i++){
        if(badges[i].idcomercio == '53'){
          if(badges[i].n == '1'){
            document.getElementById("Paintball").src="img/badges/Comercios/Paintball/1.png"
          }
          if(badges[i].n == '2'){
            document.getElementById("Paintball").src="img/badges/Comercios/Paintball/2.png"
          }
          if(badges[i].n >= '3'){
            document.getElementById("Paintball").src="img/badges/Comercios/Paintball/3.png"
          }
        }
        if(badges[i].idcomercio == '222'){
          if(badges[i].n == '1'){
            document.getElementById("BarcoPirataItapema").src="img/badges/Comercios/BarcoPirataItapema/1.png"
          }
          if(badges[i].n == '2'){
            document.getElementById("BarcoPirataItapema").src="img/badges/Comercios/BarcoPirataItapema/2.png"
          }
          if(badges[i].n >= '3'){
            document.getElementById("BarcoPirataItapema").src="img/badges/Comercios/BarcoPirataItapema/3.png"
          }
        }
        if(badges[i].idcomercio == '223'){
          if(badges[i].n == '1'){
            document.getElementById("BCWalkingTour").src="img/badges/Comercios/BCWalkingTour/1.png"
          }
          if(badges[i].n == '2'){
            document.getElementById("BCWalkingTour").src="img/badges/Comercios/BCWalkingTour/2.png"
          }
          if(badges[i].n >= '3'){
            document.getElementById("BCWalkingTour").src="img/badges/Comercios/BCWalkingTour/3.png"
          }
        }
        if(badges[i].idcomercio == '225'){
          if(badges[i].n == '1'){
            document.getElementById("BravaBeachSports").src="img/badges/Comercios/BravaBeachSports/1.png"
          }
          if(badges[i].n == '2'){
            document.getElementById("BravaBeachSports").src="img/badges/Comercios/BravaBeachSports/2.png"
          }
          if(badges[i].n >= '3'){
            document.getElementById("BravaBeachSports").src="img/badges/Comercios/BravaBeachSports/3.png"
          }
        }
        if(badges[i].idcomercio == '227'){
          if(badges[i].n == '1'){
            document.getElementById("MVBTennisPaddel").src="img/badges/Comercios/MVBTennisPaddel/1.png"
          }
          if(badges[i].n == '2'){
            document.getElementById("MVBTennisPaddel").src="img/badges/Comercios/MVBTennisPaddel/2.png"
          }
          if(badges[i].n >= '3'){
            document.getElementById("MVBTennisPaddel").src="img/badges/Comercios/MVBTennisPaddel/3.png"
          }
        }
        
        if(badges[i].idcomercio == '228'){
          if(badges[i].n == '1'){
            document.getElementById("TriboDaÁgua").src="img/badges/Comercios/TriboDaÁgua/1.png"
          }
          if(badges[i].n == '2'){
            document.getElementById("TriboDaÁgua").src="img/badges/Comercios/TriboDaÁgua/2.png"
          }
          if(badges[i].n >= '3'){
            document.getElementById("TriboDaÁgua").src="img/badges/Comercios/TriboDaÁgua/3.png"
          }
        }
      }
            

    }else{
      $scope.naotembadgescomercio = "Ainda não há nenhuma conquista em locais parceiros"
    }
  });
  $scope.naotembadgesgeral = ""
  $scope.auxnbadgeNumberOneHExa = 0;
  $scope.proximoNumberOneHExa = 0;
  $scope.proximoimgNumberOneHExa = '';
  $scope.anteriorimgNumberOneHExa = '';
  EventoService.getusuario($scope.user).then(function(user) {
      $scope.user = user;
      if(user.numcodigo){
        if(user.numcodigo == '0'){
          $scope.auxnbadgeNumberOneHExa = 0;
          $scope.anteriorimgNumberOneHExa = 'img/egg_0.png';
          $scope.proximoNumberOneHExa = 1;
          $scope.proximoimgNumberOneHExa = 'img/egg_1.png';
          document.getElementById("NumberOneHExa").src="img/egg_0.png";
        }
        if(user.numcodigo == '1'){
          $scope.auxnbadgeNumberOneHExa = 1;
          $scope.anteriorimgNumberOneHExa = 'img/egg_0.png';
          $scope.proximoNumberOneHExa = 2;
          $scope.proximoimgNumberOneHExa = 'img/egg_2.png';
          document.getElementById("NumberOneHExa").src="img/egg_1.png";
        }
        if(user.numcodigo == '2'){
          $scope.auxnbadgeNumberOneHExa = 2;
          $scope.anteriorimgNumberOneHExa = 'img/egg_1.png';
          $scope.proximoNumberOneHExa = 3;
          $scope.proximoimgNumberOneHExa = 'img/NumberOneHExa.png';
          document.getElementById("NumberOneHExa").src="img/egg_2.png";
        }
        if(parseInt(user.numcodigo) >= 3){
          $scope.auxnbadgeNumberOneHExa = 3;
          $scope.anteriorimgNumberOneHExa = 'img/egg_2.png';
          $scope.proximoNumberOneHExa = 1000;
          $scope.proximoimgNumberOneHExa = 'img/NumberOneHExa.png';
          document.getElementById("NumberOneHExa").src="img/NumberOneHExa.png";
        }
        if(parseInt(user.numcodigo) < 0){
          $scope.auxnbadgeNumberOneHExa = 3;
          $scope.anteriorimgNumberOneHExa = 'img/egg_2.png';
          $scope.proximoNumberOneHExa = 1000;
          $scope.proximoimgNumberOneHExa = 'img/NumberOneHExa.png';
          document.getElementById("NumberOneHExa").src="img/NumberOneHExa.png";
        } 
      }else{
        $scope.naotembadgesgeral = "Ainda não há nenhuma conquista aqui"
      }
      

  });

  $scope.entraBadge = function(badge){
    console.log("badge",badge);
    $scope.badge = {};
    if(badge == 'QuantidadePersonalidades'){
      $scope.badge.titulo = 'Self Awareness';
      $scope.badge.texto = 'Quanto mais avaliações referentes à nossa personalidade, mais entendemos como as pessoas nos veem. Isso pode ser útil para nos conhecermos melhor!';
      $scope.badge.numeroatual = $scope.auxnbadgeQuantidadePersonalidades;
      $scope.badge.numeroproximo = $scope.proximoQuantidadePersonalidades
      $scope.badge.imgatual = document.getElementById("QuantidadePersonalidades").src;
      $scope.badge.imganterior = $scope.anteriorimgQuantidadePersonalidades;
      $scope.badge.imgproximo = $scope.proximoimgQuantidadePersonalidades;
      formBadge.updateForm($scope.badge);
      $state.go('tabsController.badgesexplicaperfil_outro_eventoabertos');
    }
    if(badge == 'SmartDealer'){
      $scope.badge.titulo = 'Smart Dealer';
      $scope.badge.texto = 'Um Din Din Baggy é inteligente, ele cria eventos que oferecem recompensas para gastar menos fazendo mais.';
      $scope.badge.numeroatual = $scope.auxnbadgeSmartDealer;
      $scope.badge.numeroproximo = $scope.proximoSmartDealer
      $scope.badge.imgatual = document.getElementById("SmartDealer").src;
      $scope.badge.imganterior = $scope.anteriorimgSmartDealer;
      $scope.badge.imgproximo = $scope.proximoimgSmartDealer;
      formBadge.updateForm($scope.badge);
      $state.go('tabsController.badgesexplicaperfil_outro_eventoabertos');
    }
    if(badge == 'Criador'){
      $scope.badge.titulo = 'Creator';
      $scope.badge.texto = 'Cria eventos no app';
      $scope.badge.numeroatual = $scope.auxnbadgeCriador;
      $scope.badge.numeroproximo = $scope.proximoCriador
      $scope.badge.imgatual = document.getElementById("Criador").src;
      $scope.badge.imganterior = $scope.anteriorimgCriador;
      $scope.badge.imgproximo = $scope.proximoimgCriador;
      formBadge.updateForm($scope.badge);
      $state.go('tabsController.badgesexplicaperfil_outro_eventoabertos');
    }
    if(badge == 'Participante'){
      $scope.badge.titulo = 'Story Maker';
      $scope.badge.texto = 'Participa de eventos no app';
      $scope.badge.numeroatual = $scope.auxnbadgeParticipante;
      $scope.badge.numeroproximo = $scope.proximoParticipante;
      $scope.badge.imgatual = document.getElementById("Participante").src;
      $scope.badge.imganterior = $scope.anteriorimgParticipante;
      $scope.badge.imgproximo = $scope.proximoimgParticipante;
      formBadge.updateForm($scope.badge);
      $state.go('tabsController.badgesexplicaperfil_outro_eventoabertos');
    }
    if(badge == 'Comentarios'){
      $scope.badge.titulo = 'Community Activist';
      $scope.badge.texto = 'Um(a) ativista da sua comunidade local através de comentários em posts';
      $scope.badge.numeroatual = $scope.auxnbadgeComentarios;
      $scope.badge.numeroproximo = $scope.proximoComentarios
      $scope.badge.imgatual = document.getElementById("Comentarios").src;
      $scope.badge.imganterior = $scope.anteriorimgComentarios;
      $scope.badge.imgproximo = $scope.proximoimgComentarios;
      formBadge.updateForm($scope.badge);
      $state.go('tabsController.badgesexplicaperfil_outro_eventoabertos');
    }
    if(badge == 'OriginalPoster'){
      $scope.badge.titulo = 'Original Poster';
      $scope.badge.texto = 'Cria engajamento da sua comunidade local através da criação de posts';
      $scope.badge.numeroatual = $scope.auxnbadgeOriginalPoster;
      $scope.badge.numeroproximo = $scope.proximoOriginalPoster
      $scope.badge.imgatual = document.getElementById("OriginalPoster").src;
      $scope.badge.imganterior = $scope.anteriorimgOriginalPoster;
      $scope.badge.imgproximo = $scope.proximoimgOriginalPoster;
      formBadge.updateForm($scope.badge);
      $state.go('tabsController.badgesexplicaperfil_outro_eventoabertos');
    }
    if(badge == 'Upvotes'){
      $scope.badge.titulo = 'Community Supporter';
      $scope.badge.texto = 'Um suporte da sua comunidade local que ajuda a filtrar os bons posts dos ruins através de upvotes';
      $scope.badge.numeroatual = $scope.auxnbadgeUpvotes;
      $scope.badge.numeroproximo = $scope.proximoUpvotes
      $scope.badge.imgatual = document.getElementById("Upvotes").src;
      $scope.badge.imganterior = $scope.anteriorimgUpvotes;
      $scope.badge.imgproximo = $scope.proximoimgUpvotes;
      formBadge.updateForm($scope.badge);
      $state.go('tabsController.badgesexplicaperfil_outro_eventoabertos');
    }
    if(badge == 'NumberOneHExa'){
      $scope.badge.titulo = 'Amigo que chama';
      $scope.badge.texto = 'Convida amigos quando descobre um app novo';
      $scope.badge.numeroatual = $scope.auxnbadgeNumberOneHExa;
      $scope.badge.numeroproximo = $scope.proximoNumberOneHExa
      $scope.badge.imgatual = document.getElementById("NumberOneHExa").src;
      $scope.badge.imganterior = $scope.anteriorimgNumberOneHExa;
      $scope.badge.imgproximo = $scope.proximoimgNumberOneHExa;
      formBadge.updateForm($scope.badge);
      $state.go('tabsController.badgesexplicaperfil_outro_eventoabertos');
    }
    if(badge == 'ArteeCultura'){
      $scope.badge.titulo = 'Cult';
      $scope.badge.texto = 'Você participou de eventos com #ArteeCultura';
      $scope.badge.numeroatual = $scope.auxnbadgeArteeCultura;
      $scope.badge.numeroproximo = $scope.proximoArteeCultura
      $scope.badge.imgatual = document.getElementById("ArteeCultura").src;
      $scope.badge.imganterior = $scope.anteriorimgArteeCultura;
      $scope.badge.imgproximo = $scope.proximoimgArteeCultura;
      formBadge.updateForm($scope.badge);
      $state.go('tabsController.badgesexplicaperfil_outro_eventoabertos');
    }
    if(badge == 'Ciclismo'){
      $scope.badge.titulo = 'Pedal';
      $scope.badge.texto = 'Você participou de eventos com #Ciclismo';
      $scope.badge.numeroatual = $scope.auxnbadgeCiclismo;
      $scope.badge.numeroproximo = $scope.proximoCiclismo
      $scope.badge.imgatual = document.getElementById("Ciclismo").src;
      $scope.badge.imganterior = $scope.anteriorimgCiclismo;
      $scope.badge.imgproximo = $scope.proximoimgCiclismo;
      formBadge.updateForm($scope.badge);
      $state.go('tabsController.badgesexplicaperfil_outro_eventoabertos');
    }
    if(badge == 'Conversa'){
      $scope.badge.titulo = 'Falador(a)';
      $scope.badge.texto = 'Você participou de eventos com #Conversa';
      $scope.badge.numeroatual = $scope.auxnbadgeConversa;
      $scope.badge.numeroproximo = $scope.proximoConversa
      $scope.badge.imgatual = document.getElementById("Conversa").src;
      $scope.badge.imganterior = $scope.anteriorimgConversa;
      $scope.badge.imgproximo = $scope.proximoimgConversa;
      formBadge.updateForm($scope.badge);
      $state.go('tabsController.badgesexplicaperfil_outro_eventoabertos');
    }
    if(badge == 'Danca'){
      $scope.badge.titulo = 'Pés de valsa';
      $scope.badge.texto = 'Você participou de eventos com #Dança';
      $scope.badge.numeroatual = $scope.auxnbadgeDanca;
      $scope.badge.numeroproximo = $scope.proximoDanca
      $scope.badge.imgatual = document.getElementById("Danca").src;
      $scope.badge.imganterior = $scope.anteriorimgDanca;
      $scope.badge.imgproximo = $scope.proximoimgDanca;
      formBadge.updateForm($scope.badge);
      $state.go('tabsController.badgesexplicaperfil_outro_eventoabertos');
    }
    if(badge == 'EsportesdePraia'){
      $scope.badge.titulo = 'Esportes de Praia';
      $scope.badge.texto = 'Você participou de eventos com #EsportesdePraia';
      $scope.badge.numeroatual = $scope.auxnbadgeEsportesdePraia;
      $scope.badge.numeroproximo = $scope.proximoEsportesdePraia
      $scope.badge.imgatual = document.getElementById("EsportesdePraia").src;
      $scope.badge.imganterior = $scope.anteriorimgEsportesdePraia;
      $scope.badge.imgproximo = $scope.proximoimgEsportesdePraia;
      formBadge.updateForm($scope.badge);
      $state.go('tabsController.badgesexplicaperfil_outro_eventoabertos');
    }
    if(badge == 'FestaseBaladas'){
      $scope.badge.titulo = 'Da night';
      $scope.badge.texto = 'Você participou de eventos com #FestaseBaladas';
      $scope.badge.numeroatual = $scope.auxnbadgeFestaseBaladas;
      $scope.badge.numeroproximo = $scope.proximoFestaseBaladas
      $scope.badge.imgatual = document.getElementById("FestaseBaladas").src;
      $scope.badge.imganterior = $scope.anteriorimgFestaseBaladas;
      $scope.badge.imgproximo = $scope.proximoimgFestaseBaladas;
      formBadge.updateForm($scope.badge);
      $state.go('tabsController.badgesexplicaperfil_outro_eventoabertos');
    }
    if(badge == 'Futebol'){
      $scope.badge.titulo = 'Boleiro';
      $scope.badge.texto = 'Você participou de eventos com #Futebol';
      $scope.badge.numeroatual = $scope.auxnbadgeFutebol;
      $scope.badge.numeroproximo = $scope.proximoFutebol
      $scope.badge.imgatual = document.getElementById("Futebol").src;
      $scope.badge.imganterior = $scope.anteriorimgFutebol;
      $scope.badge.imgproximo = $scope.proximoimgFutebol;
      formBadge.updateForm($scope.badge);
      $state.go('tabsController.badgesexplicaperfil_outro_eventoabertos');
    }
    if(badge == 'GrupodeEstudos'){
      $scope.badge.titulo = 'CDF';
      $scope.badge.texto = 'Você participou de eventos com #GrupodeEstudos';
      $scope.badge.numeroatual = $scope.auxnbadgeGrupodeEstudos;
      $scope.badge.numeroproximo = $scope.proximoGrupodeEstudos
      $scope.badge.imgatual = document.getElementById("GrupodeEstudos").src;
      $scope.badge.imganterior = $scope.anteriorimgGrupodeEstudos;
      $scope.badge.imgproximo = $scope.proximoimgGrupodeEstudos;
      formBadge.updateForm($scope.badge);
      $state.go('tabsController.badgesexplicaperfil_outro_eventoabertos');
    }
    if(badge == 'Jogos'){
      $scope.badge.titulo = 'Jogador (a)';
      $scope.badge.texto = 'Você participou de eventos com #Jogos';
      $scope.badge.numeroatual = $scope.auxnbadgeJogos;
      $scope.badge.numeroproximo = $scope.proximoJogos
      $scope.badge.imgatual = document.getElementById("Jogos").src;
      $scope.badge.imganterior = $scope.anteriorimgJogos;
      $scope.badge.imgproximo = $scope.proximoimgJogos;
      formBadge.updateForm($scope.badge);
      $state.go('tabsController.badgesexplicaperfil_outro_eventoabertos');
    }
    if(badge == 'Musica'){
      $scope.badge.titulo = 'Chill';
      $scope.badge.texto = 'Você participou de eventos com #Musica';
      $scope.badge.numeroatual = $scope.auxnbadgeMusica;
      $scope.badge.numeroproximo = $scope.proximoMusica
      $scope.badge.imgatual = document.getElementById("Musica").src;
      $scope.badge.imganterior = $scope.anteriorimgMusica;
      $scope.badge.imgproximo = $scope.proximoimgMusica;
      formBadge.updateForm($scope.badge);
      $state.go('tabsController.badgesexplicaperfil_outro_eventoabertos');
    }
    if(badge == 'Natureza'){
      $scope.badge.titulo = 'Do mato';
      $scope.badge.texto = 'Você participou de eventos com #Natureza';
      $scope.badge.numeroatual = $scope.auxnbadgeNatureza;
      $scope.badge.numeroproximo = $scope.proximoNatureza
      $scope.badge.imgatual = document.getElementById("Natureza").src;
      $scope.badge.imganterior = $scope.anteriorimgNatureza;
      $scope.badge.imgproximo = $scope.proximoimgNatureza;
      formBadge.updateForm($scope.badge);
      $state.go('tabsController.badgesexplicaperfil_outro_eventoabertos');
    }
    if(badge == 'Passeio'){
      $scope.badge.titulo = 'Do rolê';
      $scope.badge.texto = 'Você participou de eventos com #Passeio';
      $scope.badge.numeroatual = $scope.auxnbadgePasseio;
      $scope.badge.numeroproximo = $scope.proximoPasseio
      $scope.badge.imgatual = document.getElementById("Passeio").src;
      $scope.badge.imganterior = $scope.anteriorimgPasseio;
      $scope.badge.imgproximo = $scope.proximoimgPasseio;
      formBadge.updateForm($scope.badge);
      $state.go('tabsController.badgesexplicaperfil_outro_eventoabertos');
    }
    if(badge == 'Pets'){
      $scope.badge.titulo = 'Amo animais';
      $scope.badge.texto = 'Você participou de eventos com #Pets';
      $scope.badge.numeroatual = $scope.auxnbadgePets;
      $scope.badge.numeroproximo = $scope.proximoPets
      $scope.badge.imgatual = document.getElementById("Pets").src;
      $scope.badge.imganterior = $scope.anteriorimgPets;
      $scope.badge.imgproximo = $scope.proximoimgPets;
      formBadge.updateForm($scope.badge);
      $state.go('tabsController.badgesexplicaperfil_outro_eventoabertos');
    }
    if(badge == 'Restaurantesebares'){
      $scope.badge.titulo = 'Degustador';
      $scope.badge.texto = 'Você participou de eventos com #Restaurantesebares';
      $scope.badge.numeroatual = $scope.auxnbadgeRestaurantesebares;
      $scope.badge.numeroproximo = $scope.proximoRestaurantesebares
      $scope.badge.imgatual = document.getElementById("Restaurantesebares").src;
      $scope.badge.imganterior = $scope.anteriorimgRestaurantesebares;
      $scope.badge.imgproximo = $scope.proximoimgRestaurantesebares;
      formBadge.updateForm($scope.badge);
      $state.go('tabsController.badgesexplicaperfil_outro_eventoabertos');
    }
    if(badge == 'Surf'){
      $scope.badge.titulo = 'Surf';
      $scope.badge.texto = 'Você participou de eventos com #Surf';
      $scope.badge.numeroatual = $scope.auxnbadgeSurf;
      $scope.badge.numeroproximo = $scope.proximoSurf
      $scope.badge.imgatual = document.getElementById("Surf").src;
      $scope.badge.imganterior = $scope.anteriorimgSurf;
      $scope.badge.imgproximo = $scope.proximoimgSurf;
      formBadge.updateForm($scope.badge);
      $state.go('tabsController.badgesexplicaperfil_outro_eventoabertos');
    }
    if(badge == 'Voluntariado'){
      $scope.badge.titulo = 'Ajudar sempre é bom';
      $scope.badge.texto = 'Você participou de eventos com #Voluntariado';
      $scope.badge.numeroatual = $scope.auxnbadgeVoluntariado;
      $scope.badge.numeroproximo = $scope.proximoVoluntariado
      $scope.badge.imgatual = document.getElementById("Voluntariado").src;
      $scope.badge.imganterior = $scope.anteriorimgVoluntariado;
      $scope.badge.imgproximo = $scope.proximoimgVoluntariado;
      formBadge.updateForm($scope.badge);
      $state.go('tabsController.badgesexplicaperfil_outro_eventoabertos');
    }

  }


}])

.controller('badgesexplicaperfil_outro_eventoabertosCtrl', ['$scope', '$stateParams', 'formOutro', 'EventoService','$ionicPopup', '$timeout','$state', '$cordovaCamera', '$cordovaFile', '$cordovaFileTransfer', '$ionicLoading','formBadge', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, formOutro, EventoService, $ionicPopup, $timeout, $state, $cordovaCamera, $cordovaFile, $cordovaFileTransfer, $ionicLoading, formBadge) {

  // $scope.user = formOutro.getForm();
  // $scope.badge = formBadge.getForm();
  // document.getElementById("badgeimg").src=$scope.badge.imgatual;
  // document.getElementById("Atual").src=$scope.badge.imgatual;
  // document.getElementById("Anterior").src=$scope.badge.imganterior;
  // document.getElementById("Proximonivel").src=$scope.badge.imgproximo;
  // $scope.badge.progressPercent = $scope.badge.numeroatual * 100 / $scope.badge.numeroproximo;
  
   

  $scope.$on("$ionicView.enter", function(event, data){
    $scope.user = formOutro.getForm();
    $scope.badge = formBadge.getForm();
    
    document.getElementById("Atual").src=$scope.badge.imgatual;
    document.getElementById("Anterior").src=$scope.badge.imganterior;
    document.getElementById("Proximonivel").src=$scope.badge.imgproximo;
    console.log($scope.badge.imgatual)
    $scope.badge.progressPercent = $scope.badge.numeroatual * 100 / $scope.badge.numeroproximo;
   
  });


}])

.controller('perfil_outro_evento_criadosCtrl', ['$scope', '$stateParams', 'formItem', 'formOutro', '$state', 'EventoService','$http', '$timeout', 'formUser', '$ionicPopup', 'formStalker', 'formEventoPerfil',   // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, formItem, formOutro, $state, EventoService, $http, $timeout, formUser, $ionicPopup, formStalker, formEventoPerfil) {

    $scope.estadobutton = 0; 
    $scope.stalkeada = formOutro.getForm();;
    $scope.neventos= 0;
    $scope.neventosnao= 0;
    $scope.p =0;
    $scope.outro = formOutro.getForm();
    $scope.user = formUser.getForm();
    $scope.pushnoti = {};
    $scope.followbutton = false;
    $scope.desseguirbutton = false;
    $scope.qvou = true;

     $scope.CoisasCriado = true;
        $scope.CoisasFinalizado = false;

    $scope.auxusers = {};

    var header = document.getElementById("barperfiloutroev");
    var btns = header.getElementsByClassName("btnperfilotro");
    for (var i = 0; i < btns.length; i++) {
      btns[i].addEventListener("click", function() {
        var current = document.getElementsByClassName("actoec");
        current[0].className = current[0].className.replace(" actoec", "");
        this.className += " actoec";
      });
    }

    $scope.infosstalkeada={};
      EventoService.GetStalkear($scope.stalkeada.iduser).then(function(stalker) {
            $scope.infosstalkeada = stalker;
           if(($scope.infosstalkeada.profilepic[8] == 's' && $scope.infosstalkeada.profilepic[9] == '3')||($scope.infosstalkeada.profilepic[8] == 'd' && $scope.infosstalkeada.profilepic[9] == 'i')){
          
            document.getElementById("imageidperfil_outro_evento_criados").src=$scope.infosstalkeada.profilepic+"?{{getTimeStamp()}}";
           }else{
             document.getElementById("imageidperfil_outro_evento_criados").src=$scope.infosstalkeada.profilepic;
           }
           if(!$scope.infosstalkeada.numcodigo || $scope.infosstalkeada.numcodigo == 'null'){
              $scope.temcodigo = false;
            }else{
              $scope.temcodigo = true;
              if($scope.infosstalkeada.numcodigo == '0'){
                document.getElementById("badgeimg_poec").src="img/egg_0.png";
              }
              if($scope.infosstalkeada.numcodigo == '1'){
                document.getElementById("badgeimg_poec").src="img/egg_1.png";
              }
              if($scope.infosstalkeada.numcodigo == '2'){
                document.getElementById("badgeimg_poec").src="img/egg_2.png";
              }
              if(parseInt($scope.infosstalkeada.numcodigo) >= 3){
                document.getElementById("badgeimg_poec").src="img/egg_3.png";
              }
              if(parseInt($scope.infosstalkeada.numcodigo) < 0){
                document.getElementById("badgeimg_poec").src="img/egg_3.png";
              }
            }

            //document.getElementById("imageidperfil_outro_evento_criados").src=$scope.infosstalkeada.profilepic+"?{{getTimeStamp()}}";
            $scope.frase = stalker.frase;
            if(stalker.borda == 0){
          $scope.estrelabb = false;
          $scope.estrelabs = false;
          $scope.estrelabg = false;
        }
        if(stalker.borda == 1){
          $scope.estrelabb = true;
          $scope.estrelabs = false;
          $scope.estrelabg = false;
        }
        if(stalker.borda == 2){
          $scope.estrelabb = false;
          $scope.estrelabs = true;
          $scope.estrelabg = false;
        }
        if(stalker.borda == 3){
          $scope.estrelabb = false;
          $scope.estrelabs = false;
          $scope.estrelabg = true;
        }
            if($scope.infosstalkeada.idade){
              $scope.infosstalkeada.idade = ", "+ $scope.infosstalkeada.idade +" anos";
            }else{
               $scope.infosstalkeada.idade ='';
            }
        });
    var auxbloqueado = 0;
    var noti = {};
    
    EventoService.GetPontos($scope.stalkeada.iduser).then(function(items) {
        $scope.p = items;
        $scope.labels3 = ["Pontos"];
        $scope.colores3 = ["#ff4d4d"];
        $scope.data3 = [$scope.p];
      });
      EventoService.getIC($scope.stalkeada).then(function(items) {
        if(items){
          $scope.ic = items;
          $scope.options2 = {title: {
                      display: true,
                      text: 'Indice de confirmação',
                      position: 'bottom'
                  }
           }
          $scope.labels2 = ["Fui", "Não fui"];
          $scope.colores2 = ["#99FF99","#ff4d4d"];
          var menos = (100-$scope.ic.total).toFixed(1);
          var mais = $scope.ic.total;
          $scope.data2 = [mais, menos ];
        }
      });

      EventoService.GetComments3($scope.stalkeada).then(function(items) {
        
          $scope.options1 = {title: {
                    display: true,
                    text: 'Avaliações',
                    position: 'bottom'
                }
         }
           $scope.labels1 = ["Extrovertido", "Introvertido", "Realista","Curioso", "Solidário", "Racional","Organizado", "Criativo"];
          $scope.colores1 = ["#fff200", "#02fff2", "#ff9d00","#1867ce", "#e50be1", "#0e8c28","#ef370e", "#af0eef"];
          $scope.data1 =items.chart;
        
      }); 
      $scope.outro = $scope.outro.iduser

    $scope.$on("$ionicView.enter", function(event, data){
      $scope.pushnoti = {};
      if($scope.outro == $scope.user.iduser){
         $scope.followbutton = false;
         $scope.desseguirbutton = false;
         $scope.reportbutton = false;
         $scope.qvou = true;
      }else{
        $scope.reportbutton = true;
      }
      $scope.infosstalkeada={};
      EventoService.GetStalkear($scope.stalkeada.iduser).then(function(stalker) {
            $scope.infosstalkeada = stalker;
            if(($scope.infosstalkeada.profilepic[8] == 's' && $scope.infosstalkeada.profilepic[9] == '3')||($scope.infosstalkeada.profilepic[8] == 'd' && $scope.infosstalkeada.profilepic[9] == 'i')){
          
            document.getElementById("imageidperfil_outro_evento_criados").src=$scope.infosstalkeada.profilepic+"?{{getTimeStamp()}}";
           }else{
             document.getElementById("imageidperfil_outro_evento_criados").src=$scope.infosstalkeada.profilepic;
           }
           if(!$scope.infosstalkeada.numcodigo || $scope.infosstalkeada.numcodigo == 'null'){
              $scope.temcodigo = false;
            }else{
              $scope.temcodigo = true;
              if($scope.infosstalkeada.numcodigo == '0'){
                document.getElementById("badgeimg_poec").src="img/egg_0.png";
              }
              if($scope.infosstalkeada.numcodigo == '1'){
                document.getElementById("badgeimg_poec").src="img/egg_1.png";
              }
              if($scope.infosstalkeada.numcodigo == '2'){
                document.getElementById("badgeimg_poec").src="img/egg_2.png";
              }
              if(parseInt($scope.infosstalkeada.numcodigo) >= 3){
                document.getElementById("badgeimg_poec").src="img/egg_3.png";
              }
              if(parseInt($scope.infosstalkeada.numcodigo) < 0){
                document.getElementById("badgeimg_poec").src="img/egg_3.png";
              }
            }
            //document.getElementById("imageidperfil_outro_evento_criados").src=$scope.infosstalkeada.profilepic+"?{{getTimeStamp()}}";
            $scope.frase = stalker.frase;
             if(stalker.borda == 0){
          $scope.estrelabb = false;
          $scope.estrelabs = false;
          $scope.estrelabg = false;
        }
        if(stalker.borda == 1){
          $scope.estrelabb = true;
          $scope.estrelabs = false;
          $scope.estrelabg = false;
        }
        if(stalker.borda == 2){
          $scope.estrelabb = false;
          $scope.estrelabs = true;
          $scope.estrelabg = false;
        }
        if(stalker.borda == 3){
          $scope.estrelabb = false;
          $scope.estrelabs = false;
          $scope.estrelabg = true;
        }
            if($scope.infosstalkeada.idade){
              $scope.infosstalkeada.idade = ", "+ $scope.infosstalkeada.idade +" anos";
            }else{
               $scope.infosstalkeada.idade ='';
            }
        });
      $scope.items = [];
      $scope.vezes = 0;
      $scope.newItems = [];
      $scope.noMoreItemsAvailable = false;
      $scope.lastidevento = 0;
      $scope.aux2 = 0;
      $scope.outro = formOutro.getForm();
      $scope.followbutton = false;
      $scope.desseguirbutton = false;

      EventoService.GetStalkear($scope.outro.iduser).then(function(items) {
        $scope.stalkeada = items;
        EventoService.GetCriados($scope.stalkeada).then(function(items) {
           $scope.CoisasCriado = true;
            $scope.CoisasFinalizado = false;
          if(items == 'E'){
            $scope.items = [];
          }else{
            for (var i = 0; i < items.length; i++) {
                var curr_date = (items[i].diainicio[8]+items[i].diainicio[9]);
                var h2 = (items[i].diainicio[11]+items[i].diainicio[12]);
                var m2 = (items[i].diainicio[14]+items[i].diainicio[15]);
                var curr_month = (items[i].diainicio[5]+items[i].diainicio[6]);
                var curr_year = (items[i].diainicio[0]+items[i].diainicio[1]+items[i].diainicio[2]+items[i].diainicio[3]);
                var j = curr_date + "/" + curr_month + "/" + curr_year+ ' '+h2 + ':' + m2;
                items[i].datainicio = j;
                if(items[i].estado == 0){
                  items[i].confirmacao = "Vai acontecer"
                }
                if(items[i].estado == 1){
                  items[i].confirmacao = "Finalizado"
                }
                if(items[i].estado == 2){
                  items[i].confirmacao = "Standy by, talvez aconteça"
                }
                if(items[i].estado == 3){
                  items[i].confirmacao = "Vai acontecer"
                }
                if(items[i].estado == 4){
                  items[i].confirmacao = "Cancelado"
                }
                if(items[i].estado == 5){
                  items[i].confirmacao = "Acabado"
                }
                if(items[i].estado == 6){
                  items[i].confirmacao = "Escondido"
                }
            }
            $scope.items = items.concat($scope.items);
            $scope.lastidvestido = $scope.items[0].idevento;
          }
        });
      });

                      // GET VALORES DE PONTOS E IC DA PESSOA

       EventoService.GetPontos($scope.stalkeada.iduser).then(function(items) {
        $scope.p = items;
        $scope.labels3 = ["Pontos"];
        $scope.colores3 = ["#ff4d4d"];
        $scope.data3 = [$scope.p];
      });
      EventoService.getIC($scope.stalkeada).then(function(items) {
        if(items){
          $scope.ic = items;
          $scope.options2 = {title: {
                      display: true,
                      text: 'Indice de confirmação',
                      position: 'bottom'
                  }
           }
          $scope.labels2 = ["Fui", "Não fui"];
          $scope.colores2 = ["#99FF99","#ff4d4d"];
          var menos = (100-$scope.ic.total).toFixed(1);
          var mais = $scope.ic.total;
          $scope.data2 = [mais, menos ];
        }
      });

      EventoService.GetComments3($scope.stalkeada).then(function(items) {
        
          $scope.options1 = {title: {
                    display: true,
                    text: 'Avaliações',
                    position: 'bottom'
                }
         }
          $scope.labels1 = ["Extrovertido", "Introvertido", "Realista","Curioso", "Solidário", "Racional","Organizado", "Criativo"];
          $scope.colores1 = ["#fff200", "#02fff2", "#ff9d00","#1867ce", "#e50be1", "#0e8c28","#ef370e", "#af0eef"];
          $scope.data1 =items.chart;
        
      });   

                      //Para ver se eu ja sigo esta pessoa ou não.
      $scope.auxusers.outro =  $scope.outro.iduser;
      $scope.auxusers.eu =  $scope.user.iduser;
      console.log("possoseguir", $scope.auxusers.outro, $scope.user.iduser)
      EventoService.possoseguir($scope.auxusers).then(function(items) {
        console.log("possoseguir", items)
        if(items){
          console.log($scope.outro,$scope.user.iduser)
          //// nao funciona, nao pegar os bloqueados
          $http.post('https://ec2.diwoapp.com.br/getfollow.php', {iduserseguindo : $scope.outro.iduser, 
                                                                    iduserseguidor : $scope.user.iduser}).then(function(res) {
            console.log( 'oi' , res.data[0].bloqueado );
            if(res.data[0]!='E'){
              if (res.data[0].bloqueado==0){ 
                $scope.desseguirbutton = true;
                $scope.followbutton = false;
                auxbloqueado = 1;
                $scope.qvou = true;
                console.log('ja sigo este cara');
              }
              if(res.data[0].bloqueado==2){
                console.log('nao sigo este cara');
                $scope.desseguirbutton = false;
                $scope.followbutton = true;
                auxbloqueado = 1;
                $scope.qvou = false;
              }
              if(res.data[0].bloqueado==1){
                console.log('tais bloqueado');
                $scope.desseguirbutton = false;
                $scope.followbutton = false;
                auxbloqueado = 3;
                $scope.items = [];
                $scope.qvou = false;
              }
              if($scope.outro == $scope.user.iduser){
                $scope.followbutton = false;
                $scope.desseguirbutton = false;
                $scope.reportbutton = false;
                $scope.qvou = true;
              }
            }else{
              $scope.followbutton = true;
              auxbloqueado = 2;
              $scope.qvou = false;
            }
             if($scope.outro == $scope.user.iduser){
                $scope.followbutton = false;
                $scope.desseguirbutton = false;
                $scope.reportbutton = false;
                $scope.qvou = true;
              }
          });
        }else{
          if($scope.outro == $scope.user.iduser){
            $scope.followbutton = false;
            $scope.desseguirbutton = false;
            $scope.reportbutton = false;
            $scope.qvou = true;
          }else{
            $scope.qvou = false;
          }
        }
      });                  
    });

    $scope.comentario = function(){
      formStalker.updateForm($scope.stalkeada);
      if(auxbloqueado!=3){
        $state.go('tabsController.comentariosdosoutrosnoperfil');
      }
    }

    $scope.seguir = function(){
      //console.log("oii", $scope.infosstalkeada.iduser)
      noti.recebe = $scope.infosstalkeada.iduser;
      noti.envia = $scope.user.iduser;
      noti.tipo = 11;
      noti.nomeevento = 'follow';
      EventoService.VerificaNotificacao(noti).then(function(res) {
        console.log(res);
        if(res){
          var msgnoti ='Nova pessoa esta t stalkeando';
          var link = 'https://ec2.diwoapp.com.br/notificapessoa.php';
          $http.post(link, {notificacao :msgnoti, 
                            idevento : $scope.user.iduser,
                            nomeevento : 'follow',
                            id_user_envia : $scope.user.iduser,
                            username_envia : $scope.user.username,
                            apelido_envia : $scope.user.apelido,
                            tipo : '11',
                            id_user_recebe : $scope.infosstalkeada.iduser});
        }
      });
      if(auxbloqueado == 2){
        var link = 'https://ec2.diwoapp.com.br/seguepessoa.php';
        $http.post(link, {iduserseguindo : $scope.infosstalkeada.iduser, 
                          usernameseguindo : $scope.stalkeada.username,
                          iduserseguidor : $scope.user.iduser,
                          apelidoseguindo : $scope.infosstalkeada.apelido,
                          apelidoseguidor : $scope.user.apelido,
                          profilepicseguindo : $scope.infosstalkeada.profilepic,
                          profilepicseguidor : $scope.user.profilepic,
                          devicetokenseguidor : $scope.user.devicetoken,
                          usernameseguidor : $scope.user.username}).then(function(res) {
          var alertPopup = $ionicPopup.alert({
            title: '(*•̀ᴗ•́*)و ̑̑',
            template: 'Pessoa adicionada as pessoas de interesse'
          }); 
          $scope.desseguirbutton = true;
          $scope.followbutton = false;
        });
      }else{
        var link = 'https://ec2.diwoapp.com.br/refollow.php'; // estado "Bloqueado"  = 2;
        $http.post(link, {iduserseguindo : $scope.infosstalkeada.iduser, 
                          iduserseguidor : $scope.user.iduser}).then(function(res) {  
          var alertPopup = $ionicPopup.alert({
            title: '(￣▽￣)ノ',
            template: 'Pessoa adicionada as pessoas de interesse'
          }); 
          $scope.desseguirbutton = true;
          $scope.followbutton = false;                
        });
      }
    }

    $scope.desseguir = function(){
      auxbloqueado = 0;
      var link = 'https://ec2.diwoapp.com.br/desfollow.php'; // estado "Bloqueado"  = 2;
      $http.post(link, {iduserseguindo : $scope.infosstalkeada.iduser, 
                        iduserseguidor : $scope.user.iduser}).then(function(res) {
        var alertPopup = $ionicPopup.alert({
          title: '(*꒦ິ⌓꒦ີ)',
          template: 'Não segues mais esta pessoa'
        }); 
        $scope.desseguirbutton = false;
        $scope.followbutton = true;                
      });
    }



    $scope.loadCriados = function() {
       $scope.CoisasCriado = true;
        $scope.CoisasFinalizado = false;
      if(auxbloqueado!=3){
        $scope.estadobutton = 0;
        $scope.items = [];
        EventoService.GetCriados($scope.stalkeada).then(function(items) {
          if(items == 'E'){
            $scope.items = [];
          }else{
            for (var i = 0; i < items.length; i++) {
                 var curr_date = (items[i].diainicio[8]+items[i].diainicio[9]);
                var h2 = (items[i].diainicio[11]+items[i].diainicio[12]);
                var m2 = (items[i].diainicio[14]+items[i].diainicio[15]);
                var curr_month = (items[i].diainicio[5]+items[i].diainicio[6]);
                var curr_year = (items[i].diainicio[0]+items[i].diainicio[1]+items[i].diainicio[2]+items[i].diainicio[3]);
                var j = curr_date + "/" + curr_month + "/" + curr_year+ ' '+h2 + ':' + m2;
                items[i].datainicio = j;
                if(items[i].estado == 0){
                  items[i].confirmacao = "Vai acontecer"
                }
                if(items[i].estado == 1){
                  items[i].confirmacao = "Finalizado"
                }
                if(items[i].estado == 2){
                  items[i].confirmacao = "Standy by, talvez aconteça"
                }
                if(items[i].estado == 3){
                  items[i].confirmacao = "Vai acontecer"
                }
                if(items[i].estado == 4){
                  items[i].confirmacao = "Cancelado"
                }
                if(items[i].estado == 5){
                  items[i].confirmacao = "Acabado"
                }
                if(items[i].estado == 6){
                  items[i].confirmacao = "Escondido"
                }
            }
            $scope.items = items.concat($scope.items);
            $scope.lastidvestido = $scope.items[0].idevento;
          }
        });
      }
    }

    $scope.loadAbertos = function() {
       $scope.CoisasCriado = false;
        $scope.CoisasFinalizado = true;
      if(auxbloqueado!=3){
        $scope.estadobutton = 1;
        $scope.items = [];
        EventoService.GetAbertos($scope.stalkeada.iduser).then(function(items) {  //mudar
          if(items == 'E'){
            $scope.items = [];
          }else{
            for (var i = 0; i < items.length; i++) {
                var curr_date = (items[i].diainicio[8]+items[i].diainicio[9]);
                var h2 = (items[i].diainicio[11]+items[i].diainicio[12]);
                var m2 = (items[i].diainicio[14]+items[i].diainicio[15]);
                var curr_month = (items[i].diainicio[5]+items[i].diainicio[6]);
                var curr_year = (items[i].diainicio[0]+items[i].diainicio[1]+items[i].diainicio[2]+items[i].diainicio[3]);
                var j = curr_date + "/" + curr_month + "/" + curr_year+ ' '+h2 + ':' + m2;
                items[i].datainicio = j;
            }
            $scope.items = items.concat($scope.items);
            $scope.lastidvestido = $scope.items[0].idevento;
          }
        });
      }
    }

    $scope.loadFechados = function() {
       $scope.CoisasCriado = false;
        $scope.CoisasFinalizado = true;
      if(auxbloqueado!=3){
        $scope.estadobutton = 2;
        $scope.items = [];
        //console.log($scope.user.iduser);
        EventoService.GetFinalizadosPerfil($scope.stalkeada.iduser).then(function(items) {         //mudar
          if(items=='E'){
            $scope.items = [];
          }else{
            for (var i = 0; i < items.length; i++) {
                var curr_date = (items[i].diainicio[8]+items[i].diainicio[9]);
                var h2 = (items[i].diainicio[11]+items[i].diainicio[12]);
                var m2 = (items[i].diainicio[14]+items[i].diainicio[15]);
                var curr_month = (items[i].diainicio[5]+items[i].diainicio[6]);
                var curr_year = (items[i].diainicio[0]+items[i].diainicio[1]+items[i].diainicio[2]+items[i].diainicio[3]);
                var j = curr_date + "/" + curr_month + "/" + curr_year+ ' '+h2 + ':' + m2;
                items[i].datainicio = j;
            }
            $scope.items = items.concat($scope.items);
            $scope.lastidvestido = $scope.items[0].idevento;
          }
        });
      }
    }

    $scope.loadMore = function() {
      if ($scope.estadobutton == 0&& auxbloqueado!=3) {
        EventoService.GetOldEventosCriados().then(function(items) {
        $scope.items = $scope.items.concat(items);
        $scope.$broadcast('scroll.infiniteScrollComplete');
          // an empty array indicates that there are no more items
          if (items.length <= 4) {
            $scope.noMoreItemsAvailable = true;
          }

        });
      }
      if ($scope.estadobutton == 1 && auxbloqueado!=3) {
        EventoService.GetOldEventosCriados().then(function(items) {
        $scope.items = $scope.items.concat(items);
        $scope.$broadcast('scroll.infiniteScrollComplete');
          // an empty array indicates that there are no more items
          if (items.length <= 4) {
            $scope.noMoreItemsAvailable = true;
          }
        });

        
      }
      if ($scope.estadobutton == 2 && auxbloqueado!=3) {
        EventoService.GetOldEventosCriados().then(function(items) {
        $scope.items = $scope.items.concat(items);
        $scope.$broadcast('scroll.infiniteScrollComplete');
          // an empty array indicates that there are no more items
          if (items.length <= 4) {
            $scope.noMoreItemsAvailable = true;
          }
        });

      
      }
    }

    $scope.reportar = function(){
      $scope.reportmsg = '';
      console.log($scope.stalkeada.username);
      $scope.report = [
      { text: "Nome impróprio", checked: false },
      { text: "Comportamento inadequado", checked: false },
      { text: "Foto inapropriada", checked: false },
      { text: "É um impostor", checked: false }];

        $ionicPopup.confirm({
          title: 'Você quer reportar essa pessoa pq?',
          content: '<ion-checkbox ng-repeat="item in report" style="color: #FCFCFC;" ng-model="item.checked" style="text-align: center;overflow: hidden;text-overflow: none !important; white-space: initial !important;" ng-checked="item.checked">{{item.text}}</ion-checkbox>',
          scope: $scope}).then(function(res) {
          if(res) {
            for (var h=0;h<3;h++){
              //console.log($scope.report[h].checked , h);
              if($scope.report[h].checked){
                $scope.reportmsg = $scope.reportmsg + $scope.report[h].text + ' ';
                //console.log($scope.reportmsg);
              }
            }
            if(h==3){
              console.log($scope.reportmsg);
              $http.post('https://ec2.diwoapp.com.br/reportaevento.php', {namereportado : $scope.stalkeada.username,
                                                                              reportadoid : $scope.stalkeada.iduser,
                                                                              iduserreportando : $scope.user.iduser,
                                                                              usernamereportando : $scope.user.username,
                                                                              tiporeport : 'usuario',
                                                                              motivo : $scope.reportmsg}).then(function (tes){
                $scope.response = tes.data;
                var alertPopup = $ionicPopup.alert({
                  title: 'Obrigado',
                  template: 'Esta pessoa esta agora sobre investigação, obrigado por manter a plataforma segura'
                });
              });
            }
          }
        });
      }

    $scope.enterItem =  function(item){
      //formEventoPerfil
      formEventoPerfil.updateForm(item);
      //formItem.updateForm(item);
      console.log(item.idevento);
      $state.go('tabsController.evento_do_eventoCriados_do_outro');
    }

}])

.controller('evento_do_eventoCriados_do_outroCtrl', ['$scope', '$stateParams', 'formItem', 'formUser', 'formOutro', '$http', '$timeout','$ionicPopup', 'EventoService', '$state', 'formEventoPerfil', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, formItem, formUser, formOutro, $http, $timeout, $ionicPopup, EventoService, $state, formEventoPerfil) {
    //$scope.evento = formItem.getForm();
    $scope.evento = formEventoPerfil.getForm();
    $scope.aux = formUser.getForm();
    $scope.nuser = 0;
    $scope.limiteconfirmacao ={};
    $scope.fim = {};
    $scope.dia = {};
    if(!$scope.evento.endereco){
      console.log($scope.evento.idevento)
      $http.post('https://ec2.diwoapp.com.br/geteventoporid.php', {idevento : $scope.evento.idevento}).then(function (result){
        $scope.evento = result.data[0];
        formEventoPerfil.updateForm($scope.evento);
        //formItem.updateForm($scope.evento);
     
    var hj = $scope.evento.diainicio;
    //$scope.dia = (hj[8]+hj[9]).valueOf()+'/'+(hj[5]+hj[6]).valueOf()+'/'+(hj[0]+hj[1]+hj[2]+hj[3])+' '+(hj[11]+hj[12]).valueOf()+':'+(hj[14]+hj[15]).valueOf();
    var hjf = $scope.evento.diafim;
    $scope.diafim =  (hjf[8]+hjf[9]).valueOf()+'/'+(hjf[5]+hjf[6]).valueOf()+'/'+(hjf[0]+hjf[1]+hjf[2]+hjf[3])+' '+(hjf[11]+hjf[12]).valueOf()+':'+(hjf[14]+hjf[15]).valueOf();
    
    var hjd = $scope.evento.duracao;
    var hd = (hjd[0]+hjd[1]).valueOf();
    var md = (hjd[3]+hjd[4]).valueOf();
    $scope.duracao= hd+':'+md;

    var  hjl = $scope.evento.dialimiteconfirmacao;
    $scope.limiteconfirmacao.dia =  (hjl[8]+hjl[9]).valueOf()+'/'+(hjl[5]+hjl[6]).valueOf();
    $scope.limiteconfirmacao.hora =  (hjl[11]+hjl[12]).valueOf()+':'+(hjl[14]+hjl[15]).valueOf();  
    
    

    var hjf = $scope.evento.diafim;
    $scope.fim.dia =  (hjf[8]+hjf[9]).valueOf()+'/'+(hjf[5]+hjf[6]).valueOf()+'/'+(hjf[0]+hjf[1]+hjf[2]+hjf[3]);
    $scope.fim.hora = (hjf[11]+hjf[12]).valueOf()+':'+(hjf[14]+hjf[15]).valueOf();
    $scope.dia.dia = (hj[8]+hj[9]).valueOf()+'/'+(hj[5]+hj[6]).valueOf();
    $scope.dia.hora = (hj[11]+hj[12]).valueOf()+':'+(hj[14]+hj[15]).valueOf() +' - '+(hjf[11]+hjf[12]).valueOf()+':'+(hjf[14]+hjf[15]).valueOf() ;
      });
    }else{
      var hjl = $scope.evento.dialimiteconfirmacao;
        $scope.limiteconfirmacao.dia =  (hjl[8]+hjl[9]).valueOf()+'/'+(hjl[5]+hjl[6]).valueOf();
        $scope.limiteconfirmacao.hora =  (hjl[11]+hjl[12]).valueOf()+':'+(hjl[14]+hjl[15]).valueOf();  
      
      
        var hj = $scope.evento.diainicio;    
        ///$scope.dia = (hj[8]+hj[9]).valueOf()+'/'+(hj[5]+hj[6]).valueOf()+'/'+(hj[0]+hj[1]+hj[2]+hj[3])+' '+(hj[11]+hj[12]).valueOf()+':'+(hj[14]+hj[15]).valueOf();
        var hjf = $scope.evento.diafim;
        $scope.diafim =  (hjf[8]+hjf[9]).valueOf()+'/'+(hjf[5]+hjf[6]).valueOf()+'/'+(hjf[0]+hjf[1]+hjf[2]+hjf[3])+' '+(hjf[11]+hjf[12]).valueOf()+':'+(hjf[14]+hjf[15]).valueOf();
        $scope.fim.dia =  (hjf[8]+hjf[9]).valueOf()+'/'+(hjf[5]+hjf[6]).valueOf()+'/'+(hjf[0]+hjf[1]+hjf[2]+hjf[3]);
        $scope.fim.hora = (hjf[11]+hjf[12]).valueOf()+':'+(hjf[14]+hjf[15]).valueOf();
        $scope.dia.dia = (hj[8]+hj[9]).valueOf()+'/'+(hj[5]+hj[6]).valueOf();
        $scope.dia.hora = (hj[11]+hj[12]).valueOf()+':'+(hj[14]+hj[15]).valueOf() +' - '+(hjf[11]+hjf[12]).valueOf()+':'+(hjf[14]+hjf[15]).valueOf() ;
    }

    $scope.$on("$ionicView.enter", function(event, data){
      $scope.items = [];
      //$scope.evento = formItem.getForm();
      $scope.evento = formEventoPerfil.getForm();
      
      if(!$scope.evento.endereco){
        console.log($scope.evento.idevento)
        $http.post('https://ec2.diwoapp.com.br/geteventoporid.php', {idevento : $scope.evento.idevento}).then(function (result){
          $scope.evento = result.data[0];
          //formItem.updateForm($scope.evento);

          formEventoPerfil.updateForm($scope.evento);
        });
      }
      hj = $scope.evento.diainicio;
      //$scope.dia = (hj[8]+hj[9]).valueOf()+'/'+(hj[5]+hj[6]).valueOf()+'/'+(hj[0]+hj[1]+hj[2]+hj[3])+' '+(hj[11]+hj[12]).valueOf()+':'+(hj[14]+hj[15]).valueOf();
       hjf = $scope.evento.diafim;
      $scope.diafim =  (hjf[8]+hjf[9]).valueOf()+'/'+(hjf[5]+hjf[6]).valueOf()+'/'+(hjf[0]+hjf[1]+hjf[2]+hjf[3])+' '+(hjf[11]+hjf[12]).valueOf()+':'+(hjf[14]+hjf[15]).valueOf();
      $scope.dia.dia = (hj[8]+hj[9]).valueOf()+'/'+(hj[5]+hj[6]).valueOf();
      $scope.dia.hora = (hj[11]+hj[12]).valueOf()+':'+(hj[14]+hj[15]).valueOf() +' - '+(hjf[11]+hjf[12]).valueOf()+':'+(hjf[14]+hjf[15]).valueOf() ;
      
      EventoService.GetParticipantes($scope.evento.idevento).then(function(items) {
        $scope.nomeevento = items[0].nomeevento;
        for (var i = 0; i < items.length; i++) {
          if ($scope.aux.iduser == items[i].iduser) {
            $scope.nuser++;
          }
          if (items[i].estado == 0) {
            items[i].confirmacao = 'Sou o organizador';
          }
          if (items[i].estado == 1) {
            items[i].confirmacao = 'Aguardando confirmação';
          }
          if (items[i].estado == 2) {
            items[i].confirmacao = 'Confirmação aprovada';
          }
          if(items[i].borda == 0){
            items[i].bb = false;
            items[i].bs = false;
            items[i].bg = false;
          }
          if(items[i].borda == 1){
            items[i].bb = true;
            items[i].bs = false;
            items[i].bg = false;
          }
          if(items[i].borda == 2){
            items[i].bb = false;
            items[i].bs = true;
            items[i].bg = false;
          }
          if(items[i].borda == 3){
            items[i].bb = false;
            items[i].bs = false;
            items[i].bg = true;
          }
          if((items[i].profilepic[8] == 's' && items[i].profilepic[9] == '3')||(items[i].profilepic[8] == 'd' && items[i].profilepic[9] == 'i')){
            items[i].profilepic = items[i].profilepic+"?{{getTimeStamp()}}";
           }else{
             items[i].profilepic = items[i].profilepic;
           }
          //items[i].profilepic = items[i].profilepic+"?{{getTimeStamp()}}";
        }
        $scope.items = items.concat($scope.items);
        
      });
    });

    if($scope.evento.genero == "masc"){
      $scope.masc = true;
      $scope.fem = false;
    }
    if($scope.evento.genero == "fem"){
        $scope.fem = true;
        $scope.masc = false;
    }
    if($scope.evento.genero == "todos"){
        $scope.fem = false;
        $scope.masc = false;
    }
    if($scope.evento.preco == 0 || $scope.evento.preco =="Gratuito"){
      $scope.evento.preco = "Gratuito";
      $scope.porpessoa = false;
      $scope.porlocal = false;
    }else{
      if($scope.evento.precopor == 1){
        $scope.porpessoa = true;
        $scope.porlocal = false;
      }else{
        $scope.porpessoa = false;
        $scope.porlocal = true;
      }
    }

    // $scope.enterItem =  function(item){
    //   formOutro.updateForm(item.iduser);
    //   console.log(item.iduser);
    //   $state.go('tabsController.perfil_outro_eventocriados');
    // }

}])

.controller('evento_do_eventoAbertos_do_outroCtrl', ['$scope', '$stateParams', 'formItem', 'formUser', 'formOutro', '$http', '$timeout','$ionicPopup', 'EventoService', '$state', 'formEventoAbertosTab', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, formItem, formUser, formOutro, $http, $timeout, $ionicPopup, EventoService, $state, formEventoAbertosTab) {
    //$scope.evento = formItem.getForm();
    $scope.evento = formEventoAbertosTab.getForm();
    $scope.aux = formUser.getForm();
    $scope.limiteconfirmacao ={};
    $scope.fim = {};
    $scope.dia = {};

    if(!$scope.evento.endereco){
      console.log($scope.evento.idevento)
      $http.post('https://ec2.diwoapp.com.br/geteventoporid.php', {idevento : $scope.evento.idevento}).then(function (result){
      $scope.evento = result.data[0];
        
      
      console.log($scope.evento.endereco);
      
      $scope.nuser = 0;

      var hj = $scope.evento.diainicio;
      //$scope.dia = (hj[8]+hj[9]).valueOf()+'/'+(hj[5]+hj[6]).valueOf()+'/'+(hj[0]+hj[1]+hj[2]+hj[3])+' '+(hj[11]+hj[12]).valueOf()+':'+(hj[14]+hj[15]).valueOf();
      var hjf = $scope.evento.diafim;
      $scope.diafim =  (hjf[8]+hjf[9]).valueOf()+'/'+(hjf[5]+hjf[6]).valueOf()+'/'+(hjf[0]+hjf[1]+hjf[2]+hjf[3])+' '+(hjf[11]+hjf[12]).valueOf()+':'+(hjf[14]+hjf[15]).valueOf();
      var hjd = $scope.evento.duracao;
      var hd = (hjd[0]+hjd[1]).valueOf();
      var md = (hjd[3]+hjd[4]).valueOf();
      $scope.duracao= hd+':'+md;

      var  hjl = $scope.evento.dialimiteconfirmacao;
      $scope.limiteconfirmacao.dia =  (hjl[8]+hjl[9]).valueOf()+'/'+(hjl[5]+hjl[6]).valueOf();
      $scope.limiteconfirmacao.hora =  (hjl[11]+hjl[12]).valueOf()+':'+(hjl[14]+hjl[15]).valueOf();  
      
      

      var hjf = $scope.evento.diafim;
      $scope.fim.dia =  (hjf[8]+hjf[9]).valueOf()+'/'+(hjf[5]+hjf[6]).valueOf()+'/'+(hjf[0]+hjf[1]+hjf[2]+hjf[3]);
      $scope.fim.hora = (hjf[11]+hjf[12]).valueOf()+':'+(hjf[14]+hjf[15]).valueOf();
      $scope.dia.dia = (hj[8]+hj[9]).valueOf()+'/'+(hj[5]+hj[6]).valueOf();
      $scope.dia.hora = (hj[11]+hj[12]).valueOf()+':'+(hj[14]+hj[15]).valueOf() +' - '+(hjf[11]+hjf[12]).valueOf()+':'+(hjf[14]+hjf[15]).valueOf() ;
        });
    }

    $scope.$on("$ionicView.enter", function(event, data){
      $scope.items = [];
      //$scope.evento = formItem.getForm();
      $scope.evento = formEventoAbertosTab.getForm();
      $scope.limiteconfirmacao ={};
      $scope.fim = {};
      $scope.dia = {};
      if(!$scope.evento.endereco){
        console.log($scope.evento.idevento)
        $http.post('https://ec2.diwoapp.com.br/geteventoporid.php', {idevento : $scope.evento.idevento}).then(function (result){
          $scope.evento = result.data[0];
         //formItem.updateForm($scope.evento);
         formEventoAbertosTab.updateForm($scope.evento);


        var hjl = $scope.evento.dialimiteconfirmacao;
        $scope.limiteconfirmacao.dia =  (hjl[8]+hjl[9]).valueOf()+'/'+(hjl[5]+hjl[6]).valueOf();
        $scope.limiteconfirmacao.hora =  (hjl[11]+hjl[12]).valueOf()+':'+(hjl[14]+hjl[15]).valueOf();  
      
      
        var hj = $scope.evento.diainicio;    
        ///$scope.dia = (hj[8]+hj[9]).valueOf()+'/'+(hj[5]+hj[6]).valueOf()+'/'+(hj[0]+hj[1]+hj[2]+hj[3])+' '+(hj[11]+hj[12]).valueOf()+':'+(hj[14]+hj[15]).valueOf();
        var hjf = $scope.evento.diafim;
        $scope.diafim =  (hjf[8]+hjf[9]).valueOf()+'/'+(hjf[5]+hjf[6]).valueOf()+'/'+(hjf[0]+hjf[1]+hjf[2]+hjf[3])+' '+(hjf[11]+hjf[12]).valueOf()+':'+(hjf[14]+hjf[15]).valueOf();
        $scope.fim.dia =  (hjf[8]+hjf[9]).valueOf()+'/'+(hjf[5]+hjf[6]).valueOf()+'/'+(hjf[0]+hjf[1]+hjf[2]+hjf[3]);
        $scope.fim.hora = (hjf[11]+hjf[12]).valueOf()+':'+(hjf[14]+hjf[15]).valueOf();
        $scope.dia.dia = (hj[8]+hj[9]).valueOf()+'/'+(hj[5]+hj[6]).valueOf();
        $scope.dia.hora = (hj[11]+hj[12]).valueOf()+':'+(hj[14]+hj[15]).valueOf() +' - '+(hjf[11]+hjf[12]).valueOf()+':'+(hjf[14]+hjf[15]).valueOf() ;
         });
      }else{
        var hjl = $scope.evento.dialimiteconfirmacao;
        $scope.limiteconfirmacao.dia =  (hjl[8]+hjl[9]).valueOf()+'/'+(hjl[5]+hjl[6]).valueOf();
        $scope.limiteconfirmacao.hora =  (hjl[11]+hjl[12]).valueOf()+':'+(hjl[14]+hjl[15]).valueOf();  
      
      
        var hj = $scope.evento.diainicio;    
        ///$scope.dia = (hj[8]+hj[9]).valueOf()+'/'+(hj[5]+hj[6]).valueOf()+'/'+(hj[0]+hj[1]+hj[2]+hj[3])+' '+(hj[11]+hj[12]).valueOf()+':'+(hj[14]+hj[15]).valueOf();
        var hjf = $scope.evento.diafim;
        $scope.diafim =  (hjf[8]+hjf[9]).valueOf()+'/'+(hjf[5]+hjf[6]).valueOf()+'/'+(hjf[0]+hjf[1]+hjf[2]+hjf[3])+' '+(hjf[11]+hjf[12]).valueOf()+':'+(hjf[14]+hjf[15]).valueOf();
        $scope.fim.dia =  (hjf[8]+hjf[9]).valueOf()+'/'+(hjf[5]+hjf[6]).valueOf()+'/'+(hjf[0]+hjf[1]+hjf[2]+hjf[3]);
        $scope.fim.hora = (hjf[11]+hjf[12]).valueOf()+':'+(hjf[14]+hjf[15]).valueOf();
        $scope.dia.dia = (hj[8]+hj[9]).valueOf()+'/'+(hj[5]+hj[6]).valueOf();
        $scope.dia.hora = (hj[11]+hj[12]).valueOf()+':'+(hj[14]+hj[15]).valueOf() +' - '+(hjf[11]+hjf[12]).valueOf()+':'+(hjf[14]+hjf[15]).valueOf() ;
      }
      EventoService.GetParticipantes($scope.evento.idevento).then(function(items) {
        $scope.nomeevento = items[0].nomeevento;
        for (var i = 0; i < items.length; i++) {
          if ($scope.aux.iduser == items[i].iduser) {
            $scope.nuser++;
          }
          if (items[i].estado == 0) {
            items[i].confirmacao = 'Sou o organizador';
          }
          if (items[i].estado == 1) {
            items[i].confirmacao = 'Aguardando confirmação';
          }
          if (items[i].estado == 2) {
            items[i].confirmacao = 'Confirmação aprovada';
          }
          if(items[i].borda == 0){
            items[i].bb = false;
            items[i].bs = false;
            items[i].bg = false;
          }
          if(items[i].borda == 1){
            items[i].bb = true;
            items[i].bs = false;
            items[i].bg = false;
          }
          if(items[i].borda == 2){
            items[i].bb = false;
            items[i].bs = true;
            items[i].bg = false;
          }
          if(items[i].borda == 3){
            items[i].bb = false;
            items[i].bs = false;
            items[i].bg = true;
          }
          if((items[i].profilepic[8] == 's' && items[i].profilepic[9] == '3')||(items[i].profilepic[8] == 'd' && items[i].profilepic[9] == 'i')){
            items[i].profilepic = items[i].profilepic+"?{{getTimeStamp()}}";
           }else{
             items[i].profilepic = items[i].profilepic;
           }
        }
        $scope.items = items.concat($scope.items);
      });
    });
    if($scope.evento.genero == "masc"){
      $scope.masc = true;
      $scope.fem = false;
    }
    if($scope.evento.genero == "fem"){
        $scope.fem = true;
        $scope.masc = false;
    }
    if($scope.evento.genero == "todos"){
        $scope.fem = false;
        $scope.masc = false;
    }
    if($scope.evento.preco == 0 || $scope.evento.preco =="Gratuito"){
      $scope.evento.preco = "Gratuito";
      $scope.porpessoa = false;
      $scope.porlocal = false;
    }else{
      if($scope.evento.precopor == 1){
        $scope.porpessoa = true;
        $scope.porlocal = false;
      }else{
        $scope.porpessoa = false;
        $scope.porlocal = true;
      }
    }
    $scope.enterItem =  function(item){
      formOutro.updateForm(item);
      console.log(item.iduser)
      $state.go('tabsController.perfil_outro_eventoabertos');
    }


}])

.controller('convitescriarCtrl', ['$scope', '$stateParams', 'formItem', 'EventoService', 'formUser','$state', '$http', '$timeout','$ionicPopup','$cordovaSocialSharing', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, formItem, EventoService, formUser,$state, $http, $timeout, $ionicPopup, $cordovaSocialSharing) {

    $scope.user = formUser.getForm();
    if(!$scope.user.codigo || $scope.user.codigo == 'null'){
      $scope.user.codigo = '';
      $scope.temcondigo = true;
    }else{
      $scope.temcondigo = false;
      $scope.user.codigodatacriacao = $scope.user.codigodatacriacao[0]+$scope.user.codigodatacriacao[1]+$scope.user.codigodatacriacao[2]+$scope.user.codigodatacriacao[3]+$scope.user.codigodatacriacao[4]+$scope.user.codigodatacriacao[5]+$scope.user.codigodatacriacao[6]+$scope.user.codigodatacriacao[7]+$scope.user.codigodatacriacao[8]+$scope.user.codigodatacriacao[9];
      $scope.codigodata = new Date($scope.user.codigodatacriacao);
  
      $scope.codigodata.setDate($scope.codigodata.getDate() + 14);
      var curr_date_codigo = ($scope.codigodata.getDate()<10?'0':'') + $scope.codigodata.getDate();
      var curr_month_codigo = ($scope.codigodata.getMonth()<10?'0':'') + ($scope.codigodata.getMonth() + 1); 
      var curr_year_codigo = $scope.codigodata.getFullYear();
      $scope.codigodata = curr_date_codigo + "/" + curr_month_codigo + "/" + curr_year_codigo;
      //console.log($scope.user.codigodatacriacao)
    }


    $scope.$on("$ionicView.enter", function(event, data){
      EventoService.getusuario($scope.user).then(function(user) {
        $scope.user = user;
        if(!$scope.user.codigo || $scope.user.codigo == 'null'){
          $scope.user.codigo = '';
          $scope.temcondigo = true;
        }else{
          $scope.temcondigo = false;
          $scope.user.codigodatacriacao = $scope.user.codigodatacriacao[0]+$scope.user.codigodatacriacao[1]+$scope.user.codigodatacriacao[2]+$scope.user.codigodatacriacao[3]+$scope.user.codigodatacriacao[4]+$scope.user.codigodatacriacao[5]+$scope.user.codigodatacriacao[6]+$scope.user.codigodatacriacao[7]+$scope.user.codigodatacriacao[8]+$scope.user.codigodatacriacao[9];
          $scope.codigodata = new Date($scope.user.codigodatacriacao);
      
          $scope.codigodata.setDate($scope.codigodata.getDate() + 14);
          var curr_date_codigo = ($scope.codigodata.getDate()<10?'0':'') + $scope.codigodata.getDate();
          var curr_month_codigo = ($scope.codigodata.getMonth()<10?'0':'') + ($scope.codigodata.getMonth() + 1); 
          var curr_year_codigo = $scope.codigodata.getFullYear();
          $scope.codigodata = curr_date_codigo + "/" + curr_month_codigo + "/" + curr_year_codigo;
          //console.log($scope.user.codigodatacriacao)
        }
      });
    });

    //  $scope.share = function() {
    //         $cordovaSocialSharing.canShareVia("twitter", 'Oii', '', 'http://diwoapp.com.br/politica-de-privacidade/').then(function(result) {
    //             $cordovaSocialSharing.shareViaTwitter('Oii', '', 'http://diwoapp.com.br/politica-de-privacidade/');
    //         }, function(error) {
    //             alert("Cannot share on Twitter");
    //         });
    //     }


    $scope.share = function(t, msg, img, link){ 
      $scope.msgshare = "Use meu código para entrar: " + $scope.user.codigo;
        if(t == 'w')
          $cordovaSocialSharing.canShareVia('whatsapp', $scope.msgshare, '', 'http://diwoapp.com.br/politica-de-privacidade/').then(function(result) {
            $cordovaSocialSharing.shareViaWhatsApp($scope.msgshare, '' ,device.platform == "Android" ? $scope.linkevento : "http://onelink.to/cscut7") ;
            }, function(error) {
                alert("Cannot share on whatsapp");
            });
        else if(t == 'f')
          $cordovaSocialSharing.canShareVia('facebook', $scope.msgshare, '', 'http://diwoapp.com.br/politica-de-privacidade/').then(function(result) {
                $cordovaSocialSharing.shareViaFacebook( $scope.msgshare, '', device.platform == "Android" ? $scope.linkevento : "http://onelink.to/cscut7");
            }, function(error) {
                alert("Cannot share on whatsapp");
            });
  
        else if(t == 't')
            $cordovaSocialSharing.canShareVia('twitter', $scope.msgshare, '', 'http://diwoapp.com.br/politica-de-privacidade/').then(function(result) {
                $cordovaSocialSharing.shareViaTwitter( + $scope.msgshare, '', device.platform == "Android" ? $scope.linkevento : "http://onelink.to/cscut7");
            }, function(error) {
                alert("Cannot share on whatsapp");
            })
    }


    $scope.user.auxcodigo = '';
    $scope.criarcodigo = function(){
      var currentdate = new Date(); 
      var curr_date = (currentdate.getDate()<10?'0':'') + currentdate.getDate();
      var curr_month = (currentdate.getMonth()<10?'0':'') + (currentdate.getMonth() + 1); 
      var curr_year = currentdate.getFullYear();
      var h2 = (currentdate.getHours()<10?'0':'') + currentdate.getHours();
      var m2 = (currentdate.getMinutes()<10?'0':'') + currentdate.getMinutes();
      var j = curr_year + "-" + curr_month + "-" + curr_date+ ' '+h2 + ':' + m2 + ':00';

      var res2 = $scope.user.codigo.split(" ") ;
          if(res2.length>=1){
            for(var w = 0; w < res2.length; w++){
              $scope.user.auxcodigo = $scope.user.auxcodigo + res2[w];
            }
          }
      $scope.user.codigo = $scope.user.auxcodigo;
      console.log($scope.user.codigo.length,$scope.user.codigo )
      if($scope.user.codigo.length<6){
          var alertPopup = $ionicPopup.alert({
            title: 'Seu código é muito curto',
            template: 'Escreva outro'
          });
          $scope.user.codigo = '';
      }else{
        EventoService.confereconvite($scope.codigo).then(function(resp) {
          console.log(resp.success, "fewe")
          if(resp.success == false){
            $http.post('https://ec2.diwoapp.com.br/criacodigouser.php' , {iduser :$scope.user.iduser, 
                                                                        codigo :  $scope.user.codigo,
                                                                        codigodatacriacao : j}).then(function(msg){
             if(msg.data.success == true){
              $scope.msn = 'Não se esqueça que seu código é: ' + $scope.user.codigo;
              var alertPopup = $ionicPopup.alert({
                title: 'Seu código foi criado',
                template: $scope.msn
              });
              alertPopup.then(function(){
                window.localStorage.setItem( 'user', JSON.stringify($scope.user));
                formUser.updateForm($scope.user);
                $state.go('tabsController.perfil');
              });
             }else{
              var alertPopup = $ionicPopup.alert({
                title: 'Ouve uma falha',
                template: 'Algo de certo não deu errado, O Q????'
              });
              alertPopup.then(function(){
                
                $state.go('tabsController.perfil');
              });
             } 
            });
          }else{
            var alertPopup = $ionicPopup.alert({
              title: 'Código ja existe',
              template: 'Crie um código!!'
            });
          }
        });
        
      }  
    }

}])
   
.controller('perfilCtrl', ['$scope', '$stateParams','$http', 'EventoService','$ionicTabsDelegate', '$timeout', 'formUser', '$state', 'formItem', 'formtela','formpontos', 'formEditar', 'formEventoPerfil', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, $http, EventoService,$ionicTabsDelegate, $timeout, formUser, $state, formItem, formtela, formpontos, formEditar, formEventoPerfil) {
  formEditar.updateForm(0);
  $scope.user = formUser.getForm();
  $ionicTabsDelegate.showBar(0);
  $scope.vazio = false;
  // $scope.teste = function(){
  //   $state.go('tabsController.PagarmeDadosCC')
  // }
  //console.log($scope.user.codigo, "$scope.user.codigo")
  if(!$scope.user.numcodigo || $scope.user.numcodigo == 'null'){
    $scope.ntemcodigo = true;
  }else{
    $scope.ntemcodigo = false;
  }

  if($scope.user.borda == 0){
    $scope.estrelabb = false;
    $scope.estrelabs = false;
    $scope.estrelabg = false;
    //$scope.brooch = false;
  }
  if($scope.user.borda == 1){
    $scope.estrelabb = true;
    $scope.estrelabs = false;
    $scope.estrelabg = false;
    //$scope.brooch = false;
  }
  if($scope.user.borda == 2){
    $scope.estrelabb = false;
    $scope.estrelabs = true;
    $scope.estrelabg = false;
    $scope.brooch = false;
  }
  if($scope.user.borda == 3){
    $scope.estrelabb = false;
    $scope.estrelabs = false;
    $scope.estrelabg = true;
    //$scope.brooch = false;
  }
  // if($scope.user.borda == 42){
  //   $scope.estrelabb = false;
  //   $scope.estrelabs = false;
  //   $scope.estrelabg = false;
  //   $scope.brooch = true;
  // }
  $scope.estadobutton = 0;  
  $scope.neventos= 0;
  $scope.neventosnao= 0;
  $scope.CoisasCriado = true;
  $scope.CoisasFinalizado = false;
  $scope.ic = {};
  $scope.atualiza ={};
  $scope.idader = '';
  $scope.frase = {};
  EventoService.getusuario($scope.user).then(function(user) {
        $scope.user = user;
        if((user.profilepic[8] == 's' && user.profilepic[9] == '3')||(user.profilepic[8] == 'd' && user.profilepic[9] == 'i')){
        //if(user.profilepic[8] == 's' && user.profilepic[9] == '3'){
          document.getElementById("imageid").src=user.profilepic+"?{{getTimeStamp()}}";
        }else{
          document.getElementById("imageid").src=user.profilepic;
        }
        if(user.numcodigo == '0'){
          document.getElementById("badgeimg").src="img/egg_0.png";
        }
        if(user.numcodigo == '1'){
          document.getElementById("badgeimg").src="img/egg_1.png";
        }
        if(user.numcodigo == '2'){
          document.getElementById("badgeimg").src="img/egg_2.png";
        }
        if(parseInt(user.numcodigo) >= 3){
          document.getElementById("badgeimg").src="img/egg_3.png";
        }
        if(parseInt(user.numcodigo) < 0){
          document.getElementById("badgeimg").src="img/egg_3.png";
        }

        //console.log(user.profilepic)
        if($scope.user.borda == 0){
          $scope.estrelabb = false;
          $scope.estrelabs = false;
          $scope.estrelabg = false;
          //$scope.brooch = false;
        }
        if($scope.user.borda == 1){
          $scope.estrelabb = true;
          $scope.estrelabs = false;
          $scope.estrelabg = false;
          //$scope.brooch = false;
        }
        if($scope.user.borda == 2){
          $scope.estrelabb = false;
          $scope.estrelabs = true;
          $scope.estrelabg = false;
          //$scope.brooch = false;
        }
        if($scope.user.borda == 3){
          $scope.estrelabb = false;
          $scope.estrelabs = false;
          $scope.estrelabg = true;
          $scope.brooch = false;
        }
        // if($scope.user.borda == 42){
        //   $scope.estrelabb = false;
        //   $scope.estrelabs = false;
        //   $scope.estrelabg = false;
        //   $scope.brooch = true;
        // }
        if($scope.user.idade){
          $scope.idader = ", "+ $scope.user.idade +" anos";
        }
      });
  
  var infiscroll = 0;  

  $scope.noMoreItemsAvailable = true;



  var header = document.getElementById("barperfil");
    var btns = header.getElementsByClassName("btnperfil");
    for (var i = 0; i < btns.length; i++) {
      btns[i].addEventListener("click", function() {
        var current = document.getElementsByClassName("actperfil");
        current[0].className = current[0].className.replace(" actperfil", "");
        this.className += " actperfil";
      });
    }

  EventoService.GetPontos($scope.user.iduser).then(function(items) {
    $scope.p = items;
    $scope.labels3 = ["Pontos"];
    $scope.colores3 = ["#ff4d4d"];
    $scope.data3 = [$scope.p];
    $scope.atualiza.pontos = $scope.p;
    $scope.atualiza.iduser = $scope.user.iduser;
    EventoService.atualizarpontos($scope.atualiza);
  });


    $scope.$on("$ionicView.enter", function(event, data){
      var das = document.getElementById("barperfilprimeiro");
      var current = document.getElementsByClassName("actperfil");
      current[0].className = current[0].className.replace(" actperfil", "");
      das.className += " actperfil";
      $scope.user = formUser.getForm();
      $scope.vazio = false;
      console.log($scope.user.codigo)
      $scope.idader = '';
      $ionicTabsDelegate.showBar(0);
      var infiscroll = 0;
      $scope.CoisasCriado = false;
      $scope.CoisasFinalizado = false;
      $scope.items = [];
      $scope.vezes = 0;
      $scope.newItems = [];
      $scope.lastidevento = 0;
      $scope.aux = 0;
      $scope.frase = {};
      //$scope.ic = {};
      formEditar.updateForm(0);

      if($scope.user.idade){
        $scope.idader = ", "+ $scope.user.idade +" anos";
        console.log($scope.idader)
      }
     
      EventoService.getIC($scope.user).then(function(items) {
        if(items){
          $scope.ic = items;
          $scope.options2 = {title: {
                      display: true,
                      text: 'Indice de confirmação',
                      position: 'bottom'
                  }
           }
          $scope.labels2 = ["Fui", "Não fui"];
          $scope.colores2 = ["#99FF99","#ff4d4d"];
          var menos = (100-$scope.ic.total).toFixed(1);
          var mais = $scope.ic.total;
          $scope.data2 = [mais, menos ];
        }
        
      });
      EventoService.getusuario($scope.user).then(function(user) {
        $scope.user = user;
        if($scope.user.borda == 0){
          $scope.estrelabb = false;
          $scope.estrelabs = false;
          $scope.estrelabg = false;
          //$scope.brooch = false;
        }
        if($scope.user.borda == 1){
          $scope.estrelabb = true;
          $scope.estrelabs = false;
          $scope.estrelabg = false;
          //$scope.brooch = false;
        }
        if($scope.user.borda == 2){
          $scope.estrelabb = false;
          $scope.estrelabs = true;
          $scope.estrelabg = false;
          //$scope.brooch = false;
        }
        if($scope.user.borda == 3){
          $scope.estrelabb = false;
          $scope.estrelabs = false;
          $scope.estrelabg = true;
          //$scope.brooch = false;
        }
        // if($scope.user.borda == 42){
        //   $scope.estrelabb = false;
        //   $scope.estrelabs = false;
        //   $scope.estrelabg = false;
        //   $scope.brooch = true;
        // }
        
        if((user.profilepic[8] == 's' && user.profilepic[9] == '3')||(user.profilepic[8] == 'd' && user.profilepic[9] == 'i')){
        
         document.getElementById("imageid").src=user.profilepic+"?{{getTimeStamp()}}";
         }else{
          document.getElementById("imageid").src=user.profilepic;
         }
         if(user.numcodigo == '0'){
          document.getElementById("badgeimg").src="img/egg_0.png";
        }
        if(user.numcodigo == '1'){
          document.getElementById("badgeimg").src="img/egg_1.png";
        }
        if(user.numcodigo == '2'){
          document.getElementById("badgeimg").src="img/egg_2.png";
        }
        if(parseInt(user.numcodigo) >= 3){
          document.getElementById("badgeimg").src="img/egg_3.png";
        }
        if(parseInt(user.numcodigo) < 0){
          document.getElementById("badgeimg").src="img/egg_3.png";
        }
        if(user){
         EventoService.GetComments3($scope.user).then(function(items) {
          if(items){
            $scope.options = {title: {
                      display: true,
                      text: 'Avaliações',
                      position: 'bottom'}};
            $scope.labels = ["Extrovertido", "Introvertido", "Realista","Curioso", "Solidário", "Racional","Organizado", "Criativo"];
            $scope.colores = ["#fff200", "#02fff2", "#ff9d00","#1867ce", "#e50be1", "#0e8c28","#ef370e", "#af0eef"];
            $scope.data =items.chart;
            $scope.frase = items.mal;
          }
        }); 
        }
        
      });
      EventoService.GetPontos($scope.user.iduser).then(function(items) {
        $scope.p = items;
        $scope.labels3 = ["Pontos"];
        $scope.colores3 = ["#ff4d4d"];
        $scope.data3 = [$scope.p];
        $scope.atualiza.pontos = $scope.p;
        $scope.atualiza.iduser = $scope.user.iduser;
        EventoService.atualizarpontos($scope.atualiza);
      });

      $scope.tela = formtela.getForm();
      if ($scope.tela == 1) {
        formtela.updateForm(0);
        $state.go('tabsController.eventoFechado');
      }
      if ($scope.tela == 2) {
        formtela.updateForm(0);
        $state.go('tabsController.comentarios');
      }
    });


    $scope.loadCriados = function() {
      $scope.CoisasCriado = true;
      $scope.CoisasFinalizado = false;
      $scope.estadobutton = 0;
      $ionicTabsDelegate.showBar(0);
      $scope.items = [];
      console.log($scope.user.iduser)
      EventoService.GetCriadosPerfil($scope.user).then(function(items) {
        if(items=='E'){
          $scope.vazio = true;
          $scope.items = [];
        }else{
          $scope.vazio = false;
          for (var i = 0; i < items.length; i++) {
                var curr_date = (items[i].diainicio[8]+items[i].diainicio[9]);
                var h2 = (items[i].diainicio[11]+items[i].diainicio[12]);
                var m2 = (items[i].diainicio[14]+items[i].diainicio[15]);
                var curr_month = (items[i].diainicio[5]+items[i].diainicio[6]);
                var curr_year = (items[i].diainicio[0]+items[i].diainicio[1]+items[i].diainicio[2]+items[i].diainicio[3]);
                var j = curr_date + "/" + curr_month + "/" + curr_year+ ' '+h2 + ':' + m2;
                items[i].datainicio = j;




                  var hj = items[i].diainicio;
                  var ano = (hj[0]+hj[1]+hj[2]+hj[3]).valueOf();
                  var mes = (hj[5]+hj[6]).valueOf();
                  var dia = (hj[8]+hj[9]).valueOf();
                  var h = (hj[11]+hj[12]).valueOf();
                  var m = (hj[14]+hj[15]).valueOf();
                  var hjf = items[i].diafim;
                  items[i].fimdia =  (hjf[8]+hjf[9]).valueOf()+'/'+(hjf[5]+hjf[6]).valueOf()+'/'+(hjf[0]+hjf[1]+hjf[2]+hjf[3]);
                  items[i].fimhora = (hjf[11]+hjf[12]).valueOf()+':'+(hjf[14]+hjf[15]).valueOf();
                  items[i].diadia = dia+'/'+mes;
                  items[i].diahora = h+':'+m +' - '+(hjf[11]+hjf[12]).valueOf()+':'+(hjf[14]+hjf[15]).valueOf() ;
                 
                if(items[i].estado == 0){
                  items[i].confirmacao = "Vai acontecer"
                }
                if(items[i].estado == 1){
                  items[i].confirmacao = "Finalizado"
                }
                if(items[i].estado == 2){
                  items[i].confirmacao = "Standy by, talvez aconteça"
                }
                if(items[i].estado == 3){
                  items[i].confirmacao = "Vai acontecer"
                }
                if(items[i].estado == 4){
                  items[i].confirmacao = "Cancelado"
                }
                if(items[i].estado == 5){
                  items[i].confirmacao = "Acabado"
                }
                if(items[i].estado == 6){
                  items[i].confirmacao = "Escondido"
                }
            }
          $scope.items = items;
          $scope.lastidvestido = $scope.items[0].idevento;
        }
      });
      $scope.noMoreItemsAvailable = false;
    }

    $scope.loadFechados = function() {
      $scope.CoisasCriado = false;
      $scope.CoisasFinalizado = true;
      $scope.estadobutton = 2;
      $scope.items = {};
      $ionicTabsDelegate.showBar(0);
      //console.log($scope.user.iduser);

      EventoService.GetFinalizadosPerfil($scope.user.iduser).then(function(items) {        
        //console.log(items)
        if(items=='E'){
          $scope.vazio = true;
          $scope.items = [];
        }else{
          $scope.vazio = false;
          for (var i = 0; i < items.length; i++) {
                var curr_date = (items[i].diainicio[8]+items[i].diainicio[9]);
                var h2 = (items[i].diainicio[11]+items[i].diainicio[12]);
                var m2 = (items[i].diainicio[14]+items[i].diainicio[15]);
                var curr_month = (items[i].diainicio[5]+items[i].diainicio[6]);
                var curr_year = (items[i].diainicio[0]+items[i].diainicio[1]+items[i].diainicio[2]+items[i].diainicio[3]);
                var j = curr_date + "/" + curr_month + "/" + curr_year+ ' '+h2 + ':' + m2;
                items[i].datainicio = j;
               


                  var hj = items[i].diainicio;
                  var ano = (hj[0]+hj[1]+hj[2]+hj[3]).valueOf();
                  var mes = (hj[5]+hj[6]).valueOf();
                  var dia = (hj[8]+hj[9]).valueOf();
                  var h = (hj[11]+hj[12]).valueOf();
                  var m = (hj[14]+hj[15]).valueOf();
                  var hjf = items[i].diafim;
                  items[i].fimdia =  (hjf[8]+hjf[9]).valueOf()+'/'+(hjf[5]+hjf[6]).valueOf()+'/'+(hjf[0]+hjf[1]+hjf[2]+hjf[3]);
                  items[i].fimhora = (hjf[11]+hjf[12]).valueOf()+':'+(hjf[14]+hjf[15]).valueOf();
                  items[i].diadia = dia+'/'+mes;
                  items[i].diahora = h+':'+m +' - '+(hjf[11]+hjf[12]).valueOf()+':'+(hjf[14]+hjf[15]).valueOf() ;
                 
            }
          $scope.items = items;
          $scope.lastidvestido = $scope.items[0].idevento;
        }
      });


        
    }

      
    $scope.loadMore = function() {
      $ionicTabsDelegate.showBar(0);
      if ($scope.estadobutton == 0) {
        EventoService.GetOldEventosCriados($scope.user).then(function(items) {
        $scope.items = $scope.items.concat(items);
          console.log(infiscroll);
          // an empty array indicates that there are no more items
          if (items.length <= 4 && infiscroll > 0) {
            $scope.noMoreItemsAvailable = true;
            infiscroll = 0;
          }
          infiscroll++;

        $scope.$broadcast('scroll.infiniteScrollComplete');
        });
      }
      if ($scope.estadobutton == 2) {
        EventoService.GetOldEventosCriados().then(function(items) {
        $scope.items = $scope.items.concat(items);
        $scope.$broadcast('scroll.infiniteScrollComplete');
          // an empty array indicates that there are no more items
          if (items.length <= 4) {
            $scope.noMoreItemsAvailable = true;
          }
        });

      
      }
    }
          
    $scope.enterItem =  function(items){
      formEventoPerfil.updateForm(items);
      //formItem.updateForm(items);
      console.log(items.idevento);
      console.log(items.idadm);
      if ($scope.estadobutton == 2) {
        $state.go('tabsController.eventoFechado');
      }
      if ($scope.estadobutton == 0) {
        $state.go('tabsController.eventoCriado');
      }
    }

    $scope.entrar = function(){
      $state.go('tabsController.comentarios');
    }
    $scope.entrabadges = function(){
      $state.go('tabsController.badges');
    }

    $scope.entracriacodigo = function(){
      $state.go('tabsController.convitescriar');
    }

    $scope.indice = function(){
      $state.go('tabsController.indice');
    }

    $scope.ranking = function(){
      $state.go('tabsController.ranking');
    }

}])

.controller('indiceCtrl', ['$scope', '$stateParams', 'formItem', 'EventoService', 'formUser','$state', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, formItem, EventoService, formUser,$state) {
  $scope.user = formUser.getForm();
  $scope.ic = {};

  EventoService.getIC($scope.user).then(function(ic) {
    if(ic){
      $scope.ic = ic;
    }
  });

}])

.controller('comentariosCtrl', ['$scope', '$stateParams', 'formItem', 'EventoService', 'formUser','$state', '$ionicPopup', '$http', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, formItem, EventoService, formUser,$state, $ionicPopup, $http) {
   
    $scope.user = formUser.getForm();
    $scope.items = {};
    $scope.it = {};
    $scope.mandeimal = {};
    $scope.mandeibem = {};
    $scope.mostraruim = false;
    $scope.mostratodos = true;
    $scope.mostrabom = false;

    var header2 = document.getElementById("barcome");
    var btns2 = header2.getElementsByClassName("btncome");
    for (var i = 0; i < btns2.length; i++) {
      btns2[i].addEventListener("click", function() {
        var current2 = document.getElementsByClassName("act");
        current2[0].className = current2[0].className.replace(" act", "");
        this.className += " act";
      });
    }

    EventoService.GetComments3($scope.user).then(function(items) {
      if(!items){
        $scope.items = {};
        $scope.mandeimal = {};
        $scope.mandeibem = {};
      }else{
         $scope.labels = ["Extrovertido", "Introvertido", "Realista","Curioso", "Solidário", "Racional","Organizado", "Criativo"];
        $scope.colores = ["#fff200", "#02fff2", "#ff9d00","#1867ce", "#e50be1", "#0e8c28","#ef370e", "#af0eef"];
        $scope.data =items.chart;
        $scope.ncomen = items.mal;
        $scope.mandeimal = items.ruins;
        $scope.mandeibem = items.bons;
        $scope.items = items.resto;
        for(var i = 0;i<items.tudo.length;i++){
          if((items.tudo[i].profilepic[8] == 's' && items.tudo[i].profilepic[9] == '3')||(items.tudo[i].profilepic[8] == 'd' && items.tudo[i].profilepic[9] == 'i')){
        
           //if(items.tudo[i].profilepic[8] == 's' && items.tudo[i].profilepic[9] == '3'){
             $scope.items[i].profilepic = items.tudo[i].profilepic+"?{{getTimeStamp()}}";
           }else{
              $scope.items[i].profilepic = items.tudo[i].profilepic;
           }
          //$scope.items[i].profilepic = items.tudo[i].profilepic+"?{{getTimeStamp()}}";
        }
        for(var i = 0;i<items.bons.length;i++){
          if((items.bons[i].profilepic[8] == 's' && items.bons[i].profilepic[9] == '3')||(items.bons[i].profilepic[8] == 'd' && items.bons[i].profilepic[9] == 'i')){
        
          //if(items.bons[i].profilepic[8] == 's' && items.bons[i].profilepic[9] == '3'){
             $scope.mandeibem[i].profilepic = items.bons[i].profilepic+"?{{getTimeStamp()}}";
           }else{
              $scope.mandeibem[i].profilepic = items.bons[i].profilepic;
           }
          //$scope.mandeibem[i].profilepic = items.bons[i].profilepic+"?{{getTimeStamp()}}";
        }
        for(var i = 0;i<items.ruins.length;i++){
          if((items.ruins[i].profilepic[8] == 's' && items.ruins[i].profilepic[9] == '3')||(items.ruins[i].profilepic[8] == 'd' && items.ruins[i].profilepic[9] == 'i')){
          //if(items.ruins[i].profilepic[8] == 's' && items.ruins[i].profilepic[9] == '3'){
             $scope.mandeimal[i].profilepic = items.ruins[i].profilepic+"?{{getTimeStamp()}}";
           }else{
              $scope.mandeimal[i].profilepic = items.ruins[i].profilepic;
           }
          //$scope.mandeimal[i].profilepic = items.ruins[i].profilepic+"?{{getTimeStamp()}}";
        }
        // document.getElementById("imageidComent").src=$scope.items.profilepic+"?{{getTimeStamp()}}";
        // document.getElementById("imageidComentmandeibem").src=$scope.mandeibem.profilepic+"?{{getTimeStamp()}}";
        // document.getElementById("imageidComentmandeimal").src=$scope.mandeimal.profilepic+"?{{getTimeStamp()}}";
      }
    });

    $scope.bom = function(){
      $scope.mostraruim = false;
      $scope.mostrabom = true;
      $scope.mostratodos = false;
    }
    $scope.ruim = function(){
      $scope.mostraruim = true;
      $scope.mostrabom = false;
      $scope.mostratodos = false;
    }
    $scope.todos = function(){
      $scope.mostraruim = false;
      $scope.mostrabom = false;
      $scope.mostratodos = true;
    }
    $scope.reportcoment = function(item){
      $ionicPopup.prompt({
                    title: 'Você quer reportar esse comentário pq?',
                    template: 'Não me venha reportando só pq tu quer, não me venha dar trabalho!!!!',
                   inputType: 'text',
                   inputPlaceholder: ' Linguajar ofensivo ou inapropriado'
                 }).then(function(texto) {
                  if(texto){
                    $scope.reportmsg = item.idavaliacao + ' (idavaliação) '+texto;
                    $http.post('https://ec2.diwoapp.com.br/reportaevento.php', {namereportado : item.nomeavaliador,
                                                                              reportadoid : item.iduser,
                                                                              iduserreportando : $scope.user.iduser,
                                                                              usernamereportando : $scope.user.username,
                                                                              tiporeport : 'comentario',
                                                                              motivo : $scope.reportmsg}).then(function (tes){
                                 $scope.response = tes.data;
                                  var alertPopup = $ionicPopup.alert({
                                                          title: 'Obrigado',
                                                          template: 'Esta pessoa esta agora sobre investigação, obrigado por manter a plataforma segura'
                                                        });

                               });
                  }
                  
                 });
    }
  
      
}])

.controller('comentariosdosoutrosCtrl', ['$scope', '$stateParams', 'formItem', 'EventoService', 'formUser','$state', 'formOutro', 'formStalker', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, formItem, EventoService, formUser,$state, formOutro , formStalker) {
   
   $scope.user = formStalker.getForm();
   
   $scope.items = {};
   $scope.mandeimal = {};
    $scope.mandeibem = {};
    $scope.mostraruim = false;
    $scope.mostratodos = true;
    $scope.mostrabom = false;

    var header2 = document.getElementById("barcome");
    var btns2 = header2.getElementsByClassName("btncome");
    for (var i = 0; i < btns2.length; i++) {
      btns2[i].addEventListener("click", function() {
        var current2 = document.getElementsByClassName("act");
        current2[0].className = current2[0].className.replace(" act", "");
        this.className += " act";
      });
    }

    EventoService.GetComments3($scope.user).then(function(items) {
      if(!items){
        $scope.items = {};
      }else{
           $scope.labels = ["Extrovertido", "Introvertido", "Realista","Curioso", "Solidário", "Racional","Organizado", "Criativo"];
          $scope.colores = ["#fff200", "#02fff2", "#ff9d00","#1867ce", "#e50be1", "#0e8c28","#ef370e", "#af0eef"];
          $scope.data =items.chart;
          $scope.ncomen = items.mal;
          $scope.mandeimal = items.ruins;
          $scope.mandeibem = items.bons;
          $scope.items = items.resto;
           for(var i = 0;i<items.resto.length;i++){
             if((items.resto[i].profilepic[8] == 's' && items.resto[i].profilepic[9] == '3')||(items.resto[i].profilepic[8] == 'd' && items.resto[i].profilepic[9] == 'i')){
          
           //if(items.resto[i].profilepic[8] == 's' && items.resto[i].profilepic[9] == '3'){
             $scope.items[i].profilepic = items.resto[i].profilepic+"?{{getTimeStamp()}}";
           }else{
              $scope.items[i].profilepic = items.resto[i].profilepic;
           }
          //$scope.items[i].profilepic = items.tudo[i].profilepic+"?{{getTimeStamp()}}";
        }
        for(var i = 0;i<items.bons.length;i++){
           if((items.bons[i].profilepic[8] == 's' && items.bons[i].profilepic[9] == '3')||(items.bons[i].profilepic[8] == 'd' && items.bons[i].profilepic[9] == 'i')){
           $scope.mandeibem[i].profilepic = items.bons[i].profilepic+"?{{getTimeStamp()}}";
           }else{
              $scope.mandeibem[i].profilepic = items.bons[i].profilepic;
           }
          //$scope.mandeibem[i].profilepic = items.bons[i].profilepic+"?{{getTimeStamp()}}";
        }
        for(var i = 0;i<items.ruins.length;i++){
          if((items.ruins[i].profilepic[8] == 's' && items.ruins[i].profilepic[9] == '3')||(items.ruins[i].profilepic[8] == 'd' && items.ruins[i].profilepic[9] == 'i')){
             $scope.mandeimal[i].profilepic = items.ruins[i].profilepic+"?{{getTimeStamp()}}";
           }else{
              $scope.mandeimal[i].profilepic = items.ruins[i].profilepic;
           }
          //$scope.mandeimal[i].profilepic = items.ruins[i].profilepic+"?{{getTimeStamp()}}";
        }
          // for(var i = 0;i<items.resto.length;i++){
          // $scope.items[i].profilepic = items.resto[i].profilepic+"?{{getTimeStamp()}}";
          // }
          // for(var i = 0;i<items.bons.length;i++){
          //   $scope.mandeibem[i].profilepic = items.bons[i].profilepic+"?{{getTimeStamp()}}";
          // }
          // for(var i = 0;i<items.ruins.length;i++){
          //   $scope.mandeimal[i].profilepic = items.ruins[i].profilepic+"?{{getTimeStamp()}}";
          // }
        }
      });
   

    
    $scope.bom = function(){
      console.log($scope.mandeibem);
      $scope.mostraruim = false;
      $scope.mostrabom = true;
      $scope.mostratodos = false;
    }
    $scope.ruim = function(){
      console.log($scope.mandeimal);
      $scope.mostraruim = true;
      $scope.mostrabom = false;
      $scope.mostratodos = false;
    }
    $scope.todos = function(){
      console.log($scope.items);
      $scope.mostraruim = false;
      $scope.mostrabom = false;
      $scope.mostratodos = true;
    }
  

}])

.controller('comentariosdosoutrosnoperfilCtrl', ['$scope', '$stateParams', 'formItem', 'EventoService', 'formUser','$state', 'formOutro', 'formStalker', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, formItem, EventoService, formUser,$state, formOutro , formStalker) {
   
  $scope.user = formStalker.getForm(); 
  $scope.items = {};
  $scope.mandeimal = {};
    $scope.mandeibem = {};
    $scope.mostraruim = false;
    $scope.mostratodos = true;
    $scope.mostrabom = false;

  var header2 = document.getElementById("barcome");
  var btns2 = header2.getElementsByClassName("btncome");
  for (var i = 0; i < btns2.length; i++) {
    btns2[i].addEventListener("click", function() {
      var current2 = document.getElementsByClassName("act");
      current2[0].className = current2[0].className.replace(" act", "");
      this.className += " act";
    });
  }

  EventoService.GetComments3($scope.user).then(function(items) {
      if(!items){
        $scope.items = {};
      }else{
           $scope.labels = ["Extrovertido", "Introvertido", "Realista","Curioso", "Solidário", "Racional","Organizado", "Criativo"];
          $scope.colores = ["#fff200", "#02fff2", "#ff9d00","#1867ce", "#e50be1", "#0e8c28","#ef370e", "#af0eef"];
          $scope.data =items.chart;
          $scope.ncomen = items.mal;
          $scope.mandeimal = items.ruins;
          $scope.mandeibem = items.bons;
          $scope.items = items.resto;
           for(var i = 0;i<items.resto.length;i++){
            if((items.resto[i].profilepic[8] == 's' && items.resto[i].profilepic[9] == '3')||(items.resto[i].profilepic[8] == 'd' && items.resto[i].profilepic[9] == 'i')){
          
           //if(items.tudo[i].profilepic[8] == 's' && items.resto[i].profilepic[9] == '3'){
             $scope.items[i].profilepic = items.resto[i].profilepic+"?{{getTimeStamp()}}";
           }else{
              $scope.items[i].profilepic = items.resto[i].profilepic;
           }
          //$scope.items[i].profilepic = items.tudo[i].profilepic+"?{{getTimeStamp()}}";
        }
        for(var i = 0;i<items.bons.length;i++){
          if((items.bons[i].profilepic[8] == 's' && items.bons[i].profilepic[9] == '3')||(items.bons[i].profilepic[8] == 'd' && items.bons[i].profilepic[9] == 'i')){
          
          //if(items.bons[i].profilepic[8] == 's' && items.bons[i].profilepic[9] == '3'){
             $scope.mandeibem[i].profilepic = items.bons[i].profilepic+"?{{getTimeStamp()}}";
           }else{
              $scope.mandeibem[i].profilepic = items.bons[i].profilepic;
           }
          //$scope.mandeibem[i].profilepic = items.bons[i].profilepic+"?{{getTimeStamp()}}";
        }
        for(var i = 0;i<items.ruins.length;i++){
          if((items.ruins[i].profilepic[8] == 's' && items.ruins[i].profilepic[9] == '3')||(items.ruins[i].profilepic[8] == 'd' && items.ruins[i].profilepic[9] == 'i')){
          
             $scope.mandeimal[i].profilepic = items.ruins[i].profilepic+"?{{getTimeStamp()}}";
           }else{
              $scope.mandeimal[i].profilepic = items.ruins[i].profilepic;
           }
          //$scope.mandeimal[i].profilepic = items.ruins[i].profilepic+"?{{getTimeStamp()}}";
        }
        }
      });
   

    
    $scope.bom = function(){
      console.log($scope.mandeibem);
      $scope.mostraruim = false;
      $scope.mostrabom = true;
      $scope.mostratodos = false;
    }
    $scope.ruim = function(){
      console.log($scope.mandeimal);
      $scope.mostraruim = true;
      $scope.mostrabom = false;
      $scope.mostratodos = false;
    }
    $scope.todos = function(){
      console.log($scope.items);
      $scope.mostraruim = false;
      $scope.mostrabom = false;
      $scope.mostratodos = true;
    }
  
}])


.controller('comentariosperfiloutrosCtrl', ['$scope', '$stateParams', 'EventoService', '$state',  'formStalker', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, EventoService ,$state , formStalker) {
   
   $scope.user = formStalker.getForm();
   
   $scope.items = {};
   $scope.mandeimal = {};
    $scope.mandeibem = {};
    $scope.mostraruim = false;
    $scope.mostratodos = true;
    $scope.mostrabom = false;

    var header2 = document.getElementById("barcome");
    var btns2 = header2.getElementsByClassName("btncome");
    for (var i = 0; i < btns2.length; i++) {
      btns2[i].addEventListener("click", function() {
        var current2 = document.getElementsByClassName("act");
        current2[0].className = current2[0].className.replace(" act", "");
        this.className += " act";
      });
    }

    EventoService.GetComments3($scope.user).then(function(items) {
      if(!items){
        $scope.items = {};
      }else{
         $scope.labels = ["Extrovertido", "Introvertido", "Realista","Curioso", "Solidário", "Racional","Organizado", "Criativo"];
          $scope.colores = ["#fff200", "#02fff2", "#ff9d00","#1867ce", "#e50be1", "#0e8c28","#ef370e", "#af0eef"];
          $scope.data =items.chart;
          $scope.ncomen = items.mal;
          $scope.mandeimal = items.ruins;
          $scope.mandeibem = items.bons;
          $scope.items = items.resto;
           for(var i = 0;i<items.resto.length;i++){
            if((items.resto[i].profilepic[8] == 's' && items.resto[i].profilepic[9] == '3')||(items.resto[i].profilepic[8] == 'd' && items.resto[i].profilepic[9] == 'i')){
          
           //if(items.tudo[i].profilepic[8] == 's' && items.resto[i].profilepic[9] == '3'){
             $scope.items[i].profilepic = items.resto[i].profilepic+"?{{getTimeStamp()}}";
           }else{
              $scope.items[i].profilepic = items.resto[i].profilepic;
           }
          //$scope.items[i].profilepic = items.tudo[i].profilepic+"?{{getTimeStamp()}}";
        }
        for(var i = 0;i<items.bons.length;i++){
          if((items.bons[i].profilepic[8] == 's' && items.bons[i].profilepic[9] == '3')||(items.bons[i].profilepic[8] == 'd' && items.bons[i].profilepic[9] == 'i')){
          
          //if(items.bons[i].profilepic[8] == 's' && items.bons[i].profilepic[9] == '3'){
             $scope.mandeibem[i].profilepic = items.bons[i].profilepic+"?{{getTimeStamp()}}";
           }else{
              $scope.mandeibem[i].profilepic = items.bons[i].profilepic;
           }
          //$scope.mandeibem[i].profilepic = items.bons[i].profilepic+"?{{getTimeStamp()}}";
        }
        for(var i = 0;i<items.ruins.length;i++){
          if((items.ruins[i].profilepic[8] == 's' && items.ruins[i].profilepic[9] == '3')||(items.ruins[i].profilepic[8] == 'd' && items.ruins[i].profilepic[9] == 'i')){
          
          //if(items.ruins[i].profilepic[8] == 's' && items.ruins[i].profilepic[9] == '3'){
             $scope.mandeimal[i].profilepic = items.ruins[i].profilepic+"?{{getTimeStamp()}}";
           }else{
              $scope.mandeimal[i].profilepic = items.ruins[i].profilepic;
           }
          //$scope.mandeimal[i].profilepic = items.ruins[i].profilepic+"?{{getTimeStamp()}}";
        }
        }
      });
   

    
    $scope.bom = function(){
      console.log($scope.mandeibem);
      $scope.mostraruim = false;
      $scope.mostrabom = true;
      $scope.mostratodos = false;
    }
    $scope.ruim = function(){
      console.log($scope.mandeimal);
      $scope.mostraruim = true;
      $scope.mostrabom = false;
      $scope.mostratodos = false;
    }
    $scope.todos = function(){
      console.log($scope.items);
      $scope.mostraruim = false;
      $scope.mostrabom = false;
      $scope.mostratodos = true;
    }
  
}])

.controller('comentariosperfilaceitargeralCtrl', ['$scope', '$stateParams', 'EventoService', '$state',  'formStalker', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, EventoService ,$state , formStalker) {
   
   $scope.user = formStalker.getForm();
   
   $scope.items = {};
   $scope.mandeimal = {};
    $scope.mandeibem = {};
    $scope.mostraruim = false;
    $scope.mostratodos = true;
    $scope.mostrabom = false;

    var header2 = document.getElementById("barcome");
    var btns2 = header2.getElementsByClassName("btncome");
    for (var i = 0; i < btns2.length; i++) {
      btns2[i].addEventListener("click", function() {
        var current2 = document.getElementsByClassName("act");
        current2[0].className = current2[0].className.replace(" act", "");
        this.className += " act";
      });
    }

    EventoService.GetComments3($scope.user).then(function(items) {
      if(!items){
        $scope.items = {};
      }else{
         $scope.labels = ["Extrovertido", "Introvertido", "Realista","Curioso", "Solidário", "Racional","Organizado", "Criativo"];
          $scope.colores = ["#fff200", "#02fff2", "#ff9d00","#1867ce", "#e50be1", "#0e8c28","#ef370e", "#af0eef"];
          $scope.data =items.chart;
          $scope.ncomen = items.mal;
          $scope.mandeimal = items.ruins;
          $scope.mandeibem = items.bons;
          $scope.items = items.resto;
            for(var i = 0;i<items.resto.length;i++){
            if((items.resto[i].profilepic[8] == 's' && items.resto[i].profilepic[9] == '3')||(items.resto[i].profilepic[8] == 'd' && items.resto[i].profilepic[9] == 'i')){
          
           //if(items.tudo[i].profilepic[8] == 's' && items.resto[i].profilepic[9] == '3'){
             $scope.items[i].profilepic = items.resto[i].profilepic+"?{{getTimeStamp()}}";
           }else{
              $scope.items[i].profilepic = items.resto[i].profilepic;
           }
          //$scope.items[i].profilepic = items.tudo[i].profilepic+"?{{getTimeStamp()}}";
        }
        for(var i = 0;i<items.bons.length;i++){
          if((items.bons[i].profilepic[8] == 's' && items.bons[i].profilepic[9] == '3')||(items.bons[i].profilepic[8] == 'd' && items.bons[i].profilepic[9] == 'i')){
          
          //if(items.bons[i].profilepic[8] == 's' && items.bons[i].profilepic[9] == '3'){
             $scope.mandeibem[i].profilepic = items.bons[i].profilepic+"?{{getTimeStamp()}}";
           }else{
              $scope.mandeibem[i].profilepic = items.bons[i].profilepic;
           }
          //$scope.mandeibem[i].profilepic = items.bons[i].profilepic+"?{{getTimeStamp()}}";
        }
        for(var i = 0;i<items.ruins.length;i++){
          if((items.ruins[i].profilepic[8] == 's' && items.ruins[i].profilepic[9] == '3')||(items.ruins[i].profilepic[8] == 'd' && items.ruins[i].profilepic[9] == 'i')){
          
          //if(items.ruins[i].profilepic[8] == 's' && items.ruins[i].profilepic[9] == '3'){
             $scope.mandeimal[i].profilepic = items.ruins[i].profilepic+"?{{getTimeStamp()}}";
           }else{
              $scope.mandeimal[i].profilepic = items.ruins[i].profilepic;
           }
          //$scope.mandeimal[i].profilepic = items.ruins[i].profilepic+"?{{getTimeStamp()}}";
        }
        }
      });
   

    
    $scope.bom = function(){
      console.log($scope.mandeibem);
      $scope.mostraruim = false;
      $scope.mostrabom = true;
      $scope.mostratodos = false;
    }
    $scope.ruim = function(){
      console.log($scope.mandeimal);
      $scope.mostraruim = true;
      $scope.mostrabom = false;
      $scope.mostratodos = false;
    }
    $scope.todos = function(){
      console.log($scope.items);
      $scope.mostraruim = false;
      $scope.mostrabom = false;
      $scope.mostratodos = true;
    }
  

}])

.controller('comentariosperfilaceitarCtrl', ['$scope', '$stateParams', 'EventoService', '$state',  'formStalker', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, EventoService ,$state , formStalker) {
   
  $scope.user = formStalker.getForm(); 

  $scope.items = {};
  $scope.mandeimal = {};
  $scope.mandeibem = {};

  $scope.mostraruim = false;
  $scope.mostratodos = true;
  $scope.mostrabom = false;

    var header2 = document.getElementById("barcome");
    var btns2 = header2.getElementsByClassName("btncome");
    for (var i = 0; i < btns2.length; i++) {
      btns2[i].addEventListener("click", function() {
        var current2 = document.getElementsByClassName("act");
        current2[0].className = current2[0].className.replace(" act", "");
        this.className += " act";
      });
    }

    EventoService.GetComments3($scope.user).then(function(items) {
      if(!items){
        $scope.items = {};
      }else{
        $scope.labels = ["Extrovertido", "Introvertido", "Realista","Curioso", "Solidário", "Racional","Organizado", "Criativo"];
          $scope.colores = ["#fff200", "#02fff2", "#ff9d00","#1867ce", "#e50be1", "#0e8c28","#ef370e", "#af0eef"];
          $scope.data =items.chart;
          $scope.ncomen = items.mal;
          $scope.mandeimal = items.ruins;
          $scope.mandeibem = items.bons;
          $scope.items = items.resto;
           for(var i = 0;i<items.resto.length;i++){
            if((items.resto[i].profilepic[8] == 's' && items.resto[i].profilepic[9] == '3')||(items.resto[i].profilepic[8] == 'd' && items.resto[i].profilepic[9] == 'i')){
          
           //if(items.tudo[i].profilepic[8] == 's' && items.resto[i].profilepic[9] == '3'){
             $scope.items[i].profilepic = items.resto[i].profilepic+"?{{getTimeStamp()}}";
           }else{
              $scope.items[i].profilepic = items.resto[i].profilepic;
           }
          //$scope.items[i].profilepic = items.tudo[i].profilepic+"?{{getTimeStamp()}}";
        }
        for(var i = 0;i<items.bons.length;i++){
          if((items.bons[i].profilepic[8] == 's' && items.bons[i].profilepic[9] == '3')||(items.bons[i].profilepic[8] == 'd' && items.bons[i].profilepic[9] == 'i')){
          
          //if(items.bons[i].profilepic[8] == 's' && items.bons[i].profilepic[9] == '3'){
             $scope.mandeibem[i].profilepic = items.bons[i].profilepic+"?{{getTimeStamp()}}";
           }else{
              $scope.mandeibem[i].profilepic = items.bons[i].profilepic;
           }
          //$scope.mandeibem[i].profilepic = items.bons[i].profilepic+"?{{getTimeStamp()}}";
        }
        for(var i = 0;i<items.ruins.length;i++){
          if((items.ruins[i].profilepic[8] == 's' && items.ruins[i].profilepic[9] == '3')||(items.ruins[i].profilepic[8] == 'd' && items.ruins[i].profilepic[9] == 'i')){
          
          //if(items.ruins[i].profilepic[8] == 's' && items.ruins[i].profilepic[9] == '3'){
             $scope.mandeimal[i].profilepic = items.ruins[i].profilepic+"?{{getTimeStamp()}}";
           }else{
              $scope.mandeimal[i].profilepic = items.ruins[i].profilepic;
           }
          //$scope.mandeimal[i].profilepic = items.ruins[i].profilepic+"?{{getTimeStamp()}}";
        }
        }
      });
   

    
    $scope.bom = function(){
      console.log($scope.mandeibem);
      $scope.mostraruim = false;
      $scope.mostrabom = true;
      $scope.mostratodos = false;
    }
    $scope.ruim = function(){
      console.log($scope.mandeimal);
      $scope.mostraruim = true;
      $scope.mostrabom = false;
      $scope.mostratodos = false;
    }
    $scope.todos = function(){
      console.log($scope.items);
      $scope.mostraruim = false;
      $scope.mostrabom = false;
      $scope.mostratodos = true;
    }
  

}])

.controller('rankingCtrl', ['$scope', '$stateParams', 'formpontos', 'EventoService', '$http','$timeout','formUser', '$state', '$ionicPopup', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, formpontos, EventoService, $http, $timeout, formUser, $state,$ionicPopup ) {
  $scope.rank = false;
  $scope.use = true;

  var header = document.getElementById("barrank");
    var btns = header.getElementsByClassName("btnrank");
    for (var i = 0; i < btns.length; i++) {
      btns[i].addEventListener("click", function() {
        var current = document.getElementsByClassName("actranking");
        current[0].className = current[0].className.replace(" actranking", "");
        this.className += " actranking";
      });
    }

  $scope.ranking = function(){
    $scope.rank = true;
    $scope.use = false;
    $scope.nentendi = false;
    EventoService.Getranking().then(function (oi){
                                tamanho = oi.length;
                                $scope.items = oi;
                                for(var i = 0; i<tamanho;i++){
                                  $scope.items[i].colocacao = i+1; 
                                }
                             });
  }

  $scope.usar = function(){
    $scope.rank = false;
    $scope.use = true;
    $scope.nentendi = false;
  }

  $scope.entender = function(){
    $scope.rank = false;
    $scope.use = false;
    $scope.nentendi = true;
  }
  $scope.alerta = function(){
        var alertPopup = $ionicPopup.alert({
                title: '(ノ￣ー￣)ノ ● ＼(^ω^＼)',
                subTitle: 'Aguarde',
                template: 'Em breve mais johnson, não culpe nosso Dev'
              });
  }

  $scope.criadorestrelado = function(){
    $state.go("tabsController.nivelestrela");
  }

  

}])

.controller('nivelestrelaCtrl', ['$scope', '$stateParams', 'formpontos', 'EventoService', '$http','$timeout','formUser', '$state', '$ionicPopup',  // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, formpontos, EventoService, $http, $timeout, formUser, $state, $ionicPopup) {

  $scope.user = formUser.getForm();


  $scope.auxproxpontos = 50;
  $scope.auxproxcriados = 5;
  EventoService.GetCriadosacabados($scope.user).then(function(criados) {
      if(criados=='E'){
        $scope.criei = 0;
        $scope.progressPercentCriador = 0;
      }else{
        $scope.criei = criados.length;
        $scope.progressPercentCriador = criados.length;
      }
      if($scope.user.direitoborda == 0){
        $scope.estrelaatualn = true; 
        $scope.estrelaatualb = false;
        $scope.estrelaatuals = false;
        $scope.estrelaatualg = false;
        $scope.estrelaproxb = true;
        $scope.estrelaproxs = false;
        $scope.estrelaproxg = false;
        $scope.auxproxpontos = 50;
        $scope.auxproxcriados = 5;
        if($scope.user.pontos.valueOf()*2>=100){
          $scope.progressPercent = 100;
        }else{
          $scope.progressPercent = $scope.user.pontos.valueOf()*2;
        }
        if($scope.progressPercentCriador.valueOf()*20>=100){
          $scope.progressPercentCriador = 100;
        }else{
          $scope.progressPercentCriador = $scope.progressPercentCriador.valueOf()*20;
        }
      }
      if($scope.user.direitoborda == 1){
        $scope.estrelaatualn = false; 
        $scope.estrelaatualb = true;
        $scope.estrelaatuals = false;
        $scope.estrelaatualg = false;
        $scope.estrelaproxb = false;
        $scope.estrelaproxs = true;
        $scope.estrelaproxg = false;
        $scope.auxproxpontos = 100;
        $scope.auxproxcriados = 10;
     
        if($scope.user.pontos.valueOf()>=100){
          $scope.progressPercent = 100;
        }else{
         $scope.progressPercent = $scope.user.pontos.valueOf();
        }
        if($scope.progressPercentCriador.valueOf()>=10){
          $scope.progressPercentCriador = 100;
        }else{
          $scope.progressPercentCriador = $scope.progressPercentCriador.valueOf()*10;
        }
      }
      if($scope.user.direitoborda == 2){
        $scope.estrelaatualn = false; 
        $scope.estrelaatualb = false;
        $scope.estrelaatuals = true;
        $scope.estrelaatualg = false;
        $scope.estrelaproxb = false;
        $scope.estrelaproxs = false;
        $scope.estrelaproxg = true;
        $scope.auxproxpontos = 200;
        $scope.auxproxcriados = 20;
        
        if(($scope.user.pontos.valueOf()/2) >= 200){
          $scope.progressPercent = 100;
        }else{
         $scope.progressPercent = 2+$scope.user.pontos.valueOf()/2;
        }
        if($scope.progressPercentCriador.valueOf()>=20){
          $scope.progressPercentCriador = 100;
        }else{
          console.log($scope.progressPercentCriador)
          $scope.progressPercentCriador = 2+$scope.progressPercentCriador.valueOf()*5;
        }
      }     // Muda layout da tela
      if($scope.user.direitoborda == 3){
        $scope.estrelaatualn = false; 
        $scope.estrelaatualb = false;
        $scope.estrelaatuals = false;
        $scope.estrelaatualg = false;
        $scope.estrelaproxb = false;
        $scope.estrelaproxs = false;
        $scope.estrelaproxg = false;
      }
    });
  //$scope.progressPercent = $scope.user.pontos;
  $scope.$on("$ionicView.enter", function(event, data){
    $scope.user = formUser.getForm();
    var northlat = $scope.user.northlat;
    var southlat = $scope.user.southlat;
    var westlng = $scope.user.westlng;
    var eastlng = $scope.user.eastlng;
    var lat = $scope.user.lat;
    var long = $scope.user.long;
    EventoService.getusuario($scope.user).then(function(user) {
        $scope.user = user;
          $scope.user.northlat = northlat;
          $scope.user.southlat = southlat;
          $scope.user.westlng = westlng;
          $scope.user.eastlng = eastlng;
          $scope.user.lat =  lat;
          $scope.user.long =  long;
        formUser.updateForm($scope.user);
      });
    $scope.auxproxpontos = 50;
    $scope.auxproxcriados = 5;
    EventoService.GetCriadosacabados($scope.user).then(function(criados) {
      if(criados=='E'){
        $scope.criei = 0;
        $scope.progressPercentCriador = 0;
      }else{
        $scope.criei = criados.length;
        $scope.progressPercentCriador = criados.length;
      }
      if($scope.user.direitoborda == 0){
        $scope.estrelaatualn = true; 
        $scope.estrelaatualb = false;
        $scope.estrelaatuals = false;
        $scope.estrelaatualg = false;
        $scope.estrelaproxb = true;
        $scope.estrelaproxs = false;
        $scope.estrelaproxg = false;
        $scope.estrelault =false;
        $scope.auxproxpontos = 50;
        $scope.auxproxcriados = 5;
        if($scope.user.pontos.valueOf()*2>=100){
          $scope.progressPercent = 100;
        }else{
          $scope.progressPercent = $scope.user.pontos.valueOf()*2;
        }
        if($scope.progressPercentCriador.valueOf()*20>=100){
          $scope.progressPercentCriador = 100;
        }else{
          $scope.progressPercentCriador = $scope.progressPercentCriador.valueOf()*20;
        }
      }
      if($scope.user.direitoborda == 1){
        $scope.estrelaatualn = false; 
        $scope.estrelaatualb = true;
        $scope.estrelaatuals = false;
        $scope.estrelaatualg = false;
        $scope.estrelaproxb = false;
        $scope.estrelaproxs = true;
        $scope.estrelaproxg = false;
        $scope.estrelault =false;
        $scope.auxproxpontos = 100;
        $scope.auxproxcriados = 10;
     
        if($scope.user.pontos.valueOf()>=100){
          $scope.progressPercent = 100;
        }else{
         $scope.progressPercent = $scope.user.pontos.valueOf();
        }
        if($scope.progressPercentCriador.valueOf()>=10){
          $scope.progressPercentCriador = 100;
        }else{
          $scope.progressPercentCriador = $scope.progressPercentCriador.valueOf()*10;
        }
      }
      if($scope.user.direitoborda == 2){
        $scope.estrelaatualn = false; 
        $scope.estrelaatualb = false;
        $scope.estrelaatuals = true;
        $scope.estrelaatualg = false;
        $scope.estrelaproxb = false;
        $scope.estrelaproxs = false;
        $scope.estrelaproxg = true;
        $scope.estrelault =false;
        $scope.auxproxpontos = 200;
        $scope.auxproxcriados = 20;
        
        if(($scope.user.pontos.valueOf()/2) >= 200){
          $scope.progressPercent = 100;
        }else{
         $scope.progressPercent = 2+$scope.user.pontos.valueOf()/2;
        }
        if($scope.progressPercentCriador.valueOf()>=20){
          $scope.progressPercentCriador = 100;
        }else{
          console.log($scope.progressPercentCriador)
          $scope.progressPercentCriador = 2+$scope.progressPercentCriador.valueOf()*5;
        }
      }     // Muda layout da tela
      if($scope.user.direitoborda == 3){
        $scope.estrelaatualn = false; 
        $scope.estrelaatualb = false;
        $scope.estrelaatuals = false;
        $scope.estrelaatualg = false;
        $scope.estrelaproxb = false;
        $scope.estrelaproxs = false;
        $scope.estrelaproxg = false;
        $scope.estrelault =true;
      }
    });
  });


  $scope.compra = function(usuario){
    
    EventoService.GetCriadosacabados(usuario).then(function(criados) {
      $scope.criei = criados.length;
      console.log(criados.length, usuario.direitoborda,usuario.pontos)
      if(usuario.direitoborda == 0){
        if(criados.length<5){
          var alertPopup = $ionicPopup.alert({
              title: 'ᕙ( * •̀ ᗜ •́ * )ᕗ',
              template: 'Você precisa criar mais eventos para poder comprar'
            });
        }else{
          if(usuario.pontos<49){
            var alertPopup = $ionicPopup.alert({
                title: '(ノ￣ー￣)ノ ● ＼(^ω^＼)',
                template: 'Não tens pontos suficiente, tente ir em mais eventos ou crie ou avalie em eventos que você foi e não avaliou ninguem, uma pessoa basta'
              });
          }else{
            var po = usuario.pontos.valueOf() - 50;
            var myPopup = $ionicPopup.show({
                                title: 'Confirmação',
                                subTitle: 'Upar?',
                                scope: $scope,
                                buttons: [
                                  { text: 'Não' },
                                  {
                                    text: '<b>Sim</b>',
                                    type: 'button-positive',
                                    onTap: function(e) {
                                      $http.post('https://ec2.diwoapp.com.br/gastapontospessoaevento.php', {idevento : -10,
                                                        iduser : $scope.user.iduser,
                                                        borda : $scope.user.borda,
                                                        username: $scope.user.username,
                                                        apelido : $scope.user.apelido,
                                                        nomeevento :  "Comprou borda bronze", 
                                                        estado : 10,
                                                        pontos: -50});
                                      
                                      $http.post('https://ec2.diwoapp.com.br/compraestrela.php' , {iduser : usuario.iduser,
                                                                                direitoborda : 1,
                                                                                pontos: po}).then(function(result) {
                                        $state.reload();
                                        EventoService.AtualizaEstrelaPessoaevento();
                                        if (result.data.success == true){
                                          console.log(result.data.msg);
                                          $state.reload();
                                          } else {
                                          console.log(result.data.msg);
                                          }
                                        });
                                    }
                                  }
                                ]});
          }
        }
      }
      if(usuario.direitoborda == 1){
        if(criados.length<10){
          var alertPopup = $ionicPopup.alert({
              title: 'ᕙ( * •̀ ᗜ •́ * )ᕗ',
              template: 'Você precisa criar mais eventos para poder comprar'
            });
        }else{
          if(usuario.pontos<99){
            var alertPopup = $ionicPopup.alert({
                title: '(ノ￣ー￣)ノ ● ＼(^ω^＼)',
                template: 'Não tens pontos suficiente, tente ir em mais eventos ou crie ou avalie em eventos que você foi e não avaliou ninguem, uma pessoa basta'
              });
          }else{
            var po = usuario.pontos.valueOf()-100;
            console.log(po)
            var myPopup = $ionicPopup.show({
                                
                                title: 'Confirmação',
                                subTitle: 'Upar?',
                                scope: $scope,
                                buttons: [
                                  { text: 'Não' },
                                  {
                                    text: '<b>Sim</b>',
                                    type: 'button-positive',
                                    onTap: function(e) {
                                      $http.post('https://ec2.diwoapp.com.br/gastapontospessoaevento.php', {idevento : -20,
                                                        iduser : $scope.user.iduser,
                                                        borda : $scope.user.borda,
                                                        username: $scope.user.username,
                                                        apelido : $scope.user.apelido,
                                                        nomeevento :  "Comprou borda prata", 
                                                        estado : 10,
                                                        pontos: -100});
                                      $http.post('https://ec2.diwoapp.com.br/compraestrela.php' , {iduser : usuario.iduser,
                                                                                direitoborda : 2,
                                                                                pontos : po}).then(function(result) {
                                        $state.reload();
                                        EventoService.AtualizaEstrelaPessoaevento();
                                        if (result.data.success == true){
                                          console.log(result.data.msg);
                                          $state.reload();
                                          } else {
                                          console.log(result.data.msg);
                                          }
                                        });
                                    }
                                  }
                                ]});
          }
        }
      }
      if(usuario.direitoborda == 2){
        if(criados.length<20){
          var alertPopup = $ionicPopup.alert({
              title: 'ᕙ( * •̀ ᗜ •́ * )ᕗ',
              template: 'Você precisa criar mais eventos para poder comprar'
            });
        }else{
          if(usuario.pontos<199){
            var alertPopup = $ionicPopup.alert({
                title: '(ノ￣ー￣)ノ ● ＼(^ω^＼)',
                template: 'Não tens pontos suficiente, tente ir em mais eventos ou crie ou avalie em eventos que você foi e não avaliou ninguem, uma pessoa basta'
              });
          }else{
            var po = usuario.pontos.valueOf() - 200;
            var myPopup = $ionicPopup.show({
                                
                                title: 'Confirmação',
                                subTitle: 'Upar?',
                                scope: $scope,
                                buttons: [
                                  { text: 'Não' },
                                  {
                                    text: '<b>Sim</b>',
                                    type: 'button-positive',
                                    onTap: function(e) {
                                      $http.post('https://ec2.diwoapp.com.br/gastapontospessoaevento.php', {idevento : -30,
                                                        iduser : $scope.user.iduser,
                                                        borda : $scope.user.borda,
                                                        username: $scope.user.username,
                                                        apelido : $scope.user.apelido,
                                                        nomeevento :  "Comprou borda OURO", 
                                                        estado : 10,
                                                        pontos: -200});
                                      $http.post('https://ec2.diwoapp.com.br/compraestrela.php' , {iduser : usuario.iduser,
                                                                                direitoborda : 3,
                                                                                pontos : po}).then(function(result) {
                                        $state.reload();
                                        EventoService.AtualizaEstrelaPessoaevento();
                                        if (result.data.success == true){
                                          console.log(result.data.msg);
                                          
                                          } else {
                                          console.log(result.data.msg);
                                          }
                                        });
                                    }
                                  }
                                ]});
          }
        }
      }

    });
  }

}])

.controller('infoestrelaCtrl', ['$scope', '$stateParams', 'formItem', 'EventoService', 'formUser','$state', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, formItem, EventoService, formUser,$state) {

}])


.controller('perfilFollowCtrl', ['$scope', '$stateParams', 'formOutro', 'formItem', 'EventoService','$http', '$timeout', '$ionicPopup', 'formUser', 'formStalker','$state',  // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, formOutro, formItem, EventoService,$http, $timeout, $ionicPopup, formUser, formStalker, $state) {

   $scope.estadobutton = 0; 
    $scope.stalkeada = {};
    $scope.neventos= 0;
    $scope.neventosnao= 0;
    $scope.p =0;
    $scope.outro = formOutro.getForm();
    $scope.user = formUser.getForm();
    $scope.stalkeada = $scope.outro;
    $scope.followbutton = false;
    $scope.desseguirbutton = false;
    $scope.CoisasCriado = true;
    $scope.CoisasFinalizado = false;
    $scope.auxusers = {};
    $scope.frase = {};
    var auxbloqueado = 0;
    var noti = {};
    $scope.qvou = true;
    $scope.infosstalkeada ={};
    var header = document.getElementById("barperfiloutroev");
    var btns = header.getElementsByClassName("btnperfilotro");
    for (var i = 0; i < btns.length; i++) {
      btns[i].addEventListener("click", function() {
        var current = document.getElementsByClassName("actpf");
        current[0].className = current[0].className.replace(" actpf", "");
        this.className += " actpf";
      });
    }


    EventoService.GetStalkear($scope.stalkeada.iduser).then(function(stalker) {
        $scope.infosstalkeada = stalker;
          if(($scope.infosstalkeada.profilepic[8] == 's' && $scope.infosstalkeada.profilepic[9] == '3')||($scope.infosstalkeada.profilepic[8] == 'd' && $scope.infosstalkeada.profilepic[9] == 'i')){
          
         //if($scope.infosstalkeada.profilepic[8] == 's' && $scope.infosstalkeada.profilepic[9] == '3'){
             document.getElementById("imageidperfilFollow").src=$scope.infosstalkeada.profilepic+"?{{getTimeStamp()}}";
           }else{
             document.getElementById("imageidperfilFollow").src=$scope.infosstalkeada.profilepic;
           }
            if(!$scope.infosstalkeada.numcodigo || $scope.infosstalkeada.numcodigo == 'null'){
            $scope.temcodigo = false;
          }else{
            $scope.temcodigo = true;
            if($scope.infosstalkeada.numcodigo == '0'){
              document.getElementById("badgeimg_pf").src="img/egg_0.png";
            }
            if($scope.infosstalkeada.numcodigo == '1'){
              document.getElementById("badgeimg_pf").src="img/egg_1.png";
            }
            if($scope.infosstalkeada.numcodigo == '2'){
              document.getElementById("badgeimg_pf").src="img/egg_2.png";
            }
            if(parseInt($scope.infosstalkeada.numcodigo) >= 3){
              document.getElementById("badgeimg_pf").src="img/egg_3.png";
            }
            if(parseInt($scope.infosstalkeada.numcodigo) < 0){
              document.getElementById("badgeimg_pf").src="img/egg_3.png";
            }
          }
        //document.getElementById("imageidperfilFollow").src=$scope.infosstalkeada.profilepic+"?{{getTimeStamp()}}";
        $scope.frase = stalker.frase;
         if(stalker.borda == 0){
          $scope.estrelabb = false;
          $scope.estrelabs = false;
          $scope.estrelabg = false;
        }
        if(stalker.borda == 1){
          $scope.estrelabb = true;
          $scope.estrelabs = false;
          $scope.estrelabg = false;
        }
        if(stalker.borda == 2){
          $scope.estrelabb = false;
          $scope.estrelabs = true;
          $scope.estrelabg = false;
        }
        if(stalker.borda == 3){
          $scope.estrelabb = false;
          $scope.estrelabs = false;
          $scope.estrelabg = true;
        }
        
        if($scope.infosstalkeada.idade){
          $scope.infosstalkeada.idade = ", "+ $scope.infosstalkeada.idade +" anos";
        }else{
           $scope.infosstalkeada.idade ='';
        }
    });
    

    EventoService.GetPontos($scope.stalkeada.iduser).then(function(items) {
        $scope.p = items;
        $scope.labels3 = ["Pontos"];
        $scope.colores3 = ["#ff4d4d"];
        $scope.data3 = [$scope.p];
      });
      EventoService.getIC($scope.stalkeada).then(function(items) {
        if(items){
          $scope.ic = items;
          $scope.options2 = {title: {
                      display: true,
                      text: 'Indice de confirmação',
                      position: 'bottom'
                  }
           }
          $scope.labels2 = ["Fui", "Não fui"];
          $scope.colores2 = ["#99FF99","#ff4d4d"];
          var menos = (100-$scope.ic.total).toFixed(1);
          var mais = $scope.ic.total;
          $scope.data2 = [mais, menos ];
        }
       
      });

      EventoService.GetComments3($scope.stalkeada).then(function(items) {
        
          $scope.options1 = {title: {
                    display: true,
                    text: 'Avaliações',
                    position: 'bottom'
                }
         }
          $scope.labels1 = ["Extrovertido", "Introvertido", "Realista","Curioso", "Solidário", "Racional","Organizado", "Criativo"];
          $scope.colores1 = ["#fff200", "#02fff2", "#ff9d00","#1867ce", "#e50be1", "#0e8c28","#ef370e", "#af0eef"];
          $scope.data1 =items.chart;
        
      }); 


    $scope.$on("$ionicView.enter", function(event, data){
    
    $scope.followbutton = false;
    $scope.desseguirbutton = false; 
    $scope.items = [];
    $scope.vezes = 0;
    $scope.newItems = [];
    $scope.noMoreItemsAvailable = false;
    $scope.lastidevento = 0;
    $scope.aux2 = 0;
    $scope.outro = formOutro.getForm();
    $scope.infosstalkeada ={};
    $scope.frase = {};

    auxbloqueado = 0;

    if($scope.outro.iduser == $scope.user.iduser){
       $scope.followbutton = false;
       $scope.desseguirbutton = false;
       $scope.reportbutton = false;
       $scope.qvou = true;
    }else{
      $scope.reportbutton = true;
    }
    
    
    
    
    EventoService.GetStalkear($scope.stalkeada.iduser).then(function(stalker) {
        $scope.infosstalkeada = stalker;
        //if($scope.infosstalkeada.profilepic[8] == 's' && $scope.infosstalkeada.profilepic[9] == '3'){
          if(($scope.infosstalkeada.profilepic[8] == 's' && $scope.infosstalkeada.profilepic[9] == '3')||($scope.infosstalkeada.profilepic[8] == 'd' && $scope.infosstalkeada.profilepic[9] == 'i')){
             document.getElementById("imageidperfilFollow").src=$scope.infosstalkeada.profilepic+"?{{getTimeStamp()}}";
           }else{
             document.getElementById("imageidperfilFollow").src=$scope.infosstalkeada.profilepic;
           }
            if(!$scope.infosstalkeada.numcodigo || $scope.infosstalkeada.numcodigo == 'null'){
            $scope.temcodigo = false;
          }else{
            $scope.temcodigo = true;
            if($scope.infosstalkeada.numcodigo == '0'){
              document.getElementById("badgeimg_pf").src="img/egg_0.png";
            }
            if($scope.infosstalkeada.numcodigo == '1'){
              document.getElementById("badgeimg_pf").src="img/egg_1.png";
            }
            if($scope.infosstalkeada.numcodigo == '2'){
              document.getElementById("badgeimg_pf").src="img/egg_2.png";
            }
            if(parseInt($scope.infosstalkeada.numcodigo) >= 3){
              document.getElementById("badgeimg_pf").src="img/egg_3.png";
            }
            if(parseInt($scope.infosstalkeada.numcodigo) < 0 ){
              document.getElementById("badgeimg_pf").src="img/egg_3.png";
            }
          }
        $scope.frase = stalker.frase;
         if(stalker.borda == 0){
          $scope.estrelabb = false;
          $scope.estrelabs = false;
          $scope.estrelabg = false;
        }
        if(stalker.borda == 1){
          $scope.estrelabb = true;
          $scope.estrelabs = false;
          $scope.estrelabg = false;
        }
        if(stalker.borda == 2){
          $scope.estrelabb = false;
          $scope.estrelabs = true;
          $scope.estrelabg = false;
        }
        if(stalker.borda == 3){
          $scope.estrelabb = false;
          $scope.estrelabs = false;
          $scope.estrelabg = true;
        }
        if($scope.infosstalkeada.idade){
          $scope.infosstalkeada.idade = ", "+ $scope.infosstalkeada.idade +" anos";
        }else{
           $scope.infosstalkeada.idade ='';
        }
    });
      
    EventoService.GetPontos($scope.stalkeada.iduser).then(function(items) {
      $scope.p = items;
      $scope.labels3 = ["Pontos"];
      $scope.colores3 = ["#ff4d4d"];
      $scope.data3 = [$scope.p];
    });
    
    EventoService.getIC($scope.stalkeada).then(function(items) {
      if(items){
        $scope.ic = items;
        $scope.options2 = {title: {
                    display: true,
                    text: 'Indice de confirmação',
                    position: 'bottom'
                }
         }
        $scope.labels2 = ["Fui", "Não fui"];
        $scope.colores2 = ["#99FF99","#ff4d4d"];
        var menos = (100-$scope.ic.total).toFixed(1);
        var mais = $scope.ic.total;
        $scope.data2 = [mais, menos ];
      }
    });

    EventoService.GetComments3($scope.stalkeada).then(function(items) {
      
        $scope.options1 = {title: {
                  display: true,
                  text: 'Avaliações',
                  position: 'bottom'
              }
       }
        $scope.labels1 = ["Extrovertido", "Introvertido", "Realista","Curioso", "Solidário", "Racional","Organizado", "Criativo"];
        $scope.colores1 = ["#fff200", "#02fff2", "#ff9d00","#1867ce", "#e50be1", "#0e8c28","#ef370e", "#af0eef"];
        $scope.data1 =items.chart;
    }); 

    EventoService.GetCriados($scope.stalkeada).then(function(items) {
      if(items=='E'){
        $scope.items = [];
      }else{
        for (var i = 0; i < items.length; i++) {
            var curr_date = (items[i].diainicio[8]+items[i].diainicio[9]);
            var h2 = (items[i].diainicio[11]+items[i].diainicio[12]);
            var m2 = (items[i].diainicio[14]+items[i].diainicio[15]);
            var curr_month = (items[i].diainicio[5]+items[i].diainicio[6]);
            var curr_year = (items[i].diainicio[0]+items[i].diainicio[1]+items[i].diainicio[2]+items[i].diainicio[3]);
            var j = curr_date + "/" + curr_month + "/" + curr_year+ ' '+h2 + ':' + m2;
            items[i].datainicio = j;
            if(items[i].estado == 0){
              items[i].confirmacao = "Vai acontecer"
            }
            if(items[i].estado == 1){
              items[i].confirmacao = "Finalizado"
            }
            if(items[i].estado == 2){
              items[i].confirmacao = "Standy by, talvez aconteça"
            }
            if(items[i].estado == 3){
              items[i].confirmacao = "Vai acontecer"
            }
            if(items[i].estado == 4){
              items[i].confirmacao = "Cancelado"
            }
            if(items[i].estado == 5){
              items[i].confirmacao = "Acabado"
            }
            if(items[i].estado == 6){
              items[i].confirmacao = "Escondido"
            }
        }
      $scope.items = items;
      $scope.lastidvestido = $scope.items[0].idevento;
      }
    });

    $scope.auxusers.outro =  $scope.outro.iduser;
    $scope.auxusers.eu =  $scope.user.iduser;
    console.log($scope.auxusers.eu, $scope.auxusers.outro)
    EventoService.possoseguir($scope.auxusers).then(function(items) {
      console.log(items, 'dentro do perfil follow')
        if(items){
          console.log($scope.outro,$scope.user.iduser)
          $http.post('https://ec2.diwoapp.com.br/getfollow.php', {iduserseguindo : $scope.outro.iduser, 
                          iduserseguidor : $scope.user.iduser}).then(function(res) {
                            console.log( 'oi' , res.data[0].bloqueado );
                            if(res.data[0]!='E'){
                              if (res.data[0].bloqueado==0){ 
                              $scope.desseguirbutton = true;
                              $scope.followbutton = false;
                              auxbloqueado = 1;
                              $scope.qvou = true;
                              console.log('ja sigo este cara');
                              }
                              if(res.data[0].bloqueado==2){
                              console.log('nao sigo este cara');
                              $scope.desseguirbutton = false;
                              $scope.followbutton = true;
                              auxbloqueado = 1;
                              $scope.qvou = false;
                              }
                              if(res.data[0].bloqueado==1){
                              console.log('tais bloqueado');
                              $scope.desseguirbutton = false;
                              $scope.followbutton = false;
                              auxbloqueado = 3;
                              $scope.items = [];
                              $scope.qvou = false;
                              }
                              if($scope.outro == $scope.user.iduser){
                                 $scope.followbutton = false;
                                 $scope.desseguirbutton = false;
                                 $scope.reportbutton = false;
                                 $scope.qvou = true;
                              }
                            }else{
                               $scope.followbutton = true;
                                auxbloqueado = 2;
                                $scope.qvou = false;
                            }
                             if($scope.outro == $scope.user.iduser){
                                 $scope.followbutton = false;
                                 $scope.desseguirbutton = false;
                                 $scope.reportbutton = false;
                                 $scope.qvou = true;
                              }
                          });
        }else{
          if($scope.outro.iduser == $scope.user.iduser){
            $scope.followbutton = false;
            $scope.desseguirbutton = false;
            $scope.reportbutton = false;
            $scope.qvou = true;
          }else{
            $scope.desseguirbutton = true;
            $scope.qvou = false;
          }
        }
      });  
         
              
    });

    $scope.seguir = function(){
      noti.recebe = $scope.outro.iduser;
      noti.envia = $scope.user.iduser;
      noti.tipo = 11;
      EventoService.VerificaNotificacao(noti).then(function(res) {
        console.log(res);
        if(res){
          var msgnoti ='Nova pessoa esta t stalkeando';
          var link = 'https://ec2.diwoapp.com.br/notificapessoa.php';
            $http.post(link, {notificacao :msgnoti, 
                                idevento : $scope.user.iduser,
                                nomeevento : 'follow',
                                id_user_envia : $scope.user.iduser,
                                username_envia : $scope.user.username,
                                apelido_envia : $scope.user.apelido,
                                tipo : '11',
                                id_user_recebe : $scope.outro.iduser});
        }
      });
      if(auxbloqueado == 2){
        var link = 'https://ec2.diwoapp.com.br/seguepessoa.php';
            $http.post(link, {iduserseguindo : $scope.outro.iduser, 
                          usernameseguindo : $scope.stalkeada.username,
                          iduserseguidor : $scope.user.iduser,
                          apelidoseguindo : $scope.infosstalkeada.apelido,
                          apelidoseguidor : $scope.user.apelido,
                          profilepicseguindo : $scope.infosstalkeada.profilepic,
                          profilepicseguidor : $scope.user.profilepic,
                          devicetokenseguidor : $scope.user.devicetoken,
                          usernameseguidor : $scope.user.username}).then(function(res) {
                          console.log(res.success);
                                var alertPopup = $ionicPopup.alert({
                                                            title: '(*•̀ᴗ•́*)و ̑̑',
                                                            template: 'Pessoa adicionada as pessoas de interesse'
                                                          }); 
                                
                            
                            $scope.desseguirbutton = true;
                            $scope.followbutton = false;
                          });
      }else{
         var link = 'https://ec2.diwoapp.com.br/refollow.php'; // estado "Bloqueado"  = 2;
            $http.post(link, {iduserseguindo : $scope.outro.iduser, 
                          iduserseguidor : $scope.user.iduser}).then(function(res) {
                            
                                var alertPopup = $ionicPopup.alert({
                                                            title: '(￣▽￣)ノ',
                                                            template: 'Pessoa adicionada as pessoas de interesse'
                                                          }); 
                                $scope.desseguirbutton = true;
                                $scope.followbutton = false;
                            
                          });
      }
    }

    $scope.desseguir = function(){
      auxbloqueado = 0;
        var link = 'https://ec2.diwoapp.com.br/desfollow.php'; // estado "Bloqueado"  = 2;
            $http.post(link, {iduserseguindo : $scope.outro.iduser, 
                          iduserseguidor : $scope.user.iduser}).then(function(res) {
                            
                                var alertPopup = $ionicPopup.alert({
                                                            title: '(*꒦ິ⌓꒦ີ)',
                                                            template: 'Não segues mais esta pessoa'
                                                          }); 
                                $scope.desseguirbutton = false;
                                $scope.followbutton = true;
                            
                          });
    }

    $scope.entrabadges = function(){
      $state.go('tabsController.badgesPerfilFollow');
    }

    $scope.comentario = function(){
        formStalker.updateForm($scope.stalkeada);
        if(auxbloqueado!=3){
          $state.go('tabsController.comentariosdosoutrosnoperfil');
        }
    }

    $scope.loadCriados = function() {
      $scope.CoisasCriado = true;
      $scope.CoisasFinalizado = false;
      if(auxbloqueado!=3){
        $scope.estadobutton = 0;
        $scope.items = [];
        EventoService.GetCriados($scope.stalkeada).then(function(items) {
          if(items=='E'){
          $scope.items = [];
        }else{
          for (var i = 0; i < items.length; i++) {
                var curr_date = (items[i].diainicio[8]+items[i].diainicio[9]);
                var h2 = (items[i].diainicio[11]+items[i].diainicio[12]);
                var m2 = (items[i].diainicio[14]+items[i].diainicio[15]);
                var curr_month = (items[i].diainicio[5]+items[i].diainicio[6]);
                var curr_year = (items[i].diainicio[0]+items[i].diainicio[1]+items[i].diainicio[2]+items[i].diainicio[3]);
                var j = curr_date + "/" + curr_month + "/" + curr_year+ ' '+h2 + ':' + m2;
                items[i].datainicio = j;
                if(items[i].estado == 0){
                  items[i].confirmacao = "Vai acontecer"
                }
                if(items[i].estado == 1){
                  items[i].confirmacao = "Finalizado"
                }
                if(items[i].estado == 2){
                  items[i].confirmacao = "Standy by, talvez aconteça"
                }
                if(items[i].estado == 3){
                  items[i].confirmacao = "Vai acontecer"
                }
                if(items[i].estado == 4){
                  items[i].confirmacao = "Cancelado"
                }
                if(items[i].estado == 5){
                  items[i].confirmacao = "Acabado"
                }
                if(items[i].estado == 6){
                  items[i].confirmacao = "Escondido"
                }
            }
          $scope.items = items;
          $scope.lastidvestido = $scope.items[0].idevento;
        }
        });
      }
    }

    $scope.loadAbertos = function() {
      $scope.CoisasCriado = false;
      $scope.CoisasFinalizado = true;
      if(auxbloqueado!=3){
        $scope.estadobutton = 1;
        $scope.items = [];
        EventoService.GetAbertos($scope.stalkeada.iduser).then(function(items) {  //mudar
          if(items == 'E'){
            $scope.items = [];
          }else{
            for (var i = 0; i < items.length; i++) {
                var curr_date = (items[i].diainicio[8]+items[i].diainicio[9]);
                var h2 = (items[i].diainicio[11]+items[i].diainicio[12]);
                var m2 = (items[i].diainicio[14]+items[i].diainicio[15]);
                var curr_month = (items[i].diainicio[5]+items[i].diainicio[6]);
                var curr_year = (items[i].diainicio[0]+items[i].diainicio[1]+items[i].diainicio[2]+items[i].diainicio[3]);
                var j = curr_date + "/" + curr_month + "/" + curr_year+ ' '+h2 + ':' + m2;
                items[i].datainicio = j;
            }
            $scope.items = items;
            $scope.lastidvestido = $scope.items[0].idevento;
          }
        });
      }
    }

    $scope.loadFechados = function() {
      $scope.CoisasCriado = false;
      $scope.CoisasFinalizado = true;
      if(auxbloqueado!=3){
        $scope.estadobutton = 2;
        $scope.items = [];
        //console.log($scope.user.iduser);
        EventoService.GetFinalizadosPerfil($scope.stalkeada.iduser).then(function(items) {         //mudar
          if(items=='E'){
            $scope.items = [];
          }else{
            for (var i = 0; i < items.length; i++) {
                var curr_date = (items[i].diainicio[8]+items[i].diainicio[9]);
                var h2 = (items[i].diainicio[11]+items[i].diainicio[12]);
                var m2 = (items[i].diainicio[14]+items[i].diainicio[15]);
                var curr_month = (items[i].diainicio[5]+items[i].diainicio[6]);
                var curr_year = (items[i].diainicio[0]+items[i].diainicio[1]+items[i].diainicio[2]+items[i].diainicio[3]);
                var j = curr_date + "/" + curr_month + "/" + curr_year+ ' '+h2 + ':' + m2;
                items[i].datainicio = j;
            }
            $scope.items = items;
            $scope.lastidvestido = $scope.items[0].idevento;
          }
        });
      }   
    }

    $scope.loadMore = function() {
      if ($scope.estadobutton == 0 && auxbloqueado!=3) {
        EventoService.GetOldEventosCriados().then(function(items) {
        $scope.items = $scope.items.concat(items);
        $scope.$broadcast('scroll.infiniteScrollComplete');
          // an empty array indicates that there are no more items
          if (items.length <= 4) {
            $scope.noMoreItemsAvailable = true;
          }

        });
       

      }
      if ($scope.estadobutton == 1 && auxbloqueado!=3) {
        EventoService.GetOldEventosCriados().then(function(items) {
        $scope.items = $scope.items.concat(items);
        $scope.$broadcast('scroll.infiniteScrollComplete');
          // an empty array indicates that there are no more items
          if (items.length <= 4) {
            $scope.noMoreItemsAvailable = true;
          }
        });

        
      }
      if ($scope.estadobutton == 2 && auxbloqueado!=3) {
        EventoService.GetOldEventosCriados().then(function(items) {
        $scope.items = $scope.items.concat(items);
        $scope.$broadcast('scroll.infiniteScrollComplete');
          // an empty array indicates that there are no more items
          if (items.length <= 4) {
            $scope.noMoreItemsAvailable = true;
          }
        });

      
      }
    }

    $scope.reportar = function(){
      $scope.reportmsg = '';
      console.log($scope.stalkeada.username);
        $scope.report = [
      { text: "Nome impróprio", checked: false },
      { text: "Comportamento inadequado", checked: false, style:"text-align: center;overflow: hidden;text-overflow: none !important; white-space: initial !important;" },
      { text: "Foto inapropriada", checked: false },
      { text: "É um impostor", checked: false }
     ];
        $ionicPopup.confirm({
          title: 'Você quer reportar essa pessoa pq?',
          content: '<ion-checkbox ng-repeat="item in report" style="color: #FCFCFC;" ng-model="item.checked" ng-checked="item.checked">{{item.text}}</ion-checkbox>',
          scope: $scope
        })
        .then(function(res) {
          if(res) {
            for (var h=0;h<3;h++){
              //console.log($scope.report[h].checked , h);
              if($scope.report[h].checked){
                $scope.reportmsg = $scope.reportmsg + $scope.report[h].text + ' ';
                //console.log($scope.reportmsg);
              }
            }

            if(h==3){
              console.log($scope.reportmsg);
               $http.post('https://ec2.diwoapp.com.br/reportaevento.php', {namereportado : $scope.stalkeada.username,
                                                                              reportadoid : $scope.stalkeada.iduser,
                                                                              iduserreportando : $scope.user.iduser,
                                                                              usernamereportando : $scope.user.username,
                                                                              tiporeport : 'usuario',
                                                                              motivo : $scope.reportmsg}).then(function (tes){
                                 $scope.response = tes.data;
                                  var alertPopup = $ionicPopup.alert({
                                                          title: 'Obrigado',
                                                          template: 'Esta pessoa esta agora sobre investigação, obrigado por manter a plataforma segura'
                                                        });

                               });
            }
            
          }
        });
    }

    // $scope.enterItem =  function(item){
    //   formItem.updateForm(item);
    //   console.log(item.idevento);
    // }

}])

.controller('badgesPerfilFollowCtrl', ['$scope', '$stateParams', 'formOutro', 'EventoService','$ionicPopup', '$timeout','$state', '$cordovaCamera', '$cordovaFile', '$cordovaFileTransfer', '$ionicLoading','formBadge', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, formOutro, EventoService, $ionicPopup, $timeout, $state, $cordovaCamera, $cordovaFile, $cordovaFileTransfer, $ionicLoading, formBadge) {


  $scope.user = formOutro.getForm();
  $scope.aux = {};
  $scope.aux.iduser = $scope.user.iduser;


  $scope.aux.tag = "#ArteeCultura";
  $scope.auxnbadgeArteeCultura = 0;
  $scope.proximoArteeCultura = 0;
  $scope.proximoimgArteeCultura = '';
  $scope.anteriorimgArteeCultura = '';
  EventoService.getbadges($scope.aux).then(function(badges){
    console.log("badges", badges);
    if(badges!="Error" && badges !="E"){
      $scope.auxnbadgeArteeCultura = badges.length;
      if(badges.length == 0){
        $scope.anteriorimgArteeCultura = 'img/badges/Categorias/ArteeCultura/0.png';
        $scope.proximoArteeCultura = 1;
        $scope.proximoimgArteeCultura = 'img/badges/Categorias/ArteeCultura/1.png';

        document.getElementById("ArteeCultura").src="img/badges/Categorias/ArteeCultura/0.png"
      }
      if(badges.length == 1){
        $scope.anteriorimgArteeCultura = 'img/badges/Categorias/ArteeCultura/0.png';
        $scope.proximoArteeCultura = 2;
        $scope.proximoimgArteeCultura = 'img/badges/Categorias/ArteeCultura/1.1.png';
        document.getElementById("ArteeCultura").src="img/badges/Categorias/ArteeCultura/1.png"
      }
      if(badges.length == 2){
        $scope.anteriorimgArteeCultura = 'img/badges/Categorias/ArteeCultura/1.png';
        $scope.proximoArteeCultura = 3;
        $scope.proximoimgArteeCultura = 'img/badges/Categorias/ArteeCultura/1.2.png';
        document.getElementById("ArteeCultura").src="img/badges/Categorias/ArteeCultura/1.1.png"
      }
      if(badges.length == 3){
        $scope.anteriorimgArteeCultura = 'img/badges/Categorias/ArteeCultura/1.1.png';
        $scope.proximoArteeCultura = 4;
        $scope.proximoimgArteeCultura = 'img/badges/Categorias/ArteeCultura/1.3.png';
        document.getElementById("ArteeCultura").src="img/badges/Categorias/ArteeCultura/1.2.png"
      }
      if(badges.length == 4 || badges.length == 5){
        $scope.anteriorimgArteeCultura = 'img/badges/Categorias/ArteeCultura/1.2.pn';
        $scope.proximoArteeCultura = 6;
        $scope.proximoimgArteeCultura = 'img/badges/Categorias/ArteeCultura/2.png';
        document.getElementById("ArteeCultura").src="img/badges/Categorias/ArteeCultura/1.3.png"
      }

      if(badges.length == 6 || badges.length == 7){
        $scope.anteriorimgArteeCultura = 'img/badges/Categorias/ArteeCultura/1.3.png';
        $scope.proximoArteeCultura = 8;
        $scope.proximoimgArteeCultura = 'img/badges/Categorias/ArteeCultura/2.1.png';
        document.getElementById("ArteeCultura").src="img/badges/Categorias/ArteeCultura/2.png"
      }
      if(badges.length == 8 || badges.length == 9){
        $scope.anteriorimgArteeCultura = 'img/badges/Categorias/ArteeCultura/2.png';
        $scope.proximoArteeCultura = 10;
        $scope.proximoimgArteeCultura = 'img/badges/Categorias/ArteeCultura/2.2.png';
        document.getElementById("ArteeCultura").src="img/badges/Categorias/ArteeCultura/2.1.png"
      }
      if(badges.length == 10 || badges.length == 11){
        $scope.anteriorimgArteeCultura = 'img/badges/Categorias/ArteeCultura/2.1.png';
        $scope.proximoArteeCultura = 12;
        $scope.proximoimgArteeCultura = 'img/badges/Categorias/ArteeCultura/2.3.png';
        document.getElementById("ArteeCultura").src="img/badges/Categorias/ArteeCultura/2.2.png"
      }
      if(badges.length == 12 || badges.length == 13 || badges.length == 14){
        $scope.anteriorimgArteeCultura = 'img/badges/Categorias/ArteeCultura/2.2.png';
        $scope.proximoArteeCultura = 15;
        $scope.proximoimgArteeCultura = 'img/badges/Categorias/ArteeCultura/3.png';
        document.getElementById("ArteeCultura").src="img/badges/Categorias/ArteeCultura/2.3.png"
      }

      if(badges.length >= 15 && badges.length < 20 ){
        $scope.anteriorimgArteeCultura = 'img/badges/Categorias/ArteeCultura/2.3.png';
        $scope.proximoArteeCultura = 20;
        $scope.proximoimgArteeCultura = 'img/badges/Categorias/ArteeCultura/3.1.png';
        document.getElementById("ArteeCultura").src="img/badges/Categorias/ArteeCultura/3.png"
      }
      if(badges.length >= 20 && badges.length < 22 ){
        $scope.anteriorimgArteeCultura = 'img/badges/Categorias/ArteeCultura/3.png';
        $scope.proximoArteeCultura = 25;
        $scope.proximoimgArteeCultura = 'img/badges/Categorias/ArteeCultura/3.2.png';
        document.getElementById("ArteeCultura").src="img/badges/Categorias/ArteeCultura/3.1.png"
      }
      if(badges.length >= 25 && badges.length < 30 ){
        $scope.anteriorimgArteeCultura = 'img/badges/Categorias/ArteeCultura/3.1.png';
        $scope.proximoArteeCultura = 30;
        $scope.proximoimgArteeCultura = 'img/badges/Categorias/ArteeCultura/3.3.png';
        document.getElementById("ArteeCultura").src="img/badges/Categorias/ArteeCultura/3.2.png"
      }
      if(badges.length >= 30 && badges.length < 50 ){
        $scope.anteriorimgArteeCultura = 'img/badges/Categorias/ArteeCultura/3.2.png';
        $scope.proximoArteeCultura = 50;
        $scope.proximoimgArteeCultura = 'img/badges/Categorias/ArteeCultura/Super.png';
        document.getElementById("ArteeCultura").src="img/badges/Categorias/ArteeCultura/3.3.png"
      }

      if(badges.length >= 50){

        $scope.anteriorimgArteeCultura = 'img/badges/Categorias/ArteeCultura/3.3.png';
        $scope.proximoArteeCultura = 10000;
        $scope.proximoimgArteeCultura = 'img/badges/Categorias/ArteeCultura/Super.png';
        document.getElementById("ArteeCultura").src="img/badges/Categorias/ArteeCultura/Super.png"
      }

    }else{
      $scope.auxnbadgeArteeCultura = 0;
      $scope.anteriorimgArteeCultura = 'img/badges/Categorias/ArteeCultura/0.png';
        $scope.proximoArteeCultura = 1;
        $scope.proximoimgArteeCultura = 'img/badges/Categorias/ArteeCultura/1.png';
      document.getElementById("ArteeCultura").src="img/badges/Categorias/ArteeCultura/0.png"
    }
  });

  $scope.aux.tag = "#Ciclismo";
  $scope.auxnbadgeCiclismo = 0;
  $scope.proximoCiclismo = 0;
  $scope.proximoimgCiclismo = '';
  $scope.anteriorimgCiclismo = '';
  EventoService.getbadges($scope.aux).then(function(badges){
    console.log("badges", badges);
    if(badges!="Error" && badges !="E"){
      $scope.auxnbadgeCiclismo = badges.length;
      if(badges.length == 0){
        $scope.anteriorimgCiclismoa = 'img/badges/Categorias/Ciclismo/0.png';
        $scope.proximoCiclismo = 1;
        $scope.proximoimgCiclismo = 'img/badges/Categorias/Ciclismo/1.png';
        document.getElementById("Ciclismo").src="img/badges/Categorias/Ciclismo/0.png"
      }
      if(badges.length == 1){
        $scope.anteriorimgCiclismoa = 'img/badges/Categorias/Ciclismo/0.png';
        $scope.proximoCiclismo = 2;
        $scope.proximoimgCiclismo = 'img/badges/Categorias/Ciclismo/1.1.png';
        document.getElementById("Ciclismo").src="img/badges/Categorias/Ciclismo/1.png"
      }
      if(badges.length == 2){
        $scope.anteriorimgCiclismoa = 'img/badges/Categorias/Ciclismo/1.png';
        $scope.proximoCiclismo = 3;
        $scope.proximoimgCiclismo = 'img/badges/Categorias/Ciclismo/1.2.png';
        document.getElementById("Ciclismo").src="img/badges/Categorias/Ciclismo/1.1.png"
      }
      if(badges.length == 3){
        $scope.anteriorimgCiclismoa = 'img/badges/Categorias/Ciclismo/1.1.png';
        $scope.proximoCiclismo = 4;
        $scope.proximoimgCiclismo = 'img/badges/Categorias/Ciclismo/1.3.png';
        document.getElementById("Ciclismo").src="img/badges/Categorias/Ciclismo/1.2.png"
      }
      if(badges.length == 4 || badges.length == 5){
        $scope.anteriorimgCiclismoa = 'img/badges/Categorias/Ciclismo/1.2.png';
        $scope.proximoCiclismo = 6;
        $scope.proximoimgCiclismo = 'img/badges/Categorias/Ciclismo/2.png';
        document.getElementById("Ciclismo").src="img/badges/Categorias/Ciclismo/1.3.png"
      }

      if(badges.length == 6 || badges.length == 7){
        $scope.anteriorimgCiclismoa = 'img/badges/Categorias/Ciclismo/1.3.png';
        $scope.proximoCiclismo = 8;
        $scope.proximoimgCiclismo = 'img/badges/Categorias/Ciclismo/2.1.png';
        document.getElementById("Ciclismo").src="img/badges/Categorias/Ciclismo/2.png"
      }
      if(badges.length == 8 || badges.length == 9){
        $scope.anteriorimgCiclismoa = 'img/badges/Categorias/Ciclismo/2.png';
        $scope.proximoCiclismo = 10;
        $scope.proximoimgCiclismo = 'img/badges/Categorias/Ciclismo/2.2.png';
        document.getElementById("Ciclismo").src="img/badges/Categorias/Ciclismo/2.1.png"
      }
      if(badges.length == 10 || badges.length == 11){
        $scope.anteriorimgCiclismoa = 'img/badges/Categorias/Ciclismo/2.1.png';
        $scope.proximoCiclismo = 12;
        $scope.proximoimgCiclismo = 'img/badges/Categorias/Ciclismo/2.3.png';
        document.getElementById("Ciclismo").src="img/badges/Categorias/Ciclismo/2.2.png"
      }
      if(badges.length == 12 || badges.length == 13 || badges.length == 14){
        $scope.anteriorimgCiclismoa = 'img/badges/Categorias/Ciclismo/2.2.png';
        $scope.proximoCiclismo = 15;
        $scope.proximoimgCiclismo = 'img/badges/Categorias/Ciclismo/3.png';
        document.getElementById("Ciclismo").src="img/badges/Categorias/Ciclismo/2.3.png"
      }

      if(badges.length >= 15 && badges.length < 20 ){
        $scope.anteriorimgCiclismoa = 'img/badges/Categorias/Ciclismo/2.3.png';
        $scope.proximoCiclismo = 20;
        $scope.proximoimgCiclismo = 'img/badges/Categorias/Ciclismo/3.1.png';
        document.getElementById("Ciclismo").src="img/badges/Categorias/Ciclismo/3.png"
      }
      if(badges.length >= 20 && badges.length < 22 ){
        $scope.anteriorimgCiclismoa = 'img/badges/Categorias/Ciclismo/3.png';
        $scope.proximoCiclismo = 25;
        $scope.proximoimgCiclismo = 'img/badges/Categorias/Ciclismo/3.2.png';
        document.getElementById("Ciclismo").src="img/badges/Categorias/Ciclismo/3.1.png"
      }
      if(badges.length >= 25 && badges.length < 30 ){
        $scope.anteriorimgCiclismoa = 'img/badges/Categorias/Ciclismo/3.1.png';
        $scope.proximoCiclismo = 30;
        $scope.proximoimgCiclismo = 'img/badges/Categorias/Ciclismo/3.3.png';
        document.getElementById("Ciclismo").src="img/badges/Categorias/Ciclismo/3.2.png"
      }
      if(badges.length >= 30 && badges.length < 50 ){
        $scope.anteriorimgCiclismoa = 'img/badges/Categorias/Ciclismo/3.2.png';
        $scope.proximoCiclismo = 50;
        $scope.proximoimgCiclismo = 'img/badges/Categorias/Ciclismo/Super.png';
        document.getElementById("Ciclismo").src="img/badges/Categorias/Ciclismo/3.3.png"
      }

      if(badges.length >= 50){

        $scope.anteriorimgCiclismoa = 'img/badges/Categorias/Ciclismo/3.3.png';
        $scope.proximoCiclismo = 10000;
        $scope.proximoimgCiclismo = 'img/badges/Categorias/Ciclismo/Super.png';
        document.getElementById("Ciclismo").src="img/badges/Categorias/Ciclismo/Super.png"
      }

    }else{
      $scope.auxnbadgeCiclismo = 0;
      $scope.anteriorimgCiclismoa = 'img/badges/Categorias/Ciclismo/0.png';
      $scope.proximoCiclismo = 1;
      $scope.proximoimgCiclismo = 'img/badges/Categorias/Ciclismo/1.png';
      document.getElementById("Ciclismo").src="img/badges/Categorias/Ciclismo/0.png"
    }
  });

  $scope.aux.tag = "#Conversa";
  $scope.auxnbadgeConversa = 0;
  $scope.proximoConversa = 0;
  $scope.proximoimgConversa = '';
  $scope.anteriorimgConversa = '';
  EventoService.getbadges($scope.aux).then(function(badges){
    console.log("badges", badges);
    if(badges!="Error" && badges !="E"){
      $scope.auxnbadgeConversa = badges.length;
      if(badges.length == 0){
        $scope.anteriorimgConversa = 'img/badges/Categorias/Conversa/0.png';
        $scope.proximoConversa = 1;
        $scope.proximoimgConversa = 'img/badges/Categorias/Conversa/1.png';
        document.getElementById("Conversa").src="img/badges/Categorias/Conversa/0.png"
      }
      if(badges.length == 1){
        $scope.anteriorimgConversa = 'img/badges/Categorias/Conversa/0.png';
        $scope.proximoConversa = 2;
        $scope.proximoimgConversa = 'img/badges/Categorias/Conversa/1.1.png';
        document.getElementById("Conversa").src="img/badges/Categorias/Conversa/1.png"
      }
      if(badges.length == 2){
        $scope.anteriorimgConversa = 'img/badges/Categorias/Conversa/1.png';
        $scope.proximoConversa = 3;
        $scope.proximoimgConversa = 'img/badges/Categorias/Conversa/1.2.png';
        document.getElementById("Conversa").src="img/badges/Categorias/Conversa/1.1.png"
      }
      if(badges.length == 3){
        $scope.anteriorimgConversa = 'img/badges/Categorias/Conversa/1.1.png';
        $scope.proximoConversa = 4;
        $scope.proximoimgConversa = 'img/badges/Categorias/Conversa/1.3.png';
        document.getElementById("Conversa").src="img/badges/Categorias/Conversa/1.2.png"
      }
      if(badges.length == 4 || badges.length == 5){
        $scope.anteriorimgConversa = 'img/badges/Categorias/Conversa/1.2.png';
        $scope.proximoConversa = 6;
        $scope.proximoimgConversa = 'img/badges/Categorias/Conversa/2.png';
        document.getElementById("Conversa").src="img/badges/Categorias/Conversa/1.3.png"
      }

      if(badges.length == 6 || badges.length == 7){
        $scope.anteriorimgConversa = 'img/badges/Categorias/Conversa/1.3.png';
        $scope.proximoConversa = 8;
        $scope.proximoimgConversa = 'img/badges/Categorias/Conversa/2.1.png';
        document.getElementById("Conversa").src="img/badges/Categorias/Conversa/2.png"
      }
      if(badges.length == 8 || badges.length == 9){
        $scope.anteriorimgConversa = 'img/badges/Categorias/Conversa/2.png';
        $scope.proximoConversa = 10;
        $scope.proximoimgConversa = 'img/badges/Categorias/Conversa/2.2.png';
        document.getElementById("Conversa").src="img/badges/Categorias/Conversa/2.1.png"
      }
      if(badges.length == 10 || badges.length == 11){
        $scope.anteriorimgConversa = 'img/badges/Categorias/Conversa/2.1.png';
        $scope.proximoConversa = 12;
        $scope.proximoimgConversa = 'img/badges/Categorias/Conversa/2.3.png';
        document.getElementById("Conversa").src="img/badges/Categorias/Conversa/2.2.png"
      }
      if(badges.length == 12 || badges.length == 13 || badges.length == 14){
        $scope.anteriorimgConversa = 'img/badges/Categorias/Conversa/2.2.png';
        $scope.proximoConversa = 15;
        $scope.proximoimgConversa = 'img/badges/Categorias/Conversa/3.png';
        document.getElementById("Conversa").src="img/badges/Categorias/Conversa/2.3.png"
      }

      if(badges.length >= 15 && badges.length < 20 ){
        $scope.anteriorimgConversa = 'img/badges/Categorias/Conversa/2.3.png';
        $scope.proximoConversa = 20;
        $scope.proximoimgConversa = 'img/badges/Categorias/Conversa/3.1.png';
        document.getElementById("Conversa").src="img/badges/Categorias/Conversa/3.png"
      }
      if(badges.length >= 20 && badges.length < 22 ){
        $scope.anteriorimgConversa = 'img/badges/Categorias/Conversa/3.png';
        $scope.proximoConversa = 25;
        $scope.proximoimgConversa = 'img/badges/Categorias/Conversa/3.2.png';
        document.getElementById("Conversa").src="img/badges/Categorias/Conversa/3.1.png"
      }
      if(badges.length >= 25 && badges.length < 30 ){
        $scope.anteriorimgConversa = 'img/badges/Categorias/Conversa/3.1.png';
        $scope.proximoConversa = 30;
        $scope.proximoimgConversa = 'img/badges/Categorias/Conversa/3.3.png';
        document.getElementById("Conversa").src="img/badges/Categorias/Conversa/3.2.png"
      }
      if(badges.length >= 30 && badges.length < 50 ){
        $scope.anteriorimgConversa = 'img/badges/Categorias/Conversa/3.2.png';
        $scope.proximoConversa = 50;
        $scope.proximoimgConversa = 'img/badges/Categorias/Conversa/Super.png';
        document.getElementById("Conversa").src="img/badges/Categorias/Conversa/3.3.png"
      }

      if(badges.length >= 50){
        $scope.anteriorimgConversa = 'img/badges/Categorias/Conversa/3.3.png';
        $scope.proximoConversa = 10000;
        $scope.proximoimgConversa = 'img/badges/Categorias/Conversa/Super.png';
        document.getElementById("Conversa").src="img/badges/Categorias/Conversa/Super.png"
      }

    }else{
      $scope.auxnbadgeConversa = 0;

        $scope.anteriorimgConversa = 'img/badges/Categorias/Conversa/0.png';
        $scope.proximoConversa = 1;
        $scope.proximoimgConversa = 'img/badges/Categorias/Conversa/1.png';
      document.getElementById("Conversa").src="img/badges/Categorias/Conversa/0.png"
    }
  });

  $scope.aux.tag = "#Dança";
  $scope.auxnbadgeDanca = 0;
  $scope.proximoDanca = 0;
  $scope.proximoimgDanca = '';
  $scope.anteriorimgDanca = '';
  EventoService.getbadges($scope.aux).then(function(badges){
    console.log("badges", badges);
    if(badges!="Error" && badges !="E"){
      $scope.auxnbadgeDanca = badges.length;
      if(badges.length == 0){
        $scope.anteriorimgDanca = 'img/badges/Categorias/Danca/0.png';
        $scope.proximoDanca = 1;
        $scope.proximoimgDanca = 'img/badges/Categorias/Danca/1.png';
        document.getElementById("Danca").src="img/badges/Categorias/Danca/0.png"
      }
      if(badges.length == 1){
        $scope.anteriorimgDanca = 'img/badges/Categorias/Danca/0.png';
        $scope.proximoDanca = 2;
        $scope.proximoimgDanca = 'img/badges/Categorias/Danca/1.1.png';
        document.getElementById("Danca").src="img/badges/Categorias/Danca/1.png"
      }
      if(badges.length == 2){
        $scope.anteriorimgDanca = 'img/badges/Categorias/Danca/1.png';
        $scope.proximoDanca = 3;
        $scope.proximoimgDanca = 'img/badges/Categorias/Danca/1.2.png';
        document.getElementById("Danca").src="img/badges/Categorias/Danca/1.1.png"
      }
      if(badges.length == 3){
        $scope.anteriorimgDanca = 'img/badges/Categorias/Danca/1.1.png';
        $scope.proximoDanca = 4;
        $scope.proximoimgDanca = 'img/badges/Categorias/Danca/1.3.png';
        document.getElementById("Danca").src="img/badges/Categorias/Danca/1.2.png"
      }
      if(badges.length == 4 || badges.length == 5){
        $scope.anteriorimgDanca = 'img/badges/Categorias/Danca/1.2.png';
        $scope.proximoDanca = 6;
        $scope.proximoimgDanca = 'img/badges/Categorias/Danca/2.png';
        document.getElementById("Danca").src="img/badges/Categorias/Danca/1.3.png"
      }

      if(badges.length == 6 || badges.length == 7){
        $scope.anteriorimgDanca = 'img/badges/Categorias/Danca/1.3.png';
        $scope.proximoDanca = 8;
        $scope.proximoimgDanca = 'img/badges/Categorias/Danca/2.1.png';
        document.getElementById("Danca").src="img/badges/Categorias/Danca/2.png"
      }
      if(badges.length == 8 || badges.length == 9){
        $scope.anteriorimgDanca = 'img/badges/Categorias/Danca/2.png';
        $scope.proximoDanca = 10;
        $scope.proximoimgDanca = 'img/badges/Categorias/Danca/2.2.png';
        document.getElementById("Danca").src="img/badges/Categorias/Danca/2.1.png"
      }
      if(badges.length == 10 || badges.length == 11){
        $scope.anteriorimgDanca = 'img/badges/Categorias/Danca/2.1.png';
        $scope.proximoDanca = 12;
        $scope.proximoimgDanca = 'img/badges/Categorias/Danca/2.3.png';
        document.getElementById("Danca").src="img/badges/Categorias/Danca/2.2.png"
      }
      if(badges.length == 12 || badges.length == 13 || badges.length == 14){
        $scope.anteriorimgDanca = 'img/badges/Categorias/Danca/2.2.png';
        $scope.proximoDanca = 15;
        $scope.proximoimgDanca = 'img/badges/Categorias/Danca/3.png';
        document.getElementById("Danca").src="img/badges/Categorias/Danca/2.3.png"
      }

      if(badges.length >= 15 && badges.length < 20 ){
        $scope.anteriorimgDanca = 'img/badges/Categorias/Danca/2.3.png';
        $scope.proximoDanca = 20;
        $scope.proximoimgDanca = 'img/badges/Categorias/Danca/3.png';
        document.getElementById("Danca").src="img/badges/Categorias/Danca/3.png"
      }
      if(badges.length >= 20 && badges.length < 22 ){
        $scope.anteriorimgDanca = 'img/badges/Categorias/Danca/3.png';
        $scope.proximoDanca = 25;
        $scope.proximoimgDanca = 'img/badges/Categorias/Danca/3.2.png';
        document.getElementById("Danca").src="img/badges/Categorias/Danca/3.1.png"
      }
      if(badges.length >= 25 && badges.length < 30 ){
        $scope.anteriorimgDanca = 'img/badges/Categorias/Danca/3.1.png';
        $scope.proximoDanca = 30;
        $scope.proximoimgDanca = 'img/badges/Categorias/Danca/3.3.png';
        document.getElementById("Danca").src="img/badges/Categorias/Danca/3.2.png"
      }
      if(badges.length >= 30 && badges.length < 50 ){
        $scope.anteriorimgDanca = 'img/badges/Categorias/Danca/3.2.png';
        $scope.proximoDanca = 50;
        $scope.proximoimgDanca = 'img/badges/Categorias/Danca/Super.png';
        document.getElementById("Danca").src="img/badges/Categorias/Danca/3.3.png"
      }

      if(badges.length >= 50){
        $scope.anteriorimgDanca = 'img/badges/Categorias/Danca/3.3.png';
        $scope.proximoDanca = 10000;
        $scope.proximoimgDanca = 'img/badges/Categorias/Danca/Super.png';
        document.getElementById("Danca").src="img/badges/Categorias/Danca/Super.png"
      }

    }else{
      $scope.auxnbadgeDanca = 0;
        $scope.anteriorimgDanca = 'img/badges/Categorias/Danca/0.png';
        $scope.proximoDanca = 1;
        $scope.proximoimgDanca = 'img/badges/Categorias/Danca/1.png';
      document.getElementById("Danca").src="img/badges/Categorias/Danca/0.png"
    }
  });

  $scope.aux.tag = "#EsportesdePraia";
  $scope.auxnbadgeEsportesdePraia = 0;
  $scope.proximoEsportesdePraia = 0;
  $scope.proximoimgEsportesdePraia = '';
  $scope.anteriorimgEsportesdePraia = '';
  EventoService.getbadges($scope.aux).then(function(badges){
    console.log("badges", badges);
    if(badges!="Error" && badges !="E"){
      $scope.auxnbadgeEsportesdePraia = badges.length;
      if(badges.length == 0){
        $scope.anteriorimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/0.png';
        $scope.proximoEsportesdePraia = 1;
        $scope.proximoimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/1.png';
        document.getElementById("EsportesdePraia").src="img/badges/Categorias/EsportesdePraia/0.png"
      }
      if(badges.length == 1){
        $scope.anteriorimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/0.png';
        $scope.proximoEsportesdePraia = 2;
        $scope.proximoimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/1.1.png';
        document.getElementById("EsportesdePraia").src="img/badges/Categorias/EsportesdePraia/1.png"
      }
      if(badges.length == 2){
        $scope.anteriorimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/1.png';
        $scope.proximoEsportesdePraia = 3;
        $scope.proximoimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/1.2.png';
        document.getElementById("EsportesdePraia").src="img/badges/Categorias/EsportesdePraia/1.1.png"
      }
      if(badges.length == 3){
        $scope.anteriorimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/1.1.png';
        $scope.proximoEsportesdePraia = 4;
        $scope.proximoimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/1.3.png';
        document.getElementById("EsportesdePraia").src="img/badges/Categorias/EsportesdePraia/1.2.png"
      }
      if(badges.length == 4 || badges.length == 5){
        $scope.anteriorimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/1.2.png';
        $scope.proximoEsportesdePraia = 6;
        $scope.proximoimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/2.png';
        document.getElementById("EsportesdePraia").src="img/badges/Categorias/EsportesdePraia/1.3.png"
      }

      if(badges.length == 6 || badges.length == 7){
        $scope.anteriorimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/1.3.png';
        $scope.proximoEsportesdePraia = 8;
        $scope.proximoimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/2.1.png';
        document.getElementById("EsportesdePraia").src="img/badges/Categorias/EsportesdePraia/2.png"
      }
      if(badges.length == 8 || badges.length == 9){
        $scope.anteriorimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/2.png';
        $scope.proximoEsportesdePraia = 10;
        $scope.proximoimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/2.2.png';
        document.getElementById("EsportesdePraia").src="img/badges/Categorias/EsportesdePraia/2.1.png"
      }
      if(badges.length == 10 || badges.length == 11){
        $scope.anteriorimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/2.1.png';
        $scope.proximoEsportesdePraia = 12;
        $scope.proximoimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/2.3.png';
        document.getElementById("EsportesdePraia").src="img/badges/Categorias/EsportesdePraia/2.2.png"
      }
      if(badges.length == 12 || badges.length == 13 || badges.length == 14){
        $scope.anteriorimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/2.2.png';
        $scope.proximoEsportesdePraia = 15;
        $scope.proximoimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/3.png';
        document.getElementById("EsportesdePraia").src="img/badges/Categorias/EsportesdePraia/2.3.png"
      }

      if(badges.length >= 15 && badges.length < 20 ){
        $scope.anteriorimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/2.3.png';
        $scope.proximoEsportesdePraia = 20;
        $scope.proximoimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/3.1.png';
        document.getElementById("EsportesdePraia").src="img/badges/Categorias/EsportesdePraia/3.png"
      }
      if(badges.length >= 20 && badges.length < 22 ){
        $scope.anteriorimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/3.png';
        $scope.proximoEsportesdePraia = 25;
        $scope.proximoimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/3.2.png';
        document.getElementById("EsportesdePraia").src="img/badges/Categorias/EsportesdePraia/3.1.png"
      }
      if(badges.length >= 25 && badges.length < 30 ){
        $scope.anteriorimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/3.1.png';
        $scope.proximoEsportesdePraia = 30;
        $scope.proximoimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/1.png';
        document.getElementById("EsportesdePraia").src="img/badges/Categorias/EsportesdePraia/3.2.png"
      }
      if(badges.length >= 30 && badges.length < 50 ){
        $scope.anteriorimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/3.2.png';
        $scope.proximoEsportesdePraia = 50;
        $scope.proximoimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/Super.png';
        document.getElementById("EsportesdePraia").src="img/badges/Categorias/EsportesdePraia/3.3.png"
      }

      if(badges.length >= 50){
        $scope.anteriorimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/3.3.png';
        $scope.proximoEsportesdePraia = 10000;
        $scope.proximoimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/Super.png';
        document.getElementById("EsportesdePraia").src="img/badges/Categorias/EsportesdePraia/Super.png"
      }

    }else{
      $scope.auxnbadgeEsportesdePraia = 0;
        $scope.anteriorimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/0.png';
        $scope.proximoEsportesdePraia = 1;
        $scope.proximoimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/1.png';
      document.getElementById("EsportesdePraia").src="img/badges/Categorias/EsportesdePraia/0.png"
    }
  });

  $scope.aux.tag = "#FestaseBaladas";
  $scope.auxnbadgeFestaseBaladas = 0;
  $scope.proximoFestaseBaladas = 0;
  $scope.proximoimgFestaseBaladas = '';
  $scope.anteriorimgFestaseBaladas = '';
  EventoService.getbadges($scope.aux).then(function(badges){
    console.log("badges", badges);
    if(badges!="Error" && badges !="E"){
      $scope.auxnbadgeFestaseBaladas = badges.length;
      if(badges.length == 0){
        $scope.anteriorimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/0.png';
        $scope.proximoFestaseBaladas = 1;
        $scope.proximoimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/1.png';
        document.getElementById("FestaseBaladas").src="img/badges/Categorias/FestaseBaladas/0.png"
      }
      if(badges.length == 1){
        $scope.anteriorimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/0.png';
        $scope.proximoFestaseBaladas = 2;
        $scope.proximoimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/1.1.png';
        document.getElementById("FestaseBaladas").src="img/badges/Categorias/FestaseBaladas/1.png"
      }
      if(badges.length == 2){
        $scope.anteriorimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/1.png';
        $scope.proximoFestaseBaladas = 3;
        $scope.proximoimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/1.2.png';
        document.getElementById("FestaseBaladas").src="img/badges/Categorias/FestaseBaladas/1.1.png"
      }
      if(badges.length == 3){
        $scope.anteriorimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/1.1.png';
        $scope.proximoFestaseBaladas = 4;
        $scope.proximoimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/1.3.png';
        document.getElementById("FestaseBaladas").src="img/badges/Categorias/FestaseBaladas/1.2.png"
      }
      if(badges.length == 4 || badges.length == 5){
        $scope.anteriorimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/1.2.png';
        $scope.proximoFestaseBaladas = 6;
        $scope.proximoimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/2.png';
        document.getElementById("FestaseBaladas").src="img/badges/Categorias/FestaseBaladas/1.3.png"
      }

      if(badges.length == 6 || badges.length == 7){
        $scope.anteriorimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/1.3.png';
        $scope.proximoFestaseBaladas = 8;
        $scope.proximoimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/2.1.png';
        document.getElementById("FestaseBaladas").src="img/badges/Categorias/FestaseBaladas/2.png"
      }
      if(badges.length == 8 || badges.length == 9){
        $scope.anteriorimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/2.png';
        $scope.proximoFestaseBaladas = 10;
        $scope.proximoimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/2.2.png';
        document.getElementById("FestaseBaladas").src="img/badges/Categorias/FestaseBaladas/2.1.png"
      }
      if(badges.length == 10 || badges.length == 11){
        $scope.anteriorimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/2.1.png';
        $scope.proximoFestaseBaladas = 12;
        $scope.proximoimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/2.3.png';
        document.getElementById("FestaseBaladas").src="img/badges/Categorias/FestaseBaladas/2.2.png"
      }
      if(badges.length == 12 || badges.length == 13 || badges.length == 14){
        $scope.anteriorimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/2.2.png';
        $scope.proximoFestaseBaladas = 15;
        $scope.proximoimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/3.png';
        document.getElementById("FestaseBaladas").src="img/badges/Categorias/FestaseBaladas/2.3.png"
      }

      if(badges.length >= 15 && badges.length < 20 ){
        $scope.anteriorimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/2.3.png';
        $scope.proximoFestaseBaladas = 20;
        $scope.proximoimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/3.1.png';
        document.getElementById("FestaseBaladas").src="img/badges/Categorias/FestaseBaladas/3.png"
      }
      if(badges.length >= 20 && badges.length < 22 ){
        $scope.anteriorimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/3.png';
        $scope.proximoFestaseBaladas = 25;
        $scope.proximoimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/3.2.png';
        document.getElementById("FestaseBaladas").src="img/badges/Categorias/FestaseBaladas/3.1.png"
      }
      if(badges.length >= 25 && badges.length < 30 ){
        $scope.anteriorimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/3.1.png';
        $scope.proximoFestaseBaladas = 30;
        $scope.proximoimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/3.3.png';
        document.getElementById("FestaseBaladas").src="img/badges/Categorias/FestaseBaladas/3.2.png"
      }
      if(badges.length >= 30 && badges.length < 50 ){
        $scope.anteriorimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/3.2.png';
        $scope.proximoFestaseBaladas = 50;
        $scope.proximoimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/Super.png';
        document.getElementById("FestaseBaladas").src="img/badges/Categorias/FestaseBaladas/3.3.png"
      }

      if(badges.length >= 50){
        $scope.anteriorimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/3.3.png';
        $scope.proximoFestaseBaladas = 10000;
        $scope.proximoimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/Super.png';
        document.getElementById("FestaseBaladas").src="img/badges/Categorias/FestaseBaladas/Super.png"
      }

    }else{
      $scope.auxnbadgeFestaseBaladas = 0;
        $scope.anteriorimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/0.png';
        $scope.proximoFestaseBaladas = 1;
        $scope.proximoimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/1.png';
      document.getElementById("FestaseBaladas").src="img/badges/Categorias/FestaseBaladas/0.png"
    }
  });

  $scope.aux.tag = "#Futebol";
  $scope.auxnbadgeFutebol = 0;
  $scope.proximoFutebol = 0;
  $scope.proximoimgFutebol = '';
  $scope.anteriorimgFutebol = '';
  EventoService.getbadges($scope.aux).then(function(badges){
    console.log("badges", badges);
    if(badges!="Error" && badges !="E"){
      $scope.auxnbadgeFutebol = badges.length;
      if(badges.length == 0){
        $scope.anteriorimgFutebol = 'img/badges/Categorias/Futebol/0.png';
        $scope.proximoFutebol = 1;
        $scope.proximoimgFutebol = 'img/badges/Categorias/Futebol/1.png';
        document.getElementById("Futebol").src="img/badges/Categorias/Futebol/0.png"
      }
      if(badges.length == 1){
        $scope.anteriorimgFutebol = 'img/badges/Categorias/Futebol/0.png';
        $scope.proximoFutebol = 2;
        $scope.proximoimgFutebol = 'img/badges/Categorias/Futebol/1.1.png';
        document.getElementById("Futebol").src="img/badges/Categorias/Futebol/1.png"
      }
      if(badges.length == 2){
        $scope.anteriorimgFutebol = 'img/badges/Categorias/Futebol/1.png';
        $scope.proximoFutebol = 3;
        $scope.proximoimgFutebol = 'img/badges/Categorias/Futebol/1.2.png';
        document.getElementById("Futebol").src="img/badges/Categorias/Futebol/1.1.png"
      }
      if(badges.length == 3){
        $scope.anteriorimgFutebol = 'img/badges/Categorias/Futebol/1.1.png';
        $scope.proximoFutebol = 4;
        $scope.proximoimgFutebol = 'img/badges/Categorias/Futebol/1.3.png';
        document.getElementById("Futebol").src="img/badges/Categorias/Futebol/1.2.png"
      }
      if(badges.length == 4 || badges.length == 5){
        $scope.anteriorimgFutebol = 'img/badges/Categorias/Futebol/1.2.png';
        $scope.proximoFutebol = 6;
        $scope.proximoimgFutebol = 'img/badges/Categorias/Futebol/2.png';
        document.getElementById("Futebol").src="img/badges/Categorias/Futebol/1.3.png"
      }

      if(badges.length == 6 || badges.length == 7){
        $scope.anteriorimgFutebol = 'img/badges/Categorias/Futebol/1.3.png';
        $scope.proximoFutebol = 8;
        $scope.proximoimgFutebol = 'img/badges/Categorias/Futebol/2.1.png';
        document.getElementById("Futebol").src="img/badges/Categorias/Futebol/2.png"
      }
      if(badges.length == 8 || badges.length == 9){
        $scope.anteriorimgFutebol = 'img/badges/Categorias/Futebol/2.png';
        $scope.proximoFutebol = 10;
        $scope.proximoimgFutebol = 'img/badges/Categorias/Futebol/2.2.png';
        document.getElementById("Futebol").src="img/badges/Categorias/Futebol/2.1.png"
      }
      if(badges.length == 10 || badges.length == 11){
        $scope.anteriorimgFutebol = 'img/badges/Categorias/Futebol/2.1.png';
        $scope.proximoFutebol = 12;
        $scope.proximoimgFutebol = 'img/badges/Categorias/Futebol/2.3.png';
        document.getElementById("Futebol").src="img/badges/Categorias/Futebol/2.2.png"
      }
      if(badges.length == 12 || badges.length == 13 || badges.length == 14){
        $scope.anteriorimgFutebol = 'img/badges/Categorias/Futebol/2.2.png';
        $scope.proximoFutebol = 15;
        $scope.proximoimgFutebol = 'img/badges/Categorias/Futebol/3.png';
        document.getElementById("Futebol").src="img/badges/Categorias/Futebol/2.3.png"
      }

      if(badges.length >= 15 && badges.length < 20 ){
        $scope.anteriorimgFutebol = 'img/badges/Categorias/Futebol/2.3.png';
        $scope.proximoFutebol = 20;
        $scope.proximoimgFutebol = 'img/badges/Categorias/Futebol/3.1.png';
        document.getElementById("Futebol").src="img/badges/Categorias/Futebol/3.png"
      }
      if(badges.length >= 20 && badges.length < 22 ){
        $scope.anteriorimgFutebol = 'img/badges/Categorias/Futebol/3.png';
        $scope.proximoFutebol = 25;
        $scope.proximoimgFutebol = 'img/badges/Categorias/Futebol/3.2.png';
        document.getElementById("Futebol").src="img/badges/Categorias/Futebol/3.1.png"
      }
      if(badges.length >= 25 && badges.length < 30 ){
        $scope.anteriorimgFutebol = 'img/badges/Categorias/Futebol/3.1.png';
        $scope.proximoFutebol = 30;
        $scope.proximoimgFutebol = 'img/badges/Categorias/Futebol/3.3.png';
        document.getElementById("Futebol").src="img/badges/Categorias/Futebol/3.2.png"
      }
      if(badges.length >= 30 && badges.length < 50 ){
        $scope.anteriorimgFutebol = 'img/badges/Categorias/Futebol/3.2.png';
        $scope.proximoFutebol = 50;
        $scope.proximoimgFutebol = 'img/badges/Categorias/Futebol/Super.png';
        document.getElementById("Futebol").src="img/badges/Categorias/Futebol/3.3.png"
      }

      if(badges.length >= 50){
        $scope.anteriorimgFutebol = 'img/badges/Categorias/Futebol/3.3.png';
        $scope.proximoFutebol = 10000;
        $scope.proximoimgFutebol = 'img/badges/Categorias/Futebol/Super.png';
        document.getElementById("Futebol").src="img/badges/Categorias/Futebol/Super.png"
      }

    }else{
      $scope.auxnbadgeFutebol = 0;

        $scope.anteriorimgFutebol = 'img/badges/Categorias/Futebol/0.png';
        $scope.proximoFutebol = 1;
        $scope.proximoimgFutebol = 'img/badges/Categorias/Futebol/1.png';
      document.getElementById("Futebol").src="img/badges/Categorias/Futebol/0.png"
    }
  });

  $scope.aux.tag = "#GrupodeEstudos";
  $scope.auxnbadgeGrupodeEstudos = 0;
  $scope.proximoGrupodeEstudos = 0;
  $scope.proximoimgGrupodeEstudos = '';
  $scope.anteriorimgGrupodeEstudos = '';
  EventoService.getbadges($scope.aux).then(function(badges){
    console.log("badges", badges);
    if(badges!="Error" && badges !="E"){
      $scope.auxnbadgeGrupodeEstudos = badges.length;
      if(badges.length == 0){
        $scope.anteriorimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/0.png';
        $scope.proximoGrupodeEstudos = 1;
        $scope.proximoimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/1.png';
        document.getElementById("GrupodeEstudos").src="img/badges/Categorias/GrupodeEstudos/0.png"
      }
      if(badges.length == 1){
        $scope.anteriorimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/0.png';
        $scope.proximoGrupodeEstudos = 2;
        $scope.proximoimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/1.1.png';
        document.getElementById("GrupodeEstudos").src="img/badges/Categorias/GrupodeEstudos/1.png"
      }
      if(badges.length == 2){
        $scope.anteriorimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/1.png';
        $scope.proximoGrupodeEstudos = 3;
        $scope.proximoimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/1.2.png';
        document.getElementById("GrupodeEstudos").src="img/badges/Categorias/GrupodeEstudos/1.1.png"
      }
      if(badges.length == 3){
        $scope.anteriorimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/1.1.png';
        $scope.proximoGrupodeEstudos = 4;
        $scope.proximoimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/1.3.png';
        document.getElementById("GrupodeEstudos").src="img/badges/Categorias/GrupodeEstudos/1.2.png"
      }
      if(badges.length == 4 || badges.length == 5){
        $scope.anteriorimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/1.2.png';
        $scope.proximoGrupodeEstudos = 6;
        $scope.proximoimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/2.png';
        document.getElementById("GrupodeEstudos").src="img/badges/Categorias/GrupodeEstudos/1.3.png"
      }

      if(badges.length == 6 || badges.length == 7){
        $scope.anteriorimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/1.3.png';
        $scope.proximoGrupodeEstudos = 8;
        $scope.proximoimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/2.1.png';
        document.getElementById("GrupodeEstudos").src="img/badges/Categorias/GrupodeEstudos/2.png"
      }
      if(badges.length == 8 || badges.length == 9){
        $scope.anteriorimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/2.png';
        $scope.proximoGrupodeEstudos = 10;
        $scope.proximoimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/2.2.png';
        document.getElementById("GrupodeEstudos").src="img/badges/Categorias/GrupodeEstudos/2.1.png"
      }
      if(badges.length == 10 || badges.length == 11){
        $scope.anteriorimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/2.1.png';
        $scope.proximoGrupodeEstudos = 12;
        $scope.proximoimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/2.3.png';
        document.getElementById("GrupodeEstudos").src="img/badges/Categorias/GrupodeEstudos/2.2.png"
      }
      if(badges.length == 12 || badges.length == 13 || badges.length == 14){
        $scope.anteriorimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/2.2.png';
        $scope.proximoGrupodeEstudos = 15;
        $scope.proximoimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/3.png';
        document.getElementById("GrupodeEstudos").src="img/badges/Categorias/GrupodeEstudos/2.3.png"
      }

      if(badges.length >= 15 && badges.length < 20 ){
        $scope.anteriorimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/2.3.png';
        $scope.proximoGrupodeEstudos = 20;
        $scope.proximoimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/3.1.png';
        document.getElementById("GrupodeEstudos").src="img/badges/Categorias/GrupodeEstudos/3.png"
      }
      if(badges.length >= 20 && badges.length < 22 ){
        $scope.anteriorimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/3.png';
        $scope.proximoGrupodeEstudos = 25;
        $scope.proximoimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/3.2.png';
        document.getElementById("GrupodeEstudos").src="img/badges/Categorias/GrupodeEstudos/3.1.png"
      }
      if(badges.length >= 25 && badges.length < 30 ){
        $scope.anteriorimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/3.1.png';
        $scope.proximoGrupodeEstudos = 30;
        $scope.proximoimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/3.3.png';
        document.getElementById("GrupodeEstudos").src="img/badges/Categorias/GrupodeEstudos/3.2.png"
      }
      if(badges.length >= 30 && badges.length < 50 ){
        $scope.anteriorimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/3.2.png';
        $scope.proximoGrupodeEstudos = 50;
        $scope.proximoimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/Super.png';
        document.getElementById("GrupodeEstudos").src="img/badges/Categorias/GrupodeEstudos/3.3.png"
      }

      if(badges.length >= 50){
        $scope.anteriorimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/3.3.png';
        $scope.proximoGrupodeEstudos = 10000;
        $scope.proximoimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/Super.png';
        document.getElementById("GrupodeEstudos").src="img/badges/Categorias/GrupodeEstudos/Super.png"
      }

    }else{
      $scope.auxnbadgeGrupodeEstudos = 0;
        $scope.anteriorimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/0.png';
        $scope.proximoGrupodeEstudos = 1;
        $scope.proximoimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/1.png';
      document.getElementById("GrupodeEstudos").src="img/badges/Categorias/GrupodeEstudos/0.png"
    }
  });

  $scope.aux.tag = "#Jogos";
  $scope.auxnbadgeJogos = 0;
  $scope.proximoJogos = 0;
  $scope.proximoimgJogos = '';
  $scope.anteriorimgJogos = '';
  EventoService.getbadges($scope.aux).then(function(badges){
    //console.log("badges", badges);
    if(badges!="Error" && badges !="E"){
      $scope.auxnbadgeJogos = badges.length;
      if(badges.length == 0){
        $scope.anteriorimgJogos = 'img/badges/Categorias/Jogos/0.png';
        $scope.proximoJogos = 1;
        $scope.proximoimgJogos = 'img/badges/Categorias/Jogos/1.png';
        document.getElementById("Jogos").src="img/badges/Categorias/Jogos/0.png"
      }
      if(badges.length == 1){
        $scope.anteriorimgJogos = 'img/badges/Categorias/Jogos/0.png';
        $scope.proximoJogos = 2;
        $scope.proximoimgJogos = 'img/badges/Categorias/Jogos/1.1.png';
        document.getElementById("Jogos").src="img/badges/Categorias/Jogos/1.png"
      }
      if(badges.length == 2){
        $scope.anteriorimgJogos = 'img/badges/Categorias/Jogos/1.png';
        $scope.proximoJogos = 3;
        $scope.proximoimgJogos = 'img/badges/Categorias/Jogos/1.2.png';
        document.getElementById("Jogos").src="img/badges/Categorias/Jogos/1.1.png"
      }
      if(badges.length == 3){
        $scope.anteriorimgJogos = 'img/badges/Categorias/Jogos/1.1.png';
        $scope.proximoJogos = 4;
        $scope.proximoimgJogos = 'img/badges/Categorias/Jogos/1.3.png';
        document.getElementById("Jogos").src="img/badges/Categorias/Jogos/1.2.png"
      }
      if(badges.length == 4 || badges.length == 5){
        $scope.anteriorimgJogos = 'img/badges/Categorias/Jogos/1.2.png';
        $scope.proximoJogos = 6;
        $scope.proximoimgJogos = 'img/badges/Categorias/Jogos/2.png';
        document.getElementById("Jogos").src="img/badges/Categorias/Jogos/1.3.png"
      }

      if(badges.length == 6 || badges.length == 7){
        $scope.anteriorimgJogos = 'img/badges/Categorias/Jogos/1.3.png';
        $scope.proximoJogos = 8;
        $scope.proximoimgJogos = 'img/badges/Categorias/Jogos/2.1.png';
        document.getElementById("Jogos").src="img/badges/Categorias/Jogos/2.png"
      }
      if(badges.length == 8 || badges.length == 9){
        $scope.anteriorimgJogos = 'img/badges/Categorias/Jogos/2.png';
        $scope.proximoJogos = 10;
        $scope.proximoimgJogos = 'img/badges/Categorias/Jogos/2.2.png';
        document.getElementById("Jogos").src="img/badges/Categorias/Jogos/2.1.png"
      }
      if(badges.length == 10 || badges.length == 11){
        $scope.anteriorimgJogos = 'img/badges/Categorias/Jogos/2.1.png';
        $scope.proximoJogos = 12;
        $scope.proximoimgJogos = 'img/badges/Categorias/Jogos/2.3.png';
        document.getElementById("Jogos").src="img/badges/Categorias/Jogos/2.2.png"
      }
      if(badges.length == 12 || badges.length == 13 || badges.length == 14){
        $scope.anteriorimgJogos = 'img/badges/Categorias/Jogos/2.2.png';
        $scope.proximoJogos = 15;
        $scope.proximoimgJogos = 'img/badges/Categorias/Jogos/3.png';
        document.getElementById("Jogos").src="img/badges/Categorias/Jogos/2.3.png"
      }

      if(badges.length >= 15 && badges.length < 20 ){
        $scope.anteriorimgJogos = 'img/badges/Categorias/Jogos/2.3.png';
        $scope.proximoJogos = 20;
        $scope.proximoimgJogos = 'img/badges/Categorias/Jogos/3.1.png';
        document.getElementById("Jogos").src="img/badges/Categorias/Jogos/3.png"
      }
      if(badges.length >= 20 && badges.length < 22 ){
        $scope.anteriorimgJogos = 'img/badges/Categorias/Jogos/3.png';
        $scope.proximoJogos = 25;
        $scope.proximoimgJogos = 'img/badges/Categorias/Jogos/3.2.png';
        document.getElementById("Jogos").src="img/badges/Categorias/Jogos/3.1.png"
      }
      if(badges.length >= 25 && badges.length < 30 ){
        $scope.anteriorimgJogos = 'img/badges/Categorias/Jogos/3.1.png';
        $scope.proximoJogos = 30;
        $scope.proximoimgJogos = 'img/badges/Categorias/Jogos/3.3.png';
        document.getElementById("Jogos").src="img/badges/Categorias/Jogos/3.2.png"
      }
      if(badges.length >= 30 && badges.length < 50 ){
        $scope.anteriorimgJogos = 'img/badges/Categorias/Jogos/3.2.png';
        $scope.proximoJogos = 50;
        $scope.proximoimgJogos = 'img/badges/Categorias/Jogos/Super.png';
        document.getElementById("Jogos").src="img/badges/Categorias/Jogos/3.3.png"
      }

      if(badges.length >= 50){
        $scope.anteriorimgJogos = 'img/badges/Categorias/Jogos/3.3.png';
        $scope.proximoJogos = 10000;
        $scope.proximoimgJogos = 'img/badges/Categorias/Jogos/Super.png';
        document.getElementById("Jogos").src="img/badges/Categorias/Jogos/Super.png"
      }

    }else{
      $scope.auxnbadgeJogos = 0;
        $scope.anteriorimgJogos = 'img/badges/Categorias/Jogos/0.png';
        $scope.proximoJogos = 1;
        $scope.proximoimgJogos = 'img/badges/Categorias/Jogos/1.png';
      document.getElementById("Jogos").src="img/badges/Categorias/Jogos/0.png"
    }
  });

  $scope.aux.tag = "#Musica";
  $scope.auxnbadgeMusica = 0;
  $scope.proximoMusica = 0;
  $scope.proximoimgMusica = '';
  $scope.anteriorimgMusica = '';
  EventoService.getbadges($scope.aux).then(function(badges){
    //console.log("badges", badges);
    if(badges!="Error" && badges !="E"){
      $scope.auxnbadgeMusica = badges.length;
      if(badges.length == 0){
        $scope.anteriorimgMusica = 'img/badges/Categorias/Musica/0.png';
        $scope.proximoMusica = 1;
        $scope.proximoimgMusica = 'img/badges/Categorias/Musica/1.png';
        document.getElementById("Musica").src="img/badges/Categorias/Musica/0.png"
      }
      if(badges.length == 1){
        $scope.anteriorimgMusica = 'img/badges/Categorias/Musica/0.png';
        $scope.proximoMusica = 2;
        $scope.proximoimgMusica = 'img/badges/Categorias/Musica/1.1.png';
        document.getElementById("Musica").src="img/badges/Categorias/Musica/1.png"
      }
      if(badges.length == 2){
        $scope.anteriorimgMusica = 'img/badges/Categorias/Musica/1.png';
        $scope.proximoMusica = 3;
        $scope.proximoimgMusica = 'img/badges/Categorias/Musica/1.2.png';
        document.getElementById("Musica").src="img/badges/Categorias/Musica/1.1.png"
      }
      if(badges.length == 3){
        $scope.anteriorimgMusica = 'img/badges/Categorias/Musica/1.1.png';
        $scope.proximoMusica = 4;
        $scope.proximoimgMusica = 'img/badges/Categorias/Musica/1.3.png';
        document.getElementById("Musica").src="img/badges/Categorias/Musica/1.2.png"
      }
      if(badges.length == 4 || badges.length == 5){
        $scope.anteriorimgMusica = 'img/badges/Categorias/Musica/1.2.png';
        $scope.proximoMusica = 6;
        $scope.proximoimgMusica = 'img/badges/Categorias/Musica/2.png';
        document.getElementById("Musica").src="img/badges/Categorias/Musica/1.3.png"
      }

      if(badges.length == 6 || badges.length == 7){
        $scope.anteriorimgMusica = 'img/badges/Categorias/Musica/1.3.png';
        $scope.proximoMusica = 8;
        $scope.proximoimgMusica = 'img/badges/Categorias/Musica/2.1.png';
        document.getElementById("Musica").src="img/badges/Categorias/Musica/2.png"
      }
      if(badges.length == 8 || badges.length == 9){
        $scope.anteriorimgMusica = 'img/badges/Categorias/Musica/2.png';
        $scope.proximoMusica = 10;
        $scope.proximoimgMusica = 'img/badges/Categorias/Musica/2.2.png';
        document.getElementById("Musica").src="img/badges/Categorias/Musica/2.1.png"
      }
      if(badges.length == 10 || badges.length == 11){
        $scope.anteriorimgMusica = 'img/badges/Categorias/Musica/2.1.png';
        $scope.proximoMusica = 12;
        $scope.proximoimgMusica = 'img/badges/Categorias/Musica/2.3.png';
        document.getElementById("Musica").src="img/badges/Categorias/Musica/2.2.png"
      }
      if(badges.length == 12 || badges.length == 13 || badges.length == 14){
        $scope.anteriorimgMusica = 'img/badges/Categorias/Musica/2.2.png';
        $scope.proximoMusica = 15;
        $scope.proximoimgMusica = 'img/badges/Categorias/Musica/3.png';
        document.getElementById("Musica").src="img/badges/Categorias/Musica/2.3.png"
      }

      if(badges.length >= 15 && badges.length < 20 ){
        $scope.anteriorimgMusica = 'img/badges/Categorias/Musica/2.3.png';
        $scope.proximoMusica = 20;
        $scope.proximoimgMusica = 'img/badges/Categorias/Musica/3.1.png';
        document.getElementById("Musica").src="img/badges/Categorias/Musica/3.png"
      }
      if(badges.length >= 20 && badges.length < 22 ){
        $scope.anteriorimgMusica = 'img/badges/Categorias/Musica/3.png';
        $scope.proximoMusica = 25;
        $scope.proximoimgMusica = 'img/badges/Categorias/Musica/3.2.png';
        document.getElementById("Musica").src="img/badges/Categorias/Musica/3.1.png"
      }
      if(badges.length >= 25 && badges.length < 30 ){
        $scope.anteriorimgMusica = 'img/badges/Categorias/Musica/3.1.png';
        $scope.proximoMusica = 30;
        $scope.proximoimgMusica = 'img/badges/Categorias/Musica/3.3.png';
        document.getElementById("Musica").src="img/badges/Categorias/Musica/3.2.png"
      }
      if(badges.length >= 30 && badges.length < 50 ){
        $scope.anteriorimgMusica = 'img/badges/Categorias/Musica/3.2.png';
        $scope.proximoMusica = 50;
        $scope.proximoimgMusica = 'img/badges/Categorias/Musica/Super.png';
        document.getElementById("Musica").src="img/badges/Categorias/Musica/3.3.png"
      }

      if(badges.length >= 50){
        $scope.anteriorimgMusica = 'img/badges/Categorias/Musica/3.3.png';
        $scope.proximoMusica = 10000;
        $scope.proximoimgMusica = 'img/badges/Categorias/Musica/Super.png';
        document.getElementById("Musica").src="img/badges/Categorias/Musica/Super.png"
      }

    }else{
      $scope.auxnbadgeMusica = 0;
        $scope.anteriorimgMusica = 'img/badges/Categorias/Musica/0.png';
        $scope.proximoMusica = 1;
        $scope.proximoimgMusica = 'img/badges/Categorias/Musica/1.png';
      document.getElementById("Musica").src="img/badges/Categorias/Musica/0.png"
    }
  });

  $scope.aux.tag = "#Natureza";
  $scope.auxnbadgeNatureza = 0;
  $scope.proximoNatureza = 0;
  $scope.proximoimgNatureza = '';
  $scope.anteriorimgNatureza = '';
  EventoService.getbadges($scope.aux).then(function(badges){
    //console.log("badges", badges);
    if(badges!="Error" && badges !="E"){
      $scope.auxnbadgeNatureza = badges.length;
      if(badges.length == 0){
        $scope.anteriorimgNatureza = 'img/badges/Categorias/Natureza/0.png';
        $scope.proximoNatureza = 1;
        $scope.proximoimgNatureza = 'img/badges/Categorias/Natureza/1.png';
        document.getElementById("Natureza").src="img/badges/Categorias/Natureza/0.png"
      }
      if(badges.length == 1){
        $scope.anteriorimgNatureza = 'img/badges/Categorias/Natureza/0.png';
        $scope.proximoNatureza = 2;
        $scope.proximoimgNatureza = 'img/badges/Categorias/Natureza/1.1.png';
        document.getElementById("Natureza").src="img/badges/Categorias/Natureza/1.png"
      }
      if(badges.length == 2){
        $scope.anteriorimgNatureza = 'img/badges/Categorias/Natureza/1.png';
        $scope.proximoNatureza = 3;
        $scope.proximoimgNatureza = 'img/badges/Categorias/Natureza/1.2.png';
        document.getElementById("Natureza").src="img/badges/Categorias/Natureza/1.1.png"
      }
      if(badges.length == 3){
        $scope.anteriorimgNatureza = 'img/badges/Categorias/Natureza/1.1.png';
        $scope.proximoNatureza = 4;
        $scope.proximoimgNatureza = 'img/badges/Categorias/Natureza/1.3.png';
        document.getElementById("Natureza").src="img/badges/Categorias/Natureza/1.2.png"
      }
      if(badges.length == 4 || badges.length == 5){
        $scope.anteriorimgNatureza = 'img/badges/Categorias/Natureza/1.2.png';
        $scope.proximoNatureza = 6;
        $scope.proximoimgNatureza = 'img/badges/Categorias/Natureza/2.png';
        document.getElementById("Natureza").src="img/badges/Categorias/Natureza/1.3.png"
      }

      if(badges.length == 6 || badges.length == 7){
        $scope.anteriorimgNatureza = 'img/badges/Categorias/Natureza/1.3.png';
        $scope.proximoNatureza = 8;
        $scope.proximoimgNatureza = 'img/badges/Categorias/Natureza/2.1.png';
        document.getElementById("Natureza").src="img/badges/Categorias/Natureza/2.png"
      }
      if(badges.length == 8 || badges.length == 9){
        $scope.anteriorimgNatureza = 'img/badges/Categorias/Natureza/2.png';
        $scope.proximoNatureza = 10;
        $scope.proximoimgNatureza = 'img/badges/Categorias/Natureza/2.2.png';
        document.getElementById("Natureza").src="img/badges/Categorias/Natureza/2.1.png"
      }
      if(badges.length == 10 || badges.length == 11){
        $scope.anteriorimgNatureza = 'img/badges/Categorias/Natureza/2.1.png';
        $scope.proximoNatureza = 12;
        $scope.proximoimgNatureza = 'img/badges/Categorias/Natureza/2.3.png';
        document.getElementById("Natureza").src="img/badges/Categorias/Natureza/2.2.png"
      }
      if(badges.length == 12 || badges.length == 13 || badges.length == 14){
        $scope.anteriorimgNatureza = 'img/badges/Categorias/Natureza/2.2.png';
        $scope.proximoNatureza = 15;
        $scope.proximoimgNatureza = 'img/badges/Categorias/Natureza/3.png';
        document.getElementById("Natureza").src="img/badges/Categorias/Natureza/2.3.png"
      }

      if(badges.length >= 15 && badges.length < 20 ){
        $scope.anteriorimgNatureza = 'img/badges/Categorias/Natureza/2.3.png';
        $scope.proximoNatureza = 20;
        $scope.proximoimgNatureza = 'img/badges/Categorias/Natureza/3.1.png';
        document.getElementById("Natureza").src="img/badges/Categorias/Natureza/3.png"
      }
      if(badges.length >= 20 && badges.length < 22 ){
        $scope.anteriorimgNatureza = 'img/badges/Categorias/Natureza/3.png';
        $scope.proximoNatureza = 25;
        $scope.proximoimgNatureza = 'img/badges/Categorias/Natureza/3.2.png';
        document.getElementById("Natureza").src="img/badges/Categorias/Natureza/3.1.png"
      }
      if(badges.length >= 25 && badges.length < 30 ){
        $scope.anteriorimgNatureza = 'img/badges/Categorias/Natureza/3.1.png';
        $scope.proximoNatureza = 30;
        $scope.proximoimgNatureza = 'img/badges/Categorias/Natureza/3.3.png';
        document.getElementById("Natureza").src="img/badges/Categorias/Natureza/3.2.png"
      }
      if(badges.length >= 30 && badges.length < 50 ){
        $scope.anteriorimgNatureza = 'img/badges/Categorias/Natureza/3.2.png';
        $scope.proximoNatureza = 50;
        $scope.proximoimgNatureza = 'img/badges/Categorias/Natureza/Super.png';
        document.getElementById("Natureza").src="img/badges/Categorias/Natureza/3.3.png"
      }

      if(badges.length >= 50){
        $scope.anteriorimgNatureza = 'img/badges/Categorias/Natureza/3.3.png';
        $scope.proximoNatureza = 10000;
        $scope.proximoimgNatureza = 'img/badges/Categorias/Natureza/Super.png';
        document.getElementById("Natureza").src="img/badges/Categorias/Natureza/Super.png"
      }

    }else{
      $scope.auxnbadgeNatureza = 0;
        $scope.anteriorimgNatureza = 'img/badges/Categorias/Natureza/0.png';
        $scope.proximoNatureza = 1;
        $scope.proximoimgNatureza = 'img/badges/Categorias/Natureza/1.png';
      document.getElementById("Natureza").src="img/badges/Categorias/Natureza/0.png"
    }
  });

  $scope.aux.tag = "#Passeio";
  $scope.auxnbadgePasseio = 0;
  $scope.proximoPasseio = 0;
  $scope.proximoimgPasseio = '';
  $scope.anteriorimgPasseio = '';
  EventoService.getbadges($scope.aux).then(function(badges){
    //console.log("badges", badges);
    if(badges!="Error" && badges !="E"){
      $scope.auxnbadgePasseio = badges.length;
      if(badges.length == 0){
        $scope.anteriorimgPasseio = 'img/badges/Categorias/Passeio/0.png';
        $scope.proximoPasseio = 1;
        $scope.proximoimgPasseio = 'img/badges/Categorias/Passeio/1.png';
        document.getElementById("Passeio").src="img/badges/Categorias/Passeio/0.png"
      }
      if(badges.length == 1){
        $scope.anteriorimgPasseio = 'img/badges/Categorias/Passeio/0.png';
        $scope.proximoPasseio = 2;
        $scope.proximoimgPasseio = 'img/badges/Categorias/Passeio/1.1.png';
        document.getElementById("Passeio").src="img/badges/Categorias/Passeio/1.png"
      }
      if(badges.length == 2){
        $scope.anteriorimgPasseio = 'img/badges/Categorias/Passeio/1.png';
        $scope.proximoPasseio = 3;
        $scope.proximoimgPasseio = 'img/badges/Categorias/Passeio/1.2.png';
        document.getElementById("Passeio").src="img/badges/Categorias/Passeio/1.1.png"
      }
      if(badges.length == 3){
        $scope.anteriorimgPasseio = 'img/badges/Categorias/Passeio/1.1.png';
        $scope.proximoPasseio = 4;
        $scope.proximoimgPasseio = 'img/badges/Categorias/Passeio/1.3.png';
        document.getElementById("Passeio").src="img/badges/Categorias/Passeio/1.2.png"
      }
      if(badges.length == 4 || badges.length == 5){
        $scope.anteriorimgPasseio = 'img/badges/Categorias/Passeio/1.2.png';
        $scope.proximoPasseio = 6;
        $scope.proximoimgPasseio = 'img/badges/Categorias/Passeio/2.png';
        document.getElementById("Passeio").src="img/badges/Categorias/Passeio/1.3.png"
      }

      if(badges.length == 6 || badges.length == 7){
        $scope.anteriorimgPasseio = 'img/badges/Categorias/Passeio/1.3.png';
        $scope.proximoPasseio = 8 ;
        $scope.proximoimgPasseio = 'img/badges/Categorias/Passeio/2.1.png';
        document.getElementById("Passeio").src="img/badges/Categorias/Passeio/2.png"
      }
      if(badges.length == 8 || badges.length == 9){
        $scope.anteriorimgPasseio = 'img/badges/Categorias/Passeio/2.png';
        $scope.proximoPasseio = 10;
        $scope.proximoimgPasseio = 'img/badges/Categorias/Passeio/2.2.png';
        document.getElementById("Passeio").src="img/badges/Categorias/Passeio/2.1.png"
      }
      if(badges.length == 10 || badges.length == 11){
        $scope.anteriorimgPasseio = 'img/badges/Categorias/Passeio/2.1.png';
        $scope.proximoPasseio = 12;
        $scope.proximoimgPasseio = 'img/badges/Categorias/Passeio/2.3.png';
        document.getElementById("Passeio").src="img/badges/Categorias/Passeio/2.2.png"
      }
      if(badges.length == 12 || badges.length == 13 || badges.length == 14){
        $scope.anteriorimgPasseio = 'img/badges/Categorias/Passeio/2.2.png';
        $scope.proximoPasseio = 15;
        $scope.proximoimgPasseio = 'img/badges/Categorias/Passeio/3.png';
        document.getElementById("Passeio").src="img/badges/Categorias/Passeio/2.3.png"
      }

      if(badges.length >= 15 && badges.length < 20 ){
        $scope.anteriorimgPasseio = 'img/badges/Categorias/Passeio/2.3.png';
        $scope.proximoPasseio = 20;
        $scope.proximoimgPasseio = 'img/badges/Categorias/Passeio/3.1.png';
        document.getElementById("Passeio").src="img/badges/Categorias/Passeio/3.png"
      }
      if(badges.length >= 20 && badges.length < 22 ){
        $scope.anteriorimgPasseio = 'img/badges/Categorias/Passeio/3.png';
        $scope.proximoPasseio = 25;
        $scope.proximoimgPasseio = 'img/badges/Categorias/Passeio/3.2.png';
        document.getElementById("Passeio").src="img/badges/Categorias/Passeio/3.1.png"
      }
      if(badges.length >= 25 && badges.length < 30 ){
        $scope.anteriorimgPasseio = 'img/badges/Categorias/Passeio/3.1.png';
        $scope.proximoPasseio = 30;
        $scope.proximoimgPasseio = 'img/badges/Categorias/Passeio/3.3.png';
        document.getElementById("Passeio").src="img/badges/Categorias/Passeio/3.2.png"
      }
      if(badges.length >= 30 && badges.length < 50 ){
        $scope.anteriorimgPasseio = 'img/badges/Categorias/Passeio/3.2.png';
        $scope.proximoPasseio = 50;
        $scope.proximoimgPasseio = 'img/badges/Categorias/Passeio/Super.png';
        document.getElementById("Passeio").src="img/badges/Categorias/Passeio/3.3.png"
      }

      if(badges.length >= 50){
        $scope.anteriorimgPasseio = 'img/badges/Categorias/Passeio/3.3.png';
        $scope.proximoPasseio = 10000;
        $scope.proximoimgPasseio = 'img/badges/Categorias/Passeio/Super.png';
        document.getElementById("Passeio").src="img/badges/Categorias/Passeio/Super.png"
      }

    }else{
      $scope.auxnbadgePasseio = 0;
        $scope.anteriorimgPasseio = 'img/badges/Categorias/Passeio/0.png';
        $scope.proximoPasseio = 1;
        $scope.proximoimgPasseio = 'img/badges/Categorias/Passeio/1.png';
      document.getElementById("Passeio").src="img/badges/Categorias/Passeio/0.png"
    }
  });

  $scope.aux.tag = "#Pets";
  $scope.auxnbadgePets = 0;
  $scope.proximoPets = 0;
  $scope.proximoimgPets = '';
  $scope.anteriorimgPets = '';
  EventoService.getbadges($scope.aux).then(function(badges){
    //console.log("badges", badges);
    if(badges!="Error" && badges !="E"){
      $scope.auxnbadgePets = badges.length;
      if(badges.length == 0){
        $scope.anteriorimgPets = 'img/badges/Categorias/Pets/0.png';
        $scope.proximoPets = 1;
        $scope.proximoimgPets = 'img/badges/Categorias/Pets/1.png';
        document.getElementById("Pets").src="img/badges/Categorias/Pets/0.png"
      }
      if(badges.length == 1){
        $scope.anteriorimgPets = 'img/badges/Categorias/Pets/0.png';
        $scope.proximoPets = 2;
        $scope.proximoimgPets = 'img/badges/Categorias/Pets/1.1.png';
        document.getElementById("Pets").src="img/badges/Categorias/Pets/1.png"
      }
      if(badges.length == 2){
        $scope.anteriorimgPets = 'img/badges/Categorias/Pets/1.png';
        $scope.proximoPets = 3;
        $scope.proximoimgPets = 'img/badges/Categorias/Pets/1.2.png';
        document.getElementById("Pets").src="img/badges/Categorias/Pets/1.1.png"
      }
      if(badges.length == 3){
        $scope.anteriorimgPets = 'img/badges/Categorias/Pets/1.1.png';
        $scope.proximoPets = 4;
        $scope.proximoimgPets = 'img/badges/Categorias/Pets/1.3.png';
        document.getElementById("Pets").src="img/badges/Categorias/Pets/1.2.png"
      }
      if(badges.length == 4 || badges.length == 5){
        $scope.anteriorimgPets = 'img/badges/Categorias/Pets/1.2.png';
        $scope.proximoPets = 6;
        $scope.proximoimgPets = 'img/badges/Categorias/Pets/2.png';
        document.getElementById("Pets").src="img/badges/Categorias/Pets/1.3.png"
      }

      if(badges.length == 6 || badges.length == 7){
        $scope.anteriorimgPets = 'img/badges/Categorias/Pets/1.3.png';
        $scope.proximoPets = 8;
        $scope.proximoimgPets = 'img/badges/Categorias/Pets/2.1.png';
        document.getElementById("Pets").src="img/badges/Categorias/Pets/2.png"
      }
      if(badges.length == 8 || badges.length == 9){
        $scope.anteriorimgPets = 'img/badges/Categorias/Pets/2.png';
        $scope.proximoPets = 10;
        $scope.proximoimgPets = 'img/badges/Categorias/Pets/2.2.png';
        document.getElementById("Pets").src="img/badges/Categorias/Pets/2.1.png"
      }
      if(badges.length == 10 || badges.length == 11){
        $scope.anteriorimgPets = 'img/badges/Categorias/Pets/2.1.png';
        $scope.proximoPets = 12;
        $scope.proximoimgPets = 'img/badges/Categorias/Pets/2.3.png';
        document.getElementById("Pets").src="img/badges/Categorias/Pets/2.2.png"
      }
      if(badges.length == 12 || badges.length == 13 || badges.length == 14){
        $scope.anteriorimgPets = 'img/badges/Categorias/Pets/2.2.png';
        $scope.proximoPets = 15;
        $scope.proximoimgPets = 'img/badges/Categorias/Pets/3.png';
        document.getElementById("Pets").src="img/badges/Categorias/Pets/2.3.png"
      }

      if(badges.length >= 15 && badges.length < 20 ){
        $scope.anteriorimgPets = 'img/badges/Categorias/Pets/2.3.png';
        $scope.proximoPets = 20;
        $scope.proximoimgPets = 'img/badges/Categorias/Pets/3.1.png';
        document.getElementById("Pets").src="img/badges/Categorias/Pets/3.png"
      }
      if(badges.length >= 20 && badges.length < 22 ){
        $scope.anteriorimgPets = 'img/badges/Categorias/Pets/3.png';
        $scope.proximoPets = 25;
        $scope.proximoimgPets = 'img/badges/Categorias/Pets/3.2.png';
        document.getElementById("Pets").src="img/badges/Categorias/Pets/3.1.png"
      }
      if(badges.length >= 25 && badges.length < 30 ){
        $scope.anteriorimgPets = 'img/badges/Categorias/Pets/3.1.png';
        $scope.proximoPets = 30;
        $scope.proximoimgPets = 'img/badges/Categorias/Pets/3.3.png';
        document.getElementById("Pets").src="img/badges/Categorias/Pets/3.2.png"
      }
      if(badges.length >= 30 && badges.length < 50 ){
        $scope.anteriorimgPets = 'img/badges/Categorias/Pets/3.2.png';
        $scope.proximoPets = 50;
        $scope.proximoimgPets = 'img/badges/Categorias/Pets/Super.png';
        document.getElementById("Pets").src="img/badges/Categorias/Pets/3.3.png"
      }

      if(badges.length >= 50){
        $scope.anteriorimgPets = 'img/badges/Categorias/Pets/3.3.png';
        $scope.proximoPets = 10000;
        $scope.proximoimgPets = 'img/badges/Categorias/Pets/Super.png';
        document.getElementById("Pets").src="img/badges/Categorias/Pets/Super.png"
      }

    }else{
      $scope.auxnbadgePets = 0;
        $scope.anteriorimgPets = 'img/badges/Categorias/Pets/0.png';
        $scope.proximoPets = 1;
        $scope.proximoimgPets = 'img/badges/Categorias/Pets/1.png';
      document.getElementById("Pets").src="img/badges/Categorias/Pets/0.png"
    }
  });

  $scope.aux.tag = "#Restaurantesebares";
  $scope.auxnbadgeRestaurantesebares = 0;
  $scope.proximoRestaurantesebares = 0;
  $scope.proximoimgRestaurantesebares = '';
  $scope.anteriorimgRestaurantesebares = '';
  EventoService.getbadges($scope.aux).then(function(badges){
    //console.log("badges", badges);
    if(badges!="Error" && badges !="E"){
      $scope.auxnbadgeRestaurantesebares = badges.length ;
      if(badges.length == 0){
        $scope.anteriorimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/0.png';
        $scope.proximoRestaurantesebares = 1;
        $scope.proximoimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/1.png';
        document.getElementById("Restaurantesebares").src="img/badges/Categorias/Restaurantesebares/0.png"
      }
      if(badges.length == 1){
        $scope.anteriorimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/0.png';
        $scope.proximoRestaurantesebares = 2;
        $scope.proximoimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/1.1.png';
        document.getElementById("Restaurantesebares").src="img/badges/Categorias/Restaurantesebares/1.png"
      }
      if(badges.length == 2){
        $scope.anteriorimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/1.png';
        $scope.proximoRestaurantesebares = 3;
        $scope.proximoimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/1.2.png';
        document.getElementById("Restaurantesebares").src="img/badges/Categorias/Restaurantesebares/1.1.png"
      }
      if(badges.length == 3){
        $scope.anteriorimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/1.1.png';
        $scope.proximoRestaurantesebares = 4;
        $scope.proximoimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/1.3.png';
        document.getElementById("Restaurantesebares").src="img/badges/Categorias/Restaurantesebares/1.2.png"
      }
      if(badges.length == 4 || badges.length == 5){
        $scope.anteriorimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/1.2.png';
        $scope.proximoRestaurantesebares = 6;
        $scope.proximoimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/2.png';
        document.getElementById("Restaurantesebares").src="img/badges/Categorias/Restaurantesebares/1.3.png"
      }

      if(badges.length == 6 || badges.length == 7){
        $scope.anteriorimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/1.3.png';
        $scope.proximoRestaurantesebares = 8;
        $scope.proximoimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/2.1.png';
        document.getElementById("Restaurantesebares").src="img/badges/Categorias/Restaurantesebares/2.png"
      }
      if(badges.length == 8 || badges.length == 9){
        $scope.anteriorimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/2.png';
        $scope.proximoRestaurantesebares = 10;
        $scope.proximoimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/2.2.png';
        document.getElementById("Restaurantesebares").src="img/badges/Categorias/Restaurantesebares/2.1.png"
      }
      if(badges.length == 10 || badges.length == 11){
        $scope.anteriorimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/2.1.png';
        $scope.proximoRestaurantesebares = 12;
        $scope.proximoimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/2.3.png';
        document.getElementById("Restaurantesebares").src="img/badges/Categorias/Restaurantesebares/2.2.png"
      }
      if(badges.length == 12 || badges.length == 13 || badges.length == 14){
        $scope.anteriorimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/2.2.png';
        $scope.proximoRestaurantesebares = 15;
        $scope.proximoimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/3.png';
        document.getElementById("Restaurantesebares").src="img/badges/Categorias/Restaurantesebares/2.3.png"
      }

      if(badges.length >= 15 && badges.length < 20 ){
        $scope.anteriorimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/2.3.png';
        $scope.proximoRestaurantesebares = 20;
        $scope.proximoimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/3.1.png';
        document.getElementById("Restaurantesebares").src="img/badges/Categorias/Restaurantesebares/3.png"
      }
      if(badges.length >= 20 && badges.length < 22 ){
        $scope.anteriorimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/3.png';
        $scope.proximoRestaurantesebares = 25;
        $scope.proximoimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/3.2.png';
        document.getElementById("Restaurantesebares").src="img/badges/Categorias/Restaurantesebares/3.1.png"
      }
      if(badges.length >= 25 && badges.length < 30 ){
        $scope.anteriorimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/3.1.png';
        $scope.proximoRestaurantesebares = 30;
        $scope.proximoimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/3.3.png';
        document.getElementById("Restaurantesebares").src="img/badges/Categorias/Restaurantesebares/3.2.png"
      }
      if(badges.length >= 30 && badges.length < 50 ){
        $scope.anteriorimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/3.2.png';
        $scope.proximoRestaurantesebares = 50;
        $scope.proximoimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/Super.png';
        document.getElementById("Restaurantesebares").src="img/badges/Categorias/Restaurantesebares/3.3.png"
      }

      if(badges.length >= 50){
        $scope.anteriorimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/3.3.png';
        $scope.proximoRestaurantesebares = 10000;
        $scope.proximoimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/Super.png';
        document.getElementById("Restaurantesebares").src="img/badges/Categorias/Restaurantesebares/Super.png"
      }

    }else{
      $scope.auxnbadgeRestaurantesebares = 0;
        $scope.anteriorimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/0.png';
        $scope.proximoRestaurantesebares = 1;
        $scope.proximoimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/1.png';
      document.getElementById("Restaurantesebares").src="img/badges/Categorias/Restaurantesebares/0.png"
    }
  });

  $scope.aux.tag = "#Surf";
  $scope.auxnbadgeSurf = 0;
  $scope.proximoSurf = 0;
  $scope.proximoimgSurf = '';
  $scope.anteriorimgSurf = '';
  EventoService.getbadges($scope.aux).then(function(badges){
    //console.log("badges", badges);
    if(badges!="Error" && badges !="E"){
      $scope.auxnbadgeSurf = badges.length;
      if(badges.length == 0){
        $scope.anteriorimgSurf = 'img/badges/Categorias/Surf/0.png';
        $scope.proximoSurf = 1;
        $scope.proximoimgSurf = 'img/badges/Categorias/Surf/1.png';
        document.getElementById("Surf").src="img/badges/Categorias/Surf/0.png"
      }
      if(badges.length == 1){
        $scope.anteriorimgSurf = 'img/badges/Categorias/Surf/0.png';
        $scope.proximoSurf = 2;
        $scope.proximoimgSurf = 'img/badges/Categorias/Surf/1.1.png';
        document.getElementById("Surf").src="img/badges/Categorias/Surf/1.png"
      }
      if(badges.length == 2){
        $scope.anteriorimgSurf = 'img/badges/Categorias/Surf/1.png';
        $scope.proximoSurf = 3;
        $scope.proximoimgSurf = 'img/badges/Categorias/Surf/1.2.png';
        document.getElementById("Surf").src="img/badges/Categorias/Surf/1.1.png"
      }
      if(badges.length == 3){
        $scope.anteriorimgSurf = 'img/badges/Categorias/Surf/1.1.png';
        $scope.proximoSurf = 4;
        $scope.proximoimgSurf = 'img/badges/Categorias/Surf/1.3.png';
        document.getElementById("Surf").src="img/badges/Categorias/Surf/1.2.png"
      }
      if(badges.length == 4 || badges.length == 5){
        $scope.anteriorimgSurf = 'img/badges/Categorias/Surf/1.2.png';
        $scope.proximoSurf = 6;
        $scope.proximoimgSurf = 'img/badges/Categorias/Surf/2.png';
        document.getElementById("Surf").src="img/badges/Categorias/Surf/1.3.png"
      }

      if(badges.length == 6 || badges.length == 7){
        $scope.anteriorimgSurf = 'img/badges/Categorias/Surf/1.3.png';
        $scope.proximoSurf = 8;
        $scope.proximoimgSurf = 'img/badges/Categorias/Surf/2.1.png';
        document.getElementById("Surf").src="img/badges/Categorias/Surf/2.png"
      }
      if(badges.length == 8 || badges.length == 9){
        $scope.anteriorimgSurf = 'img/badges/Categorias/Surf/2.png';
        $scope.proximoSurf = 10;
        $scope.proximoimgSurf = 'img/badges/Categorias/Surf/2.2.png';
        document.getElementById("Surf").src="img/badges/Categorias/Surf/2.1.png"
      }
      if(badges.length == 10 || badges.length == 11){
        $scope.anteriorimgSurf = 'img/badges/Categorias/Surf/2.1.png';
        $scope.proximoSurf = 12;
        $scope.proximoimgSurf = 'img/badges/Categorias/Surf/2.3.png';
        document.getElementById("Surf").src="img/badges/Categorias/Surf/2.2.png"
      }
      if(badges.length == 12 || badges.length == 13 || badges.length == 14){
        $scope.anteriorimgSurf = 'img/badges/Categorias/Surf/2.2.png';
        $scope.proximoSurf = 15;
        $scope.proximoimgSurf = 'img/badges/Categorias/Surf/3.png';
        document.getElementById("Surf").src="img/badges/Categorias/Surf/2.3.png"
      }

      if(badges.length >= 15 && badges.length < 20 ){
        $scope.anteriorimgSurf = 'img/badges/Categorias/Surf/2.3.png';
        $scope.proximoSurf = 20;
        $scope.proximoimgSurf = 'img/badges/Categorias/Surf/3.1.png';
        document.getElementById("Surf").src="img/badges/Categorias/Surf/3.png"
      }
      if(badges.length >= 20 && badges.length < 22 ){
        $scope.anteriorimgSurf = 'img/badges/Categorias/Surf/3.png';
        $scope.proximoSurf = 25;
        $scope.proximoimgSurf = 'img/badges/Categorias/Surf/3.2.png';
        document.getElementById("Surf").src="img/badges/Categorias/Surf/3.1.png"
      }
      if(badges.length >= 25 && badges.length < 30 ){
        $scope.anteriorimgSurf = 'img/badges/Categorias/Surf/3.1.png';
        $scope.proximoSurf = 30;
        $scope.proximoimgSurf = 'img/badges/Categorias/Surf/3.3.png';
        document.getElementById("Surf").src="img/badges/Categorias/Surf/3.2.png"
      }
      if(badges.length >= 30 && badges.length < 50 ){
        $scope.anteriorimgSurf = 'img/badges/Categorias/Surf/3.2.png';
        $scope.proximoSurf = 50;
        $scope.proximoimgSurf = 'img/badges/Categorias/Surf/Super.png';
        document.getElementById("Surf").src="img/badges/Categorias/Surf/3.3.png"
      }

      if(badges.length >= 50){
        $scope.anteriorimgSurf = 'img/badges/Categorias/Surf/3.3.png';
        $scope.proximoSurf = 10000;
        $scope.proximoimgSurf = 'img/badges/Categorias/Surf/Super.png';
        document.getElementById("Surf").src="img/badges/Categorias/Surf/Super.png"
      }

    }else{
      $scope.auxnbadgeSurf = 0;
        $scope.anteriorimgSurf = 'img/badges/Categorias/Surf/0.png';
        $scope.proximoSurf = 1;
        $scope.proximoimgSurf = 'img/badges/Categorias/Surf/1.png';
      document.getElementById("Surf").src="img/badges/Categorias/Surf/0.png"
    }
  });

  $scope.aux.tag = "#Voluntariado";
  $scope.auxnbadgeVoluntariado = 0;
  $scope.proximoVoluntariado = 0;
  $scope.proximoimgVoluntariado = '';
  $scope.anteriorimgVoluntariado = '';
  EventoService.getbadges($scope.aux).then(function(badges){
    //console.log("Voluntariado", badges);
    if(badges!="Error" && badges !="E"){
      $scope.auxnbadgeVoluntariado = badges.length;
      if(badges.length == 0){
        $scope.anteriorimgVoluntariado = 'img/badges/Categorias/Voluntariado/0.png';
        $scope.proximoVoluntariado = 1;
        $scope.proximoimgVoluntariado = 'img/badges/Categorias/Voluntariado/1.png';
        document.getElementById("Voluntariado").src="img/badges/Categorias/Voluntariado/0.png"
      }
      if(badges.length == 1){
        $scope.anteriorimgVoluntariado = 'img/badges/Categorias/Voluntariado/0.png';
        $scope.proximoVoluntariado = 2;
        $scope.proximoimgVoluntariado = 'img/badges/Categorias/Voluntariado/1.1.png';
        document.getElementById("Voluntariado").src="img/badges/Categorias/Voluntariado/1.png"
      }
      if(badges.length == 2){
        $scope.anteriorimgVoluntariado = 'img/badges/Categorias/Voluntariado/1.png';
        $scope.proximoVoluntariado = 3;
        $scope.proximoimgVoluntariado = 'img/badges/Categorias/Voluntariado/1.2.png';
        document.getElementById("Voluntariado").src="img/badges/Categorias/Voluntariado/1.1.png"
      }
      if(badges.length == 3){
        $scope.anteriorimgVoluntariado = 'img/badges/Categorias/Voluntariado/1.1.png';
        $scope.proximoVoluntariado = 4;
        $scope.proximoimgVoluntariado = 'img/badges/Categorias/Voluntariado/1.3.png';
        document.getElementById("Voluntariado").src="img/badges/Categorias/Voluntariado/1.2.png"
      }
      if(badges.length == 4 || badges.length == 5){
        $scope.anteriorimgVoluntariado = 'img/badges/Categorias/Voluntariado/1.2.png';
        $scope.proximoVoluntariado = 6;
        $scope.proximoimgVoluntariado = 'img/badges/Categorias/Voluntariado/2.png';
        document.getElementById("Voluntariado").src="img/badges/Categorias/Voluntariado/1.3.png"
      }

      if(badges.length == 6 || badges.length == 7){
        $scope.anteriorimgVoluntariado = 'img/badges/Categorias/Voluntariado/1.3.png';
        $scope.proximoVoluntariado = 8;
        $scope.proximoimgVoluntariado = 'img/badges/Categorias/Voluntariado/2.1.png';
        document.getElementById("Voluntariado").src="img/badges/Categorias/Voluntariado/2.png"
      }
      if(badges.length == 8 || badges.length == 9){
        $scope.anteriorimgVoluntariado = 'img/badges/Categorias/Voluntariado/2.png';
        $scope.proximoVoluntariado = 10;
        $scope.proximoimgVoluntariado = 'img/badges/Categorias/Voluntariado/2.2.png';
        document.getElementById("Voluntariado").src="img/badges/Categorias/Voluntariado/2.1.png"
      }
      if(badges.length == 10 || badges.length == 11){
        $scope.anteriorimgVoluntariado = 'img/badges/Categorias/Voluntariado/2.1.png';
        $scope.proximoVoluntariado = 12;
        $scope.proximoimgVoluntariado = 'img/badges/Categorias/Voluntariado/2.3.png';
        document.getElementById("Voluntariado").src="img/badges/Categorias/Voluntariado/2.2.png"
      }
      if(badges.length == 12 || badges.length == 13 || badges.length == 14){
        $scope.anteriorimgVoluntariado = 'img/badges/Categorias/Voluntariado/2.2.png';
        $scope.proximoVoluntariado = 15;
        $scope.proximoimgVoluntariado = 'img/badges/Categorias/Voluntariado/3.png';
        document.getElementById("Voluntariado").src="img/badges/Categorias/Voluntariado/2.3.png"
      }

      if(badges.length >= 15 && badges.length < 20 ){
        $scope.anteriorimgVoluntariado = 'img/badges/Categorias/Voluntariado/2.3.png';
        $scope.proximoVoluntariado = 20;
        $scope.proximoimgVoluntariado = 'img/badges/Categorias/Voluntariado/3.1.png';
        document.getElementById("Voluntariado").src="img/badges/Categorias/Voluntariado/3.png"
      }
      if(badges.length >= 20 && badges.length < 22 ){
        $scope.anteriorimgVoluntariado = 'img/badges/Categorias/Voluntariado/3.png';
        $scope.proximoVoluntariado = 25;
        $scope.proximoimgVoluntariado = 'img/badges/Categorias/Voluntariado/3.2.png';
        document.getElementById("Voluntariado").src="img/badges/Categorias/Voluntariado/3.1.png"
      }
      if(badges.length >= 25 && badges.length < 30 ){
        $scope.anteriorimgVoluntariado = 'img/badges/Categorias/Voluntariado/3.1.png';
        $scope.proximoVoluntariado = 30;
        $scope.proximoimgVoluntariado = 'img/badges/Categorias/Voluntariado/3.3.png';
        document.getElementById("Voluntariado").src="img/badges/Categorias/Voluntariado/3.2.png"
      }
      if(badges.length >= 30 && badges.length < 50 ){
        $scope.anteriorimgVoluntariado = 'img/badges/Categorias/Voluntariado/3.2.png';
        $scope.proximoVoluntariado = 50;
        $scope.proximoimgVoluntariado = 'img/badges/Categorias/Voluntariado/Super.png';
        document.getElementById("Voluntariado").src="img/badges/Categorias/Voluntariado/3.3.png"
      }

      if(badges.length >= 50){
        $scope.anteriorimgVoluntariado = 'img/badges/Categorias/Voluntariado/3.3.png';
        $scope.proximoVoluntariado = 10000;
        $scope.proximoimgVoluntariado = 'img/badges/Categorias/Voluntariado/Super.png';
        document.getElementById("Voluntariado").src="img/badges/Categorias/Voluntariado/Super.png"
      }

    }else{
      $scope.auxnbadgeVoluntariado = 0;
        $scope.anteriorimgVoluntariado = 'img/badges/Categorias/Voluntariado/0.png';
        $scope.proximoVoluntariado = 1;
        $scope.proximoimgVoluntariado = 'img/badges/Categorias/Voluntariado/1.png';
      document.getElementById("Voluntariado").src="img/badges/Categorias/Voluntariado/0.png"
    }
  });
  // $scope.auxnbadgeQuantidadePersonalidades = 0;
  // $scope.proximoQuantidadePersonalidades = 0;
  // $scope.proximoimgQuantidadePersonalidades = '';
  // $scope.anteriorimgQuantidadePersonalidades = '';
  // EventoService.GetComments3($scope.user).then(function(badges){
  //   //console.log("GetComments3", badges.mal,"dasd", badges.ruins);
  //   if(badges.mal != "0,0,0,"){
  //     $scope.auxnbadgeQuantidadePersonalidades = badges.tamanho;
  //     if(badges.tamanho == 0){
  //       $scope.anteriorimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/0.png';
  //       $scope.proximoQuantidadePersonalidades = 1;
  //       $scope.proximoimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/1.png';

  //       document.getElementById("QuantidadePersonalidades").src="img/badges/Geral/Avaliacoes/QuantidadePersonalidades/0.png"
  //     }
  //     if(badges.tamanho >= 1 && badges.tamanho < 5){
  //       $scope.anteriorimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/0.png';
  //       $scope.proximoQuantidadePersonalidades = 5;
  //       $scope.proximoimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/1.1.png';
  //       document.getElementById("QuantidadePersonalidades").src="img/badges/Geral/Avaliacoes/QuantidadePersonalidades/1.png"
  //     }
  //     if(badges.tamanho >= 5 && badges.tamanho < 10){
  //       $scope.anteriorimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/1.png';
  //       $scope.proximoQuantidadePersonalidades = 10;
  //       $scope.proximoimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/1.2.png';
  //       document.getElementById("QuantidadePersonalidades").src="img/badges/Geral/Avaliacoes/QuantidadePersonalidades/1.1.png"
  //     }
  //     if(badges.tamanho >= 10 && badges.tamanho < 15){
  //       $scope.anteriorimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/1.1.png';
  //       $scope.proximoQuantidadePersonalidades = 15;
  //       $scope.proximoimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/1.3.png';
  //       document.getElementById("QuantidadePersonalidades").src="img/badges/Geral/Avaliacoes/QuantidadePersonalidades/1.2.png"
  //     }
  //     if(badges.tamanho >= 15 && badges.tamanho < 30){
  //       $scope.anteriorimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/1.2.png';
  //       $scope.proximoQuantidadePersonalidades = 30;
  //       $scope.proximoimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/2.png';
  //       document.getElementById("QuantidadePersonalidades").src="img/badges/Geral/Avaliacoes/QuantidadePersonalidades/1.3.png"
  //     }

  //     if(badges.tamanho >= 30 && badges.tamanho < 40){
  //       $scope.anteriorimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/1.3.png';
  //       $scope.proximoQuantidadePersonalidades = 40;
  //       $scope.proximoimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/2.1.png';
  //       document.getElementById("QuantidadePersonalidades").src="img/badges/Geral/Avaliacoes/QuantidadePersonalidades/2.png"
  //     }
  //     if(badges.tamanho >= 40 && badges.tamanho < 50){
  //       $scope.anteriorimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/2.png';
  //       $scope.proximoQuantidadePersonalidades = 50;
  //       $scope.proximoimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/2.2.png';
  //       document.getElementById("QuantidadePersonalidades").src="img/badges/Geral/Avaliacoes/QuantidadePersonalidades/2.1.png"
  //     }
  //     if(badges.tamanho >= 50 && badges.tamanho < 60){
  //       $scope.anteriorimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/2.1.png';
  //       $scope.proximoQuantidadePersonalidades = 60;
  //       $scope.proximoimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/2.3.png';
  //       document.getElementById("QuantidadePersonalidades").src="img/badges/Geral/Avaliacoes/QuantidadePersonalidades/2.2.png"
  //     }
  //     if(badges.tamanho >= 60 && badges.tamanho < 80){
  //       $scope.anteriorimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/2.2.png';
  //       $scope.proximoQuantidadePersonalidades = 80;
  //       $scope.proximoimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/3.png';
  //       document.getElementById("QuantidadePersonalidades").src="img/badges/Geral/Avaliacoes/QuantidadePersonalidades/2.3.png"
  //     }

  //     if(badges.tamanho >= 80 && badges.tamanho < 110 ){
  //       $scope.anteriorimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/2.3.png';
  //       $scope.proximoQuantidadePersonalidades = 110;
  //       $scope.proximoimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/3.1.png';
  //       document.getElementById("QuantidadePersonalidades").src="img/badges/Geral/Avaliacoes/QuantidadePersonalidades/3.png"
  //     }
  //     if(badges.tamanho >= 110 && badges.tamanho < 140 ){
  //       $scope.anteriorimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/3.png';
  //       $scope.proximoQuantidadePersonalidades = 140;
  //       $scope.proximoimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/3.2.png';
  //       document.getElementById("QuantidadePersonalidades").src="img/badges/Geral/Avaliacoes/QuantidadePersonalidades/3.1.png"
  //     }
  //     if(badges.tamanho >= 140 && badges.tamanho < 170 ){
  //       $scope.anteriorimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/3.1.png';
  //       $scope.proximoQuantidadePersonalidades = 170;
  //       $scope.proximoimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/3.3.png';
  //       document.getElementById("QuantidadePersonalidades").src="img/badges/Geral/Avaliacoes/QuantidadePersonalidades/3.2.png"
  //     }
  //     if(badges.tamanho >= 170 && badges.tamanho < 230 ){
  //       $scope.anteriorimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/3.2.png';
  //       $scope.proximoQuantidadePersonalidades = 230;
  //       $scope.proximoimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/Super.png';
  //       document.getElementById("QuantidadePersonalidades").src="img/badges/Geral/Avaliacoes/QuantidadePersonalidades/3.3.png"
  //     }

  //     if(badges.tamanho >= 230){
  //       $scope.anteriorimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/3.3.png';
  //       $scope.proximoQuantidadePersonalidades = 10000;
  //       $scope.proximoimgQuantidadePersonalidades = '';
  //       document.getElementById("QuantidadePersonalidades").src="img/badges/Geral/Avaliacoes/QuantidadePersonalidades/Super.png"
  //     }

  //   }else{
  //     document.getElementById("QuantidadePersonalidades").src="img/badges/Geral/Avaliacoes/QuantidadePersonalidades/0.png"
  //   }
  // });

  // $scope.auxnbadgeSmartDealer = 0;
  // $scope.proximoSmartDealer = 0;
  // $scope.proximoimgSmartDealer = '';
  // $scope.anteriorimgSmartDealer = '';
  // EventoService.getbadgesCriouComercio($scope.user).then(function(badges){
  //   //console.log("getbadgesCriouComercio", badges.length);
  //   if(badges!="Error" && badges !="E"){
  //     $scope.auxnbadgeSmartDealer = badges.length;
  //     if(badges.length == 0){
  //       $scope.anteriorimgSmartDealer = '"img/badges/Geral/Comercios/SmartDealer/0.png';
  //       $scope.proximoSmartDealer = 1;
  //       $scope.proximoimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/1.png';
  //       document.getElementById("SmartDealer").src="img/badges/Geral/Comercios/SmartDealer/0.png"
  //     }
  //     if(badges.length == 1){
  //       $scope.anteriorimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/0.png';
  //       $scope.proximoSmartDealer = 2;
  //       $scope.proximoimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/1.1.png';
  //       document.getElementById("SmartDealer").src="img/badges/Geral/Comercios/SmartDealer/1.png"
  //     }
  //     if(badges.length == 2){
  //       $scope.anteriorimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/1.png';
  //       $scope.proximoSmartDealer = 3;
  //       $scope.proximoimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/1.2.png';
  //       document.getElementById("SmartDealer").src="img/badges/Geral/Comercios/SmartDealer/1.1.png"
  //     }
  //     if(badges.length == 3){
  //       $scope.anteriorimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/1.1.png';
  //       $scope.proximoSmartDealer = 4;
  //       $scope.proximoimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/1.3.png';
  //       document.getElementById("SmartDealer").src="img/badges/Geral/Comercios/SmartDealer/1.2.png"
  //     }
  //     if(badges.length >= 4 && badges.length < 6){
  //       $scope.anteriorimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/1.2.png';
  //       $scope.proximoSmartDealer = 6;
  //       $scope.proximoimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/2.png';
  //       document.getElementById("SmartDealer").src="img/badges/Geral/Comercios/SmartDealer/1.3.png"
  //     }

  //     if(badges.length >= 6 && badges.length < 8){
  //       $scope.anteriorimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/1.3.png';
  //       $scope.proximoSmartDealer = 8;
  //       $scope.proximoimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/2.1.png';
  //       document.getElementById("SmartDealer").src="img/badges/Geral/Comercios/SmartDealer/2.png"
  //     }
  //     if(badges.length >= 8 && badges.length < 10){
  //       $scope.anteriorimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/2.png';
  //       $scope.proximoSmartDealer = 10;
  //       $scope.proximoimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/2.2.png';
  //       document.getElementById("SmartDealer").src="img/badges/Geral/Comercios/SmartDealer/2.1.png"
  //     }
  //     if(badges.length >= 10 && badges.length < 12){
  //       $scope.anteriorimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/2.1.png';
  //       $scope.proximoSmartDealer = 12;
  //       $scope.proximoimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/2.3.png';
  //       document.getElementById("SmartDealer").src="img/badges/Geral/Comercios/SmartDealer/2.2.png"
  //     }
  //     if(badges.length >= 12 && badges.length < 15){
  //       $scope.anteriorimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/2.2.png';
  //       $scope.proximoSmartDealer = 15;
  //       $scope.proximoimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/3.png';
  //       document.getElementById("SmartDealer").src="img/badges/Geral/Comercios/SmartDealer/2.3.png"
  //     }

  //     if(badges.length >= 15 && badges.length < 20 ){
  //       $scope.anteriorimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/2.3.png';
  //       $scope.proximoSmartDealer = 20;
  //       $scope.proximoimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/3.1.png';
  //       document.getElementById("SmartDealer").src="img/badges/Geral/Comercios/SmartDealer/3.png"
  //     }
  //     if(badges.length >= 20 && badges.length < 25 ){
  //       $scope.anteriorimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/3.png';
  //       $scope.proximoSmartDealer = 25;
  //       $scope.proximoimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/3.2.png';
  //       document.getElementById("SmartDealer").src="img/badges/Geral/Comercios/SmartDealer/3.1.png"
  //     }
  //     if(badges.length >= 25 && badges.length < 30 ){
  //       $scope.anteriorimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/3.1.png';
  //       $scope.proximoSmartDealer = 30;
  //       $scope.proximoimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/3.3.png';
  //       document.getElementById("SmartDealer").src="img/badges/Geral/Comercios/SmartDealer/3.2.png"
  //     }
  //     if(badges.length >= 30 && badges.length < 40 ){
  //       $scope.anteriorimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/3.2.png';
  //       $scope.proximoSmartDealer = 40;
  //       $scope.proximoimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/Super.png';
  //       document.getElementById("SmartDealer").src="img/badges/Geral/Comercios/SmartDealer/3.3.png"
  //     }

  //     if(badges.length >= 40){
  //       $scope.anteriorimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/3.3.png';
  //       $scope.proximoSmartDealer = 10000;
  //       $scope.proximoimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/Super.png';
  //       document.getElementById("SmartDealer").src="img/badges/Geral/Comercios/SmartDealer/Super.png"
  //     }

  //   }else{
  //     document.getElementById("SmartDealer").src="img/badges/Geral/Comercios/SmartDealer/0.png"
  //   }
  // });

  // $scope.auxnbadgeCriador = 0;
  // $scope.proximoCriador = 0;
  // $scope.proximoimgCriador = '';
  // $scope.anteriorimgCriador = '';
  // EventoService.GetCriados($scope.user).then(function(badges) {
  //   if(badges!="Error" && badges !="E"){
  //     $scope.auxnbadgeCriador = badges.length;
  //     if(badges.length == 0){
  //       $scope.anteriorimgCriador = 'img/badges/Geral/Eventos/Criador/0.png';
  //       $scope.proximoCriador = 1;
  //       $scope.proximoimgCriador = 'img/badges/Geral/Eventos/Criador/1.png';
  //       document.getElementById("Criador").src="img/badges/Geral/Eventos/Criador/0.png"
  //     }
  //     if(badges.length == 1){
  //       $scope.anteriorimgCriador = 'img/badges/Geral/Eventos/Criador/0.png';
  //       $scope.proximoCriador = 2;
  //       $scope.proximoimgCriador = 'img/badges/Geral/Eventos/Criador/1.1.png';
  //       document.getElementById("Criador").src="img/badges/Geral/Eventos/Criador/1.png"
  //     }
  //     if(badges.length == 2){
  //       $scope.anteriorimgCriador = 'img/badges/Geral/Eventos/Criador/1.png';
  //       $scope.proximoCriador = 3;
  //       $scope.proximoimgCriador = 'img/badges/Geral/Eventos/Criador/1.2.png';
  //       document.getElementById("Criador").src="img/badges/Geral/Eventos/Criador/1.1.png"
  //     }
  //     if(badges.length == 3){
  //       $scope.anteriorimgCriador = 'img/badges/Geral/Eventos/Criador/1.1.png';
  //       $scope.proximoCriador = 4;
  //       $scope.proximoimgCriador = 'img/badges/Geral/Eventos/Criador/1.3.png';
  //       document.getElementById("Criador").src="img/badges/Geral/Eventos/Criador/1.2.png"
  //     }
  //     if(badges.length >= 4 && badges.length < 6){
  //       $scope.anteriorimgCriador = 'img/badges/Geral/Eventos/Criador/1.2.png';
  //       $scope.proximoCriador = 6;
  //       $scope.proximoimgCriador = 'img/badges/Geral/Eventos/Criador/2.png';
  //       document.getElementById("Criador").src="img/badges/Geral/Eventos/Criador/1.3.png"
  //     }

  //     if(badges.length >= 6 && badges.length < 8){
  //       $scope.anteriorimgCriador = 'img/badges/Geral/Eventos/Criador/1.3.png';
  //       $scope.proximoCriador = 8;
  //       $scope.proximoimgCriador = 'img/badges/Geral/Eventos/Criador/2.1.png';
  //       document.getElementById("Criador").src="img/badges/Geral/Eventos/Criador/2.png"
  //     }
  //     if(badges.length >= 8 && badges.length < 10){
  //       $scope.anteriorimgCriador = 'img/badges/Geral/Eventos/Criador/2.png';
  //       $scope.proximoCriador = 10;
  //       $scope.proximoimgCriador = 'img/badges/Geral/Eventos/Criador/2.2.png';
  //       document.getElementById("Criador").src="img/badges/Geral/Eventos/Criador/2.1.png"
  //     }
  //     if(badges.length >= 10 && badges.length < 12){
  //       $scope.anteriorimgCriador = 'img/badges/Geral/Eventos/Criador/2.1.png';
  //       $scope.proximoCriador = 12;
  //       $scope.proximoimgCriador = 'img/badges/Geral/Eventos/Criador/2.3.png';
  //       document.getElementById("Criador").src="img/badges/Geral/Eventos/Criador/2.2.png"
  //     }
  //     if(badges.length >= 12 && badges.length < 15){
  //       $scope.anteriorimgCriador = 'img/badges/Geral/Eventos/Criador/2.2.png';
  //       $scope.proximoCriador = 15;
  //       $scope.proximoimgCriador = 'img/badges/Geral/Eventos/Criador/3.png';
  //       document.getElementById("Criador").src="img/badges/Geral/Eventos/Criador/2.3.png"
  //     }

  //     if(badges.length >= 15 && badges.length < 20 ){
  //       $scope.anteriorimgCriador = 'img/badges/Geral/Eventos/Criador/2.3.png';
  //       $scope.proximoCriador = 20;
  //       $scope.proximoimgCriador = 'img/badges/Geral/Eventos/Criador/3.1.png';
  //       document.getElementById("Criador").src="img/badges/Geral/Eventos/Criador/3.png"
  //     }
  //     if(badges.length >= 20 && badges.length < 25 ){
  //       $scope.anteriorimgCriador = 'img/badges/Geral/Eventos/Criador/3.png';
  //       $scope.proximoCriador = 25;
  //       $scope.proximoimgCriador = 'img/badges/Geral/Eventos/Criador/3.2.png';
  //       document.getElementById("Criador").src="img/badges/Geral/Eventos/Criador/3.1.png"
  //     }
  //     if(badges.length >= 25 && badges.length < 30 ){
  //       $scope.anteriorimgCriador = 'img/badges/Geral/Eventos/Criador/3.1.png';
  //       $scope.proximoCriador = 30;
  //       $scope.proximoimgCriador = 'img/badges/Geral/Eventos/Criador/3.3.png';
  //       document.getElementById("Criador").src="img/badges/Geral/Eventos/Criador/3.2.png"
  //     }
  //     if(badges.length >= 30 && badges.length < 40 ){
  //       $scope.anteriorimgCriador = 'img/badges/Geral/Eventos/Criador/3.2.png';
  //       $scope.proximoCriador = 40;
  //       $scope.proximoimgCriador = 'img/badges/Geral/Eventos/Criador/Super.png';
  //       document.getElementById("Criador").src="img/badges/Geral/Eventos/Criador/3.3.png"
  //     }

  //     if(badges.length >= 40){
  //       $scope.anteriorimgCriador = 'img/badges/Geral/Eventos/Criador/3.3.png';
  //       $scope.proximoCriador = 10000;
  //       $scope.proximoimgCriador = 'img/badges/Geral/Eventos/Criador/Super.png';
  //       document.getElementById("Criador").src="img/badges/Geral/Eventos/Criador/Super.png"
  //     }

  //   }else{
  //     document.getElementById("Criador").src="img/badges/Geral/Eventos/Criador/0.png"
  //   }
  // });

  // $scope.auxnbadgeParticipante = 0;
  // $scope.proximoParticipante = 0;
  // $scope.proximoimgParticipante = '';
  // $scope.anteriorimgParticipante = '';
  // EventoService.GetParticipanteBagde($scope.user).then(function(badges) {
  //   //console.log(badges.length,"GetParticipanteBagde")
  //   if(badges!="Error" && badges !="E"){
  //     $scope.auxnbadgeParticipante = badges.length;
  //     if(badges.length == 0){
  //       $scope.anteriorimgParticipante = 'img/badges/Geral/Eventos/Participante/0.png';
  //       $scope.proximoParticipante = 1;
  //       $scope.proximoimgParticipante = 'img/badges/Geral/Eventos/Participante/1.png';
  //       document.getElementById("Participante").src="img/badges/Geral/Eventos/Participante/0.png"
  //     }
  //     if(badges.length == 1){
  //       $scope.anteriorimgParticipante = 'img/badges/Geral/Eventos/Participante/0.png';
  //       $scope.proximoParticipante = 2;
  //       $scope.proximoimgParticipante = 'img/badges/Geral/Eventos/Participante/1.1.png';
  //       document.getElementById("Participante").src="img/badges/Geral/Eventos/Participante/1.png"
  //     }
  //     if(badges.length == 2){
  //       $scope.anteriorimgParticipante = 'img/badges/Geral/Eventos/Participante/1.png';
  //       $scope.proximoParticipante = 3;
  //       $scope.proximoimgParticipante = 'img/badges/Geral/Eventos/Participante/1.2.png';
  //       document.getElementById("Participante").src="img/badges/Geral/Eventos/Participante/1.1.png"
  //     }
  //     if(badges.length == 3){
  //       $scope.anteriorimgParticipante = 'img/badges/Geral/Eventos/Participante/1.1.png';
  //       $scope.proximoParticipante = 4;
  //       $scope.proximoimgParticipante = 'img/badges/Geral/Eventos/Participante/1.3.png';
  //       document.getElementById("Participante").src="img/badges/Geral/Eventos/Participante/1.2.png"
  //     }
  //     if(badges.length >= 4 && badges.length < 6){
  //       $scope.anteriorimgParticipante = 'img/badges/Geral/Eventos/Participante/1.2.png';
  //       $scope.proximoParticipante = 6;
  //       $scope.proximoimgParticipante = 'img/badges/Geral/Eventos/Participante/2.png';
  //       document.getElementById("Participante").src="img/badges/Geral/Eventos/Participante/1.3.png"
  //     }

  //     if(badges.length >= 6 && badges.length < 8){
  //       $scope.anteriorimgParticipante = 'img/badges/Geral/Eventos/Participante/1.3.png';
  //       $scope.proximoParticipante = 8;
  //       $scope.proximoimgParticipante = 'img/badges/Geral/Eventos/Participante/2.1.png';
  //       document.getElementById("Participante").src="img/badges/Geral/Eventos/Participante/2.png"
  //     }
  //     if(badges.length >= 8 && badges.length < 10){
  //       $scope.anteriorimgParticipante = 'img/badges/Geral/Eventos/Participante/2.png';
  //       $scope.proximoParticipante = 10;
  //       $scope.proximoimgParticipante = 'img/badges/Geral/Eventos/Participante/2.2.png';
  //       document.getElementById("Participante").src="img/badges/Geral/Eventos/Participante/2.1.png"
  //     }
  //     if(badges.length >= 10 && badges.length < 12){
  //       $scope.anteriorimgParticipante = 'img/badges/Geral/Eventos/Participante/2.1.png';
  //       $scope.proximoParticipante = 12;
  //       $scope.proximoimgParticipante = 'img/badges/Geral/Eventos/Participante/2.3.png';
  //       document.getElementById("Participante").src="img/badges/Geral/Eventos/Participante/2.2.png"
  //     }
  //     if(badges.length >= 12 && badges.length < 20){
  //       $scope.anteriorimgParticipante = 'img/badges/Geral/Eventos/Participante/2.2.png';
  //       $scope.proximoParticipante = 20;
  //       $scope.proximoimgParticipante = 'img/badges/Geral/Eventos/Participante/3.png';
  //       document.getElementById("Participante").src="img/badges/Geral/Eventos/Participante/2.3.png"
  //     }

  //     if(badges.length >= 20 && badges.length < 25 ){
  //       $scope.anteriorimgParticipante = 'img/badges/Geral/Eventos/Participante/2.3.png';
  //       $scope.proximoParticipante = 25;
  //       $scope.proximoimgParticipante = 'img/badges/Geral/Eventos/Participante/3.1.png';
  //       document.getElementById("Participante").src="img/badges/Geral/Eventos/Participante/3.png"
  //     }
  //     if(badges.length >= 25 && badges.length < 30 ){
  //       $scope.anteriorimgParticipante = 'img/badges/Geral/Eventos/Participante/3.png';
  //       $scope.proximoParticipante = 30;
  //       $scope.proximoimgParticipante = 'img/badges/Geral/Eventos/Participante/3.2.png';
  //       document.getElementById("Participante").src="img/badges/Geral/Eventos/Participante/3.1.png"
  //     }
  //     if(badges.length >= 30 && badges.length < 35 ){
  //       $scope.anteriorimgParticipante = 'img/badges/Geral/Eventos/Participante/3.1.png';
  //       $scope.proximoParticipante = 35;
  //       $scope.proximoimgParticipante = 'img/badges/Geral/Eventos/Participante/3.3.png';
  //       document.getElementById("Participante").src="img/badges/Geral/Eventos/Participante/3.2.png"
  //     }
  //     if(badges.length >= 35 && badges.length < 50 ){
  //       $scope.anteriorimgParticipante = 'img/badges/Geral/Eventos/Participante/3.2.png';
  //       $scope.proximoParticipante = 50;
  //       $scope.proximoimgParticipante = 'img/badges/Geral/Eventos/Participante/Super.png';
  //       document.getElementById("Participante").src="img/badges/Geral/Eventos/Participante/3.3.png"
  //     }

  //     if(badges.length >= 50){
  //       $scope.anteriorimgParticipante = 'img/badges/Geral/Eventos/Participante/3.3.png';
  //       $scope.proximoParticipante = 10000;
  //       $scope.proximoimgParticipante = 'img/badges/Geral/Eventos/Participante/Super.png';
  //       document.getElementById("Participante").src="img/badges/Geral/Eventos/Participante/Super.png"
  //     }

  //   }else{
  //     document.getElementById("Participante").src="img/badges/Geral/Eventos/Participante/0.png"
  //   }
  // });

  // $scope.auxnbadgeComentarios = 0;
  // $scope.proximoComentarios = 0;
  // $scope.proximoimgComentarios = '';
  // $scope.anteriorimgComentarios = '';
  // EventoService.GetBadgeComentarioPost($scope.user).then(function(badges) {
  //   //console.log(badges.length,"GetBadgeComentarioPost",badges )
  //   if(badges!="Error" && badges !="E"){
  //     $scope.auxnbadgeComentarios = badges.length;
  //     //console.log("faisdfniasidn", badges.length)
  //     if(badges.length == 0){
  //       $scope.anteriorimgComentarios = 'img/badges/Geral/Posts/Comentarios/0.png';
  //       $scope.proximoComentarios = 1;
  //       $scope.proximoimgComentarios = 'img/badges/Geral/Posts/Comentarios/1.png';
  //       document.getElementById("Comentarios").src="img/badges/Geral//Posts/Comentarios/0.png"
  //     }
  //     if(badges.length >= 1 && badges.length < 5){
  //       $scope.anteriorimgComentarios = 'img/badges/Geral/Posts/Comentarios/0.png';
  //       $scope.proximoComentarios = 5;
  //       $scope.proximoimgComentarios = 'img/badges/Geral/Posts/Comentarios/1.1.png';
  //       document.getElementById("Comentarios").src="img/badges/Geral/Posts/Comentarios/1.png"
  //     }
  //     if(badges.length >= 5 && badges.length < 10){
  //       $scope.anteriorimgComentarios = 'img/badges/Geral/Posts/Comentarios/1.png';
  //       $scope.proximoComentarios = 10;
  //       $scope.proximoimgComentarios = 'img/badges/Geral/Posts/Comentarios/1.2.png';
  //       document.getElementById("Comentarios").src="img/badges/Geral/Posts/Comentarios/1.1.png"
  //     }
  //     if(badges.length >= 10 && badges.length < 15){
  //       $scope.anteriorimgComentarios = 'img/badges/Geral/Posts/Comentarios/1.1.png';
  //       $scope.proximoComentarios = 15;
  //       $scope.proximoimgComentarios = 'img/badges/Geral/Posts/Comentarios/1.3.png';
  //       document.getElementById("Comentarios").src="img/badges/Geral/Posts/Comentarios/1.2.png"
  //     }
  //     if(badges.length >= 15 && badges.length < 30){
  //       $scope.anteriorimgComentarios = 'img/badges/Geral/Posts/Comentarios/1.2.png';
  //       $scope.proximoComentarios = 30;
  //       $scope.proximoimgComentarios = 'img/badges/Geral/Posts/Comentarios/2.png';
  //       console.log("faisdfniasidn")
  //       document.getElementById("Comentarios").src="img/badges/Geral/Posts/Comentarios/1.3.png"
  //     }

  //     if(badges.length >= 30 && badges.length < 40){
  //       $scope.anteriorimgComentarios = 'img/badges/Geral/Posts/Comentarios/1.3.png';
  //       $scope.proximoComentarios = 40;
  //       $scope.proximoimgComentarios = 'img/badges/Geral/Posts/Comentarios/2.1.png';
  //       document.getElementById("Comentarios").src="img/badges/Geral/Posts/Comentarios/2.png"
  //     }
  //     if(badges.length >= 40 && badges.length < 50){
  //       $scope.anteriorimgComentarios = 'img/badges/Geral/Posts/Comentarios/2.png';
  //       $scope.proximoComentarios = 50;
  //       $scope.proximoimgComentarios = 'img/badges/Geral/Posts/Comentarios/2.2.png';
  //       document.getElementById("Comentarios").src="img/badges/Geral/Posts/Comentarios/2.1.png"
  //     }
  //     if(badges.length >= 50 && badges.length < 60){
  //       $scope.anteriorimgComentarios = 'img/badges/Geral/Posts/Comentarios/2.1.png';
  //       $scope.proximoComentarios = 60;
  //       $scope.proximoimgComentarios = 'img/badges/Geral/Posts/Comentarios/2.3.png';
  //       document.getElementById("Comentarios").src="img/badges/Geral/Posts/Comentarios/2.2.png"
  //     }
  //     if(badges.length >= 60 && badges.length < 80){
  //       $scope.anteriorimgComentarios = 'img/badges/Geral/Posts/Comentarios/2.2.png';
  //       $scope.proximoComentarios = 80;
  //       $scope.proximoimgComentarios = 'img/badges/Geral/Posts/Comentarios/3.png';
  //       document.getElementById("Comentarios").src="img/badges/Geral/Posts/Comentarios/2.3.png"
  //     }

  //     if(badges.length >= 80 && badges.length < 110 ){
  //       $scope.anteriorimgComentarios = 'img/badges/Geral/Posts/Comentarios/2.3.png';
  //       $scope.proximoComentarios = 110;
  //       $scope.proximoimgComentarios = 'img/badges/Geral/Posts/Comentarios/3.1.png';
  //       document.getElementById("Comentarios").src="img/badges/Geral/Posts/Comentarios/3.png"
  //     }
  //     if(badges.length >= 110 && badges.length < 140 ){
  //       $scope.anteriorimgComentarios = 'img/badges/Geral/Posts/Comentarios/3.png';
  //       $scope.proximoComentarios = 140;
  //       $scope.proximoimgComentarios = 'img/badges/Geral/Posts/Comentarios/3.2.png';
  //       document.getElementById("Comentarios").src="img/badges/Geral/Posts/Comentarios/3.1.png"
  //     }
  //     if(badges.length >= 140 && badges.length < 170 ){
  //       $scope.anteriorimgComentarios = 'img/badges/Geral/Posts/Comentarios/3.1.png';
  //       $scope.proximoComentarios = 170;
  //       $scope.proximoimgComentarios = 'img/badges/Geral/Posts/Comentarios/3.3.png';
  //       document.getElementById("Comentarios").src="img/badges/Geral/Posts/Comentarios/3.2.png"
  //     }
  //     if(badges.length >= 170 && badges.length < 230 ){
  //       $scope.anteriorimgComentarios = 'img/badges/Geral/Posts/Comentarios/3.2.png';
  //       $scope.proximoComentarios = 230;
  //       $scope.proximoimgComentarios = 'img/badges/Geral/Posts/Comentarios/Super.png';
  //       document.getElementById("Comentarios").src="img/badges/Geral/Posts/Comentarios/3.3.png"
  //     }

  //     if(badges.length >= 230){
  //       $scope.anteriorimgComentarios = 'img/badges/Geral/Posts/Comentarios/3.3.png';
  //       $scope.proximoComentarios = 10000;
  //       $scope.proximoimgComentarios = 'img/badges/Geral/Posts/Comentarios/Super.png';
  //       document.getElementById("Comentarios").src="img/badges/Geral/Posts/Comentarios/Super.png"
  //     }

  //   }else{
  //     document.getElementById("Comentarios").src="img/badges/Geral/Posts/Comentarios/0.png"
  //   }
  // });

  // $scope.auxnbadgeOriginalPoster = 0;
  // $scope.proximoOriginalPoster = 0;
  // $scope.proximoimgOriginalPoster = '';
  // $scope.anteriorimgOriginalPoster = '';
  // EventoService.GetFeedMeusPost($scope.user).then(function(badges) {
  //   //console.log(badges.length,"GetBadgeComentarioPost",badges )
  //   if(badges!="Error" && badges !="E"){
  //     $scope.auxnbadgeOriginalPoster = badges.length;
  //     //console.log("faisdfniasidn", badges.length)
  //     if(badges.length == 0){
  //       $scope.anteriorimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/0.png';
  //       $scope.proximoOriginalPoster = 1;
  //       $scope.proximoimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/1.png';
  //       document.getElementById("OriginalPoster").src="img/badges/Geral//Posts/OriginalPoster/0.png"
  //     }
  //     if(badges.length >= 1 && badges.length < 3){
  //       $scope.anteriorimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/0.png';
  //       $scope.proximoOriginalPoster = 3;
  //       $scope.proximoimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/1.1.png';
  //       document.getElementById("OriginalPoster").src="img/badges/Geral/Posts/OriginalPoster/1.png"
  //     }
  //     if(badges.length >= 3 && badges.length < 5){
  //       $scope.anteriorimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/1.png';
  //       $scope.proximoOriginalPoster = 5;
  //       $scope.proximoimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/1.2.png';
  //       document.getElementById("OriginalPoster").src="img/badges/Geral/Posts/OriginalPoster/1.1.png"
  //     }
  //     if(badges.length >= 5 && badges.length < 7){
  //       $scope.anteriorimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/1.1.png';
  //       $scope.proximoOriginalPoster = 7;
  //       $scope.proximoimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/1.3.png';
  //       document.getElementById("OriginalPoster").src="img/badges/Geral/Posts/OriginalPoster/1.2.png"
  //     }
  //     if(badges.length >= 7 && badges.length < 10){
  //       $scope.anteriorimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/1.2.png';
  //       $scope.proximoOriginalPoster = 10;
  //       $scope.proximoimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/2.png';
       
  //       document.getElementById("OriginalPoster").src="img/badges/Geral/Posts/OriginalPoster/1.3.png"
  //     }

  //     if(badges.length >= 10 && badges.length < 15){
  //       $scope.anteriorimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/1.3.png';
  //       $scope.proximoOriginalPoster = 15;
  //       $scope.proximoimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/2.1.png';
  //       document.getElementById("OriginalPoster").src="img/badges/Geral/Posts/OriginalPoster/2.png"
  //     }
  //     if(badges.length >= 15 && badges.length < 20){
  //       $scope.anteriorimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/2.png';
  //       $scope.proximoOriginalPoster = 20;
  //       $scope.proximoimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/2.2.png';
  //       document.getElementById("OriginalPoster").src="img/badges/Geral/Posts/OriginalPoster/2.1.png"
  //     }
  //     if(badges.length >= 20 && badges.length < 25){
  //       $scope.anteriorimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/2.1.png';
  //       $scope.proximoOriginalPoster = 25;
  //       $scope.proximoimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/2.3.png';
  //       document.getElementById("OriginalPoster").src="img/badges/Geral/Posts/OriginalPoster/2.2.png"
  //     }
  //     if(badges.length >= 25 && badges.length < 35){
  //       $scope.anteriorimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/2.2.png';
  //       $scope.proximoOriginalPoster = 35;
  //       $scope.proximoimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/3.png';
  //       document.getElementById("OriginalPoster").src="img/badges/Geral/Posts/OriginalPoster/2.3.png"
  //     }

  //     if(badges.length >= 35 && badges.length < 45 ){
  //       $scope.anteriorimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/2.3.png';
  //       $scope.proximoOriginalPoster = 45;
  //       $scope.proximoimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/3.1.png';
  //       document.getElementById("OriginalPoster").src="img/badges/Geral/Posts/OriginalPoster/3.png"
  //     }
  //     if(badges.length >= 45 && badges.length < 55 ){
  //       $scope.anteriorimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/3.png';
  //       $scope.proximoOriginalPoster = 55;
  //       $scope.proximoimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/3.2.png';
  //       document.getElementById("OriginalPoster").src="img/badges/Geral/Posts/OriginalPoster/3.1.png"
  //     }
  //     if(badges.length >= 55 && badges.length < 65 ){
  //       $scope.anteriorimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/3.1.png';
  //       $scope.proximoOriginalPoster = 65;
  //       $scope.proximoimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/3.3.png';
  //       document.getElementById("OriginalPoster").src="img/badges/Geral/Posts/OriginalPoster/3.2.png"
  //     }
  //     if(badges.length >= 65 && badges.length < 80 ){
  //       $scope.anteriorimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/3.2.png';
  //       $scope.proximoOriginalPoster = 80;
  //       $scope.proximoimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/Super.png';
  //       document.getElementById("OriginalPoster").src="img/badges/Geral/Posts/OriginalPoster/3.3.png"
  //     }

  //     if(badges.length >= 80){
  //       $scope.anteriorimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/3.3.png';
  //       $scope.proximoOriginalPoster = 10000;
  //       $scope.proximoimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/Super.png';
  //       document.getElementById("OriginalPoster").src="img/badges/Geral/Posts/OriginalPoster/Super.png"
  //     }

  //   }else{
  //     document.getElementById("OriginalPoster").src="img/badges/Geral/Posts/OriginalPoster/0.png"
  //   }
  // });
  
  // $scope.auxnbadgeUpvotes = 0;
  // $scope.proximoUpvotes = 0;
  // $scope.proximoimgUpvotes = '';
  // $scope.anteriorimgUpvotes = '';
  // EventoService.GetBadgeUpvote($scope.user).then(function(badges) {
  //   console.log(badges.length,"GetBadgeComentarioPost",badges )
  //   if(badges!="Error" && badges !="E"){
  //     $scope.auxnbadgeUpvotes = badges.length;
  //     console.log("faisdfniasidn", badges.length)
  //     if(badges.length == 0){
  //       $scope.anteriorimgUpvotes = 'img/badges/Geral/Posts/Upvotes/0.png';
  //       $scope.proximoUpvotes = 1;
  //       $scope.proximoimgUpvotes = 'img/badges/Geral/Posts/Upvotes/1.png';
  //       document.getElementById("Upvotes").src="img/badges/Geral//Posts/Upvotes/0.png"
  //     }
  //     if(badges.length >= 1 && badges.length < 5){
  //       $scope.anteriorimgUpvotes = 'img/badges/Geral/Posts/Upvotes/0.png';
  //       $scope.proximoUpvotes = 5;
  //       $scope.proximoimgUpvotes = 'img/badges/Geral/Posts/Upvotes/1.1.png';
  //       document.getElementById("Upvotes").src="img/badges/Geral/Posts/Upvotes/1.png"
  //     }
  //     if(badges.length >= 5 && badges.length < 10){
  //       $scope.anteriorimgUpvotes = 'img/badges/Geral/Posts/Upvotes/1.png';
  //       $scope.proximoUpvotes = 10;
  //       $scope.proximoimgUpvotes = 'img/badges/Geral/Posts/Upvotes/1.2.png';
  //       document.getElementById("Upvotes").src="img/badges/Geral/Posts/Upvotes/1.1.png"
  //     }
  //     if(badges.length >= 10 && badges.length < 15){
  //       $scope.anteriorimgUpvotes = 'img/badges/Geral/Posts/Upvotes/1.1.png';
  //       $scope.proximoUpvotes = 15;
  //       $scope.proximoimgUpvotes = 'img/badges/Geral/Posts/Upvotes/1.3.png';
  //       document.getElementById("Upvotes").src="img/badges/Geral/Posts/Upvotes/1.2.png"
  //     }
  //     if(badges.length >= 15 && badges.length < 25){
  //       $scope.anteriorimgUpvotes = 'img/badges/Geral/Posts/Upvotes/1.2.png';
  //       $scope.proximoUpvotes = 25;
  //       $scope.proximoimgUpvotes = 'img/badges/Geral/Posts/Upvotes/2.png';
       
  //       document.getElementById("Upvotes").src="img/badges/Geral/Posts/Upvotes/1.3.png"
  //     }

  //     if(badges.length >= 25 && badges.length < 35){
  //       $scope.anteriorimgUpvotes = 'img/badges/Geral/Posts/Upvotes/1.3.png';
  //       $scope.proximoUpvotes = 35;
  //       $scope.proximoimgUpvotes = 'img/badges/Geral/Posts/Upvotes/2.1.png';
  //       document.getElementById("Upvotes").src="img/badges/Geral/Posts/Upvotes/2.png"
  //     }
  //     if(badges.length >= 35 && badges.length < 45){
  //       $scope.anteriorimgUpvotes = 'img/badges/Geral/Posts/Upvotes/2.png';
  //       $scope.proximoUpvotes = 45;
  //       $scope.proximoimgUpvotes = 'img/badges/Geral/Posts/Upvotes/2.2.png';
  //       document.getElementById("Upvotes").src="img/badges/Geral/Posts/Upvotes/2.1.png"
  //     }
  //     if(badges.length >= 45 && badges.length < 55){
  //       $scope.anteriorimgUpvotes = 'img/badges/Geral/Posts/Upvotes/2.1.png';
  //       $scope.proximoUpvotes = 55;
  //       $scope.proximoimgUpvotes = 'img/badges/Geral/Posts/Upvotes/2.3.png';
  //       document.getElementById("Upvotes").src="img/badges/Geral/Posts/Upvotes/2.2.png"
  //     }
  //     if(badges.length >= 55 && badges.length < 80){
  //       $scope.anteriorimgUpvotes = 'img/badges/Geral/Posts/Upvotes/2.2.png';
  //       $scope.proximoUpvotes = 80;
  //       $scope.proximoimgUpvotes = 'img/badges/Geral/Posts/Upvotes/3.png';
  //       document.getElementById("Upvotes").src="img/badges/Geral/Posts/Upvotes/2.3.png"
  //     }

  //     if(badges.length >= 80 && badges.length < 100 ){
  //       $scope.anteriorimgUpvotes = 'img/badges/Geral/Posts/Upvotes/2.3.png';
  //       $scope.proximoUpvotes = 100;
  //       $scope.proximoimgUpvotes = 'img/badges/Geral/Posts/Upvotes/3.1.png';
  //       document.getElementById("Upvotes").src="img/badges/Geral/Posts/Upvotes/3.png"
  //     }
  //     if(badges.length >= 100 && badges.length < 120 ){
  //       $scope.anteriorimgUpvotes = 'img/badges/Geral/Posts/Upvotes/3.png';
  //       $scope.proximoUpvotes = 120;
  //       $scope.proximoimgUpvotes = 'img/badges/Geral/Posts/Upvotes/3.2.png';
  //       document.getElementById("Upvotes").src="img/badges/Geral/Posts/Upvotes/3.1.png"
  //     }
  //     if(badges.length >= 120 && badges.length < 140 ){
  //       $scope.anteriorimgUpvotes = 'img/badges/Geral/Posts/Upvotes/3.1.png';
  //       $scope.proximoUpvotes = 140;
  //       $scope.proximoimgUpvotes = 'img/badges/Geral/Posts/Upvotes/3.3.png';
  //       document.getElementById("Upvotes").src="img/badges/Geral/Posts/Upvotes/3.2.png"
  //     }
  //     if(badges.length >= 140 && badges.length < 200 ){
  //       $scope.anteriorimgUpvotes = 'img/badges/Geral/Posts/Upvotes/3.2.png';
  //       $scope.proximoUpvotes = 200;
  //       $scope.proximoimgUpvotes = 'img/badges/Geral/Posts/Upvotes/Super.png';
  //       document.getElementById("Upvotes").src="img/badges/Geral/Posts/Upvotes/3.3.png"
  //     }

  //     if(badges.length >= 200){
  //       $scope.anteriorimgUpvotes = 'img/badges/Geral/Posts/Upvotes/3.3.png';
  //       $scope.proximoUpvotes = 100000;
  //       $scope.proximoimgUpvotes = 'img/badges/Geral/Posts/Upvotes/Super.png';
  //       document.getElementById("Upvotes").src="img/badges/Geral/Posts/Upvotes/Super.png"
  //     }

  //   }else{
  //     document.getElementById("Upvotes").src="img/badges/Geral/Posts/Upvotes/0.png"
  //   }
  // });

  $scope.naotembadgescomercio = ""
  EventoService.GetComercioFinalizado($scope.user).then(function(badges) {  //console.log(badges.length,"GetBadgeComentarioPost",badges )
    if(badges!="error" && badges !="e"){
      console.log("faisdfniasidn", badges.length)
      for(var i =0 ;i<badges.length;i++){
        if(badges[i].idcomercio == '53'){
          if(badges[i].n == '1'){
            document.getElementById("Paintball").src="img/badges/Comercios/Paintball/1.png"
          }
          if(badges[i].n == '2'){
            document.getElementById("Paintball").src="img/badges/Comercios/Paintball/2.png"
          }
          if(badges[i].n >= '3'){
            document.getElementById("Paintball").src="img/badges/Comercios/Paintball/3.png"
          }
        }
        if(badges[i].idcomercio == '222'){
          if(badges[i].n == '1'){
            document.getElementById("BarcoPirataItapema").src="img/badges/Comercios/BarcoPirataItapema/1.png"
          }
          if(badges[i].n == '2'){
            document.getElementById("BarcoPirataItapema").src="img/badges/Comercios/BarcoPirataItapema/2.png"
          }
          if(badges[i].n >= '3'){
            document.getElementById("BarcoPirataItapema").src="img/badges/Comercios/BarcoPirataItapema/3.png"
          }
        }
        if(badges[i].idcomercio == '223'){
          if(badges[i].n == '1'){
            document.getElementById("BCWalkingTour").src="img/badges/Comercios/BCWalkingTour/1.png"
          }
          if(badges[i].n == '2'){
            document.getElementById("BCWalkingTour").src="img/badges/Comercios/BCWalkingTour/2.png"
          }
          if(badges[i].n >= '3'){
            document.getElementById("BCWalkingTour").src="img/badges/Comercios/BCWalkingTour/3.png"
          }
        }
        if(badges[i].idcomercio == '225'){
          if(badges[i].n == '1'){
            document.getElementById("BravaBeachSports").src="img/badges/Comercios/BravaBeachSports/1.png"
          }
          if(badges[i].n == '2'){
            document.getElementById("BravaBeachSports").src="img/badges/Comercios/BravaBeachSports/2.png"
          }
          if(badges[i].n >= '3'){
            document.getElementById("BravaBeachSports").src="img/badges/Comercios/BravaBeachSports/3.png"
          }
        }
        if(badges[i].idcomercio == '227'){
          if(badges[i].n == '1'){
            document.getElementById("MVBTennisPaddel").src="img/badges/Comercios/MVBTennisPaddel/1.png"
          }
          if(badges[i].n == '2'){
            document.getElementById("MVBTennisPaddel").src="img/badges/Comercios/MVBTennisPaddel/2.png"
          }
          if(badges[i].n >= '3'){
            document.getElementById("MVBTennisPaddel").src="img/badges/Comercios/MVBTennisPaddel/3.png"
          }
        }
        
        if(badges[i].idcomercio == '228'){
          if(badges[i].n == '1'){
            document.getElementById("TriboDaÁgua").src="img/badges/Comercios/TriboDaÁgua/1.png"
          }
          if(badges[i].n == '2'){
            document.getElementById("TriboDaÁgua").src="img/badges/Comercios/TriboDaÁgua/2.png"
          }
          if(badges[i].n >= '3'){
            document.getElementById("TriboDaÁgua").src="img/badges/Comercios/TriboDaÁgua/3.png"
          }
        }
      }
            

    }else{
      $scope.naotembadgescomercio = "Ainda não há nenhuma conquista em locais parceiros"
    }
  });

   $scope.naotembadgesgeral = ""
  $scope.auxnbadgeNumberOneHExa = 0;
  $scope.proximoNumberOneHExa = 0;
  $scope.proximoimgNumberOneHExa = '';
  $scope.anteriorimgNumberOneHExa = '';
  EventoService.getusuario($scope.user).then(function(user) {
      $scope.user = user;
      if(user.numcodigo){
        if(user.numcodigo == '0'){
          $scope.auxnbadgeNumberOneHExa = 0;
          $scope.anteriorimgNumberOneHExa = 'img/egg_0.png';
          $scope.proximoNumberOneHExa = 1;
          $scope.proximoimgNumberOneHExa = 'img/egg_1.png';
          document.getElementById("NumberOneHExa").src="img/egg_0.png";
        }
        if(user.numcodigo == '1'){
          $scope.auxnbadgeNumberOneHExa = 1;
          $scope.anteriorimgNumberOneHExa = 'img/egg_0.png';
          $scope.proximoNumberOneHExa = 2;
          $scope.proximoimgNumberOneHExa = 'img/egg_2.png';
          document.getElementById("NumberOneHExa").src="img/egg_1.png";
        }
        if(user.numcodigo == '2'){
          $scope.auxnbadgeNumberOneHExa = 2;
          $scope.anteriorimgNumberOneHExa = 'img/egg_1.png';
          $scope.proximoNumberOneHExa = 3;
          $scope.proximoimgNumberOneHExa = 'img/NumberOneHExa.png';
          document.getElementById("NumberOneHExa").src="img/egg_2.png";
        }
        if(parseInt(user.numcodigo) >= 3){
          $scope.auxnbadgeNumberOneHExa = 3;
          $scope.anteriorimgNumberOneHExa = 'img/egg_2.png';
          $scope.proximoNumberOneHExa = 1000;
          $scope.proximoimgNumberOneHExa = 'img/NumberOneHExa.png';
          document.getElementById("NumberOneHExa").src="img/NumberOneHExa.png";
        }
        if(parseInt(user.numcodigo) < 0){
          $scope.auxnbadgeNumberOneHExa = 3;
          $scope.anteriorimgNumberOneHExa = 'img/egg_2.png';
          $scope.proximoNumberOneHExa = 1000;
          $scope.proximoimgNumberOneHExa = 'img/NumberOneHExa.png';
          document.getElementById("NumberOneHExa").src="img/NumberOneHExa.png";
        } 
      }else{
        $scope.naotembadgesgeral = "Ainda não há nenhuma conquista aqui"
      }
      

  });

  $scope.entraBadge = function(badge){
    console.log("badge",badge);
    $scope.badge = {};
    if(badge == 'QuantidadePersonalidades'){
      $scope.badge.titulo = 'Self Awareness';
      $scope.badge.texto = 'Quanto mais avaliações referentes à nossa personalidade, mais entendemos como as pessoas nos veem. Isso pode ser útil para nos conhecermos melhor!';
      $scope.badge.numeroatual = $scope.auxnbadgeQuantidadePersonalidades;
      $scope.badge.numeroproximo = $scope.proximoQuantidadePersonalidades
      $scope.badge.imgatual = document.getElementById("QuantidadePersonalidades").src;
      $scope.badge.imganterior = $scope.anteriorimgQuantidadePersonalidades;
      $scope.badge.imgproximo = $scope.proximoimgQuantidadePersonalidades;
      formBadge.updateForm($scope.badge);
      $state.go('tabsController.badgesexplicaPerfilFollow');
    }
    if(badge == 'SmartDealer'){
      $scope.badge.titulo = 'Smart Dealer';
      $scope.badge.texto = 'Um Din Din Baggy é inteligente, ele cria eventos que oferecem recompensas para gastar menos fazendo mais.';
      $scope.badge.numeroatual = $scope.auxnbadgeSmartDealer;
      $scope.badge.numeroproximo = $scope.proximoSmartDealer
      $scope.badge.imgatual = document.getElementById("SmartDealer").src;
      $scope.badge.imganterior = $scope.anteriorimgSmartDealer;
      $scope.badge.imgproximo = $scope.proximoimgSmartDealer;
      formBadge.updateForm($scope.badge);
      $state.go('tabsController.badgesexplicaPerfilFollow');
    }
    if(badge == 'Criador'){
      $scope.badge.titulo = 'Creator';
      $scope.badge.texto = 'Cria eventos no app';
      $scope.badge.numeroatual = $scope.auxnbadgeCriador;
      $scope.badge.numeroproximo = $scope.proximoCriador
      $scope.badge.imgatual = document.getElementById("Criador").src;
      $scope.badge.imganterior = $scope.anteriorimgCriador;
      $scope.badge.imgproximo = $scope.proximoimgCriador;
      formBadge.updateForm($scope.badge);
      $state.go('tabsController.badgesexplicaPerfilFollow');
    }
    if(badge == 'Participante'){
      $scope.badge.titulo = 'Story Maker';
      $scope.badge.texto = 'Participa de eventos no app';
      $scope.badge.numeroatual = $scope.auxnbadgeParticipante;
      $scope.badge.numeroproximo = $scope.proximoParticipante;
      $scope.badge.imgatual = document.getElementById("Participante").src;
      $scope.badge.imganterior = $scope.anteriorimgParticipante;
      $scope.badge.imgproximo = $scope.proximoimgParticipante;
      formBadge.updateForm($scope.badge);
      $state.go('tabsController.badgesexplicaPerfilFollow');
    }
    if(badge == 'Comentarios'){
      $scope.badge.titulo = 'Community Activist';
      $scope.badge.texto = 'Um(a) ativista da sua comunidade local através de comentários em posts';
      $scope.badge.numeroatual = $scope.auxnbadgeComentarios;
      $scope.badge.numeroproximo = $scope.proximoComentarios
      $scope.badge.imgatual = document.getElementById("Comentarios").src;
      $scope.badge.imganterior = $scope.anteriorimgComentarios;
      $scope.badge.imgproximo = $scope.proximoimgComentarios;
      formBadge.updateForm($scope.badge);
      $state.go('tabsController.badgesexplicaPerfilFollow');
    }
    if(badge == 'OriginalPoster'){
      $scope.badge.titulo = 'Original Poster';
      $scope.badge.texto = 'Cria engajamento da sua comunidade local através da criação de posts';
      $scope.badge.numeroatual = $scope.auxnbadgeOriginalPoster;
      $scope.badge.numeroproximo = $scope.proximoOriginalPoster
      $scope.badge.imgatual = document.getElementById("OriginalPoster").src;
      $scope.badge.imganterior = $scope.anteriorimgOriginalPoster;
      $scope.badge.imgproximo = $scope.proximoimgOriginalPoster;
      formBadge.updateForm($scope.badge);
      $state.go('tabsController.badgesexplicaPerfilFollow');
    }
    if(badge == 'Upvotes'){
      $scope.badge.titulo = 'Community Supporter';
      $scope.badge.texto = 'Um suporte da sua comunidade local que ajuda a filtrar os bons posts dos ruins através de upvotes';
      $scope.badge.numeroatual = $scope.auxnbadgeUpvotes;
      $scope.badge.numeroproximo = $scope.proximoUpvotes
      $scope.badge.imgatual = document.getElementById("Upvotes").src;
      $scope.badge.imganterior = $scope.anteriorimgUpvotes;
      $scope.badge.imgproximo = $scope.proximoimgUpvotes;
      formBadge.updateForm($scope.badge);
      $state.go('tabsController.badgesexplicaPerfilFollow');
    }
    if(badge == 'NumberOneHExa'){
      $scope.badge.titulo = 'Amigo que chama';
      $scope.badge.texto = 'Convida amigos quando descobre um app novo';
      $scope.badge.numeroatual = $scope.auxnbadgeNumberOneHExa;
      $scope.badge.numeroproximo = $scope.proximoNumberOneHExa
      $scope.badge.imgatual = document.getElementById("NumberOneHExa").src;
      $scope.badge.imganterior = $scope.anteriorimgNumberOneHExa;
      $scope.badge.imgproximo = $scope.proximoimgNumberOneHExa;
      formBadge.updateForm($scope.badge);
      $state.go('tabsController.badgesexplicaPerfilFollow');
    }
    if(badge == 'ArteeCultura'){
      $scope.badge.titulo = 'Cult';
      $scope.badge.texto = 'Você participou de eventos com #ArteeCultura';
      $scope.badge.numeroatual = $scope.auxnbadgeArteeCultura;
      $scope.badge.numeroproximo = $scope.proximoArteeCultura
      $scope.badge.imgatual = document.getElementById("ArteeCultura").src;
      $scope.badge.imganterior = $scope.anteriorimgArteeCultura;
      $scope.badge.imgproximo = $scope.proximoimgArteeCultura;
      formBadge.updateForm($scope.badge);
      $state.go('tabsController.badgesexplicaPerfilFollow');
    }
    if(badge == 'Ciclismo'){
      $scope.badge.titulo = 'Pedal';
      $scope.badge.texto = 'Você participou de eventos com #Ciclismo';
      $scope.badge.numeroatual = $scope.auxnbadgeCiclismo;
      $scope.badge.numeroproximo = $scope.proximoCiclismo
      $scope.badge.imgatual = document.getElementById("Ciclismo").src;
      $scope.badge.imganterior = $scope.anteriorimgCiclismo;
      $scope.badge.imgproximo = $scope.proximoimgCiclismo;
      formBadge.updateForm($scope.badge);
      $state.go('tabsController.badgesexplicaPerfilFollow');
    }
    if(badge == 'Conversa'){
      $scope.badge.titulo = 'Falador(a)';
      $scope.badge.texto = 'Você participou de eventos com #Conversa';
      $scope.badge.numeroatual = $scope.auxnbadgeConversa;
      $scope.badge.numeroproximo = $scope.proximoConversa
      $scope.badge.imgatual = document.getElementById("Conversa").src;
      $scope.badge.imganterior = $scope.anteriorimgConversa;
      $scope.badge.imgproximo = $scope.proximoimgConversa;
      formBadge.updateForm($scope.badge);
      $state.go('tabsController.badgesexplicaPerfilFollow');
    }
    if(badge == 'Danca'){
      $scope.badge.titulo = 'Pés de valsa';
      $scope.badge.texto = 'Você participou de eventos com #Dança';
      $scope.badge.numeroatual = $scope.auxnbadgeDanca;
      $scope.badge.numeroproximo = $scope.proximoDanca
      $scope.badge.imgatual = document.getElementById("Danca").src;
      $scope.badge.imganterior = $scope.anteriorimgDanca;
      $scope.badge.imgproximo = $scope.proximoimgDanca;
      formBadge.updateForm($scope.badge);
      $state.go('tabsController.badgesexplicaPerfilFollow');
    }
    if(badge == 'EsportesdePraia'){
      $scope.badge.titulo = 'Esportes de Praia';
      $scope.badge.texto = 'Você participou de eventos com #EsportesdePraia';
      $scope.badge.numeroatual = $scope.auxnbadgeEsportesdePraia;
      $scope.badge.numeroproximo = $scope.proximoEsportesdePraia
      $scope.badge.imgatual = document.getElementById("EsportesdePraia").src;
      $scope.badge.imganterior = $scope.anteriorimgEsportesdePraia;
      $scope.badge.imgproximo = $scope.proximoimgEsportesdePraia;
      formBadge.updateForm($scope.badge);
      $state.go('tabsController.badgesexplicaPerfilFollow');
    }
    if(badge == 'FestaseBaladas'){
      $scope.badge.titulo = 'Da night';
      $scope.badge.texto = 'Você participou de eventos com #FestaseBaladas';
      $scope.badge.numeroatual = $scope.auxnbadgeFestaseBaladas;
      $scope.badge.numeroproximo = $scope.proximoFestaseBaladas
      $scope.badge.imgatual = document.getElementById("FestaseBaladas").src;
      $scope.badge.imganterior = $scope.anteriorimgFestaseBaladas;
      $scope.badge.imgproximo = $scope.proximoimgFestaseBaladas;
      formBadge.updateForm($scope.badge);
      $state.go('tabsController.badgesexplicaPerfilFollow');
    }
    if(badge == 'Futebol'){
      $scope.badge.titulo = 'Boleiro';
      $scope.badge.texto = 'Você participou de eventos com #Futebol';
      $scope.badge.numeroatual = $scope.auxnbadgeFutebol;
      $scope.badge.numeroproximo = $scope.proximoFutebol
      $scope.badge.imgatual = document.getElementById("Futebol").src;
      $scope.badge.imganterior = $scope.anteriorimgFutebol;
      $scope.badge.imgproximo = $scope.proximoimgFutebol;
      formBadge.updateForm($scope.badge);
      $state.go('tabsController.badgesexplicaPerfilFollow');
    }
    if(badge == 'GrupodeEstudos'){
      $scope.badge.titulo = 'CDF';
      $scope.badge.texto = 'Você participou de eventos com #GrupodeEstudos';
      $scope.badge.numeroatual = $scope.auxnbadgeGrupodeEstudos;
      $scope.badge.numeroproximo = $scope.proximoGrupodeEstudos
      $scope.badge.imgatual = document.getElementById("GrupodeEstudos").src;
      $scope.badge.imganterior = $scope.anteriorimgGrupodeEstudos;
      $scope.badge.imgproximo = $scope.proximoimgGrupodeEstudos;
      formBadge.updateForm($scope.badge);
      $state.go('tabsController.badgesexplicaPerfilFollow');
    }
    if(badge == 'Jogos'){
      $scope.badge.titulo = 'Jogador (a)';
      $scope.badge.texto = 'Você participou de eventos com #Jogos';
      $scope.badge.numeroatual = $scope.auxnbadgeJogos;
      $scope.badge.numeroproximo = $scope.proximoJogos
      $scope.badge.imgatual = document.getElementById("Jogos").src;
      $scope.badge.imganterior = $scope.anteriorimgJogos;
      $scope.badge.imgproximo = $scope.proximoimgJogos;
      formBadge.updateForm($scope.badge);
      $state.go('tabsController.badgesexplicaPerfilFollow');
    }
    if(badge == 'Musica'){
      $scope.badge.titulo = 'Chill';
      $scope.badge.texto = 'Você participou de eventos com #Musica';
      $scope.badge.numeroatual = $scope.auxnbadgeMusica;
      $scope.badge.numeroproximo = $scope.proximoMusica
      $scope.badge.imgatual = document.getElementById("Musica").src;
      $scope.badge.imganterior = $scope.anteriorimgMusica;
      $scope.badge.imgproximo = $scope.proximoimgMusica;
      formBadge.updateForm($scope.badge);
      $state.go('tabsController.badgesexplicaPerfilFollow');
    }
    if(badge == 'Natureza'){
      $scope.badge.titulo = 'Do mato';
      $scope.badge.texto = 'Você participou de eventos com #Natureza';
      $scope.badge.numeroatual = $scope.auxnbadgeNatureza;
      $scope.badge.numeroproximo = $scope.proximoNatureza
      $scope.badge.imgatual = document.getElementById("Natureza").src;
      $scope.badge.imganterior = $scope.anteriorimgNatureza;
      $scope.badge.imgproximo = $scope.proximoimgNatureza;
      formBadge.updateForm($scope.badge);
      $state.go('tabsController.badgesexplicaPerfilFollow');
    }
    if(badge == 'Passeio'){
      $scope.badge.titulo = 'Do rolê';
      $scope.badge.texto = 'Você participou de eventos com #Passeio';
      $scope.badge.numeroatual = $scope.auxnbadgePasseio;
      $scope.badge.numeroproximo = $scope.proximoPasseio
      $scope.badge.imgatual = document.getElementById("Passeio").src;
      $scope.badge.imganterior = $scope.anteriorimgPasseio;
      $scope.badge.imgproximo = $scope.proximoimgPasseio;
      formBadge.updateForm($scope.badge);
      $state.go('tabsController.badgesexplicaPerfilFollow');
    }
    if(badge == 'Pets'){
      $scope.badge.titulo = 'Amo animais';
      $scope.badge.texto = 'Você participou de eventos com #Pets';
      $scope.badge.numeroatual = $scope.auxnbadgePets;
      $scope.badge.numeroproximo = $scope.proximoPets
      $scope.badge.imgatual = document.getElementById("Pets").src;
      $scope.badge.imganterior = $scope.anteriorimgPets;
      $scope.badge.imgproximo = $scope.proximoimgPets;
      formBadge.updateForm($scope.badge);
      $state.go('tabsController.badgesexplicaPerfilFollow');
    }
    if(badge == 'Restaurantesebares'){
      $scope.badge.titulo = 'Degustador';
      $scope.badge.texto = 'Você participou de eventos com #Restaurantesebares';
      $scope.badge.numeroatual = $scope.auxnbadgeRestaurantesebares;
      $scope.badge.numeroproximo = $scope.proximoRestaurantesebares
      $scope.badge.imgatual = document.getElementById("Restaurantesebares").src;
      $scope.badge.imganterior = $scope.anteriorimgRestaurantesebares;
      $scope.badge.imgproximo = $scope.proximoimgRestaurantesebares;
      formBadge.updateForm($scope.badge);
      $state.go('tabsController.badgesexplicaPerfilFollow');
    }
    if(badge == 'Surf'){
      $scope.badge.titulo = 'Surf';
      $scope.badge.texto = 'Você participou de eventos com #Surf';
      $scope.badge.numeroatual = $scope.auxnbadgeSurf;
      $scope.badge.numeroproximo = $scope.proximoSurf
      $scope.badge.imgatual = document.getElementById("Surf").src;
      $scope.badge.imganterior = $scope.anteriorimgSurf;
      $scope.badge.imgproximo = $scope.proximoimgSurf;
      formBadge.updateForm($scope.badge);
      $state.go('tabsController.badgesexplicaPerfilFollow');
    }
    if(badge == 'Voluntariado'){
      $scope.badge.titulo = 'Ajudar sempre é bom';
      $scope.badge.texto = 'Você participou de eventos com #Voluntariado';
      $scope.badge.numeroatual = $scope.auxnbadgeVoluntariado;
      $scope.badge.numeroproximo = $scope.proximoVoluntariado
      $scope.badge.imgatual = document.getElementById("Voluntariado").src;
      $scope.badge.imganterior = $scope.anteriorimgVoluntariado;
      $scope.badge.imgproximo = $scope.proximoimgVoluntariado;
      formBadge.updateForm($scope.badge);
      $state.go('tabsController.badgesexplicaPerfilFollow');
    }

  }


}])

.controller('badgesexplicaPerfilFollowCtrl', ['$scope', '$stateParams', 'formOutro', 'EventoService','$ionicPopup', '$timeout','$state', '$cordovaCamera', '$cordovaFile', '$cordovaFileTransfer', '$ionicLoading','formBadge', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, formOutro, EventoService, $ionicPopup, $timeout, $state, $cordovaCamera, $cordovaFile, $cordovaFileTransfer, $ionicLoading, formBadge) {

  // $scope.user = formOutro.getForm();
  // $scope.badge = formBadge.getForm();
  // document.getElementById("badgeimg").src=$scope.badge.imgatual;
  // document.getElementById("Atual").src=$scope.badge.imgatual;
  // document.getElementById("Anterior").src=$scope.badge.imganterior;
  // document.getElementById("Proximonivel").src=$scope.badge.imgproximo;
  // $scope.badge.progressPercent = $scope.badge.numeroatual * 100 / $scope.badge.numeroproximo;
  
   

  $scope.$on("$ionicView.enter", function(event, data){
    $scope.user = formOutro.getForm();
    $scope.badge = formBadge.getForm();
    
    document.getElementById("Atual").src=$scope.badge.imgatual;
    document.getElementById("Anterior").src=$scope.badge.imganterior;
    document.getElementById("Proximonivel").src=$scope.badge.imgproximo;
    console.log($scope.badge.imgatual)
    $scope.badge.progressPercent = $scope.badge.numeroatual * 100 / $scope.badge.numeroproximo;
   
  });


}])

   
.controller('perfilOutroCtrl', ['$scope', '$stateParams', 'formOutro', 'formItem', 'EventoService','$http', '$timeout', '$ionicPopup', 'formUser', 'formStalker','$state','formvimdofiltro','formvimdofiltroperfil','formvimdopost', '$ionicTabsDelegate',  // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, formOutro, formItem, EventoService,$http, $timeout, $ionicPopup, formUser, formStalker, $state, formvimdofiltro, formvimdofiltroperfil,formvimdopost, $ionicTabsDelegate) {

  
  $scope.stalkeada = {};
  $scope.auxusers = {};
  $scope.estadobutton = 0; 
  $scope.neventos= 0;
  $scope.neventosnao= 0;
  $scope.p =0;
  $scope.frase = {};
  $scope.vimdofiltro = formvimdofiltroperfil.getForm();
  $scope.vimdopost =formvimdopost.getForm();

  $scope.outro = formOutro.getForm();
  $scope.user = formUser.getForm();

  $scope.stalkeada = $scope.outro;
  $scope.infosstalkeada={};
  EventoService.GetStalkear($scope.stalkeada.iduser).then(function(stalker) {
        $scope.infosstalkeada = stalker;
        if(($scope.infosstalkeada.profilepic[8] == 's' && $scope.infosstalkeada.profilepic[9] == '3')||($scope.infosstalkeada.profilepic[8] == 'd' && $scope.infosstalkeada.profilepic[9] == 'i')){
        //if($scope.infosstalkeada.profilepic[8] == 's' && $scope.infosstalkeada.profilepic[9] == '3'){
             document.getElementById("imageidperfilOutro").src=$scope.infosstalkeada.profilepic+"?{{getTimeStamp()}}";
           }else{
             document.getElementById("imageidperfilOutro").src=$scope.infosstalkeada.profilepic;
           }
           if(!$scope.infosstalkeada.numcodigo || $scope.infosstalkeada.numcodigo == 'null'){
            $scope.temcodigo = false;
          }else{
            $scope.temcodigo = true;
            if($scope.infosstalkeada.numcodigo == '0'){
              document.getElementById("badgeimg_po").src="img/egg_0.png";
            }
            if($scope.infosstalkeada.numcodigo == '1'){
              document.getElementById("badgeimg_po").src="img/egg_1.png";
            }
            if($scope.infosstalkeada.numcodigo == '2'){
              document.getElementById("badgeimg_po").src="img/egg_2.png";
            }
            if(parseInt($scope.infosstalkeada.numcodigo) >= 3){
              document.getElementById("badgeimg_po").src="img/egg_3.png";
            }
            if(parseInt($scope.infosstalkeada.numcodigo) < 0){
              document.getElementById("badgeimg_po").src="img/egg_3.png";
            }
          }
        $scope.frase = stalker.frase;
         if(stalker.borda == 0){
          $scope.estrelabb = false;
          $scope.estrelabs = false;
          $scope.estrelabg = false;
        }
        if(stalker.borda == 1){
          $scope.estrelabb = true;
          $scope.estrelabs = false;
          $scope.estrelabg = false;
        }
        if(stalker.borda == 2){
          $scope.estrelabb = false;
          $scope.estrelabs = true;
          $scope.estrelabg = false;
        }
        if(stalker.borda == 3){
          $scope.estrelabb = false;
          $scope.estrelabs = false;
          $scope.estrelabg = true;
        }
        if($scope.infosstalkeada.idade){
          $scope.infosstalkeada.idade = ", "+ $scope.infosstalkeada.idade +" anos";
        }else{
           $scope.infosstalkeada.idade ='';
        }
  });
  var header = document.getElementById("barperfiloutroev");
    var btns = header.getElementsByClassName("btnperfilotro");
    for (var i = 0; i < btns.length; i++) {
      btns[i].addEventListener("click", function() {
        var current = document.getElementsByClassName("actpo");
        current[0].className = current[0].className.replace(" actpo", "");
        this.className += " actpo";
      });
    }


  $scope.followbutton = false;
  $scope.desseguirbutton = false;

  $scope.qvou = true;

    $scope.CoisasCriado = true;
    $scope.CoisasFinalizado = false;

  var auxbloqueado = 0;
  var noti = {};

   EventoService.GetPontos($scope.stalkeada.iduser).then(function(items) {
        $scope.p = items;
        $scope.labels3 = ["Pontos"];
        $scope.colores3 = ["#ff4d4d"];
        $scope.data3 = [$scope.p];
      });
      EventoService.getIC($scope.stalkeada).then(function(items) {
        if(items){
          $scope.ic = items;
          $scope.options2 = {title: {
                      display: true,
                      text: 'Indice de confirmação',
                      position: 'bottom'
                  }
           }
          $scope.labels2 = ["Fui", "Não fui"];
          $scope.colores2 = ["#99FF99","#ff4d4d"];
          var menos = (100-$scope.ic.total).toFixed(1);
          var mais = $scope.ic.total;
          $scope.data2 = [mais, menos ];
        }
      });

      EventoService.GetComments3($scope.stalkeada).then(function(items) {
        
          $scope.options1 = {title: {
                    display: true,
                    text: 'Avaliações',
                    position: 'bottom'
                }
         }
          $scope.labels1 = ["Extrovertido", "Introvertido", "Realista","Curioso", "Solidário", "Racional","Organizado", "Criativo"];
          $scope.colores1 = ["#fff200", "#02fff2", "#ff9d00","#1867ce", "#e50be1", "#0e8c28","#ef370e", "#af0eef"];
          $scope.data1 =items.chart;
        
      }); 



  $scope.$on("$ionicView.enter", function(event, data){
    $scope.vimdofiltro = formvimdofiltroperfil.getForm();
    $scope.items = [];
    $scope.newItems = [];
    $scope.frase = {};
    $scope.vimdopost =formvimdopost.getForm();
    $scope.vezes = 0;
    $scope.lastidevento = 0;
    $scope.aux2 = 0;
    $ionicTabsDelegate.showBar(0);

    $scope.outro = formOutro.getForm();
    $scope.stalkeada = $scope.outro;
    $scope.infosstalkeada={};
    EventoService.GetStalkear($scope.outro.iduser).then(function(stalker) {
        $scope.infosstalkeada = stalker;
        if(($scope.infosstalkeada.profilepic[8] == 's' && $scope.infosstalkeada.profilepic[9] == '3')||($scope.infosstalkeada.profilepic[8] == 'd' && $scope.infosstalkeada.profilepic[9] == 'i')){
         //if($scope.infosstalkeada.profilepic[8] == 's' && $scope.infosstalkeada.profilepic[9] == '3'){
             document.getElementById("imageidperfilOutro").src=$scope.infosstalkeada.profilepic+"?{{getTimeStamp()}}";
           }else{
             document.getElementById("imageidperfilOutro").src=$scope.infosstalkeada.profilepic;
           }
           if(!$scope.infosstalkeada.numcodigo || $scope.infosstalkeada.numcodigo == 'null'){
            $scope.temcodigo = false;
          }else{
            $scope.temcodigo = true;
            if($scope.infosstalkeada.numcodigo == '0'){
              document.getElementById("badgeimg_po").src="img/egg_0.png";
            }
            if($scope.infosstalkeada.numcodigo == '1'){
              document.getElementById("badgeimg_po").src="img/egg_1.png";
            }
            if($scope.infosstalkeada.numcodigo == '2'){
              document.getElementById("badgeimg_po").src="img/egg_2.png";
            }
            if(parseInt($scope.infosstalkeada.numcodigo) >= 3){
              document.getElementById("badgeimg_po").src="img/egg_3.png";
            }
            if(parseInt($scope.infosstalkeada.numcodigo) < 0){
              document.getElementById("badgeimg_po").src="img/egg_3.png";
            }
          }
        $scope.frase = stalker.frase;
         if(stalker.borda == 0){
          $scope.estrelabb = false;
          $scope.estrelabs = false;
          $scope.estrelabg = false;
        }
        if(stalker.borda == 1){
          $scope.estrelabb = true;
          $scope.estrelabs = false;
          $scope.estrelabg = false;
        }
        if(stalker.borda == 2){
          $scope.estrelabb = false;
          $scope.estrelabs = true;
          $scope.estrelabg = false;
        }
        if(stalker.borda == 3){
          $scope.estrelabb = false;
          $scope.estrelabs = false;
          $scope.estrelabg = true;
        }
        if($scope.infosstalkeada.idade){
          $scope.infosstalkeada.idade = ", "+ $scope.infosstalkeada.idade +" anos";
        }else{
           $scope.infosstalkeada.idade ='';
        }
    });
    
    $scope.followbutton = false;
    $scope.desseguirbutton = false;
    $scope.noMoreItemsAvailable = false;

    $scope.CoisasCriado = true;
    $scope.CoisasFinalizado = false;

    EventoService.GetPontos($scope.outro.iduser).then(function(items) {
        $scope.p = items;
        $scope.labels3 = ["Pontos"];
        $scope.colores3 = ["#ff4d4d"];
        $scope.data3 = [$scope.p];
      });
      EventoService.getIC($scope.outro).then(function(items) {
        if(items){
          $scope.ic = items;
          $scope.options2 = {title: {
                      display: true,
                      text: 'Indice de confirmação',
                      position: 'bottom'
                  }
           }
          $scope.labels2 = ["Fui", "Não fui"];
          $scope.colores2 = ["#99FF99","#ff4d4d"];
          var menos = (100-$scope.ic.total).toFixed(1);
          var mais = $scope.ic.total;
          $scope.data2 = [mais, menos ];
        }
      });

      EventoService.GetComments3($scope.outro).then(function(items) {
        
          $scope.options1 = {title: {
                    display: true,
                    text: 'Avaliações',
                    position: 'bottom'
                }
         }
           $scope.labels1 = ["Extrovertido", "Introvertido", "Realista","Curioso", "Solidário", "Racional","Organizado", "Criativo"];
          $scope.colores1 = ["#fff200", "#02fff2", "#ff9d00","#1867ce", "#e50be1", "#0e8c28","#ef370e", "#af0eef"];
          $scope.data1 =items.chart;
        
      }); 

      EventoService.GetCriados($scope.stalkeada).then(function(items) {
        if(items!='E'){
          for (var i = 0; i < items.length; i++) {
                var curr_date = (items[i].diainicio[8]+items[i].diainicio[9]);
                var h2 = (items[i].diainicio[11]+items[i].diainicio[12]);
                var m2 = (items[i].diainicio[14]+items[i].diainicio[15]);
                var curr_month = (items[i].diainicio[5]+items[i].diainicio[6]);
                var curr_year = (items[i].diainicio[0]+items[i].diainicio[1]+items[i].diainicio[2]+items[i].diainicio[3]);
                var j = curr_date + "/" + curr_month + "/" + curr_year+ ' '+h2 + ':' + m2;
                items[i].datainicio = j;
                if(items[i].estado == 0){
                  items[i].confirmacao = "Vai acontecer"
                }
                if(items[i].estado == 1){
                  items[i].confirmacao = "Finalizado"
                }
                if(items[i].estado == 2){
                  items[i].confirmacao = "Standy by, talvez aconteça"
                }
                if(items[i].estado == 3){
                  items[i].confirmacao = "Vai acontecer"
                }
                if(items[i].estado == 4){
                  items[i].confirmacao = "Cancelado"
                }
                if(items[i].estado == 5){
                  items[i].confirmacao = "Acabado"
                }
                if(items[i].estado == 6){
                  items[i].confirmacao = "Escondido"
                }
            }
          $scope.items = items;
          $scope.lastidvestido = $scope.items[0].idevento;
        }else{
          $scope.items = [];
          $scope.lastidevento = 0;
          auxbloqueado = 3;
        }
      //});
    });

    $scope.auxusers.outro =  $scope.outro.iduser;
    $scope.auxusers.eu =  $scope.user.iduser;

      $scope.outro= $scope.outro.iduser;
      $scope.auxusers.outro =  $scope.outro;
      $scope.auxusers.eu =  $scope.user.iduser;


      EventoService.possoseguir($scope.auxusers).then(function(items) {
        console.log(items)
        if(items){
          console.log($scope.outro,$scope.user.iduser)
          //// nao funciona, nao pegar os bloqueados
          $http.post('https://ec2.diwoapp.com.br/getfollow.php', {iduserseguindo : $scope.outro, 
                                                                    iduserseguidor : $scope.user.iduser}).then(function(res) {
            console.log( 'oi' , res.data[0].bloqueado, res.data[0] );
            if(res.data[0]!='E'){
              if (res.data[0].bloqueado==0){ 
                $scope.desseguirbutton = true;
                $scope.followbutton = false;
                auxbloqueado = 1;
                $scope.qvou = true;
                console.log('ja sigo este cara');
              }
              if(res.data[0].bloqueado==2){
                console.log('nao sigo este cara');
                $scope.desseguirbutton = false;
                $scope.followbutton = true;
                auxbloqueado = 1;
                $scope.qvou = false;
              }
              if(res.data[0].bloqueado==1){
                console.log('tais bloqueado');
                $scope.desseguirbutton = false;
                $scope.followbutton = false;
                auxbloqueado = 3;
                $scope.items = [];
                $scope.qvou = false;
              }
              if($scope.outro == $scope.user.iduser){
                $scope.followbutton = false;
                $scope.desseguirbutton = false;
                $scope.reportbutton = false;
                $scope.qvou = true;
              }
            }else{
                $scope.followbutton = true;
                auxbloqueado = 2;
                $scope.qvou = false;
            }
            if($scope.outro == $scope.user.iduser){
              $scope.followbutton = false;
              $scope.desseguirbutton = false;
              $scope.reportbutton = false;
              $scope.qvou = true;
            }
          });
        }else{
          if($scope.outro == $scope.user.iduser){
            $scope.followbutton = false;
            $scope.desseguirbutton = false;
            $scope.reportbutton = false;
            $scope.qvou = true;
          }else{
            $scope.qvou = false;
          }
        }
      });        
    });
 
    if($scope.outro.iduser == $scope.user.iduser){
      $scope.followbutton = false;
      $scope.desseguirbutton = false;
      $scope.reportbutton = false;
      var alertPopup = $ionicPopup.alert({
        title: '(●♡∀♡)',
        template: 'Que pessoa bela'
      }); 
    } 

  $scope.seguir = function(){
    noti.recebe = $scope.outro.iduser;
    noti.envia = $scope.user.iduser;
    noti.tipo = 11;
    noti.nomeevento = 'follow';
    console.log(auxbloqueado, "auxbloqueado == 2")
    EventoService.VerificaNotificacao(noti).then(function(res) {
      console.log(res);
      if(res){
        var msgnoti ='Nova pessoa esta t stalkeando';
        var link = 'https://ec2.diwoapp.com.br/notificapessoa.php';
          $http.post(link, {notificacao :msgnoti, 
                              idevento : $scope.user.iduser,
                              nomeevento : 'follow',
                              id_user_envia : $scope.user.iduser,
                              username_envia : $scope.user.username,
                              apelido_envia : $scope.user.apelido,
                              tipo : '11',
                              id_user_recebe : $scope.outro.iduser});
      }
    });
    if(auxbloqueado == 2){
      var link = 'https://ec2.diwoapp.com.br/seguepessoa.php';
      $http.post(link, {iduserseguindo : $scope.infosstalkeada.iduser, 
                        usernameseguindo : $scope.stalkeada.username,
                        iduserseguidor : $scope.user.iduser,
                        apelidoseguindo : $scope.infosstalkeada.apelido,
                        apelidoseguidor : $scope.user.apelido,
                        profilepicseguindo : $scope.infosstalkeada.profilepic,
                        profilepicseguidor : $scope.user.profilepic,
                        devicetokenseguidor : $scope.user.devicetoken,
                        usernameseguidor : $scope.user.username}).then(function(res) {
        console.log(res.success);
        var alertPopup = $ionicPopup.alert({
          title: '(*•̀ᴗ•́*)و ̑̑',
          template: 'Pessoa adicionada as pessoas de interesse'
        });
        $scope.desseguirbutton = true;
        $scope.followbutton = false;
      });
    }else{
       var link = 'https://ec2.diwoapp.com.br/refollow.php'; // estado "Bloqueado"  = 2;
          $http.post(link, {iduserseguindo : $scope.infosstalkeada.iduser, 
                            iduserseguidor : $scope.user.iduser}).then(function(res) {           
            var alertPopup = $ionicPopup.alert({
              title: '(￣▽￣)ノ',
              template: 'Pessoa adicionada as pessoas de interesse'
            }); 
            $scope.desseguirbutton = true;
            $scope.followbutton = false;             
          });
    }
  }

  $scope.desseguir = function(){
    auxbloqueado = 0;
      var link = 'https://ec2.diwoapp.com.br/desfollow.php'; // estado "Bloqueado"  = 2;
          $http.post(link, {iduserseguindo : $scope.infosstalkeada.iduser, 
                        iduserseguidor : $scope.user.iduser}).then(function(res) {
                          
                              var alertPopup = $ionicPopup.alert({
                                                          title: '(*꒦ິ⌓꒦ີ)',
                                                          template: 'Não segues mais esta pessoa'
                                                        }); 
                              $scope.desseguirbutton = false;
                              $scope.followbutton = true;
                          
                        });
  }

  $scope.entrabadges = function(){
    $state.go('tabsController.badgesPerfilOutro');
  }

  $scope.comentario = function(){
    formStalker.updateForm($scope.stalkeada);
    if(auxbloqueado!=3){
      $state.go('tabsController.comentariosperfiloutros');
    }
  }

  $scope.loadCriados = function() {
    $scope.CoisasCriado = true;
    $scope.CoisasFinalizado = false;
    if(auxbloqueado!=3){
      $scope.estadobutton = 0;
      $scope.items = [];
      EventoService.GetCriados($scope.stalkeada).then(function(items) {
        if(items == 'E'){
          $scope.items = [];
        }else{
          for (var i = 0; i < items.length; i++) {
                var curr_date = (items[i].diainicio[8]+items[i].diainicio[9]);
                var h2 = (items[i].diainicio[11]+items[i].diainicio[12]);
                var m2 = (items[i].diainicio[14]+items[i].diainicio[15]);
                var curr_month = (items[i].diainicio[5]+items[i].diainicio[6]);
                var curr_year = (items[i].diainicio[0]+items[i].diainicio[1]+items[i].diainicio[2]+items[i].diainicio[3]);
                var j = curr_date + "/" + curr_month + "/" + curr_year+ ' '+h2 + ':' + m2;
                items[i].datainicio = j;
                if(items[i].estado == 0){
                  items[i].confirmacao = "Vai acontecer"
                }
                if(items[i].estado == 1){
                  items[i].confirmacao = "Finalizado"
                }
                if(items[i].estado == 2){
                  items[i].confirmacao = "Standy by, talvez aconteça"
                }
                if(items[i].estado == 3){
                  items[i].confirmacao = "Vai acontecer"
                }
                if(items[i].estado == 4){
                  items[i].confirmacao = "Cancelado"
                }
                if(items[i].estado == 5){
                  items[i].confirmacao = "Acabado"
                }
                if(items[i].estado == 6){
                  items[i].confirmacao = "Escondido"
                }
            }
          $scope.items = items.concat($scope.items);
          $scope.lastidvestido = $scope.items[0].idevento;
        }
      });
    }
  }
  
  $scope.loadAbertos = function() {
    $scope.CoisasCriado = false;
    $scope.CoisasFinalizado = true;
    if(auxbloqueado!=3){
      $scope.estadobutton = 1;
      $scope.items = [];
      EventoService.GetAbertos($scope.stalkeada.iduser).then(function(items) {  //mudar
        if(items == 'E'){
          $scope.items = [];
        }else{
          for (var i = 0; i < items.length; i++) {
                var curr_date = (items[i].diainicio[8]+items[i].diainicio[9]);
                var h2 = (items[i].diainicio[11]+items[i].diainicio[12]);
                var m2 = (items[i].diainicio[14]+items[i].diainicio[15]);
                var curr_month = (items[i].diainicio[5]+items[i].diainicio[6]);
                var curr_year = (items[i].diainicio[0]+items[i].diainicio[1]+items[i].diainicio[2]+items[i].diainicio[3]);
                var j = curr_date + "/" + curr_month + "/" + curr_year+ ' '+h2 + ':' + m2;
                items[i].datainicio = j;
            }
          $scope.items = items.concat($scope.items);
          $scope.lastidvestido = $scope.items[0].idevento;
        }
      });
    }
  }
  
  $scope.loadFechados = function() {
    $scope.CoisasCriado = false;
    $scope.CoisasFinalizado = true;
    if(auxbloqueado!=3){
      $scope.estadobutton = 2;
      $scope.items = [];
      //console.log($scope.user.iduser);
      EventoService.GetFinalizadosPerfil($scope.stalkeada.iduser).then(function(items) {         //mudar
        if(items=='E'){
          $scope.items = [];
        }else{
          for (var i = 0; i < items.length; i++) {
                var curr_date = (items[i].diainicio[8]+items[i].diainicio[9]);
                var h2 = (items[i].diainicio[11]+items[i].diainicio[12]);
                var m2 = (items[i].diainicio[14]+items[i].diainicio[15]);
                var curr_month = (items[i].diainicio[5]+items[i].diainicio[6]);
                var curr_year = (items[i].diainicio[0]+items[i].diainicio[1]+items[i].diainicio[2]+items[i].diainicio[3]);
                var j = curr_date + "/" + curr_month + "/" + curr_year+ ' '+h2 + ':' + m2;
                items[i].datainicio = j;
            }
          $scope.items = items.concat($scope.items);
          $scope.lastidvestido = $scope.items[0].idevento;
        }
      });
    }
  }
    
  $scope.loadMore = function() {
    if ($scope.estadobutton == 0 && auxbloqueado!=3) {
      EventoService.GetOldEventosCriados().then(function(items) {
        $scope.items = $scope.items.concat(items);
        $scope.$broadcast('scroll.infiniteScrollComplete');
        if (items.length <= 4) {
          $scope.noMoreItemsAvailable = true;
        }
      });
    }
    if ($scope.estadobutton == 1 && auxbloqueado!=3) {
      EventoService.GetOldEventosCriados().then(function(items) {
        $scope.items = $scope.items.concat(items);
        $scope.$broadcast('scroll.infiniteScrollComplete');
        if (items.length <= 4) {
          $scope.noMoreItemsAvailable = true;
        }
      });

      
    }
    if ($scope.estadobutton == 2 && auxbloqueado!=3) {
      EventoService.GetOldEventosCriados().then(function(items) {
        $scope.items = $scope.items.concat(items);
        $scope.$broadcast('scroll.infiniteScrollComplete');
        if (items.length <= 4) {
          $scope.noMoreItemsAvailable = true;
        }
      });
    }
  }

  $scope.reportar = function(){
    $scope.reportmsg = '';
    console.log($scope.stalkeada.username);
    $scope.report = [
    { text: "Nome impróprio", checked: false },
    { text: "Comportamento inadequado", checked: false },
    { text: "Foto inapropriada", checked: false },
    { text: "É um impostor", checked: false }
    ];
    $ionicPopup.confirm({
      title: 'Você quer reportar essa pessoa pq?',
      content: '<ion-checkbox ng-repeat="item in report"  style="color: #FCFCFC;" ng-model="item.checked"  ng-checked="item.checked">{{item.text}}</ion-checkbox>',
      scope: $scope
    }).then(function(res) {
      if(res) {
        for (var h=0;h<3;h++){
          //console.log($scope.report[h].checked , h);
          if($scope.report[h].checked){
            $scope.reportmsg = $scope.reportmsg + $scope.report[h].text + ' ';
            //console.log($scope.reportmsg);
          }
        }
        if(h==3){
          console.log($scope.reportmsg);
          $http.post('https://ec2.diwoapp.com.br/reportaevento.php', {namereportado : $scope.stalkeada.username,
                                                                          reportadoid : $scope.stalkeada.iduser,
                                                                          iduserreportando : $scope.user.iduser,
                                                                          usernamereportando : $scope.user.username,
                                                                          tiporeport : 'usuario',
                                                                          motivo : $scope.reportmsg}).then(function (tes){
            $scope.response = tes.data;
            var alertPopup = $ionicPopup.alert({
              title: 'Obrigado',
              template: 'Esta pessoa esta agora sobre investigação, obrigado por manter a plataforma segura'
            });
          });
        }
      }
    });
  }

}])

.controller('badgesPerfilOutroCtrl', ['$scope', '$stateParams', 'formOutro', 'EventoService','$ionicPopup', '$timeout','$state', '$cordovaCamera', '$cordovaFile', '$cordovaFileTransfer', '$ionicLoading','formBadge', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, formOutro, EventoService, $ionicPopup, $timeout, $state, $cordovaCamera, $cordovaFile, $cordovaFileTransfer, $ionicLoading, formBadge) {


  $scope.user = formOutro.getForm();
  $scope.aux = {};
  $scope.aux.iduser = $scope.user.iduser;


  $scope.aux.tag = "#ArteeCultura";
  $scope.auxnbadgeArteeCultura = 0;
  $scope.proximoArteeCultura = 0;
  $scope.proximoimgArteeCultura = '';
  $scope.anteriorimgArteeCultura = '';
  EventoService.getbadges($scope.aux).then(function(badges){
    console.log("badges", badges);
    if(badges!="Error" && badges !="E"){
      $scope.auxnbadgeArteeCultura = badges.length;
      if(badges.length == 0){
        $scope.anteriorimgArteeCultura = 'img/badges/Categorias/ArteeCultura/0.png';
        $scope.proximoArteeCultura = 1;
        $scope.proximoimgArteeCultura = 'img/badges/Categorias/ArteeCultura/1.png';

        document.getElementById("ArteeCultura").src="img/badges/Categorias/ArteeCultura/0.png"
      }
      if(badges.length == 1){
        $scope.anteriorimgArteeCultura = 'img/badges/Categorias/ArteeCultura/0.png';
        $scope.proximoArteeCultura = 2;
        $scope.proximoimgArteeCultura = 'img/badges/Categorias/ArteeCultura/1.1.png';
        document.getElementById("ArteeCultura").src="img/badges/Categorias/ArteeCultura/1.png"
      }
      if(badges.length == 2){
        $scope.anteriorimgArteeCultura = 'img/badges/Categorias/ArteeCultura/1.png';
        $scope.proximoArteeCultura = 3;
        $scope.proximoimgArteeCultura = 'img/badges/Categorias/ArteeCultura/1.2.png';
        document.getElementById("ArteeCultura").src="img/badges/Categorias/ArteeCultura/1.1.png"
      }
      if(badges.length == 3){
        $scope.anteriorimgArteeCultura = 'img/badges/Categorias/ArteeCultura/1.1.png';
        $scope.proximoArteeCultura = 4;
        $scope.proximoimgArteeCultura = 'img/badges/Categorias/ArteeCultura/1.3.png';
        document.getElementById("ArteeCultura").src="img/badges/Categorias/ArteeCultura/1.2.png"
      }
      if(badges.length == 4 || badges.length == 5){
        $scope.anteriorimgArteeCultura = 'img/badges/Categorias/ArteeCultura/1.2.pn';
        $scope.proximoArteeCultura = 6;
        $scope.proximoimgArteeCultura = 'img/badges/Categorias/ArteeCultura/2.png';
        document.getElementById("ArteeCultura").src="img/badges/Categorias/ArteeCultura/1.3.png"
      }

      if(badges.length == 6 || badges.length == 7){
        $scope.anteriorimgArteeCultura = 'img/badges/Categorias/ArteeCultura/1.3.png';
        $scope.proximoArteeCultura = 8;
        $scope.proximoimgArteeCultura = 'img/badges/Categorias/ArteeCultura/2.1.png';
        document.getElementById("ArteeCultura").src="img/badges/Categorias/ArteeCultura/2.png"
      }
      if(badges.length == 8 || badges.length == 9){
        $scope.anteriorimgArteeCultura = 'img/badges/Categorias/ArteeCultura/2.png';
        $scope.proximoArteeCultura = 10;
        $scope.proximoimgArteeCultura = 'img/badges/Categorias/ArteeCultura/2.2.png';
        document.getElementById("ArteeCultura").src="img/badges/Categorias/ArteeCultura/2.1.png"
      }
      if(badges.length == 10 || badges.length == 11){
        $scope.anteriorimgArteeCultura = 'img/badges/Categorias/ArteeCultura/2.1.png';
        $scope.proximoArteeCultura = 12;
        $scope.proximoimgArteeCultura = 'img/badges/Categorias/ArteeCultura/2.3.png';
        document.getElementById("ArteeCultura").src="img/badges/Categorias/ArteeCultura/2.2.png"
      }
      if(badges.length == 12 || badges.length == 13 || badges.length == 14){
        $scope.anteriorimgArteeCultura = 'img/badges/Categorias/ArteeCultura/2.2.png';
        $scope.proximoArteeCultura = 15;
        $scope.proximoimgArteeCultura = 'img/badges/Categorias/ArteeCultura/3.png';
        document.getElementById("ArteeCultura").src="img/badges/Categorias/ArteeCultura/2.3.png"
      }

      if(badges.length >= 15 && badges.length < 20 ){
        $scope.anteriorimgArteeCultura = 'img/badges/Categorias/ArteeCultura/2.3.png';
        $scope.proximoArteeCultura = 20;
        $scope.proximoimgArteeCultura = 'img/badges/Categorias/ArteeCultura/3.1.png';
        document.getElementById("ArteeCultura").src="img/badges/Categorias/ArteeCultura/3.png"
      }
      if(badges.length >= 20 && badges.length < 22 ){
        $scope.anteriorimgArteeCultura = 'img/badges/Categorias/ArteeCultura/3.png';
        $scope.proximoArteeCultura = 25;
        $scope.proximoimgArteeCultura = 'img/badges/Categorias/ArteeCultura/3.2.png';
        document.getElementById("ArteeCultura").src="img/badges/Categorias/ArteeCultura/3.1.png"
      }
      if(badges.length >= 25 && badges.length < 30 ){
        $scope.anteriorimgArteeCultura = 'img/badges/Categorias/ArteeCultura/3.1.png';
        $scope.proximoArteeCultura = 30;
        $scope.proximoimgArteeCultura = 'img/badges/Categorias/ArteeCultura/3.3.png';
        document.getElementById("ArteeCultura").src="img/badges/Categorias/ArteeCultura/3.2.png"
      }
      if(badges.length >= 30 && badges.length < 50 ){
        $scope.anteriorimgArteeCultura = 'img/badges/Categorias/ArteeCultura/3.2.png';
        $scope.proximoArteeCultura = 50;
        $scope.proximoimgArteeCultura = 'img/badges/Categorias/ArteeCultura/Super.png';
        document.getElementById("ArteeCultura").src="img/badges/Categorias/ArteeCultura/3.3.png"
      }

      if(badges.length >= 50){

        $scope.anteriorimgArteeCultura = 'img/badges/Categorias/ArteeCultura/3.3.png';
        $scope.proximoArteeCultura = 10000;
        $scope.proximoimgArteeCultura = 'img/badges/Categorias/ArteeCultura/Super.png';
        document.getElementById("ArteeCultura").src="img/badges/Categorias/ArteeCultura/Super.png"
      }

    }else{
      $scope.auxnbadgeArteeCultura = 0;
      $scope.anteriorimgArteeCultura = 'img/badges/Categorias/ArteeCultura/0.png';
        $scope.proximoArteeCultura = 1;
        $scope.proximoimgArteeCultura = 'img/badges/Categorias/ArteeCultura/1.png';
      document.getElementById("ArteeCultura").src="img/badges/Categorias/ArteeCultura/0.png"
    }
  });

  $scope.aux.tag = "#Ciclismo";
  $scope.auxnbadgeCiclismo = 0;
  $scope.proximoCiclismo = 0;
  $scope.proximoimgCiclismo = '';
  $scope.anteriorimgCiclismo = '';
  EventoService.getbadges($scope.aux).then(function(badges){
    console.log("badges", badges);
    if(badges!="Error" && badges !="E"){
      $scope.auxnbadgeCiclismo = badges.length;
      if(badges.length == 0){
        $scope.anteriorimgCiclismoa = 'img/badges/Categorias/Ciclismo/0.png';
        $scope.proximoCiclismo = 1;
        $scope.proximoimgCiclismo = 'img/badges/Categorias/Ciclismo/1.png';
        document.getElementById("Ciclismo").src="img/badges/Categorias/Ciclismo/0.png"
      }
      if(badges.length == 1){
        $scope.anteriorimgCiclismoa = 'img/badges/Categorias/Ciclismo/0.png';
        $scope.proximoCiclismo = 2;
        $scope.proximoimgCiclismo = 'img/badges/Categorias/Ciclismo/1.1.png';
        document.getElementById("Ciclismo").src="img/badges/Categorias/Ciclismo/1.png"
      }
      if(badges.length == 2){
        $scope.anteriorimgCiclismoa = 'img/badges/Categorias/Ciclismo/1.png';
        $scope.proximoCiclismo = 3;
        $scope.proximoimgCiclismo = 'img/badges/Categorias/Ciclismo/1.2.png';
        document.getElementById("Ciclismo").src="img/badges/Categorias/Ciclismo/1.1.png"
      }
      if(badges.length == 3){
        $scope.anteriorimgCiclismoa = 'img/badges/Categorias/Ciclismo/1.1.png';
        $scope.proximoCiclismo = 4;
        $scope.proximoimgCiclismo = 'img/badges/Categorias/Ciclismo/1.3.png';
        document.getElementById("Ciclismo").src="img/badges/Categorias/Ciclismo/1.2.png"
      }
      if(badges.length == 4 || badges.length == 5){
        $scope.anteriorimgCiclismoa = 'img/badges/Categorias/Ciclismo/1.2.png';
        $scope.proximoCiclismo = 6;
        $scope.proximoimgCiclismo = 'img/badges/Categorias/Ciclismo/2.png';
        document.getElementById("Ciclismo").src="img/badges/Categorias/Ciclismo/1.3.png"
      }

      if(badges.length == 6 || badges.length == 7){
        $scope.anteriorimgCiclismoa = 'img/badges/Categorias/Ciclismo/1.3.png';
        $scope.proximoCiclismo = 8;
        $scope.proximoimgCiclismo = 'img/badges/Categorias/Ciclismo/2.1.png';
        document.getElementById("Ciclismo").src="img/badges/Categorias/Ciclismo/2.png"
      }
      if(badges.length == 8 || badges.length == 9){
        $scope.anteriorimgCiclismoa = 'img/badges/Categorias/Ciclismo/2.png';
        $scope.proximoCiclismo = 10;
        $scope.proximoimgCiclismo = 'img/badges/Categorias/Ciclismo/2.2.png';
        document.getElementById("Ciclismo").src="img/badges/Categorias/Ciclismo/2.1.png"
      }
      if(badges.length == 10 || badges.length == 11){
        $scope.anteriorimgCiclismoa = 'img/badges/Categorias/Ciclismo/2.1.png';
        $scope.proximoCiclismo = 12;
        $scope.proximoimgCiclismo = 'img/badges/Categorias/Ciclismo/2.3.png';
        document.getElementById("Ciclismo").src="img/badges/Categorias/Ciclismo/2.2.png"
      }
      if(badges.length == 12 || badges.length == 13 || badges.length == 14){
        $scope.anteriorimgCiclismoa = 'img/badges/Categorias/Ciclismo/2.2.png';
        $scope.proximoCiclismo = 15;
        $scope.proximoimgCiclismo = 'img/badges/Categorias/Ciclismo/3.png';
        document.getElementById("Ciclismo").src="img/badges/Categorias/Ciclismo/2.3.png"
      }

      if(badges.length >= 15 && badges.length < 20 ){
        $scope.anteriorimgCiclismoa = 'img/badges/Categorias/Ciclismo/2.3.png';
        $scope.proximoCiclismo = 20;
        $scope.proximoimgCiclismo = 'img/badges/Categorias/Ciclismo/3.1.png';
        document.getElementById("Ciclismo").src="img/badges/Categorias/Ciclismo/3.png"
      }
      if(badges.length >= 20 && badges.length < 22 ){
        $scope.anteriorimgCiclismoa = 'img/badges/Categorias/Ciclismo/3.png';
        $scope.proximoCiclismo = 25;
        $scope.proximoimgCiclismo = 'img/badges/Categorias/Ciclismo/3.2.png';
        document.getElementById("Ciclismo").src="img/badges/Categorias/Ciclismo/3.1.png"
      }
      if(badges.length >= 25 && badges.length < 30 ){
        $scope.anteriorimgCiclismoa = 'img/badges/Categorias/Ciclismo/3.1.png';
        $scope.proximoCiclismo = 30;
        $scope.proximoimgCiclismo = 'img/badges/Categorias/Ciclismo/3.3.png';
        document.getElementById("Ciclismo").src="img/badges/Categorias/Ciclismo/3.2.png"
      }
      if(badges.length >= 30 && badges.length < 50 ){
        $scope.anteriorimgCiclismoa = 'img/badges/Categorias/Ciclismo/3.2.png';
        $scope.proximoCiclismo = 50;
        $scope.proximoimgCiclismo = 'img/badges/Categorias/Ciclismo/Super.png';
        document.getElementById("Ciclismo").src="img/badges/Categorias/Ciclismo/3.3.png"
      }

      if(badges.length >= 50){

        $scope.anteriorimgCiclismoa = 'img/badges/Categorias/Ciclismo/3.3.png';
        $scope.proximoCiclismo = 10000;
        $scope.proximoimgCiclismo = 'img/badges/Categorias/Ciclismo/Super.png';
        document.getElementById("Ciclismo").src="img/badges/Categorias/Ciclismo/Super.png"
      }

    }else{
      $scope.auxnbadgeCiclismo = 0;
      $scope.anteriorimgCiclismoa = 'img/badges/Categorias/Ciclismo/0.png';
      $scope.proximoCiclismo = 1;
      $scope.proximoimgCiclismo = 'img/badges/Categorias/Ciclismo/1.png';
      document.getElementById("Ciclismo").src="img/badges/Categorias/Ciclismo/0.png"
    }
  });

  $scope.aux.tag = "#Conversa";
  $scope.auxnbadgeConversa = 0;
  $scope.proximoConversa = 0;
  $scope.proximoimgConversa = '';
  $scope.anteriorimgConversa = '';
  EventoService.getbadges($scope.aux).then(function(badges){
    console.log("badges", badges);
    if(badges!="Error" && badges !="E"){
      $scope.auxnbadgeConversa = badges.length;
      if(badges.length == 0){
        $scope.anteriorimgConversa = 'img/badges/Categorias/Conversa/0.png';
        $scope.proximoConversa = 1;
        $scope.proximoimgConversa = 'img/badges/Categorias/Conversa/1.png';
        document.getElementById("Conversa").src="img/badges/Categorias/Conversa/0.png"
      }
      if(badges.length == 1){
        $scope.anteriorimgConversa = 'img/badges/Categorias/Conversa/0.png';
        $scope.proximoConversa = 2;
        $scope.proximoimgConversa = 'img/badges/Categorias/Conversa/1.1.png';
        document.getElementById("Conversa").src="img/badges/Categorias/Conversa/1.png"
      }
      if(badges.length == 2){
        $scope.anteriorimgConversa = 'img/badges/Categorias/Conversa/1.png';
        $scope.proximoConversa = 3;
        $scope.proximoimgConversa = 'img/badges/Categorias/Conversa/1.2.png';
        document.getElementById("Conversa").src="img/badges/Categorias/Conversa/1.1.png"
      }
      if(badges.length == 3){
        $scope.anteriorimgConversa = 'img/badges/Categorias/Conversa/1.1.png';
        $scope.proximoConversa = 4;
        $scope.proximoimgConversa = 'img/badges/Categorias/Conversa/1.3.png';
        document.getElementById("Conversa").src="img/badges/Categorias/Conversa/1.2.png"
      }
      if(badges.length == 4 || badges.length == 5){
        $scope.anteriorimgConversa = 'img/badges/Categorias/Conversa/1.2.png';
        $scope.proximoConversa = 6;
        $scope.proximoimgConversa = 'img/badges/Categorias/Conversa/2.png';
        document.getElementById("Conversa").src="img/badges/Categorias/Conversa/1.3.png"
      }

      if(badges.length == 6 || badges.length == 7){
        $scope.anteriorimgConversa = 'img/badges/Categorias/Conversa/1.3.png';
        $scope.proximoConversa = 8;
        $scope.proximoimgConversa = 'img/badges/Categorias/Conversa/2.1.png';
        document.getElementById("Conversa").src="img/badges/Categorias/Conversa/2.png"
      }
      if(badges.length == 8 || badges.length == 9){
        $scope.anteriorimgConversa = 'img/badges/Categorias/Conversa/2.png';
        $scope.proximoConversa = 10;
        $scope.proximoimgConversa = 'img/badges/Categorias/Conversa/2.2.png';
        document.getElementById("Conversa").src="img/badges/Categorias/Conversa/2.1.png"
      }
      if(badges.length == 10 || badges.length == 11){
        $scope.anteriorimgConversa = 'img/badges/Categorias/Conversa/2.1.png';
        $scope.proximoConversa = 12;
        $scope.proximoimgConversa = 'img/badges/Categorias/Conversa/2.3.png';
        document.getElementById("Conversa").src="img/badges/Categorias/Conversa/2.2.png"
      }
      if(badges.length == 12 || badges.length == 13 || badges.length == 14){
        $scope.anteriorimgConversa = 'img/badges/Categorias/Conversa/2.2.png';
        $scope.proximoConversa = 15;
        $scope.proximoimgConversa = 'img/badges/Categorias/Conversa/3.png';
        document.getElementById("Conversa").src="img/badges/Categorias/Conversa/2.3.png"
      }

      if(badges.length >= 15 && badges.length < 20 ){
        $scope.anteriorimgConversa = 'img/badges/Categorias/Conversa/2.3.png';
        $scope.proximoConversa = 20;
        $scope.proximoimgConversa = 'img/badges/Categorias/Conversa/3.1.png';
        document.getElementById("Conversa").src="img/badges/Categorias/Conversa/3.png"
      }
      if(badges.length >= 20 && badges.length < 22 ){
        $scope.anteriorimgConversa = 'img/badges/Categorias/Conversa/3.png';
        $scope.proximoConversa = 25;
        $scope.proximoimgConversa = 'img/badges/Categorias/Conversa/3.2.png';
        document.getElementById("Conversa").src="img/badges/Categorias/Conversa/3.1.png"
      }
      if(badges.length >= 25 && badges.length < 30 ){
        $scope.anteriorimgConversa = 'img/badges/Categorias/Conversa/3.1.png';
        $scope.proximoConversa = 30;
        $scope.proximoimgConversa = 'img/badges/Categorias/Conversa/3.3.png';
        document.getElementById("Conversa").src="img/badges/Categorias/Conversa/3.2.png"
      }
      if(badges.length >= 30 && badges.length < 50 ){
        $scope.anteriorimgConversa = 'img/badges/Categorias/Conversa/3.2.png';
        $scope.proximoConversa = 50;
        $scope.proximoimgConversa = 'img/badges/Categorias/Conversa/Super.png';
        document.getElementById("Conversa").src="img/badges/Categorias/Conversa/3.3.png"
      }

      if(badges.length >= 50){
        $scope.anteriorimgConversa = 'img/badges/Categorias/Conversa/3.3.png';
        $scope.proximoConversa = 10000;
        $scope.proximoimgConversa = 'img/badges/Categorias/Conversa/Super.png';
        document.getElementById("Conversa").src="img/badges/Categorias/Conversa/Super.png"
      }

    }else{
      $scope.auxnbadgeConversa = 0;

        $scope.anteriorimgConversa = 'img/badges/Categorias/Conversa/0.png';
        $scope.proximoConversa = 1;
        $scope.proximoimgConversa = 'img/badges/Categorias/Conversa/1.png';
      document.getElementById("Conversa").src="img/badges/Categorias/Conversa/0.png"
    }
  });

  $scope.aux.tag = "#Dança";
  $scope.auxnbadgeDanca = 0;
  $scope.proximoDanca = 0;
  $scope.proximoimgDanca = '';
  $scope.anteriorimgDanca = '';
  EventoService.getbadges($scope.aux).then(function(badges){
    console.log("badges", badges);
    if(badges!="Error" && badges !="E"){
      $scope.auxnbadgeDanca = badges.length;
      if(badges.length == 0){
        $scope.anteriorimgDanca = 'img/badges/Categorias/Danca/0.png';
        $scope.proximoDanca = 1;
        $scope.proximoimgDanca = 'img/badges/Categorias/Danca/1.png';
        document.getElementById("Danca").src="img/badges/Categorias/Danca/0.png"
      }
      if(badges.length == 1){
        $scope.anteriorimgDanca = 'img/badges/Categorias/Danca/0.png';
        $scope.proximoDanca = 2;
        $scope.proximoimgDanca = 'img/badges/Categorias/Danca/1.1.png';
        document.getElementById("Danca").src="img/badges/Categorias/Danca/1.png"
      }
      if(badges.length == 2){
        $scope.anteriorimgDanca = 'img/badges/Categorias/Danca/1.png';
        $scope.proximoDanca = 3;
        $scope.proximoimgDanca = 'img/badges/Categorias/Danca/1.2.png';
        document.getElementById("Danca").src="img/badges/Categorias/Danca/1.1.png"
      }
      if(badges.length == 3){
        $scope.anteriorimgDanca = 'img/badges/Categorias/Danca/1.1.png';
        $scope.proximoDanca = 4;
        $scope.proximoimgDanca = 'img/badges/Categorias/Danca/1.3.png';
        document.getElementById("Danca").src="img/badges/Categorias/Danca/1.2.png"
      }
      if(badges.length == 4 || badges.length == 5){
        $scope.anteriorimgDanca = 'img/badges/Categorias/Danca/1.2.png';
        $scope.proximoDanca = 6;
        $scope.proximoimgDanca = 'img/badges/Categorias/Danca/2.png';
        document.getElementById("Danca").src="img/badges/Categorias/Danca/1.3.png"
      }

      if(badges.length == 6 || badges.length == 7){
        $scope.anteriorimgDanca = 'img/badges/Categorias/Danca/1.3.png';
        $scope.proximoDanca = 8;
        $scope.proximoimgDanca = 'img/badges/Categorias/Danca/2.1.png';
        document.getElementById("Danca").src="img/badges/Categorias/Danca/2.png"
      }
      if(badges.length == 8 || badges.length == 9){
        $scope.anteriorimgDanca = 'img/badges/Categorias/Danca/2.png';
        $scope.proximoDanca = 10;
        $scope.proximoimgDanca = 'img/badges/Categorias/Danca/2.2.png';
        document.getElementById("Danca").src="img/badges/Categorias/Danca/2.1.png"
      }
      if(badges.length == 10 || badges.length == 11){
        $scope.anteriorimgDanca = 'img/badges/Categorias/Danca/2.1.png';
        $scope.proximoDanca = 12;
        $scope.proximoimgDanca = 'img/badges/Categorias/Danca/2.3.png';
        document.getElementById("Danca").src="img/badges/Categorias/Danca/2.2.png"
      }
      if(badges.length == 12 || badges.length == 13 || badges.length == 14){
        $scope.anteriorimgDanca = 'img/badges/Categorias/Danca/2.2.png';
        $scope.proximoDanca = 15;
        $scope.proximoimgDanca = 'img/badges/Categorias/Danca/3.png';
        document.getElementById("Danca").src="img/badges/Categorias/Danca/2.3.png"
      }

      if(badges.length >= 15 && badges.length < 20 ){
        $scope.anteriorimgDanca = 'img/badges/Categorias/Danca/2.3.png';
        $scope.proximoDanca = 20;
        $scope.proximoimgDanca = 'img/badges/Categorias/Danca/3.png';
        document.getElementById("Danca").src="img/badges/Categorias/Danca/3.png"
      }
      if(badges.length >= 20 && badges.length < 22 ){
        $scope.anteriorimgDanca = 'img/badges/Categorias/Danca/3.png';
        $scope.proximoDanca = 25;
        $scope.proximoimgDanca = 'img/badges/Categorias/Danca/3.2.png';
        document.getElementById("Danca").src="img/badges/Categorias/Danca/3.1.png"
      }
      if(badges.length >= 25 && badges.length < 30 ){
        $scope.anteriorimgDanca = 'img/badges/Categorias/Danca/3.1.png';
        $scope.proximoDanca = 30;
        $scope.proximoimgDanca = 'img/badges/Categorias/Danca/3.3.png';
        document.getElementById("Danca").src="img/badges/Categorias/Danca/3.2.png"
      }
      if(badges.length >= 30 && badges.length < 50 ){
        $scope.anteriorimgDanca = 'img/badges/Categorias/Danca/3.2.png';
        $scope.proximoDanca = 50;
        $scope.proximoimgDanca = 'img/badges/Categorias/Danca/Super.png';
        document.getElementById("Danca").src="img/badges/Categorias/Danca/3.3.png"
      }

      if(badges.length >= 50){
        $scope.anteriorimgDanca = 'img/badges/Categorias/Danca/3.3.png';
        $scope.proximoDanca = 10000;
        $scope.proximoimgDanca = 'img/badges/Categorias/Danca/Super.png';
        document.getElementById("Danca").src="img/badges/Categorias/Danca/Super.png"
      }

    }else{
      $scope.auxnbadgeDanca = 0;
        $scope.anteriorimgDanca = 'img/badges/Categorias/Danca/0.png';
        $scope.proximoDanca = 1;
        $scope.proximoimgDanca = 'img/badges/Categorias/Danca/1.png';
      document.getElementById("Danca").src="img/badges/Categorias/Danca/0.png"
    }
  });

  $scope.aux.tag = "#EsportesdePraia";
  $scope.auxnbadgeEsportesdePraia = 0;
  $scope.proximoEsportesdePraia = 0;
  $scope.proximoimgEsportesdePraia = '';
  $scope.anteriorimgEsportesdePraia = '';
  EventoService.getbadges($scope.aux).then(function(badges){
    console.log("badges", badges);
    if(badges!="Error" && badges !="E"){
      $scope.auxnbadgeEsportesdePraia = badges.length;
      if(badges.length == 0){
        $scope.anteriorimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/0.png';
        $scope.proximoEsportesdePraia = 1;
        $scope.proximoimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/1.png';
        document.getElementById("EsportesdePraia").src="img/badges/Categorias/EsportesdePraia/0.png"
      }
      if(badges.length == 1){
        $scope.anteriorimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/0.png';
        $scope.proximoEsportesdePraia = 2;
        $scope.proximoimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/1.1.png';
        document.getElementById("EsportesdePraia").src="img/badges/Categorias/EsportesdePraia/1.png"
      }
      if(badges.length == 2){
        $scope.anteriorimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/1.png';
        $scope.proximoEsportesdePraia = 3;
        $scope.proximoimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/1.2.png';
        document.getElementById("EsportesdePraia").src="img/badges/Categorias/EsportesdePraia/1.1.png"
      }
      if(badges.length == 3){
        $scope.anteriorimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/1.1.png';
        $scope.proximoEsportesdePraia = 4;
        $scope.proximoimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/1.3.png';
        document.getElementById("EsportesdePraia").src="img/badges/Categorias/EsportesdePraia/1.2.png"
      }
      if(badges.length == 4 || badges.length == 5){
        $scope.anteriorimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/1.2.png';
        $scope.proximoEsportesdePraia = 6;
        $scope.proximoimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/2.png';
        document.getElementById("EsportesdePraia").src="img/badges/Categorias/EsportesdePraia/1.3.png"
      }

      if(badges.length == 6 || badges.length == 7){
        $scope.anteriorimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/1.3.png';
        $scope.proximoEsportesdePraia = 8;
        $scope.proximoimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/2.1.png';
        document.getElementById("EsportesdePraia").src="img/badges/Categorias/EsportesdePraia/2.png"
      }
      if(badges.length == 8 || badges.length == 9){
        $scope.anteriorimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/2.png';
        $scope.proximoEsportesdePraia = 10;
        $scope.proximoimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/2.2.png';
        document.getElementById("EsportesdePraia").src="img/badges/Categorias/EsportesdePraia/2.1.png"
      }
      if(badges.length == 10 || badges.length == 11){
        $scope.anteriorimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/2.1.png';
        $scope.proximoEsportesdePraia = 12;
        $scope.proximoimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/2.3.png';
        document.getElementById("EsportesdePraia").src="img/badges/Categorias/EsportesdePraia/2.2.png"
      }
      if(badges.length == 12 || badges.length == 13 || badges.length == 14){
        $scope.anteriorimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/2.2.png';
        $scope.proximoEsportesdePraia = 15;
        $scope.proximoimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/3.png';
        document.getElementById("EsportesdePraia").src="img/badges/Categorias/EsportesdePraia/2.3.png"
      }

      if(badges.length >= 15 && badges.length < 20 ){
        $scope.anteriorimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/2.3.png';
        $scope.proximoEsportesdePraia = 20;
        $scope.proximoimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/3.1.png';
        document.getElementById("EsportesdePraia").src="img/badges/Categorias/EsportesdePraia/3.png"
      }
      if(badges.length >= 20 && badges.length < 22 ){
        $scope.anteriorimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/3.png';
        $scope.proximoEsportesdePraia = 25;
        $scope.proximoimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/3.2.png';
        document.getElementById("EsportesdePraia").src="img/badges/Categorias/EsportesdePraia/3.1.png"
      }
      if(badges.length >= 25 && badges.length < 30 ){
        $scope.anteriorimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/3.1.png';
        $scope.proximoEsportesdePraia = 30;
        $scope.proximoimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/1.png';
        document.getElementById("EsportesdePraia").src="img/badges/Categorias/EsportesdePraia/3.2.png"
      }
      if(badges.length >= 30 && badges.length < 50 ){
        $scope.anteriorimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/3.2.png';
        $scope.proximoEsportesdePraia = 50;
        $scope.proximoimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/Super.png';
        document.getElementById("EsportesdePraia").src="img/badges/Categorias/EsportesdePraia/3.3.png"
      }

      if(badges.length >= 50){
        $scope.anteriorimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/3.3.png';
        $scope.proximoEsportesdePraia = 10000;
        $scope.proximoimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/Super.png';
        document.getElementById("EsportesdePraia").src="img/badges/Categorias/EsportesdePraia/Super.png"
      }

    }else{
      $scope.auxnbadgeEsportesdePraia = 0;
        $scope.anteriorimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/0.png';
        $scope.proximoEsportesdePraia = 1;
        $scope.proximoimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/1.png';
      document.getElementById("EsportesdePraia").src="img/badges/Categorias/EsportesdePraia/0.png"
    }
  });

  $scope.aux.tag = "#FestaseBaladas";
  $scope.auxnbadgeFestaseBaladas = 0;
  $scope.proximoFestaseBaladas = 0;
  $scope.proximoimgFestaseBaladas = '';
  $scope.anteriorimgFestaseBaladas = '';
  EventoService.getbadges($scope.aux).then(function(badges){
    console.log("badges", badges);
    if(badges!="Error" && badges !="E"){
      $scope.auxnbadgeFestaseBaladas = badges.length;
      if(badges.length == 0){
        $scope.anteriorimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/0.png';
        $scope.proximoFestaseBaladas = 1;
        $scope.proximoimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/1.png';
        document.getElementById("FestaseBaladas").src="img/badges/Categorias/FestaseBaladas/0.png"
      }
      if(badges.length == 1){
        $scope.anteriorimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/0.png';
        $scope.proximoFestaseBaladas = 2;
        $scope.proximoimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/1.1.png';
        document.getElementById("FestaseBaladas").src="img/badges/Categorias/FestaseBaladas/1.png"
      }
      if(badges.length == 2){
        $scope.anteriorimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/1.png';
        $scope.proximoFestaseBaladas = 3;
        $scope.proximoimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/1.2.png';
        document.getElementById("FestaseBaladas").src="img/badges/Categorias/FestaseBaladas/1.1.png"
      }
      if(badges.length == 3){
        $scope.anteriorimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/1.1.png';
        $scope.proximoFestaseBaladas = 4;
        $scope.proximoimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/1.3.png';
        document.getElementById("FestaseBaladas").src="img/badges/Categorias/FestaseBaladas/1.2.png"
      }
      if(badges.length == 4 || badges.length == 5){
        $scope.anteriorimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/1.2.png';
        $scope.proximoFestaseBaladas = 6;
        $scope.proximoimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/2.png';
        document.getElementById("FestaseBaladas").src="img/badges/Categorias/FestaseBaladas/1.3.png"
      }

      if(badges.length == 6 || badges.length == 7){
        $scope.anteriorimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/1.3.png';
        $scope.proximoFestaseBaladas = 8;
        $scope.proximoimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/2.1.png';
        document.getElementById("FestaseBaladas").src="img/badges/Categorias/FestaseBaladas/2.png"
      }
      if(badges.length == 8 || badges.length == 9){
        $scope.anteriorimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/2.png';
        $scope.proximoFestaseBaladas = 10;
        $scope.proximoimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/2.2.png';
        document.getElementById("FestaseBaladas").src="img/badges/Categorias/FestaseBaladas/2.1.png"
      }
      if(badges.length == 10 || badges.length == 11){
        $scope.anteriorimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/2.1.png';
        $scope.proximoFestaseBaladas = 12;
        $scope.proximoimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/2.3.png';
        document.getElementById("FestaseBaladas").src="img/badges/Categorias/FestaseBaladas/2.2.png"
      }
      if(badges.length == 12 || badges.length == 13 || badges.length == 14){
        $scope.anteriorimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/2.2.png';
        $scope.proximoFestaseBaladas = 15;
        $scope.proximoimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/3.png';
        document.getElementById("FestaseBaladas").src="img/badges/Categorias/FestaseBaladas/2.3.png"
      }

      if(badges.length >= 15 && badges.length < 20 ){
        $scope.anteriorimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/2.3.png';
        $scope.proximoFestaseBaladas = 20;
        $scope.proximoimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/3.1.png';
        document.getElementById("FestaseBaladas").src="img/badges/Categorias/FestaseBaladas/3.png"
      }
      if(badges.length >= 20 && badges.length < 22 ){
        $scope.anteriorimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/3.png';
        $scope.proximoFestaseBaladas = 25;
        $scope.proximoimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/3.2.png';
        document.getElementById("FestaseBaladas").src="img/badges/Categorias/FestaseBaladas/3.1.png"
      }
      if(badges.length >= 25 && badges.length < 30 ){
        $scope.anteriorimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/3.1.png';
        $scope.proximoFestaseBaladas = 30;
        $scope.proximoimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/3.3.png';
        document.getElementById("FestaseBaladas").src="img/badges/Categorias/FestaseBaladas/3.2.png"
      }
      if(badges.length >= 30 && badges.length < 50 ){
        $scope.anteriorimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/3.2.png';
        $scope.proximoFestaseBaladas = 50;
        $scope.proximoimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/Super.png';
        document.getElementById("FestaseBaladas").src="img/badges/Categorias/FestaseBaladas/3.3.png"
      }

      if(badges.length >= 50){
        $scope.anteriorimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/3.3.png';
        $scope.proximoFestaseBaladas = 10000;
        $scope.proximoimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/Super.png';
        document.getElementById("FestaseBaladas").src="img/badges/Categorias/FestaseBaladas/Super.png"
      }

    }else{
      $scope.auxnbadgeFestaseBaladas = 0;
        $scope.anteriorimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/0.png';
        $scope.proximoFestaseBaladas = 1;
        $scope.proximoimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/1.png';
      document.getElementById("FestaseBaladas").src="img/badges/Categorias/FestaseBaladas/0.png"
    }
  });

  $scope.aux.tag = "#Futebol";
  $scope.auxnbadgeFutebol = 0;
  $scope.proximoFutebol = 0;
  $scope.proximoimgFutebol = '';
  $scope.anteriorimgFutebol = '';
  EventoService.getbadges($scope.aux).then(function(badges){
    console.log("badges", badges);
    if(badges!="Error" && badges !="E"){
      $scope.auxnbadgeFutebol = badges.length;
      if(badges.length == 0){
        $scope.anteriorimgFutebol = 'img/badges/Categorias/Futebol/0.png';
        $scope.proximoFutebol = 1;
        $scope.proximoimgFutebol = 'img/badges/Categorias/Futebol/1.png';
        document.getElementById("Futebol").src="img/badges/Categorias/Futebol/0.png"
      }
      if(badges.length == 1){
        $scope.anteriorimgFutebol = 'img/badges/Categorias/Futebol/0.png';
        $scope.proximoFutebol = 2;
        $scope.proximoimgFutebol = 'img/badges/Categorias/Futebol/1.1.png';
        document.getElementById("Futebol").src="img/badges/Categorias/Futebol/1.png"
      }
      if(badges.length == 2){
        $scope.anteriorimgFutebol = 'img/badges/Categorias/Futebol/1.png';
        $scope.proximoFutebol = 3;
        $scope.proximoimgFutebol = 'img/badges/Categorias/Futebol/1.2.png';
        document.getElementById("Futebol").src="img/badges/Categorias/Futebol/1.1.png"
      }
      if(badges.length == 3){
        $scope.anteriorimgFutebol = 'img/badges/Categorias/Futebol/1.1.png';
        $scope.proximoFutebol = 4;
        $scope.proximoimgFutebol = 'img/badges/Categorias/Futebol/1.3.png';
        document.getElementById("Futebol").src="img/badges/Categorias/Futebol/1.2.png"
      }
      if(badges.length == 4 || badges.length == 5){
        $scope.anteriorimgFutebol = 'img/badges/Categorias/Futebol/1.2.png';
        $scope.proximoFutebol = 6;
        $scope.proximoimgFutebol = 'img/badges/Categorias/Futebol/2.png';
        document.getElementById("Futebol").src="img/badges/Categorias/Futebol/1.3.png"
      }

      if(badges.length == 6 || badges.length == 7){
        $scope.anteriorimgFutebol = 'img/badges/Categorias/Futebol/1.3.png';
        $scope.proximoFutebol = 8;
        $scope.proximoimgFutebol = 'img/badges/Categorias/Futebol/2.1.png';
        document.getElementById("Futebol").src="img/badges/Categorias/Futebol/2.png"
      }
      if(badges.length == 8 || badges.length == 9){
        $scope.anteriorimgFutebol = 'img/badges/Categorias/Futebol/2.png';
        $scope.proximoFutebol = 10;
        $scope.proximoimgFutebol = 'img/badges/Categorias/Futebol/2.2.png';
        document.getElementById("Futebol").src="img/badges/Categorias/Futebol/2.1.png"
      }
      if(badges.length == 10 || badges.length == 11){
        $scope.anteriorimgFutebol = 'img/badges/Categorias/Futebol/2.1.png';
        $scope.proximoFutebol = 12;
        $scope.proximoimgFutebol = 'img/badges/Categorias/Futebol/2.3.png';
        document.getElementById("Futebol").src="img/badges/Categorias/Futebol/2.2.png"
      }
      if(badges.length == 12 || badges.length == 13 || badges.length == 14){
        $scope.anteriorimgFutebol = 'img/badges/Categorias/Futebol/2.2.png';
        $scope.proximoFutebol = 15;
        $scope.proximoimgFutebol = 'img/badges/Categorias/Futebol/3.png';
        document.getElementById("Futebol").src="img/badges/Categorias/Futebol/2.3.png"
      }

      if(badges.length >= 15 && badges.length < 20 ){
        $scope.anteriorimgFutebol = 'img/badges/Categorias/Futebol/2.3.png';
        $scope.proximoFutebol = 20;
        $scope.proximoimgFutebol = 'img/badges/Categorias/Futebol/3.1.png';
        document.getElementById("Futebol").src="img/badges/Categorias/Futebol/3.png"
      }
      if(badges.length >= 20 && badges.length < 22 ){
        $scope.anteriorimgFutebol = 'img/badges/Categorias/Futebol/3.png';
        $scope.proximoFutebol = 25;
        $scope.proximoimgFutebol = 'img/badges/Categorias/Futebol/3.2.png';
        document.getElementById("Futebol").src="img/badges/Categorias/Futebol/3.1.png"
      }
      if(badges.length >= 25 && badges.length < 30 ){
        $scope.anteriorimgFutebol = 'img/badges/Categorias/Futebol/3.1.png';
        $scope.proximoFutebol = 30;
        $scope.proximoimgFutebol = 'img/badges/Categorias/Futebol/3.3.png';
        document.getElementById("Futebol").src="img/badges/Categorias/Futebol/3.2.png"
      }
      if(badges.length >= 30 && badges.length < 50 ){
        $scope.anteriorimgFutebol = 'img/badges/Categorias/Futebol/3.2.png';
        $scope.proximoFutebol = 50;
        $scope.proximoimgFutebol = 'img/badges/Categorias/Futebol/Super.png';
        document.getElementById("Futebol").src="img/badges/Categorias/Futebol/3.3.png"
      }

      if(badges.length >= 50){
        $scope.anteriorimgFutebol = 'img/badges/Categorias/Futebol/3.3.png';
        $scope.proximoFutebol = 10000;
        $scope.proximoimgFutebol = 'img/badges/Categorias/Futebol/Super.png';
        document.getElementById("Futebol").src="img/badges/Categorias/Futebol/Super.png"
      }

    }else{
      $scope.auxnbadgeFutebol = 0;

        $scope.anteriorimgFutebol = 'img/badges/Categorias/Futebol/0.png';
        $scope.proximoFutebol = 1;
        $scope.proximoimgFutebol = 'img/badges/Categorias/Futebol/1.png';
      document.getElementById("Futebol").src="img/badges/Categorias/Futebol/0.png"
    }
  });

  $scope.aux.tag = "#GrupodeEstudos";
  $scope.auxnbadgeGrupodeEstudos = 0;
  $scope.proximoGrupodeEstudos = 0;
  $scope.proximoimgGrupodeEstudos = '';
  $scope.anteriorimgGrupodeEstudos = '';
  EventoService.getbadges($scope.aux).then(function(badges){
    console.log("badges", badges);
    if(badges!="Error" && badges !="E"){
      $scope.auxnbadgeGrupodeEstudos = badges.length;
      if(badges.length == 0){
        $scope.anteriorimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/0.png';
        $scope.proximoGrupodeEstudos = 1;
        $scope.proximoimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/1.png';
        document.getElementById("GrupodeEstudos").src="img/badges/Categorias/GrupodeEstudos/0.png"
      }
      if(badges.length == 1){
        $scope.anteriorimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/0.png';
        $scope.proximoGrupodeEstudos = 2;
        $scope.proximoimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/1.1.png';
        document.getElementById("GrupodeEstudos").src="img/badges/Categorias/GrupodeEstudos/1.png"
      }
      if(badges.length == 2){
        $scope.anteriorimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/1.png';
        $scope.proximoGrupodeEstudos = 3;
        $scope.proximoimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/1.2.png';
        document.getElementById("GrupodeEstudos").src="img/badges/Categorias/GrupodeEstudos/1.1.png"
      }
      if(badges.length == 3){
        $scope.anteriorimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/1.1.png';
        $scope.proximoGrupodeEstudos = 4;
        $scope.proximoimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/1.3.png';
        document.getElementById("GrupodeEstudos").src="img/badges/Categorias/GrupodeEstudos/1.2.png"
      }
      if(badges.length == 4 || badges.length == 5){
        $scope.anteriorimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/1.2.png';
        $scope.proximoGrupodeEstudos = 6;
        $scope.proximoimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/2.png';
        document.getElementById("GrupodeEstudos").src="img/badges/Categorias/GrupodeEstudos/1.3.png"
      }

      if(badges.length == 6 || badges.length == 7){
        $scope.anteriorimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/1.3.png';
        $scope.proximoGrupodeEstudos = 8;
        $scope.proximoimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/2.1.png';
        document.getElementById("GrupodeEstudos").src="img/badges/Categorias/GrupodeEstudos/2.png"
      }
      if(badges.length == 8 || badges.length == 9){
        $scope.anteriorimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/2.png';
        $scope.proximoGrupodeEstudos = 10;
        $scope.proximoimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/2.2.png';
        document.getElementById("GrupodeEstudos").src="img/badges/Categorias/GrupodeEstudos/2.1.png"
      }
      if(badges.length == 10 || badges.length == 11){
        $scope.anteriorimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/2.1.png';
        $scope.proximoGrupodeEstudos = 12;
        $scope.proximoimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/2.3.png';
        document.getElementById("GrupodeEstudos").src="img/badges/Categorias/GrupodeEstudos/2.2.png"
      }
      if(badges.length == 12 || badges.length == 13 || badges.length == 14){
        $scope.anteriorimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/2.2.png';
        $scope.proximoGrupodeEstudos = 15;
        $scope.proximoimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/3.png';
        document.getElementById("GrupodeEstudos").src="img/badges/Categorias/GrupodeEstudos/2.3.png"
      }

      if(badges.length >= 15 && badges.length < 20 ){
        $scope.anteriorimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/2.3.png';
        $scope.proximoGrupodeEstudos = 20;
        $scope.proximoimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/3.1.png';
        document.getElementById("GrupodeEstudos").src="img/badges/Categorias/GrupodeEstudos/3.png"
      }
      if(badges.length >= 20 && badges.length < 22 ){
        $scope.anteriorimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/3.png';
        $scope.proximoGrupodeEstudos = 25;
        $scope.proximoimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/3.2.png';
        document.getElementById("GrupodeEstudos").src="img/badges/Categorias/GrupodeEstudos/3.1.png"
      }
      if(badges.length >= 25 && badges.length < 30 ){
        $scope.anteriorimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/3.1.png';
        $scope.proximoGrupodeEstudos = 30;
        $scope.proximoimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/3.3.png';
        document.getElementById("GrupodeEstudos").src="img/badges/Categorias/GrupodeEstudos/3.2.png"
      }
      if(badges.length >= 30 && badges.length < 50 ){
        $scope.anteriorimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/3.2.png';
        $scope.proximoGrupodeEstudos = 50;
        $scope.proximoimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/Super.png';
        document.getElementById("GrupodeEstudos").src="img/badges/Categorias/GrupodeEstudos/3.3.png"
      }

      if(badges.length >= 50){
        $scope.anteriorimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/3.3.png';
        $scope.proximoGrupodeEstudos = 10000;
        $scope.proximoimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/Super.png';
        document.getElementById("GrupodeEstudos").src="img/badges/Categorias/GrupodeEstudos/Super.png"
      }

    }else{
      $scope.auxnbadgeGrupodeEstudos = 0;
        $scope.anteriorimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/0.png';
        $scope.proximoGrupodeEstudos = 1;
        $scope.proximoimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/1.png';
      document.getElementById("GrupodeEstudos").src="img/badges/Categorias/GrupodeEstudos/0.png"
    }
  });

  $scope.aux.tag = "#Jogos";
  $scope.auxnbadgeJogos = 0;
  $scope.proximoJogos = 0;
  $scope.proximoimgJogos = '';
  $scope.anteriorimgJogos = '';
  EventoService.getbadges($scope.aux).then(function(badges){
    //console.log("badges", badges);
    if(badges!="Error" && badges !="E"){
      $scope.auxnbadgeJogos = badges.length;
      if(badges.length == 0){
        $scope.anteriorimgJogos = 'img/badges/Categorias/Jogos/0.png';
        $scope.proximoJogos = 1;
        $scope.proximoimgJogos = 'img/badges/Categorias/Jogos/1.png';
        document.getElementById("Jogos").src="img/badges/Categorias/Jogos/0.png"
      }
      if(badges.length == 1){
        $scope.anteriorimgJogos = 'img/badges/Categorias/Jogos/0.png';
        $scope.proximoJogos = 2;
        $scope.proximoimgJogos = 'img/badges/Categorias/Jogos/1.1.png';
        document.getElementById("Jogos").src="img/badges/Categorias/Jogos/1.png"
      }
      if(badges.length == 2){
        $scope.anteriorimgJogos = 'img/badges/Categorias/Jogos/1.png';
        $scope.proximoJogos = 3;
        $scope.proximoimgJogos = 'img/badges/Categorias/Jogos/1.2.png';
        document.getElementById("Jogos").src="img/badges/Categorias/Jogos/1.1.png"
      }
      if(badges.length == 3){
        $scope.anteriorimgJogos = 'img/badges/Categorias/Jogos/1.1.png';
        $scope.proximoJogos = 4;
        $scope.proximoimgJogos = 'img/badges/Categorias/Jogos/1.3.png';
        document.getElementById("Jogos").src="img/badges/Categorias/Jogos/1.2.png"
      }
      if(badges.length == 4 || badges.length == 5){
        $scope.anteriorimgJogos = 'img/badges/Categorias/Jogos/1.2.png';
        $scope.proximoJogos = 6;
        $scope.proximoimgJogos = 'img/badges/Categorias/Jogos/2.png';
        document.getElementById("Jogos").src="img/badges/Categorias/Jogos/1.3.png"
      }

      if(badges.length == 6 || badges.length == 7){
        $scope.anteriorimgJogos = 'img/badges/Categorias/Jogos/1.3.png';
        $scope.proximoJogos = 8;
        $scope.proximoimgJogos = 'img/badges/Categorias/Jogos/2.1.png';
        document.getElementById("Jogos").src="img/badges/Categorias/Jogos/2.png"
      }
      if(badges.length == 8 || badges.length == 9){
        $scope.anteriorimgJogos = 'img/badges/Categorias/Jogos/2.png';
        $scope.proximoJogos = 10;
        $scope.proximoimgJogos = 'img/badges/Categorias/Jogos/2.2.png';
        document.getElementById("Jogos").src="img/badges/Categorias/Jogos/2.1.png"
      }
      if(badges.length == 10 || badges.length == 11){
        $scope.anteriorimgJogos = 'img/badges/Categorias/Jogos/2.1.png';
        $scope.proximoJogos = 12;
        $scope.proximoimgJogos = 'img/badges/Categorias/Jogos/2.3.png';
        document.getElementById("Jogos").src="img/badges/Categorias/Jogos/2.2.png"
      }
      if(badges.length == 12 || badges.length == 13 || badges.length == 14){
        $scope.anteriorimgJogos = 'img/badges/Categorias/Jogos/2.2.png';
        $scope.proximoJogos = 15;
        $scope.proximoimgJogos = 'img/badges/Categorias/Jogos/3.png';
        document.getElementById("Jogos").src="img/badges/Categorias/Jogos/2.3.png"
      }

      if(badges.length >= 15 && badges.length < 20 ){
        $scope.anteriorimgJogos = 'img/badges/Categorias/Jogos/2.3.png';
        $scope.proximoJogos = 20;
        $scope.proximoimgJogos = 'img/badges/Categorias/Jogos/3.1.png';
        document.getElementById("Jogos").src="img/badges/Categorias/Jogos/3.png"
      }
      if(badges.length >= 20 && badges.length < 22 ){
        $scope.anteriorimgJogos = 'img/badges/Categorias/Jogos/3.png';
        $scope.proximoJogos = 25;
        $scope.proximoimgJogos = 'img/badges/Categorias/Jogos/3.2.png';
        document.getElementById("Jogos").src="img/badges/Categorias/Jogos/3.1.png"
      }
      if(badges.length >= 25 && badges.length < 30 ){
        $scope.anteriorimgJogos = 'img/badges/Categorias/Jogos/3.1.png';
        $scope.proximoJogos = 30;
        $scope.proximoimgJogos = 'img/badges/Categorias/Jogos/3.3.png';
        document.getElementById("Jogos").src="img/badges/Categorias/Jogos/3.2.png"
      }
      if(badges.length >= 30 && badges.length < 50 ){
        $scope.anteriorimgJogos = 'img/badges/Categorias/Jogos/3.2.png';
        $scope.proximoJogos = 50;
        $scope.proximoimgJogos = 'img/badges/Categorias/Jogos/Super.png';
        document.getElementById("Jogos").src="img/badges/Categorias/Jogos/3.3.png"
      }

      if(badges.length >= 50){
        $scope.anteriorimgJogos = 'img/badges/Categorias/Jogos/3.3.png';
        $scope.proximoJogos = 10000;
        $scope.proximoimgJogos = 'img/badges/Categorias/Jogos/Super.png';
        document.getElementById("Jogos").src="img/badges/Categorias/Jogos/Super.png"
      }

    }else{
      $scope.auxnbadgeJogos = 0;
        $scope.anteriorimgJogos = 'img/badges/Categorias/Jogos/0.png';
        $scope.proximoJogos = 1;
        $scope.proximoimgJogos = 'img/badges/Categorias/Jogos/1.png';
      document.getElementById("Jogos").src="img/badges/Categorias/Jogos/0.png"
    }
  });

  $scope.aux.tag = "#Musica";
  $scope.auxnbadgeMusica = 0;
  $scope.proximoMusica = 0;
  $scope.proximoimgMusica = '';
  $scope.anteriorimgMusica = '';
  EventoService.getbadges($scope.aux).then(function(badges){
    //console.log("badges", badges);
    if(badges!="Error" && badges !="E"){
      $scope.auxnbadgeMusica = badges.length;
      if(badges.length == 0){
        $scope.anteriorimgMusica = 'img/badges/Categorias/Musica/0.png';
        $scope.proximoMusica = 1;
        $scope.proximoimgMusica = 'img/badges/Categorias/Musica/1.png';
        document.getElementById("Musica").src="img/badges/Categorias/Musica/0.png"
      }
      if(badges.length == 1){
        $scope.anteriorimgMusica = 'img/badges/Categorias/Musica/0.png';
        $scope.proximoMusica = 2;
        $scope.proximoimgMusica = 'img/badges/Categorias/Musica/1.1.png';
        document.getElementById("Musica").src="img/badges/Categorias/Musica/1.png"
      }
      if(badges.length == 2){
        $scope.anteriorimgMusica = 'img/badges/Categorias/Musica/1.png';
        $scope.proximoMusica = 3;
        $scope.proximoimgMusica = 'img/badges/Categorias/Musica/1.2.png';
        document.getElementById("Musica").src="img/badges/Categorias/Musica/1.1.png"
      }
      if(badges.length == 3){
        $scope.anteriorimgMusica = 'img/badges/Categorias/Musica/1.1.png';
        $scope.proximoMusica = 4;
        $scope.proximoimgMusica = 'img/badges/Categorias/Musica/1.3.png';
        document.getElementById("Musica").src="img/badges/Categorias/Musica/1.2.png"
      }
      if(badges.length == 4 || badges.length == 5){
        $scope.anteriorimgMusica = 'img/badges/Categorias/Musica/1.2.png';
        $scope.proximoMusica = 6;
        $scope.proximoimgMusica = 'img/badges/Categorias/Musica/2.png';
        document.getElementById("Musica").src="img/badges/Categorias/Musica/1.3.png"
      }

      if(badges.length == 6 || badges.length == 7){
        $scope.anteriorimgMusica = 'img/badges/Categorias/Musica/1.3.png';
        $scope.proximoMusica = 8;
        $scope.proximoimgMusica = 'img/badges/Categorias/Musica/2.1.png';
        document.getElementById("Musica").src="img/badges/Categorias/Musica/2.png"
      }
      if(badges.length == 8 || badges.length == 9){
        $scope.anteriorimgMusica = 'img/badges/Categorias/Musica/2.png';
        $scope.proximoMusica = 10;
        $scope.proximoimgMusica = 'img/badges/Categorias/Musica/2.2.png';
        document.getElementById("Musica").src="img/badges/Categorias/Musica/2.1.png"
      }
      if(badges.length == 10 || badges.length == 11){
        $scope.anteriorimgMusica = 'img/badges/Categorias/Musica/2.1.png';
        $scope.proximoMusica = 12;
        $scope.proximoimgMusica = 'img/badges/Categorias/Musica/2.3.png';
        document.getElementById("Musica").src="img/badges/Categorias/Musica/2.2.png"
      }
      if(badges.length == 12 || badges.length == 13 || badges.length == 14){
        $scope.anteriorimgMusica = 'img/badges/Categorias/Musica/2.2.png';
        $scope.proximoMusica = 15;
        $scope.proximoimgMusica = 'img/badges/Categorias/Musica/3.png';
        document.getElementById("Musica").src="img/badges/Categorias/Musica/2.3.png"
      }

      if(badges.length >= 15 && badges.length < 20 ){
        $scope.anteriorimgMusica = 'img/badges/Categorias/Musica/2.3.png';
        $scope.proximoMusica = 20;
        $scope.proximoimgMusica = 'img/badges/Categorias/Musica/3.1.png';
        document.getElementById("Musica").src="img/badges/Categorias/Musica/3.png"
      }
      if(badges.length >= 20 && badges.length < 22 ){
        $scope.anteriorimgMusica = 'img/badges/Categorias/Musica/3.png';
        $scope.proximoMusica = 25;
        $scope.proximoimgMusica = 'img/badges/Categorias/Musica/3.2.png';
        document.getElementById("Musica").src="img/badges/Categorias/Musica/3.1.png"
      }
      if(badges.length >= 25 && badges.length < 30 ){
        $scope.anteriorimgMusica = 'img/badges/Categorias/Musica/3.1.png';
        $scope.proximoMusica = 30;
        $scope.proximoimgMusica = 'img/badges/Categorias/Musica/3.3.png';
        document.getElementById("Musica").src="img/badges/Categorias/Musica/3.2.png"
      }
      if(badges.length >= 30 && badges.length < 50 ){
        $scope.anteriorimgMusica = 'img/badges/Categorias/Musica/3.2.png';
        $scope.proximoMusica = 50;
        $scope.proximoimgMusica = 'img/badges/Categorias/Musica/Super.png';
        document.getElementById("Musica").src="img/badges/Categorias/Musica/3.3.png"
      }

      if(badges.length >= 50){
        $scope.anteriorimgMusica = 'img/badges/Categorias/Musica/3.3.png';
        $scope.proximoMusica = 10000;
        $scope.proximoimgMusica = 'img/badges/Categorias/Musica/Super.png';
        document.getElementById("Musica").src="img/badges/Categorias/Musica/Super.png"
      }

    }else{
      $scope.auxnbadgeMusica = 0;
        $scope.anteriorimgMusica = 'img/badges/Categorias/Musica/0.png';
        $scope.proximoMusica = 1;
        $scope.proximoimgMusica = 'img/badges/Categorias/Musica/1.png';
      document.getElementById("Musica").src="img/badges/Categorias/Musica/0.png"
    }
  });

  $scope.aux.tag = "#Natureza";
  $scope.auxnbadgeNatureza = 0;
  $scope.proximoNatureza = 0;
  $scope.proximoimgNatureza = '';
  $scope.anteriorimgNatureza = '';
  EventoService.getbadges($scope.aux).then(function(badges){
    //console.log("badges", badges);
    if(badges!="Error" && badges !="E"){
      $scope.auxnbadgeNatureza = badges.length;
      if(badges.length == 0){
        $scope.anteriorimgNatureza = 'img/badges/Categorias/Natureza/0.png';
        $scope.proximoNatureza = 1;
        $scope.proximoimgNatureza = 'img/badges/Categorias/Natureza/1.png';
        document.getElementById("Natureza").src="img/badges/Categorias/Natureza/0.png"
      }
      if(badges.length == 1){
        $scope.anteriorimgNatureza = 'img/badges/Categorias/Natureza/0.png';
        $scope.proximoNatureza = 2;
        $scope.proximoimgNatureza = 'img/badges/Categorias/Natureza/1.1.png';
        document.getElementById("Natureza").src="img/badges/Categorias/Natureza/1.png"
      }
      if(badges.length == 2){
        $scope.anteriorimgNatureza = 'img/badges/Categorias/Natureza/1.png';
        $scope.proximoNatureza = 3;
        $scope.proximoimgNatureza = 'img/badges/Categorias/Natureza/1.2.png';
        document.getElementById("Natureza").src="img/badges/Categorias/Natureza/1.1.png"
      }
      if(badges.length == 3){
        $scope.anteriorimgNatureza = 'img/badges/Categorias/Natureza/1.1.png';
        $scope.proximoNatureza = 4;
        $scope.proximoimgNatureza = 'img/badges/Categorias/Natureza/1.3.png';
        document.getElementById("Natureza").src="img/badges/Categorias/Natureza/1.2.png"
      }
      if(badges.length == 4 || badges.length == 5){
        $scope.anteriorimgNatureza = 'img/badges/Categorias/Natureza/1.2.png';
        $scope.proximoNatureza = 6;
        $scope.proximoimgNatureza = 'img/badges/Categorias/Natureza/2.png';
        document.getElementById("Natureza").src="img/badges/Categorias/Natureza/1.3.png"
      }

      if(badges.length == 6 || badges.length == 7){
        $scope.anteriorimgNatureza = 'img/badges/Categorias/Natureza/1.3.png';
        $scope.proximoNatureza = 8;
        $scope.proximoimgNatureza = 'img/badges/Categorias/Natureza/2.1.png';
        document.getElementById("Natureza").src="img/badges/Categorias/Natureza/2.png"
      }
      if(badges.length == 8 || badges.length == 9){
        $scope.anteriorimgNatureza = 'img/badges/Categorias/Natureza/2.png';
        $scope.proximoNatureza = 10;
        $scope.proximoimgNatureza = 'img/badges/Categorias/Natureza/2.2.png';
        document.getElementById("Natureza").src="img/badges/Categorias/Natureza/2.1.png"
      }
      if(badges.length == 10 || badges.length == 11){
        $scope.anteriorimgNatureza = 'img/badges/Categorias/Natureza/2.1.png';
        $scope.proximoNatureza = 12;
        $scope.proximoimgNatureza = 'img/badges/Categorias/Natureza/2.3.png';
        document.getElementById("Natureza").src="img/badges/Categorias/Natureza/2.2.png"
      }
      if(badges.length == 12 || badges.length == 13 || badges.length == 14){
        $scope.anteriorimgNatureza = 'img/badges/Categorias/Natureza/2.2.png';
        $scope.proximoNatureza = 15;
        $scope.proximoimgNatureza = 'img/badges/Categorias/Natureza/3.png';
        document.getElementById("Natureza").src="img/badges/Categorias/Natureza/2.3.png"
      }

      if(badges.length >= 15 && badges.length < 20 ){
        $scope.anteriorimgNatureza = 'img/badges/Categorias/Natureza/2.3.png';
        $scope.proximoNatureza = 20;
        $scope.proximoimgNatureza = 'img/badges/Categorias/Natureza/3.1.png';
        document.getElementById("Natureza").src="img/badges/Categorias/Natureza/3.png"
      }
      if(badges.length >= 20 && badges.length < 22 ){
        $scope.anteriorimgNatureza = 'img/badges/Categorias/Natureza/3.png';
        $scope.proximoNatureza = 25;
        $scope.proximoimgNatureza = 'img/badges/Categorias/Natureza/3.2.png';
        document.getElementById("Natureza").src="img/badges/Categorias/Natureza/3.1.png"
      }
      if(badges.length >= 25 && badges.length < 30 ){
        $scope.anteriorimgNatureza = 'img/badges/Categorias/Natureza/3.1.png';
        $scope.proximoNatureza = 30;
        $scope.proximoimgNatureza = 'img/badges/Categorias/Natureza/3.3.png';
        document.getElementById("Natureza").src="img/badges/Categorias/Natureza/3.2.png"
      }
      if(badges.length >= 30 && badges.length < 50 ){
        $scope.anteriorimgNatureza = 'img/badges/Categorias/Natureza/3.2.png';
        $scope.proximoNatureza = 50;
        $scope.proximoimgNatureza = 'img/badges/Categorias/Natureza/Super.png';
        document.getElementById("Natureza").src="img/badges/Categorias/Natureza/3.3.png"
      }

      if(badges.length >= 50){
        $scope.anteriorimgNatureza = 'img/badges/Categorias/Natureza/3.3.png';
        $scope.proximoNatureza = 10000;
        $scope.proximoimgNatureza = 'img/badges/Categorias/Natureza/Super.png';
        document.getElementById("Natureza").src="img/badges/Categorias/Natureza/Super.png"
      }

    }else{
      $scope.auxnbadgeNatureza = 0;
        $scope.anteriorimgNatureza = 'img/badges/Categorias/Natureza/0.png';
        $scope.proximoNatureza = 1;
        $scope.proximoimgNatureza = 'img/badges/Categorias/Natureza/1.png';
      document.getElementById("Natureza").src="img/badges/Categorias/Natureza/0.png"
    }
  });

  $scope.aux.tag = "#Passeio";
  $scope.auxnbadgePasseio = 0;
  $scope.proximoPasseio = 0;
  $scope.proximoimgPasseio = '';
  $scope.anteriorimgPasseio = '';
  EventoService.getbadges($scope.aux).then(function(badges){
    //console.log("badges", badges);
    if(badges!="Error" && badges !="E"){
      $scope.auxnbadgePasseio = badges.length;
      if(badges.length == 0){
        $scope.anteriorimgPasseio = 'img/badges/Categorias/Passeio/0.png';
        $scope.proximoPasseio = 1;
        $scope.proximoimgPasseio = 'img/badges/Categorias/Passeio/1.png';
        document.getElementById("Passeio").src="img/badges/Categorias/Passeio/0.png"
      }
      if(badges.length == 1){
        $scope.anteriorimgPasseio = 'img/badges/Categorias/Passeio/0.png';
        $scope.proximoPasseio = 2;
        $scope.proximoimgPasseio = 'img/badges/Categorias/Passeio/1.1.png';
        document.getElementById("Passeio").src="img/badges/Categorias/Passeio/1.png"
      }
      if(badges.length == 2){
        $scope.anteriorimgPasseio = 'img/badges/Categorias/Passeio/1.png';
        $scope.proximoPasseio = 3;
        $scope.proximoimgPasseio = 'img/badges/Categorias/Passeio/1.2.png';
        document.getElementById("Passeio").src="img/badges/Categorias/Passeio/1.1.png"
      }
      if(badges.length == 3){
        $scope.anteriorimgPasseio = 'img/badges/Categorias/Passeio/1.1.png';
        $scope.proximoPasseio = 4;
        $scope.proximoimgPasseio = 'img/badges/Categorias/Passeio/1.3.png';
        document.getElementById("Passeio").src="img/badges/Categorias/Passeio/1.2.png"
      }
      if(badges.length == 4 || badges.length == 5){
        $scope.anteriorimgPasseio = 'img/badges/Categorias/Passeio/1.2.png';
        $scope.proximoPasseio = 6;
        $scope.proximoimgPasseio = 'img/badges/Categorias/Passeio/2.png';
        document.getElementById("Passeio").src="img/badges/Categorias/Passeio/1.3.png"
      }

      if(badges.length == 6 || badges.length == 7){
        $scope.anteriorimgPasseio = 'img/badges/Categorias/Passeio/1.3.png';
        $scope.proximoPasseio = 8 ;
        $scope.proximoimgPasseio = 'img/badges/Categorias/Passeio/2.1.png';
        document.getElementById("Passeio").src="img/badges/Categorias/Passeio/2.png"
      }
      if(badges.length == 8 || badges.length == 9){
        $scope.anteriorimgPasseio = 'img/badges/Categorias/Passeio/2.png';
        $scope.proximoPasseio = 10;
        $scope.proximoimgPasseio = 'img/badges/Categorias/Passeio/2.2.png';
        document.getElementById("Passeio").src="img/badges/Categorias/Passeio/2.1.png"
      }
      if(badges.length == 10 || badges.length == 11){
        $scope.anteriorimgPasseio = 'img/badges/Categorias/Passeio/2.1.png';
        $scope.proximoPasseio = 12;
        $scope.proximoimgPasseio = 'img/badges/Categorias/Passeio/2.3.png';
        document.getElementById("Passeio").src="img/badges/Categorias/Passeio/2.2.png"
      }
      if(badges.length == 12 || badges.length == 13 || badges.length == 14){
        $scope.anteriorimgPasseio = 'img/badges/Categorias/Passeio/2.2.png';
        $scope.proximoPasseio = 15;
        $scope.proximoimgPasseio = 'img/badges/Categorias/Passeio/3.png';
        document.getElementById("Passeio").src="img/badges/Categorias/Passeio/2.3.png"
      }

      if(badges.length >= 15 && badges.length < 20 ){
        $scope.anteriorimgPasseio = 'img/badges/Categorias/Passeio/2.3.png';
        $scope.proximoPasseio = 20;
        $scope.proximoimgPasseio = 'img/badges/Categorias/Passeio/3.1.png';
        document.getElementById("Passeio").src="img/badges/Categorias/Passeio/3.png"
      }
      if(badges.length >= 20 && badges.length < 22 ){
        $scope.anteriorimgPasseio = 'img/badges/Categorias/Passeio/3.png';
        $scope.proximoPasseio = 25;
        $scope.proximoimgPasseio = 'img/badges/Categorias/Passeio/3.2.png';
        document.getElementById("Passeio").src="img/badges/Categorias/Passeio/3.1.png"
      }
      if(badges.length >= 25 && badges.length < 30 ){
        $scope.anteriorimgPasseio = 'img/badges/Categorias/Passeio/3.1.png';
        $scope.proximoPasseio = 30;
        $scope.proximoimgPasseio = 'img/badges/Categorias/Passeio/3.3.png';
        document.getElementById("Passeio").src="img/badges/Categorias/Passeio/3.2.png"
      }
      if(badges.length >= 30 && badges.length < 50 ){
        $scope.anteriorimgPasseio = 'img/badges/Categorias/Passeio/3.2.png';
        $scope.proximoPasseio = 50;
        $scope.proximoimgPasseio = 'img/badges/Categorias/Passeio/Super.png';
        document.getElementById("Passeio").src="img/badges/Categorias/Passeio/3.3.png"
      }

      if(badges.length >= 50){
        $scope.anteriorimgPasseio = 'img/badges/Categorias/Passeio/3.3.png';
        $scope.proximoPasseio = 10000;
        $scope.proximoimgPasseio = 'img/badges/Categorias/Passeio/Super.png';
        document.getElementById("Passeio").src="img/badges/Categorias/Passeio/Super.png"
      }

    }else{
      $scope.auxnbadgePasseio = 0;
        $scope.anteriorimgPasseio = 'img/badges/Categorias/Passeio/0.png';
        $scope.proximoPasseio = 1;
        $scope.proximoimgPasseio = 'img/badges/Categorias/Passeio/1.png';
      document.getElementById("Passeio").src="img/badges/Categorias/Passeio/0.png"
    }
  });

  $scope.aux.tag = "#Pets";
  $scope.auxnbadgePets = 0;
  $scope.proximoPets = 0;
  $scope.proximoimgPets = '';
  $scope.anteriorimgPets = '';
  EventoService.getbadges($scope.aux).then(function(badges){
    //console.log("badges", badges);
    if(badges!="Error" && badges !="E"){
      $scope.auxnbadgePets = badges.length;
      if(badges.length == 0){
        $scope.anteriorimgPets = 'img/badges/Categorias/Pets/0.png';
        $scope.proximoPets = 1;
        $scope.proximoimgPets = 'img/badges/Categorias/Pets/1.png';
        document.getElementById("Pets").src="img/badges/Categorias/Pets/0.png"
      }
      if(badges.length == 1){
        $scope.anteriorimgPets = 'img/badges/Categorias/Pets/0.png';
        $scope.proximoPets = 2;
        $scope.proximoimgPets = 'img/badges/Categorias/Pets/1.1.png';
        document.getElementById("Pets").src="img/badges/Categorias/Pets/1.png"
      }
      if(badges.length == 2){
        $scope.anteriorimgPets = 'img/badges/Categorias/Pets/1.png';
        $scope.proximoPets = 3;
        $scope.proximoimgPets = 'img/badges/Categorias/Pets/1.2.png';
        document.getElementById("Pets").src="img/badges/Categorias/Pets/1.1.png"
      }
      if(badges.length == 3){
        $scope.anteriorimgPets = 'img/badges/Categorias/Pets/1.1.png';
        $scope.proximoPets = 4;
        $scope.proximoimgPets = 'img/badges/Categorias/Pets/1.3.png';
        document.getElementById("Pets").src="img/badges/Categorias/Pets/1.2.png"
      }
      if(badges.length == 4 || badges.length == 5){
        $scope.anteriorimgPets = 'img/badges/Categorias/Pets/1.2.png';
        $scope.proximoPets = 6;
        $scope.proximoimgPets = 'img/badges/Categorias/Pets/2.png';
        document.getElementById("Pets").src="img/badges/Categorias/Pets/1.3.png"
      }

      if(badges.length == 6 || badges.length == 7){
        $scope.anteriorimgPets = 'img/badges/Categorias/Pets/1.3.png';
        $scope.proximoPets = 8;
        $scope.proximoimgPets = 'img/badges/Categorias/Pets/2.1.png';
        document.getElementById("Pets").src="img/badges/Categorias/Pets/2.png"
      }
      if(badges.length == 8 || badges.length == 9){
        $scope.anteriorimgPets = 'img/badges/Categorias/Pets/2.png';
        $scope.proximoPets = 10;
        $scope.proximoimgPets = 'img/badges/Categorias/Pets/2.2.png';
        document.getElementById("Pets").src="img/badges/Categorias/Pets/2.1.png"
      }
      if(badges.length == 10 || badges.length == 11){
        $scope.anteriorimgPets = 'img/badges/Categorias/Pets/2.1.png';
        $scope.proximoPets = 12;
        $scope.proximoimgPets = 'img/badges/Categorias/Pets/2.3.png';
        document.getElementById("Pets").src="img/badges/Categorias/Pets/2.2.png"
      }
      if(badges.length == 12 || badges.length == 13 || badges.length == 14){
        $scope.anteriorimgPets = 'img/badges/Categorias/Pets/2.2.png';
        $scope.proximoPets = 15;
        $scope.proximoimgPets = 'img/badges/Categorias/Pets/3.png';
        document.getElementById("Pets").src="img/badges/Categorias/Pets/2.3.png"
      }

      if(badges.length >= 15 && badges.length < 20 ){
        $scope.anteriorimgPets = 'img/badges/Categorias/Pets/2.3.png';
        $scope.proximoPets = 20;
        $scope.proximoimgPets = 'img/badges/Categorias/Pets/3.1.png';
        document.getElementById("Pets").src="img/badges/Categorias/Pets/3.png"
      }
      if(badges.length >= 20 && badges.length < 22 ){
        $scope.anteriorimgPets = 'img/badges/Categorias/Pets/3.png';
        $scope.proximoPets = 25;
        $scope.proximoimgPets = 'img/badges/Categorias/Pets/3.2.png';
        document.getElementById("Pets").src="img/badges/Categorias/Pets/3.1.png"
      }
      if(badges.length >= 25 && badges.length < 30 ){
        $scope.anteriorimgPets = 'img/badges/Categorias/Pets/3.1.png';
        $scope.proximoPets = 30;
        $scope.proximoimgPets = 'img/badges/Categorias/Pets/3.3.png';
        document.getElementById("Pets").src="img/badges/Categorias/Pets/3.2.png"
      }
      if(badges.length >= 30 && badges.length < 50 ){
        $scope.anteriorimgPets = 'img/badges/Categorias/Pets/3.2.png';
        $scope.proximoPets = 50;
        $scope.proximoimgPets = 'img/badges/Categorias/Pets/Super.png';
        document.getElementById("Pets").src="img/badges/Categorias/Pets/3.3.png"
      }

      if(badges.length >= 50){
        $scope.anteriorimgPets = 'img/badges/Categorias/Pets/3.3.png';
        $scope.proximoPets = 10000;
        $scope.proximoimgPets = 'img/badges/Categorias/Pets/Super.png';
        document.getElementById("Pets").src="img/badges/Categorias/Pets/Super.png"
      }

    }else{
      $scope.auxnbadgePets = 0;
        $scope.anteriorimgPets = 'img/badges/Categorias/Pets/0.png';
        $scope.proximoPets = 1;
        $scope.proximoimgPets = 'img/badges/Categorias/Pets/1.png';
      document.getElementById("Pets").src="img/badges/Categorias/Pets/0.png"
    }
  });

  $scope.aux.tag = "#Restaurantesebares";
  $scope.auxnbadgeRestaurantesebares = 0;
  $scope.proximoRestaurantesebares = 0;
  $scope.proximoimgRestaurantesebares = '';
  $scope.anteriorimgRestaurantesebares = '';
  EventoService.getbadges($scope.aux).then(function(badges){
    //console.log("badges", badges);
    if(badges!="Error" && badges !="E"){
      $scope.auxnbadgeRestaurantesebares = badges.length ;
      if(badges.length == 0){
        $scope.anteriorimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/0.png';
        $scope.proximoRestaurantesebares = 1;
        $scope.proximoimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/1.png';
        document.getElementById("Restaurantesebares").src="img/badges/Categorias/Restaurantesebares/0.png"
      }
      if(badges.length == 1){
        $scope.anteriorimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/0.png';
        $scope.proximoRestaurantesebares = 2;
        $scope.proximoimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/1.1.png';
        document.getElementById("Restaurantesebares").src="img/badges/Categorias/Restaurantesebares/1.png"
      }
      if(badges.length == 2){
        $scope.anteriorimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/1.png';
        $scope.proximoRestaurantesebares = 3;
        $scope.proximoimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/1.2.png';
        document.getElementById("Restaurantesebares").src="img/badges/Categorias/Restaurantesebares/1.1.png"
      }
      if(badges.length == 3){
        $scope.anteriorimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/1.1.png';
        $scope.proximoRestaurantesebares = 4;
        $scope.proximoimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/1.3.png';
        document.getElementById("Restaurantesebares").src="img/badges/Categorias/Restaurantesebares/1.2.png"
      }
      if(badges.length == 4 || badges.length == 5){
        $scope.anteriorimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/1.2.png';
        $scope.proximoRestaurantesebares = 6;
        $scope.proximoimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/2.png';
        document.getElementById("Restaurantesebares").src="img/badges/Categorias/Restaurantesebares/1.3.png"
      }

      if(badges.length == 6 || badges.length == 7){
        $scope.anteriorimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/1.3.png';
        $scope.proximoRestaurantesebares = 8;
        $scope.proximoimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/2.1.png';
        document.getElementById("Restaurantesebares").src="img/badges/Categorias/Restaurantesebares/2.png"
      }
      if(badges.length == 8 || badges.length == 9){
        $scope.anteriorimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/2.png';
        $scope.proximoRestaurantesebares = 10;
        $scope.proximoimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/2.2.png';
        document.getElementById("Restaurantesebares").src="img/badges/Categorias/Restaurantesebares/2.1.png"
      }
      if(badges.length == 10 || badges.length == 11){
        $scope.anteriorimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/2.1.png';
        $scope.proximoRestaurantesebares = 12;
        $scope.proximoimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/2.3.png';
        document.getElementById("Restaurantesebares").src="img/badges/Categorias/Restaurantesebares/2.2.png"
      }
      if(badges.length == 12 || badges.length == 13 || badges.length == 14){
        $scope.anteriorimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/2.2.png';
        $scope.proximoRestaurantesebares = 15;
        $scope.proximoimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/3.png';
        document.getElementById("Restaurantesebares").src="img/badges/Categorias/Restaurantesebares/2.3.png"
      }

      if(badges.length >= 15 && badges.length < 20 ){
        $scope.anteriorimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/2.3.png';
        $scope.proximoRestaurantesebares = 20;
        $scope.proximoimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/3.1.png';
        document.getElementById("Restaurantesebares").src="img/badges/Categorias/Restaurantesebares/3.png"
      }
      if(badges.length >= 20 && badges.length < 22 ){
        $scope.anteriorimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/3.png';
        $scope.proximoRestaurantesebares = 25;
        $scope.proximoimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/3.2.png';
        document.getElementById("Restaurantesebares").src="img/badges/Categorias/Restaurantesebares/3.1.png"
      }
      if(badges.length >= 25 && badges.length < 30 ){
        $scope.anteriorimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/3.1.png';
        $scope.proximoRestaurantesebares = 30;
        $scope.proximoimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/3.3.png';
        document.getElementById("Restaurantesebares").src="img/badges/Categorias/Restaurantesebares/3.2.png"
      }
      if(badges.length >= 30 && badges.length < 50 ){
        $scope.anteriorimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/3.2.png';
        $scope.proximoRestaurantesebares = 50;
        $scope.proximoimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/Super.png';
        document.getElementById("Restaurantesebares").src="img/badges/Categorias/Restaurantesebares/3.3.png"
      }

      if(badges.length >= 50){
        $scope.anteriorimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/3.3.png';
        $scope.proximoRestaurantesebares = 10000;
        $scope.proximoimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/Super.png';
        document.getElementById("Restaurantesebares").src="img/badges/Categorias/Restaurantesebares/Super.png"
      }

    }else{
      $scope.auxnbadgeRestaurantesebares = 0;
        $scope.anteriorimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/0.png';
        $scope.proximoRestaurantesebares = 1;
        $scope.proximoimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/1.png';
      document.getElementById("Restaurantesebares").src="img/badges/Categorias/Restaurantesebares/0.png"
    }
  });

  $scope.aux.tag = "#Surf";
  $scope.auxnbadgeSurf = 0;
  $scope.proximoSurf = 0;
  $scope.proximoimgSurf = '';
  $scope.anteriorimgSurf = '';
  EventoService.getbadges($scope.aux).then(function(badges){
    //console.log("badges", badges);
    if(badges!="Error" && badges !="E"){
      $scope.auxnbadgeSurf = badges.length;
      if(badges.length == 0){
        $scope.anteriorimgSurf = 'img/badges/Categorias/Surf/0.png';
        $scope.proximoSurf = 1;
        $scope.proximoimgSurf = 'img/badges/Categorias/Surf/1.png';
        document.getElementById("Surf").src="img/badges/Categorias/Surf/0.png"
      }
      if(badges.length == 1){
        $scope.anteriorimgSurf = 'img/badges/Categorias/Surf/0.png';
        $scope.proximoSurf = 2;
        $scope.proximoimgSurf = 'img/badges/Categorias/Surf/1.1.png';
        document.getElementById("Surf").src="img/badges/Categorias/Surf/1.png"
      }
      if(badges.length == 2){
        $scope.anteriorimgSurf = 'img/badges/Categorias/Surf/1.png';
        $scope.proximoSurf = 3;
        $scope.proximoimgSurf = 'img/badges/Categorias/Surf/1.2.png';
        document.getElementById("Surf").src="img/badges/Categorias/Surf/1.1.png"
      }
      if(badges.length == 3){
        $scope.anteriorimgSurf = 'img/badges/Categorias/Surf/1.1.png';
        $scope.proximoSurf = 4;
        $scope.proximoimgSurf = 'img/badges/Categorias/Surf/1.3.png';
        document.getElementById("Surf").src="img/badges/Categorias/Surf/1.2.png"
      }
      if(badges.length == 4 || badges.length == 5){
        $scope.anteriorimgSurf = 'img/badges/Categorias/Surf/1.2.png';
        $scope.proximoSurf = 6;
        $scope.proximoimgSurf = 'img/badges/Categorias/Surf/2.png';
        document.getElementById("Surf").src="img/badges/Categorias/Surf/1.3.png"
      }

      if(badges.length == 6 || badges.length == 7){
        $scope.anteriorimgSurf = 'img/badges/Categorias/Surf/1.3.png';
        $scope.proximoSurf = 8;
        $scope.proximoimgSurf = 'img/badges/Categorias/Surf/2.1.png';
        document.getElementById("Surf").src="img/badges/Categorias/Surf/2.png"
      }
      if(badges.length == 8 || badges.length == 9){
        $scope.anteriorimgSurf = 'img/badges/Categorias/Surf/2.png';
        $scope.proximoSurf = 10;
        $scope.proximoimgSurf = 'img/badges/Categorias/Surf/2.2.png';
        document.getElementById("Surf").src="img/badges/Categorias/Surf/2.1.png"
      }
      if(badges.length == 10 || badges.length == 11){
        $scope.anteriorimgSurf = 'img/badges/Categorias/Surf/2.1.png';
        $scope.proximoSurf = 12;
        $scope.proximoimgSurf = 'img/badges/Categorias/Surf/2.3.png';
        document.getElementById("Surf").src="img/badges/Categorias/Surf/2.2.png"
      }
      if(badges.length == 12 || badges.length == 13 || badges.length == 14){
        $scope.anteriorimgSurf = 'img/badges/Categorias/Surf/2.2.png';
        $scope.proximoSurf = 15;
        $scope.proximoimgSurf = 'img/badges/Categorias/Surf/3.png';
        document.getElementById("Surf").src="img/badges/Categorias/Surf/2.3.png"
      }

      if(badges.length >= 15 && badges.length < 20 ){
        $scope.anteriorimgSurf = 'img/badges/Categorias/Surf/2.3.png';
        $scope.proximoSurf = 20;
        $scope.proximoimgSurf = 'img/badges/Categorias/Surf/3.1.png';
        document.getElementById("Surf").src="img/badges/Categorias/Surf/3.png"
      }
      if(badges.length >= 20 && badges.length < 22 ){
        $scope.anteriorimgSurf = 'img/badges/Categorias/Surf/3.png';
        $scope.proximoSurf = 25;
        $scope.proximoimgSurf = 'img/badges/Categorias/Surf/3.2.png';
        document.getElementById("Surf").src="img/badges/Categorias/Surf/3.1.png"
      }
      if(badges.length >= 25 && badges.length < 30 ){
        $scope.anteriorimgSurf = 'img/badges/Categorias/Surf/3.1.png';
        $scope.proximoSurf = 30;
        $scope.proximoimgSurf = 'img/badges/Categorias/Surf/3.3.png';
        document.getElementById("Surf").src="img/badges/Categorias/Surf/3.2.png"
      }
      if(badges.length >= 30 && badges.length < 50 ){
        $scope.anteriorimgSurf = 'img/badges/Categorias/Surf/3.2.png';
        $scope.proximoSurf = 50;
        $scope.proximoimgSurf = 'img/badges/Categorias/Surf/Super.png';
        document.getElementById("Surf").src="img/badges/Categorias/Surf/3.3.png"
      }

      if(badges.length >= 50){
        $scope.anteriorimgSurf = 'img/badges/Categorias/Surf/3.3.png';
        $scope.proximoSurf = 10000;
        $scope.proximoimgSurf = 'img/badges/Categorias/Surf/Super.png';
        document.getElementById("Surf").src="img/badges/Categorias/Surf/Super.png"
      }

    }else{
      $scope.auxnbadgeSurf = 0;
        $scope.anteriorimgSurf = 'img/badges/Categorias/Surf/0.png';
        $scope.proximoSurf = 1;
        $scope.proximoimgSurf = 'img/badges/Categorias/Surf/1.png';
      document.getElementById("Surf").src="img/badges/Categorias/Surf/0.png"
    }
  });

  $scope.aux.tag = "#Voluntariado";
  $scope.auxnbadgeVoluntariado = 0;
  $scope.proximoVoluntariado = 0;
  $scope.proximoimgVoluntariado = '';
  $scope.anteriorimgVoluntariado = '';
  EventoService.getbadges($scope.aux).then(function(badges){
    //console.log("Voluntariado", badges);
    if(badges!="Error" && badges !="E"){
      $scope.auxnbadgeVoluntariado = badges.length;
      if(badges.length == 0){
        $scope.anteriorimgVoluntariado = 'img/badges/Categorias/Voluntariado/0.png';
        $scope.proximoVoluntariado = 1;
        $scope.proximoimgVoluntariado = 'img/badges/Categorias/Voluntariado/1.png';
        document.getElementById("Voluntariado").src="img/badges/Categorias/Voluntariado/0.png"
      }
      if(badges.length == 1){
        $scope.anteriorimgVoluntariado = 'img/badges/Categorias/Voluntariado/0.png';
        $scope.proximoVoluntariado = 2;
        $scope.proximoimgVoluntariado = 'img/badges/Categorias/Voluntariado/1.1.png';
        document.getElementById("Voluntariado").src="img/badges/Categorias/Voluntariado/1.png"
      }
      if(badges.length == 2){
        $scope.anteriorimgVoluntariado = 'img/badges/Categorias/Voluntariado/1.png';
        $scope.proximoVoluntariado = 3;
        $scope.proximoimgVoluntariado = 'img/badges/Categorias/Voluntariado/1.2.png';
        document.getElementById("Voluntariado").src="img/badges/Categorias/Voluntariado/1.1.png"
      }
      if(badges.length == 3){
        $scope.anteriorimgVoluntariado = 'img/badges/Categorias/Voluntariado/1.1.png';
        $scope.proximoVoluntariado = 4;
        $scope.proximoimgVoluntariado = 'img/badges/Categorias/Voluntariado/1.3.png';
        document.getElementById("Voluntariado").src="img/badges/Categorias/Voluntariado/1.2.png"
      }
      if(badges.length == 4 || badges.length == 5){
        $scope.anteriorimgVoluntariado = 'img/badges/Categorias/Voluntariado/1.2.png';
        $scope.proximoVoluntariado = 6;
        $scope.proximoimgVoluntariado = 'img/badges/Categorias/Voluntariado/2.png';
        document.getElementById("Voluntariado").src="img/badges/Categorias/Voluntariado/1.3.png"
      }

      if(badges.length == 6 || badges.length == 7){
        $scope.anteriorimgVoluntariado = 'img/badges/Categorias/Voluntariado/1.3.png';
        $scope.proximoVoluntariado = 8;
        $scope.proximoimgVoluntariado = 'img/badges/Categorias/Voluntariado/2.1.png';
        document.getElementById("Voluntariado").src="img/badges/Categorias/Voluntariado/2.png"
      }
      if(badges.length == 8 || badges.length == 9){
        $scope.anteriorimgVoluntariado = 'img/badges/Categorias/Voluntariado/2.png';
        $scope.proximoVoluntariado = 10;
        $scope.proximoimgVoluntariado = 'img/badges/Categorias/Voluntariado/2.2.png';
        document.getElementById("Voluntariado").src="img/badges/Categorias/Voluntariado/2.1.png"
      }
      if(badges.length == 10 || badges.length == 11){
        $scope.anteriorimgVoluntariado = 'img/badges/Categorias/Voluntariado/2.1.png';
        $scope.proximoVoluntariado = 12;
        $scope.proximoimgVoluntariado = 'img/badges/Categorias/Voluntariado/2.3.png';
        document.getElementById("Voluntariado").src="img/badges/Categorias/Voluntariado/2.2.png"
      }
      if(badges.length == 12 || badges.length == 13 || badges.length == 14){
        $scope.anteriorimgVoluntariado = 'img/badges/Categorias/Voluntariado/2.2.png';
        $scope.proximoVoluntariado = 15;
        $scope.proximoimgVoluntariado = 'img/badges/Categorias/Voluntariado/3.png';
        document.getElementById("Voluntariado").src="img/badges/Categorias/Voluntariado/2.3.png"
      }

      if(badges.length >= 15 && badges.length < 20 ){
        $scope.anteriorimgVoluntariado = 'img/badges/Categorias/Voluntariado/2.3.png';
        $scope.proximoVoluntariado = 20;
        $scope.proximoimgVoluntariado = 'img/badges/Categorias/Voluntariado/3.1.png';
        document.getElementById("Voluntariado").src="img/badges/Categorias/Voluntariado/3.png"
      }
      if(badges.length >= 20 && badges.length < 22 ){
        $scope.anteriorimgVoluntariado = 'img/badges/Categorias/Voluntariado/3.png';
        $scope.proximoVoluntariado = 25;
        $scope.proximoimgVoluntariado = 'img/badges/Categorias/Voluntariado/3.2.png';
        document.getElementById("Voluntariado").src="img/badges/Categorias/Voluntariado/3.1.png"
      }
      if(badges.length >= 25 && badges.length < 30 ){
        $scope.anteriorimgVoluntariado = 'img/badges/Categorias/Voluntariado/3.1.png';
        $scope.proximoVoluntariado = 30;
        $scope.proximoimgVoluntariado = 'img/badges/Categorias/Voluntariado/3.3.png';
        document.getElementById("Voluntariado").src="img/badges/Categorias/Voluntariado/3.2.png"
      }
      if(badges.length >= 30 && badges.length < 50 ){
        $scope.anteriorimgVoluntariado = 'img/badges/Categorias/Voluntariado/3.2.png';
        $scope.proximoVoluntariado = 50;
        $scope.proximoimgVoluntariado = 'img/badges/Categorias/Voluntariado/Super.png';
        document.getElementById("Voluntariado").src="img/badges/Categorias/Voluntariado/3.3.png"
      }

      if(badges.length >= 50){
        $scope.anteriorimgVoluntariado = 'img/badges/Categorias/Voluntariado/3.3.png';
        $scope.proximoVoluntariado = 10000;
        $scope.proximoimgVoluntariado = 'img/badges/Categorias/Voluntariado/Super.png';
        document.getElementById("Voluntariado").src="img/badges/Categorias/Voluntariado/Super.png"
      }

    }else{
      $scope.auxnbadgeVoluntariado = 0;
        $scope.anteriorimgVoluntariado = 'img/badges/Categorias/Voluntariado/0.png';
        $scope.proximoVoluntariado = 1;
        $scope.proximoimgVoluntariado = 'img/badges/Categorias/Voluntariado/1.png';
      document.getElementById("Voluntariado").src="img/badges/Categorias/Voluntariado/0.png"
    }
  });
  // $scope.auxnbadgeQuantidadePersonalidades = 0;
  // $scope.proximoQuantidadePersonalidades = 0;
  // $scope.proximoimgQuantidadePersonalidades = '';
  // $scope.anteriorimgQuantidadePersonalidades = '';
  // EventoService.GetComments3($scope.user).then(function(badges){
  //   //console.log("GetComments3", badges.mal,"dasd", badges.ruins);
  //   if(badges.mal != "0,0,0,"){
  //     $scope.auxnbadgeQuantidadePersonalidades = badges.tamanho;
  //     if(badges.tamanho == 0){
  //       $scope.anteriorimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/0.png';
  //       $scope.proximoQuantidadePersonalidades = 1;
  //       $scope.proximoimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/1.png';

  //       document.getElementById("QuantidadePersonalidades").src="img/badges/Geral/Avaliacoes/QuantidadePersonalidades/0.png"
  //     }
  //     if(badges.tamanho >= 1 && badges.tamanho < 5){
  //       $scope.anteriorimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/0.png';
  //       $scope.proximoQuantidadePersonalidades = 5;
  //       $scope.proximoimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/1.1.png';
  //       document.getElementById("QuantidadePersonalidades").src="img/badges/Geral/Avaliacoes/QuantidadePersonalidades/1.png"
  //     }
  //     if(badges.tamanho >= 5 && badges.tamanho < 10){
  //       $scope.anteriorimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/1.png';
  //       $scope.proximoQuantidadePersonalidades = 10;
  //       $scope.proximoimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/1.2.png';
  //       document.getElementById("QuantidadePersonalidades").src="img/badges/Geral/Avaliacoes/QuantidadePersonalidades/1.1.png"
  //     }
  //     if(badges.tamanho >= 10 && badges.tamanho < 15){
  //       $scope.anteriorimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/1.1.png';
  //       $scope.proximoQuantidadePersonalidades = 15;
  //       $scope.proximoimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/1.3.png';
  //       document.getElementById("QuantidadePersonalidades").src="img/badges/Geral/Avaliacoes/QuantidadePersonalidades/1.2.png"
  //     }
  //     if(badges.tamanho >= 15 && badges.tamanho < 30){
  //       $scope.anteriorimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/1.2.png';
  //       $scope.proximoQuantidadePersonalidades = 30;
  //       $scope.proximoimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/2.png';
  //       document.getElementById("QuantidadePersonalidades").src="img/badges/Geral/Avaliacoes/QuantidadePersonalidades/1.3.png"
  //     }

  //     if(badges.tamanho >= 30 && badges.tamanho < 40){
  //       $scope.anteriorimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/1.3.png';
  //       $scope.proximoQuantidadePersonalidades = 40;
  //       $scope.proximoimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/2.1.png';
  //       document.getElementById("QuantidadePersonalidades").src="img/badges/Geral/Avaliacoes/QuantidadePersonalidades/2.png"
  //     }
  //     if(badges.tamanho >= 40 && badges.tamanho < 50){
  //       $scope.anteriorimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/2.png';
  //       $scope.proximoQuantidadePersonalidades = 50;
  //       $scope.proximoimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/2.2.png';
  //       document.getElementById("QuantidadePersonalidades").src="img/badges/Geral/Avaliacoes/QuantidadePersonalidades/2.1.png"
  //     }
  //     if(badges.tamanho >= 50 && badges.tamanho < 60){
  //       $scope.anteriorimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/2.1.png';
  //       $scope.proximoQuantidadePersonalidades = 60;
  //       $scope.proximoimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/2.3.png';
  //       document.getElementById("QuantidadePersonalidades").src="img/badges/Geral/Avaliacoes/QuantidadePersonalidades/2.2.png"
  //     }
  //     if(badges.tamanho >= 60 && badges.tamanho < 80){
  //       $scope.anteriorimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/2.2.png';
  //       $scope.proximoQuantidadePersonalidades = 80;
  //       $scope.proximoimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/3.png';
  //       document.getElementById("QuantidadePersonalidades").src="img/badges/Geral/Avaliacoes/QuantidadePersonalidades/2.3.png"
  //     }

  //     if(badges.tamanho >= 80 && badges.tamanho < 110 ){
  //       $scope.anteriorimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/2.3.png';
  //       $scope.proximoQuantidadePersonalidades = 110;
  //       $scope.proximoimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/3.1.png';
  //       document.getElementById("QuantidadePersonalidades").src="img/badges/Geral/Avaliacoes/QuantidadePersonalidades/3.png"
  //     }
  //     if(badges.tamanho >= 110 && badges.tamanho < 140 ){
  //       $scope.anteriorimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/3.png';
  //       $scope.proximoQuantidadePersonalidades = 140;
  //       $scope.proximoimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/3.2.png';
  //       document.getElementById("QuantidadePersonalidades").src="img/badges/Geral/Avaliacoes/QuantidadePersonalidades/3.1.png"
  //     }
  //     if(badges.tamanho >= 140 && badges.tamanho < 170 ){
  //       $scope.anteriorimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/3.1.png';
  //       $scope.proximoQuantidadePersonalidades = 170;
  //       $scope.proximoimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/3.3.png';
  //       document.getElementById("QuantidadePersonalidades").src="img/badges/Geral/Avaliacoes/QuantidadePersonalidades/3.2.png"
  //     }
  //     if(badges.tamanho >= 170 && badges.tamanho < 230 ){
  //       $scope.anteriorimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/3.2.png';
  //       $scope.proximoQuantidadePersonalidades = 230;
  //       $scope.proximoimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/Super.png';
  //       document.getElementById("QuantidadePersonalidades").src="img/badges/Geral/Avaliacoes/QuantidadePersonalidades/3.3.png"
  //     }

  //     if(badges.tamanho >= 230){
  //       $scope.anteriorimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/3.3.png';
  //       $scope.proximoQuantidadePersonalidades = 10000;
  //       $scope.proximoimgQuantidadePersonalidades = '';
  //       document.getElementById("QuantidadePersonalidades").src="img/badges/Geral/Avaliacoes/QuantidadePersonalidades/Super.png"
  //     }

  //   }else{
  //     document.getElementById("QuantidadePersonalidades").src="img/badges/Geral/Avaliacoes/QuantidadePersonalidades/0.png"
  //   }
  // });

  // $scope.auxnbadgeSmartDealer = 0;
  // $scope.proximoSmartDealer = 0;
  // $scope.proximoimgSmartDealer = '';
  // $scope.anteriorimgSmartDealer = '';
  // EventoService.getbadgesCriouComercio($scope.user).then(function(badges){
  //   //console.log("getbadgesCriouComercio", badges.length);
  //   if(badges!="Error" && badges !="E"){
  //     $scope.auxnbadgeSmartDealer = badges.length;
  //     if(badges.length == 0){
  //       $scope.anteriorimgSmartDealer = '"img/badges/Geral/Comercios/SmartDealer/0.png';
  //       $scope.proximoSmartDealer = 1;
  //       $scope.proximoimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/1.png';
  //       document.getElementById("SmartDealer").src="img/badges/Geral/Comercios/SmartDealer/0.png"
  //     }
  //     if(badges.length == 1){
  //       $scope.anteriorimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/0.png';
  //       $scope.proximoSmartDealer = 2;
  //       $scope.proximoimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/1.1.png';
  //       document.getElementById("SmartDealer").src="img/badges/Geral/Comercios/SmartDealer/1.png"
  //     }
  //     if(badges.length == 2){
  //       $scope.anteriorimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/1.png';
  //       $scope.proximoSmartDealer = 3;
  //       $scope.proximoimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/1.2.png';
  //       document.getElementById("SmartDealer").src="img/badges/Geral/Comercios/SmartDealer/1.1.png"
  //     }
  //     if(badges.length == 3){
  //       $scope.anteriorimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/1.1.png';
  //       $scope.proximoSmartDealer = 4;
  //       $scope.proximoimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/1.3.png';
  //       document.getElementById("SmartDealer").src="img/badges/Geral/Comercios/SmartDealer/1.2.png"
  //     }
  //     if(badges.length >= 4 && badges.length < 6){
  //       $scope.anteriorimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/1.2.png';
  //       $scope.proximoSmartDealer = 6;
  //       $scope.proximoimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/2.png';
  //       document.getElementById("SmartDealer").src="img/badges/Geral/Comercios/SmartDealer/1.3.png"
  //     }

  //     if(badges.length >= 6 && badges.length < 8){
  //       $scope.anteriorimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/1.3.png';
  //       $scope.proximoSmartDealer = 8;
  //       $scope.proximoimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/2.1.png';
  //       document.getElementById("SmartDealer").src="img/badges/Geral/Comercios/SmartDealer/2.png"
  //     }
  //     if(badges.length >= 8 && badges.length < 10){
  //       $scope.anteriorimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/2.png';
  //       $scope.proximoSmartDealer = 10;
  //       $scope.proximoimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/2.2.png';
  //       document.getElementById("SmartDealer").src="img/badges/Geral/Comercios/SmartDealer/2.1.png"
  //     }
  //     if(badges.length >= 10 && badges.length < 12){
  //       $scope.anteriorimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/2.1.png';
  //       $scope.proximoSmartDealer = 12;
  //       $scope.proximoimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/2.3.png';
  //       document.getElementById("SmartDealer").src="img/badges/Geral/Comercios/SmartDealer/2.2.png"
  //     }
  //     if(badges.length >= 12 && badges.length < 15){
  //       $scope.anteriorimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/2.2.png';
  //       $scope.proximoSmartDealer = 15;
  //       $scope.proximoimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/3.png';
  //       document.getElementById("SmartDealer").src="img/badges/Geral/Comercios/SmartDealer/2.3.png"
  //     }

  //     if(badges.length >= 15 && badges.length < 20 ){
  //       $scope.anteriorimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/2.3.png';
  //       $scope.proximoSmartDealer = 20;
  //       $scope.proximoimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/3.1.png';
  //       document.getElementById("SmartDealer").src="img/badges/Geral/Comercios/SmartDealer/3.png"
  //     }
  //     if(badges.length >= 20 && badges.length < 25 ){
  //       $scope.anteriorimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/3.png';
  //       $scope.proximoSmartDealer = 25;
  //       $scope.proximoimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/3.2.png';
  //       document.getElementById("SmartDealer").src="img/badges/Geral/Comercios/SmartDealer/3.1.png"
  //     }
  //     if(badges.length >= 25 && badges.length < 30 ){
  //       $scope.anteriorimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/3.1.png';
  //       $scope.proximoSmartDealer = 30;
  //       $scope.proximoimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/3.3.png';
  //       document.getElementById("SmartDealer").src="img/badges/Geral/Comercios/SmartDealer/3.2.png"
  //     }
  //     if(badges.length >= 30 && badges.length < 40 ){
  //       $scope.anteriorimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/3.2.png';
  //       $scope.proximoSmartDealer = 40;
  //       $scope.proximoimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/Super.png';
  //       document.getElementById("SmartDealer").src="img/badges/Geral/Comercios/SmartDealer/3.3.png"
  //     }

  //     if(badges.length >= 40){
  //       $scope.anteriorimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/3.3.png';
  //       $scope.proximoSmartDealer = 10000;
  //       $scope.proximoimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/Super.png';
  //       document.getElementById("SmartDealer").src="img/badges/Geral/Comercios/SmartDealer/Super.png"
  //     }

  //   }else{
  //     document.getElementById("SmartDealer").src="img/badges/Geral/Comercios/SmartDealer/0.png"
  //   }
  // });

  // $scope.auxnbadgeCriador = 0;
  // $scope.proximoCriador = 0;
  // $scope.proximoimgCriador = '';
  // $scope.anteriorimgCriador = '';
  // EventoService.GetCriados($scope.user).then(function(badges) {
  //   if(badges!="Error" && badges !="E"){
  //     $scope.auxnbadgeCriador = badges.length;
  //     if(badges.length == 0){
  //       $scope.anteriorimgCriador = 'img/badges/Geral/Eventos/Criador/0.png';
  //       $scope.proximoCriador = 1;
  //       $scope.proximoimgCriador = 'img/badges/Geral/Eventos/Criador/1.png';
  //       document.getElementById("Criador").src="img/badges/Geral/Eventos/Criador/0.png"
  //     }
  //     if(badges.length == 1){
  //       $scope.anteriorimgCriador = 'img/badges/Geral/Eventos/Criador/0.png';
  //       $scope.proximoCriador = 2;
  //       $scope.proximoimgCriador = 'img/badges/Geral/Eventos/Criador/1.1.png';
  //       document.getElementById("Criador").src="img/badges/Geral/Eventos/Criador/1.png"
  //     }
  //     if(badges.length == 2){
  //       $scope.anteriorimgCriador = 'img/badges/Geral/Eventos/Criador/1.png';
  //       $scope.proximoCriador = 3;
  //       $scope.proximoimgCriador = 'img/badges/Geral/Eventos/Criador/1.2.png';
  //       document.getElementById("Criador").src="img/badges/Geral/Eventos/Criador/1.1.png"
  //     }
  //     if(badges.length == 3){
  //       $scope.anteriorimgCriador = 'img/badges/Geral/Eventos/Criador/1.1.png';
  //       $scope.proximoCriador = 4;
  //       $scope.proximoimgCriador = 'img/badges/Geral/Eventos/Criador/1.3.png';
  //       document.getElementById("Criador").src="img/badges/Geral/Eventos/Criador/1.2.png"
  //     }
  //     if(badges.length >= 4 && badges.length < 6){
  //       $scope.anteriorimgCriador = 'img/badges/Geral/Eventos/Criador/1.2.png';
  //       $scope.proximoCriador = 6;
  //       $scope.proximoimgCriador = 'img/badges/Geral/Eventos/Criador/2.png';
  //       document.getElementById("Criador").src="img/badges/Geral/Eventos/Criador/1.3.png"
  //     }

  //     if(badges.length >= 6 && badges.length < 8){
  //       $scope.anteriorimgCriador = 'img/badges/Geral/Eventos/Criador/1.3.png';
  //       $scope.proximoCriador = 8;
  //       $scope.proximoimgCriador = 'img/badges/Geral/Eventos/Criador/2.1.png';
  //       document.getElementById("Criador").src="img/badges/Geral/Eventos/Criador/2.png"
  //     }
  //     if(badges.length >= 8 && badges.length < 10){
  //       $scope.anteriorimgCriador = 'img/badges/Geral/Eventos/Criador/2.png';
  //       $scope.proximoCriador = 10;
  //       $scope.proximoimgCriador = 'img/badges/Geral/Eventos/Criador/2.2.png';
  //       document.getElementById("Criador").src="img/badges/Geral/Eventos/Criador/2.1.png"
  //     }
  //     if(badges.length >= 10 && badges.length < 12){
  //       $scope.anteriorimgCriador = 'img/badges/Geral/Eventos/Criador/2.1.png';
  //       $scope.proximoCriador = 12;
  //       $scope.proximoimgCriador = 'img/badges/Geral/Eventos/Criador/2.3.png';
  //       document.getElementById("Criador").src="img/badges/Geral/Eventos/Criador/2.2.png"
  //     }
  //     if(badges.length >= 12 && badges.length < 15){
  //       $scope.anteriorimgCriador = 'img/badges/Geral/Eventos/Criador/2.2.png';
  //       $scope.proximoCriador = 15;
  //       $scope.proximoimgCriador = 'img/badges/Geral/Eventos/Criador/3.png';
  //       document.getElementById("Criador").src="img/badges/Geral/Eventos/Criador/2.3.png"
  //     }

  //     if(badges.length >= 15 && badges.length < 20 ){
  //       $scope.anteriorimgCriador = 'img/badges/Geral/Eventos/Criador/2.3.png';
  //       $scope.proximoCriador = 20;
  //       $scope.proximoimgCriador = 'img/badges/Geral/Eventos/Criador/3.1.png';
  //       document.getElementById("Criador").src="img/badges/Geral/Eventos/Criador/3.png"
  //     }
  //     if(badges.length >= 20 && badges.length < 25 ){
  //       $scope.anteriorimgCriador = 'img/badges/Geral/Eventos/Criador/3.png';
  //       $scope.proximoCriador = 25;
  //       $scope.proximoimgCriador = 'img/badges/Geral/Eventos/Criador/3.2.png';
  //       document.getElementById("Criador").src="img/badges/Geral/Eventos/Criador/3.1.png"
  //     }
  //     if(badges.length >= 25 && badges.length < 30 ){
  //       $scope.anteriorimgCriador = 'img/badges/Geral/Eventos/Criador/3.1.png';
  //       $scope.proximoCriador = 30;
  //       $scope.proximoimgCriador = 'img/badges/Geral/Eventos/Criador/3.3.png';
  //       document.getElementById("Criador").src="img/badges/Geral/Eventos/Criador/3.2.png"
  //     }
  //     if(badges.length >= 30 && badges.length < 40 ){
  //       $scope.anteriorimgCriador = 'img/badges/Geral/Eventos/Criador/3.2.png';
  //       $scope.proximoCriador = 40;
  //       $scope.proximoimgCriador = 'img/badges/Geral/Eventos/Criador/Super.png';
  //       document.getElementById("Criador").src="img/badges/Geral/Eventos/Criador/3.3.png"
  //     }

  //     if(badges.length >= 40){
  //       $scope.anteriorimgCriador = 'img/badges/Geral/Eventos/Criador/3.3.png';
  //       $scope.proximoCriador = 10000;
  //       $scope.proximoimgCriador = 'img/badges/Geral/Eventos/Criador/Super.png';
  //       document.getElementById("Criador").src="img/badges/Geral/Eventos/Criador/Super.png"
  //     }

  //   }else{
  //     document.getElementById("Criador").src="img/badges/Geral/Eventos/Criador/0.png"
  //   }
  // });

  // $scope.auxnbadgeParticipante = 0;
  // $scope.proximoParticipante = 0;
  // $scope.proximoimgParticipante = '';
  // $scope.anteriorimgParticipante = '';
  // EventoService.GetParticipanteBagde($scope.user).then(function(badges) {
  //   //console.log(badges.length,"GetParticipanteBagde")
  //   if(badges!="Error" && badges !="E"){
  //     $scope.auxnbadgeParticipante = badges.length;
  //     if(badges.length == 0){
  //       $scope.anteriorimgParticipante = 'img/badges/Geral/Eventos/Participante/0.png';
  //       $scope.proximoParticipante = 1;
  //       $scope.proximoimgParticipante = 'img/badges/Geral/Eventos/Participante/1.png';
  //       document.getElementById("Participante").src="img/badges/Geral/Eventos/Participante/0.png"
  //     }
  //     if(badges.length == 1){
  //       $scope.anteriorimgParticipante = 'img/badges/Geral/Eventos/Participante/0.png';
  //       $scope.proximoParticipante = 2;
  //       $scope.proximoimgParticipante = 'img/badges/Geral/Eventos/Participante/1.1.png';
  //       document.getElementById("Participante").src="img/badges/Geral/Eventos/Participante/1.png"
  //     }
  //     if(badges.length == 2){
  //       $scope.anteriorimgParticipante = 'img/badges/Geral/Eventos/Participante/1.png';
  //       $scope.proximoParticipante = 3;
  //       $scope.proximoimgParticipante = 'img/badges/Geral/Eventos/Participante/1.2.png';
  //       document.getElementById("Participante").src="img/badges/Geral/Eventos/Participante/1.1.png"
  //     }
  //     if(badges.length == 3){
  //       $scope.anteriorimgParticipante = 'img/badges/Geral/Eventos/Participante/1.1.png';
  //       $scope.proximoParticipante = 4;
  //       $scope.proximoimgParticipante = 'img/badges/Geral/Eventos/Participante/1.3.png';
  //       document.getElementById("Participante").src="img/badges/Geral/Eventos/Participante/1.2.png"
  //     }
  //     if(badges.length >= 4 && badges.length < 6){
  //       $scope.anteriorimgParticipante = 'img/badges/Geral/Eventos/Participante/1.2.png';
  //       $scope.proximoParticipante = 6;
  //       $scope.proximoimgParticipante = 'img/badges/Geral/Eventos/Participante/2.png';
  //       document.getElementById("Participante").src="img/badges/Geral/Eventos/Participante/1.3.png"
  //     }

  //     if(badges.length >= 6 && badges.length < 8){
  //       $scope.anteriorimgParticipante = 'img/badges/Geral/Eventos/Participante/1.3.png';
  //       $scope.proximoParticipante = 8;
  //       $scope.proximoimgParticipante = 'img/badges/Geral/Eventos/Participante/2.1.png';
  //       document.getElementById("Participante").src="img/badges/Geral/Eventos/Participante/2.png"
  //     }
  //     if(badges.length >= 8 && badges.length < 10){
  //       $scope.anteriorimgParticipante = 'img/badges/Geral/Eventos/Participante/2.png';
  //       $scope.proximoParticipante = 10;
  //       $scope.proximoimgParticipante = 'img/badges/Geral/Eventos/Participante/2.2.png';
  //       document.getElementById("Participante").src="img/badges/Geral/Eventos/Participante/2.1.png"
  //     }
  //     if(badges.length >= 10 && badges.length < 12){
  //       $scope.anteriorimgParticipante = 'img/badges/Geral/Eventos/Participante/2.1.png';
  //       $scope.proximoParticipante = 12;
  //       $scope.proximoimgParticipante = 'img/badges/Geral/Eventos/Participante/2.3.png';
  //       document.getElementById("Participante").src="img/badges/Geral/Eventos/Participante/2.2.png"
  //     }
  //     if(badges.length >= 12 && badges.length < 20){
  //       $scope.anteriorimgParticipante = 'img/badges/Geral/Eventos/Participante/2.2.png';
  //       $scope.proximoParticipante = 20;
  //       $scope.proximoimgParticipante = 'img/badges/Geral/Eventos/Participante/3.png';
  //       document.getElementById("Participante").src="img/badges/Geral/Eventos/Participante/2.3.png"
  //     }

  //     if(badges.length >= 20 && badges.length < 25 ){
  //       $scope.anteriorimgParticipante = 'img/badges/Geral/Eventos/Participante/2.3.png';
  //       $scope.proximoParticipante = 25;
  //       $scope.proximoimgParticipante = 'img/badges/Geral/Eventos/Participante/3.1.png';
  //       document.getElementById("Participante").src="img/badges/Geral/Eventos/Participante/3.png"
  //     }
  //     if(badges.length >= 25 && badges.length < 30 ){
  //       $scope.anteriorimgParticipante = 'img/badges/Geral/Eventos/Participante/3.png';
  //       $scope.proximoParticipante = 30;
  //       $scope.proximoimgParticipante = 'img/badges/Geral/Eventos/Participante/3.2.png';
  //       document.getElementById("Participante").src="img/badges/Geral/Eventos/Participante/3.1.png"
  //     }
  //     if(badges.length >= 30 && badges.length < 35 ){
  //       $scope.anteriorimgParticipante = 'img/badges/Geral/Eventos/Participante/3.1.png';
  //       $scope.proximoParticipante = 35;
  //       $scope.proximoimgParticipante = 'img/badges/Geral/Eventos/Participante/3.3.png';
  //       document.getElementById("Participante").src="img/badges/Geral/Eventos/Participante/3.2.png"
  //     }
  //     if(badges.length >= 35 && badges.length < 50 ){
  //       $scope.anteriorimgParticipante = 'img/badges/Geral/Eventos/Participante/3.2.png';
  //       $scope.proximoParticipante = 50;
  //       $scope.proximoimgParticipante = 'img/badges/Geral/Eventos/Participante/Super.png';
  //       document.getElementById("Participante").src="img/badges/Geral/Eventos/Participante/3.3.png"
  //     }

  //     if(badges.length >= 50){
  //       $scope.anteriorimgParticipante = 'img/badges/Geral/Eventos/Participante/3.3.png';
  //       $scope.proximoParticipante = 10000;
  //       $scope.proximoimgParticipante = 'img/badges/Geral/Eventos/Participante/Super.png';
  //       document.getElementById("Participante").src="img/badges/Geral/Eventos/Participante/Super.png"
  //     }

  //   }else{
  //     document.getElementById("Participante").src="img/badges/Geral/Eventos/Participante/0.png"
  //   }
  // });

  // $scope.auxnbadgeComentarios = 0;
  // $scope.proximoComentarios = 0;
  // $scope.proximoimgComentarios = '';
  // $scope.anteriorimgComentarios = '';
  // EventoService.GetBadgeComentarioPost($scope.user).then(function(badges) {
  //   //console.log(badges.length,"GetBadgeComentarioPost",badges )
  //   if(badges!="Error" && badges !="E"){
  //     $scope.auxnbadgeComentarios = badges.length;
  //     //console.log("faisdfniasidn", badges.length)
  //     if(badges.length == 0){
  //       $scope.anteriorimgComentarios = 'img/badges/Geral/Posts/Comentarios/0.png';
  //       $scope.proximoComentarios = 1;
  //       $scope.proximoimgComentarios = 'img/badges/Geral/Posts/Comentarios/1.png';
  //       document.getElementById("Comentarios").src="img/badges/Geral//Posts/Comentarios/0.png"
  //     }
  //     if(badges.length >= 1 && badges.length < 5){
  //       $scope.anteriorimgComentarios = 'img/badges/Geral/Posts/Comentarios/0.png';
  //       $scope.proximoComentarios = 5;
  //       $scope.proximoimgComentarios = 'img/badges/Geral/Posts/Comentarios/1.1.png';
  //       document.getElementById("Comentarios").src="img/badges/Geral/Posts/Comentarios/1.png"
  //     }
  //     if(badges.length >= 5 && badges.length < 10){
  //       $scope.anteriorimgComentarios = 'img/badges/Geral/Posts/Comentarios/1.png';
  //       $scope.proximoComentarios = 10;
  //       $scope.proximoimgComentarios = 'img/badges/Geral/Posts/Comentarios/1.2.png';
  //       document.getElementById("Comentarios").src="img/badges/Geral/Posts/Comentarios/1.1.png"
  //     }
  //     if(badges.length >= 10 && badges.length < 15){
  //       $scope.anteriorimgComentarios = 'img/badges/Geral/Posts/Comentarios/1.1.png';
  //       $scope.proximoComentarios = 15;
  //       $scope.proximoimgComentarios = 'img/badges/Geral/Posts/Comentarios/1.3.png';
  //       document.getElementById("Comentarios").src="img/badges/Geral/Posts/Comentarios/1.2.png"
  //     }
  //     if(badges.length >= 15 && badges.length < 30){
  //       $scope.anteriorimgComentarios = 'img/badges/Geral/Posts/Comentarios/1.2.png';
  //       $scope.proximoComentarios = 30;
  //       $scope.proximoimgComentarios = 'img/badges/Geral/Posts/Comentarios/2.png';
  //       console.log("faisdfniasidn")
  //       document.getElementById("Comentarios").src="img/badges/Geral/Posts/Comentarios/1.3.png"
  //     }

  //     if(badges.length >= 30 && badges.length < 40){
  //       $scope.anteriorimgComentarios = 'img/badges/Geral/Posts/Comentarios/1.3.png';
  //       $scope.proximoComentarios = 40;
  //       $scope.proximoimgComentarios = 'img/badges/Geral/Posts/Comentarios/2.1.png';
  //       document.getElementById("Comentarios").src="img/badges/Geral/Posts/Comentarios/2.png"
  //     }
  //     if(badges.length >= 40 && badges.length < 50){
  //       $scope.anteriorimgComentarios = 'img/badges/Geral/Posts/Comentarios/2.png';
  //       $scope.proximoComentarios = 50;
  //       $scope.proximoimgComentarios = 'img/badges/Geral/Posts/Comentarios/2.2.png';
  //       document.getElementById("Comentarios").src="img/badges/Geral/Posts/Comentarios/2.1.png"
  //     }
  //     if(badges.length >= 50 && badges.length < 60){
  //       $scope.anteriorimgComentarios = 'img/badges/Geral/Posts/Comentarios/2.1.png';
  //       $scope.proximoComentarios = 60;
  //       $scope.proximoimgComentarios = 'img/badges/Geral/Posts/Comentarios/2.3.png';
  //       document.getElementById("Comentarios").src="img/badges/Geral/Posts/Comentarios/2.2.png"
  //     }
  //     if(badges.length >= 60 && badges.length < 80){
  //       $scope.anteriorimgComentarios = 'img/badges/Geral/Posts/Comentarios/2.2.png';
  //       $scope.proximoComentarios = 80;
  //       $scope.proximoimgComentarios = 'img/badges/Geral/Posts/Comentarios/3.png';
  //       document.getElementById("Comentarios").src="img/badges/Geral/Posts/Comentarios/2.3.png"
  //     }

  //     if(badges.length >= 80 && badges.length < 110 ){
  //       $scope.anteriorimgComentarios = 'img/badges/Geral/Posts/Comentarios/2.3.png';
  //       $scope.proximoComentarios = 110;
  //       $scope.proximoimgComentarios = 'img/badges/Geral/Posts/Comentarios/3.1.png';
  //       document.getElementById("Comentarios").src="img/badges/Geral/Posts/Comentarios/3.png"
  //     }
  //     if(badges.length >= 110 && badges.length < 140 ){
  //       $scope.anteriorimgComentarios = 'img/badges/Geral/Posts/Comentarios/3.png';
  //       $scope.proximoComentarios = 140;
  //       $scope.proximoimgComentarios = 'img/badges/Geral/Posts/Comentarios/3.2.png';
  //       document.getElementById("Comentarios").src="img/badges/Geral/Posts/Comentarios/3.1.png"
  //     }
  //     if(badges.length >= 140 && badges.length < 170 ){
  //       $scope.anteriorimgComentarios = 'img/badges/Geral/Posts/Comentarios/3.1.png';
  //       $scope.proximoComentarios = 170;
  //       $scope.proximoimgComentarios = 'img/badges/Geral/Posts/Comentarios/3.3.png';
  //       document.getElementById("Comentarios").src="img/badges/Geral/Posts/Comentarios/3.2.png"
  //     }
  //     if(badges.length >= 170 && badges.length < 230 ){
  //       $scope.anteriorimgComentarios = 'img/badges/Geral/Posts/Comentarios/3.2.png';
  //       $scope.proximoComentarios = 230;
  //       $scope.proximoimgComentarios = 'img/badges/Geral/Posts/Comentarios/Super.png';
  //       document.getElementById("Comentarios").src="img/badges/Geral/Posts/Comentarios/3.3.png"
  //     }

  //     if(badges.length >= 230){
  //       $scope.anteriorimgComentarios = 'img/badges/Geral/Posts/Comentarios/3.3.png';
  //       $scope.proximoComentarios = 10000;
  //       $scope.proximoimgComentarios = 'img/badges/Geral/Posts/Comentarios/Super.png';
  //       document.getElementById("Comentarios").src="img/badges/Geral/Posts/Comentarios/Super.png"
  //     }

  //   }else{
  //     document.getElementById("Comentarios").src="img/badges/Geral/Posts/Comentarios/0.png"
  //   }
  // });

  // $scope.auxnbadgeOriginalPoster = 0;
  // $scope.proximoOriginalPoster = 0;
  // $scope.proximoimgOriginalPoster = '';
  // $scope.anteriorimgOriginalPoster = '';
  // EventoService.GetFeedMeusPost($scope.user).then(function(badges) {
  //   //console.log(badges.length,"GetBadgeComentarioPost",badges )
  //   if(badges!="Error" && badges !="E"){
  //     $scope.auxnbadgeOriginalPoster = badges.length;
  //     //console.log("faisdfniasidn", badges.length)
  //     if(badges.length == 0){
  //       $scope.anteriorimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/0.png';
  //       $scope.proximoOriginalPoster = 1;
  //       $scope.proximoimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/1.png';
  //       document.getElementById("OriginalPoster").src="img/badges/Geral//Posts/OriginalPoster/0.png"
  //     }
  //     if(badges.length >= 1 && badges.length < 3){
  //       $scope.anteriorimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/0.png';
  //       $scope.proximoOriginalPoster = 3;
  //       $scope.proximoimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/1.1.png';
  //       document.getElementById("OriginalPoster").src="img/badges/Geral/Posts/OriginalPoster/1.png"
  //     }
  //     if(badges.length >= 3 && badges.length < 5){
  //       $scope.anteriorimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/1.png';
  //       $scope.proximoOriginalPoster = 5;
  //       $scope.proximoimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/1.2.png';
  //       document.getElementById("OriginalPoster").src="img/badges/Geral/Posts/OriginalPoster/1.1.png"
  //     }
  //     if(badges.length >= 5 && badges.length < 7){
  //       $scope.anteriorimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/1.1.png';
  //       $scope.proximoOriginalPoster = 7;
  //       $scope.proximoimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/1.3.png';
  //       document.getElementById("OriginalPoster").src="img/badges/Geral/Posts/OriginalPoster/1.2.png"
  //     }
  //     if(badges.length >= 7 && badges.length < 10){
  //       $scope.anteriorimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/1.2.png';
  //       $scope.proximoOriginalPoster = 10;
  //       $scope.proximoimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/2.png';
       
  //       document.getElementById("OriginalPoster").src="img/badges/Geral/Posts/OriginalPoster/1.3.png"
  //     }

  //     if(badges.length >= 10 && badges.length < 15){
  //       $scope.anteriorimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/1.3.png';
  //       $scope.proximoOriginalPoster = 15;
  //       $scope.proximoimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/2.1.png';
  //       document.getElementById("OriginalPoster").src="img/badges/Geral/Posts/OriginalPoster/2.png"
  //     }
  //     if(badges.length >= 15 && badges.length < 20){
  //       $scope.anteriorimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/2.png';
  //       $scope.proximoOriginalPoster = 20;
  //       $scope.proximoimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/2.2.png';
  //       document.getElementById("OriginalPoster").src="img/badges/Geral/Posts/OriginalPoster/2.1.png"
  //     }
  //     if(badges.length >= 20 && badges.length < 25){
  //       $scope.anteriorimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/2.1.png';
  //       $scope.proximoOriginalPoster = 25;
  //       $scope.proximoimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/2.3.png';
  //       document.getElementById("OriginalPoster").src="img/badges/Geral/Posts/OriginalPoster/2.2.png"
  //     }
  //     if(badges.length >= 25 && badges.length < 35){
  //       $scope.anteriorimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/2.2.png';
  //       $scope.proximoOriginalPoster = 35;
  //       $scope.proximoimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/3.png';
  //       document.getElementById("OriginalPoster").src="img/badges/Geral/Posts/OriginalPoster/2.3.png"
  //     }

  //     if(badges.length >= 35 && badges.length < 45 ){
  //       $scope.anteriorimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/2.3.png';
  //       $scope.proximoOriginalPoster = 45;
  //       $scope.proximoimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/3.1.png';
  //       document.getElementById("OriginalPoster").src="img/badges/Geral/Posts/OriginalPoster/3.png"
  //     }
  //     if(badges.length >= 45 && badges.length < 55 ){
  //       $scope.anteriorimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/3.png';
  //       $scope.proximoOriginalPoster = 55;
  //       $scope.proximoimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/3.2.png';
  //       document.getElementById("OriginalPoster").src="img/badges/Geral/Posts/OriginalPoster/3.1.png"
  //     }
  //     if(badges.length >= 55 && badges.length < 65 ){
  //       $scope.anteriorimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/3.1.png';
  //       $scope.proximoOriginalPoster = 65;
  //       $scope.proximoimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/3.3.png';
  //       document.getElementById("OriginalPoster").src="img/badges/Geral/Posts/OriginalPoster/3.2.png"
  //     }
  //     if(badges.length >= 65 && badges.length < 80 ){
  //       $scope.anteriorimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/3.2.png';
  //       $scope.proximoOriginalPoster = 80;
  //       $scope.proximoimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/Super.png';
  //       document.getElementById("OriginalPoster").src="img/badges/Geral/Posts/OriginalPoster/3.3.png"
  //     }

  //     if(badges.length >= 80){
  //       $scope.anteriorimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/3.3.png';
  //       $scope.proximoOriginalPoster = 10000;
  //       $scope.proximoimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/Super.png';
  //       document.getElementById("OriginalPoster").src="img/badges/Geral/Posts/OriginalPoster/Super.png"
  //     }

  //   }else{
  //     document.getElementById("OriginalPoster").src="img/badges/Geral/Posts/OriginalPoster/0.png"
  //   }
  // });
  
  // $scope.auxnbadgeUpvotes = 0;
  // $scope.proximoUpvotes = 0;
  // $scope.proximoimgUpvotes = '';
  // $scope.anteriorimgUpvotes = '';
  // EventoService.GetBadgeUpvote($scope.user).then(function(badges) {
  //   console.log(badges.length,"GetBadgeComentarioPost",badges )
  //   if(badges!="Error" && badges !="E"){
  //     $scope.auxnbadgeUpvotes = badges.length;
  //     console.log("faisdfniasidn", badges.length)
  //     if(badges.length == 0){
  //       $scope.anteriorimgUpvotes = 'img/badges/Geral/Posts/Upvotes/0.png';
  //       $scope.proximoUpvotes = 1;
  //       $scope.proximoimgUpvotes = 'img/badges/Geral/Posts/Upvotes/1.png';
  //       document.getElementById("Upvotes").src="img/badges/Geral//Posts/Upvotes/0.png"
  //     }
  //     if(badges.length >= 1 && badges.length < 5){
  //       $scope.anteriorimgUpvotes = 'img/badges/Geral/Posts/Upvotes/0.png';
  //       $scope.proximoUpvotes = 5;
  //       $scope.proximoimgUpvotes = 'img/badges/Geral/Posts/Upvotes/1.1.png';
  //       document.getElementById("Upvotes").src="img/badges/Geral/Posts/Upvotes/1.png"
  //     }
  //     if(badges.length >= 5 && badges.length < 10){
  //       $scope.anteriorimgUpvotes = 'img/badges/Geral/Posts/Upvotes/1.png';
  //       $scope.proximoUpvotes = 10;
  //       $scope.proximoimgUpvotes = 'img/badges/Geral/Posts/Upvotes/1.2.png';
  //       document.getElementById("Upvotes").src="img/badges/Geral/Posts/Upvotes/1.1.png"
  //     }
  //     if(badges.length >= 10 && badges.length < 15){
  //       $scope.anteriorimgUpvotes = 'img/badges/Geral/Posts/Upvotes/1.1.png';
  //       $scope.proximoUpvotes = 15;
  //       $scope.proximoimgUpvotes = 'img/badges/Geral/Posts/Upvotes/1.3.png';
  //       document.getElementById("Upvotes").src="img/badges/Geral/Posts/Upvotes/1.2.png"
  //     }
  //     if(badges.length >= 15 && badges.length < 25){
  //       $scope.anteriorimgUpvotes = 'img/badges/Geral/Posts/Upvotes/1.2.png';
  //       $scope.proximoUpvotes = 25;
  //       $scope.proximoimgUpvotes = 'img/badges/Geral/Posts/Upvotes/2.png';
       
  //       document.getElementById("Upvotes").src="img/badges/Geral/Posts/Upvotes/1.3.png"
  //     }

  //     if(badges.length >= 25 && badges.length < 35){
  //       $scope.anteriorimgUpvotes = 'img/badges/Geral/Posts/Upvotes/1.3.png';
  //       $scope.proximoUpvotes = 35;
  //       $scope.proximoimgUpvotes = 'img/badges/Geral/Posts/Upvotes/2.1.png';
  //       document.getElementById("Upvotes").src="img/badges/Geral/Posts/Upvotes/2.png"
  //     }
  //     if(badges.length >= 35 && badges.length < 45){
  //       $scope.anteriorimgUpvotes = 'img/badges/Geral/Posts/Upvotes/2.png';
  //       $scope.proximoUpvotes = 45;
  //       $scope.proximoimgUpvotes = 'img/badges/Geral/Posts/Upvotes/2.2.png';
  //       document.getElementById("Upvotes").src="img/badges/Geral/Posts/Upvotes/2.1.png"
  //     }
  //     if(badges.length >= 45 && badges.length < 55){
  //       $scope.anteriorimgUpvotes = 'img/badges/Geral/Posts/Upvotes/2.1.png';
  //       $scope.proximoUpvotes = 55;
  //       $scope.proximoimgUpvotes = 'img/badges/Geral/Posts/Upvotes/2.3.png';
  //       document.getElementById("Upvotes").src="img/badges/Geral/Posts/Upvotes/2.2.png"
  //     }
  //     if(badges.length >= 55 && badges.length < 80){
  //       $scope.anteriorimgUpvotes = 'img/badges/Geral/Posts/Upvotes/2.2.png';
  //       $scope.proximoUpvotes = 80;
  //       $scope.proximoimgUpvotes = 'img/badges/Geral/Posts/Upvotes/3.png';
  //       document.getElementById("Upvotes").src="img/badges/Geral/Posts/Upvotes/2.3.png"
  //     }

  //     if(badges.length >= 80 && badges.length < 100 ){
  //       $scope.anteriorimgUpvotes = 'img/badges/Geral/Posts/Upvotes/2.3.png';
  //       $scope.proximoUpvotes = 100;
  //       $scope.proximoimgUpvotes = 'img/badges/Geral/Posts/Upvotes/3.1.png';
  //       document.getElementById("Upvotes").src="img/badges/Geral/Posts/Upvotes/3.png"
  //     }
  //     if(badges.length >= 100 && badges.length < 120 ){
  //       $scope.anteriorimgUpvotes = 'img/badges/Geral/Posts/Upvotes/3.png';
  //       $scope.proximoUpvotes = 120;
  //       $scope.proximoimgUpvotes = 'img/badges/Geral/Posts/Upvotes/3.2.png';
  //       document.getElementById("Upvotes").src="img/badges/Geral/Posts/Upvotes/3.1.png"
  //     }
  //     if(badges.length >= 120 && badges.length < 140 ){
  //       $scope.anteriorimgUpvotes = 'img/badges/Geral/Posts/Upvotes/3.1.png';
  //       $scope.proximoUpvotes = 140;
  //       $scope.proximoimgUpvotes = 'img/badges/Geral/Posts/Upvotes/3.3.png';
  //       document.getElementById("Upvotes").src="img/badges/Geral/Posts/Upvotes/3.2.png"
  //     }
  //     if(badges.length >= 140 && badges.length < 200 ){
  //       $scope.anteriorimgUpvotes = 'img/badges/Geral/Posts/Upvotes/3.2.png';
  //       $scope.proximoUpvotes = 200;
  //       $scope.proximoimgUpvotes = 'img/badges/Geral/Posts/Upvotes/Super.png';
  //       document.getElementById("Upvotes").src="img/badges/Geral/Posts/Upvotes/3.3.png"
  //     }

  //     if(badges.length >= 200){
  //       $scope.anteriorimgUpvotes = 'img/badges/Geral/Posts/Upvotes/3.3.png';
  //       $scope.proximoUpvotes = 100000;
  //       $scope.proximoimgUpvotes = 'img/badges/Geral/Posts/Upvotes/Super.png';
  //       document.getElementById("Upvotes").src="img/badges/Geral/Posts/Upvotes/Super.png"
  //     }

  //   }else{
  //     document.getElementById("Upvotes").src="img/badges/Geral/Posts/Upvotes/0.png"
  //   }
  // });

  $scope.naotembadgescomercio = ""
  EventoService.GetComercioFinalizado($scope.user).then(function(badges) {  //console.log(badges.length,"GetBadgeComentarioPost",badges )
    if(badges!="error" && badges !="e"){
      console.log("faisdfniasidn", badges.length)
      for(var i =0 ;i<badges.length;i++){
        if(badges[i].idcomercio == '53'){
          if(badges[i].n == '1'){
            document.getElementById("Paintball").src="img/badges/Comercios/Paintball/1.png"
          }
          if(badges[i].n == '2'){
            document.getElementById("Paintball").src="img/badges/Comercios/Paintball/2.png"
          }
          if(badges[i].n >= '3'){
            document.getElementById("Paintball").src="img/badges/Comercios/Paintball/3.png"
          }
        }
        if(badges[i].idcomercio == '222'){
          if(badges[i].n == '1'){
            document.getElementById("BarcoPirataItapema").src="img/badges/Comercios/BarcoPirataItapema/1.png"
          }
          if(badges[i].n == '2'){
            document.getElementById("BarcoPirataItapema").src="img/badges/Comercios/BarcoPirataItapema/2.png"
          }
          if(badges[i].n >= '3'){
            document.getElementById("BarcoPirataItapema").src="img/badges/Comercios/BarcoPirataItapema/3.png"
          }
        }
        if(badges[i].idcomercio == '223'){
          if(badges[i].n == '1'){
            document.getElementById("BCWalkingTour").src="img/badges/Comercios/BCWalkingTour/1.png"
          }
          if(badges[i].n == '2'){
            document.getElementById("BCWalkingTour").src="img/badges/Comercios/BCWalkingTour/2.png"
          }
          if(badges[i].n >= '3'){
            document.getElementById("BCWalkingTour").src="img/badges/Comercios/BCWalkingTour/3.png"
          }
        }
        if(badges[i].idcomercio == '225'){
          if(badges[i].n == '1'){
            document.getElementById("BravaBeachSports").src="img/badges/Comercios/BravaBeachSports/1.png"
          }
          if(badges[i].n == '2'){
            document.getElementById("BravaBeachSports").src="img/badges/Comercios/BravaBeachSports/2.png"
          }
          if(badges[i].n >= '3'){
            document.getElementById("BravaBeachSports").src="img/badges/Comercios/BravaBeachSports/3.png"
          }
        }
        if(badges[i].idcomercio == '227'){
          if(badges[i].n == '1'){
            document.getElementById("MVBTennisPaddel").src="img/badges/Comercios/MVBTennisPaddel/1.png"
          }
          if(badges[i].n == '2'){
            document.getElementById("MVBTennisPaddel").src="img/badges/Comercios/MVBTennisPaddel/2.png"
          }
          if(badges[i].n >= '3'){
            document.getElementById("MVBTennisPaddel").src="img/badges/Comercios/MVBTennisPaddel/3.png"
          }
        }
        
        if(badges[i].idcomercio == '228'){
          if(badges[i].n == '1'){
            document.getElementById("TriboDaÁgua").src="img/badges/Comercios/TriboDaÁgua/1.png"
          }
          if(badges[i].n == '2'){
            document.getElementById("TriboDaÁgua").src="img/badges/Comercios/TriboDaÁgua/2.png"
          }
          if(badges[i].n >= '3'){
            document.getElementById("TriboDaÁgua").src="img/badges/Comercios/TriboDaÁgua/3.png"
          }
        }
      }
            

    }else{
      $scope.naotembadgescomercio = "Ainda não há nenhuma conquista em locais parceiros"
    }
  });

   $scope.naotembadgesgeral = ""
  $scope.auxnbadgeNumberOneHExa = 0;
  $scope.proximoNumberOneHExa = 0;
  $scope.proximoimgNumberOneHExa = '';
  $scope.anteriorimgNumberOneHExa = '';
  EventoService.getusuario($scope.user).then(function(user) {
      $scope.user = user;
      if(user.numcodigo){
        if(user.numcodigo == '0'){
          $scope.auxnbadgeNumberOneHExa = 0;
          $scope.anteriorimgNumberOneHExa = 'img/egg_0.png';
          $scope.proximoNumberOneHExa = 1;
          $scope.proximoimgNumberOneHExa = 'img/egg_1.png';
          document.getElementById("NumberOneHExa").src="img/egg_0.png";
        }
        if(user.numcodigo == '1'){
          $scope.auxnbadgeNumberOneHExa = 1;
          $scope.anteriorimgNumberOneHExa = 'img/egg_0.png';
          $scope.proximoNumberOneHExa = 2;
          $scope.proximoimgNumberOneHExa = 'img/egg_2.png';
          document.getElementById("NumberOneHExa").src="img/egg_1.png";
        }
        if(user.numcodigo == '2'){
          $scope.auxnbadgeNumberOneHExa = 2;
          $scope.anteriorimgNumberOneHExa = 'img/egg_1.png';
          $scope.proximoNumberOneHExa = 3;
          $scope.proximoimgNumberOneHExa = 'img/NumberOneHExa.png';
          document.getElementById("NumberOneHExa").src="img/egg_2.png";
        }
        if(parseInt(user.numcodigo) >= 3){
          $scope.auxnbadgeNumberOneHExa = 3;
          $scope.anteriorimgNumberOneHExa = 'img/egg_2.png';
          $scope.proximoNumberOneHExa = 1000;
          $scope.proximoimgNumberOneHExa = 'img/NumberOneHExa.png';
          document.getElementById("NumberOneHExa").src="img/NumberOneHExa.png";
        }
        if(parseInt(user.numcodigo) < 0){
          $scope.auxnbadgeNumberOneHExa = 3;
          $scope.anteriorimgNumberOneHExa = 'img/egg_2.png';
          $scope.proximoNumberOneHExa = 1000;
          $scope.proximoimgNumberOneHExa = 'img/NumberOneHExa.png';
          document.getElementById("NumberOneHExa").src="img/NumberOneHExa.png";
        } 
      }else{
        $scope.naotembadgesgeral = "Ainda não há nenhuma conquista aqui"
      }
      

  });

  $scope.entraBadge = function(badge){
    console.log("badge",badge);
    $scope.badge = {};
    if(badge == 'QuantidadePersonalidades'){
      $scope.badge.titulo = 'Self Awareness';
      $scope.badge.texto = 'Quanto mais avaliações referentes à nossa personalidade, mais entendemos como as pessoas nos veem. Isso pode ser útil para nos conhecermos melhor!';
      $scope.badge.numeroatual = $scope.auxnbadgeQuantidadePersonalidades;
      $scope.badge.numeroproximo = $scope.proximoQuantidadePersonalidades
      $scope.badge.imgatual = document.getElementById("QuantidadePersonalidades").src;
      $scope.badge.imganterior = $scope.anteriorimgQuantidadePersonalidades;
      $scope.badge.imgproximo = $scope.proximoimgQuantidadePersonalidades;
      formBadge.updateForm($scope.badge);
      $state.go('tabsController.badgesexplicaPerfilOutro');
    }
    if(badge == 'SmartDealer'){
      $scope.badge.titulo = 'Smart Dealer';
      $scope.badge.texto = 'Um Din Din Baggy é inteligente, ele cria eventos que oferecem recompensas para gastar menos fazendo mais.';
      $scope.badge.numeroatual = $scope.auxnbadgeSmartDealer;
      $scope.badge.numeroproximo = $scope.proximoSmartDealer
      $scope.badge.imgatual = document.getElementById("SmartDealer").src;
      $scope.badge.imganterior = $scope.anteriorimgSmartDealer;
      $scope.badge.imgproximo = $scope.proximoimgSmartDealer;
      formBadge.updateForm($scope.badge);
      $state.go('tabsController.badgesexplicaPerfilOutro');
    }
    if(badge == 'Criador'){
      $scope.badge.titulo = 'Creator';
      $scope.badge.texto = 'Cria eventos no app';
      $scope.badge.numeroatual = $scope.auxnbadgeCriador;
      $scope.badge.numeroproximo = $scope.proximoCriador
      $scope.badge.imgatual = document.getElementById("Criador").src;
      $scope.badge.imganterior = $scope.anteriorimgCriador;
      $scope.badge.imgproximo = $scope.proximoimgCriador;
      formBadge.updateForm($scope.badge);
      $state.go('tabsController.badgesexplicaPerfilOutro');
    }
    if(badge == 'Participante'){
      $scope.badge.titulo = 'Story Maker';
      $scope.badge.texto = 'Participa de eventos no app';
      $scope.badge.numeroatual = $scope.auxnbadgeParticipante;
      $scope.badge.numeroproximo = $scope.proximoParticipante;
      $scope.badge.imgatual = document.getElementById("Participante").src;
      $scope.badge.imganterior = $scope.anteriorimgParticipante;
      $scope.badge.imgproximo = $scope.proximoimgParticipante;
      formBadge.updateForm($scope.badge);
      $state.go('tabsController.badgesexplicaPerfilOutro');
    }
    if(badge == 'Comentarios'){
      $scope.badge.titulo = 'Community Activist';
      $scope.badge.texto = 'Um(a) ativista da sua comunidade local através de comentários em posts';
      $scope.badge.numeroatual = $scope.auxnbadgeComentarios;
      $scope.badge.numeroproximo = $scope.proximoComentarios
      $scope.badge.imgatual = document.getElementById("Comentarios").src;
      $scope.badge.imganterior = $scope.anteriorimgComentarios;
      $scope.badge.imgproximo = $scope.proximoimgComentarios;
      formBadge.updateForm($scope.badge);
      $state.go('tabsController.badgesexplicaPerfilOutro');
    }
    if(badge == 'OriginalPoster'){
      $scope.badge.titulo = 'Original Poster';
      $scope.badge.texto = 'Cria engajamento da sua comunidade local através da criação de posts';
      $scope.badge.numeroatual = $scope.auxnbadgeOriginalPoster;
      $scope.badge.numeroproximo = $scope.proximoOriginalPoster
      $scope.badge.imgatual = document.getElementById("OriginalPoster").src;
      $scope.badge.imganterior = $scope.anteriorimgOriginalPoster;
      $scope.badge.imgproximo = $scope.proximoimgOriginalPoster;
      formBadge.updateForm($scope.badge);
      $state.go('tabsController.badgesexplicaPerfilOutro');
    }
    if(badge == 'Upvotes'){
      $scope.badge.titulo = 'Community Supporter';
      $scope.badge.texto = 'Um suporte da sua comunidade local que ajuda a filtrar os bons posts dos ruins através de upvotes';
      $scope.badge.numeroatual = $scope.auxnbadgeUpvotes;
      $scope.badge.numeroproximo = $scope.proximoUpvotes
      $scope.badge.imgatual = document.getElementById("Upvotes").src;
      $scope.badge.imganterior = $scope.anteriorimgUpvotes;
      $scope.badge.imgproximo = $scope.proximoimgUpvotes;
      formBadge.updateForm($scope.badge);
      $state.go('tabsController.badgesexplicaPerfilOutro');
    }
    if(badge == 'NumberOneHExa'){
      $scope.badge.titulo = 'Amigo que chama';
      $scope.badge.texto = 'Convida amigos quando descobre um app novo';
      $scope.badge.numeroatual = $scope.auxnbadgeNumberOneHExa;
      $scope.badge.numeroproximo = $scope.proximoNumberOneHExa
      $scope.badge.imgatual = document.getElementById("NumberOneHExa").src;
      $scope.badge.imganterior = $scope.anteriorimgNumberOneHExa;
      $scope.badge.imgproximo = $scope.proximoimgNumberOneHExa;
      formBadge.updateForm($scope.badge);
      $state.go('tabsController.badgesexplicaPerfilOutro');
    }
    if(badge == 'ArteeCultura'){
      $scope.badge.titulo = 'Cult';
      $scope.badge.texto = 'Você participou de eventos com #ArteeCultura';
      $scope.badge.numeroatual = $scope.auxnbadgeArteeCultura;
      $scope.badge.numeroproximo = $scope.proximoArteeCultura
      $scope.badge.imgatual = document.getElementById("ArteeCultura").src;
      $scope.badge.imganterior = $scope.anteriorimgArteeCultura;
      $scope.badge.imgproximo = $scope.proximoimgArteeCultura;
      formBadge.updateForm($scope.badge);
      $state.go('tabsController.badgesexplicaPerfilOutro');
    }
    if(badge == 'Ciclismo'){
      $scope.badge.titulo = 'Pedal';
      $scope.badge.texto = 'Você participou de eventos com #Ciclismo';
      $scope.badge.numeroatual = $scope.auxnbadgeCiclismo;
      $scope.badge.numeroproximo = $scope.proximoCiclismo
      $scope.badge.imgatual = document.getElementById("Ciclismo").src;
      $scope.badge.imganterior = $scope.anteriorimgCiclismo;
      $scope.badge.imgproximo = $scope.proximoimgCiclismo;
      formBadge.updateForm($scope.badge);
      $state.go('tabsController.badgesexplicaPerfilOutro');
    }
    if(badge == 'Conversa'){
      $scope.badge.titulo = 'Falador(a)';
      $scope.badge.texto = 'Você participou de eventos com #Conversa';
      $scope.badge.numeroatual = $scope.auxnbadgeConversa;
      $scope.badge.numeroproximo = $scope.proximoConversa
      $scope.badge.imgatual = document.getElementById("Conversa").src;
      $scope.badge.imganterior = $scope.anteriorimgConversa;
      $scope.badge.imgproximo = $scope.proximoimgConversa;
      formBadge.updateForm($scope.badge);
      $state.go('tabsController.badgesexplicaPerfilOutro');
    }
    if(badge == 'Danca'){
      $scope.badge.titulo = 'Pés de valsa';
      $scope.badge.texto = 'Você participou de eventos com #Dança';
      $scope.badge.numeroatual = $scope.auxnbadgeDanca;
      $scope.badge.numeroproximo = $scope.proximoDanca
      $scope.badge.imgatual = document.getElementById("Danca").src;
      $scope.badge.imganterior = $scope.anteriorimgDanca;
      $scope.badge.imgproximo = $scope.proximoimgDanca;
      formBadge.updateForm($scope.badge);
      $state.go('tabsController.badgesexplicaPerfilOutro');
    }
    if(badge == 'EsportesdePraia'){
      $scope.badge.titulo = 'Esportes de Praia';
      $scope.badge.texto = 'Você participou de eventos com #EsportesdePraia';
      $scope.badge.numeroatual = $scope.auxnbadgeEsportesdePraia;
      $scope.badge.numeroproximo = $scope.proximoEsportesdePraia
      $scope.badge.imgatual = document.getElementById("EsportesdePraia").src;
      $scope.badge.imganterior = $scope.anteriorimgEsportesdePraia;
      $scope.badge.imgproximo = $scope.proximoimgEsportesdePraia;
      formBadge.updateForm($scope.badge);
      $state.go('tabsController.badgesexplicaPerfilOutro');
    }
    if(badge == 'FestaseBaladas'){
      $scope.badge.titulo = 'Da night';
      $scope.badge.texto = 'Você participou de eventos com #FestaseBaladas';
      $scope.badge.numeroatual = $scope.auxnbadgeFestaseBaladas;
      $scope.badge.numeroproximo = $scope.proximoFestaseBaladas
      $scope.badge.imgatual = document.getElementById("FestaseBaladas").src;
      $scope.badge.imganterior = $scope.anteriorimgFestaseBaladas;
      $scope.badge.imgproximo = $scope.proximoimgFestaseBaladas;
      formBadge.updateForm($scope.badge);
      $state.go('tabsController.badgesexplicaPerfilOutro');
    }
    if(badge == 'Futebol'){
      $scope.badge.titulo = 'Boleiro';
      $scope.badge.texto = 'Você participou de eventos com #Futebol';
      $scope.badge.numeroatual = $scope.auxnbadgeFutebol;
      $scope.badge.numeroproximo = $scope.proximoFutebol
      $scope.badge.imgatual = document.getElementById("Futebol").src;
      $scope.badge.imganterior = $scope.anteriorimgFutebol;
      $scope.badge.imgproximo = $scope.proximoimgFutebol;
      formBadge.updateForm($scope.badge);
      $state.go('tabsController.badgesexplicaPerfilOutro');
    }
    if(badge == 'GrupodeEstudos'){
      $scope.badge.titulo = 'CDF';
      $scope.badge.texto = 'Você participou de eventos com #GrupodeEstudos';
      $scope.badge.numeroatual = $scope.auxnbadgeGrupodeEstudos;
      $scope.badge.numeroproximo = $scope.proximoGrupodeEstudos
      $scope.badge.imgatual = document.getElementById("GrupodeEstudos").src;
      $scope.badge.imganterior = $scope.anteriorimgGrupodeEstudos;
      $scope.badge.imgproximo = $scope.proximoimgGrupodeEstudos;
      formBadge.updateForm($scope.badge);
      $state.go('tabsController.badgesexplicaPerfilOutro');
    }
    if(badge == 'Jogos'){
      $scope.badge.titulo = 'Jogador (a)';
      $scope.badge.texto = 'Você participou de eventos com #Jogos';
      $scope.badge.numeroatual = $scope.auxnbadgeJogos;
      $scope.badge.numeroproximo = $scope.proximoJogos
      $scope.badge.imgatual = document.getElementById("Jogos").src;
      $scope.badge.imganterior = $scope.anteriorimgJogos;
      $scope.badge.imgproximo = $scope.proximoimgJogos;
      formBadge.updateForm($scope.badge);
      $state.go('tabsController.badgesexplicaPerfilOutro');
    }
    if(badge == 'Musica'){
      $scope.badge.titulo = 'Chill';
      $scope.badge.texto = 'Você participou de eventos com #Musica';
      $scope.badge.numeroatual = $scope.auxnbadgeMusica;
      $scope.badge.numeroproximo = $scope.proximoMusica
      $scope.badge.imgatual = document.getElementById("Musica").src;
      $scope.badge.imganterior = $scope.anteriorimgMusica;
      $scope.badge.imgproximo = $scope.proximoimgMusica;
      formBadge.updateForm($scope.badge);
      $state.go('tabsController.badgesexplicaPerfilOutro');
    }
    if(badge == 'Natureza'){
      $scope.badge.titulo = 'Do mato';
      $scope.badge.texto = 'Você participou de eventos com #Natureza';
      $scope.badge.numeroatual = $scope.auxnbadgeNatureza;
      $scope.badge.numeroproximo = $scope.proximoNatureza
      $scope.badge.imgatual = document.getElementById("Natureza").src;
      $scope.badge.imganterior = $scope.anteriorimgNatureza;
      $scope.badge.imgproximo = $scope.proximoimgNatureza;
      formBadge.updateForm($scope.badge);
      $state.go('tabsController.badgesexplicaPerfilOutro');
    }
    if(badge == 'Passeio'){
      $scope.badge.titulo = 'Do rolê';
      $scope.badge.texto = 'Você participou de eventos com #Passeio';
      $scope.badge.numeroatual = $scope.auxnbadgePasseio;
      $scope.badge.numeroproximo = $scope.proximoPasseio
      $scope.badge.imgatual = document.getElementById("Passeio").src;
      $scope.badge.imganterior = $scope.anteriorimgPasseio;
      $scope.badge.imgproximo = $scope.proximoimgPasseio;
      formBadge.updateForm($scope.badge);
      $state.go('tabsController.badgesexplicaPerfilOutro');
    }
    if(badge == 'Pets'){
      $scope.badge.titulo = 'Amo animais';
      $scope.badge.texto = 'Você participou de eventos com #Pets';
      $scope.badge.numeroatual = $scope.auxnbadgePets;
      $scope.badge.numeroproximo = $scope.proximoPets
      $scope.badge.imgatual = document.getElementById("Pets").src;
      $scope.badge.imganterior = $scope.anteriorimgPets;
      $scope.badge.imgproximo = $scope.proximoimgPets;
      formBadge.updateForm($scope.badge);
      $state.go('tabsController.badgesexplicaPerfilOutro');
    }
    if(badge == 'Restaurantesebares'){
      $scope.badge.titulo = 'Degustador';
      $scope.badge.texto = 'Você participou de eventos com #Restaurantesebares';
      $scope.badge.numeroatual = $scope.auxnbadgeRestaurantesebares;
      $scope.badge.numeroproximo = $scope.proximoRestaurantesebares
      $scope.badge.imgatual = document.getElementById("Restaurantesebares").src;
      $scope.badge.imganterior = $scope.anteriorimgRestaurantesebares;
      $scope.badge.imgproximo = $scope.proximoimgRestaurantesebares;
      formBadge.updateForm($scope.badge);
      $state.go('tabsController.badgesexplicaPerfilOutro');
    }
    if(badge == 'Surf'){
      $scope.badge.titulo = 'Surf';
      $scope.badge.texto = 'Você participou de eventos com #Surf';
      $scope.badge.numeroatual = $scope.auxnbadgeSurf;
      $scope.badge.numeroproximo = $scope.proximoSurf
      $scope.badge.imgatual = document.getElementById("Surf").src;
      $scope.badge.imganterior = $scope.anteriorimgSurf;
      $scope.badge.imgproximo = $scope.proximoimgSurf;
      formBadge.updateForm($scope.badge);
      $state.go('tabsController.badgesexplicaPerfilOutro');
    }
    if(badge == 'Voluntariado'){
      $scope.badge.titulo = 'Ajudar sempre é bom';
      $scope.badge.texto = 'Você participou de eventos com #Voluntariado';
      $scope.badge.numeroatual = $scope.auxnbadgeVoluntariado;
      $scope.badge.numeroproximo = $scope.proximoVoluntariado
      $scope.badge.imgatual = document.getElementById("Voluntariado").src;
      $scope.badge.imganterior = $scope.anteriorimgVoluntariado;
      $scope.badge.imgproximo = $scope.proximoimgVoluntariado;
      formBadge.updateForm($scope.badge);
      $state.go('tabsController.badgesexplicaPerfilOutro');
    }

  }


}])

.controller('badgesexplicaPerfilOutroCtrl', ['$scope', '$stateParams', 'formOutro', 'EventoService','$ionicPopup', '$timeout','$state', '$cordovaCamera', '$cordovaFile', '$cordovaFileTransfer', '$ionicLoading','formBadge', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, formOutro, EventoService, $ionicPopup, $timeout, $state, $cordovaCamera, $cordovaFile, $cordovaFileTransfer, $ionicLoading, formBadge) {

  // $scope.user = formOutro.getForm();
  // $scope.badge = formBadge.getForm();
  // document.getElementById("badgeimg").src=$scope.badge.imgatual;
  // document.getElementById("Atual").src=$scope.badge.imgatual;
  // document.getElementById("Anterior").src=$scope.badge.imganterior;
  // document.getElementById("Proximonivel").src=$scope.badge.imgproximo;
  // $scope.badge.progressPercent = $scope.badge.numeroatual * 100 / $scope.badge.numeroproximo;
  
   

  $scope.$on("$ionicView.enter", function(event, data){
    $scope.user = formOutro.getForm();
    $scope.badge = formBadge.getForm();
    
    document.getElementById("Atual").src=$scope.badge.imgatual;
    document.getElementById("Anterior").src=$scope.badge.imganterior;
    document.getElementById("Proximonivel").src=$scope.badge.imgproximo;
    console.log($scope.badge.imgatual)
    $scope.badge.progressPercent = $scope.badge.numeroatual * 100 / $scope.badge.numeroproximo;
   
  });


}])
       
.controller('loginCtrl', ['$scope', '$stateParams', '$state', 'EventoService','$ionicPopup','$timeout','formUser','$ionicLoading','$q','formLoc', 'formtipologin', 'formCodigo', '$http',  // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, $state, EventoService, $ionicPopup, $timeout, formUser, $ionicLoading, $q, formLoc, formtipologin, formCodigo, $http) {
    $scope.user = {
      email: '',
      password: ''
    };
    $scope.codigo = formCodigo.getForm();

    $scope.usuario ={};
    $scope.concordo = { checked: false };
    var lat;
    var long;
    var myLatlng;
    var spherical; 
    var north; 
    var west; 
    var south; 
    var east;
    var raio;
    $scope.parceiro = function(){
      $state.go('onboardingcomercio')
    }
    // $scope.teste = function(){
    //   console.log($scope.user.iduser)
    // }
    // navigator.geolocation.getCurrentPosition(function(position){
    //   raio = 30000*0.71;
    //   lat  = position.coords.latitude;
    //   long = position.coords.longitude;
    //   $scope.user.lat =  position.coords.latitude;
    //   $scope.user.long =  position.coords.longitude;

    //   myLatlng = new google.maps.LatLng(lat, long);
    //   spherical = google.maps.geometry.spherical; 
    //   north = spherical.computeOffset(myLatlng, raio, 0); 
    //   west  = spherical.computeOffset(myLatlng, raio, -90); 
    //   south = spherical.computeOffset(myLatlng, raio, 180); 
    //   east  = spherical.computeOffset(myLatlng, raio, 90);
    //   $scope.user.northlat = north.lat();
    //   $scope.user.westlng = west.lng();
    //   $scope.user.southlat = south.lat();
    //   $scope.user.eastlng = east.lng();
    //   formLoc.updateForm($scope.user);
    // },function (error) { 
    //   if (error.code == error.PERMISSION_DENIED)
    //       console.log("you denied me :-(");
    //       $scope.semloc = true;
    //   });

    $scope.$on("$ionicView.enter", function(event, data){
      $scope.user = {
        email: '',
        password: ''
      };
      $scope.codigo = formCodigo.getForm();
      $scope.usuario ={};
      $scope.concordo = { checked: false };
      // navigator.geolocation.getCurrentPosition(function(position){
      //   raio = 30000*0.71;
      //   lat  = position.coords.latitude;
      //   long = position.coords.longitude;
      //   $scope.user.lat =  position.coords.latitude;
      //   $scope.user.long =  position.coords.longitude;

      //   myLatlng = new google.maps.LatLng(lat, long);
      //   spherical = google.maps.geometry.spherical; 
      //   north = spherical.computeOffset(myLatlng, raio, 0); 
      //   west  = spherical.computeOffset(myLatlng, raio, -90); 
      //   south = spherical.computeOffset(myLatlng, raio, 180); 
      //   east  = spherical.computeOffset(myLatlng, raio, 90);
      //   $scope.user.northlat = north.lat();
      //   $scope.user.westlng = west.lng();
      //   $scope.user.southlat = south.lat();
      //   $scope.user.eastlng = east.lng();
      //   formLoc.updateForm($scope.user);
      // },function (error) { 
      //   if (error.code == error.PERMISSION_DENIED)
      //       console.log("you denied me :-(");
      //       $scope.semloc = true;
      //   });
    });

    $scope.checkLoginState = function(){
    facebookConnectPlugin.login(["public_profile","email"],function(result){
            console.log(result)
          },
          function (result) {}
        );
   }

                


    $scope.facebookSignIn = function(){

      // if ($scope.concordo.checked) {
      facebookConnectPlugin.login(["public_profile","email"],function(result){
        //calling api after login success
        //alert("OI")
        facebookConnectPlugin.api("me/picture?width=600&height=600&redirect=false",["public_profile"],function (res) {
            $scope.user.profilepic = res.data.url;
            //alert("olá")
          },
          function (res) {}
        );

        facebookConnectPlugin.api("/me?fields=email,name",["public_profile","email"],function(userData){
              //API success callback
              //alert(JSON.stringify(userData));
              $scope.user.email = userData.email;
              $scope.user.apelido = userData.name;
              $scope.user.username = userData.name.replace(/\s/g,'');
              $scope.user.password = userData.id;
              if(!$scope.user.profilepic){
                $scope.user.profilepic = 'https://graph.facebook.com/'+userData.id+'/picture?type=large&width=720&height=720';
              }
              EventoService.verificanome($scope.user.username).then(function(success){                  
                if(success){
                  $scope.user.username = $scope.user.username +$scope.user.password[0]+$scope.user.password[1]+$scope.user.password[2];
                }  
                // if(userData.gender){
                //   if(userData.gender == "male"){
                //     $scope.user.genero = "masc";
                //   }else{
                //     $scope.user.genero = "fem";
                //   }
                // } 
                // if(userData.birthda){
                //  var today = new Date();
                //   var birthDate = new Date(userData.birthday);
                //   $scope.user.idade = today.getFullYear() - birthDate.getFullYear();
                //   var m = today.getMonth() - birthDate.getMonth();
                //   if (m < 0 || (m === 0 && today.getDate() < birthDate.getDate())) {
                //       $scope.user.idade--;
                //   } 
                // }
                // if(userData.age_range){
                //   $scope.user.idade =userData.age_range;
                // }
                 //alert("olá2")
                EventoService.Entrando($scope.user).then(function(data){ //alert("olá3")
                  if(data.success){

                    $scope.user.devicetoken = window.localStorage.getItem( 'token' );
                    $scope.user.iduser = data[0].iduser;
                    EventoService.Mudadevice($scope.user);
                    $ionicLoading.hide();
                    formtipologin.updateForm(1);
                    var alertPopup = $ionicPopup.alert({
                        title: 'Olá', 
                        template: 'Bem vindo!',
                        buttons: [
                            {
                              text: 'ԅ( ˘ω˘ ԅ)',
                              type: 'button-positive'
                            }]  
                        });
                      alertPopup.then(function(){
                        window.localStorage.setItem( 'user', JSON.stringify(data[0]));
                            formUser.updateForm(data[0]);
                            $state.go('tabsController.home');
                      })  
                  }else{
                    EventoService.CriaConta($scope.user).then(function(resp){
                      if(resp.success){
                        formtipologin.updateForm(1);
                        var alertPopup = $ionicPopup.alert({
                              title: 'Olá', 
                              template: 'Bem vindo!',
                              buttons: [
                                  {
                                    text: 'ԅ( ˘ω˘ ԅ)',
                                    type: 'button-positive'
                                  }]     
                        });
                        alertPopup.then(function(){

                          $scope.loc = formLoc.getForm();
                          if($scope.loc){
                            $scope.user.lat =  $scope.loc.lat;
                            $scope.user.long =  $scope.loc.long;
                            $scope.user.northlat = $scope.loc.northlat;
                            $scope.user.westlng = $scope.loc.westlng;
                            $scope.user.southlat = $scope.loc.southlat;
                            $scope.user.eastlng = $scope.loc.eastlng;
                            //console.log($scope.loc.eastlng)
                          }else{
                            navigator.geolocation.getCurrentPosition(function(position){
                            console.log("to aqui")
                            raio = 30000*0.71;
                            lat  = position.coords.latitude;
                            long = position.coords.longitude;
                            $scope.user.lat =  position.coords.latitude;
                            $scope.user.long =  position.coords.longitude;

                            myLatlng = new google.maps.LatLng(lat, long);
                            spherical = google.maps.geometry.spherical; 
                            north = spherical.computeOffset(myLatlng, raio, 0); 
                            west  = spherical.computeOffset(myLatlng, raio, -90); 
                            south = spherical.computeOffset(myLatlng, raio, 180); 
                            east  = spherical.computeOffset(myLatlng, raio, 90);
                            $scope.user.northlat = north.lat();
                            $scope.user.westlng = west.lng();
                            $scope.user.southlat = south.lat();
                            $scope.user.eastlng = east.lng();
                            formLoc.updateForm($scope.user);
                          },function (error) { 
                            if (error.code == error.PERMISSION_DENIED)
                                console.log("you denied me :-(");
                                $scope.semloc = true;
                            });
                          }
                          EventoService.confereconvite($scope.codigo).then(function(resp) {
                              var currentdate = new Date();
                              currentdate.setDate(currentdate.getDate() - 14);
                              var curr_date = (currentdate.getDate()<10?'0':'') + currentdate.getDate();
                              var curr_month = (currentdate.getMonth()<10?'0':'') + (currentdate.getMonth() + 1); 
                              var curr_year = currentdate.getFullYear();
                              var h2 = (currentdate.getHours()<10?'0':'') + currentdate.getHours();
                              var m2 = (currentdate.getMinutes()<10?'0':'') + currentdate.getMinutes();
                              var j = curr_year + "-" + curr_month + "-" + curr_date+ ' '+h2 + ':' + m2 + ':00';
                              console.log(j, resp[0].codigodatacriacao)
                              if(resp[0].codigodatacriacao > j){
                                resp[0].numcodigo = parseInt(resp[0].numcodigo) + 1
                                console.log(resp[0].numcodigo)
                                if(resp[0].numcodigo == 3){
                                  $http.post('https://ec2.diwoapp.com.br/gastapontospessoaevento.php', {idevento : -100,
                                            iduser : resp[0].iduser,
                                            borda : '0',
                                            username:  resp[0].username,
                                            apelido : resp[0].apelido,
                                            nomeevento :  "Entrou com convite", 
                                            estado : 10,
                                            pontos: 10});
                                  $scope.atualiza = {};
                                  var po = resp[0].pontos.valueOf()+10;
                                  $scope.atualiza.pontos = po;
                                  $scope.atualiza.iduser = resp[0].iduser;
                                  EventoService.atualizarpontos($scope.atualiza);
                                }
                                $http.post('https://ec2.diwoapp.com.br/somanumcodigo.php', {iduser : resp[0].iduser,
                                                                                                      numcodigo : resp[0].numcodigo});
                              }
                          });
                          EventoService.Entrando($scope.user).then(function(data){
                            window.localStorage.setItem( 'user', JSON.stringify(data[0]));
                            $http.post('https://ec2.diwoapp.com.br/gastapontospessoaevento.php', {idevento : -100,
                                            iduser : data[0].iduser,
                                            borda : '0',
                                            username: data[0].username,
                                            apelido : data[0].apelido,
                                            nomeevento :  "Criou conta", 
                                            estado : 10,
                                            pontos: 10});
                            formUser.updateForm(data[0]);
                            $state.go('idadegenero');
                          })
                        });
                      }else{
                        var alertPopup = $ionicPopup.alert({
                          title: 'ಠ_ಠ',
                          template: 'Ja existe uma conta vinculada a esse email'
                        });
                      }  
                    }); 
                  }
                }); 
              });
        },function(error){
           //API error callback
           alert(JSON.stringify(error));
        });
      },function(error){
        //authenication error callback
        alert(JSON.stringify(error));
       });
     //  }else{
     //    var alertPopup = $ionicPopup.alert({
     //          title: 'ԅ( ˘ω˘ ԅ)',
     //          template: 'Para que possa entrar você precisa concordar com os termos de uso no app, afinal de contas nao queremos nenhum mal entendido'
     //    });
     // }
      
    }

    $scope.entrar = function(){
      
      $scope.entrarcomemail = true;
    }

    $scope.login = function() {
  
      if($scope.user.email){
          $ionicLoading.show({
            template: '<ion-spinner icon="ripple" class="spinner-diwo"></ion-spinner>'+
                      '<p style="color:#ff4444;font-weight:bold;font-family:Kollektif;padding:auto;margin:auto;">TOC TOC!!!</p>'
          });
        var authenticationData = {
        Username : $scope.user.email,
        Password : $scope.user.password,
          };
        
        var authenticationDetails = new AmazonCognitoIdentity.AuthenticationDetails(authenticationData);
          
        var poolData = {
          UserPoolId : 'us-east-1_nOWA67ADf', // Your user pool id here
          ClientId : '8k5rbqhifi5r1hb2j4n1u07li'// Your client id here
        };
        
          var userPool = new AmazonCognitoIdentity.CognitoUserPool(poolData);
        
          var userData = {
              Username : $scope.user.email,
              Pool : userPool,
          };
        
          var cognitoUser = new AmazonCognitoIdentity.CognitoUser(userData);
          
        cognitoUser.authenticateUser(authenticationDetails, {
              onSuccess: function (result) {
            var accessToken = result.getAccessToken().getJwtToken();
            //console.log(accessToken); 
              },

              onFailure: function(err) {
                  //alert(err.message || JSON.stringify(err));
                  $ionicLoading.hide();
              },
          });

      EventoService.Entrando($scope.user).then(function(data){
        if(data.success){
          $scope.user.devicetoken = window.localStorage.getItem( 'token' );
          $scope.user.iduser = data[0].iduser;
          EventoService.Mudadevice($scope.user);
          $ionicLoading.hide();
          if(data[0].estado == '1' && data[0].tipodeconta =='comercio'){
            var alertPopup = $ionicPopup.alert({
                        title: 'Conta sob análise',
                        template: 'Sua conta esta sob análise para ser aprovada como um parceiro nosso, em caso de dúvidas entre em contato!'
                      });
          }else{  
            var alertPopup = $ionicPopup.alert({
                title: 'Olá', 
                template: 'Bem vindo!',
                buttons: [
                    {
                      text: 'ԅ( ˘ω˘ ԅ)',
                      type: 'button-positive'
                    }]   
            });
            alertPopup.then(function(){
              formtipologin.updateForm(2);
              window.localStorage.setItem( 'user', JSON.stringify(data[0]));
              formUser.updateForm(data[0]);
              if(data[0].tipodeconta!='comercio'){
              
                  $state.go('tabsController.home');
                
                
              }else{
                  $state.go('perfilComercio');
              }
            })  
          }
       }else{
        $ionicLoading.hide();
        var alertPopup = $ionicPopup.alert({
              title: 'Login falhou',
              template: data.msg
        });
       }
      });   
     }else{
        var alertPopup = $ionicPopup.alert({
              title: 'ԅ( ˘ω˘ ԅ)',
              template: 'Coloque o email'
        });
     }
    }

    $scope.Esqueci = function(){
      if(!$scope.user.email){
        var alertPopup = $ionicPopup.alert({
              title: 'Nos ajude',
              template: 'Complete o campo de email para refazer sua senha'
        });
      }else{
        var poolData = {
          UserPoolId : 'us-east-1_nOWA67ADf', // Your user pool id here
          ClientId : '8k5rbqhifi5r1hb2j4n1u07li'// Your client id here
        };
    
        var userPool = new AmazonCognitoIdentity.CognitoUserPool(poolData);
    
        var userData = {
          Username : $scope.user.email,
          Pool : userPool,
        };
      console.log($scope.user.email)
        var cognitoUser = new AmazonCognitoIdentity.CognitoUser(userData);
      
        cognitoUser.forgotPassword({
          onSuccess: function (result) {
              console.log('call result: ' + result);
              
          },
          onFailure: function(err) {
          //alert(err);
            var alertPopup = $ionicPopup.alert({
                title: 'ᇂﮌᇂ) ',
                template: 'Não encontramos seu email em nossas anotações, tente criar um novo usuário com o mesmo email, caso o problema continue acontecendo entre em contato!'
              })
          },
          inputVerificationCode() {
            var alertPopup = $ionicPopup.alert({
                title: '＼(^-^)／',
                template: 'Estamos verificando seu email, enviamos um código para ele!'
              })
              alertPopup.then(function(){
                formUser.updateForm($scope.user);
                $state.go('esquecisenha')
              });
             // $ionicPopup.prompt({
             //                  title: 'Enviamos um código',
             //                  template: 'Insira o código de verificação no seu email',
             //                 inputType: 'text',
             //                 inputPlaceholder: 'XXXXXX'
             //               }).then(function(verificationCode) {
             //                if(!verificationCode || verificationCode == ""){
             //                  console.log("nao dei")
             //                }else{
             //                  $ionicPopup.prompt({
             //                  title: 'Nova senha',
             //                  template: 'Qual vai ser minha nova senha que nao esquecerei?',
             //                 inputType: 'text',
             //                 inputPlaceholder: 'Diwo1234'
             //              }).then(function(newPassword) {
             //                if(!newPassword || newPassword == ""){
             //                  var alertPopup = $ionicPopup.alert({
             //                    title: '-.-"',
             //                    template: 'Escreva uma nova senha de acordo com as regras'
             //                  });
             //                }else{
             //                  cognitoUser.confirmPassword(verificationCode, newPassword, this);
             //                  $scope.usuario.email = $scope.user.email;
             //                  $scope.usuario.password = newPassword;
             //                  EventoService.atualizarsenha($scope.usuario).then(function(data){
             //                    if (data) {
             //                      var alertPopup = $ionicPopup.alert({
             //                        title: 'Deu boa',
             //                        template: 'Senha alterada com sucesso, agora é só não esquecer dessa!'
             //                      });
             //                    }else{
             //                      var alertPopup = $ionicPopup.alert({
             //                        title: 'Deu ruim',
             //                        template: 'Senha não pode ser alterada, tente novamente, se o problema persistir contate a gente!'
             //                      });
             //                    }
                                
             //                  });;
             //                }
             //             }); 
             //                }
                           
             //        });
          }
        });
      }
      
     }

}])

.controller('esquecisenhaCtrl', ['$scope', '$stateParams', '$ionicPopup', '$http', '$timeout', 'EventoService','formUser','$state','formtipologin','$ionicLoading',  // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, $ionicPopup, $timeout, $http, EventoService, formUser, $state, formtipologin, $ionicLoading) {

  $scope.user = formUser.getForm();
  
  $scope.Proximo = function(){console.log($scope.user.password, $scope.user.codigosenha)
     if(!$scope.user.password || $scope.user.password == ""){
      var alertPopup = $ionicPopup.alert({
        title: '-.-"',
        template: 'Escreva uma nova senha de acordo com as regras'
      });
    }
    else{
      if(!$scope.user.password || $scope.user.password == ""){
        var alertPopup = $ionicPopup.alert({
          title: '-.-"',
          template: 'Escreva uma nova senha de acordo com as regras'
        });
      }else{
        $ionicLoading.show({
            template: '<ion-spinner icon="ripple" class="spinner-diwo"></ion-spinner>'+
                      '<p style="color:#ff4444;font-weight:bold;font-family:Kollektif;padding:auto;margin:auto;">Fabricando nova senha!!</p>'
          });
        cognitoUser.confirmPassword($scope.user.codigosenha, $scope.user.password, this);
        $scope.usuario.email = $scope.user.email;
        $scope.usuario.password = $scope.user.password;
        EventoService.atualizarsenha($scope.usuario).then(function(data){
          if (data) {
            var alertPopup = $ionicPopup.alert({
              title: 'Deu boa',
              template: 'Senha alterada com sucesso, agora é só não esquecer dessa!'
            })
            alertPopup.then(function(){
              EventoService.Entrando($scope.user).then(function(data){
                
                if(data.success){
                  $scope.user.devicetoken = window.localStorage.getItem( 'token' );
                  $scope.user.iduser = data[0].iduser;
                  EventoService.Mudadevice($scope.user);
                  $ionicLoading.hide();
                  formtipologin.updateForm(2);
                  window.localStorage.setItem( 'user', JSON.stringify(data[0]));
                  formUser.updateForm(data[0]);
                  if(data[0].tipodeconta!='comercio'){
                    $state.go('tabsController.home');
                  }else{
                    if(data[0].estado == '1'){
                      var alertPopup = $ionicPopup.alert({
                                  title: 'Conta sob análise',
                                  template: 'Sua conta esta sob análise para ser aprovada como um parceiro nosso, em caso de dúvidas entre em contato!'
                                });
                    }else{
                      $state.go('perfilComercio');
                    }
                  }
               
               }else{
                $ionicLoading.hide();
                var alertPopup = $ionicPopup.alert({
                      title: 'Login falhou',
                      template: data.msg
                  });
                }
              });
            })  
          }else{
            var alertPopup = $ionicPopup.alert({
              title: 'Deu ruim',
              template: 'Senha não pode ser alterada, tente novamente, se o problema persistir contate a gente!'
            })
            alertPopup.then(function(){
              $state.go('logando');
            })
          }
          
        });
      }
    }
  }
}])



   
.controller('nomeuserCtrl', ['$scope', '$stateParams', '$ionicPopup', '$http', '$timeout', 'EventoService','formUser','$state',  // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, $ionicPopup, $timeout, $http, EventoService, formUser, $state) {

  $scope.user = formUser.getForm();
  $scope.userexiste = false;
  $scope.usernexite = false;
  $scope.verifique = false;
  $scope.verifica = function(){
    EventoService.verificanome($scope.user.username).then(function(success){
    console.log(success, "'dasd",$scope.user.email, $scope.user.genero )                         
      if(!success){
        $scope.usernexite = true;
        $scope.userexiste = false;
        $scope.verifique = false;
      }else{
        $scope.userexiste = true;
        $scope.usernexite = false;
        $scope.verifique = false;
      }
    });
  };
  $scope.items = {};
     EventoService.Getranking().then(function (oi){
                                var tamanho = oi.length;
                                $scope.items = oi;
                                for(var i = 0; i<tamanho;i++){
                                  $scope.items[i].colocacao = i+1; 
                                }
                             });

  $scope.pronto = function(){   
  console.log($scope.usernexite)                
    if($scope.usernexite){
      EventoService.CriaConta($scope.user);
      EventoService.Entrando($scope.user).then(function(data){
        var alertPopup = $ionicPopup.alert({
              title: 'Olá', 
              template: 'Bem vindo!',
              buttons: [
                  {
                    text: 'oi',
                    type: 'button-positive'
                  }]
        });
         alertPopup.then(function(){
                  formUser.updateForm(data[0]);
                  if($scope.user.tipodeconta!=null){
                    $state.go('tabsController.home');
                  }else{
                     if(data[0].estado == '1'){
                      var alertPopup = $ionicPopup.alert({
                                  title: 'Conta sob análise',
                                  template: 'Sua conta esta sob análise para ser aprovada como um parceiro nosso, em caso de dúvidas entre em contato!'
                                });
                    }else{
                      $state.go('perfilComercio');
                    }
                  }
                })  

      }, function(errMsg){
        var alertPopup = $ionicPopup.alert({
              title: 'Login falhou',
              template: errMsg.msg
        });
      })
    }else{
      $scope.verifique = true;
    }
  };
}])
   
.controller('EditEvCtrl', ['$scope', '$stateParams', '$ionicPopup', '$http', '$cordovaDevice', '$timeout', 'EventoService','formUser','$state', 'formEventoAbertosTab', 'formEventoEdita','$cordovaCamera', '$cordovaFile', '$cordovaFileTransfer', '$cordovaDevice',  '$ionicLoading',  // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, $ionicPopup, $http, $cordovaDevice, $timeout, EventoService, formUser, $state,formEventoAbertosTab, formEventoEdita, $cordovaCamera, $cordovaFile, $cordovaFileTransfer, $cordovaDevice,  $ionicLoading) {
  $scope.evento = {};
  $scope.evento = formEventoEdita.getForm();
  $scope.auxfoto = '';
  $scope.user = formUser.getForm();
  var mudoufoto = false;
  var noti = {};
  $scope.pushnoti = {};

  $scope.limiteconfirmacao ={};
  $scope.fim = {};
  $scope.inicio = {};

  var auxdiainicio = $scope.evento.diainicio;

  $scope.evento.dateconfirma = $scope.evento.dialimiteconfirmacao.toLocaleString();
  $scope.evento.dateinicio = $scope.evento.diainicio;
  $scope.evento.datefim = $scope.evento.diafim;
  
  var currentdate = new Date(); 
  var curr_date = (currentdate.getDate()<10?'0':'') + currentdate.getDate();
  var curr_month = (currentdate.getMonth()<9?'0':'') + (currentdate.getMonth() + 1); //Months are zero based
  var curr_year = currentdate.getFullYear();
  var curr_h = (currentdate.getHours()<10?'0':'') + currentdate.getHours();
  var curr_m = (currentdate.getMinutes()<10?'0':'') + currentdate.getMinutes();
  var curr_j = curr_year + "-" + curr_month + "-" + curr_date+ ' '+curr_h + ':' + curr_m + ':' + '00';
  
  EventoService.verificahorariopessoaevento($scope.user).then(function(items) {
    if (items!="Error") {
      $scope.auxdata = items;
    }
  });
  document.getElementById("imageidEventoEditEv").src=$scope.evento.eventopic;
  $scope.mudafotoevento = function (optionsCamera) {
    var optionsCamera = {
          quality : 100,
          sourceType : 0,
          allowEdit : true,
          targetWidth: 640,
          targetHeight: 640
    };
    $cordovaCamera.getPicture(optionsCamera).then(function(imageData) {
      $scope.imgURI = imageData;
      mudoufoto = true;
      document.getElementById("imageidEventoEditEv").src=imageData;
    }, function(err) {
      console.log(err);
    });
    
  }

  $scope.mudaconfirma = function(){
    novaconfirma_date = ($scope.evento.dateconfirma.getDate()<10?'0':'') + $scope.evento.dateconfirma.getDate();
    novaconfirma_month = ($scope.evento.dateconfirma.getMonth()<9?'0':'') + ($scope.evento.dateconfirma.getMonth() + 1); //Months are zero based
    novaconfirma_year = $scope.evento.dateconfirma.getFullYear();
    novaconfirma_h = ($scope.evento.dateconfirma.getHours()<10?'0':'') + $scope.evento.dateconfirma.getHours();
    novaconfirma_m = ($scope.evento.dateconfirma.getMinutes()<10?'0':'') + $scope.evento.dateconfirma.getMinutes();
    novaconfirma_s = ($scope.evento.dateconfirma.getSeconds()<10?'0':'') + $scope.evento.dateconfirma.getSeconds();
    var novaconfirmaj = novaconfirma_year + "-" + novaconfirma_month + "-" + novaconfirma_date+ ' '+novaconfirma_h + ':' + novaconfirma_m + ':' + novaconfirma_s;
    

    if(curr_j>novaconfirmaj){
      var alertPopup = $ionicPopup.alert({
                  title: '(*ﾉ´□`)ﾉ~',
                  template: 'Muito em cima da hora para mudar pra ontem'
                });
      
    }else{
      if(novaconfirmaj>$scope.evento.diainicio){
        var alertPopup = $ionicPopup.alert({
                  title: 'ヽ ( ꒪д꒪ )ﾉ',
                  template: 'Evento nao pode começar depois da data limite de confirmação'
                });
      }else{
        $scope.limiteconfirmacao.dia =  novaconfirma_date +'/'+ novaconfirma_month;
        $scope.limiteconfirmacao.hora =  novaconfirma_h+':'+novaconfirma_m;  
        $scope.evento.dialimiteconfirmacao = novaconfirmaj;
        $scope.evento.dateconfirma = $scope.evento.dateconfirma.toLocaleString();
      }
    }
  }
  
  $scope.mudainicio = function(){
    var datainvalida = 0;
    
    novadateinicio_date = ($scope.evento.dateinicio.getDate()<10?'0':'') + $scope.evento.dateinicio.getDate();
    novadateinicio_month = ($scope.evento.dateinicio.getMonth()<9?'0':'') + ($scope.evento.dateinicio.getMonth() + 1); //Months are zero based
    novadateinicio_year = $scope.evento.dateinicio.getFullYear();
    novadateinicio_h = ($scope.evento.dateinicio.getHours()<10?'0':'') + $scope.evento.dateinicio.getHours();
    novadateinicio_m = ($scope.evento.dateinicio.getMinutes()<10?'0':'') + $scope.evento.dateinicio.getMinutes();
    novadateinicio_s = ($scope.evento.dateinicio.getSeconds()<10?'0':'') + $scope.evento.dateinicio.getSeconds();
    $scope.evento.semana = $scope.evento.dateinicio.getDay();
    var novadateinicioj = novadateinicio_year + "-" + novadateinicio_month + "-" + novadateinicio_date+ ' '+novadateinicio_h + ':' + novadateinicio_m + ':' + novadateinicio_s;
    
    if(curr_j>novadateinicioj){
      var alertPopup = $ionicPopup.alert({
                  title: '(*ﾉ´□`)ﾉ~',
                  template: 'Muito em cima da hora para mudar pra ontem'
                });
      
    }else{
      if($scope.evento.dialimiteconfirmacao>novadateinicioj){
        var alertPopup = $ionicPopup.alert({
                    title: '(*ﾉ´□`)ﾉ~',
                    template: 'Data de inicio não pode ser antes que a data limite de confirmação'
                  });
        
      }else{
        for(var r = 0;r<$scope.auxdata.length; r++){
          //console.log($scope.auxdata[r].idevento, $scope.auxdata[r].diainicio, $scope.auxdata[r].diafim , we ,$scope.evento.diafim);
          if($scope.evento.idevento!=$scope.auxdata[r].idevento){
            if (($scope.auxdata[r].diainicio <= novadateinicioj && $scope.auxdata[r].diafim >= novadateinicioj)  ) {
              datainvalida = 1;
            }
          }
        }
        if(r==$scope.auxdata.length && datainvalida == 1){
          var alertPopup = $ionicPopup.alert({
            title: 'Oww!!',
            template: 'Tu ja tem um evento marcado nesse horário :/'
          });
        }
        if(novadateinicioj>$scope.evento.datefim){
          console.log("to aquiwenqieni")
          $scope.fim.dia =  '??'+'/'+'??';
          $scope.fim.hora = '??'+':'+'??';
        }
        if(r==$scope.auxdata.length && datainvalida == 0){
          if($scope.evento.semana == 0){
            $scope.evento.semana = "Domingo";
          }
          if($scope.evento.semana == 1){
            $scope.evento.semana = "Segunda-feira";
          }
          if($scope.evento.semana == 2){
            $scope.evento.semana = "Terça-feira";
          }
          if($scope.evento.semana == 3){
            $scope.evento.semana = "Quarta-feira";
          }
          if($scope.evento.semana == 4){
            $scope.evento.semana = "Quinta-feira";
          }
          if($scope.evento.semana == 5){
            $scope.evento.semana = "Sexta-feira";
          }
          if($scope.evento.semana == 6){
            $scope.evento.semana = "Sábado";
          }
          $scope.inicio.dia =  novadateinicio_date +'/'+ novadateinicio_month;
          $scope.inicio.hora =  novadateinicio_h+':'+novadateinicio_m;  
          $scope.evento.diainicio = novadateinicioj;
          $scope.evento.dateinicio = $scope.evento.dateinicio.toLocaleString();
        }
      }
    }
  }

  $scope.mudafim = function(){
    var datainvalida = 0;
    
    novadatefim_date = ($scope.evento.datefim.getDate()<10?'0':'') + $scope.evento.datefim.getDate();
    novadatefim_month = ($scope.evento.datefim.getMonth()<9?'0':'') + ($scope.evento.datefim.getMonth() + 1); //Months are zero based
    novadatefim_year = $scope.evento.datefim.getFullYear();
    novadatefim_h = ($scope.evento.datefim.getHours()<10?'0':'') + $scope.evento.datefim.getHours();
    novadatefim_m = ($scope.evento.datefim.getMinutes()<10?'0':'') + $scope.evento.datefim.getMinutes();
    novadatefim_s = ($scope.evento.datefim.getSeconds()<10?'0':'') + $scope.evento.datefim.getSeconds();
    var novadatedatefimj = novadatefim_year + "-" + novadatefim_month + "-" + novadatefim_date+ ' '+novadatefim_h + ':' + novadatefim_m + ':' + novadatefim_s;
    
    if(curr_j>novadatedatefimj){
      var alertPopup = $ionicPopup.alert({
                  title: '(*ﾉ´□`)ﾉ~',
                  template: 'Muito em cima da hora para mudar pra ontem'
                });
      
    }else{
      if($scope.evento.dialimiteconfirmacao>novadatedatefimj){
        var alertPopup = $ionicPopup.alert({
                    title: '(*ﾉ´□`)ﾉ~',
                    template: 'Data de fim não pode ser antes que a data limite de confirmação'
                  });
        
      }else{
        if($scope.evento.diainicio>=novadatedatefimj){
        var alertPopup = $ionicPopup.alert({
                    title: '(*ﾉ´□`)ﾉ~',
                    template: 'Data de fim não pode ser antes que a data de início'
                  });
        }else{
          for(var r = 0;r<$scope.auxdata.length; r++){
            if($scope.evento.idevento!=$scope.auxdata[r].idevento){
              if (($scope.auxdata[r].diainicio <= novadatedatefimj && $scope.auxdata[r].diafim >= novadatedatefimj)  ) {
                datainvalida = 1;
              }
            }
          }
          if(r==$scope.auxdata.length && datainvalida == 1){
            var alertPopup = $ionicPopup.alert({
              title: 'Oww!!',
              template: 'Tu ja tem um evento marcado nesse horário :/'
            });
          }
          if(r==$scope.auxdata.length && datainvalida == 0){
            $scope.fim.dia =  novadatefim_date +'/'+ novadatefim_month;
            $scope.fim.hora =  novadatefim_h+':'+novadatefim_m;  
            $scope.evento.diafim = novadatedatefimj;
            $scope.evento.datefim = $scope.evento.datefim.toLocaleString();
          }
        }
      }
    }
  }
  
  var hjf = $scope.evento.diafim;
  $scope.fim.dia =  (hjf[8]+hjf[9]).valueOf()+'/'+(hjf[5]+hjf[6]).valueOf();
  $scope.fim.hora = (hjf[11]+hjf[12]).valueOf()+':'+(hjf[14]+hjf[15]).valueOf();
  
  var hj = $scope.evento.diainicio;
  $scope.inicio.dia = (hj[8]+hj[9]).valueOf()+'/'+(hj[5]+hj[6]).valueOf();
  $scope.inicio.hora = (hj[11]+hj[12]).valueOf()+':'+(hj[14]+hj[15]).valueOf();


  var  hjl = $scope.evento.dialimiteconfirmacao;
  $scope.limiteconfirmacao.dia =  (hjl[8]+hjl[9]).valueOf()+'/'+(hjl[5]+hjl[6]).valueOf();
  $scope.limiteconfirmacao.hora =  (hjl[11]+hjl[12]).valueOf()+':'+(hjl[14]+hjl[15]).valueOf();  
  
    $scope.evento.auxtag1 = '';
    $scope.evento.auxtag2 = '';
    $scope.evento.auxtag3 = '';
    $scope.evento.auxtagbutton1 = false;
    $scope.evento.auxtagbutton2 = false;
    $scope.evento.auxtagbutton3 = false;
    $scope.evento.auxtag4 = '';
    $scope.evento.auxtag5 = '';
    $scope.evento.auxtag6 = '';
    $scope.evento.auxtagbutton4 = false;
    $scope.evento.auxtagbutton5 = false;
    $scope.evento.auxtagbutton6 = false;
    $scope.evento.auxtag7 = '';
    $scope.evento.auxtag8 = '';
    $scope.evento.auxtag9 = '';
    $scope.evento.auxtagbutton7 = false;
    $scope.evento.auxtagbutton8 = false;
    $scope.evento.auxtagbutton9 = false;


    $scope.auxtags = {};
    EventoService.Gettags($scope.evento.idevento).then(function(tags) {
      var auxauxtagbut = true;
      $scope.auxtags = tags;
      for(var  i =0; i< tags.length;i++){
         if($scope.evento.auxtagbutton1 == false && auxauxtagbut){
            $scope.evento.auxtag1 = tags[i].tag;
            $scope.evento.auxtagbutton1 = true;
            auxauxtagbut = false;
          }
          if($scope.evento.auxtagbutton2 == false && auxauxtagbut){
            console.log($scope.evento.auxtagbutton2)
            $scope.evento.auxtag2 = tags[i].tag;
            $scope.evento.auxtagbutton2 = true;
            auxauxtagbut = false;
          }
          if($scope.evento.auxtagbutton3 == false && auxauxtagbut){
            $scope.evento.auxtag3 = tags[i].tag;
            $scope.evento.auxtagbutton3 = true;
            auxauxtagbut = false;
          }
          if($scope.evento.auxtagbutton4 == false && auxauxtagbut){
            $scope.evento.auxtag4 = tags[i].tag;
            $scope.evento.auxtagbutton4 = true;
            auxauxtagbut = false;
          }
          if($scope.evento.auxtagbutton5 == false && auxauxtagbut){
            $scope.evento.auxtag5 = tags[i].tag;
            $scope.evento.auxtagbutton5 = true;
            auxauxtagbut = false;
          }
          if($scope.evento.auxtagbutton6 == false && auxauxtagbut){
            $scope.evento.auxtag6 = tags[i].tag;
            $scope.evento.auxtagbutton6 = true;
            auxauxtagbut = false;
          }
          if($scope.evento.auxtagbutton7 == false && auxauxtagbut){
            $scope.evento.auxtag7 = tags[i].tag;
            $scope.evento.auxtagbutton7 = true;
            auxauxtagbut = false;
          }
          if($scope.evento.auxtagbutton8 == false && auxauxtagbut){
            $scope.evento.auxtag8 = tags[i].tag;
            $scope.evento.auxtagbutton8 = true;
            auxauxtagbut = false;
          }
          if($scope.evento.auxtagbutton9 == false && auxauxtagbut){
            $scope.evento.auxtag9 = tags[i].tag;
            $scope.evento.auxtagbutton9 = true;
            auxauxtagbut = false;
          }
          auxauxtagbut = true;
      } 
    });

    var auxauxtagbut = false;
    $scope.adicionatag = function(){
      if($scope.evento.addtag!=''){
        var res2 = $scope.evento.addtag.split(" ") ;
          if(res2.length>1){
            for(var w = 0; w < res2.length; w++){
              var t = res2[w].toLowerCase();
             console.log(t)
            }
            $scope.evento.addtag = res2[0];
          }
        if(!auxauxtagbut){
          auxauxtagbut = true;
          if($scope.evento.auxtagbutton1 == false && auxauxtagbut){
            $scope.evento.auxtag1 = '#' +$scope.evento.addtag;
            $scope.evento.auxtagbutton1 = true;
            auxauxtagbut = false;
          }
          if($scope.evento.auxtagbutton2 == false && auxauxtagbut){
            $scope.evento.auxtag2 = '#' +$scope.evento.addtag;
            $scope.evento.auxtagbutton2 = true;
            auxauxtagbut = false;
          }
          if($scope.evento.auxtagbutton3 == false && auxauxtagbut){
            $scope.evento.auxtag3 = '#' +$scope.evento.addtag;
            $scope.evento.auxtagbutton3 = true;
            auxauxtagbut = false;
          }
          if($scope.evento.auxtagbutton4 == false && auxauxtagbut){
            $scope.evento.auxtag4 = '#' +$scope.evento.addtag;
            $scope.evento.auxtagbutton4 = true;
            auxauxtagbut = false;
          }
          if($scope.evento.auxtagbutton5 == false && auxauxtagbut){
            $scope.evento.auxtag5 = '#' +$scope.evento.addtag;
            $scope.evento.auxtagbutton5 = true;
            auxauxtagbut = false;
          }
          if($scope.evento.auxtagbutton6 == false && auxauxtagbut){
            $scope.evento.auxtag6 = '#' +$scope.evento.addtag;
            $scope.evento.auxtagbutton6 = true;
            auxauxtagbut = false;
          }
          if($scope.evento.auxtagbutton7 == false && auxauxtagbut){
            $scope.evento.auxtag7 = '#' +$scope.evento.addtag;
            $scope.evento.auxtagbutton7 = true;
            auxauxtagbut = false;
          }
          if($scope.evento.auxtagbutton8 == false && auxauxtagbut){
            $scope.evento.auxtag8 = '#' +$scope.evento.addtag;
            $scope.evento.auxtagbutton8 = true;
            auxauxtagbut = false;
          }
          if($scope.evento.auxtagbutton9 == false && auxauxtagbut){
            $scope.evento.auxtag9 = '#' +$scope.evento.addtag;
            $scope.evento.auxtagbutton9 = true;
            auxauxtagbut = false;
          }
        }
      }
      $scope.evento.addtag = '';
    }

    $scope.tiratag1 = function(){
        $scope.evento.auxtagbutton1 = false;
        $scope.evento.auxtag1 = '';
    }
    $scope.tiratag2 = function(){
        $scope.evento.auxtagbutton2 = false;
        $scope.evento.auxtag2 = '';
    }
    $scope.tiratag3 = function(){
        $scope.evento.auxtagbutton3 = false;
        $scope.evento.auxtag3 = '';
    }
    $scope.tiratag4 = function(){
        $scope.evento.auxtagbutton4 = false;
        $scope.evento.auxtag4 = '';
    }
    $scope.tiratag5 = function(){
        $scope.evento.auxtagbutton5 = false;
        $scope.evento.auxtag5 = '';
    }
    $scope.tiratag6 = function(){
        $scope.evento.auxtagbutton6 = false;
        $scope.evento.auxtag6 = '';
    }
    $scope.tiratag7 = function(){
        $scope.evento.auxtagbutton7 = false;
        $scope.evento.auxtag7 = '';
    }
    $scope.tiratag8 = function(){
        $scope.evento.auxtagbutton8 = false;
        $scope.evento.auxtag8 = '';
    }
    $scope.tiratag9 = function(){
        $scope.evento.auxtagbutton9 = false;
        $scope.evento.auxtag9 = '';
    }

    $scope.mudaloc = function(){
      formEventoEdita.updateForm($scope.evento);
      $state.go('tabsController.EditaEventoPart2')
    }

    $scope.mudamais = function(){
      formEventoEdita.updateForm($scope.evento);
      $state.go('tabsController.EditaEventoPart3')
    }

    $scope.salvar = function(evento){
      if ($scope.evento.nomeevento == '') {
        var alertPopup = $ionicPopup.alert({
          title: 'ʕ•ᴥ•ʔ',
          template: 'Coloque um titulo válido'
        });
      }else{
        if($scope.evento.diafim <$scope.evento.diainicio){
          var alertPopup = $ionicPopup.alert({
            title: 'ʕ•ᴥ•ʔ',
            template: 'Data de termino eh antes do dia de inicio!! Assim não da'
          });
        }else{
         var existe = 0;
          var link = 'https://ec2.diwoapp.com.br/deletatag.php';
          $http.post(link, {idevento : $scope.evento.idevento}).then(function(items) {
            if($scope.evento.auxtagbutton1 == true){
              existe = 0;
              var link = 'https://ec2.diwoapp.com.br/criartag.php';
              $http.post(link, {idevento : $scope.evento.idevento, 
                                      tag : $scope.evento.auxtag1});
            }
            if($scope.evento.auxtagbutton2 == true){
              existe = 0;
              var link = 'https://ec2.diwoapp.com.br/criartag.php';
              $http.post(link, {idevento : $scope.evento.idevento, 
                                      tag : $scope.evento.auxtag2});
            }
            if($scope.evento.auxtagbutton3 == true){
              existe = 0;
              var link = 'https://ec2.diwoapp.com.br/criartag.php';
              $http.post(link, {idevento : $scope.evento.idevento, 
                                      tag : $scope.evento.auxtag3});
            }
            if($scope.evento.auxtagbutton4 == true){
              existe = 0;
              var link = 'https://ec2.diwoapp.com.br/criartag.php';
              $http.post(link, {idevento : $scope.evento.idevento, 
                                      tag : $scope.evento.auxtag4});
            }
            if($scope.evento.auxtagbutton5 == true){
              existe = 0;
              var link = 'https://ec2.diwoapp.com.br/criartag.php';
              $http.post(link, {idevento : $scope.evento.idevento, 
                                      tag : $scope.evento.auxtag5});
            }
            if($scope.evento.auxtagbutton6 == true){
              existe = 0;
              var link = 'https://ec2.diwoapp.com.br/criartag.php';
              $http.post(link, {idevento : $scope.evento.idevento, 
                                      tag : $scope.evento.auxtag6});
            }
            if($scope.evento.auxtagbutton7 == true){
              existe = 0;
              var link = 'https://ec2.diwoapp.com.br/criartag.php';
              $http.post(link, {idevento : $scope.evento.idevento, 
                                      tag : $scope.evento.auxtag7});
            }
            if($scope.evento.auxtagbutton8 == true){
              existe = 0;
              var link = 'https://ec2.diwoapp.com.br/criartag.php';
              $http.post(link, {idevento : $scope.evento.idevento, 
                                      tag : $scope.evento.auxtag8});
            }
            if($scope.evento.auxtagbutton9 == true){
              existe = 0;
              var link = 'https://ec2.diwoapp.com.br/criartag.php';
              $http.post(link, {idevento : $scope.evento.idevento, 
                                      tag : $scope.evento.auxtag9});
            }
          });

          
            if(mudoufoto == true){
              console.log($scope.imgURI)
              if($scope.imgURI != "img/ev.png"){ 
                $scope.auxfoto = $scope.evento.nomeevento + $scope.evento.diainicio;
                var mystring = String($scope.auxfoto);
                mystring = mystring.replace(/[^a-zA-Z0-9]/g, '');
                $scope.evento.eventopic = 'https://s3.amazonaws.com/diwoappprofilepics/eventopicsdiwo/' + mystring + '.jpg';
              }else{
                 $scope.evento.eventopic = "img/ev.png";
              }
              var url = "https://ec2.diwoapp.com.br/uploadfotoevento.php";
                                      // File for Upload
              var targetPath = $scope.imgURI;
             
              // File name only
              //var name = $scope.imgURI.substr(imageData.lastIndexOf('/') + 1);
              var filename = mystring + '.jpg';
              // NO CASO SERIA O NOME DO USUARIO.jpg O fileName
              var options = {
                fileKey: "file",
                fileName: filename,
                chunkedMode: false,
                mimeType: "multipart/form-data"
              };
              $cordovaFileTransfer.upload(url, targetPath, options).then(function(result) {
                $scope.evento.datamodificacao = new Date();
               EventoService.atualizarevento($scope.evento).then(function(msg){
                $ionicLoading.hide();
        var alertPopup = $ionicPopup.alert({
                title: 'ʕ•ᴥ•ʔ',
                template: msg
              });
        alertPopup.then(function(){

          EventoService.GetParticipantes($scope.evento.idevento).then(function(items) {
            $scope.msgnoti = 'O evento: '+$scope.evento.nomeevento +' foi mudado'
            for (var i = 0; i < items.length; i++) {
              if ($scope.user.iduser != items[i].iduser) {
                noti.recebeusername = items[i].username;
                noti.recebe = items[i].iduser;
                noti.envia = $scope.user.iduser;
                noti.tipo = 4;
                noti.nomeevento = $scope.evento.nomeevento;
                EventoService.VerificaNotificacao(noti).then(function(res) {
                  console.log(res);
                  if(res){
                    $http.post('https://ec2.diwoapp.com.br/notificapessoa.php', {notificacao : $scope.msgnoti, 
                          idevento : $scope.evento.idevento,
                          nomeevento : $scope.evento.nomeevento,
                          id_user_envia : $scope.user.iduser,
                          username_envia : $scope.user.username,
                          apelido_envia : $scope.user.apelido,
                          tipo : '4',    //update no evento
                          id_user_recebe : noti.recebe}).then(function (res){
                         $scope.response = res.data;
                         console.log($scope.response.msg)
                    });
                    EventoService.getusuario2(noti.recebeusername).then(function(user) {
                      if(user.notiparticipando== '1'){
                      $scope.pushnoti.titulo =  'Mudanças!' ;
                      $scope.pushnoti.msg = $scope.msgnoti;
                      $scope.pushnoti.token = user.devicetoken;
                      EventoService.MandaPushNoti($scope.pushnoti);
                    }
                    });
                  }
                });
              }
            }
          })
          formEventoAbertosTab.updateForm($scope.evento);
          $state.go('tabsController.evento_do_eventoAbertos');
        })
        }, function(errMsg) {
          var alertPopup = $ionicPopup.alert({
            title: 'Register failed!',
            template: errMsg
          });
        })
              }, function(err) {
                $ionicPopup.alert({
                  title: 'Sorry!',
                  template: 'Aconteceu um probleminha, tente de novo'
                });
                $ionicLoading.hide();
              }, function (progress) {
                $ionicLoading.show({
                  title: '┗(＾0＾)┓',
                  template: '┗(＾0＾)┓'
                });
              });
            }else{
              $scope.evento.datamodificacao = new Date();
              EventoService.atualizarevento($scope.evento).then(function(msg){
                $ionicLoading.hide();
        var alertPopup = $ionicPopup.alert({
                title: 'ʕ•ᴥ•ʔ',
                template: msg
              });
        alertPopup.then(function(){

          EventoService.GetParticipantes($scope.evento.idevento).then(function(items) {
            $scope.msgnoti = 'O evento: '+$scope.evento.nomeevento +' foi mudado'
            for (var i = 0; i < items.length; i++) {
              if ($scope.user.iduser != items[i].iduser) {
                noti.recebeusername = items[i].username;
                noti.recebe = items[i].iduser;
                noti.envia = $scope.user.iduser;
                noti.tipo = 4;
                noti.nomeevento = $scope.evento.nomeevento;
                EventoService.VerificaNotificacao(noti).then(function(res) {
                  console.log(res);
                  if(res){
                    $http.post('https://ec2.diwoapp.com.br/notificapessoa.php', {notificacao : $scope.msgnoti, 
                          idevento : $scope.evento.idevento,
                          nomeevento : $scope.evento.nomeevento,
                          id_user_envia : $scope.user.iduser,
                          username_envia : $scope.user.username,
                          apelido_envia : $scope.user.apelido,
                          tipo : '4',    //update no evento
                          id_user_recebe : noti.recebe}).then(function (res){
                         $scope.response = res.data;
                         console.log($scope.response.msg)
                    });
                    EventoService.getusuario2(noti.recebeusername).then(function(user) {
                      if(user.notiparticipando== '1'){
                      $scope.pushnoti.titulo =  'Mudanças!' ;
                      $scope.pushnoti.msg = $scope.msgnoti;
                      $scope.pushnoti.token = user.devicetoken;
                      EventoService.MandaPushNoti($scope.pushnoti);
                    }
                    });
                  }
                });
              }
            }
          })
          formEventoAbertosTab.updateForm($scope.evento);
          $state.go('tabsController.evento_do_eventoAbertos');
        })
        }, function(errMsg) {
          var alertPopup = $ionicPopup.alert({
            title: 'Register failed!',
            template: errMsg
          });
        })
            }

       
                
      }
     }
      
    }
  

}])

   
.controller('filtroCtrl', ['$scope', '$stateParams', 'formUser', 'EventoService', '$timeout', '$http','$filter','formItem', '$state','formOutro', '$cordovaGeolocation', 'formvimdofiltro','formvimdofiltroperfil',  // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, formUser, EventoService, $timeout, $http,$filter, formItem, $state,formOutro, $cordovaGeolocation, formvimdofiltro, formvimdofiltroperfil) {
  $scope.user = formUser.getForm();
  $scope.pegaevento ={};
  $scope.auxevento = {};
  $scope.tuto = {};
  $scope.viewtitle = "Procura / Filtra";
  $scope.filtro ={ genero:"todos", precof: "ambos",  raio: 1220, preco : -1, raiokm: "50", tipo : "tag", dificuldade : "Qual a dificuldade do evento?", dificuldaden : 1};
    
    var header = document.getElementById("barfiltro");
    var btns = header.getElementsByClassName("btnfiltro");
    for (var i = 0; i < btns.length; i++) {
      btns[i].addEventListener("click", function() {
        var current = document.getElementsByClassName("actfil");
        current[0].className = current[0].className.replace(" actfil", "");
        this.className += " actfil";
      });
    }

    var header2 = document.getElementById("rqrq");
    var btns2 = header2.getElementsByClassName("btnsearch");
    console.log(btns2.length)
    for (var f = 0; f < btns2.length; f++) {
      btns2[f].addEventListener("click", function() {
        var current2 = document.getElementsByClassName("actitro");
        current2[0].className = current2[0].className.replace(" actitro", "");
        this.className += " actitro";
      });
    }

    $scope.CoisasDoSearch = false;
    $scope.CoisasDoFiltro = false;
    $scope.BotaoDoFiltro = false;
    $scope.TipoDoFiltro = true;
    $scope.CoisasDoFiltroRaio = false;
    $scope.CoisasDoSearchPessoa = false;
    $scope.CoisasDoSearchLugar = false;
    $scope.Raiobusca = false;
    $scope.CoisasPreco = false;
    $scope.listlength = 20;
    $scope.filtra ={};
    $scope.eventos = {};

  var aux = 0;
  var aux2 = 0;
  var aux3 = 0;

  var lat  = $scope.user.lat;
  var long  =  $scope.user.long;

  $scope.filtro.northlat = $scope.user.northlat;
  $scope.filtro.westlng = $scope.user.westlng;
  $scope.filtro.southlat = $scope.user.southlat;
  $scope.filtro.eastlng = $scope.user.eastlng;

  $scope.$on("$ionicView.enter", function(event, data){
    $scope.viewtitle = "Procura / Filtra";
    var das = document.getElementById("hash");
    var current = document.getElementsByClassName("actitro");
    current[0].className = current[0].className.replace(" actitro", "");
    das.className += " actitro";

    $scope.filtro ={ genero:"todos", precof: "ambos",precovalor: 0, precovalorescrito:"Grátis",   raio: 1220, preco : -1, raiokm: "50", tipo : "tag", dificuldade : "Qual a dificuldade do evento?", dificuldaden : 1};
    
    $scope.user = formUser.getForm();
    $scope.filtro.northlat = $scope.user.northlat;
    $scope.filtro.westlng = $scope.user.westlng;
    $scope.filtro.southlat = $scope.user.southlat;
    $scope.filtro.eastlng = $scope.user.eastlng;
    

  });

  $scope.buscaaa = function(){
    $scope.viewtitle = "Procura";
    $scope.precoevento = false;
    $scope.CoisasDoSearch = false;
    $scope.CoisasDoFiltro = false;
    $scope.BotaoDoFiltro = false;
    $scope.TipoDoFiltro = true;
    $scope.CoisasDoFiltroRaio = false;
    $scope.CoisasDoSearchPessoa = false;
    $scope.CoisasDoSearchLugar = false;
    $scope.CoisasPreco = false;
    $scope.eventos = {};
    $scope.filtro ={ genero:"todos", precof: "ambos",precovalor: 0, precovalorescrito:"Grátis",  raio: 1220, preco : -1, raiokm: "50", tipo : "tag", dificuldade : "Qual a dificuldade do evento?", dificuldaden : 1};
  }
  $scope.filtraaa = function(){
    $scope.viewtitle = "Filtra";
    $scope.Raiobusca = false;
    $scope.CoisasDoSearch = false;
    $scope.CoisasDoFiltro = true;
    $scope.BotaoDoFiltro = true;
    $scope.CoisasPreco = true;
    $scope.TipoDoFiltro = false;
    $scope.CoisasDoFiltroRaio = true;
    $scope.CoisasDoSearchPessoa = false;
    $scope.CoisasDoSearchLugar = false;
    $scope.CoisasFiltradas = false;
    $scope.precoevento = false;

    $scope.filtro ={ genero:"todos", precof: "ambos",precovalor: 0, precovalorescrito:"Grátis",   raio: 50, preco : -1, raiokm: "50", tipo : "tag", dificuldade : "Qual a dificuldade do evento?", dificuldaden : 1};
    $scope.filtro.northlat = $scope.user.northlat;
    $scope.filtro.westlng = $scope.user.westlng;
    $scope.filtro.southlat = $scope.user.southlat;
    $scope.filtro.eastlng = $scope.user.eastlng;
    EventoService.filtro($scope.user).then(function(filt){
      $scope.tuto = filt;
      $scope.eventos = filt;
    });
  }

  // if($scope.evento.tipodeevento){
  //     console.log("patrocinadoffff")
  //     $scope.evento.patrocinado = true;
  //     //$scope.evento.styleItem = "background-color: #212121;color: white;box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.3);border: 4px dotted #ffdb29;";
  //     //$scope.evento.styleItem = "background-color: #212121;color: white;box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.3);border: 4px dotted #ff9008;";
  //     $scope.evento.styleItem = "background-color: #212121;color: white;box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.3);outline: 7px dotted #ff4c42;outline-offset: -4px;";
  //     //$scope.evento.styleItem = "background-color: #212121;color: white;box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.3);border: 4px dotted #f9bdff;";
  //     //$scope.evento.styleItem = "background-color: #212121;color: white;box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.3);border: 4px dotted #00FFFF;";

  //     document.getElementById("page10").style.backgroundImage = "url('img/background_patrocinado.jpg')"
  //   }else{
  //     $scope.evento.styleItem = "background-color: #212121;color: white;box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.3);"
  //     $scope.evento.patrocinado = false;
  //     document.getElementById("page10").style.backgroundColor = "#212121"
  //   }
  $scope.ch = function(){
    if($scope.filtro.dificuldaden == 1){
      $scope.filtro.dificuldade = "Não importa";
      if(aux2>0){
        $scope.tuto.tamanho = aux2;
        $scope.tuto.filtro = $scope.filtro;
        $scope.tuto.filtro.lat = $scope.user.lat;
        $scope.tuto.filtro.long = $scope.user.long;
        EventoService.Filtradinamicamente21($scope.tuto).then(function(destilado){
          $scope.eventos = destilado;
        });
      }
    }
    if($scope.filtro.dificuldaden == 2){
      $scope.eventos = {};
      $scope.filtro.dificuldade = "Fácil";
      if(aux2>0){
        $scope.tuto.tamanho = aux2;
        $scope.tuto.filtro = $scope.filtro;
        $scope.tuto.filtro.lat = $scope.user.lat;
        $scope.tuto.filtro.long = $scope.user.long;
        EventoService.Filtradinamicamente21($scope.tuto).then(function(destilado){
          $scope.eventos = destilado;
        });
      }
    }
    if($scope.filtro.dificuldaden == 3){
      $scope.eventos = {};
      $scope.filtro.dificuldade = "Moderado";
      if(aux2>0){
        $scope.tuto.tamanho = aux2;
        $scope.tuto.filtro = $scope.filtro;
        $scope.tuto.filtro.lat = $scope.user.lat;
        $scope.tuto.filtro.long = $scope.user.long;
        EventoService.Filtradinamicamente21($scope.tuto).then(function(destilado){
          $scope.eventos = destilado;
        });
      }
    }
    if($scope.filtro.dificuldaden == 4){
      $scope.eventos = {};
      $scope.filtro.dificuldade = "Difícil";
      if(aux2>0){
        $scope.tuto.tamanho = aux2;
        $scope.tuto.filtro = $scope.filtro;
        $scope.tuto.filtro.lat = $scope.user.lat;
        $scope.tuto.filtro.long = $scope.user.long;
        EventoService.Filtradinamicamente21($scope.tuto).then(function(destilado){
          $scope.eventos = destilado;
        });
      }
    }
  }

  $scope.pushNotification = { checked: false};
  
  $scope.sexo = function(){
    if(!$scope.user.genero){
      $state.go('idadegenero');
    }else{
      if($scope.pushNotification.checked){
        $scope.filtro.genero = $scope.user.genero;
        if(aux2>0){
          $scope.tuto.tamanho = aux2;
          $scope.tuto.filtro = $scope.filtro;
          $scope.tuto.filtro.lat = $scope.user.lat;
          $scope.tuto.filtro.long = $scope.user.long;
          $scope.eventos = {};
          EventoService.Filtradinamicamente21($scope.tuto).then(function(destilado){
            $scope.eventos = destilado;
            //console.log("danodmsa", $scope.eventos.length)
          });
        }
      }else{
        $scope.filtro.genero = "todos";
          if(aux2>0){
          $scope.tuto.tamanho = aux2;
          console.log($scope.tuto.tamanho, "tamanho")
          $scope.tuto.filtro = $scope.filtro;
          $scope.tuto.filtro.lat = $scope.user.lat;
          $scope.tuto.filtro.long = $scope.user.long;
          $scope.eventos = {};
          EventoService.Filtradinamicamente21($scope.tuto).then(function(destilado){
            $scope.eventos = destilado;
            //console.log("danodmsa", $scope.eventos.length)
          });
        }
      }
    }

  }

  $scope.buscafiltropreco = { checked: false };
  $scope.precoevento = false;

  $scope.precodabusca = function(){
    if(!$scope.BotaoDoFiltro){
      if($scope.buscafiltropreco.checked){
        $scope.precoevento = true;
        $scope.filtro.precof = "gratis";
        $scope.filtro.precovalor = 0;
        $scope.filtro.precovalorescrito = "Grátis";
        $scope.tuto.tamanho = aux2;
        $scope.tuto.filtro = $scope.filtro;
        $scope.tuto.filtro.lat = $scope.user.lat;
        $scope.tuto.filtro.long = $scope.user.long;
        console.log($scope.tuto)
        EventoService.Filtradinamicamente21($scope.tuto).then(function(destilado){
          $scope.CoisasFiltradas = true;
          $scope.eventos = destilado;
          
        });
      }else{
        $scope.precoevento = false;
        $scope.filtro.precof = "ambos";
        $scope.filtro.precovalor = 0;
        $scope.filtro.precovalorescrito = "Grátis";
        $scope.tuto.tamanho = aux2;
        $scope.tuto.filtro = $scope.filtro;
        $scope.tuto.filtro.lat = $scope.user.lat;
        $scope.tuto.filtro.long = $scope.user.long;
        EventoService.Filtradinamicamente21($scope.tuto).then(function(destilado){
          $scope.eventos = destilado;
          $scope.CoisasFiltradas = true;
        });
      }
    }else{
      if($scope.buscafiltropreco.checked){
        $scope.precoevento = true;
        $scope.filtro.precof = "gratis";
        $scope.filtro.preco = 0;
        $scope.filtro.precovalor = 0;
        $scope.filtro.precovalorescrito = "Grátis";
        $scope.tuto.tamanho = aux2;
        $scope.tuto.filtro = $scope.filtro;
        $scope.tuto.filtro.lat = $scope.user.lat;
        $scope.tuto.filtro.long = $scope.user.long;
      }else{
        $scope.precoevento = false;
        $scope.filtro.precof = "ambos";
        $scope.filtro.preco = -1;
        $scope.filtro.precovalor = 0;
      }
      
    }
  }

  $scope.mudapreco = function(valor){
    if(!$scope.BotaoDoFiltro){
      if(valor == 0){
        $scope.filtro.precof = "gratis";
        $scope.filtro.precovalor = 0;
        $scope.filtro.precovalorescrito = "Grátis";
        $scope.tuto.tamanho = aux2;
        $scope.tuto.filtro = $scope.filtro;
        $scope.tuto.filtro.lat = $scope.user.lat;
        $scope.tuto.filtro.long = $scope.user.long;
        EventoService.Filtradinamicamente21($scope.tuto).then(function(destilado){
          $scope.eventos = destilado;

        });
      }else{
        $scope.filtro.precof = "pago";
        $scope.filtro.precovalor = valor;
        $scope.filtro.precovalorescrito = valor + " dinheiros";
        $scope.tuto.tamanho = aux2;
        $scope.tuto.filtro = $scope.filtro;
        $scope.tuto.filtro.lat = $scope.user.lat;
        $scope.tuto.filtro.long = $scope.user.long;
        EventoService.Filtradinamicamente21($scope.tuto).then(function(destilado){
          $scope.eventos = destilado;
        });
      }
    }else{
      if(valor == 0){
        $scope.filtro. precof = "gratis";
        $scope.filtro.precovalor = 0;
        $scope.filtro.precovalorescrito = "Grátis";
      }else{
        $scope.filtro. precof = "pago";
        $scope.filtro.precovalor = valor;
        $scope.filtro.precovalorescrito = valor + " dinheiros";
      }
    }
  }

  $scope.buscafiltro = { checked: false };
  $scope.raiodabusca = function(){
    console.log("raiodabusca", $scope.user.lat, $scope.user.long)
    if($scope.buscafiltro.checked){
      $scope.CoisasDoFiltroRaio = true;
      $scope.filtro.raio = 120;
      $scope.filtro.raiokm = '120';
      $scope.tuto.tamanho = aux2;
      $scope.tuto.filtro = $scope.filtro;
      console.log($scope.user.lat, $scope.user.long)
      $scope.tuto.filtro.lat = $scope.user.lat;
      $scope.tuto.filtro.long = $scope.user.long;
      EventoService.Filtradinamicamente21($scope.tuto).then(function(destilado){
        $scope.eventos = destilado;
      });
    }else{
      $scope.CoisasDoFiltroRaio = false;
      $scope.tuto.tamanho = aux2;
      $scope.tuto.filtro = $scope.filtro;
      $scope.tuto.filtro.lat = $scope.user.lat;
      $scope.tuto.filtro.long = $scope.user.long;
      $scope.filtro.raio = 1220;
      $scope.eventos = {};
      EventoService.Filtradinamicamente21($scope.tuto).then(function(destilado){
        $scope.eventos = destilado;
      });
    }
  }
  
  EventoService.Getalltags().then(function (oi){
    $scope.items = oi;
  });

  $scope.mudafiltro1 = function() {
    $scope.filtro.tipo = "tag";
    $scope.eventos = {};
    $scope.auxevento = {};
    //console.log($scope.filtro.search);
    EventoService.Getalltags().then(function (oi){
      $scope.listlength = oi.length
      $scope.items = oi;
    });
    $scope.CoisasDoSearch = true;
    $scope.CoisasDoSearchPessoa = false;
    $scope.CoisasDoSearchLugar = false;
    $scope.CoisasDoFiltroRaio = false;
    $scope.CoisasDoFiltro = false;
    $scope.BotaoDoFiltro = false;
    $scope.Raiobusca = false;
    $scope.CoisasPreco = false;
    $scope.precoevento = false;
  }

  $scope.mudafiltro2 = function() {
    $scope.filtro.tipo = "pessoa";
    $scope.eventos = {};
    $scope.auxevento = {};
    //console.log($scope.filtro.search);
    EventoService.Getusers().then(function (ola){
      $scope.listlength = ola.length
      $scope.pessoas = ola;
    });
    $scope.CoisasDoSearchPessoa = true;
    $scope.CoisasDoSearch = false;
    $scope.CoisasDoSearchLugar = false;
    $scope.CoisasDoFiltroRaio = false;
    $scope.CoisasDoFiltro = false;
    $scope.BotaoDoFiltro = false;
    $scope.Raiobusca = false;
    $scope.CoisasPreco = false;
    $scope.precoevento = false;
  }

  $scope.mudafiltro3 = function() {
    $scope.filtro.tipo = "lugar";
    $scope.eventos = {};
    $scope.auxevento = {};
    //console.log($scope.filtro.search);
    EventoService.Getcidades().then(function (salut){
      $scope.listlength = salut.length
      $scope.places = salut;
    });
    $scope.CoisasDoSearchPessoa = false;
    $scope.CoisasDoSearch = false;
    $scope.CoisasDoSearchLugar = true;
    $scope.CoisasDoFiltroRaio = false;
    $scope.CoisasDoFiltro = false;
    $scope.BotaoDoFiltro = false;
    $scope.Raiobusca = false;
    $scope.CoisasPreco = false;
    $scope.precoevento = false;
  }

  $scope.abrir = function(item){
    $scope.CoisasFiltradas = true;
    $scope.CoisasDoFiltro = true;
    $scope.BotaoDoFiltro = false;
    $scope.CoisasDoSearch = false;
    $scope.CoisasDoSearchPessoa = false;
    $scope.CoisasDoSearchLugar = false;
    $scope.CoisasDoFiltroRaio = false;
    
    
    if ($scope.filtro.tipo == "tag") {
      $scope.Raiobusca = true;
      $scope.CoisasPreco = true;
      $scope.auxevento = {};
      item.iduser = $scope.user.iduser;
      EventoService.Getfiltradotag(item).then(function (filtrado){
        $scope.eventos = {};
        aux2 = 0;
        $scope.pegaevento.iduser = $scope.user.iduser;
        for (var i = 0; i < filtrado.length ; i++) {
          $scope.pegaevento.idevento = filtrado[i].idevento;
          //console.log($scope.pegaevento.idevento , $scope.pegaevento.iduser)
            EventoService.Getfiltradotag2($scope.pegaevento).then(function (bye){
              if (bye !='e') { 
                $scope.eventos[aux2] = bye;
              if($scope.eventos[aux2].tipodeevento){
                console.log("patrocinadoffff")
                $scope.eventos[aux2].patrocinado = true;
                //$scope.evento.styleItem = "background-color: #212121;color: white;box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.3);border: 4px dotted #ffdb29;";
                //$scope.evento.styleItem = "background-color: #212121;color: white;box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.3);border: 4px dotted #ff9008;";
                $scope.eventos[aux2].styleItem = "background-color: #212121;color: white;box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.3);outline: 3px dotted #ff4c42;outline-offset: -2px;border-radius:14px 14px 14px 14px;";
                //$scope.evento.styleItem = "background-color: #212121;color: white;box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.3);border: 4px dotted #f9bdff;";
                //$scope.evento.styleItem = "background-color: #212121;color: white;box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.3);border: 4px dotted #00FFFF;";

              }else{
                $scope.eventos[aux2].styleItem = "background-color: #212121;color: white;box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.3);border-radius:14px 14px 14px 14px;"
                $scope.eventos[aux2].patrocinado = false;
              }
                // $scope.eventos[aux2]. = bye;
                $scope.tuto[aux2] = $scope.eventos[aux2];
                aux2++;
              }
            });
        }
      });
    }
    if ($scope.filtro.tipo == "pessoa"){
      $scope.Raiobusca = false;
      $scope.CoisasPreco = false;
      $scope.CoisasDoFiltroRaio = false;
      $scope.CoisasDoFiltro = false;
      $scope.BotaoDoFiltro = false;
      $scope.precoevento = false;
      formOutro.updateForm(item);
      formvimdofiltroperfil.updateForm(true);
      $state.go('tabsController.perfilOutro');
    }
    if ($scope.filtro.tipo == "lugar") {
      $scope.CoisasDoFiltroRaio = false;
      $scope.Raiobusca = false;
      $scope.CoisasPreco = true;
      //console.log(item.cidade);
      EventoService.Getfiltradocidade(item.cidade).then(function (filtrado){
        aux = filtrado.nrow;
        $scope.listlength = filtrado.nrow;
        $scope.eventos = {};
        aux2 = 0;
        $scope.pegaevento.iduser = $scope.user.iduser;
          for (var i = 0; i < filtrado.nrow ; i++) {
            $scope.pegaevento.idevento = filtrado[i].idevento;
            EventoService.Geteventoporid($scope.pegaevento).then(function (bye){
              if (bye !='e') { 
                $scope.eventos[aux2] = bye;
              if($scope.eventos[aux2].tipodeevento ){
                console.log("patrocinadoffff")
                $scope.eventos[aux2].patrocinado = true;
                //$scope.evento.styleItem = "background-color: #212121;color: white;box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.3);border: 4px dotted #ffdb29;";
                //$scope.evento.styleItem = "background-color: #212121;color: white;box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.3);border: 4px dotted #ff9008;";
                $scope.eventos[aux2].styleItem = "background-color: #212121;color: white;box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.3);outline: 3px dotted #ff4c42;outline-offset: -2px;border-radius:14px 14px 14px 14px;";
                //$scope.evento.styleItem = "background-color: #212121;color: white;box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.3);border: 4px dotted #f9bdff;";
                //$scope.evento.styleItem = "background-color: #212121;color: white;box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.3);border: 4px dotted #00FFFF;";

              }else{
                $scope.eventos[aux2].styleItem = "background-color: #212121;color: white;box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.3);border-radius:14px 14px 14px 14px;"
                $scope.eventos[aux2].patrocinado = false;
              }
                $scope.tuto[aux2] = $scope.eventos[aux2];
                aux2++;
              }
            });
          }
      });
    }
  }

  $scope.onde = function(){
    if($scope.TipoDoFiltro){
      $scope.filtro.raiokm = $scope.filtro.raio;
      $scope.tuto.filtro.lat = $scope.user.lat;
      $scope.tuto.filtro.long = $scope.user.long;
      if(aux2>0){
        $scope.tuto.tamanho = aux2;
        $scope.tuto.filtro = $scope.filtro;
        $scope.BotaoDoFiltro = false;
        $scope.eventos = {};
        EventoService.Filtradinamicamente21($scope.tuto).then(function(destilado){
          $scope.eventos = destilado;
        });
      }
    }else{
      $scope.filtro.raiokm = $scope.filtro.raio;

      var raio = $scope.filtro.raio*1000*0.71;
      var myLatlng = new google.maps.LatLng($scope.user.lat, $scope.user.long);
      var spherical = google.maps.geometry.spherical; 
      var north = spherical.computeOffset(myLatlng, raio, 0); 
      var west  = spherical.computeOffset(myLatlng, raio, -90); 
      var south = spherical.computeOffset(myLatlng, raio, 180); 
      var east  = spherical.computeOffset(myLatlng, raio, 90); 
      $scope.filtro.northlat = north.lat();
      $scope.filtro.westlng = west.lng();
      $scope.filtro.southlat = south.lat();
      $scope.filtro.eastlng = east.lng();
    }
  }

  $scope.procurar =  function(){
    if ($scope.filtro.tipo == "tag") {
      $scope.CoisasDoSearch = true;
      $scope.CoisasDoSearchPessoa = false;
      $scope.CoisasDoSearchLugar = false;
   
    }
    if ($scope.filtro.tipo == "pessoa") {
      $scope.CoisasDoSearchPessoa = true;
      $scope.CoisasDoSearch = false;
      $scope.CoisasDoSearchLugar = false;
      
    }
    if ($scope.filtro.tipo == "lugar") {
      $scope.CoisasDoSearchPessoa = false;
      $scope.CoisasDoSearch = false;
      $scope.CoisasDoSearchLugar = true;
    }
    //console.log($scope.tipo);
    $scope.listlength = 20;
    $scope.CoisasDoFiltro = false;
    $scope.BotaoDoFiltro = false;
    $scope.CoisasFiltradas = false;
    $scope.CoisasDoFiltroRaio = false;
    $scope.CoisasPreco = false;
    $scope.precoevento = false;
  }

  $scope.cancelar =  function(){
    $scope.CoisasFiltradas = false;
    $scope.filtro ={ genero:"todos", precof: "ambos", raio: 1220, raiokm: "50", tipo : "tag", dificuldade : "Qual a dificuldade do evento?"};
    $scope.CoisasDoSearch = false;
    $scope.CoisasDoSearchPessoa = false;
    $scope.CoisasDoSearchLugar = false;
    $scope.TipoDoFiltro = true;
    $scope.precoevento = false;
    $scope.CoisasDoFiltro = false;
    $scope.BotaoDoFiltro = false;
    $scope.CoisasDoFiltroRaio = false;
    $scope.Raiobusca = false;
    $scope.CoisasPreco = false;
    $scope.pushNotification.checked=false;
    $scope.buscafiltropreco.checked=false;
    $scope.buscafiltro.checked=false;
  }

  $scope.limpar =  function(){
    $scope.CoisasDoSearch = false;
    $scope.CoisasDoFiltro = true;
    $scope.BotaoDoFiltro = true;
    $scope.TipoDoFiltro = false;
    $scope.CoisasDoFiltroRaio = true;
    $scope.CoisasDoSearchPessoa = false;
    $scope.CoisasDoSearchLugar = false;
    $scope.CoisasFiltradas = false;
    $scope.Raiobusca = false;
    $scope.CoisasPreco = true;
    $scope.pushNotification.checked=false;
    $scope.buscafiltropreco.checked=false;
    $scope.filtro ={ genero:"todos", precof: "ambos",preco : -1,  raio: 50, raiokm: "50", tipo : "tag", dificuldade : "Qual a dificuldade do evento?", dificuldaden : 1};
    $scope.filtro.northlat = $scope.user.northlat;
    $scope.filtro.westlng = $scope.user.westlng;
    $scope.filtro.southlat = $scope.user.southlat;
    $scope.filtro.eastlng = $scope.user.eastlng;
  }

  $scope.filtra =  function(){
    if ($scope.filtro.dificuldade == "Qual a dificuldade do evento?") {$scope.filtro.dificuldade = "Não importa";}

      $scope.eventos = {};
      EventoService.Geteventofiltrado($scope.filtro).then(function (destilado){
        $scope.eventos = destilado;
        console.log(destilado);
      });
   
    $scope.CoisasFiltradas = true;
    $scope.CoisasDoFiltro = false;
    $scope.BotaoDoFiltro = false;
    $scope.CoisasDoFiltroRaio = false;
    $scope.CoisasDoSearch = false;
    $scope.CoisasDoSearchPessoa = false;
    $scope.CoisasDoSearchLugar = false;
    $scope.TipoDoFiltro = false;
    $scope.CoisasPreco = false;
    $scope.precoevento = false;
  }

  $scope.enterItem = function(eventos){
    console.log(eventos, $scope.eventos[eventos].idevento, "Aqui entrando",$scope.eventos[eventos].styleItem );
    formItem.updateForm($scope.eventos[eventos]);
    
    if($scope.eventos[eventos].estado == 0 || $scope.eventos[eventos].estado == 2){
      $state.go('tabsController.eventoAberto');
      formvimdofiltro.updateForm(true);
    }else{
      $state.go('tabsController.eventofiltroEncerrado');
    }
    
  }

}])
   
.controller('chatCtrl', ['$scope', '$stateParams', '$timeout', '$ionicScrollDelegate', 'formUser', '$http', 'formItem', '$interval', 'EventoService', 'formEventoAbertosTab', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, $timeout, $ionicScrollDelegate, formUser, $http, formItem, $interval, EventoService, formEventoAbertosTab) {
  $scope.user = formUser.getForm();
  $scope.evento = formEventoAbertosTab.getForm();
  $scope.data = {};
  $scope.messages = [];
  // $scope.hideTime = true;
  //console.log( $scope.user.username);
  var isIOS = ionic.Platform.isWebView() && ionic.Platform.isIOS();


  $scope.$on("$ionicView.enter", function(event, data){
    $scope.evento = formEventoAbertosTab.getForm();
    $scope.user = formUser.getForm();
    $scope.data = {};
    $scope.messages = {};
    $scope.messages = [];
    //alert($scope.evento.idevento)
     EventoService.Getmsg($scope.evento.idevento).then(function(result) {
        $scope.messages = result;
      });
  });

   $interval( function() {
          //   $http.post('https://ec2.diwoapp.com.br/getmsg.php' , {idevento : $scope.evento.idevento}).then(function(result) {
          // // console.log(result.data[0].idevento);
          // //   console.log("estou aqui");
          // if (result.data.success != false) {
          //     $scope.messages = result.data;
          // }
          // });
      EventoService.Getmsg($scope.evento.idevento).then(function(result) {
        $scope.messages = result;
      });

    }, 5000);

  // $http.post('https://ec2.diwoapp.com.br/getmsg.php' , {idevento : $scope.evento.idevento}).then(function(result) {
  //         if (result.data.success != false ) {
  //             $scope.messages = result.data;
  //         }
          
  //         });

   EventoService.Getmsg($scope.evento.idevento).then(function(result) {
        $scope.messages = result;
      });


  $scope.auxev = {};
  $scope.auxev.iduser = $scope.user.iduser;
  $scope.auxev.idevento = $scope.evento.idevento;
  EventoService.GetNotiOn($scope.auxev).then(function(notion) {
    $scope.notion = notion;
  });
  $scope.ativanoti = function(){
    $http.post('https://ec2.diwoapp.com.br/mudanotievento.php', {idevento : $scope.auxev.idevento, iduser : $scope.auxev.iduser, chatnotion : 0});
    $scope.notion = true;
  }
  $scope.desativanoti = function(){
    $http.post('https://ec2.diwoapp.com.br/mudanotievento.php', {idevento : $scope.auxev.idevento, iduser : $scope.auxev.iduser, chatnotion : 1});
    $scope.notion = false;
  }

  $scope.sendMessage = function() {
    var d = new Date();
    console.log(d);
    d = d.toLocaleTimeString().replace(/:\d+ /, ' ');
    var data = new Date();
    var dataFormatada = ("0" + data.getDate()).substr(-2) + "/" 
        + ("0" + (data.getMonth() + 1)).substr(-2) + "/" + data.getFullYear();

     // var dataFormatada2 =  (data.getFullYear() + "-" + ("0" + (data.getMonth() + 1)).substr(-2) + "-" + ("0" + data.getDate()).substr(-2) );


        dataFormatada = (d + ' '+dataFormatada);
        console.log(dataFormatada);

    if(!$scope.data.message){
      console.log(  "mensagem "+$scope.data.message);
     }else{
      console.log($scope.data.message,  $scope.messages,  $scope.messages[0]);
    
      if($scope.messages[0]){
        $scope.messages.push({
          username: $scope.user.username,
          mensagem: $scope.data.message,
          tempo: dataFormatada,
          idevento : $scope.evento.idevento, 
          iduser : $scope.user.iduser, 
          apelido : $scope.user.apelido
        });
      }else{
        $scope.messages[0] = {
          username: $scope.user.username,
          mensagem: $scope.data.message,
          tempo: dataFormatada,
          idevento : $scope.evento.idevento, 
          iduser : $scope.user.iduser, 
          apelido : $scope.user.apelido
        };
      }
      if($scope.data.message != '' || $scope.data.message){
         var link = 'https://ec2.diwoapp.com.br/criarmsg.php';
                      $http.post(link, {idevento : $scope.evento.idevento, 
                                        mensagem :  $scope.data.message,
                                        iduser : $scope.user.iduser, 
                                        username : $scope.user.username,
                                        apelido : $scope.user.apelido,
                                        tempo : dataFormatada}).then(function (res){
                    $scope.response = res.data;
                    console.log($scope.response.msg);
                  });
          EventoService.GetParticipantesNotifica($scope.evento.idevento).then(function(parti) {
            for (var i = 0; i < parti.length; i++) {
              if (parti[i].estado!=7 && parti[i].estado!=8 && parti[i].iduser != $scope.user.iduser) {
                console.log(parti[i].username,"parti[i].username")
                EventoService.getusuario2(parti[i].username).then(function(user) {
                  if(user.notichat== '1'){
                    $scope.pushnoti = {};
                    console.log(user.username,"getusuario2")
                    $scope.pushnoti.titulo = "Nova mensagem";
                    var hj = $scope.evento.diainicio;      
                    var mes = (hj[5]+hj[6]).valueOf();
                    var dia = (hj[8]+hj[9]).valueOf();
                    var diadia = dia+'/'+mes;
                    $scope.pushnoti.msg = 'Chat do '+$scope.evento.nomeevento + ' ' + diadia + ' ' + ' tem mensagem nova' ;
                    $scope.pushnoti.token = user.devicetoken;
                    EventoService.MandaPushNoti($scope.pushnoti);
                  }
                });
              }          
            }      
          });
      }
      delete $scope.data.message;
      $ionicScrollDelegate.scrollBottom(true);
     }
  };


  $scope.inputUp = function() {
    if (isIOS) $scope.data.keyboardHeight = 216;
    $timeout(function() {
      $ionicScrollDelegate.scrollBottom(true);
    }, 300);

  };

  $scope.inputDown = function() {
    if (isIOS) $scope.data.keyboardHeight = 0;
    $ionicScrollDelegate.resize();
  };

  $scope.closeKeyboard = function() {
    // cordova.plugins.Keyboard.close();
  };

}])

.controller('perfilAceitarGeralCtrl', ['$scope', '$state', '$stateParams', 'formAux', 'formUser', 'EventoService', '$timeout', '$http','$ionicPopup', 'formStalker','$ionicLoading', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $state, $stateParams, formAux, formUser, EventoService, $timeout, $http, $ionicPopup, formStalker, $ionicLoading) {

    $scope.aux = formAux.getAux();      // Infos da notificação
    // console.log($scope.aux.id_user_recebe);
    // console.log($scope.aux.id_user_envia);
    // console.log($scope.aux.idnotificacao);
    $scope.user = formUser.getForm();
    //console.log($scope.aux);
    $scope.auxdata = {};
    $scope.estadobutton = 0;
    $scope.stalkeada = {}; 
    $scope.stalkeada.iduser = $scope.aux.id_user_envia;
    $scope.stalkeada.username = $scope.aux.username_envia;
    $scope.neventos= 0;
    $scope.neventosnao= 0;
    $scope.p =0;
    $scope.ic = 0;
    $scope.infoevento ={};
    $scope.CoisasCriado = true;
    $scope.CoisasFinalizado = false;
    $scope.pushnoti = {};
    var noti={};
    $scope.infosstalkeada ={};
    EventoService.GetStalkear($scope.aux.id_user_envia).then(function(stalker) {
        $scope.infosstalkeada = stalker;
        if(($scope.infosstalkeada.profilepic[8] == 's' && $scope.infosstalkeada.profilepic[9] == '3')||($scope.infosstalkeada.profilepic[8] == 'd' && $scope.infosstalkeada.profilepic[9] == 'i')){
        //if($scope.infosstalkeada.profilepic[8] == 's' && $scope.infosstalkeada.profilepic[9] == '3'){
             document.getElementById("imageidperfilAceitarGeral").src=$scope.infosstalkeada.profilepic+"?{{getTimeStamp()}}";
           }else{
             document.getElementById("imageidperfilAceitarGeral").src=$scope.infosstalkeada.profilepic;
           }
           if(!$scope.infosstalkeada.numcodigo || $scope.infosstalkeada.numcodigo == 'null'){
            $scope.temcodigo = false;
          }else{
            $scope.temcodigo = true;
            if($scope.infosstalkeada.numcodigo == '0'){
              document.getElementById("badgeimg_pag").src="img/egg_0.png";
            }
            if($scope.infosstalkeada.numcodigo == '1'){
              document.getElementById("badgeimg_pag").src="img/egg_1.png";
            }
            if($scope.infosstalkeada.numcodigo == '2'){
              document.getElementById("badgeimg_pag").src="img/egg_2.png";
            }
            if(parseInt($scope.infosstalkeada.numcodigo) >= 3){
              document.getElementById("badgeimg_pag").src="img/egg_3.png";
            }
            if(parseInt($scope.infosstalkeada.numcodigo) < 0){
              document.getElementById("badgeimg_pag").src="img/egg_3.png";
            }
          }
       // document.getElementById("imageidperfilAceitarGeral").src=$scope.infosstalkeada.profilepic+"?{{getTimeStamp()}}";
        $scope.frase = stalker.frase;
         if(stalker.borda == 0){
          $scope.estrelabb = false;
          $scope.estrelabs = false;
          $scope.estrelabg = false;
        }
        if(stalker.borda == 1){
          $scope.estrelabb = true;
          $scope.estrelabs = false;
          $scope.estrelabg = false;
        }
        if(stalker.borda == 2){
          $scope.estrelabb = false;
          $scope.estrelabs = true;
          $scope.estrelabg = false;
        }
        if(stalker.borda == 3){
          $scope.estrelabb = false;
          $scope.estrelabs = false;
          $scope.estrelabg = true;
        }
        if($scope.infosstalkeada.idade){
          $scope.infosstalkeada.idade = ", "+ $scope.infosstalkeada.idade +" anos";
        }else{
           $scope.infosstalkeada.idade ='';
        }
    });
    
    var header = document.getElementById("barperfiloutroev");
    var btns = header.getElementsByClassName("btnperfilotro");
    for (var i = 0; i < btns.length; i++) {
      btns[i].addEventListener("click", function() {
        var current = document.getElementsByClassName("actpag");
        current[0].className = current[0].className.replace(" actpag", "");
        this.className += " actpag";
      });
    }

    EventoService.GetPontos($scope.stalkeada.iduser).then(function(items) {
        $scope.p = items;
        $scope.labels3 = ["Pontos"];
        $scope.colores3 = ["#ff4d4d"];
        $scope.data3 = [$scope.p];
      });
      EventoService.getIC($scope.stalkeada).then(function(items) {
        if(items){
          $scope.ic = items;
          $scope.options2 = {title: {
                      display: true,
                      text: 'Indice de confirmação',
                      position: 'bottom'
                  }
           }
          $scope.labels2 = ["Fui", "Não fui"];
          $scope.colores2 = ["#99FF99","#ff4d4d"];
          var menos = (100-$scope.ic.total).toFixed(1);
          var mais = $scope.ic.total;
          $scope.data2 = [mais, menos ];
        }
      });
      console.log('antes', $scope.stalkeada.iduser)
      EventoService.GetComments3($scope.stalkeada).then(function(items) {
        
          $scope.options1 = {title: {
                    display: true,
                    text: 'Avaliações',
                    position: 'bottom'
                }
         }
           $scope.labels1 = ["Extrovertido", "Introvertido", "Realista","Curioso", "Solidário", "Racional","Organizado", "Criativo"];
          $scope.colores1 = ["#fff200", "#02fff2", "#ff9d00","#1867ce", "#e50be1", "#0e8c28","#ef370e", "#af0eef"];
          $scope.data1 =items.chart;
        
      }); 


    $http.post('https://ec2.diwoapp.com.br/geteventoporid.php', {idevento :  $scope.aux.idevento}).then(function (result){
      $scope.infoevento = result.data[0];
    });

    $scope.comentario = function(){
      formStalker.updateForm($scope.stalkeada);
      $state.go('comentariosperfilaceitargeral');
    }
    
    $http.post("https://ec2.diwoapp.com.br/getpessoaevento.php", {iduser : $scope.outro,
                                                                    estado : '3'}).then(function(response) {
      pontos = response.data[0];
      if (pontos=='E') {
        $scope.neventos = parseFloat(0);
      }else{
         $scope.neventos =parseFloat(pontos.length);
      }
      for(var i=0;i<pontos.length;i++){
        $http.post("https://ec2.diwoapp.com.br/geteventopessoaevento.php", {idevento : pontos[i].idevento,
                                                                              estado : '3'}).then(function(response) {
          var novo = response.data[0];
          for(var j=0 ;j<response.data[0].length;j++){
            if (novo[j].iduser == $scope.user.iduser && !$scope.desseguirbutton && $scope.outro != $scope.user.iduser) {
              $scope.followbutton = true;
              //console.log('fui no evento com este cara e nao sigo', $scope.outro , $scope.user.iduser);
            }
          }
        });
      }
    });   

    if(parseInt($scope.infoevento.patual)>=parseInt($scope.infoevento.pmax)){
      var alertPopup = $ionicPopup.alert({
                      title: ' ٩( ᐛ )و ',
                      template: 'Evento é um sucesso, mas o numero máximo de pessoas foi atingido. Como o evento é seu, tu pode confirmar essa pessoa mesmo assim'
                    });
    }                                                                

    $scope.$on("$ionicView.enter", function(event, data){
      $scope.items = [];
      $scope.vezes = 0;
      $scope.newItems = [];
      $scope.noMoreItemsAvailable = false;
      $scope.lastidevento = 0;
      $scope.aux2 = 0;
      $scope.aux = formAux.getAux();
      $scope.user = formUser.getForm();
      $scope.stalkeada = {}; 
      $scope.stalkeada.iduser = $scope.aux.id_user_envia;
      $scope.stalkeada.username = $scope.aux.username_envia;
      $scope.CoisasCriado = true;
      $scope.CoisasFinalizado = false;
      $scope.pushnoti = {};
      $scope.infosstalkeada ={};
      EventoService.GetStalkear($scope.aux.id_user_envia).then(function(stalker) {
          $scope.infosstalkeada = stalker;
          if(($scope.infosstalkeada.profilepic[8] == 's' && $scope.infosstalkeada.profilepic[9] == '3')||($scope.infosstalkeada.profilepic[8] == 'd' && $scope.infosstalkeada.profilepic[9] == 'i')){
           //if($scope.infosstalkeada.profilepic[8] == 's' && $scope.infosstalkeada.profilepic[9] == '3'){
             document.getElementById("imageidperfilAceitarGeral").src=$scope.infosstalkeada.profilepic+"?{{getTimeStamp()}}";
           }else{
             document.getElementById("imageidperfilAceitarGeral").src=$scope.infosstalkeada.profilepic;
           }
           if(!$scope.infosstalkeada.numcodigo || $scope.infosstalkeada.numcodigo == 'null'){
            $scope.temcodigo = false;
          }else{
            $scope.temcodigo = true;
            if($scope.infosstalkeada.numcodigo == '0'){
              document.getElementById("badgeimg_pag").src="img/egg_0.png";
            }
            if($scope.infosstalkeada.numcodigo == '1'){
              document.getElementById("badgeimg_pag").src="img/egg_1.png";
            }
            if($scope.infosstalkeada.numcodigo == '2'){
              document.getElementById("badgeimg_pag").src="img/egg_2.png";
            }
            if(parseInt($scope.infosstalkeada.numcodigo) >= 3){
              document.getElementById("badgeimg_pag").src="img/egg_3.png";
            }
            if(parseInt($scope.infosstalkeada.numcodigo) < 0){
              document.getElementById("badgeimg_pag").src="img/egg_3.png";
            }
          }
          //document.getElementById("imageidperfilAceitarGeral").src=$scope.infosstalkeada.profilepic+"?{{getTimeStamp()}}";
          $scope.frase = stalker.frase;
          if(stalker.borda == 0){
          $scope.estrelabb = false;
          $scope.estrelabs = false;
          $scope.estrelabg = false;
        }
        if(stalker.borda == 1){
          $scope.estrelabb = true;
          $scope.estrelabs = false;
          $scope.estrelabg = false;
        }
        if(stalker.borda == 2){
          $scope.estrelabb = false;
          $scope.estrelabs = true;
          $scope.estrelabg = false;
        }
        if(stalker.borda == 3){
          $scope.estrelabb = false;
          $scope.estrelabs = false;
          $scope.estrelabg = true;
        }
          if($scope.infosstalkeada.idade){
            $scope.infosstalkeada.idade = ", "+ $scope.infosstalkeada.idade +" anos";
          }else{
             $scope.infosstalkeada.idade ='';
          }
      });
      
   

      EventoService.GetStalkear($scope.aux.id_user_envia).then(function(stalker) {
        $scope.stalkeada = stalker;
        EventoService.GetCriados($scope.stalkeada).then(function(items) {
          if(items == 'E'){
            $scope.items = [];
          }else{
            for (var i = 0; i < items.length; i++) {
                var curr_date = (items[i].diainicio[8]+items[i].diainicio[9]);
                var h2 = (items[i].diainicio[11]+items[i].diainicio[12]);
                var m2 = (items[i].diainicio[14]+items[i].diainicio[15]);
                var curr_month = (items[i].diainicio[5]+items[i].diainicio[6]);
                var curr_year = (items[i].diainicio[0]+items[i].diainicio[1]+items[i].diainicio[2]+items[i].diainicio[3]);
                var j = curr_date + "/" + curr_month + "/" + curr_year+ ' '+h2 + ':' + m2;
                items[i].datainicio = j;
                if(items[i].estado == 0){
                  items[i].confirmacao = "Vai acontecer"
                }
                if(items[i].estado == 1){
                  items[i].confirmacao = "Finalizado"
                }
                if(items[i].estado == 2){
                  items[i].confirmacao = "Standy by, talvez aconteça"
                }
                if(items[i].estado == 3){
                  items[i].confirmacao = "Vai acontecer"
                }
                if(items[i].estado == 4){
                  items[i].confirmacao = "Cancelado"
                }
                if(items[i].estado == 5){
                  items[i].confirmacao = "Acabado"
                }
                if(items[i].estado == 6){
                  items[i].confirmacao = "Escondido"
                }
            }
            $scope.items = items.concat($scope.items);
            $scope.lastidvestido = $scope.items[0].idevento;
          }
        });
      });

      $http.post('https://ec2.diwoapp.com.br/geteventoporid.php', {idevento :  $scope.aux.idevento}).then(function (result){
        $scope.infoevento = result.data[0];
      });

      if(parseInt($scope.infoevento.patual)>=parseInt($scope.infoevento.pmax)){
        var alertPopup = $ionicPopup.alert({
                      title: ' ٩( ᐛ )و ',
                      template: 'Evento é um sucesso, mas o numero máximo de pessoas foi atingido. Como o evento é seu, tu pode confirmar essa pessoa mesmo assim'
        });
      }  

      EventoService.GetPontos($scope.stalkeada.iduser).then(function(items) {
        $scope.p = items;
        $scope.labels3 = ["Pontos"];
        $scope.colores3 = ["#ff4d4d"];
        $scope.data3 = [$scope.p];
      });
      EventoService.getIC($scope.stalkeada).then(function(items) {
        if(items){
          $scope.ic = items;
          $scope.options2 = {title: {
                      display: true,
                      text: 'Indice de confirmação',
                      position: 'bottom'
                  }
           }
          $scope.labels2 = ["Fui", "Não fui"];
          $scope.colores2 = ["#99FF99","#ff4d4d"];
          var menos = (100-$scope.ic.total).toFixed(1);
          var mais = $scope.ic.total;
          $scope.data2 = [mais, menos ];
        }
      });
      console.log('antes', $scope.stalkeada.iduser)
      EventoService.GetComments3($scope.stalkeada).then(function(items) {
        
          $scope.options1 = {title: {
                    display: true,
                    text: 'Avaliações',
                    position: 'bottom'
                }
         }
           $scope.labels1 = ["Extrovertido", "Introvertido", "Realista","Curioso", "Solidário", "Racional","Organizado", "Criativo"];
          $scope.colores1 = ["#fff200", "#02fff2", "#ff9d00","#1867ce", "#e50be1", "#0e8c28","#ef370e", "#af0eef"];
          $scope.data1 =items.chart;
        
      }); 


      $scope.stalkeada.diainicio = $scope.infoevento.diainicio ;
      $scope.stalkeada.diafim = $scope.infoevento.diafim ;
      EventoService.verificahorariopessoaeventoaguardando($scope.stalkeada).then(function(items) {
        $scope.auxdata = items;
      });
                      //Para ver se eu ja sigo esta pessoa ou não.
      $http.post("https://ec2.diwoapp.com.br/getpessoaevento.php", {iduser : $scope.outro,
                                                                       estado : '3'}).then(function(response) {
                  pontos = response.data[0];
                  if (pontos=='E') {
                    $scope.neventos = parseFloat(0);
                  }else{
                    $scope.neventos =parseFloat(pontos.length);
                  }
                  for(var i=0;i<pontos.length;i++){
                          $http.post("https://ec2.diwoapp.com.br/geteventopessoaevento.php", {idevento : pontos[i].idevento,
                                                                              estado : '3'}).then(function(response) {
                                var novo = response.data[0];
                                for(var j=0 ;j<response.data[0].length;j++){
                                  if (novo[j].iduser == $scope.user.iduser && !$scope.desseguirbutton && $scope.outro != $scope.user.iduser) {
                                    $scope.followbutton = true;
                                    //console.log('fui no evento com este cara e nao sigo', $scope.outro , $scope.user.iduser);
                                  }
                                }
                          });
                  }
      });   
    });

    $scope.entrar = function(){
        formUser.updateForm($scope.aux);
        $state.go('tabsController.comentarios');

    }
    
    $scope.aceitar =  function(){
      $ionicLoading.show({
        template: '<ion-spinner icon="ripple" class="spinner-diwo"></ion-spinner>'+
                  '<p style="color:#ff4444;font-weight:bold;font-family:Kollektif;padding:auto;margin:auto;">Enviando confirmação</p>'
      });
      $scope.aux.aceito = 2;
      $scope.aux.confirmacao = 'Confirmação aceita';
      $scope.msgnoti = ('Tu foi aceito no evento: ' + $scope.aux.nomeevento);
      //console.log($scope.msgnoti);
      EventoService.atualizarpessoaeventosconfirma($scope.auxdata);
      EventoService.atualizarpessoaevento($scope.aux).then(function(msg){
        var alertPopup = $ionicPopup.alert({
                title: 'Enviando confirmação',
                template: 'Vamos avisar para não se esquecer de comparecer no evento'
              });
        $scope.infoevento.patual = parseInt($scope.infoevento.patual)+1;
        console.log($scope.infoevento.patual,$scope.infoevento.pmin ,'Número de pessoas alcançado do evento ')
        if($scope.infoevento.patual == $scope.infoevento.pmin){
          EventoService.GetUserPorId($scope.aux.idComercioParceiro).then(function(comercio) {
            $scope.msgnotiComercio = ('Número mínimo de pessoas  alcançado do evento ' + $scope.aux.nomeevento);
            noti.recebeusername = comercio.username;
            noti.recebe = comercio.idComercioParceiro;
            noti.envia = comercio.idComercioParceiro;
            noti.tipo = 51;   //evento bateu numero minimo de pessoas para acontecer
            noti.nomeevento = $scope.aux.nomeevento;
              EventoService.VerificaNotificacao(noti).then(function(res) {
              if(res){
                $http.post('https://ec2.diwoapp.com.br/notificapessoa.php', {notificacao : $scope.msgnotiComercio, 
                              idevento : $scope.aux.idevento,
                              nomeevento : $scope.aux.nomeevento,
                              id_user_envia : $scope.aux.idComercioParceiro,
                              username_envia : $scope.aux.nomeevento,
                              apelido_envia : $scope.aux.nomeevento,
                              tipo : '51',
                              id_user_recebe : $scope.aux.idComercioParceiro});
                  $scope.pushnoti.titulo =  'Número de pessoas alcançado!' ;
                  $scope.pushnoti.msg = $scope.msgnotiComercio;
                  $scope.pushnoti.token = comercio.devicetoken;
                  EventoService.MandaPushNoti($scope.pushnoti);
                  $scope.pushnoti.titulo =  'Número de pessoas alcançado!' ;
                  $scope.pushnoti.msg = $scope.msgnotiComercio;
                  $scope.pushnoti.token = 'c9WyMZZdhcA:APA91bGI9UHwVAw_1ryMRZxd3cvcvwKnfZ8YpoWKaVrbZjfyi6luCX_IcdKj2HVz_eEwvtM01ISHtcCXJIfc1Cf_iyQEtG9UB64uV9m_DrLIzUYD6Z4gbDtESh_TuO1APak6F5YaO8iK';
                  EventoService.MandaPushNoti($scope.pushnoti);
              }
            });
          });
        }
        $http.post('https://ec2.diwoapp.com.br/addpessoaevento.php', {idevento : $scope.aux.idevento,
                                                                          patual : $scope.infoevento.patual});
        noti.recebeusername = $scope.infosstalkeada.username;
        noti.recebe = $scope.aux.id_user_envia;
        noti.envia = $scope.aux.id_user_recebe;
        noti.tipo = 2;
        noti.nomeevento = $scope.aux.nomeevento;
        EventoService.VerificaNotificacao(noti).then(function(res) {
          if(res){
            $http.post('https://ec2.diwoapp.com.br/notificapessoa.php', {notificacao : $scope.msgnoti, 
                          idevento : $scope.aux.idevento,
                          nomeevento : $scope.aux.nomeevento,
                          id_user_envia : $scope.aux.id_user_recebe,
                          username_envia : $scope.user.username,
                          apelido_envia : $scope.aux.apelido,
                          tipo : '2',
                          id_user_recebe : $scope.aux.id_user_envia});
            EventoService.getusuario2(noti.recebeusername).then(function(user) {

              if(user.notiparticipando== '1'){
              $scope.pushnoti.titulo =  'Boraaa!!!' ;
              $scope.pushnoti.msg = $scope.msgnoti;
              $scope.pushnoti.token = user.devicetoken;
               EventoService.MandaPushNoti($scope.pushnoti);
             }
            });
          }
        });
        $http.post('https://ec2.diwoapp.com.br/deletanotificacao.php', {idnotificacao : $scope.aux.idnotificacao});
          alertPopup.then(function(){
             $ionicLoading.hide();
            $state.go('tabsController.geral');
          })
      }, function(errMsg) {
            var alertPopup = $ionicPopup.alert({
              title: 'Register failed!',
              template: errMsg
            });
      })  
    }

    $scope.recusar =  function(){
           var confirmPopup = $ionicPopup.show({
                   title: 'ATENÇÃO!!!',
                   template: 'Ao recusar esta pessoa não poderá mais entrar neste evento, tens certeza disso?',
                   buttons: [
                      { text: 'Não',
                        type: 'button-assertive'},
                      {
                        text: 'Sim',
                        type: 'button-positive',
                        onTap: function(e){
                        $scope.msgnoti = ('Tu foi negado pra comparecer nome evento: ' + $scope.aux.nomeevento + ', mas segue o day');
                        console.log($scope.msgnoti);
              noti.recebeusername = $scope.infosstalkeada.username;
              noti.recebe = $scope.aux.id_user_envia;
              noti.envia = $scope.aux.id_user_recebe;
              noti.tipo = 3;
              noti.nomeevento = $scope.aux.nomeevento;
              EventoService.VerificaNotificacao(noti).then(function(res) {
                console.log(res);
                if(res){
                  $http.post('https://ec2.diwoapp.com.br/notificapessoa.php', {notificacao : $scope.msgnoti, 
                                idevento : $scope.aux.idevento,
                                nomeevento : $scope.aux.nomeevento,
                                id_user_envia : $scope.aux.id_user_recebe,
                                username_envia : $scope.user.username,
                                apelido_envia : $scope.aux.apelido,
                                tipo : '3',
                                id_user_recebe : $scope.aux.id_user_envia});
                  $http.post('https://ec2.diwoapp.com.br/deletanotificacao.php', {idnotificacao : $scope.aux.idnotificacao});
                  EventoService.getusuario2(noti.recebeusername).then(function(user) {
                    if(user.notiparticipando== '1'){
                    $scope.pushnoti.titulo = $scope.evento.nomeevento + ' negado';
                    $scope.pushnoti.msg = $scope.msgnoti;
                    $scope.pushnoti.token = user.devicetoken;
                     EventoService.MandaPushNoti($scope.pushnoti);
                   }
                  });
                }
              });
              $http.post('https://ec2.diwoapp.com.br/deletapessoaevento.php', {iduser : $scope.aux.id_user_envia,
                                                                                  idevento : $scope.aux.idevento,
                                                                                  estado: '1'});
              $http.post('https://ec2.diwoapp.com.br/deletachat.php', {iduser : $scope.aux.id_user_envia,
                                                                            idevento : $scope.aux.idevento  });
              $http.post('https://ec2.diwoapp.com.br/pessoanaoevento.php', {iduser : $scope.aux.id_user_envia, 
                                                                                idevento : $scope.aux.idevento,
                                                                                nomeevento : $scope.aux.nomeevento,
                                                                                estado : '2'});//foi nao foi aceito
              $state.go('tabsController.geral');
                             }
                      }
                           ]
                   })
    }

    $scope.loadCriados = function() {
      $scope.CoisasCriado = true;
      $scope.CoisasFinalizado = false;
        $scope.estadobutton = 0;
        $scope.items = [];
        EventoService.GetCriados($scope.stalkeada).then(function(items) {
          if(items == 'E'){
            $scope.items = [];
          }else{
            for (var i = 0; i < items.length; i++) {
                var curr_date = (items[i].diainicio[8]+items[i].diainicio[9]);
                var h2 = (items[i].diainicio[11]+items[i].diainicio[12]);
                var m2 = (items[i].diainicio[14]+items[i].diainicio[15]);
                var curr_month = (items[i].diainicio[5]+items[i].diainicio[6]);
                var curr_year = (items[i].diainicio[0]+items[i].diainicio[1]+items[i].diainicio[2]+items[i].diainicio[3]);
                var j = curr_date + "/" + curr_month + "/" + curr_year+ ' '+h2 + ':' + m2;
                items[i].datainicio = j;
                if(items[i].estado == 0){
                  items[i].confirmacao = "Vai acontecer"
                }
                if(items[i].estado == 1){
                  items[i].confirmacao = "Finalizado"
                }
                if(items[i].estado == 2){
                  items[i].confirmacao = "Standy by, talvez aconteça"
                }
                if(items[i].estado == 3){
                  items[i].confirmacao = "Vai acontecer"
                }
                if(items[i].estado == 4){
                  items[i].confirmacao = "Cancelado"
                }
                if(items[i].estado == 5){
                  items[i].confirmacao = "Acabado"
                }
                if(items[i].estado == 6){
                  items[i].confirmacao = "Escondido"
                }
            }
            $scope.items = items.concat($scope.items);
            $scope.lastidvestido = $scope.items[0].idevento;
          }
        });
    }
    
    $scope.loadAbertos = function() {
      $scope.CoisasCriado = false;
      $scope.CoisasFinalizado = true;
        $scope.estadobutton = 1;
        $scope.items = [];
        EventoService.GetAbertos($scope.stalkeada.iduser).then(function(items) {  //mudar
          if(items == 'E'){
            $scope.items = [];
          }else{
            for (var i = 0; i < items.length; i++) {
                var curr_date = (items[i].diainicio[8]+items[i].diainicio[9]);
                var h2 = (items[i].diainicio[11]+items[i].diainicio[12]);
                var m2 = (items[i].diainicio[14]+items[i].diainicio[15]);
                var curr_month = (items[i].diainicio[5]+items[i].diainicio[6]);
                var curr_year = (items[i].diainicio[0]+items[i].diainicio[1]+items[i].diainicio[2]+items[i].diainicio[3]);
                var j = curr_date + "/" + curr_month + "/" + curr_year+ ' '+h2 + ':' + m2;
                items[i].datainicio = j;
            }
            $scope.items = items.concat($scope.items);
            $scope.lastidvestido = $scope.items[0].idevento;
          }
        });
    }
    
    $scope.loadFechados = function() {
      $scope.CoisasCriado = false;
      $scope.CoisasFinalizado = true;
        $scope.estadobutton = 2;
        $scope.items = [];
        EventoService.GetFinalizadosPerfil($scope.stalkeada.iduser).then(function(items) {         //mudar
          if(items =='E'){
            $scope.items = [];
          }else{
            for (var i = 0; i < items.length; i++) {
                var curr_date = (items[i].diainicio[8]+items[i].diainicio[9]);
                var h2 = (items[i].diainicio[11]+items[i].diainicio[12]);
                var m2 = (items[i].diainicio[14]+items[i].diainicio[15]);
                var curr_month = (items[i].diainicio[5]+items[i].diainicio[6]);
                var curr_year = (items[i].diainicio[0]+items[i].diainicio[1]+items[i].diainicio[2]+items[i].diainicio[3]);
                var j = curr_date + "/" + curr_month + "/" + curr_year+ ' '+h2 + ':' + m2;
                items[i].datainicio = j;
            }
            $scope.items = items.concat($scope.items);
            $scope.lastidvestido = $scope.items[0].idevento;
          }
        });      
    }
    
    $scope.loadMore = function() {
      if ($scope.estadobutton == 0) {
        EventoService.GetOldEventosCriados().then(function(items) {
        $scope.items = $scope.items.concat(items);
        $scope.$broadcast('scroll.infiniteScrollComplete');
          if (items.length <= 4) {
            $scope.noMoreItemsAvailable = true;
          }

        });
      }
      if ($scope.estadobutton == 1) {
        EventoService.GetOldEventosCriados().then(function(items) {
        $scope.items = $scope.items.concat(items);
        $scope.$broadcast('scroll.infiniteScrollComplete');
          if (items.length <= 4) {
            $scope.noMoreItemsAvailable = true;
          }
        });

        
      }
      if ($scope.estadobutton == 2) {
        EventoService.GetOldEventosCriados().then(function(items) {
        $scope.items = $scope.items.concat(items);
        $scope.$broadcast('scroll.infiniteScrollComplete');
          if (items.length <= 4) {
            $scope.noMoreItemsAvailable = true;
          }
        });

      
      }
    }

}])

.controller('areacoberturaCtrl', ['$scope', '$stateParams',  // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams ) {
  
}])

.controller('idadegeneroCtrl', ['$scope', '$stateParams', 'formUser', 'formLoc', 'EventoService', 'formAux', '$state','$timeout', '$ionicPopup', '$http', 'formOutro', 'formItem', 'formtela', 'formtelanoti', 'formtipologin','formEventoPerfil', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, formUser, formLoc, EventoService, formAux, $state, $timeout, $ionicPopup, $http, formOutro, formItem, formtela, formtelanoti, formtipologin, formEventoPerfil) {
  $scope.user = formUser.getForm();
  console.log($scope.user.iduser)
    var header = document.getElementById("barsexoidade1");
    var btns = header.getElementsByClassName("btnsexy1");
    for (var i = 0; i < btns.length; i++) {
      btns[i].addEventListener("click", function() {
        var current = document.getElementsByClassName("actsex1");
        current[0].className = current[0].className.replace(" actsex1", "");
        this.className += " actsex1";
      });
    }


    $scope.macho = function() {$scope.user.genero = 'masc'};
    $scope.femea = function() {$scope.user.genero = 'fem'};
   
    $scope.salvar =  function(){
      var ageDifMs = Date.now() - $scope.user.birthday;
      var ageDate = new Date(ageDifMs); // miliseconds from epoch
      $scope.user.idade =  Math.abs(ageDate.getUTCFullYear() - 1970);
      console.log($scope.user.idade , $scope.user.genero)
      if($scope.user.idade.valueOf() < 18 ){
       var alertPopup = $ionicPopup.alert({
          title: '(●´ω｀●)ゞ',
          template: 'Menores de idade não são permitido no App, para saber mais confira nossos Termos de Uso'
        }); 
        alertPopup.then(function(){
          $state.go('logando');
        });
      }else{
        if($scope.user.genero){
          EventoService.atualizaidadegenero($scope.user).then(function(msg){
          var alertPopup = $ionicPopup.alert({
                            title: 'Perfil Atualizado, obrigado',
                            template: 'Agora poderá ver mais coisas'
              });
              alertPopup.then(function(){
                formUser.updateForm($scope.user);

                $state.go('tabsController.home');
              }) 
            
          }, function(errMsg) {
            var alertPopup = $ionicPopup.alert({
              title: 'Register failed!',
              template: errMsg
            });
            alertPopup.then(function(){
                      $state.go('logando');
            })
          })
        }else{
          var alertPopup = $ionicPopup.alert({
            title: '(●´ω｀●)ゞ',
            template: 'Por favor selecione seu gênero (mais próximo?)'
          });
        }
        
      }
    }
  

}])

.controller('geralCtrl', ['$scope', '$stateParams', 'formUser', 'formLoc','formvimdopost','formPost', 'EventoService', 'formAux', '$state','$timeout', '$ionicPopup', '$http', 'formOutro', 'formItem', 'formtela', 'formtelanoti', 'formtipologin','formEventoPerfil','formResetoufeed', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, formUser, formLoc,formvimdopost,formPost, EventoService, formAux, $state, $timeout, $ionicPopup, $http, formOutro, formItem, formtela, formtelanoti, formtipologin, formEventoPerfil, formResetoufeed) {
  
  $scope.comentario = '';
 
  $scope.user = formUser.getForm();
  EventoService.GetComentariosfeitos($scope.user).then(function(coments) { //
        aux1 = coments.length;
        $scope.feitos = coments;
      });
  $scope.mandeicomentario = true;

  $scope.enviar =  function(comentario){
    if(!comentario || comentario == ''){
      var alertPopup = $ionicPopup.alert({
          title: '＿φ(°-°=)',
          template: 'Escreva algo para gente antes de enviar plz!!'
        });
    }else{
     var alertPopup = $ionicPopup.alert({
          title: '(◍˃̵͈̑ᴗ˂̵͈̑)',
          template: 'Obrigado pelo feedback'
        });
        alertPopup.then(function(){
          $http.post('https://ec2.diwoapp.com.br/reportaevento.php', {namereportado : 'diwoapp',
                                                                  reportadoid : 'nada',
                                                                  iduserreportando : $scope.aux.iduser,
                                                                  usernamereportando : $scope.aux.username,
                                                                  tiporeport : 'fale conosco',
                                                                  motivo : comentario});
          delete $scope.comentario;
          $scope.mandeicomentario = false;
          });
    }
  }
  $scope.$on("$ionicView.enter", function(event, data){
    $scope.user = formUser.getForm();
    $scope.raiodist = (window.localStorage.getItem( 'dist' ))/1000;
    if(!$scope.raiodist){
      $scope.raiodistkm = 30;
      //$scope.raiodistkm = raiodistkm/1000;
      console.log($scope.raiodist, "raiodist")
    }else{
      console.log($scope.raiodist, "raiodist")
      $scope.raiodistkm = $scope.raiodist;
    }
    $scope.SilenciarNoti = false;
    //console.log($scope.user.noticriados,"$scope.user.noticriados")
    if($scope.user.noticriados == '1'){
      $scope.criados = { checked: true };
    }else{
      $scope.criados = { checked: false };
    }
    if($scope.user.notichat == '1'){
      $scope.chat = { checked: true };
    }else{
      $scope.chat = { checked: false };
    }
    if($scope.user.notiparticipando == '1'){
      $scope.participando = { checked: true };
    }else{
      $scope.participando = { checked: false };
    }
    if($scope.user.notipost == '1'){
      $scope.post = { checked: true };
    }else{
      $scope.post = { checked: false };
    }
    if($scope.user.notipertovc == '1'){
      $scope.pertovc = { checked: true };
    }else{
      $scope.pertovc = { checked: false };
    }
    if($scope.user.notiavaliacao == '1'){
      $scope.avaliacoes = { checked: true };
    }else{
      $scope.avaliacoes = { checked: false };
    }
    if($scope.user.notipessoasqsigo == '1'){
      $scope.pessoasqsigo = { checked: true };
    }else{
      $scope.pessoasqsigo = { checked: false };
    }
  })
  
  $scope.raiodist = (window.localStorage.getItem( 'dist' ))/1000;
  if(!$scope.raiodist){
    $scope.raiodistkm = 30;
    //$scope.raiodistkm = raiodistkm/1000;
    console.log($scope.raiodist, "raiodist")
  }else{
    console.log($scope.raiodist, "raiodist")
    $scope.raiodistkm = $scope.raiodist;
  }
  $scope.SilenciarNoti = true;
  $scope.silenciarnotificacao = function(raiodistkm){
    
    if($scope.SilenciarNoti){
      $scope.SilenciarNoti = false;
    }
    else{
      $scope.SilenciarNoti = true;
    }
  }



 
  
  $scope.SilenciarCriados =function(){
    if($scope.criados.checked){
      $scope.user.noticriados = 1;
      EventoService.atualizarnotiperfil($scope.user);
    }
    if(!$scope.criados.checked){
      $scope.user.noticriados = 0;
      EventoService.atualizarnotiperfil($scope.user);
    }
  }
  
  $scope.SilenciarChat =function(){
    if($scope.chat.checked){
      $scope.user.notichat = 1;
      EventoService.atualizarnotiperfil($scope.user);
    }
    if(!$scope.chat.checked){
      $scope.user.notichat = 0;
      EventoService.atualizarnotiperfil($scope.user);
    }
  }

  $scope.SilenciarParticipando =function(){
    if($scope.participando.checked){
      $scope.user.notiparticipando = 1;
      EventoService.atualizarnotiperfil($scope.user);
    }
    if(!$scope.participando.checked){
      $scope.user.notiparticipando = 0;
      EventoService.atualizarnotiperfil($scope.user);
    }
  }

  $scope.SilenciarPosts =function(){
    if($scope.post.checked){
      $scope.user.notipost = 1;
      EventoService.atualizarnotiperfil($scope.user);
    }
    if(!$scope.post.checked){
      $scope.user.notipost = 0;
      EventoService.atualizarnotiperfil($scope.user);
    }
  }
  
  $scope.SilenciarPertodevc =function(){
    if($scope.pertovc.checked){
      $scope.user.notipertovc = 1;
      EventoService.atualizarnotiperfil($scope.user);
    }
    if(!$scope.pertovc.checked){
      $scope.user.notipertovc = 0;
      EventoService.atualizarnotiperfil($scope.user);
    }
  }
 
  $scope.SilenciarAvaliacao =function(){
    if($scope.avaliacoes.checked){
      $scope.user.notiavaliacao = 1;
      EventoService.atualizarnotiperfil($scope.user);
    }
    if(!$scope.avaliacoes.checked){
      $scope.user.notiavaliacao = 0;
      EventoService.atualizarnotiperfil($scope.user);
    }
  }
  
  $scope.SilenciarPessoasqsigo =function(){
    if($scope.pessoasqsigo.checked){
      $scope.user.notipessoasqsigo = 1;
      EventoService.atualizarnotiperfil($scope.user);
    }
    if(!$scope.pessoasqsigo.checked){
      $scope.user.notipessoasqsigo = 0;
      EventoService.atualizarnotiperfil($scope.user);
    }
  }
  


  $scope.mudaraio = function(raiodistkm){
    $scope.raiodist = raiodistkm
    //console.log($scope.raiodist, "raiodist")
    window.localStorage.setItem( 'dist',  JSON.stringify(($scope.raiodist*1000)));
  }

  $scope.resetar = function(){

    var myPopup = $ionicPopup.show({
                  title: 'Resetar!',
                  subTitle: 'Para recarregar os eventos que você pulou vamos pegar 5 pontinhos emprestados! Vá em Perfil-Pontos para saber como ganhar mais! (É grátis)',
                  scope: $scope,
                  buttons: [
                    { text: 'Cancelar' },
                    {
                      text: '<b>Ok</b>',
                      type: 'button-positive',
                      onTap: function(e) {
                        var po = $scope.user.pontos.valueOf() - 5;
                        if($scope.user.pontos<5){
                          var alertPopup = $ionicPopup.alert({
                              title: '(ノ￣ー￣)ノ ● ＼(^ω^＼)',
                              template: 'Não tens pontos suficiente, tente ir em mais eventos ou crie ou avalie em eventos que você foi e não avaliou ninguem, uma pessoa basta!'
                          });
                        }else{
                          $http.post('https://ec2.diwoapp.com.br/gastapontospessoaevento.php', {idevento : -24,
                                                          iduser : $scope.user.iduser,
                                                          borda : $scope.user.borda,
                                                          username: $scope.user.username,
                                                          apelido : $scope.user.apelido,
                                                          nomeevento :  "Resetou feed", 
                                                          estado : 10,
                                                          pontos: -5});
                          console.log($scope.user.iduser, "$scope.user.iduser")
                          $http.post('https://ec2.diwoapp.com.br/resetafeed.php', {iduser : $scope.user.iduser});
                          $scope.atualiza = {};
                          $scope.atualiza.pontos = po;
                          $scope.atualiza.iduser = $scope.user.iduser;
                          formResetoufeed.updateForm(true);
                          EventoService.atualizarpontos($scope.atualiza);
                          $state.go('tabsController.home')
                        }
                      }
                    }
                  ]
                  });
  }

  $scope.logout =  function(){
    $scope.user = {};
    delete $scope.items;
    $scope.loc = formLoc.getForm();
    formLoc.updateForm();
    formAux.updateAux();
    formUser.updateForm();
    formItem.updateForm();
    formOutro.updateForm();
    formtela.updateForm();
    formtelanoti.updateForm();
    formtipologin.updateForm();
    if($scope.loc){
      $scope.user.lat =  $scope.loc.lat;
      $scope.user.long =  $scope.loc.long;
      $scope.user.northlat = $scope.loc.northlat;
      $scope.user.westlng = $scope.loc.westlng;
      $scope.user.southlat = $scope.loc.southlat;
      $scope.user.eastlng = $scope.loc.eastlng;
      //console.log($scope.loc.eastlng)
    }
    formUser.updateForm($scope.user);
    EventoService.Mudadevice($scope.user);
    window.localStorage.removeItem('user')
    if($scope.tipologin == 1){
       facebookConnectPlugin.logout(function(){

          $state.go('logando');
        },
        function(fail){
           var alertPopup = $ionicPopup.alert({
            title: '( ;°Д°)',
            template: 'Aconteceu algum problema nao planejado'
          });
        });
    }
    $state.go('logando');
  }
  $scope.data = {};
  $scope.deletar =  function(){
    $state.go('tabsController.deletaconta');
  }

}])

.controller('deletacontaCtrl', ['$scope', '$stateParams', 'formUser', 'formLoc','formvimdopost','formPost', 'EventoService', 'formAux', '$state','$timeout', '$ionicPopup', '$http', 'formOutro', 'formItem', 'formtela', 'formtelanoti', 'formtipologin','formEventoPerfil','formResetoufeed', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, formUser, formLoc,formvimdopost,formPost, EventoService, formAux, $state, $timeout, $ionicPopup, $http, formOutro, formItem, formtela, formtelanoti, formtipologin, formEventoPerfil, formResetoufeed) {

 
  $scope.user = formUser.getForm();
 

  $scope.$on("$ionicView.enter", function(event, data){
    $scope.user = formUser.getForm();
    $scope.movito1 = { checked: false };
    $scope.movito2 = { checked: false };
    $scope.movito3 = { checked: false };
    $scope.movito4 = { checked: false };
    $scope.movito5 = { checked: false };
    $scope.movito6 = { checked: false };
  })


 
  
  $scope.Movito6 =function(){
    if($scope.movito6.checked){
      $scope.mostraoutro = true;
    }
    if(!$scope.movito6.checked){
      $scope.mostraoutro = false;
    }
  }
  
  $scope.outromotivo = '';
  
  

  $scope.data = {};
  $scope.deletar =  function(){
    $scope.msg = '';
    if($scope.movito1.checked){
      $scope.msg = "Não gostei";
    }
    if($scope.movito2.checked){
      $scope.msg =  $scope.msg  +'\n\r' + " Não encontrei eventos do meu interesse";
    }
    if($scope.movito3.checked){
      $scope.msg =  $scope.msg  +'\n\r' + " Não acesso mais o App";
    }
    if($scope.movito4.checked){
      $scope.msg =  $scope.msg  +'\n\r' + " Não encontrei nada útil";
    }
    if($scope.movito5.checked){
      $scope.msg =  $scope.msg  +'\n\r' +  " Não acho seguro";
    }
    if($scope.movito6.checked){
      console.log($scope.user.outromotivo)
      $scope.msg =  $scope.msg +'\n\r' + " Outro motivo:"  + $scope.user.outromotivo;
    }
    $http.post('https://ec2.diwoapp.com.br/reportaevento.php', {namereportado : $scope.user.username,
                                                        reportadoid : $scope.user.iduser,
                                                        iduserreportando : $scope.user.iduser,
                                                        usernamereportando : $scope.user.username,
                                                        tiporeport : 'Deletando Conta',
                                                        motivo : $scope.msg});
    var myPopup = $ionicPopup.show({
                                template: '<input type="text" placeholder="Escreva aqui sua senha para confirmar" ng-model="data.senha">',
                                title: 'ATENÇÃOOOO!!!',
                                subTitle: 'Você esta preste a DELETAR sua conta, tens certeza disso?. Estaremos removendo de todos os lugares desse app. Se mesmo assim você quer continuar digite sua senha abaixo para confirmar.',
                                scope: $scope,
                                buttons: [
                                  { text: 'Não' },
                                  {
                                    text: '<b>Deletar</b>',
                                    type: 'button-positive',
                                    onTap: function(e) {
                                      if($scope.data.senha == $scope.user.password){

                                        delete $scope.items;
                                        $scope.loc = formLoc.getForm();
                                        formLoc.updateForm();
                                        formAux.updateAux();
                                        formUser.updateForm();
                                        formItem.updateForm();
                                        formOutro.updateForm();
                                        formtela.updateForm();
                                        formtelanoti.updateForm();
                                        formtipologin.updateForm();
                                        if($scope.loc){
                                          $scope.user.lat =  $scope.loc.lat;
                                          $scope.user.long =  $scope.loc.long;
                                          $scope.user.northlat = $scope.loc.northlat;
                                          $scope.user.westlng = $scope.loc.westlng;
                                          $scope.user.southlat = $scope.loc.southlat;
                                          $scope.user.eastlng = $scope.loc.eastlng;
                                          //console.log($scope.loc.eastlng)
                                        }
                                        EventoService.DeletaConta($scope.user);
                                        $scope.user.devicetoken ='';
                                        EventoService.Mudadevice($scope.user);
                                        var authenticationData = {
                                        Username : $scope.user.email,
                                        Password : $scope.user.password,
                                          };
                                        
                                        var authenticationDetails = new AmazonCognitoIdentity.AuthenticationDetails(authenticationData);
                                          
                                        var poolData = {
                                          UserPoolId : 'us-east-1_nOWA67ADf', // Your user pool id here
                                          ClientId : '8k5rbqhifi5r1hb2j4n1u07li'// Your client id here
                                        };
                                        
                                          var userPool = new AmazonCognitoIdentity.CognitoUserPool(poolData);
                                          var userData = {
                                              Username : $scope.user.email,
                                              Pool : userPool,
                                          };
                                        
                                        var cognitoUser = new AmazonCognitoIdentity.CognitoUser(userData);
                                        cognitoUser.authenticateUser(authenticationDetails, {
                                            onSuccess: function (result) {
                                              cognitoUser.deleteUser(function(err, result) {
                                                if (err) {
                                                    //alert(err);
                                                    $scope.user = {};
                                                formUser.updateForm();
                                                $state.go('logando');
                                                    return;
                                                }
                                                $scope.user = {};
                                                formUser.updateForm();
                                                $state.go('logando');
                                              });
                                            },

                                            onFailure: function(err) {
                                                $scope.user = {};
                                                formUser.updateForm();
                                                $state.go('logando');
                                            },

                                        });
                                        
                                        $scope.user = {};
                                        formUser.updateForm();
                                        window.localStorage.removeItem('user')
                                        if($scope.tipologin == 1){
                                          facebookConnectPlugin.logout(function(){
                                              $state.go('logando');
                                          },
                                          function(fail){
                                            var alertPopup = $ionicPopup.alert({
                                              title: '( ;°Д°)',
                                              template: 'Aconteceu algum problema nao planejado'
                                            });
                                          });
                                        }
                                        
                                        
                                      }else{
                                        var alertPopup = $ionicPopup.alert({
                                          title: '( ;°Д°)',
                                          template: 'Senha incorreta.'
                                        });
                                      }
                                      
                                    }
                                  }
                                ]})
    
  }

}])

.controller('sobreCtrl', ['$scope', '$stateParams', 'formItem', 'EventoService', 'formUser','$state', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, formItem, EventoService, formUser,$state) {

}])

.controller('sobrecampanhasCtrl', ['$scope', '$stateParams', 'formItem', 'EventoService', 'formUser','$state', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, formItem, EventoService, formUser,$state) {

}])
   
.controller('notificaEsCtrl', ['$scope', '$stateParams', 'formUser', 'EventoService', 'formAux','formPost', '$state','$timeout', '$ionicPopup', '$http', 'formOutro', 'formItem', 'formtela', 'formtelanoti','formEventoPerfil','formvimdonoti', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, formUser, EventoService, formAux,formPost, $state, $timeout, $ionicPopup, $http, formOutro, formItem, formtela, formtelanoti, formEventoPerfil,formvimdonoti) {
  
   $scope.data = {showDelete: false};
   $scope.evento = {};
   $scope.comentariovalido = {};
   $scope.outro ={};
    $scope.auxpost = {};
   $scope.aux = formUser.getForm();
   console.log($scope.aux);
   var aux1= 0;
   var aux2= 0;
   var k = 0;
   var noti ={};
   var ultima_noti_data;
   formtelanoti.updateForm(2);

   $scope.$on("$ionicView.enter", function(event, data){
      $scope.items = [];
      $scope.evento = {};
      $scope.auxpost = {};
      $scope.auxpost.user = $scope.aux;
      $scope.auxpost.user.lat = $scope.aux.lat;
      $scope.comentariovalido = {};
      $scope.outro ={};
      var aux1= 0;
      var aux2= 0;
      var k = 0;
      var noti ={};
      var ultima_noti_data;
      $scope.data = {showDelete: false};
      $scope.aux = formUser.getForm();
      console.log($scope.aux,"aux",'ndansnnks')
      EventoService.GetNotificacoes1($scope.aux).then(function(aux) {
        console.log(aux,"aux",'ndansnnks')
        if(aux == "error"){
          $scope.vazio = true;
        }else{
          for (var i = 0; i < aux.nrow; i++) {
            $scope.items[i] = aux[i];
            console.log($scope.items[i].notificacao);
            ultima_noti_data = $scope.items[0].datadecriacao;
            var curr_date = (aux[i].datadecriacao[8]+aux[i].datadecriacao[9]);
            var h2 = (aux[i].datadecriacao[11]+aux[i].datadecriacao[12]);
            h2 = parseInt(h2)-3;
            var m2 = (aux[i].datadecriacao[14]+aux[i].datadecriacao[15]);
            var curr_month = (aux[i].datadecriacao[5]+aux[i].datadecriacao[6]);
            var curr_year = (aux[i].datadecriacao[0]+aux[i].datadecriacao[1]+aux[i].datadecriacao[2]+aux[i].datadecriacao[3]);
            var j = curr_date + "/" + curr_month + "/" + curr_year+ ' '+h2 + ':' + m2;
            $scope.items[i].datadeenvio = j;
          }
          $scope.vazio = false;
        }
             
      });
      EventoService.GetComentariosfeitos($scope.aux).then(function(coments) { //
        aux1 = coments.length;
        $scope.feitos = coments;
        for (var i = 0 ; i<aux1 ; i++){
          if ($scope.feitos[i].idevento == item.idevento && item.id_user_envia == $scope.feitos[i].idpessoaavaliada && item.username_envia == $scope.feitos[i].nomepessoaavaliada) {
            $scope.comentariovalido = $scope.feitos[i]; 
            aux2 = 1;
            k++;
          }
        }
      });
    });

   $scope.onItemDelete = function(item) {
    $scope.items.splice($scope.items.indexOf(item), 1);
    $http.post('https://ec2.diwoapp.com.br/deletanotificacao.php', {idnotificacao : item.idnotificacao});
   };

    $scope.enterItem =  function(item){
      formAux.updateAux(item.tipo);
      console.log(item.tipo)
      $http.post('https://ec2.diwoapp.com.br/geteventoporid.php', {idevento : item.idevento}).then(function (result){
        $scope.infoevento = result.data[0];
        formItem.updateForm($scope.infoevento);
        console.log($scope.infoevento.idevento);
      });
      if (item.tipo == '1') {
        formAux.updateAux(item);
        $state.go('perfilAceitar');
      }
      if (item.tipo == '8') {
        var alertPopup = $ionicPopup.alert({
          title: '(((( ;°Д°))))',
          template: 'Muita gente querendo ir no evento, mas como tu que manda podes aceitar ou não, ai é contigo'
        });
        alertPopup.then(function(){
          $http.post('https://ec2.diwoapp.com.br/deletanotificacao.php', {idnotificacao : item.idnotificacao}).then(function (res){
            $scope.response = res.data;
            console.log($scope.response.msg)
             $state.go('perfilAceitar');
          });
         
        })
      }
      if (item.tipo == '2') {
        var alertPopup = $ionicPopup.alert({
          title: '⁽(◍˃̵͈̑ᴗ˂̵͈̑)⁽',
          template: 'Agora é se preparar e não se esqueçer de comparecer ao evento'
        });
        alertPopup.then(function(){
          $http.post('https://ec2.diwoapp.com.br/deletanotificacao.php', {idnotificacao : item.idnotificacao}).then(function (res){
            $scope.response = res.data;
            console.log($scope.response.msg)
            $state.reload();
          });
          
        })
      }
      if (item.tipo == '3') {
        var alertPopup = $ionicPopup.alert({
          title: '（╬ಠ益ಠ)',
          template: 'Não se esqueça de comparecer aos eventos para seu indice de confirmação ser altos sempre'
        });
        alertPopup.then(function(){
          $http.post('https://ec2.diwoapp.com.br/deletanotificacao.php', {idnotificacao : item.idnotificacao}).then(function (res){
            $scope.response = res.data;
            console.log($scope.response.msg)
            $state.reload();
          });
          
        })
      }
      if (item.tipo == '4') {
        var alertPopup = $ionicPopup.alert({
          title: '(￣ω￣)',
          template: 'Fica de olho que mudou o evento, o organizador resolveu mudar algo no evento'
        });
        alertPopup.then(function(){
          $http.post('https://ec2.diwoapp.com.br/deletanotificacao.php', {idnotificacao : item.idnotificacao}).then(function (res){
            $scope.response = res.data;
            console.log($scope.response.msg)
            $state.go('tabsController.eventosAbertos');
          });
          
        })
      }
      if (item.tipo == '5') {
        var alertPopup = $ionicPopup.alert({
          title: 'ε-(>o<)',
          template: 'Nao vou mais, tive que cancelar'
        });
        alertPopup.then(function(){
          $http.post('https://ec2.diwoapp.com.br/deletanotificacao.php', {idnotificacao : item.idnotificacao}).then(function (res){
            $scope.response = res.data;
            console.log($scope.response.msg)
            $state.reload();
          });
          
        })
      }
       if (item.tipo == '13') {
        var alertPopup = $ionicPopup.alert({
          title: '(ﾉ^ヮ^)ﾉ*:・ﾟ✧',
          template: item.notificacao
        });
        alertPopup.then(function(){
          $http.post('https://ec2.diwoapp.com.br/deletanotificacao.php', {idnotificacao : item.idnotificacao}).then(function (res){
            $scope.response = res.data;
            console.log($scope.response.msg)
            $state.reload();
          });
          
        })
      }
      if (item.tipo == '9') {
        var alertPopup = $ionicPopup.alert({
          title: 'ಥ_ಥ',
          template: 'Você foi retirado do evento por algum motivo'
        });
        alertPopup.then(function(){
          $http.post('https://ec2.diwoapp.com.br/deletanotificacao.php', {idnotificacao : item.idnotificacao}).then(function (res){
            $scope.response = res.data;
            console.log($scope.response.msg)
            $state.reload();
          });
          
        })
      }
      if (item.tipo == '6' && item.id_user_envia == $scope.aux.iduser) {
        formtela.updateForm(1);
        var confirmPopup = $ionicPopup.show({
                   title: 'Confirme pá nóx',
                   template: 'Você foi mesmo no evento?',
                   buttons: [
                      { text: 'Não',
                        type: 'button-assertive',
                        onTap: function(e){
                          item.confirmacao = 'Não estive presente no evento ocorrido';
                          item.aceito = '5'; 
                          EventoService.atualizarpessoaevento(item);
                          $http.post('https://ec2.diwoapp.com.br/deletanotificacao.php', {idnotificacao : item.idnotificacao}).then(function (res){
                               $scope.response = res.data;
                               console.log($scope.response.msg)
                               $state.reload();
                             });
                           

                        }},
                      {
                        text: 'Sim',
                        type: 'button-positive',
                        onTap: function(e){
                          formAux.updateAux(item);
                          $state.go('qmFoiMesmo');
                        }}]
                 });
       }
       if (item.tipo == '6' && item.id_user_envia !=  $scope.aux.iduser) {
        formtela.updateForm(1);
        item.id_user_envia = $scope.aux.iduser;
          var confirmPopup = $ionicPopup.show({
                   title: 'Confirme pá nóx',
                   template: 'Você foi mesmo no evento?',
                   buttons: [
                      { text: 'Não',
                        type: 'button-assertive',
                        onTap: function(e){
                          item.confirmacao = 'Não estive presente no evento ocorrido';
                          item.aceito = '5'; 
                          EventoService.atualizarpessoaevento(item);
                            $http.post('https://ec2.diwoapp.com.br/deletanotificacao.php', {idnotificacao : item.idnotificacao}).then(function (res){
                               $scope.response = res.data;
                               console.log($scope.response.msg)
                               $state.reload();
                             });
                            

                        }},
                      {
                        text: 'Sim',
                        type: 'button-positive',
                        onTap: function(e){
                          formAux.updateAux(item);
                          $state.go('tabsController.avaliaODoEvento');
                        }}]
                 });

      }
      // if (item.tipo == '400') {
      //   var alertPopup = $ionicPopup.alert({
      //     title: 'Novo comentário no post',
      //     template: item.notificacao
      //   });
      //   alertPopup.then(function(){
      //     $http.post('https://ec2.diwoapp.com.br/deletanotificacao.php', {idnotificacao : item.idnotificacao}).then(function (res){
      //       $scope.response = res.data;
      //       console.log($scope.response.msg, "aqui??")
      //       // $state.reload();
      //     });
      //   })
      // }
      if (item.tipo == '10') {
        var alertPopup = $ionicPopup.alert({
          title: '└(・-・)┘',
          template: 'Não foi dessa vez'
        });
        alertPopup.then(function(){
          $http.post('https://ec2.diwoapp.com.br/deletanotificacao.php', {idnotificacao : item.idnotificacao}).then(function (res){
            $scope.response = res.data;
            console.log($scope.response.msg)
            $state.reload();
          });
          
        })
      }
      if (item.tipo == '11') {
        var alertPopup = $ionicPopup.alert({
          title: '⁽(◍˃̵͈̑ᴗ˂̵͈̑)⁽',
          template: 'Sou muito pop'
        });
        alertPopup.then(function(){
          $http.post('https://ec2.diwoapp.com.br/deletanotificacao.php', {idnotificacao : item.idnotificacao}).then(function (res){
            $scope.response = res.data;
            console.log($scope.response.msg)
            $state.reload();
          });
          
        })
      }
       if(item.tipo == '12'){
        $http.post('https://ec2.diwoapp.com.br/geteventoporid.php', {idevento :  item.idevento}).then(function (result){
          $scope.evento = result.data[0];
        });
        var myPopup = $ionicPopup.show({
                        template: 'Uma pessoa desistiu e agora o numero de pessoas confirmadas no evento é menor que o minimo. Deseja fazer o evento mesmo assim? (Caso cancele nao receberás penalidade)',
                        title: 'Vish',
                        scope: $scope,
                        buttons: [
                       { text: 'Vou ver' 
                         //close popup and do nothing
                       },
                       {
                        text: 'Vai rolar',
                        type: 'button-balanced',
                        onTap: function(e) {  
                          console.log('evento acontece normalmente')
                        }
                       },
                       {
                        text: 'Cancelar',
                        type: 'button-assertive',
                        onTap: function(e) { 
                          EventoService.Cancelarevento($scope.evento);
                          console.log('Vou cancelar o evento', $scope.evento.nomeevento);
                        }
                       }]
                      });
       }
      if (item.tipo == '400') {
        $scope.auxpost.idposts = item.idevento;
        
        EventoService.PostGet($scope.auxpost).then(function(post) {
          $scope.auxpost = post;
        });
        var alertPopup = $ionicPopup.alert({
          title: 'Novo comentário no post',
          template: item.notificacao
        });
        alertPopup.then(function(){
          $http.post('https://ec2.diwoapp.com.br/deletanotificacao.php', {idnotificacao : item.idnotificacao}).then(function (res){
            $scope.response = res.data;
            console.log($scope.response.msg)
            formPost.updatePost( $scope.auxpost);
            formvimdonoti.updateForm(true);
            $state.go('tabsController.post');
          });
        })
      }
      if (item.tipo == '401') {
        $scope.auxpost.idposts = item.idevento;
        EventoService.PostGet($scope.auxpost).then(function(post) {
          $scope.auxpost = post;
        });
        var alertPopup = $ionicPopup.alert({
          title: '٩(˃̶͈̀௰˂̶͈́)و',
          template: item.notificacao
        });
        alertPopup.then(function(){
          $http.post('https://ec2.diwoapp.com.br/deletanotificacao.php', {idnotificacao : item.idnotificacao}).then(function (res){
            $scope.response = res.data;
            console.log($scope.response.msg)
            formPost.updatePost( $scope.auxpost);
            formvimdonoti.updateForm(true);
            $state.go('tabsController.post');
          });
        })
      }

       if (item.tipo == '7') {
          
          //console.log(item.idevento);
          //console.log(item.id_user_envia);
          
          if (aux2 == 1) {
            //formtela.updateForm(1);
            var alertPopup = $ionicPopup.alert({
                      title: 'ヽ(〃･ω･)ﾉ',
                      template: 'Curioso? Vamos ver o que escreveram sobre mim'
                    });
            //formtela.updateForm(2);
            alertPopup.then(function(){
                   // $http.post('https://ec2.diwoapp.com.br/deletanotificacao.php', {idnotificacao : item.idnotificacao}).then(function (res){
                   //             $scope.response = res.data;
                   //             console.log($scope.response.msg)
                   //           });
                  formEventoPerfil.updateForm(item);
                  console.log($scope.evento.idevento, "odajsij")
                  $state.go('tabsController.eventoFechado');
            })
          }else{

            var alertPopup = $ionicPopup.alert({
                      title: '(`へ´*)ノ',
                      template: 'Avalie!!! Conseguirás ver só se você avaliar o outro, tipo um troca troca'
                    });
            alertPopup.then(function(){
                   // $http.post('https://ec2.diwoapp.com.br/deletanotificacao.php', {idnotificacao : item.idnotificacao}).then(function (res){
                   //             $scope.response = res.data;
                   //             console.log($scope.response.msg)
                   //           });
                   $scope.outro.iduser = item.id_user_envia;
                   formOutro.updateForm($scope.outro);
                   //formtela.updateForm(1); 
                   console.log($scope.evento.idevento, "odajsij")
                   formEventoPerfil.updateForm(item);

                            // TEM QUE IR PARA PAGINA DE AVALIAR A PESSOA NAQUELE EVENTO
                          $state.go('tabsController.eventoFechado');
                    })

          }

       }
      if (item.tipo == '13') {   /// comercio nao tem horario agora
        var alertPopup = $ionicPopup.alert({
          title: '⁽(◍˃̵͈̑ᴗ˂̵͈̑)⁽',
          template: 'Infelizmente o local não esta com horário disponível'
        });
        alertPopup.then(function(){
          $http.post('https://ec2.diwoapp.com.br/deletanotificacao.php', {idnotificacao : item.idnotificacao}).then(function (res){
            $scope.response = res.data;
            console.log($scope.response.msg);
            $state.reload();
          });
        })
      }
      // if (item.tipo == '14') {   /// comercio nao tem horario agora
      //   var confirmPopup = $ionicPopup.show({
      //              title: 'Horário indisponivel',
      //              template: $scope.response.notificacao,
      //              buttons: [
      //                 { text: 'Não',
      //                   type: 'button-assertive',
      //                   onTap: function(e){
      //                     item.confirmacao = 'Não estive presente no evento ocorrido';
      //                     item.aceito = '5'; 
      //                     EventoService.atualizarpessoaevento(item);
      //                       $http.post('https://ec2.diwoapp.com.br/deletanotificacao.php', {idnotificacao : item.idnotificacao}).then(function (res){
      //                          $scope.response = res.data;
      //                          $state.reload();
      //                        });

      //                   }},
      //                 {
      //                   text: 'Sim',
      //                   type: 'button-positive',
      //                   onTap: function(e){
      //                   }}]
      //            });
      // }

   
   }
    $scope.doRefresh = function() {
      var refresh = {};
      refresh.iduser = $scope.aux.iduser;  
      refresh.datadaultima = ultima_noti_data;
            console.log($scope.aux.iduser , ultima_noti_data)
             EventoService.GetNoti(refresh).then(function(resp) {
                console.log(resp, resp.length);
                if(resp == "Error"){
                  console.log("Nao tem notificação nova")
                }else{
                  $scope.items =resp.concat($scope.items);
                }
              });

          $scope.$broadcast('scroll.refreshComplete');
    }


}])

.controller('perfilAceitarCtrl', ['$scope', '$state', '$stateParams', 'formAux', 'formUser', 'EventoService', '$timeout', '$http','$ionicPopup', 'formStalker','$ionicLoading',  // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $state, $stateParams, formAux, formUser, EventoService, $timeout, $http, $ionicPopup, formStalker, $ionicLoading) {

    $scope.aux = formAux.getAux();      // Infos da notificação
    // console.log($scope.aux.id_user_recebe);
    // console.log($scope.aux.id_user_envia);
    // console.log($scope.aux.idnotificacao);
    $scope.user = formUser.getForm();
    //console.log($scope.aux);
    $scope.auxdata = {};
    $scope.estadobutton = 0;
    $scope.stalkeada = {}; 
    $scope.stalkeada.iduser = $scope.aux.id_user_envia;
    $scope.stalkeada.username = $scope.aux.username_envia;
    $scope.neventos= 0;
    $scope.neventosnao= 0;
    $scope.p =0;
    $scope.ic = 0;
    $scope.infoevento ={};
    $scope.CoisasCriado = true;
    $scope.CoisasFinalizado = false;
    $scope.pushnoti = {};
    var noti={};
    $scope.infosstalkeada ={};
    EventoService.GetStalkear($scope.aux.id_user_envia).then(function(stalker) {
        $scope.infosstalkeada = stalker;
        if(($scope.infosstalkeada.profilepic[8] == 's' && $scope.infosstalkeada.profilepic[9] == '3')||($scope.infosstalkeada.profilepic[8] == 'd' && $scope.infosstalkeada.profilepic[9] == 'i')){
        //if($scope.infosstalkeada.profilepic[8] == 's' && $scope.infosstalkeada.profilepic[9] == '3'){
             document.getElementById("imageidperfilAceitar").src=$scope.infosstalkeada.profilepic+"?{{getTimeStamp()}}";
           }else{
             document.getElementById("imageidperfilAceitar").src=$scope.infosstalkeada.profilepic;
           }
           if(!$scope.infosstalkeada.numcodigo || $scope.infosstalkeada.numcodigo == 'null'){
            $scope.temcodigo = false;
          }else{
            $scope.temcodigo = true;
            if($scope.infosstalkeada.numcodigo == '0'){
              document.getElementById("badgeimg_pa").src="img/egg_0.png";
            }
            if($scope.infosstalkeada.numcodigo == '1'){
              document.getElementById("badgeimg_pa").src="img/egg_1.png";
            }
            if($scope.infosstalkeada.numcodigo == '2'){
              document.getElementById("badgeimg_pa").src="img/egg_2.png";
            }
            if(parseInt($scope.infosstalkeada.numcodigo) >= 3){
              document.getElementById("badgeimg_pa").src="img/egg_3.png";
            }
            if(parseInt($scope.infosstalkeada.numcodigo) < 0){
              document.getElementById("badgeimg_pa").src="img/egg_3.png";
            }
          }
        //document.getElementById("imageidperfilAceitar").src=$scope.infosstalkeada.profilepic+"?{{getTimeStamp()}}";
        $scope.frase = stalker.frase;
         if(stalker.borda == 0){
          $scope.estrelabb = false;
          $scope.estrelabs = false;
          $scope.estrelabg = false;
        }
        if(stalker.borda == 1){
          $scope.estrelabb = true;
          $scope.estrelabs = false;
          $scope.estrelabg = false;
        }
        if(stalker.borda == 2){
          $scope.estrelabb = false;
          $scope.estrelabs = true;
          $scope.estrelabg = false;
        }
        if(stalker.borda == 3){
          $scope.estrelabb = false;
          $scope.estrelabs = false;
          $scope.estrelabg = true;
        }
        if($scope.infosstalkeada.idade){
          $scope.infosstalkeada.idade = ", "+ $scope.infosstalkeada.idade +" anos";
        }else{
           $scope.infosstalkeada.idade ='';
        }
    });
    var header = document.getElementById("barperfiloutroev");
    var btns = header.getElementsByClassName("btnperfilotro");
    for (var i = 0; i < btns.length; i++) {
      btns[i].addEventListener("click", function() {
        var current = document.getElementsByClassName("actpa");
        current[0].className = current[0].className.replace(" actpa", "");
        this.className += " actpa";
      });
    }

   

    EventoService.GetPontos($scope.stalkeada.iduser).then(function(items) {
        $scope.p = items;
        $scope.labels3 = ["Pontos"];
        $scope.colores3 = ["#ff4d4d"];
        $scope.data3 = [$scope.p];
      });
      EventoService.getIC($scope.stalkeada).then(function(items) {
        if(items){
          $scope.ic = items;
          $scope.options2 = {title: {
                      display: true,
                      text: 'Indice de confirmação',
                      position: 'bottom'
                  }
           }
          $scope.labels2 = ["Fui", "Não fui"];
          $scope.colores2 = ["#99FF99","#ff4d4d"];
          var menos = (100-$scope.ic.total).toFixed(1);
          var mais = $scope.ic.total;
          $scope.data2 = [mais, menos ];
        }
      });
      console.log('antes', $scope.stalkeada.iduser)
      EventoService.GetComments3($scope.stalkeada).then(function(items) {
        
          $scope.options1 = {title: {
                    display: true,
                    text: 'Avaliações',
                    position: 'bottom'
                }
         }
          $scope.labels1 = ["Extrovertido", "Introvertido", "Realista","Curioso", "Solidário", "Racional","Organizado", "Criativo"];
          $scope.colores1 = ["#fff200", "#02fff2", "#ff9d00","#1867ce", "#e50be1", "#0e8c28","#ef370e", "#af0eef"];
          $scope.data1 =items.chart;
        
      }); 


    $http.post('https://ec2.diwoapp.com.br/geteventoporid.php', {idevento :  $scope.aux.idevento}).then(function (result){
      $scope.infoevento = result.data[0];
    });

    $scope.comentario = function(){
      formStalker.updateForm($scope.stalkeada);
      $state.go('comentariosperfilaceitar');
    }
    
    $http.post("https://ec2.diwoapp.com.br/getpessoaevento.php", {iduser : $scope.outro,
                                                                    estado : '3'}).then(function(response) {
      pontos = response.data[0];
      if (pontos=='E') {
        $scope.neventos = parseFloat(0);
      }else{
         $scope.neventos =parseFloat(pontos.length);
      }
      for(var i=0;i<pontos.length;i++){
        $http.post("https://ec2.diwoapp.com.br/geteventopessoaevento.php", {idevento : pontos[i].idevento,
                                                                              estado : '3'}).then(function(response) {
          var novo = response.data[0];
          for(var j=0 ;j<response.data[0].length;j++){
            if (novo[j].iduser == $scope.user.iduser && !$scope.desseguirbutton && $scope.outro != $scope.user.iduser) {
              $scope.followbutton = true;
              //console.log('fui no evento com este cara e nao sigo', $scope.outro , $scope.user.iduser);
            }
          }
        });
      }
    });   

    if(parseInt($scope.infoevento.patual)>=parseInt($scope.infoevento.pmax)){
      var alertPopup = $ionicPopup.alert({
                      title: ' ٩( ᐛ )و ',
                      template: 'Evento é um sucesso, mas o numero máximo de pessoas foi atingido. Como o evento é seu, tu pode confirmar essa pessoa mesmo assim'
                    });
    }                                                                

    $scope.$on("$ionicView.enter", function(event, data){
      $scope.items = [];
      $scope.vezes = 0;
      $scope.newItems = [];
      $scope.noMoreItemsAvailable = false;
      $scope.lastidevento = 0;
      $scope.aux2 = 0;
      $scope.aux = formAux.getAux();
      $scope.user = formUser.getForm();
      $scope.stalkeada = {}; 
      $scope.stalkeada.iduser = $scope.aux.id_user_envia;
      $scope.stalkeada.username = $scope.aux.username_envia;
      $scope.CoisasCriado = true;
      $scope.CoisasFinalizado = false;
      $scope.pushnoti = {};
      $scope.infosstalkeada ={};
      EventoService.GetStalkear($scope.aux.id_user_envia).then(function(stalker) {
          $scope.infosstalkeada = stalker;
          if(($scope.infosstalkeada.profilepic[8] == 's' && $scope.infosstalkeada.profilepic[9] == '3')||($scope.infosstalkeada.profilepic[8] == 'd' && $scope.infosstalkeada.profilepic[9] == 'i')){
          //if($scope.infosstalkeada.profilepic[8] == 's' && $scope.infosstalkeada.profilepic[9] == '3'){
             document.getElementById("imageidperfilAceitar").src=$scope.infosstalkeada.profilepic+"?{{getTimeStamp()}}";
           }else{
             document.getElementById("imageidperfilAceitar").src=$scope.infosstalkeada.profilepic;
           }
           if(!$scope.infosstalkeada.numcodigo || $scope.infosstalkeada.numcodigo == 'null'){
            $scope.temcodigo = false;
          }else{
            $scope.temcodigo = true;
            if($scope.infosstalkeada.numcodigo == '0'){
              document.getElementById("badgeimg_pa").src="img/egg_0.png";
            }
            if($scope.infosstalkeada.numcodigo == '1'){
              document.getElementById("badgeimg_pa").src="img/egg_1.png";
            }
            if($scope.infosstalkeada.numcodigo == '2'){
              document.getElementById("badgeimg_pa").src="img/egg_2.png";
            }
            if(parseInt($scope.infosstalkeada.numcodigo) >= 3){
              document.getElementById("badgeimg_pa").src="img/egg_3.png";
            }
            if(parseInt($scope.infosstalkeada.numcodigo) < 0){
              document.getElementById("badgeimg_pa").src="img/egg_3.png";
            }
          }
         //document.getElementById("imageidperfilAceitar").src=$scope.infosstalkeada.profilepic+"?{{getTimeStamp()}}";
          $scope.frase = stalker.frase;
           if(stalker.borda == 0){
          $scope.estrelabb = false;
          $scope.estrelabs = false;
          $scope.estrelabg = false;
        }
        if(stalker.borda == 1){
          $scope.estrelabb = true;
          $scope.estrelabs = false;
          $scope.estrelabg = false;
        }
        if(stalker.borda == 2){
          $scope.estrelabb = false;
          $scope.estrelabs = true;
          $scope.estrelabg = false;
        }
        if(stalker.borda == 3){
          $scope.estrelabb = false;
          $scope.estrelabs = false;
          $scope.estrelabg = true;
        }
          if($scope.infosstalkeada.idade){
            $scope.infosstalkeada.idade = ", "+ $scope.infosstalkeada.idade +" anos";
          }else{
             $scope.infosstalkeada.idade ='';
          }

        EventoService.GetCriados($scope.stalkeada).then(function(items) {
          if(items == 'E'){
            $scope.items = [];
          }else{
            for (var i = 0; i < items.length; i++) {
                var curr_date = (items[i].diainicio[8]+items[i].diainicio[9]);
                var h2 = (items[i].diainicio[11]+items[i].diainicio[12]);
                var m2 = (items[i].diainicio[14]+items[i].diainicio[15]);
                var curr_month = (items[i].diainicio[5]+items[i].diainicio[6]);
                var curr_year = (items[i].diainicio[0]+items[i].diainicio[1]+items[i].diainicio[2]+items[i].diainicio[3]);
                var j = curr_date + "/" + curr_month + "/" + curr_year+ ' '+h2 + ':' + m2;
                items[i].datainicio = j;
                if(items[i].estado == 0){
                  items[i].confirmacao = "Vai acontecer"
                }
                if(items[i].estado == 1){
                  items[i].confirmacao = "Finalizado"
                }
                if(items[i].estado == 2){
                  items[i].confirmacao = "Standy by, talvez aconteça"
                }
                if(items[i].estado == 3){
                  items[i].confirmacao = "Vai acontecer"
                }
                if(items[i].estado == 4){
                  items[i].confirmacao = "Cancelado"
                }
                if(items[i].estado == 5){
                  items[i].confirmacao = "Acabado"
                }
                if(items[i].estado == 6){
                  items[i].confirmacao = "Escondido"
                }
            }
            $scope.items = items.concat($scope.items);
            $scope.lastidvestido = $scope.items[0].idevento;
          }
        });
      });

      $http.post('https://ec2.diwoapp.com.br/geteventoporid.php', {idevento :  $scope.aux.idevento}).then(function (result){
        $scope.infoevento = result.data[0];
      });

      if(parseInt($scope.infoevento.patual)>=parseInt($scope.infoevento.pmax)){
        var alertPopup = $ionicPopup.alert({
                      title: ' ٩( ᐛ )و ',
                      template: 'Evento é um sucesso, mas o numero máximo de pessoas foi atingido. Como o evento é seu, tu pode confirmar essa pessoa mesmo assim'
        });
      }  

      EventoService.GetPontos($scope.stalkeada.iduser).then(function(items) {
        $scope.p = items;
        $scope.labels3 = ["Pontos"];
        $scope.colores3 = ["#ff4d4d"];
        $scope.data3 = [$scope.p];
      });
      EventoService.getIC($scope.stalkeada).then(function(items) {
        if(items){
          $scope.ic = items;
          $scope.options2 = {title: {
                      display: true,
                      text: 'Indice de confirmação',
                      position: 'bottom'
                  }
           }
          $scope.labels2 = ["Fui", "Não fui"];
          $scope.colores2 = ["#99FF99","#ff4d4d"];
          var menos = (100-$scope.ic.total).toFixed(1);
          var mais = $scope.ic.total;
          $scope.data2 = [mais, menos ];
        }
      });
      console.log('antes', $scope.stalkeada.iduser)
      EventoService.GetComments3($scope.stalkeada).then(function(items) {
        
          $scope.options1 = {title: {
                    display: true,
                    text: 'Avaliações',
                    position: 'bottom'
                }
         }
          $scope.labels1 = ["Extrovertido", "Introvertido", "Realista","Curioso", "Solidário", "Racional","Organizado", "Criativo"];
          $scope.colores1 = ["#fff200", "#02fff2", "#ff9d00","#1867ce", "#e50be1", "#0e8c28","#ef370e", "#af0eef"];
          $scope.data1 =items.chart;
        
      }); 


      $scope.stalkeada.diainicio = $scope.infoevento.diainicio ;
      $scope.stalkeada.diafim = $scope.infoevento.diafim ;
      EventoService.verificahorariopessoaeventoaguardando($scope.stalkeada).then(function(items) {
        $scope.auxdata = items;
      });
                      //Para ver se eu ja sigo esta pessoa ou não.
      $http.post("https://ec2.diwoapp.com.br/getpessoaevento.php", {iduser : $scope.outro,
                                                                       estado : '3'}).then(function(response) {
                  pontos = response.data[0];
                  if (pontos=='E') {
                    $scope.neventos = parseFloat(0);
                  }else{
                    $scope.neventos =parseFloat(pontos.length);
                  }
                  for(var i=0;i<pontos.length;i++){
                          $http.post("https://ec2.diwoapp.com.br/geteventopessoaevento.php", {idevento : pontos[i].idevento,
                                                                              estado : '3'}).then(function(response) {
                                var novo = response.data[0];
                                for(var j=0 ;j<response.data[0].length;j++){
                                  if (novo[j].iduser == $scope.user.iduser && !$scope.desseguirbutton && $scope.outro != $scope.user.iduser) {
                                    $scope.followbutton = true;
                                    //console.log('fui no evento com este cara e nao sigo', $scope.outro , $scope.user.iduser);
                                  }
                                }
                          });
                  }
      });   
    });

    $scope.entrar = function(){
        formUser.updateForm($scope.aux);
        $state.go('tabsController.comentarios');

    }
    
    $scope.aceitar =  function(){
      $ionicLoading.show({
        template: '<ion-spinner icon="ripple" class="spinner-diwo"></ion-spinner>'+
                  '<p style="color:#ff4444;font-weight:bold;font-family:Kollektif;padding:auto;margin:auto;">Enviando confirmação</p>'
      });
      $scope.aux.aceito = 2;
      $scope.aux.confirmacao = 'Confirmação aceita';
      $scope.msgnoti = ('Tu foi aceito no evento: ' + $scope.aux.nomeevento);
      //console.log($scope.msgnoti);
      EventoService.atualizarpessoaeventosconfirma($scope.auxdata);
      EventoService.atualizarpessoaevento($scope.aux).then(function(msg){
        // var alertPopup = $ionicPopup.alert({
        //         title: 'Enviando confirmação',
        //         template: 'Vamos avisar para não se esquecer de comparecer no evento'
        //       });
        $scope.infoevento.patual = parseInt($scope.infoevento.patual)+1;
        $http.post('https://ec2.diwoapp.com.br/addpessoaevento.php', {idevento : $scope.aux.idevento,
                                                                          patual : $scope.infoevento.patual});
        noti.recebeusername = $scope.infosstalkeada.username;
        noti.recebe = $scope.aux.id_user_envia;
        noti.envia = $scope.aux.id_user_recebe;
        noti.tipo = 2;
        noti.nomeevento = $scope.aux.nomeevento;
        EventoService.VerificaNotificacao(noti).then(function(res) {
          if(res){
            $http.post('https://ec2.diwoapp.com.br/notificapessoa.php', {notificacao : $scope.msgnoti, 
                          idevento : $scope.aux.idevento,
                          nomeevento : $scope.aux.nomeevento,
                          id_user_envia : $scope.aux.id_user_recebe,
                          username_envia : $scope.user.username,
                          apelido_envia : $scope.user.apelido,
                          tipo : '2',
                          id_user_recebe : $scope.aux.id_user_envia});
           EventoService.getusuario2(noti.recebeusername).then(function(user) {
            if(user.notiparticipando== '1'){
              $scope.pushnoti.titulo =  'Boraaa!!!' ;
              $scope.pushnoti.msg = $scope.msgnoti;
              $scope.pushnoti.token = user.devicetoken;
               EventoService.MandaPushNoti($scope.pushnoti);
             }
            });
          }
        });
        $http.post('https://ec2.diwoapp.com.br/deletanotificacao.php', {idnotificacao : $scope.aux.idnotificacao});
            $ionicLoading.hide();
            $state.go('tabsController.notificaEs');
          
      }, function(errMsg) {
            var alertPopup = $ionicPopup.alert({
              title: 'Register failed!',
              template: errMsg
            });
            $ionicLoading.hide();
      })  
    }

    $scope.recusar =  function(){
           var confirmPopup = $ionicPopup.show({
                   title: 'ATENÇÃO!!!',
                   template: 'Ao recusar esta pessoa não poderá mais entrar neste evento, tens certeza disso?',
                   buttons: [
                      { text: 'Não',
                        type: 'button-assertive'},
                      {
                        text: 'Sim',
                        type: 'button-positive',
                        onTap: function(e){
                        $scope.msgnoti = ('Tu foi negado pra comparecer nome evento: ' + $scope.aux.nomeevento + ', mas segue o day');
                        console.log($scope.msgnoti);
              noti.recebeusername = $scope.infosstalkeada.username;
              noti.recebe = $scope.aux.id_user_envia;
              noti.envia = $scope.aux.id_user_recebe;
              noti.tipo = 3;
              noti.nomeevento = $scope.aux.nomeevento;
              EventoService.VerificaNotificacao(noti).then(function(res) {
                console.log(res);
                if(res){
                  $http.post('https://ec2.diwoapp.com.br/notificapessoa.php', {notificacao : $scope.msgnoti, 
                                idevento : $scope.aux.idevento,
                                nomeevento : $scope.aux.nomeevento,
                                id_user_envia : $scope.aux.id_user_recebe,
                                username_envia : $scope.user.username,
                                apelido_envia : $scope.aux.apelido,
                                tipo : '3',
                                id_user_recebe : $scope.aux.id_user_envia});
                  $http.post('https://ec2.diwoapp.com.br/deletanotificacao.php', {idnotificacao : $scope.aux.idnotificacao});
                  EventoService.getusuario2(noti.recebeusername).then(function(user) {
                    if(user.notiparticipando== '1'){
                    $scope.pushnoti.titulo = $scope.evento.nomeevento + ' negado';
                    $scope.pushnoti.msg = $scope.msgnoti;
                    $scope.pushnoti.token = user.devicetoken;
                     EventoService.MandaPushNoti($scope.pushnoti);
                   }
                  });
                }
              });
              $http.post('https://ec2.diwoapp.com.br/deletapessoaevento.php', {iduser : $scope.aux.id_user_envia,
                                                                                  idevento : $scope.aux.idevento,
                                                                                  estado: '1'});
              $http.post('https://ec2.diwoapp.com.br/deletachat.php', {iduser : $scope.aux.id_user_envia,
                                                                            idevento : $scope.aux.idevento  });
              $http.post('https://ec2.diwoapp.com.br/pessoanaoevento.php', {iduser : $scope.aux.id_user_envia, 
                                                                                idevento : $scope.aux.idevento,
                                                                                nomeevento : $scope.aux.nomeevento,
                                                                                estado : '2'});//foi nao foi aceito
              $state.go('tabsController.notificaEs');
                             }
                      }
                           ]
                   })
    }

    $scope.loadCriados = function() {
      $scope.CoisasCriado = true;
    $scope.CoisasFinalizado = false;
        $scope.estadobutton = 0;
        $scope.items = [];
        EventoService.GetCriados($scope.stalkeada).then(function(items) {
          if(items == 'E'){
            $scope.items = [];
          }else{
            for (var i = 0; i < items.length; i++) {
                var curr_date = (items[i].diainicio[8]+items[i].diainicio[9]);
                var h2 = (items[i].diainicio[11]+items[i].diainicio[12]);
                var m2 = (items[i].diainicio[14]+items[i].diainicio[15]);
                var curr_month = (items[i].diainicio[5]+items[i].diainicio[6]);
                var curr_year = (items[i].diainicio[0]+items[i].diainicio[1]+items[i].diainicio[2]+items[i].diainicio[3]);
                var j = curr_date + "/" + curr_month + "/" + curr_year+ ' '+h2 + ':' + m2;
                items[i].datainicio = j;
                if(items[i].estado == 0){
                  items[i].confirmacao = "Vai acontecer"
                }
                if(items[i].estado == 1){
                  items[i].confirmacao = "Finalizado"
                }
                if(items[i].estado == 2){
                  items[i].confirmacao = "Standy by, talvez aconteça"
                }
                if(items[i].estado == 3){
                  items[i].confirmacao = "Vai acontecer"
                }
                if(items[i].estado == 4){
                  items[i].confirmacao = "Cancelado"
                }
                if(items[i].estado == 5){
                  items[i].confirmacao = "Acabado"
                }
                if(items[i].estado == 6){
                  items[i].confirmacao = "Escondido"
                }
            }
            $scope.items = items.concat($scope.items);
            $scope.lastidvestido = $scope.items[0].idevento;
          }
        });
    }
    
    $scope.loadAbertos = function() {
      $scope.CoisasCriado = false;
    $scope.CoisasFinalizado = true;
        $scope.estadobutton = 1;
        $scope.items = [];
        EventoService.GetAbertos($scope.stalkeada.iduser).then(function(items) {  //mudar
          if(items == 'E'){
            $scope.items = [];
          }else{
            for (var i = 0; i < items.length; i++) {
                var curr_date = (items[i].diainicio[8]+items[i].diainicio[9]);
                var h2 = (items[i].diainicio[11]+items[i].diainicio[12]);
                var m2 = (items[i].diainicio[14]+items[i].diainicio[15]);
                var curr_month = (items[i].diainicio[5]+items[i].diainicio[6]);
                var curr_year = (items[i].diainicio[0]+items[i].diainicio[1]+items[i].diainicio[2]+items[i].diainicio[3]);
                var j = curr_date + "/" + curr_month + "/" + curr_year+ ' '+h2 + ':' + m2;
                items[i].datainicio = j;
            }
            $scope.items = items.concat($scope.items);
            $scope.lastidvestido = $scope.items[0].idevento;
          }
        });
    }
    
    $scope.loadFechados = function() {
      $scope.CoisasCriado = false;
    $scope.CoisasFinalizado = true;
        $scope.estadobutton = 2;
        $scope.items = [];
        EventoService.GetFinalizadosPerfil($scope.stalkeada.iduser).then(function(items) {         //mudar
          if(items =='E'){
            $scope.items = [];
          }else{
            for (var i = 0; i < items.length; i++) {
                var curr_date = (items[i].diainicio[8]+items[i].diainicio[9]);
                var h2 = (items[i].diainicio[11]+items[i].diainicio[12]);
                var m2 = (items[i].diainicio[14]+items[i].diainicio[15]);
                var curr_month = (items[i].diainicio[5]+items[i].diainicio[6]);
                var curr_year = (items[i].diainicio[0]+items[i].diainicio[1]+items[i].diainicio[2]+items[i].diainicio[3]);
                var j = curr_date + "/" + curr_month + "/" + curr_year+ ' '+h2 + ':' + m2;
                items[i].datainicio = j;
            }
            $scope.items = items.concat($scope.items);
            $scope.lastidvestido = $scope.items[0].idevento;
          }
        });      
    }
    
    $scope.loadMore = function() {
      if ($scope.estadobutton == 0) {
        EventoService.GetOldEventosCriados().then(function(items) {
        $scope.items = $scope.items.concat(items);
        $scope.$broadcast('scroll.infiniteScrollComplete');
          if (items.length <= 4) {
            $scope.noMoreItemsAvailable = true;
          }

        });
      }
      if ($scope.estadobutton == 1) {
        EventoService.GetOldEventosCriados().then(function(items) {
        $scope.items = $scope.items.concat(items);
        $scope.$broadcast('scroll.infiniteScrollComplete');
          if (items.length <= 4) {
            $scope.noMoreItemsAvailable = true;
          }
        });

        
      }
      if ($scope.estadobutton == 2) {
        EventoService.GetOldEventosCriados().then(function(items) {
        $scope.items = $scope.items.concat(items);
        $scope.$broadcast('scroll.infiniteScrollComplete');
          if (items.length <= 4) {
            $scope.noMoreItemsAvailable = true;
          }
        });

      
      }
    }

}])
   
.controller('eventoCriadoCtrl', ['$scope', '$stateParams', 'formItem', 'formUser', 'formOutro', '$http', '$timeout','$ionicPopup', 'EventoService', '$state', 'formEditar', 'formEventoPerfil', 'formEventoEditaperfil',// The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, formItem, formUser, formOutro, $http, $timeout, $ionicPopup, EventoService, $state, formEditar, formEventoPerfil, formEventoEditaperfil) {
    //$scope.evento = formItem.getForm();
    $scope.evento = formEventoPerfil.getForm();
    
    console.log($scope.evento.nomeevento);
    $scope.aux = formUser.getForm();
    $scope.EditEvento = true;
    $scope.desisti = true;
    $scope.repete = false;
    $scope.data = {};
    $scope.nuser = 0;
    $scope.items = [];
    var noti = {};
    $scope.limiteconfirmacao ={};
    $scope.fim = {};
    $scope.dia = {};
    $scope.pushnoti = {};
    //console.log($scope.aux.iduser);

    if ($scope.evento.estado == 1 || $scope.evento.estado == 5) {
      console.log('éstado 1');
      $scope.EditEvento = false;
      $scope.repete = true;
      $scope.desisti = false;
    }else{
       console.log('éstado 0');
      $scope.EditEvento = true;
          $scope.repete = false;
    }
    if($scope.evento.genero == "masc"){
      $scope.masc = true;
      $scope.fem = false;
    }
    if($scope.evento.genero == "fem"){
        $scope.fem = true;
        $scope.masc = false;
    }
    if($scope.evento.genero == "todos"){
        $scope.fem = false;
        $scope.masc = false;
    }
    if($scope.evento.preco == 0 || $scope.evento.preco =="Gratuito"){
      $scope.evento.preco = "Gratuito";
      $scope.porpessoa = false;
      $scope.porlocal = false;
    }else{
      if($scope.evento.precopor == 1){
        $scope.porpessoa = true;
        $scope.porlocal = false;
      }else{
        $scope.porpessoa = false;
        $scope.porlocal = true;
      }
    }
    
    EventoService.GetParticipantes($scope.evento.idevento).then(function(items) {
      $scope.nomeevento = items[0].nomeevento;
       for (var i = 0; i < items.length; i++) {
        if(items[i].iduser == $scope.aux.iduser){
                    if(items[i].estado =='9'){
                     $scope.ocultabotao = false;
                    }else{
                      $scope.ocultabotao = true;
                    }
                  }
        if ($scope.aux.iduser != items[i].iduser) {
          $scope.nuser++;
        }
        if (items[i].estado == 0) {
          items[i].confirmacao = 'Sou o organizador';
        }
        if (items[i].estado == 1) {
          items[i].confirmacao = 'Aguardando confirmação';
        }
        if (items[i].estado == 2) {
          items[i].confirmacao = 'Confirmação aprovada';
        }
        if(items[i].borda == 0){
            items[i].bb = false;
            items[i].bs = false;
            items[i].bg = false;
          }
          if(items[i].borda == 1){
            items[i].bb = true;
            items[i].bs = false;
            items[i].bg = false;
          }
          if(items[i].borda == 2){
            items[i].bb = false;
            items[i].bs = true;
            items[i].bg = false;
          }
          if(items[i].borda == 3){
            items[i].bb = false;
            items[i].bs = false;
            items[i].bg = true;
          }
          if((items[i].profilepic[8] == 's' && items[i].profilepic[9] == '3')||(items[i].profilepic[8] == 'd' && items[i].profilepic[9] == 'i')){
          //if(items[i].profilepic[8] == 's' && items[i].profilepic[9] == '3'){
             items[i].profilepic=items[i].profilepic+"?{{getTimeStamp()}}";
           }else{
             items[i].profilepic=items[i].profilepic;
           }
          //items[i].profilepic = items[i].profilepic+"?{{getTimeStamp()}}";
      }
      $scope.items = items.concat($scope.items);
    });
    
    $scope.tag = '';

    var hj = new Date();
    var currentdate = new Date(); 
    var curr_date = (currentdate.getDate()<10?'0':'') + currentdate.getDate();
    var curr_month = (currentdate.getMonth()<10?'0':'') + (currentdate.getMonth() + 1); //Months are zero based
    var curr_year = currentdate.getFullYear();
    var h2 = (currentdate.getHours()<10?'0':'') + currentdate.getHours();
    var m2 = (currentdate.getMinutes()<10?'0':'') + currentdate.getMinutes();
    
    hj = $scope.evento.diainicio;
    
    var ano = (hj[0]+hj[1]+hj[2]+hj[3]).valueOf()-curr_year;
    var mes = (hj[5]+hj[6]).valueOf()-curr_month;
    var dia = (hj[8]+hj[9]).valueOf()-curr_date;
    var h = (hj[11]+hj[12]).valueOf()-h2;
    var m = (hj[14]+hj[15]).valueOf()-m2;
    
    //$scope.dia = (hj[8]+hj[9]).valueOf()+'/'+(hj[5]+hj[6]).valueOf()+'/'+(hj[0]+hj[1]+hj[2]+hj[3])+' '+(hj[11]+hj[12]).valueOf()+':'+(hj[14]+hj[15]).valueOf();

    var  hjl = $scope.evento.dialimiteconfirmacao;
    var anol = (hjl[0]+hjl[1]+hjl[2]+hjl[3]).valueOf()-curr_year;
    var mesl = (hjl[5]+hjl[6]).valueOf()-curr_month;
    var dial = (hjl[8]+hjl[9]).valueOf()-curr_date;
    var hl = (hjl[11]+hjl[12]).valueOf()-h2;
    var ml = (hjl[14]+hjl[15]).valueOf()-m2;

    $scope.dialimiteconfirmacao =  (hjl[8]+hjl[9]).valueOf()+'/'+(hjl[5]+hjl[6]).valueOf()+'/'+(hjl[0]+hjl[1]+hjl[2]+hjl[3])+' '+(hjl[11]+hjl[12]).valueOf()+':'+(hjl[14]+hjl[15]).valueOf();
  
    var hjd = $scope.evento.duracao;
    var hd = (hjd[0]+hjd[1]).valueOf();
    var md = (hjd[3]+hjd[4]).valueOf();
    $scope.duracao= hd+':'+md;

    var  hjl = $scope.evento.dialimiteconfirmacao;
    $scope.limiteconfirmacao.dia =  (hjl[8]+hjl[9]).valueOf()+'/'+(hjl[5]+hjl[6]).valueOf();
    $scope.limiteconfirmacao.hora =  (hjl[11]+hjl[12]).valueOf()+':'+(hjl[14]+hjl[15]).valueOf();  
    
    

    var hjf = $scope.evento.diafim;
    $scope.fim.dia =  (hjf[8]+hjf[9]).valueOf()+'/'+(hjf[5]+hjf[6]).valueOf()+'/'+(hjf[0]+hjf[1]+hjf[2]+hjf[3]);
    $scope.fim.hora = (hjf[11]+hjf[12]).valueOf()+':'+(hjf[14]+hjf[15]).valueOf();
    $scope.dia.dia = (hj[8]+hj[9]).valueOf()+'/'+(hj[5]+hj[6]).valueOf();
    $scope.dia.hora = (hj[11]+hj[12]).valueOf()+':'+(hj[14]+hj[15]).valueOf() +' - '+(hjf[11]+hjf[12]).valueOf()+':'+(hjf[14]+hjf[15]).valueOf() ;


    $scope.diafim =  (hjf[8]+hjf[9]).valueOf()+'/'+(hjf[5]+hjf[6]).valueOf()+'/'+(hjf[0]+hjf[1]+hjf[2]+hjf[3])+' '+(hjf[11]+hjf[12]).valueOf()+':'+(hjf[14]+hjf[15]).valueOf();
    

     EventoService.Gettags($scope.evento.idevento).then(function(tags) {
        for(var  i =0; i< tags.length;i++){
          $scope.tag = ($scope.tag + ' ' + tags[i].tag);
        } 
     });



    var zone;

          // YELLOW ZONE qualquer pessoa confirmada por confirmar a pessoa que nao foi confirmada
    if(anol == 0 && mesl == 0 && dial == 0 && ((hl == 1 && ml<30 && ml>0)||(hl==0 && ml > 30)|| (hl==1 && ml>-30))){
      console.log('YELLOW-ZONE');
       $scope.EditEvento =true;
       zone = 'yellow';
    }
          // RED ZONE 
    if(anol<0 || mesl < 0 ||(anol == 0 && mesl == 0 && (dial < 0 || (dial==0 && ((hl == 0 && ml<=0)||(hl < 0)))))){
      console.log('RED-ZONE');
      $scope.EditEvento =false;
      zone = 'red';
    }
    if((anol == 0 && mesl <= 0 && dial < -1 )||(ano<0)){
      console.log('BLACK-ZONE');
      $scope.EditEvento =false;
      zone = 'black';
    }

    $scope.$on("$ionicView.enter", function(event, data){
      //$scope.evento = formItem.getForm();
      $scope.evento = formEventoPerfil.getForm();
      
      $scope.tag = '';
      $scope.pushnoti = {};
      EventoService.Gettags($scope.evento.idevento).then(function(tags) {
        for(var  i =0; i< tags.length;i++){
          $scope.tag = ($scope.tag + ' ' + tags[i].tag);
        } 
      });

      var hj = new Date();
      var currentdate = new Date(); 
      var curr_date = (currentdate.getDate()<10?'0':'') + currentdate.getDate();
      var curr_month = (currentdate.getMonth()<10?'0':'') + (currentdate.getMonth() + 1); //Months are zero based
      var curr_year = currentdate.getFullYear();
      var h2 = (currentdate.getHours()<10?'0':'') + currentdate.getHours();
      var m2 = (currentdate.getMinutes()<10?'0':'') + currentdate.getMinutes();
      
      hj = $scope.evento.diainicio;
      
      var ano = (hj[0]+hj[1]+hj[2]+hj[3]).valueOf()-curr_year;
      var mes = (hj[5]+hj[6]).valueOf()-curr_month;
      var dia = (hj[8]+hj[9]).valueOf()-curr_date;
      var h = (hj[11]+hj[12]).valueOf()-h2;
      var m = (hj[14]+hj[15]).valueOf()-m2;
      
      //$scope.dia = (hj[8]+hj[9]).valueOf()+'/'+(hj[5]+hj[6]).valueOf()+'/'+(hj[0]+hj[1]+hj[2]+hj[3])+' '+(hj[11]+hj[12]).valueOf()+':'+(hj[14]+hj[15]).valueOf();

      var  hjl = $scope.evento.dialimiteconfirmacao;
      var anol = (hjl[0]+hjl[1]+hjl[2]+hjl[3]).valueOf()-curr_year;
      var mesl = (hjl[5]+hjl[6]).valueOf()-curr_month;
      var dial = (hjl[8]+hjl[9]).valueOf()-curr_date;
      var hl = (hjl[11]+hjl[12]).valueOf()-h2;
      var ml = (hjl[14]+hjl[15]).valueOf()-m2;

      $scope.dialimiteconfirmacao =  (hjl[8]+hjl[9]).valueOf()+'/'+(hjl[5]+hjl[6]).valueOf()+'/'+(hjl[0]+hjl[1]+hjl[2]+hjl[3])+' '+(hjl[11]+hjl[12]).valueOf()+':'+(hjl[14]+hjl[15]).valueOf();
    
      var hjf = $scope.evento.diafim;

      $scope.diafim =  (hjf[8]+hjf[9]).valueOf()+'/'+(hjf[5]+hjf[6]).valueOf()+'/'+(hjf[0]+hjf[1]+hjf[2]+hjf[3])+' '+(hjf[11]+hjf[12]).valueOf()+':'+(hjf[14]+hjf[15]).valueOf();
      var hjd = $scope.evento.duracao;
      var hd = (hjd[0]+hjd[1]).valueOf();
      var md = (hjd[3]+hjd[4]).valueOf();
      $scope.duracao= hd+':'+md;

      var  hjl = $scope.evento.dialimiteconfirmacao;
      $scope.limiteconfirmacao.dia =  (hjl[8]+hjl[9]).valueOf()+'/'+(hjl[5]+hjl[6]).valueOf();
      $scope.limiteconfirmacao.hora =  (hjl[11]+hjl[12]).valueOf()+':'+(hjl[14]+hjl[15]).valueOf();  
      
      

      var hjf = $scope.evento.diafim;
      $scope.fim.dia =  (hjf[8]+hjf[9]).valueOf()+'/'+(hjf[5]+hjf[6]).valueOf()+'/'+(hjf[0]+hjf[1]+hjf[2]+hjf[3]);
      $scope.fim.hora = (hjf[11]+hjf[12]).valueOf()+':'+(hjf[14]+hjf[15]).valueOf();
      $scope.dia.dia = (hj[8]+hj[9]).valueOf()+'/'+(hj[5]+hj[6]).valueOf();
      $scope.dia.hora = (hj[11]+hj[12]).valueOf()+':'+(hj[14]+hj[15]).valueOf() +' - '+(hjf[11]+hjf[12]).valueOf()+':'+(hjf[14]+hjf[15]).valueOf() ;


      var zone;
          // YELLOW ZONE qualquer pessoa confirmada por confirmar a pessoa que nao foi confirmada
      if(anol == 0 && mesl == 0 && dial == 0 && ((hl == 1 && ml<30 && ml>0)||(hl==0 && ml > 30)|| (hl==1 && ml>-30))){
        console.log('YELLOW-ZONE');
         $scope.EditEvento =true;
         zone = 'yellow';
      }
            // RED ZONE 
      if(anol<0 || mesl < 0 ||(anol == 0 && mesl == 0 && (dial < 0 || (dial==0 && ((hl == 0 && ml<=0)||(hl < 0)))))){
        console.log('RED-ZONE');
        $scope.EditEvento =false;
        zone = 'red';
      }
      if((anol == 0 && mesl <= 0 && dial < -1 )||(ano<0)){
      console.log('BLACK-ZONE');
      $scope.EditEvento =false;
      zone = 'black';
    }

    });
    
    // $scope.Ocultar =  function(evento){
    //   $scope.ocultabotao = false;
    //   $http.post("https://ec2.diwoapp.com.br/ocultarpessoaevento.php", {idevento : evento.idevento,
    //                                                                       iduser: $scope.aux.iduser,
    //                                                                       estado : 9});
    //   $http.post("https://ec2.diwoapp.com.br/ocultarevento.php", {idevento : evento.idevento,
    //                                                                  estado : 6});
    // }
    // $scope.DESOcultar =  function(evento){
    //   $scope.ocultabotao = true;
    //   $http.post("https://ec2.diwoapp.com.br/ocultarpessoaevento.php", {idevento : evento.idevento,
    //                                                                       iduser: $scope.aux.iduser,
    //                                                                       estado : 3});
    //   if(zone == 'black' ){
    //     $http.post("https://ec2.diwoapp.com.br/ocultarevento.php", {idevento : evento.idevento,
    //                                                                  estado : 5});
    //   }else{
    //     $http.post("https://ec2.diwoapp.com.br/ocultarevento.php", {idevento : evento.idevento,
    //                                                                  estado : 0});
    //   }
      
    // }
    //     });
    $scope.desistir = function(){
      if(zone == 'red' || zone == 'yellow'){
                          if(zone == 'red' ){
                             var myPopup = $ionicPopup.show({
                                template: '<input type="text" placeholder="Escreva aqui pq nao vai rolar" ng-model="data.desculpa">',
                                title: 'ATENÇÃOOOO!!!',
                                subTitle: 'Você esta preste a cancelar seu evento faltando muito pouco para seu começo, tens certeza disso?. Se tu realmente cancelar estaremos te dando um cartão vermelho. Para saber mais sobre eles va no seu indice de confirmação',
                                scope: $scope,
                                buttons: [
                                  { text: 'Não' },
                                  {
                                    text: '<b>Sim</b>',
                                    type: 'button-positive',
                                    onTap: function(e) {
                                      // console.log($scope.items.length);
                                       var notifica = ("Desisti de fazer o evento, " + $scope.data.desculpa);
                                        $http.post('https://ec2.diwoapp.com.br/deletanotificacaoporevento.php' , {idevento : $scope.evento.idevento,
                                                                                                    nomeevento : $scope.evento.nomeevento}).then(function(response) {console.log(response, 'deleta')});
                                     
                                   for (var i = 0; i < $scope.items.length; i++) {
                                    if ($scope.aux.iduser != $scope.items[i].iduser) {
                                          noti.recebeusername = $scope.items[i].username;
                                          noti.recebe = $scope.items[i].iduser;
                                          noti.envia = $scope.aux.iduser;
                                          noti.tipo = 4;
                                          noti.nomeevento = $scope.evento.nomeevento;
                                         console.log('enviando msg', $scope.evento.idevento,noti.envia, noti.recebe, noti.nomeevento, notifica)
                                        
                                            $http.post('https://ec2.diwoapp.com.br/notificapessoa.php', {notificacao : notifica, 
                                                    idevento : $scope.evento.idevento,
                                                    nomeevento : $scope.evento.nomeevento,
                                                    id_user_envia : $scope.aux.iduser,
                                                    username_envia : $scope.aux.username,
                                                    apelido_envia : $scope.aux.apelido,
                                                    tipo : '5',   
                                                    id_user_recebe : noti.recebe}).then(function (res){
                                                   $scope.response = res.data;
                                                   console.log($scope.response.msg)
                                                 });
                                            EventoService.getusuario2(noti.recebeusername).then(function(user) {
                                              if(user.notiparticipando== '1'){
                                              $scope.pushnoti.titulo = $scope.evento.nomeevento + ' Cancelado';
                                              $scope.pushnoti.msg = notifica;
                                              $scope.pushnoti.token = user.devicetoken;
                                               EventoService.MandaPushNoti($scope.pushnoti);
                                             }
                                            });
                                    }
                                  }

                                      for(var i = 0; i< $scope.items.length; i++){
                      
                                        
                                        $http.post('https://ec2.diwoapp.com.br/deletapessoaevento.php', {iduser : $scope.items[i].iduser,
                                                                                                           idevento : $scope.evento.idevento});
                                      }

                                         $http.post('https://ec2.diwoapp.com.br/penalidade.php', {iduser : $scope.aux.iduser,
                                                                                                     idevento : $scope.evento.idevento,
                                                                                                     username : $scope.aux.username,
                                                                                                     tipopenalidade : '2'});     // tipo2 saiu na redzone         
                                       $scope.evento.estado = "3";
                                       $scope.evento.datamodificacao = new Date();                
                                     EventoService.atualizarevento($scope.evento);
                                                          $state.go('tabsController.perfil');
                                                          }
                                  }]
                                 });

                                      console.log('criador do evento cancelando proprio evento');
                       }else{
                             var myPopup = $ionicPopup.show({
                                template: '<input type="text" placeholder="Escreva aqui pq nao vai rolar" ng-model="data.desculpa">',
                                title: 'ATENÇÃO!!!',
                                subTitle: 'Você esta preste a cancelar seu evento faltando pouco para seu começo, tens certeza disso?. Se tu realmente cancelar estaremos te dando um cartão amarelo. Para saber mais sobre eles va no seu indice de confirmação',
                                scope: $scope,
                                buttons: [
                                  { text: 'Não' },
                                  {
                                    text: '<b>Sim</b>',
                                    type: 'button-positive',
                                    onTap: function(e) {
                                      // console.log($scope.items.length);
                                       var notifica = ("Desisti de fazer o evento, " + $scope.data.desculpa);
                                      // console.log(notifica);
                                      // console.log($scope.aux.iduser);
                                     $http.post('https://ec2.diwoapp.com.br/deletanotificacaoporevento.php' , {idevento : $scope.evento.idevento,
                                                                                                    nomeevento : $scope.evento.nomeevento}).then(function(response) {console.log(response, 'deleta')});
                                      EventoService.GetParticipantes($scope.evento.idevento).then(function(ppl) {
                                   for (var i = 0; i < ppl.length; i++) {
                                    if ($scope.aux.iduser != ppl[i].iduser) {
                                          noti.recebeusername = ppl[i].username;
                                          noti.recebe = ppl[i].iduser;
                                          noti.envia = $scope.aux.iduser;
                                          noti.tipo = 4;
                                          noti.nomeevento = $scope.evento.nomeevento;
                                          EventoService.VerificaNotificacao(noti).then(function(res) {
                                            console.log(res);
                                            if(res){
                                            $http.post('https://ec2.diwoapp.com.br/notificapessoa.php', {notificacao : notifica, 
                                                    idevento : $scope.evento.idevento,
                                                    nomeevento : $scope.evento.nomeevento,
                                                    id_user_envia : $scope.aux.iduser,
                                                    username_envia : $scope.aux.username,
                                                    apelido_envia : $scope.aux.apelido,
                                                    tipo : '5',   
                                                    id_user_recebe : noti.recebe}).then(function (res){
                                                   $scope.response = res.data;
                                                   console.log($scope.response.msg)
                                                 });
                                            EventoService.getusuario2(noti.recebeusername).then(function(user) {
                                              if(user.notiparticipando== '1'){
                                              $scope.pushnoti.titulo = $scope.evento.nomeevento + ' Cancelado';
                                              $scope.pushnoti.msg = notifica;
                                              $scope.pushnoti.token = user.devicetoken;
                                               EventoService.MandaPushNoti($scope.pushnoti);
                                             }
                                            });
                                    }
                                  });
                                        }
                                  }
                                 })
                                      for(var i = 0; i< $scope.items.length; i++){
                               
                                        
                                        $http.post('https://ec2.diwoapp.com.br/deletapessoaevento.php', {iduser : $scope.items[i].iduser,
                                                                                                           idevento : $scope.evento.idevento});
                                      }
                                       $http.post('https://ec2.diwoapp.com.br/penalidade.php', {iduser : $scope.aux.iduser,
                                                                                                     idevento : $scope.evento.idevento,
                                                                                                     username : $scope.aux.username,
                                                                                                     tipopenalidade : '1'});   // tipo 1 saiu na yellow zone               
                                       $scope.evento.estado = "3";
                                       $scope.evento.datamodificacao = new Date();                
                                     EventoService.atualizarevento($scope.evento);
                                                          $state.go('tabsController.perfil');
                                                          }
                                  }]
                                 });

                                      console.log('criador do evento cancelando proprio evento');
                       }
        }else{
           var myPopup = $ionicPopup.show({
                  template: '<input type="text" placeholder="Escreva aqui pq nao vai rolar" ng-model="data.desculpa">',
                  title: 'ATENÇÃO!!!',
                  subTitle: 'Você esta preste a deletar seu evento, tens certeza disso?',
                  scope: $scope,
                  buttons: [
                    { text: 'Não' },
                    {
                      text: '<b>Sim</b>',
                      type: 'button-positive',
                      onTap: function(e) {
                        // console.log($scope.items.length);
                         var notifica = ("Desisti de fazer o evento, " + $scope.data.desculpa);
                        // console.log(notifica);
                        // console.log($scope.aux.iduser);
                     $http.post('https://ec2.diwoapp.com.br/deletanotificacaoporevento.php' , {idevento : $scope.evento.idevento,
                                                                                                    nomeevento : $scope.evento.nomeevento}).then(function(response) {console.log(response, 'deleta')});
                                   EventoService.GetParticipantes($scope.evento.idevento).then(function(ppl) {
                                   for (var i = 0; i < ppl.length; i++) {
                                    if ($scope.aux.iduser != ppl[i].iduser) {
                                          noti.recebeusername = ppl[i].username
                                          noti.recebe = ppl[i].iduser;
                                          noti.envia = $scope.aux.iduser;
                                          noti.tipo = 4;
                                          noti.nomeevento = $scope.evento.nomeevento;
                                          EventoService.VerificaNotificacao(noti).then(function(res) {
                                            console.log(res);
                                            if(res){
                                              $http.post('https://ec2.diwoapp.com.br/notificapessoa.php', {notificacao : notifica, 
                                                      idevento : $scope.evento.idevento,
                                                      nomeevento : $scope.evento.nomeevento,
                                                      id_user_envia : $scope.aux.iduser,
                                                      username_envia : $scope.aux.username,
                                                      apelido_envia : $scope.aux.apelido,
                                                      tipo : '5',   
                                                      id_user_recebe : noti.recebe}).then(function (res){
                                                     $scope.response = res.data;
                                                     console.log($scope.response.msg)
                                                   });
                                              EventoService.getusuario2(noti.recebeusername).then(function(user) {
                                                if(user.notiparticipando== '1'){
                                                $scope.pushnoti.titulo = $scope.evento.nomeevento + ' Cancelado';
                                                $scope.pushnoti.msg = notifica;
                                                $scope.pushnoti.token = user.devicetoken;
                                                 EventoService.MandaPushNoti($scope.pushnoti);
                                               }
                                              });
                                            }
                                          });
                                        }
                                  }
                                 })
                        for(var i = 0; i< $scope.items.length; i++){
            
                          $http.post('https://ec2.diwoapp.com.br/deletapessoaevento.php', {iduser : $scope.items[i].iduser,
                                                                                             idevento : $scope.evento.idevento});
                        }
                                        
                         $scope.evento.estado = "3";
                         $scope.evento.datamodificacao = new Date();                
                       EventoService.atualizarevento($scope.evento);
                                            $state.go('tabsController.perfil');
                                            }
                    }]
                   });
        }

    }

    $scope.editar = function(){
      formEditar.updateForm(1);
      formEventoEditaperfil.updateForm($scope.evento)
      $state.go('tabsController.repeteEventoPart1');
    }


    $scope.enterItem =  function(item){
      formOutro.updateForm(item);
      //console.log(item.iduser);
      $state.go('tabsController.perfil_outro_evento_criados');
    }

}])

.controller('eventoConvidadoCtrl', ['$scope', '$stateParams', 'formItem', 'formUser', 'formtelaCriar', 'formOutro', '$http', '$timeout','$ionicPopup', 'EventoService', '$state','$cordovaSocialSharing', '$ionicTabsDelegate', 'formEventoEditahome','formvimdofiltroperfil', 'formLimiteatuacao','formvimdopost',// The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, formItem, formUser, formtelaCriar, formOutro, $http, $timeout, $ionicPopup, EventoService, $state, $cordovaSocialSharing, $ionicTabsDelegate, formEventoEditahome, formvimdofiltroperfil, formLimiteatuacao, formvimdopost) {
  // $scope.user  = formUser.getForm();
  // $scope.aux = {};
  // $scope.aux.iduser = $scope.user.iduser;
  // $scope.aux.lat = $scope.user.lat;
  // $scope.aux.lng = $scope.user.long;
  // $scope.aux.idevento = $stateParams.idevento;
  // $scope.listapessoas = {};
  // $scope.auxpne = {};
  // var noti = {};
  // //$scope.item = {};
  // $ionicTabsDelegate.showBar(0);
  // window.localStorage.removeItem('convite2')
  // $scope.naoexistemais = false;
  // $scope.naomostrabotton = false;
  // $scope.naomostrafav = false;
  $scope.$on('$destroy', function() {
     window.localStorage.removeItem('convite2')
     $scope.item = {};
  });
  $scope.$on("$ionicView.enter", function(event, data){
    $scope.user  = formUser.getForm();
    $scope.aux = {};
    $scope.aux.iduser = $scope.user.iduser;
    $scope.aux.lat = $scope.user.lat;
    $scope.aux.lng = $scope.user.long;
    $scope.aux.idevento = $stateParams.idevento;
    $scope.listapessoas = {};
    $scope.auxpne = {};
    var noti = {};
    $scope.item = {};
    $scope.evento = {};
    $ionicTabsDelegate.showBar(0);
    
    $scope.naoexistemais = false;
    $scope.naomostrabotton = false;
    $scope.naomostrafav = false;
    //$scope.convidado2 =  window.localStorage.getItem( 'convite2' );
    
    // if(!$scope.convidado2){
    //     //alert("$scope.convidado2")
    //     $state.go('tabsController.home');
    // }else{
      EventoService.GetPessoanaoeventoidevento($scope.aux).then(function (pessoanaoevento){
        $scope.auxpne = pessoanaoevento[pessoanaoevento.length-1];
        console.log(pessoanaoevento.length,"pessoanaoevento.lengh", pessoanaoevento)
        if (pessoanaoevento !='E') {
          
          console.log($scope.auxpne.estado)
          if($scope.auxpne.estado == '10'){
            $scope.naomostrabotton = true;
            $scope.naomostrafav = true;
          }
          // if(pessoanaoevento.estado == '11'){
            
          // }
          if( $scope.auxpne.estado == '13'){
            $scope.naomostrafav = true;
          }
        }
      });
      EventoService.Geteventoconvidado($scope.aux).then(function (evento){
        console.log(evento, "ENTOOOO")
        if (evento !='E' &&evento !='Error') { 
          $scope.item = evento;
          $scope.evento = $scope.item;
          if($scope.item.adm == $scope.user.iduser){
            $scope.naomostrabotton = true;
            $scope.naomostrafav = true;
          }
          EventoService.GetParticipantes($scope.item.idevento).then(function(listapessoas) {
             console.log(listapessoas[0].iduser, "bug dentro")
                for (var i = 0; i < listapessoas.length; i++) {
                  if (listapessoas[i].estado == 0) {
                    listapessoas[i].confirmacao = 'Oi, sou o organizador';
                    $scope.criador = listapessoas[i].iduser;
                  }
                  if (listapessoas[i].estado == 1) {
                    listapessoas[i].confirmacao = 'E eu aguardando confirmação';
                  }
                  if (listapessoas[i].estado == 2) {
                    listapessoas[i].confirmacao = 'To confirmado!!';
                  }
                  if(listapessoas[i].borda == 0){
                      listapessoas[i].bb = false;
                      listapessoas[i].bs = false;
                      listapessoas[i].bg = false;
                    }
                    if(listapessoas[i].borda == 1){
                      listapessoas[i].bb = true;
                      listapessoas[i].bs = false;
                      listapessoas[i].bg = false;
                    }
                    if(listapessoas[i].borda == 2){
                      listapessoas[i].bb = false;
                      listapessoas[i].bs = true;
                      listapessoas[i].bg = false;
                    }
                    if(listapessoas[i].borda == 3){
                      listapessoas[i].bb = false;
                      listapessoas[i].bs = false;
                      listapessoas[i].bg = true;
                    }
                    if((listapessoas[i].profilepic[8] == 's' && listapessoas[i].profilepic[9] == '3')||(listapessoas[i].profilepic[8] == 'd' && listapessoas[i].profilepic[9] == 'i')){
    
                    //if(listapessoas[i].profilepic[8] == 's' && listapessoas[i].profilepic[9] == '3'){
                       listapessoas[i].profilepic=listapessoas[i].profilepic+"?{{getTimeStamp()}}";
                     }else{
                       listapessoas[i].profilepic=listapessoas[i].profilepic;
                     }

                }
                 if($scope.item.tipodeevento ){
                  console.log("patrocinadoffff")
                  $scope.item.patrocinado = true;
                  //$scope.item.styleItemCaixa = "background-color: #212121;color: white;box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.3);border: 4px dotted #ffdb29;";
                  //$scope.evento.styleItemCaixa = "background-color: #212121;color: white;box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.3);border: 4px dotted #ff9008;";
                  $scope.item.styleItemCaixa = "background-color: #212121;color: white;box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.3);outline: 3px dotted #ff4c42;outline-offset: -4px;padding: 5px; margin-top:7px;";
                  //$scope.evento.styleItemCaixa = "background-color: #212121;color: white;box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.3);border: 4px dotted #f9bdff;";
                  //$scope.evento.styleItem = "background-color: #212121;color: white;box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.3);border: 4px dotted #00FFFF;";

                  document.getElementById("eventoConvidado").style.backgroundImage = "url('img/background_patrocinado.jpg')"
                }else{
                  $scope.item.styleItemCaixa = "background-color: #212121;padding: 5px;"
                  $scope.item.patrocinado = false;
                  document.getElementById("eventoConvidado").style.backgroundColor = "#212121"
                }
                $scope.listapessoas = listapessoas;
          });
           if(parseInt($scope.evento.pmin)>parseInt($scope.evento.patual)){
              $scope.menorqpmin = true;
              $scope.nopmin = false;
              $scope.entre = false;
              $scope.cheio = false;
            }
            if(parseInt($scope.evento.pmin)==parseInt($scope.evento.patual)){
              $scope.menorqpmin = false;
              $scope.nopmin = true;
              $scope.entre = false;
              $scope.cheio = false;
            }

            if(parseInt($scope.evento.pmin)<parseInt($scope.evento.patual) && parseInt($scope.evento.pmax)>parseInt($scope.evento.patual)){
              $scope.menorqpmin = false;
              $scope.nopmin = false;
              $scope.entre = true;
              $scope.cheio = false;
              console.log("nao cheio")
            }
            if(parseInt($scope.evento.pmin)<parseInt($scope.evento.patual) && parseInt($scope.evento.pmax)<=parseInt($scope.evento.patual)){
              $scope.menorqpmin = false;
              $scope.nopmin = false;
              $scope.entre = false;
              $scope.cheio = true;
              console.log(" cheio", $scope.evento.pmin.valueOf() , $scope.evento.patual.valueOf(), $scope.evento.pmax.valueOf())
            }
        }else{
          $scope.naoexistemais= true;
        }
        window.localStorage.removeItem('convite2')
        console.log($scope.naoexistemais, "$scope.naoexistemais$scope.naoexistemais$scope.naoexistemais")
      });
      
   // }
    
  
  });
  
  $scope.Vermapa = function(){
    formItem.updateForm($scope.item)
    $state.go('tabsController.ver_onde_mapa');
  }
  $scope.share = function(t, msg, img, link){ 
    //console.log($scope.evento.diainicio)
    $scope.msgshare = "Olha o que achei: " + $scope.evento.nomeevento + ' ' +$scope.evento.diainicio[8]+$scope.evento.diainicio[9]+'/'+ +$scope.evento.diainicio[5]+$scope.evento.diainicio[6] + ' bora?';
    $scope.linkevento = "https://ec2.diwoapp.com.br/pageteste.html?idevento="+$scope.evento.idevento;
     console.log($scope.msgshare)
      if(t == 'w')
        $cordovaSocialSharing.canShareVia('whatsapp', $scope.msgshare, '', 'http://diwoapp.com.br/politica-de-privacidade/').then(function(result) {
          $cordovaSocialSharing.shareViaWhatsApp($scope.msgshare, '' , $scope.linkevento) ;
          }, function(error) {
              alert("Cannot share on whatsapp");
          });
      else if(t == 'f')
        $cordovaSocialSharing.canShareVia('facebook', $scope.msgshare, '', 'http://diwoapp.com.br/politica-de-privacidade/').then(function(result) {
              $cordovaSocialSharing.shareViaFacebook( $scope.msgshare, '', $scope.linkevento);
          }, function(error) {
              alert("Cannot share on whatsapp");
          });

      else if(t == 't')
          $cordovaSocialSharing.canShareVia('twitter', $scope.msgshare, '', 'http://diwoapp.com.br/politica-de-privacidade/').then(function(result) {
              $cordovaSocialSharing.shareViaTwitter( + $scope.msgshare, '',  $scope.linkevento);
          }, function(error) {
              alert("Cannot share on whatsapp");
          }); 
  }                  
  $scope.chamamos = function(){  
    $scope.carinha = '';
    $ionicPopup.prompt({
        title: 'Ajude um amigo',
        template: 'Ajude um amigo(a) que amaria esse evento a fazer parte dele também! Com um amigo é sempre mais seguro.Nós enviaremos um meme, poema ou áudio convidando ele(a) por você. Só precisamos do “@”, email ou telefone dela e voilá :)',
       inputType: 'text',
       inputPlaceholder: '@insta ou numero pra whats ou email'
     }).then(function(contato) {
      if(contato){
        if(contato!= ''){
          $scope.carinha = $scope.aux.iduser + " " +$scope.aux.username + " quer convidar: " + contato + " no evento id:" + $scope.evento.idevento + " nome do evento: " + $scope.evento.nomeevento;
          $http.post('https://ec2.diwoapp.com.br/pedeconvite.php', {namereportado : $scope.evento.nomeevento,
                                                                                    usernamereportando : contato,
                                                                                    tiporeport : 'Convide meu amigo',
                                                                                    motivo : $scope.carinha}).then(function (tes){
            if(tes.data.success == true){
              var alertPopup = $ionicPopup.alert({
                title: 'Pronto!',
                template: 'Convidaremos ele de uma das formas, obrigado!!'
              });
              alertPopup.then(function(){
                EventoService.ConvidarPessoaevento($scope.helppp).then(function(convite) {
                  if(convite){
                    $scope.convidar = false;
                  }
                });
              });
            }else{
              var alertPopup = $ionicPopup.alert({
                title: 'Vish',
                template: 'Ocorreu uma falha!!'
              });
            }
          });
        }
        console.log($scope.carinha)
      }
    }); 
  }
  $scope.reportar = function(){
    $scope.reportmsg = '';
    //console.log($scope.evento.admusername);
    $scope.report = [
      { text: "Conteúdo impróprio", checked: false },
      { text: "Linguajar inadequado", checked: false },
      { text: "Discurso de ódio", checked: false },
      { text: "Imagem imprópria", checked: false },
      { text: "Substancias ilicitas ", checked: false }
    ];
    $ionicPopup.confirm({
        title: 'Você quer reportar esse evento pq?',
        content: '<ion-checkbox ng-repeat="item in report" style="color: #FCFCFC;" ng-model="item.checked"  ng-checked="item.checked">{{item.text}}</ion-checkbox>',
        scope: $scope
    }).then(function(res) {
        if(res) {
          for (var h=0;h<3;h++){
            //console.log($scope.report[h].checked , h);
            if($scope.report[h].checked){
              $scope.reportmsg = $scope.reportmsg + $scope.report[h].text + ' ';
              //console.log($scope.reportmsg);
            }
          }
          if(h==3){
            console.log($scope.reportmsg);
            $http.post('https://ec2.diwoapp.com.br/reportaevento.php', {namereportado : $scope.evento.admusername,
                                                                            reportadoid : $scope.evento.idevento,
                                                                            iduserreportando : $scope.user.iduser,
                                                                            usernamereportando : $scope.user.username,
                                                                            tiporeport : 'evento',
                                                                            motivo : $scope.reportmsg}).then(function (tes){
              $scope.response = tes.data;
              var alertPopup = $ionicPopup.alert({
                                        title: 'Obrigado',
                                        template: 'Este evento esta agora sobre avaliação, obrigado por manter a plataforma organizada'
              });
            });
          }
        }
    });
  }

  $scope.enterPessoa =  function(item){
    formOutro.updateForm(item);
    console.log(item.iduser, "enterPessoa");
    formvimdofiltroperfil.updateForm(false);
    $state.go('tabsController.perfilOutro');
  }
  
  $scope.naoir = function() {
    $http.post('https://ec2.diwoapp.com.br/pessoanaoevento.php', {iduser : $scope.user.iduser, 
                                                                  idevento : $scope.evento.idevento,
                                                                  nomeevento : $scope.evento.nomeevento,
                                                                  estado : '11'}).then(function(resp){//nao aparece mais no feed da pessoa o evento
      $http.post('https://ec2.diwoapp.com.br/deletapessoaevento.php', {iduser : $scope.user.iduser,
                                                                      idevento : $scope.evento.idevento,
                                                                      estado: '7'});
      $state.go('tabsController.home');                                                          
    });
  }

  $scope.bora = function() {
      var datainvalida = 0;
      EventoService.verificahorariopessoaeventoconfirmados($scope.user).then(function(items) {
        $scope.auxdata = items;
        for(var r = 0;r<$scope.auxdata.length; r++){
          console.log($scope.auxdata[r].idevento, $scope.auxdata[r].diainicio, $scope.auxdata[r].diafim ,$scope.evento.diafim);
          if($scope.evento.idevento!=$scope.auxdata[r].idevento){
            if (($scope.auxdata[r].diainicio < $scope.evento.diainicio && $scope.auxdata[r].diafim > $scope.evento.diainicio) || ($scope.auxdata[r].diainicio<$scope.evento.diafim && $scope.auxdata[r].diafim>$scope.evento.diafim) ||($scope.auxdata[r].diainicio > $scope.evento.diainicio && $scope.auxdata[r].diafim<$scope.evento.diafim) || ($scope.auxdata[r].diainicio < $scope.evento.diainicio && $scope.auxdata[r].diafim>$scope.evento.diafim) ) {
              console.log('horario invalido');
              datainvalida = 1;
            }
          }
        }
      });

      $http.post('https://ec2.diwoapp.com.br/pessoanaoevento.php', {iduser : $scope.user.iduser, 
                                                                    idevento : $scope.evento.idevento,
                                                                    nomeevento : $scope.evento.nomeevento,
                                                                    estado : '10'}).then(function(resp) {//aceitou ir evento, nao mostra mais feed
        if(resp.data.success){
          if($scope.evento.estado == 21){
             var link = 'https://ec2.diwoapp.com.br/irevento.php';
            $http.post(link, {idevento : $scope.evento.idevento, 
                            iduser : $scope.user.iduser,
                            idadm : $scope.user.iduser,
                            admusername : $scope.user.username,  
                            diainicio : $scope.evento.diainicio,
                            diafim : $scope.evento.diafim,
                            username : $scope.user.username,
                            borda : $scope.user.borda,
                            apelido : $scope.user.apelido,
                            profilepic : $scope.user.profilepic,
                            devicetoken : $scope.user.devicetoken,
                            confirmacao : 'Planejando',
                            nomeevento :  'Alguma coisa, ainda não sei', 
                            eventopic : 'img/manha.png', 
                            estado : 21}).then(function (res){
              $scope.response = res.data;
              console.log($scope.response);
              var alertPopup = $ionicPopup.alert({
                title: '(￣▽￣)ノ',
                template: 'Veja nos seus eventos o que estão combinando sobre esse evento.'
              });
            })
          }else{
            if(datainvalida==1){
              var alertPopup = $ionicPopup.alert({
                title: 'ಠ_ಠ',
                template: 'Ja tens um evento marcado nesta data querido'
              });
            }else{
              var noti = {};
              $scope.pushnoti = {};
                    if (!$scope.evento.idevento || !$scope.user.iduser) {
                                    var alertPopup = $ionicPopup.alert({
                                    title: 'Vish deu ruim',
                                    template: 'Favor refaça seu login'
                                  });

                    }else{
                      if($scope.evento.tipodeevento){
                        if($scope.evento.zone == 'yellow'){
                          var confirmPopup = $ionicPopup.show({
                               title: 'ZONA AMARELA',
                               template: 'Evento esta na ZONA AMARELA, caso voce desista uma vez que confirmado a presença tu sofrerás um cartão amarelo. Deseja ir mesmo assim?',
                               buttons: [
                                  { text: 'Não sei se vou',
                                    type: 'button-assertive',
                                    onTap: function(e){
                                      console.log('nada acontece');
                                    }},
                                  {
                                    text: 'Quero ir',
                                    type: 'button-positive',
                                    onTap: function(e){
                                      $scope.confirmacao = 'Confirmação aceita';
                                      $scope.estado = '2';
                            var link = 'https://ec2.diwoapp.com.br/irevento.php';
                            $http.post(link, {idevento : $scope.evento.idevento,
                                            idadm : $scope.evento.adm, 
                                            admusername : $scope.evento.admusername, 
                                            diainicio : $scope.evento.diainicio,
                                            diafim : $scope.evento.diafim,
                                            iduser : $scope.user.iduser,
                                            borda : $scope.user.borda,
                                            username: $scope.user.username,
                                            profilepic : $scope.user.profilepic,
                                            devicetoken : $scope.user.devicetoken,
                                            apelido : $scope.user.apelido,
                                            confirmacao : $scope.confirmacao,
                                            nomeevento :  $scope.evento.nomeevento,
                                            eventopic : $scope.evento.eventopic,
                                            idComercioParceiro : $scope.evento.idComercioParceiro, 
                                            estado : $scope.estado}).then(function (res){
                              $scope.response = res.data;
                             
                              $http.post('https://ec2.diwoapp.com.br/deletapessoaevento.php', {iduser : $scope.user.iduser,
                                                                                          idevento : $scope.evento.idevento,
                                                                                          estado: '5'});
                              if ($scope.response.success == true) {
                                $scope.evento.patual = parseInt($scope.evento.patual)+1;
                                $http.post('https://ec2.diwoapp.com.br/addpessoaevento.php', {idevento : $scope.evento.idevento,
                                                                                patual : $scope.evento.patual});
                                console.log($scope.evento.patual,$scope.evento.pmin , 'Número de pessoas alcançado do evento ')
                                if(parseInt($scope.evento.patual) == parseInt($scope.evento.pmin)){
                                  EventoService.GetUserPorId($scope.evento.idComercioParceiro).then(function(comercio) {
                                    $scope.msgnotiComercio = ('Número mínimo de pessoas alcançado do evento ' + $scope.evento.nomeevento );
                                    noti.recebeusername = comercio.username;
                                    noti.recebe = comercio.idComercioParceiro;
                                    noti.envia = comercio.idComercioParceiro;
                                    noti.tipo = 51;   //evento bateu numero minimo de pessoas para acontecer
                                    noti.nomeevento = $scope.evento.nomeevento;
                                      EventoService.VerificaNotificacao(noti).then(function(res) {
                                      if(res){
                                        $http.post('https://ec2.diwoapp.com.br/notificapessoa.php', {notificacao : $scope.msgnotiComercio, 
                                                      idevento : $scope.evento.idevento,
                                                      nomeevento : $scope.evento.nomeevento,
                                                      id_user_envia : $scope.evento.idComercioParceiro,
                                                      username_envia : $scope.evento.nomeevento,
                                                      apelido_envia : $scope.evento.nomeevento,
                                                      tipo : '51',
                                                      id_user_recebe : $scope.evento.idComercioParceiro});
                                          $scope.pushnoti.titulo =  'Número de pessoas alcançado!' ;
                                          $scope.pushnoti.msg = $scope.msgnotiComercio;
                                          $scope.pushnoti.token = comercio.devicetoken;
                                          EventoService.MandaPushNoti($scope.pushnoti);
                                          $scope.pushnoti.titulo =  'Número de pessoas alcançado!' ;
                                          $scope.pushnoti.msg = $scope.msgnotiComercio;
                                          $scope.pushnoti.token = 'dKpOML7ZLIA:APA91bFhTghUqP4gpCkohaf3h1WzCjDwQTrMg2JbUJjEQ9WegZgXWZQSNWtwoeAIu98bLK6wtSByVo1jluGyPmVmBxrvEWu6sluypuLk6O7F_18Z_e2kko7UQdK16Hu7O4qxsvstCmSI';
                                          EventoService.MandaPushNoti($scope.pushnoti);
                                      }
                                    });
                                  });
                                }
                                $http.post("https://ec2.diwoapp.com.br/deletanotificacaoporids.php", {id_user_recebe : noti.recebe,
                                                                                          id_user_envia: noti.envia,
                                                                                          nomeevento: noti.nomeevento,
                                                                                          tipo : '5'});
                                var alertPopup = $ionicPopup.alert({
                                  title: 'Parabéns',
                                  template: $scope.response.msg
                                });
                                alertPopup.then(function(){
                                  $http.post('https://ec2.diwoapp.com.br/deletapessoaevento.php', {iduser : $scope.user.iduser,
                                                                                          idevento : $scope.evento.idevento,
                                                                                          estado: '7'}).then(function (res){
                                  $scope.response = res.data;
                                  $state.go('tabsController.home'); 
                                  });
                                  
                                });
                                
                              }else{
                                var alertPopup = $ionicPopup.alert({
                                  title: 'Ocorreu uma falha',
                                  template: $scope.response.msg
                                });
                              }
                              console.log($scope.response.msg);
                          });
                                    }}]
                             });
                        }else{
                            $scope.confirmacao = 'Confirmação aceita';
                            $scope.estado = '2';
                            //console.log($scope.evento.idComercioParceiro, "ANSUIDNAIUSnd", $scope.evento.nomeevento);
                            var link = 'https://ec2.diwoapp.com.br/irevento.php';
                            $http.post(link, {idevento : $scope.evento.idevento,
                                            idadm : $scope.evento.adm, 
                                            admusername : $scope.evento.admusername, 
                                            diainicio : $scope.evento.diainicio,
                                            diafim : $scope.evento.diafim,
                                            iduser : $scope.user.iduser,
                                            borda : $scope.user.borda,
                                            username: $scope.user.username,
                                            profilepic : $scope.user.profilepic,
                                            devicetoken : $scope.user.devicetoken,
                                            apelido : $scope.user.apelido,
                                            confirmacao : $scope.confirmacao,
                                            nomeevento :  $scope.evento.nomeevento, 
                                            eventopic : $scope.evento.eventopic,
                                            idComercioParceiro : $scope.evento.idComercioParceiro, 
                                            estado : $scope.estado}).then(function (res){
                              $scope.response = res.data;
                             
                              $http.post('https://ec2.diwoapp.com.br/deletapessoaevento.php', {iduser : $scope.user.iduser,
                                                                                          idevento : $scope.evento.idevento,
                                                                                          estado: '5'});
                              if ($scope.response.success == true) {
                                $scope.evento.patual = parseInt($scope.evento.patual)+1;
                                $http.post('https://ec2.diwoapp.com.br/addpessoaevento.php', {idevento : $scope.evento.idevento,
                                                                                patual : $scope.evento.patual});
                                //console.log($scope.evento.patual,$scope.evento.pmin , 'Número de pessoas alcançado do evento dahushudauhuh')
                                if(parseInt($scope.evento.patual) == parseInt($scope.evento.pmin)){
                                  //console.log("Passou pelo IF", $scope.evento.idComercioParceiro)
                                  EventoService.GetUserPorId($scope.evento.idComercioParceiro).then(function(comercio) {
                                    $scope.msgnotiComercio = ('Número mínimo de pessoas alcançado do evento ' + $scope.evento.nomeevento );
                                    noti.recebeusername = comercio.username;
                                    noti.recebe = comercio.idComercioParceiro;
                                    noti.envia = comercio.idComercioParceiro;
                                    noti.tipo = 51;   //evento bateu numero minimo de pessoas para acontecer
                                    noti.nomeevento = $scope.evento.nomeevento;
                                    //console.log(noti.nomeevento , "Idevento");
                                      EventoService.VerificaNotificacao(noti).then(function(res) {
                                      if(res){
                                        $http.post('https://ec2.diwoapp.com.br/notificapessoa.php', {notificacao : $scope.msgnotiComercio, 
                                                      idevento : $scope.evento.idevento,
                                                      nomeevento : $scope.evento.nomeevento,
                                                      id_user_envia : $scope.evento.idComercioParceiro,
                                                      username_envia : $scope.evento.nomeevento,
                                                      apelido_envia : $scope.evento.nomeevento,
                                                      tipo : '51',
                                                      id_user_recebe : $scope.evento.idComercioParceiro});
                                          $scope.pushnoti.titulo =  'Número de pessoas alcançado!' ;
                                          $scope.pushnoti.msg = $scope.msgnotiComercio;
                                          $scope.pushnoti.token = comercio.devicetoken;
                                          EventoService.MandaPushNoti($scope.pushnoti);
                                          $scope.pushnoti.titulo =  'Número de pessoas alcançado!' ;
                                          $scope.pushnoti.msg = $scope.msgnotiComercio;
                                          $scope.pushnoti.token = 'dKpOML7ZLIA:APA91bFhTghUqP4gpCkohaf3h1WzCjDwQTrMg2JbUJjEQ9WegZgXWZQSNWtwoeAIu98bLK6wtSByVo1jluGyPmVmBxrvEWu6sluypuLk6O7F_18Z_e2kko7UQdK16Hu7O4qxsvstCmSI';
                                          console.log($scope.pushnoti.msg, "Mandando push");
                                          EventoService.MandaPushNoti($scope.pushnoti);
                                      }
                                    });
                                  });
                                }




                                var alertPopup = $ionicPopup.alert({
                                  title: 'Parabéns',
                                  template: $scope.response.msg
                                });
                                alertPopup.then(function(){
                                  $http.post('https://ec2.diwoapp.com.br/deletapessoaevento.php', {iduser : $scope.user.iduser,
                                                                                          idevento : $scope.evento.idevento,
                                                                                          estado: '7'}).then(function (res){
                                  $scope.response = res.data;
                                  $state.go('tabsController.home'); 
                                  });
                                 
                                });
                                
                              }else{
                                var alertPopup = $ionicPopup.alert({
                                  title: 'Ocorreu uma falha',
                                  template: $scope.response.msg
                                });
                              }
                              console.log($scope.response.msg);
                          });
                        }
                      }else{
                        if($scope.evento.zone == 'yellow'){
                          var confirmPopup = $ionicPopup.show({
                               title: 'ZONA AMARELA',
                               template: 'Evento esta na ZONA AMARELA, caso voce desista uma vez que confirmado a presença tu sofrerás um cartão amarelo. Deseja ir mesmo assim?',
                               buttons: [
                                  { text: 'Não sei se vou',
                                    type: 'button-assertive',
                                    onTap: function(e){
                                      console.log('nada acontece');
                                    }},
                                  {
                                    text: 'Quero ir',
                                    type: 'button-positive',
                                    onTap: function(e){
                                      $scope.confirmacao = 'aguardando confirmação';
                                      $scope.estado = '1';
                            
                            var link = 'https://ec2.diwoapp.com.br/irevento.php';
                            $http.post(link, {idevento : $scope.evento.idevento,
                                            idadm : $scope.evento.adm, 
                                            admusername : $scope.evento.admusername, 
                                            diainicio : $scope.evento.diainicio,
                                            diafim : $scope.evento.diafim,
                                            iduser : $scope.user.iduser,
                                            borda : $scope.user.borda,
                                            username: $scope.user.username,
                                            profilepic : $scope.user.profilepic,
                                            devicetoken : $scope.user.devicetoken,
                                            apelido : $scope.user.apelido,
                                            confirmacao : $scope.confirmacao,
                                            nomeevento :  $scope.nomeevento,
                                            eventopic : $scope.evento.eventopic,
                                            idComercioParceiro : $scope.evento.idComercioParceiro, 
                                            estado : $scope.estado}).then(function (res){
                              $scope.response = res.data;
                              
                              $http.post('https://ec2.diwoapp.com.br/deletapessoaevento.php', {iduser : $scope.user.iduser,
                                                                                          idevento : $scope.evento.idevento,
                                                                                          estado: '5'});
                              if ($scope.response.success == true) {
                                $scope.msgnoti = ('To querendo ir no evento: ' + $scope.evento.nomeevento);
                                noti.recebe = $scope.evento.adm;
                                noti.envia = $scope.user.iduser;
                                noti.tipo = 1;
                                noti.nomeevento = $scope.evento.nomeevento;
                                EventoService.VerificaNotificacao(noti).then(function(res) {
                                  console.log(res);
                                  if(res){
                                    if($scope.evento.tipodeevento != "comercio" && $scope.evento.tipodeevento != "campanha"){
                                      $http.post('https://ec2.diwoapp.com.br/notificacriador.php', {notificacao : $scope.msgnoti, 
                                            idevento : $scope.evento.idevento,
                                            nomeevento : $scope.evento.nomeevento,
                                            id_user_envia : $scope.user.iduser,
                                            username_envia : $scope.user.username,
                                            apelido_envia : $scope.user.apelido,
                                            tipo : '1',
                                            id_user_recebe : $scope.evento.adm});
                                   EventoService.getusuario2($scope.evento.admusername).then(function(user) {
                                    if(user.noticriados == '1'){
                                      $scope.pushnoti.titulo = $scope.evento.nomeevento;
                                      $scope.pushnoti.msg = $scope.user.username + " quer participar do evento";
                                      $scope.pushnoti.token = user.devicetoken;
                                       EventoService.MandaPushNoti($scope.pushnoti);
                                     }
                                    });
                                    }
                                   
                                   
                                  }
                                });
                                $http.post("https://ec2.diwoapp.com.br/deletanotificacaoporids.php", {id_user_recebe : noti.recebe,
                                                                                          id_user_envia: noti.envia,
                                                                                          nomeevento: noti.nomeevento,
                                                                                          tipo : '5'});
                                var alertPopup = $ionicPopup.alert({
                                  title: 'Parabéns',
                                  template: $scope.response.msg
                                });
                                alertPopup.then(function(){
                                  $http.post('https://ec2.diwoapp.com.br/deletapessoaevento.php', {iduser : $scope.user.iduser,
                                                                                          idevento : $scope.evento.idevento,
                                                                                          estado: '7'}).then(function (res){
                                  $scope.response = res.data;
                                  $state.go('tabsController.home'); 
                                  });
                                });
                                
                              }else{
                                var alertPopup = $ionicPopup.alert({
                                  title: 'Ocorreu uma falha',
                                  template: $scope.response.msg
                                });
                              }
                              console.log($scope.response.msg);
                          });
                                    }}]
                             });
                        }else{
                            $scope.confirmacao = 'aguardando confirmação';
                            $scope.estado = '1';
                            var link = 'https://ec2.diwoapp.com.br/irevento.php';
                            $http.post(link, {idevento : $scope.evento.idevento,
                                            idadm : $scope.evento.adm, 
                                            admusername : $scope.evento.admusername, 
                                            diainicio : $scope.evento.diainicio,
                                            diafim : $scope.evento.diafim,
                                            iduser : $scope.user.iduser,
                                            borda : $scope.user.borda,
                                            username: $scope.user.username,
                                            profilepic : $scope.user.profilepic,
                                            devicetoken : $scope.user.devicetoken,
                                            apelido : $scope.user.apelido,
                                            confirmacao : $scope.confirmacao,
                                            nomeevento :  $scope.nomeevento, 
                                            eventopic : $scope.evento.eventopic,
                                            idComercioParceiro : $scope.evento.idComercioParceiro, 
                                            estado : $scope.estado}).then(function (res){
                              $scope.response = res.data;
                              
                              $http.post('https://ec2.diwoapp.com.br/deletapessoaevento.php', {iduser : $scope.user.iduser,
                                                                                          idevento : $scope.evento.idevento,
                                                                                          estado: '5'});
                              if ($scope.response.success == true) {
                                $scope.msgnoti = ('To querendo ir no evento: ' + $scope.evento.nomeevento);
                                noti.recebe = $scope.evento.adm;
                                noti.envia = $scope.user.iduser;
                                noti.tipo = 1;
                                noti.nomeevento = $scope.evento.nomeevento;
                                EventoService.VerificaNotificacao(noti).then(function(res) {
                                  console.log(res);
                                  if(res){
                                       if($scope.evento.tipodeevento != "comercio" && $scope.evento.tipodeevento != "campanha"){
                                      $http.post('https://ec2.diwoapp.com.br/notificacriador.php', {notificacao : $scope.msgnoti, 
                                            idevento : $scope.evento.idevento,
                                            nomeevento : $scope.evento.nomeevento,
                                            id_user_envia : $scope.user.iduser,
                                            username_envia : $scope.user.username,
                                            apelido_envia : $scope.user.apelido,
                                            tipo : '1',
                                            id_user_recebe : $scope.evento.adm});
                                   EventoService.getusuario2($scope.evento.admusername).then(function(user) {
                                    if(user.noticriados == '1'){
                                      $scope.pushnoti.titulo = $scope.evento.nomeevento;
                                      $scope.pushnoti.msg = $scope.user.username + " quer participar do evento";
                                      $scope.pushnoti.token = user.devicetoken;
                                       EventoService.MandaPushNoti($scope.pushnoti);
                                     }
                                    });
                                    }
                                    
                                  }
                                });
                                $http.post("https://ec2.diwoapp.com.br/deletanotificacaoporids.php", {id_user_recebe : noti.recebe,
                                                                                          id_user_envia: noti.envia,
                                                                                          nomeevento: noti.nomeevento,
                                                                                          tipo : '5'});


                                            /// PEDIR CONTATO DE ALGUEM DE FORA PARA FAZER O SERVIÇO DE CHAMAR
                 



                                var alertPopup = $ionicPopup.alert({
                                  title: 'Parabéns',
                                  template: $scope.response.msg
                                });
                                alertPopup.then(function(){
                                  $http.post('https://ec2.diwoapp.com.br/deletapessoaevento.php', {iduser : $scope.user.iduser,
                                                                                          idevento : $scope.evento.idevento,
                                                                                          estado: '7'}).then(function (res){
                                  $scope.response = res.data;
                                  $state.go('tabsController.home'); 
                                  });
                                });
                                
                              }else{
                                var alertPopup = $ionicPopup.alert({
                                  title: 'Ocorreu uma falha',
                                  template: $scope.response.msg
                                });
                              }
                              console.log($scope.response.msg);
                          });
                        }
                      }
                    }
            }
          }
            
        
        
        }
      });
    
  };
  $scope.favorita = function(){
    var po = $scope.user.pontos.valueOf() - 2;
    var mgsg = 'Mas para isso vamos t cobrar 2 pontos, você quer? (Pontos atuais:' + $scope.user.pontos + ')';
    var myPopup = $ionicPopup.show({
                        title: 'Salvar para depois',
                        subTitle: mgsg,
                        scope: $scope,
                        buttons: [
                          { text: 'Não' },
                          {
                            text: '<b>Sim</b>',
                            type: 'button-positive',
                            onTap: function(e) {
      if($scope.user.pontos<2){
        var alertPopup = $ionicPopup.alert({
            title: '(ノ￣ー￣)ノ ● ＼(^ω^＼)',
            template: 'Não tens pontos suficiente, tente ir em mais eventos ou crie ou avalie em eventos que você foi e não avaliou ninguem, uma pessoa basta'
          });
      }else{
        $http.post('https://ec2.diwoapp.com.br/gastapontospessoaevento.php', {idevento : -20,
                                                        iduser : $scope.user.iduser,
                                                        borda : $scope.user.borda,
                                                        username: $scope.user.username,
                                                        apelido : $scope.user.apelido,
                                                        nomeevento :  "Salvou, pinzou evento", 
                                                        estado : 10,
                                                        pontos: -2});
                                    var link = 'https://ec2.diwoapp.com.br/irevento.php';
                                    $http.post(link, {idevento : $scope.item.idevento, 
                                                              idadm : $scope.item.adm, 
                                                              admusername : $scope.item.admusername, 
                                                              iduser : $scope.user.iduser,
                                                              diainicio : $scope.item.diainicio,
                                                              diafim : $scope.item.diafim,
                                                              borda : $scope.user.borda,
                                                              username: $scope.user.username,
                                                              profilepic : $scope.user.profilepic,
                                                              devicetoken : $scope.user.devicetoken,
                                                              apelido : $scope.user.apelido,
                                                              confirmacao : 'interesse',
                                                              nomeevento :  $scope.item.nomeevento,
                                                              eventopic : $scope.item.eventopic,
                                                              idComercioParceiro : $scope.item.idComercioParceiro,  
                                                              estado : '7'}).then(function (res){
                                        $scope.response = res.data;
                                        if ($scope.response.success == true) {

                                          $http.post('https://ec2.diwoapp.com.br/pessoanaoevento.php', {iduser : $scope.user.iduser, 
                                                                  idevento : $scope.item.idevento,
                                                                  nomeevento : $scope.item.nomeevento,
                                                                  estado : '13'}) // favoritou
                                          var alertPopup = $ionicPopup.alert({
                                                        title: '( ͡° ͜ʖ ͡°)',
                                                        template: 'Foi adicionado a lista de pinzados, quando resolver ir é só confimar por lá.'
                                                      });
                                          alertPopup.then(function(){
                                            $scope.atualiza = {};
                                            $scope.atualiza.pontos = po;
                                            $scope.atualiza.iduser = $scope.user.iduser;
                                            EventoService.atualizarpontos($scope.atualiza);
                                            $state.go('tabsController.home')
                                            
                                          });
                                        }
                                      });
                                    }
                                  }
                                }
                                ]});     
  }
  

}])
    
.controller('eventoAbertoCtrl', ['$scope', '$stateParams', 'formItem', 'formUser', 'formtelaCriar', 'formOutro', '$http', '$timeout','$ionicPopup', 'EventoService', '$state','$cordovaSocialSharing', 'formvimdofiltro', 'formEventoEditahome','formvimdofiltroperfil', 'formLimiteatuacao','formvimdopost',// The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, formItem, formUser, formtelaCriar, formOutro, $http, $timeout, $ionicPopup, EventoService, $state, $cordovaSocialSharing, formvimdofiltro, formEventoEditahome, formvimdofiltroperfil, formLimiteatuacao, formvimdopost) {

  $scope.evento = formItem.getForm();
  $scope.aux = formUser.getForm();
  formvimdopost.updateForm(false);
  $scope.tag = '';
  $scope.nuser = 0;
  $scope.convidar = false;
  var datainvalida = 0;
  $scope.chat = $stateParams.idevento;
  console.log("HAHUAHUAUHUHAHUAUHUHAUHUHAUH", $scope.chat)
  $scope.borala = true;
  $scope.aviso =false;
  $scope.desistir = false;
  $scope.reserva = false;
  $scope.chathome = false;
  $scope.pinza = false;
  $scope.despinza = false;
  $scope.data = {};
  $scope.auxdata ={};
  $scope.limiteconfirmacao ={};
  $scope.fim = {};
  $scope.dia = {};
  $scope.pushnoti ={};
  $scope.limiteatuacao = formLimiteatuacao.getForm();

  var hj = $scope.evento.diainicio;
  var ano = (hj[0]+hj[1]+hj[2]+hj[3]).valueOf();
  var mes = (hj[5]+hj[6]).valueOf();
  var dia = (hj[8]+hj[9]).valueOf();

  var h = (hj[11]+hj[12]).valueOf();
  var m = (hj[14]+hj[15]).valueOf();

  var vdf = formvimdofiltro.getForm();
  $scope.vimdofiltroEA =false;
  if(vdf){
    $scope.vimdofiltroEA = vdf;
  }

  var currentdate = new Date(); 
  var curr_date = (currentdate.getDate()<10?'0':'') + currentdate.getDate();
  var curr_month = (currentdate.getMonth()<10?'0':'') + (currentdate.getMonth() + 1); 
  var curr_year = currentdate.getFullYear();
  var h2 = (currentdate.getHours()<10?'0':'') + currentdate.getHours();
  var m2 = (currentdate.getMinutes()<10?'0':'') + currentdate.getMinutes();
    

  var hjd = $scope.evento.duracao;
  var hd = (hjd[0]+hjd[1]).valueOf();
  var md = (hjd[3]+hjd[4]).valueOf();
  $scope.duracao = hd+':'+md;

  var  hjl = $scope.evento.dialimiteconfirmacao;
  $scope.limiteconfirmacao.dia =  (hjl[8]+hjl[9]).valueOf()+'/'+(hjl[5]+hjl[6]).valueOf();
  $scope.limiteconfirmacao.hora =  (hjl[11]+hjl[12]).valueOf()+':'+(hjl[14]+hjl[15]).valueOf();  
  
  

  var hjf = $scope.evento.diafim;
  $scope.fim.dia =  (hjf[8]+hjf[9]).valueOf()+'/'+(hjf[5]+hjf[6]).valueOf()+'/'+(hjf[0]+hjf[1]+hjf[2]+hjf[3]);
  $scope.fim.hora = (hjf[11]+hjf[12]).valueOf()+':'+(hjf[14]+hjf[15]).valueOf();
  $scope.dia.dia = dia+'/'+mes;
  $scope.dia.hora = h+':'+m +' - '+(hjf[11]+hjf[12]).valueOf()+':'+(hjf[14]+hjf[15]).valueOf() ;

  if($scope.limiteconfirmacao.dia == $scope.dia.dia){
    $scope.limsemana = $scope.evento.semana;
  }else{
    if($scope.evento.semana == "Segunda-feira"){
      $scope.limsemana = "Domingo";
    }
    if($scope.evento.semana == "Terça-feira"){
      $scope.limsemana = "Segunda-feira";
    }
    if($scope.evento.semana == "Quarta-feira"){
      $scope.limsemana = "Terça-feira";
    }
    if($scope.evento.semana == "Quinta-feira"){
      $scope.limsemana = "Quarta-feira";
    }
    if($scope.evento.semana == "Sexta-feira"){
      $scope.limsemana = "Quinta-feira";
    }
    if($scope.evento.semana == "Sábado"){
      $scope.limsemana = "Sexta-feira";
    }
    if($scope.evento.semana == "Domingo"){
      $scope.limsemana = "Sábado";
    }
  }
  var zone;
  var meuestado;
  var noti = {};
  var confirm = $scope.aux.iduser;

  var ano5 = (hjl[0]+hjl[1]+hjl[2]+hjl[3]).valueOf()-curr_year;
  var mes5 = (hjl[5]+hjl[6]).valueOf()-curr_month;
  var dia5 = (hjl[8]+hjl[9]).valueOf()-curr_date;
  var h5 = (hjl[11]+hjl[12]).valueOf()-h2;
  var m5 = (hjl[14]+hjl[15]).valueOf()-m2;

  
  console.log(ano5, mes5, dia5,h5, m5 , 'COMOMO?')
  if(ano5 == 0 && mes5 == 0 && dia5 == 0 && ((h5 == 1 && m5<30 && m5>0)||(h5==0 && m5 > 30)|| (h5==1 && m5>-30))){
    console.log('YELLOWZONE');
    zone = 'yellow';
    $scope.confirmaPessoa =true;
  }
  if(ano5<0 || mes5 < 0 ||(ano5 == 0 && mes5 == 0 && (dia5 < 0 || (dia5==0 && ((h5 == 0 && m5<=0)||(h5 < 0)) )))){
    console.log('REDZONE');
    $scope.borala = false;
    $scope.aviso =true;
    zone = 'red';
    $scope.confirmaPessoa =false;
    $scope.deletarPessoa = false;
    $scope.edita = false;
  }else{
    $scope.borala = true;
    $scope.aviso =false;
  }

  if($scope.evento.adm ==  $scope.aux.iduser){
    $scope.deletarPessoa = true;
    $scope.confirmaPessoa =true;
    if(zone == 'red'){
      $scope.edita = false;
      $scope.deletarPessoa = false;
    }else{
      $scope.edita = true;
    }
  }
  console.log("numeor", $scope.evento.pmin, $scope.evento.patual , $scope.evento.pmax)
  
    if(parseInt($scope.evento.pmin)>parseInt($scope.evento.patual)){
      $scope.menorqpmin = true;
      $scope.nopmin = false;
      $scope.entre = false;
      $scope.cheio = false;
    }
    if(parseInt($scope.evento.pmin)==parseInt($scope.evento.patual)){
      $scope.menorqpmin = false;
      $scope.nopmin = true;
      $scope.entre = false;
      $scope.cheio = false;
    }

    if(parseInt($scope.evento.pmin)<parseInt($scope.evento.patual) && parseInt($scope.evento.pmax)>parseInt($scope.evento.patual)){
      $scope.menorqpmin = false;
      $scope.nopmin = false;
      $scope.entre = true;
      $scope.cheio = false;
      console.log("nao cheio")
    }
    if(parseInt($scope.evento.pmin)<parseInt($scope.evento.patual) && parseInt($scope.evento.pmax)<=parseInt($scope.evento.patual)){
      $scope.menorqpmin = false;
      $scope.nopmin = false;
      $scope.entre = false;
      $scope.cheio = true;
      console.log(" cheio", $scope.evento.pmin.valueOf() , $scope.evento.patual.valueOf(), $scope.evento.pmax.valueOf())
    }
     

  console.log($scope.evento.patual , $scope.evento.pmin)
  if(parseInt($scope.evento.patual) < parseInt($scope.evento.pmin) && zone == 'red'){
    console.log('Evento não acontece por falta de pessoas')
  }
  if(parseInt($scope.evento.patual) < parseInt($scope.evento.pmin) && zone == 'yellow'){
    console.log('Evento esta com poucas pessoas, talvez ele nao aconteça')
  }
  
  if($scope.evento.preco == 0 || $scope.evento.preco =="Gratuito"){
      $scope.evento.preco = "Gratuito";
      $scope.porpessoa = false;
      $scope.porlocal = false;
    }else{
      if($scope.evento.precopor == 1){
        $scope.porpessoa = true;
        $scope.porlocal = false;
      }else{
        $scope.porpessoa = false;
        $scope.porlocal = true;
      }
    }

  if($scope.evento.genero == "masc"){
      $scope.masc = true;
      $scope.fem = false;
  }
  if($scope.evento.genero == "fem"){
      $scope.fem = true;
      $scope.masc = false;
  }
  if($scope.evento.genero == "todos"){
      $scope.fem = false;
      $scope.masc = false;
  }

  $scope.helppp = {};
  $scope.helppp.idevento = $scope.evento.idevento;
  $scope.helppp.iduser = $scope.aux.iduser
  EventoService.VerificaPossoConvidar($scope.helppp).then(function(convi) {
    $scope.convidar = convi.success;
  });

   if($scope.evento.tipodeevento ){
      console.log("patrocinadoffff")
      $scope.evento.patrocinado = true;
      //$scope.evento.styleItem = "background-color: #212121;color: white;box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.3);border: 4px dotted #ffdb29;";
      //$scope.evento.styleItem = "background-color: #212121;color: white;box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.3);border: 4px dotted #ff9008;";
      $scope.evento.styleItem = "background-color: #212121;color: white;box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.3);outline: 7px dotted #ff4c42;outline-offset: -4px;";
      //$scope.evento.styleItem = "background-color: #212121;color: white;box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.3);border: 4px dotted #f9bdff;";
      //$scope.evento.styleItem = "background-color: #212121;color: white;box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.3);border: 4px dotted #00FFFF;";

      document.getElementById("page10").style.backgroundImage = "url('img/background_patrocinado.jpg')"
    }else{
      $scope.evento.styleItem = "background-color: #212121;color: white;box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.3);"
      $scope.evento.patrocinado = false;
      document.getElementById("page10").style.backgroundColor = "#212121"
    }


  $scope.$on("$ionicView.enter", function(event, data){

    $scope.tag = '';
    $scope.items = [];
    $scope.pinza = false;
    $scope.despinza = false;
    $scope.evento = formItem.getForm();
    $scope.aux = formUser.getForm();
    datainvalida = 0;
    formvimdopost.updateForm(false);
    $scope.menorqpmin = false;
    $scope.nopmin = false;
    $scope.entre = false;
    $scope.cheio = false;

    $scope.convidar = false;
    $scope.limiteatuacao = formLimiteatuacao.getForm();
    $scope.auxdata ={};
    $scope.pushnoti = {};
    var hjd = $scope.evento.duracao;
    var hd = (hjd[0]+hjd[1]).valueOf();
    var md = (hjd[3]+hjd[4]).valueOf();
    $scope.duracao = hd+':'+md;

    var  hjl = $scope.evento.dialimiteconfirmacao;
    $scope.limiteconfirmacao.dia =  (hjl[8]+hjl[9]).valueOf()+'/'+(hjl[5]+hjl[6]).valueOf();
    $scope.limiteconfirmacao.hora =  (hjl[11]+hjl[12]).valueOf()+':'+(hjl[14]+hjl[15]).valueOf();  
    
    

    var hjf = $scope.evento.diafim;
    $scope.fim.dia =  (hjf[8]+hjf[9]).valueOf()+'/'+(hjf[5]+hjf[6]).valueOf()+'/'+(hjf[0]+hjf[1]+hjf[2]+hjf[3]);
    $scope.fim.hora = (hjf[11]+hjf[12]).valueOf()+':'+(hjf[14]+hjf[15]).valueOf();
    $scope.dia.dia = dia+'/'+mes;
    $scope.dia.hora = h+':'+m +' - '+(hjf[11]+hjf[12]).valueOf()+':'+(hjf[14]+hjf[15]).valueOf() ;

            // Ve se eu tenho ou não interesse nesse evento
    $scope.auxpinza ={};
    $scope.auxpinza.iduser = $scope.aux.iduser;
    $scope.auxpinza.idevento = $scope.evento.idevento;
    var vdf = formvimdofiltro.getForm();
    $scope.vimdofiltroEA =false;
    if(vdf){
      $scope.vimdofiltroEA = vdf;
    }
    if(parseInt($scope.evento.pmin)>parseInt($scope.evento.patual)){
      $scope.menorqpmin = true;
      $scope.nopmin = false;
      $scope.entre = false;
      $scope.cheio = false;
    }
    if(parseInt($scope.evento.pmin)==parseInt($scope.evento.patual)){
      $scope.menorqpmin = false;
      $scope.nopmin = true;
      $scope.entre = false;
      $scope.cheio = false;
    }

    if(parseInt($scope.evento.pmin)<parseInt($scope.evento.patual) && parseInt($scope.evento.pmax)>parseInt($scope.evento.patual)){
      $scope.menorqpmin = false;
      $scope.nopmin = false;
      $scope.entre = true;
      $scope.cheio = false;
      console.log("nao cheio")
    }
    if(parseInt($scope.evento.pmin)<parseInt($scope.evento.patual) && parseInt($scope.evento.pmax)<=parseInt($scope.evento.patual)){
      $scope.menorqpmin = false;
      $scope.nopmin = false;
      $scope.entre = false;
      $scope.cheio = true;
      console.log(" cheio", $scope.evento.pmin.valueOf() , $scope.evento.patual.valueOf(), $scope.evento.pmax.valueOf())
    }
    if($scope.evento.tipodeevento ){
      //console.log("patrocinadoffff")
      $scope.evento.patrocinado = true;
      //$scope.evento.styleItem = "background-color: #212121;color: white;box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.3);border: 4px dotted #ffdb29;";
      //$scope.evento.styleItem = "background-color: #212121;color: white;box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.3);border: 4px dotted #ff9008;";
      $scope.evento.styleItem = "background-color: #212121;color: white;box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.3);outline: 7px dotted #ff4c42;outline-offset: -4px;";
      //$scope.evento.styleItem = "background-color: #212121;color: white;box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.3);border: 4px dotted #f9bdff;";
      //$scope.evento.styleItem = "background-color: #212121;color: white;box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.3);border: 4px dotted #00FFFF;";

      document.getElementById("page10").style.backgroundImage = "url('img/background_patrocinado.jpg')"
    }else{
      $scope.evento.styleItem = "background-color: #212121;color: white;box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.3);"
      $scope.evento.patrocinado = false;
      document.getElementById("page10").style.backgroundColor = "#212121"
    }

    if($scope.evento.preco == 0 || $scope.evento.preco =="Gratuito"){
      $scope.evento.preco = "Gratuito";
      $scope.porpessoa = false;
      $scope.porlocal = false;
    }else{
      if($scope.evento.precopor == 1){
        $scope.porpessoa = true;
        $scope.porlocal = false;
      }else{
        $scope.porpessoa = false;
        $scope.porlocal = true;
      }
    }

    $scope.helppp = {};
    $scope.helppp.idevento = $scope.evento.idevento;
    $scope.helppp.iduser = $scope.aux.iduser
    EventoService.VerificaPossoConvidar($scope.helppp).then(function(convi) {
      $scope.convidar = convi;
    });

    EventoService.verificahorariopessoaeventoconfirmados($scope.aux).then(function(items) {
      $scope.auxdata = items;
      for(var r = 0;r<$scope.auxdata.length; r++){
        //console.log($scope.auxdata[r].idevento, $scope.auxdata[r].diainicio, $scope.auxdata[r].diafim , we ,$scope.evento.diafim);
        if($scope.evento.idevento!=$scope.auxdata[r].idevento){
          if (($scope.auxdata[r].diainicio < $scope.evento.diainicio && $scope.auxdata[r].diafim > $scope.evento.diainicio) || ($scope.auxdata[r].diainicio<$scope.evento.diafim && $scope.auxdata[r].diafim>$scope.evento.diafim) ||($scope.auxdata[r].diainicio > $scope.evento.diainicio && $scope.auxdata[r].diafim<$scope.evento.diafim) || ($scope.auxdata[r].diainicio < $scope.evento.diainicio && $scope.auxdata[r].diafim>$scope.evento.diafim) ) {
            console.log('horario invalido');
            datainvalida = 1;
          }
        }
      }
    });

    if($scope.aux.iduser != $scope.evento.adm){
       $scope.edita = false;
       console.log($scope.auxpinza.iduser , $scope.auxpinza.idevento)
        EventoService.Getpinza($scope.auxpinza).then(function(items) {
        //alert(items.success)
        console.log(items.success,"qeqew" )
        if(items.success != false){
          if (items[0].estado == 7) {
            $scope.pinza = false;
            $scope.despinza = true;
            console.log('eh favorito')
          }
        }else{
          console.log('N eh')
          $scope.pinza = true;
          $scope.despinza = false;
        } 
      });
    }else{
       if(zone == 'red'){
          $scope.edita = false;
        }else{
          $scope.edita = true;
        }
      $scope.pinza = false;
      $scope.despinza = false;
    }
    
            //Pega tags do evento
    EventoService.Gettags($scope.evento.idevento).then(function(tags) {
      for(var  i =0; i< tags.length;i++){
        $scope.tag = ($scope.tag + ' ' + tags[i].tag);
      } 
    });
            //Capacidade do evento
    if(parseInt($scope.evento.pmax) <= parseInt($scope.evento.patual)){
        console.log('Evento cheio');
        $scope.borala = false;
        $scope.reserva = true;
    }
    console.log($scope.evento.idevento, "bug")
    EventoService.GetParticipantes($scope.evento.idevento).then(function(parti) {
      console.log(parti.length , "parti.length");
      $scope.nomeevento = parti[0].nomeevento;
      console.log($scope.nomeevento, "bug dentro")
      for (var i = 0; i < parti.length; i++) {
        if ($scope.aux.iduser == parti[i].iduser && parti[i].estado!=7 && parti[i].estado!=8) {
          $scope.nuser++;
          $scope.borala = false;
          $scope.reserva = false;
          $scope.desistir = true;
          $scope.chathome = true;
        }
        if ($scope.aux.iduser == parti[i].iduser) {
          meuestado = parti[i].estado;
        }
        if ($scope.aux.iduser == parti[i].iduser && parti[i].estado == 7) {
          $scope.pinza = false;
          $scope.despinza = true;
        }
        if ($scope.aux.iduser == parti[i].iduser && parti[i].estado == 8) {
          $scope.reserva = false;
          var alertPopup = $ionicPopup.alert({
                          title: 'ლ(*꒪ヮ꒪*)ლ',
                          template: 'Tais na fila da reserva, se vagar t avisaremos'
          });
          console.log('reservado');
        }            
      }
    });


    console.log($scope.evento.idevento, "bug")
    EventoService.GetParticipantesSemFav($scope.evento.idevento).then(function(items) {
      console.log(items[0].iduser, "bug dentro")
      for (var i = 0; i < items.length; i++) {
        if (items[i].estado == 0) {
          items[i].confirmacao = 'Sou o organizador';
          $scope.criador = items[i].iduser;
        }
        if (items[i].estado == 1) {
          items[i].confirmacao = 'Aguardando confirmação';
        }
        if (items[i].estado == 2) {
          items[i].confirmacao = 'Confirmado';
        }
        if(items[i].borda == 0){
            items[i].bb = false;
            items[i].bs = false;
            items[i].bg = false;
          }
          if(items[i].borda == 1){
            items[i].bb = true;
            items[i].bs = false;
            items[i].bg = false;
          }
          if(items[i].borda == 2){
            items[i].bb = false;
            items[i].bs = true;
            items[i].bg = false;
          }
          if(items[i].borda == 3){
            items[i].bb = false;
            items[i].bs = false;
            items[i].bg = true;
          }
          if((items[i].profilepic[8] == 's' && items[i].profilepic[9] == '3')||(items[i].profilepic[8] == 'd' && items[i].profilepic[9] == 'i')){
         
             items[i].profilepic=items[i].profilepic+"?{{getTimeStamp()}}";
           }else{
             items[i].profilepic=items[i].profilepic;
           }

      }
      $scope.items = items;
     
      
    });
  });
    //  $scope.share = function() {
    //         $cordovaSocialSharing.canShareVia("twitter", 'Oii', '', 'http://diwoapp.com.br/politica-de-privacidade/').then(function(result) {
    //             $cordovaSocialSharing.shareViaTwitter('Oii', '', 'http://diwoapp.com.br/politica-de-privacidade/');
    //         }, function(error) {
    //             alert("Cannot share on Twitter");
    //         }); device.platform == "Android" ? "https://play.google.com/store/apps/details?id=com.ionicframework.invitta391892" : "ITUNES_URL
    //     }
    //$scope.linkevento ='';
     $scope.share = function(t, msg, img, link){ 
      $scope.msgshare = "Olha o que achei: " + $scope.evento.nomeevento + ' ' +dia+'/'+mes  + ' bora?';
      $scope.linkevento = "https://ec2.diwoapp.com.br/pageteste.html?idevento="+$scope.evento.idevento;
       console.log($scope.msgshare)
        if(t == 'w')
          $cordovaSocialSharing.canShareVia('whatsapp', $scope.msgshare, '', 'http://diwoapp.com.br/politica-de-privacidade/').then(function(result) {
            $cordovaSocialSharing.shareViaWhatsApp($scope.msgshare, '' , $scope.linkevento) ;
            }, function(error) {
                alert("Cannot share on whatsapp");
            });
        else if(t == 'f')
          $cordovaSocialSharing.canShareVia('facebook', $scope.msgshare, '', 'http://diwoapp.com.br/politica-de-privacidade/').then(function(result) {
                $cordovaSocialSharing.shareViaFacebook( $scope.msgshare, '', $scope.linkevento);
            }, function(error) {
                alert("Cannot share on whatsapp");
            });
  
        else if(t == 't')
            $cordovaSocialSharing.canShareVia('twitter', $scope.msgshare, '', 'http://diwoapp.com.br/politica-de-privacidade/').then(function(result) {
                $cordovaSocialSharing.shareViaTwitter( + $scope.msgshare, '',  $scope.linkevento);
            }, function(error) {
                alert("Cannot share on whatsapp");
            }); 
    }

                      
    $scope.chamamos = function(){  
      $scope.carinha = '';
      $ionicPopup.prompt({
          title: 'Ajude um amigo',
          template: 'Ajude um amigo(a) que amaria esse evento a fazer parte dele também! Com um amigo é sempre mais seguro.Nós enviaremos um meme, poema ou áudio convidando ele(a) por você. Só precisamos do “@”, email ou telefone dela e voilá :)',
         inputType: 'text',
         inputPlaceholder: '@insta ou numero pra whats ou email'
       }).then(function(contato) {
        if(contato){
          if(contato!= ''){
            $scope.carinha = $scope.aux.iduser + " " +$scope.aux.username + " quer convidar: " + contato + " no evento id:" + $scope.evento.idevento + " nome do evento: " + $scope.evento.nomeevento;
            $http.post('https://ec2.diwoapp.com.br/pedeconvite.php', {namereportado : $scope.evento.nomeevento,
                                                                                      usernamereportando : contato,
                                                                                      tiporeport : 'Convide meu amigo',
                                                                                      motivo : $scope.carinha}).then(function (tes){
              if(tes.data.success == true){
                var alertPopup = $ionicPopup.alert({
                  title: 'Pronto!',
                  template: 'Convidaremos ele de uma das formas, obrigado!!'
                });
                alertPopup.then(function(){
                  EventoService.ConvidarPessoaevento($scope.helppp).then(function(convite) {
                    if(convite){
                      $scope.convidar = false;
                    }
                  });
                });
              }else{
                var alertPopup = $ionicPopup.alert({
                  title: 'Vish',
                  template: 'Ocorreu uma falha!!'
                });
              }
            });
          }
          console.log($scope.carinha)
        }
      }); 
    }
  

  $scope.enterItem =  function(item){
    formOutro.updateForm(item);
    //console.log(item.iduser);
    formvimdofiltroperfil.updateForm(false);
    $state.go('tabsController.perfilOutro');
  }

  $scope.Vermapa = function(){
    $state.go('tabsController.ver_onde_mapa');
  }

  $scope.editar = function(){
    formEventoEditahome.updateForm($scope.evento)
    $state.go('tabsController.EditaEEAPart1');
    //$state.go('tabsController.EditaEventoPart1');
  }

  $scope.aprova = function(item){
    console.log(meuestado)
    if(meuestado == 1 || meuestado == 8 || meuestado == 7 ){
                var alertPopup = $ionicPopup.alert({
                          title: '(°ロ°)☝',
                          template: 'Ainda não foi confirmado para poder aprovar alguem'
                        });
    }else{
      if(item.estado == 1 ){
        if (item.iduser!=$scope.aux.iduser  && confirm!= item.iduser) {
                confirm = item.iduser;
                console.log(item.iduser, $scope.aux.iduser);
                $scope.msgnoti = ('Tu foi aceito no evento: ' + $scope.evento.nomeevento);
                $scope.evento.patual = parseInt($scope.evento.patual)+1;
                $http.post('https://ec2.diwoapp.com.br/addpessoaevento.php', {idevento : $scope.evento.idevento,
                                                                                patual : $scope.evento.patual});
                $http.post('https://ec2.diwoapp.com.br/atualizarpessoaevento.php' , {iduser : item.iduser,
                                                                                  idevento : $scope.evento.idevento,
                                                                                  confirmacao : 'Confirmação aceita',
                                                                                  estado :2});
                noti.recebeusername = item.username;
                noti.recebe = item.iduser;
                noti.envia = $scope.aux.iduser;
                noti.tipo = 2;
                noti.nomeevento = $scope.evento.nomeevento;
                $http.post("https://ec2.diwoapp.com.br/deletanotificacaoporids.php", {id_user_recebe : $scope.evento.adm,
                                                                              id_user_envia: item.iduser,
                                                                              nomeevento: noti.nomeevento,
                                                                              tipo : '1'});
                EventoService.VerificaNotificacao(noti).then(function(res) {
                  console.log(res);
                  if(res){
                    $http.post('https://ec2.diwoapp.com.br/notificapessoa.php', {notificacao : $scope.msgnoti, 
                                          idevento : $scope.evento.idevento,
                                          nomeevento : $scope.evento.nomeevento,
                                          id_user_envia : $scope.aux.iduser,
                                          username_envia : $scope.aux.username,
                                          apelido_envia : $scope.aux.apelido,
                                          tipo : '2',
                                          id_user_recebe : noti.recebe});
                    EventoService.getusuario2(noti.recebeusername).then(function(user) {
                      if(user.notiparticipando== '1'){
                      $scope.pushnoti.titulo =  'Boraaa!!!' ;
                      $scope.pushnoti.msg = $scope.msgnoti;
                      $scope.pushnoti.token = user.devicetoken;
                       EventoService.MandaPushNoti($scope.pushnoti);
                     }
                    });
                  }
                });
                 var alertPopup = $ionicPopup.alert({
                          title: '(/^▽^)/',
                          template: 'Vamos avisa-lo que ele foi aprovado, obrigado.'
                        });
                 item.confirmacao = 'Confirmação aprovada';

              
        }else{
          if(confirm ==  item.iduser){
            var alertPopup = $ionicPopup.alert({
                          title: '༼ つ ◕_◕ ༽つ',
                          template: 'Ja esta confirmado nesse evento!!!'
                        });
          }else{
              var alertPopup = $ionicPopup.alert({
                          title: 'ಠ_ಠ',
                          template: 'Seria muito facil tu se aceitar no evento né?'
                        });
          }
        }
      }
      if(item.estado == 2 ){
        var alertPopup = $ionicPopup.alert({
                      title: '༼ つ ◕_◕ ༽つ',
                      template: 'Ja esta confirmado nesse evento!!!'
                    });
        console.log('Ja estou confirmado')
      }
      console.log($scope.evento.diainicio)
      if(item.estado == 8 ){
        if(parseInt($scope.evento.patual)<parseInt($scope.evento.pmax)  && confirm!= item.iduser){
                confirm = item.iduser;
                console.log(item.iduser, $scope.aux.iduser);
                $scope.msgnoti = ('Tu foi aceito no evento: ' + $scope.evento.nomeevento);
                $scope.evento.patual = parseInt($scope.evento.patual)+1;
                $http.post('https://ec2.diwoapp.com.br/addpessoaevento.php', {idevento : $scope.evento.idevento,
                                                                                patual : $scope.evento.patual});
                $http.post('https://ec2.diwoapp.com.br/atualizarpessoaevento.php' , {iduser : item.iduser,
                                                                                  idevento : $scope.evento.idevento,
                                                                                  confirmacao : 'Confirmação aceita',
                                                                                  estado :2});
                noti.recebeusername = item.username;
                noti.recebe = item.iduser;
                noti.envia = $scope.aux.iduser;
                noti.tipo = 2;
                noti.nomeevento = $scope.evento.nomeevento;
                EventoService.VerificaNotificacao(noti).then(function(res) {
                  console.log(res);
                  if(res){
                    $http.post('https://ec2.diwoapp.com.br/notificapessoa.php', {notificacao : $scope.msgnoti, 
                                          idevento : $scope.evento.idevento,
                                          nomeevento : $scope.evento.nomeevento,
                                          id_user_envia : $scope.aux.iduser,
                                          username_envia : $scope.aux.username,
                                          apelido_envia : $scope.aux.apelido,
                                          tipo : '2',
                                          id_user_recebe : noti.recebe});
                    EventoService.getusuario2(noti.recebeusername).then(function(user) {
                      if(user.notiparticipando== '1'){
                      $scope.pushnoti.titulo =  'Boraaa!!!' ;
                      $scope.pushnoti.msg = $scope.msgnoti;
                      $scope.pushnoti.token = user.devicetoken;
                       EventoService.MandaPushNoti($scope.pushnoti);
                     }
                    });
                  }
                });
                  var alertPopup = $ionicPopup.alert({
                      title: '(°◡°♡).:｡',
                      template: 'Vamos confirmar a presença dele!!'
                    });
                 item.confirmacao = 'Confirmação aprovada';
         
        console.log('Ja estou confirmado')
        }else{
          var confirmPopup = $ionicPopup.show({
                   title: '(◕⌓◕;)',
                   template: 'Evento esta cheio, deseja confirmar essa pessoa mesmo assim?',
                   buttons: [
                      { text: 'Não',
                        type: 'button-assertive'},
                      {
                        text: 'Sim',
                        type: 'button-positive',
                        onTap: function(e){
                          confirm = item.iduser;
                          console.log(item.iduser, $scope.aux.iduser);
                          $scope.msgnoti = ('Tu foi aceito no evento: ' + $scope.evento.nomeevento);
                          $scope.evento.patual = parseInt($scope.evento.patual)+1;
                          $http.post('https://ec2.diwoapp.com.br/addpessoaevento.php', {idevento : $scope.evento.idevento,
                                                                                          patual : $scope.evento.patual});
                          $http.post('https://ec2.diwoapp.com.br/atualizarpessoaevento.php' , {iduser : item.iduser,
                                                                                            idevento : $scope.evento.idevento,
                                                                                            confirmacao : 'Confirmação aceita',
                                                                                            estado :2});
                          noti.recebeusername = item.username;
                          noti.recebe = item.iduser;
                          noti.envia = $scope.aux.iduser;
                          noti.tipo = 2;
                          noti.nomeevento = $scope.evento.nomeevento;
                          EventoService.VerificaNotificacao(noti).then(function(res) {
                            console.log(res);
                            if(res){
                              $http.post('https://ec2.diwoapp.com.br/notificapessoa.php', {notificacao : $scope.msgnoti, 
                                                    idevento : $scope.evento.idevento,
                                                    nomeevento : $scope.evento.nomeevento,
                                                    id_user_envia : $scope.aux.iduser,
                                                    username_envia : $scope.aux.username,
                                                    apelido_envia : $scope.aux.apelido,
                                                    tipo : '2',
                                                    id_user_recebe : noti.recebe});
                              EventoService.getusuario2(noti.recebeusername).then(function(user) {
                                if(user.notiparticipando== '1'){
                                $scope.pushnoti.titulo =  'Boraaa!!!' ;
                                $scope.pushnoti.msg = $scope.msgnoti;
                                $scope.pushnoti.token = user.devicetoken;
                                 EventoService.MandaPushNoti($scope.pushnoti);
                               }
                              });
                            }
                          });
                            var alertPopup = $ionicPopup.alert({
                                title: '(°◡°♡).:｡',
                                template: 'Vamos confirmar a presença dele!!'
                              });
                           item.confirmacao = 'Confirmação aprovada';
                              }
                             }
                           ]
                   })
            // var alertPopup = $ionicPopup.alert({
            //             title: '(◕⌓◕;)',
            //             template: 'Evento esta cheio, ou aumenta o numero de vagas ou escolha alguem para excluir do evento'
            //           });
          console.log('Esta cheio o evento')
        }
      }
      if (item.estado == 0) {
                var alertPopup = $ionicPopup.alert({
                          title: 'ლ(́◉◞౪◟◉‵ლ)',
                          template: 'Ja sou o organizador, não preciso me confirmar'
                        });
      }
    }
  }

  $scope.onItemDelete = function(item) {
    if (item.iduser == $scope.aux.iduser) {
      var alertPopup = $ionicPopup.alert({
                      title: 'Oi?',
                      template: 'Tu és o organizador, não podes se deletar do seu evento, podes cancelar ele'
      });
    }else{
      var confirmPopup = $ionicPopup.show({
                   title: 'ATENÇÃO!!!',
                   template: 'Você esta preste excluir pessoa do evento, ela não poderá mais entrar neste evento, tens certeza disso?',
                   buttons: [
                      { text: 'Não',
                        type: 'button-assertive'},
                      {
                        text: 'Sim',
                        type: 'button-positive',
                        onTap: function(e){
                        noti.recebeusername = item.username;
                        noti.recebe = item.iduser;
                        noti.envia = $scope.aux.iduser;
                        noti.tipo = 9;
                        noti.nomeevento = $scope.evento.nomeevento;
                        EventoService.VerificaNotificacao(noti).then(function(res) {
                          console.log(res);
                          if(res){
                            $http.post('https://ec2.diwoapp.com.br/notificapessoa.php', {notificacao : 'Tu foi retirado do evento', 
                                                                                            idevento : $scope.evento.idevento,
                                                                                            nomeevento : $scope.evento.nomeevento,
                                                                                            id_user_envia : $scope.aux.iduser,
                                                                                            username_envia : $scope.aux.username,
                                                                                            apelido_envia : $scope.aux.apelido,
                                                                                            tipo : '9', //pessoa kickada
                                                                                            id_user_recebe : noti.recebe});
                            EventoService.getusuario2(noti.recebeusername).then(function(user) {
                              if(user.notiparticipando== '1'){
                                              $scope.pushnoti.titulo = $scope.evento.nomeevento;
                                              $scope.pushnoti.msg = 'Tu foi retirado do evento: ' + $scope.evento.nomeevento;
                                              $scope.pushnoti.token = user.devicetoken;
                                               EventoService.MandaPushNoti($scope.pushnoti);
                                             }
                                            });
                          }
                        });
                          $http.post('https://ec2.diwoapp.com.br/deletapessoaevento.php', {iduser :item.iduser,
                                                                                              idevento : $scope.evento.idevento});
                          $http.post('https://ec2.diwoapp.com.br/deletachat.php', {iduser : item.iduser,
                                                                                      idevento : $scope.aux.idevento}); 
                          if(item.estado == 2){
                           $scope.evento.patual = parseInt($scope.evento.patual)-1;
                          }
                          $http.post('https://ec2.diwoapp.com.br/addpessoaevento.php', {idevento : $scope.evento.idevento,
                                                                                          patual : $scope.evento.patual});     
                          $http.post('https://ec2.diwoapp.com.br/pessoanaoevento.php', {iduser : item.iduser, 
                                                                                          idevento : $scope.evento.idevento,
                                                                                          nomeevento : $scope.evento.nomeevento,
                                                                                          estado : '1'});//foi kickado
                                                                                             

                          $scope.items.splice($scope.items.indexOf(item), 1);      
                              }
                             }
                           ]
                   })


      
    }
  }  

  $scope.confirma = function(){
    if($scope.limiteatuacao){
      if(datainvalida==1){
        var alertPopup = $ionicPopup.alert({
          title: 'ಠ_ಠ',
          template: 'Ja tens um evento marcado nesta data querido'
        });
      }else{
        if ($scope.nuser == 0) {
              if (!$scope.evento.idevento || !$scope.aux.iduser) {
                              var alertPopup = $ionicPopup.alert({
                              title: 'Vish deu ruim',
                              template: 'Favor refaça seu login'
                            });

              }else{
                if($scope.evento.tipodeevento){
                  if(zone == 'yellow'){
                    var confirmPopup = $ionicPopup.show({
                         title: 'ZONA AMARELA',
                         template: 'Evento esta na ZONA AMARELA, caso voce desista uma vez que confirmado a presença tu sofrerás um cartão amarelo. Deseja ir mesmo assim?',
                         buttons: [
                            { text: 'Não sei se vou',
                              type: 'button-assertive',
                              onTap: function(e){
                                console.log('nada acontece');
                              }},
                            {
                              text: 'Quero ir',
                              type: 'button-positive',
                              onTap: function(e){
                                $scope.confirmacao = 'Confirmação aceita';
                                $scope.estado = '2';
                      var link = 'https://ec2.diwoapp.com.br/irevento.php';
                      $http.post(link, {idevento : $scope.evento.idevento,
                                      idadm : $scope.evento.adm, 
                                      admusername : $scope.evento.admusername, 
                                      diainicio : $scope.evento.diainicio,
                                      diafim : $scope.evento.diafim,
                                      iduser : $scope.aux.iduser,
                                      borda : $scope.aux.borda,
                                      username: $scope.aux.username,
                                      profilepic : $scope.aux.profilepic,
                                      devicetoken : $scope.aux.devicetoken,
                                      apelido : $scope.aux.apelido,
                                      confirmacao : $scope.confirmacao,
                                      nomeevento :  $scope.evento.nomeevento,
                                      eventopic : $scope.evento.eventopic,
                                      idComercioParceiro : $scope.evento.idComercioParceiro, 
                                      estado : $scope.estado}).then(function (res){
                        $scope.response = res.data;
                        $http.post('https://ec2.diwoapp.com.br/deletapessoaevento.php', {iduser : $scope.aux.iduser,
                                                                                    idevento : $scope.evento.idevento,
                                                                                    estado: '5'});
                        if ($scope.response.success == true) {
                          $scope.evento.patual = parseInt($scope.evento.patual)+1;
                          $http.post('https://ec2.diwoapp.com.br/addpessoaevento.php', {idevento : $scope.evento.idevento,
                                                                          patual : $scope.evento.patual});
                          console.log($scope.evento.patual,$scope.evento.pmin , 'Número de pessoas alcançado do evento ')
                          if(parseInt($scope.evento.patual) == parseInt($scope.evento.pmin)){
                            EventoService.GetUserPorId($scope.evento.idComercioParceiro).then(function(comercio) {
                              $scope.msgnotiComercio = ('Número mínimo de pessoas alcançado do evento ' + $scope.evento.nomeevento );
                              noti.recebeusername = comercio.username;
                              noti.recebe = comercio.idComercioParceiro;
                              noti.envia = comercio.idComercioParceiro;
                              noti.tipo = 51;   //evento bateu numero minimo de pessoas para acontecer
                              noti.nomeevento = $scope.evento.nomeevento;
                                EventoService.VerificaNotificacao(noti).then(function(res) {
                                if(res){
                                  $http.post('https://ec2.diwoapp.com.br/notificapessoa.php', {notificacao : $scope.msgnotiComercio, 
                                                idevento : $scope.evento.idevento,
                                                nomeevento : $scope.evento.nomeevento,
                                                id_user_envia : $scope.evento.idComercioParceiro,
                                                username_envia : $scope.evento.nomeevento,
                                                apelido_envia : $scope.evento.nomeevento,
                                                tipo : '51',
                                                id_user_recebe : $scope.evento.idComercioParceiro});
                                    $scope.pushnoti.titulo =  'Número de pessoas alcançado!' ;
                                    $scope.pushnoti.msg = $scope.msgnotiComercio;
                                    $scope.pushnoti.token = comercio.devicetoken;
                                    EventoService.MandaPushNoti($scope.pushnoti);
                                    $scope.pushnoti.titulo =  'Número de pessoas alcançado!' ;
                                    $scope.pushnoti.msg = $scope.msgnotiComercio;
                                    $scope.pushnoti.token = 'dKpOML7ZLIA:APA91bFhTghUqP4gpCkohaf3h1WzCjDwQTrMg2JbUJjEQ9WegZgXWZQSNWtwoeAIu98bLK6wtSByVo1jluGyPmVmBxrvEWu6sluypuLk6O7F_18Z_e2kko7UQdK16Hu7O4qxsvstCmSI';
                                    EventoService.MandaPushNoti($scope.pushnoti);
                                }
                              });
                            });
                          }
                          $http.post("https://ec2.diwoapp.com.br/deletanotificacaoporids.php", {id_user_recebe : noti.recebe,
                                                                                    id_user_envia: noti.envia,
                                                                                    nomeevento: noti.nomeevento,
                                                                                    tipo : '5'});
                          var alertPopup = $ionicPopup.alert({
                            title: 'Parabéns',
                            template: $scope.response.msg
                          });
                          alertPopup.then(function(){
                            $http.post('https://ec2.diwoapp.com.br/deletapessoaevento.php', {iduser : $scope.aux.iduser,
                                                                                    idevento : $scope.evento.idevento,
                                                                                    estado: '7'}).then(function (res){
                            $scope.response = res.data;
                            //console.log(i);
                            $scope.fav = false;
                            });
                            $state.go('tabsController.home');
                          });
                          
                        }else{
                          var alertPopup = $ionicPopup.alert({
                            title: 'Ocorreu uma falha',
                            template: $scope.response.msg
                          });
                        }
                        console.log($scope.response.msg);
                    });
                              }}]
                       });
                  }else{
                      $scope.confirmacao = 'Confirmação aceita';
                      $scope.estado = '2';
                      console.log($scope.evento.idComercioParceiro, "ANSUIDNAIUSnd", $scope.evento.nomeevento);
                      // console.log($scope.aux.iduser);
                      // console.log($scope.confirmacao);
                      // console.log($scope.nomeevento);
                      // console.log($scope.estado);
                      var link = 'https://ec2.diwoapp.com.br/irevento.php';
                      $http.post(link, {idevento : $scope.evento.idevento,
                                      idadm : $scope.evento.adm, 
                                      admusername : $scope.evento.admusername, 
                                      diainicio : $scope.evento.diainicio,
                                      diafim : $scope.evento.diafim,
                                      iduser : $scope.aux.iduser,
                                      borda : $scope.aux.borda,
                                      username: $scope.aux.username,
                                      profilepic : $scope.aux.profilepic,
                                      devicetoken : $scope.aux.devicetoken,
                                      apelido : $scope.aux.apelido,
                                      confirmacao : $scope.confirmacao,
                                      nomeevento :  $scope.evento.nomeevento, 
                                      eventopic : $scope.evento.eventopic,
                                      idComercioParceiro : $scope.evento.idComercioParceiro, 
                                      estado : $scope.estado}).then(function (res){
                        $scope.response = res.data;
                        $http.post('https://ec2.diwoapp.com.br/deletapessoaevento.php', {iduser : $scope.aux.iduser,
                                                                                    idevento : $scope.evento.idevento,
                                                                                    estado: '5'});
                        if ($scope.response.success == true) {
                          $scope.evento.patual = parseInt($scope.evento.patual)+1;
                          $http.post('https://ec2.diwoapp.com.br/addpessoaevento.php', {idevento : $scope.evento.idevento,
                                                                          patual : $scope.evento.patual});
                          //console.log($scope.evento.patual,$scope.evento.pmin , 'Número de pessoas alcançado do evento dahushudauhuh')
                          if(parseInt($scope.evento.patual) == parseInt($scope.evento.pmin)){
                            //console.log("Passou pelo IF", $scope.evento.idComercioParceiro)
                            EventoService.GetUserPorId($scope.evento.idComercioParceiro).then(function(comercio) {
                              $scope.msgnotiComercio = ('Número mínimo de pessoas alcançado do evento ' + $scope.evento.nomeevento );
                              noti.recebeusername = comercio.username;
                              noti.recebe = comercio.idComercioParceiro;
                              noti.envia = comercio.idComercioParceiro;
                              noti.tipo = 51;   //evento bateu numero minimo de pessoas para acontecer
                              noti.nomeevento = $scope.evento.nomeevento;
                              //console.log(noti.nomeevento , "Idevento");
                                EventoService.VerificaNotificacao(noti).then(function(res) {
                                if(res){
                                  $http.post('https://ec2.diwoapp.com.br/notificapessoa.php', {notificacao : $scope.msgnotiComercio, 
                                                idevento : $scope.evento.idevento,
                                                nomeevento : $scope.evento.nomeevento,
                                                id_user_envia : $scope.evento.idComercioParceiro,
                                                username_envia : $scope.evento.nomeevento,
                                                apelido_envia : $scope.evento.nomeevento,
                                                tipo : '51',
                                                id_user_recebe : $scope.evento.idComercioParceiro});
                                    $scope.pushnoti.titulo =  'Número de pessoas alcançado!' ;
                                    $scope.pushnoti.msg = $scope.msgnotiComercio;
                                    $scope.pushnoti.token = comercio.devicetoken;
                                    EventoService.MandaPushNoti($scope.pushnoti);
                                    $scope.pushnoti.titulo =  'Número de pessoas alcançado!' ;
                                    $scope.pushnoti.msg = $scope.msgnotiComercio;
                                    $scope.pushnoti.token = 'dKpOML7ZLIA:APA91bFhTghUqP4gpCkohaf3h1WzCjDwQTrMg2JbUJjEQ9WegZgXWZQSNWtwoeAIu98bLK6wtSByVo1jluGyPmVmBxrvEWu6sluypuLk6O7F_18Z_e2kko7UQdK16Hu7O4qxsvstCmSI';
                                    console.log($scope.pushnoti.msg, "Mandando push");
                                    EventoService.MandaPushNoti($scope.pushnoti);
                                }
                              });
                            });
                          }




                          var alertPopup = $ionicPopup.alert({
                            title: 'Parabéns',
                            template: $scope.response.msg
                          });
                          alertPopup.then(function(){
                            $http.post('https://ec2.diwoapp.com.br/deletapessoaevento.php', {iduser : $scope.aux.iduser,
                                                                                    idevento : $scope.evento.idevento,
                                                                                    estado: '7'}).then(function (res){
                            $scope.response = res.data;
                            //console.log(i);
                            $scope.fav = false;
                            });
                            $state.go('tabsController.home');
                          });
                          
                        }else{
                          var alertPopup = $ionicPopup.alert({
                            title: 'Ocorreu uma falha',
                            template: $scope.response.msg
                          });
                        }
                        console.log($scope.response.msg);
                    });
                  }
                }else{
                  if(zone == 'yellow'){
                    var confirmPopup = $ionicPopup.show({
                         title: 'ZONA AMARELA',
                         template: 'Evento esta na ZONA AMARELA, caso voce desista uma vez que confirmado a presença tu sofrerás um cartão amarelo. Deseja ir mesmo assim?',
                         buttons: [
                            { text: 'Não sei se vou',
                              type: 'button-assertive',
                              onTap: function(e){
                                console.log('nada acontece');
                              }},
                            {
                              text: 'Quero ir',
                              type: 'button-positive',
                              onTap: function(e){
                                $scope.confirmacao = 'aguardando confirmação';
                                $scope.estado = '1';
                      // console.log($scope.evento.idevento);
                      // console.log($scope.aux.iduser);
                      // console.log($scope.confirmacao);
                      // console.log($scope.nomeevento);
                      // console.log($scope.estado);
                      var link = 'https://ec2.diwoapp.com.br/irevento.php';
                      $http.post(link, {idevento : $scope.evento.idevento,
                                      idadm : $scope.evento.adm, 
                                      admusername : $scope.evento.admusername, 
                                      diainicio : $scope.evento.diainicio,
                                      diafim : $scope.evento.diafim,
                                      iduser : $scope.aux.iduser,
                                      borda : $scope.aux.borda,
                                      username: $scope.aux.username,
                                      profilepic : $scope.aux.profilepic,
                                      devicetoken : $scope.aux.devicetoken,
                                      apelido : $scope.aux.apelido,
                                      confirmacao : $scope.confirmacao,
                                      nomeevento :  $scope.nomeevento,
                                      eventopic : $scope.evento.eventopic,
                                      idComercioParceiro : $scope.evento.idComercioParceiro, 
                                      estado : $scope.estado}).then(function (res){
                        $scope.response = res.data;
                        $http.post('https://ec2.diwoapp.com.br/deletapessoaevento.php', {iduser : $scope.aux.iduser,
                                                                                    idevento : $scope.evento.idevento,
                                                                                    estado: '5'});
                        if ($scope.response.success == true) {
                          $scope.msgnoti = ('To querendo ir no evento: ' + $scope.evento.nomeevento);
                          noti.recebe = $scope.evento.adm;
                          noti.envia = $scope.aux.iduser;
                          noti.tipo = 1;
                          noti.nomeevento = $scope.evento.nomeevento;
                          EventoService.VerificaNotificacao(noti).then(function(res) {
                            console.log(res);
                            if(res){
                              if($scope.evento.tipodeevento != "comercio" && $scope.evento.tipodeevento != "campanha"){
                                $http.post('https://ec2.diwoapp.com.br/notificacriador.php', {notificacao : $scope.msgnoti, 
                                      idevento : $scope.evento.idevento,
                                      nomeevento : $scope.evento.nomeevento,
                                      id_user_envia : $scope.aux.iduser,
                                      username_envia : $scope.aux.username,
                                      apelido_envia : $scope.aux.apelido,
                                      tipo : '1',
                                      id_user_recebe : $scope.evento.adm});
                             EventoService.getusuario2($scope.evento.admusername).then(function(user) {
                              if(user.noticriados== '1'){
                                $scope.pushnoti.titulo = $scope.evento.nomeevento;
                                $scope.pushnoti.msg = $scope.aux.username + " quer participar do evento";
                                $scope.pushnoti.token = user.devicetoken;
                                 EventoService.MandaPushNoti($scope.pushnoti);
                               }
                              });
                              }
                             
                             
                            }
                          });
                          $http.post("https://ec2.diwoapp.com.br/deletanotificacaoporids.php", {id_user_recebe : noti.recebe,
                                                                                    id_user_envia: noti.envia,
                                                                                    nomeevento: noti.nomeevento,
                                                                                    tipo : '5'});
                          var alertPopup = $ionicPopup.alert({
                            title: 'Parabéns',
                            template: $scope.response.msg
                          });
                          alertPopup.then(function(){
                            $http.post('https://ec2.diwoapp.com.br/deletapessoaevento.php', {iduser : $scope.aux.iduser,
                                                                                    idevento : $scope.evento.idevento,
                                                                                    estado: '7'}).then(function (res){
                            $scope.response = res.data;
                            //console.log(i);
                            $scope.fav = false;
                            });
                            $state.go('tabsController.home');
                          });
                          
                        }else{
                          var alertPopup = $ionicPopup.alert({
                            title: 'Ocorreu uma falha',
                            template: $scope.response.msg
                          });
                        }
                        console.log($scope.response.msg);
                    });
                              }}]
                       });
                  }else{
                      $scope.confirmacao = 'aguardando confirmação';
                      $scope.estado = '1';
                      // console.log($scope.evento.idevento);
                      // console.log($scope.aux.iduser);
                      // console.log($scope.confirmacao);
                      // console.log($scope.nomeevento);
                      // console.log($scope.estado);
                      var link = 'https://ec2.diwoapp.com.br/irevento.php';
                      $http.post(link, {idevento : $scope.evento.idevento,
                                      idadm : $scope.evento.adm, 
                                      admusername : $scope.evento.admusername, 
                                      diainicio : $scope.evento.diainicio,
                                      diafim : $scope.evento.diafim,
                                      iduser : $scope.aux.iduser,
                                      borda : $scope.aux.borda,
                                      username: $scope.aux.username,
                                      profilepic : $scope.aux.profilepic,
                                      devicetoken : $scope.aux.devicetoken,
                                      apelido : $scope.aux.apelido,
                                      confirmacao : $scope.confirmacao,
                                      nomeevento :  $scope.nomeevento, 
                                      eventopic : $scope.evento.eventopic,
                                      idComercioParceiro : $scope.evento.idComercioParceiro, 
                                      estado : $scope.estado}).then(function (res){
                        $scope.response = res.data;
                        $http.post('https://ec2.diwoapp.com.br/deletapessoaevento.php', {iduser : $scope.aux.iduser,
                                                                                    idevento : $scope.evento.idevento,
                                                                                    estado: '5'});
                        if ($scope.response.success == true) {
                          $scope.msgnoti = ('To querendo ir no evento: ' + $scope.evento.nomeevento);
                          noti.recebe = $scope.evento.adm;
                          noti.envia = $scope.aux.iduser;
                          noti.tipo = 1;
                          noti.nomeevento = $scope.evento.nomeevento;
                          EventoService.VerificaNotificacao(noti).then(function(res) {
                            console.log(res);
                            if(res){
                                 if($scope.evento.tipodeevento != "comercio" && $scope.evento.tipodeevento != "campanha"){
                                $http.post('https://ec2.diwoapp.com.br/notificacriador.php', {notificacao : $scope.msgnoti, 
                                      idevento : $scope.evento.idevento,
                                      nomeevento : $scope.evento.nomeevento,
                                      id_user_envia : $scope.aux.iduser,
                                      username_envia : $scope.aux.username,
                                      apelido_envia : $scope.aux.apelido,
                                      tipo : '1',
                                      id_user_recebe : $scope.evento.adm});
                             EventoService.getusuario2($scope.evento.admusername).then(function(user) {
                              if(user.noticriados== '1'){
                                $scope.pushnoti.titulo = $scope.evento.nomeevento;
                                $scope.pushnoti.msg = $scope.aux.username + " quer participar do evento";
                                $scope.pushnoti.token = user.devicetoken;
                                 EventoService.MandaPushNoti($scope.pushnoti);
                               }
                              });
                              }
                              
                            }
                          });
                          $http.post("https://ec2.diwoapp.com.br/deletanotificacaoporids.php", {id_user_recebe : noti.recebe,
                                                                                    id_user_envia: noti.envia,
                                                                                    nomeevento: noti.nomeevento,
                                                                                    tipo : '5'});


                                      /// PEDIR CONTATO DE ALGUEM DE FORA PARA FAZER O SERVIÇO DE CHAMAR
           



                          var alertPopup = $ionicPopup.alert({
                            title: 'Parabéns',
                            template: $scope.response.msg
                          });
                          alertPopup.then(function(){
                            $http.post('https://ec2.diwoapp.com.br/deletapessoaevento.php', {iduser : $scope.aux.iduser,
                                                                                    idevento : $scope.evento.idevento,
                                                                                    estado: '7'}).then(function (res){
                            $scope.response = res.data;
                            //console.log(i);
                            $scope.fav = false;
                            });
                            $state.go('tabsController.home');
                          });
                          
                        }else{
                          var alertPopup = $ionicPopup.alert({
                            title: 'Ocorreu uma falha',
                            template: $scope.response.msg
                          });
                        }
                        console.log($scope.response.msg);
                    });
                  }
                }
              }
        
        }else{
          $scope.borala = false;
          $scope.desistir = true;
        }
        $state.reload();
      }
    }else{
      var alertPopup = $ionicPopup.alert({
        title: '(⌯˃̶᷄ ﹏ ˂̶᷄⌯)ﾟ',
        template: 'Ficamos felizes em saber que você quer participar desse evento! Mas parece que ele está muito longe de você. Tente novamente quando você estiver mais perto!'
      });
    }
    
  }

  $scope.reservar = function(){
    var link = 'https://ec2.diwoapp.com.br/reservar.php';
                  $http.post(link, {idevento : $scope.evento.idevento, 
                                idadm : $scope.evento.adm, 
                                admusername : $scope.evento.admusername,
                                apelido : $scope.aux.apelido,  
                                iduser : $scope.aux.iduser,
                                diainicio : $scope.evento.diainicio,
                                diafim : $scope.evento.diafim,
                                username: $scope.aux.username,
                                confirmacao : 'na fila',
                                profilepic: $scope.aux.profilepic,
                                devicetoken : $scope.aux.devicetoken,
                                nomeevento :  $scope.nomeevento, 
                                estado : '8'}).then(function (res){
                  $scope.response = res.data;
                  var alertPopup = $ionicPopup.alert({
                      title: 'ヾ(･д･ヾ)',
                      template: 'Vamos avisar que tu ta querendo ir, vai que aumentao o limite máximo ou alguem desiste né? T avisaremos se algo acontecer'
                    });
                    $scope.msgnoti = ('To querendo ir no evento: ' + $scope.evento.nomeevento + ' mas ele esta cheio, da pra fazer algo?');
                    //console.log($scope.msgnoti);
                    noti.recebe = $scope.evento.adm;
                    noti.envia = $scope.aux.iduser;
                    noti.tipo = 8; // solicitando reserva
                    noti.nomeevento = $scope.evento.nomeevento;
                    EventoService.VerificaNotificacao(noti).then(function(res) {
                      console.log(res);
                      if(res){
                          if($scope.evento.tipodeevento != "comercio" && $scope.evento.tipodeevento != "campanha"){
                                $http.post('https://ec2.diwoapp.com.br/notificacriador.php', {notificacao : $scope.msgnoti, 
                                      idevento : $scope.evento.idevento,
                                      nomeevento : $scope.evento.nomeevento,
                                      id_user_envia : $scope.aux.iduser,
                                      username_envia : $scope.aux.username,
                                      apelido_envia : $scope.aux.apelido,
                                      tipo : '1',
                                      id_user_recebe : $scope.evento.adm});
                             EventoService.getusuario2($scope.evento.admusername).then(function(user) {
                              if(user.noticriados== '1'){
                                $scope.pushnoti.titulo = $scope.evento.nomeevento;
                                $scope.pushnoti.msg = $scope.aux.username + " quer participar do evento";
                                $scope.pushnoti.token = user.devicetoken;
                                 EventoService.MandaPushNoti($scope.pushnoti);
                               }
                              });
                              }
                      }
                    });
                    $http.post("https://ec2.diwoapp.com.br/deletanotificacaoporids.php", {id_user_recebe : noti.recebe,
                                                                              id_user_envia: noti.envia,
                                                                              nomeevento: noti.nomeevento,
                                                                              tipo : '5'});
                  $scope.reserva = false;
              });
    $state.reload();
  }

  $scope.desfavorita = function(){
    $http.post('https://ec2.diwoapp.com.br/deletapessoaevento.php', {iduser : $scope.aux.iduser,
                                                                        idevento : $scope.evento.idevento,
                                                                        estado: '7'});
    $scope.pinza = true;
    $scope.despinza = false;
  }

  $scope.favorita = function(){
   //    console.log("pinza", $scope.evento.adm, $scope.evento.admusername, $scope.aux.iduser, $scope.evento.diainicio, $scope.evento.diafim,
   // $scope.aux.borda,
   // $scope.aux.username,
   // $scope.aux.profilepic,
   // $scope.aux.devicetoken,
   // $scope.aux.apelido,
   // 'interesse',
   // $scope.nomeevento, )
    var link = 'https://ec2.diwoapp.com.br/irevento.php';
    $http.post(link, {idevento : $scope.evento.idevento, 
                              idadm : $scope.evento.adm, 
                              admusername : $scope.evento.admusername, 
                              iduser : $scope.aux.iduser,
                              diainicio : $scope.evento.diainicio,
                              diafim : $scope.evento.diafim,
                              borda : $scope.aux.borda,
                              username: $scope.aux.username,
                              profilepic : $scope.aux.profilepic,
                              devicetoken : $scope.aux.devicetoken,
                              apelido : $scope.aux.apelido,
                              confirmacao : 'interesse',
                              nomeevento :  $scope.nomeevento,
                              eventopic : $scope.evento.eventopic,
                              idComercioParceiro : $scope.evento.idComercioParceiro,  
                              estado : '7'});
    $scope.pinza = false;
    $scope.despinza = true;
  }

  $scope.reportar = function(){
    $scope.reportmsg = '';
    //console.log($scope.evento.admusername);
    $scope.report = [
      { text: "Conteúdo impróprio", checked: false },
      { text: "Linguajar inadequado", checked: false },
      { text: "Discurso de ódio", checked: false },
      { text: "Imagem imprópria", checked: false },
      { text: "Substancias ilicitas ", checked: false }
    ];
    $ionicPopup.confirm({
        title: 'Você quer reportar esse evento pq?',
        content: '<ion-checkbox ng-repeat="item in report" style="color: #FCFCFC;" ng-model="item.checked"  ng-checked="item.checked">{{item.text}}</ion-checkbox>',
        scope: $scope
    }).then(function(res) {
        if(res) {
          for (var h=0;h<3;h++){
            //console.log($scope.report[h].checked , h);
            if($scope.report[h].checked){
              $scope.reportmsg = $scope.reportmsg + $scope.report[h].text + ' ';
              //console.log($scope.reportmsg);
            }
          }
          if(h==3){
            console.log($scope.reportmsg);
            $http.post('https://ec2.diwoapp.com.br/reportaevento.php', {namereportado : $scope.evento.admusername,
                                                                            reportadoid : $scope.evento.idevento,
                                                                            iduserreportando : $scope.aux.iduser,
                                                                            usernamereportando : $scope.aux.username,
                                                                            tiporeport : 'evento',
                                                                            motivo : $scope.reportmsg}).then(function (tes){
              $scope.response = tes.data;
              var alertPopup = $ionicPopup.alert({
                                        title: 'Obrigado',
                                        template: 'Este evento esta agora sobre avaliação, obrigado por manter a plataforma organizada'
              });
            });
          }
        }
    });
  }

  $scope.deletar =  function(){
    if ($scope.criador == $scope.aux.iduser) {
      if(zone == 'red' || zone == 'yellow'){
        if(zone == 'red' ){
          var myPopup = $ionicPopup.show({
                template: '<input type="text" placeholder="Escreva aqui pq nao vai rolar" ng-model="data.desculpa">',
                title: 'ATENÇÃOOOOOO!!!',
                subTitle: 'Você esta preste a cancelar seu evento faltando muito pouco para seu começo, tens certeza disso?. Se tu realmente cancelar estaremos te dando um cartão vermelho. Para saber mais sobre eles va no seu indice de confirmação',
                scope: $scope,
                buttons: [
                  { text: 'Não' },
                  {
                    text: '<b>Sim</b>',
                    type: 'button-positive',
                    onTap: function(e) {
                      // console.log($scope.items.length);
                       var notifica = ("Desisti de fazer o evento, " + $scope.data.desculpa);
                      // console.log(notifica);
                      // console.log($scope.aux.iduser);
                    
                      formtelaCriar.updateForm(1);
                       $http.post('https://ec2.diwoapp.com.br/deletanotificacaoporevento.php' , {idevento : $scope.evento.idevento,
                                                                                    nomeevento : $scope.evento.nomeevento});
                      
                      $http.post('https://ec2.diwoapp.com.br/penalidade.php', {iduser : $scope.aux.iduser,
                                                                                   idevento : $scope.evento.idevento,
                                                                                   username : $scope.aux.username,
                                                                                   tipopenalidade : '2'});     // tipo2 saiu na redzone         
                      EventoService.GetParticipantes($scope.evento.idevento).then(function(ppl) {
                                   for (var i = 0; i < ppl.length; i++) {
                                    if ($scope.aux.iduser != ppl[i].iduser) {
                                          noti.recebeusername = ppl[i].username;
                                          noti.recebe = ppl[i].iduser;
                                          noti.envia = $scope.aux.iduser;
                                          noti.tipo = 4;
                                          noti.nomeevento = $scope.evento.nomeevento;
                                          EventoService.VerificaNotificacao(noti).then(function(res) {
                                            console.log(res);
                                            if(res){
                                            $http.post('https://ec2.diwoapp.com.br/notificapessoa.php', {notificacao : notifica, 
                                                    idevento : $scope.evento.idevento,
                                                    nomeevento : $scope.evento.nomeevento,
                                                    id_user_envia : $scope.aux.iduser,
                                                    username_envia : $scope.aux.username,
                                                    apelido_envia : $scope.aux.apelido,
                                                    tipo : '5',   
                                                    id_user_recebe : noti.recebe}).then(function (res){
                                                   $scope.response = res.data;
                                                   console.log($scope.response.msg)
                                                 });
                                              EventoService.getusuario2(noti.recebeusername).then(function(user) {
                                                if(user.notiparticipando== '1'){
                                                $scope.pushnoti.titulo = $scope.evento.nomeevento + ' Cancelado';
                                                $scope.pushnoti.msg = notifica;
                                                $scope.pushnoti.token = user.devicetoken;
                                                 EventoService.MandaPushNoti($scope.pushnoti);
                                               }
                                              });
                                            }
                                          });
                                        }
                                  }
                                 })
                      for(var i = 0; i< $scope.items.length; i++){
                        $http.post('https://ec2.diwoapp.com.br/deletapessoaevento.php', {iduser : $scope.items[i].iduser,
                                                                                           idevento : $scope.evento.idevento});
                      }
                      $scope.evento.estado = "3";
                      $scope.evento.datamodificacao = new Date();                
                      EventoService.atualizarevento($scope.evento);
                      $state.go('tabsController.home');
                    }
                  }
                ]
          });
          console.log('criador do evento cancelando proprio evento');
        }else{
          var myPopup = $ionicPopup.show({
                      template: '<input type="text" placeholder="Escreva aqui pq nao vai rolar" ng-model="data.desculpa">',
                      title: 'ATENÇÃO!!!',
                      subTitle: 'Você esta preste a cancelar seu evento faltando pouco para seu começo, tens certeza disso?. Se tu realmente cancelar estaremos te dando um cartão amarelo. Para saber mais sobre eles va no seu indice de confirmação',
                      scope: $scope,
                      buttons: [
                        { text: 'Não' },
                        {
                          text: '<b>Sim</b>',
                          type: 'button-positive',
                          onTap: function(e) {
                            // console.log($scope.items.length);
                             var notifica = ("Desisti de fazer o evento, " + $scope.data.desculpa);
                            // console.log(notifica);
                            // console.log($scope.aux.iduser);
                          
                            formtelaCriar.updateForm(1);
                             $http.post('https://ec2.diwoapp.com.br/deletanotificacaoporevento.php' , {idevento : $scope.evento.idevento,
                                                                                          nomeevento : $scope.evento.nomeevento});
                            
                           
                            $http.post('https://ec2.diwoapp.com.br/penalidade.php', {iduser : $scope.aux.iduser,
                                                                                       idevento : $scope.evento.idevento,
                                                                                       username : $scope.aux.username,
                                                                                       tipopenalidade : '1'});   // tipo 1 saiu na yellow zone               
                            EventoService.GetParticipantes($scope.evento.idevento).then(function(ppl) {
                                   for (var i = 0; i < ppl.length; i++) {
                                    console.log('Enviando')
                                    if ($scope.aux.iduser != ppl[i].iduser) {
                                          noti.recebeusername = ppl[i].username;
                                          noti.recebe = ppl[i].iduser;
                                          noti.envia = $scope.aux.iduser;
                                          noti.tipo = 4;
                                          noti.nomeevento = $scope.evento.nomeevento;
                                          EventoService.VerificaNotificacao(noti).then(function(res) {
                                            console.log(res);
                                            if(res){
                                              console.log('Enviando de vdd')
                                              $http.post('https://ec2.diwoapp.com.br/notificapessoa.php', {notificacao : notifica, 
                                                      idevento : $scope.evento.idevento,
                                                      nomeevento : $scope.evento.nomeevento,
                                                      id_user_envia : $scope.aux.iduser,
                                                      username_envia : $scope.aux.username,
                                                      apelido_envia : $scope.aux.apelido,
                                                      tipo : '5',   
                                                      id_user_recebe : noti.recebe}).then(function (res){
                                                     $scope.response = res.data;
                                                     console.log($scope.response.msg)
                                                   });
                                                EventoService.getusuario2(noti.recebeusername).then(function(user) {
                                                  if(user.notiparticipando== '1'){
                                                  $scope.pushnoti.titulo = $scope.evento.nomeevento + ' Cancelado';
                                                  $scope.pushnoti.msg = notifica;
                                                  $scope.pushnoti.token = user.devicetoken;
                                                   EventoService.MandaPushNoti($scope.pushnoti);
                                                 }
                                                });
                                              }
                                            });
                                        }
                                  }
                                 })
                             for(var i = 0; i< $scope.items.length; i++){
                              $http.post('https://ec2.diwoapp.com.br/deletapessoaevento.php', {iduser : $scope.items[i].iduser,
                                                                                                 idevento : $scope.evento.idevento});
                            }
                            $scope.evento.estado = "3";
                            $scope.evento.datamodificacao = new Date();                
                            EventoService.atualizarevento($scope.evento);
                            $state.go('tabsController.home');
                          }
                        }
                      ]
          });
          console.log('criador do evento cancelando proprio evento');
        }
      }else{
        var myPopup = $ionicPopup.show({
                  template: '<input type="text" placeholder="Escreva aqui pq nao vai rolar" ng-model="data.desculpa">',
                  title: 'SÉRIO?!?!',
                  subTitle: 'Você esta preste a deletar seu evento, tens certeza disso?',
                  scope: $scope,
                  buttons: [
                    { text: 'Não' },
                    {
                      text: '<b>Sim</b>',
                      type: 'button-positive',
                      onTap: function(e) {
                        // console.log($scope.items.length);
                         var notifica = ("Desisti de fazer o evento, " + $scope.data.desculpa);
                        // console.log(notifica);
                        // console.log($scope.aux.iduser);
                      
                        formtelaCriar.updateForm(1);
                         $http.post('https://ec2.diwoapp.com.br/deletanotificacaoporevento.php' , {idevento : $scope.evento.idevento,
                                                                                                    nomeevento : $scope.evento.nomeevento}).then(function(response) {console.log(response, 'deleta')});
                                    
                        
                        EventoService.GetParticipantes($scope.evento.idevento).then(function(ppl) {
                                   for (var i = 0; i < ppl.length; i++) {
                                    if ($scope.aux.iduser != ppl[i].iduser) {
                                          noti.recebeusername = ppl[i].username
                                          noti.recebe = ppl[i].iduser;
                                          noti.envia = $scope.aux.iduser;
                                          noti.tipo = 4;
                                          noti.nomeevento = $scope.evento.nomeevento;
                                          EventoService.VerificaNotificacao(noti).then(function(res) {
                                            console.log(res);
                                            if(res){
                                            $http.post('https://ec2.diwoapp.com.br/notificapessoa.php', {notificacao : notifica, 
                                                    idevento : $scope.evento.idevento,
                                                    nomeevento : $scope.evento.nomeevento,
                                                    id_user_envia : $scope.aux.iduser,
                                                    username_envia : $scope.aux.username,
                                                    apelido_envia : $scope.aux.apelido,
                                                    tipo : '5',   
                                                    id_user_recebe : noti.recebe}).then(function (res){
                                                   $scope.response = res.data;
                                                   console.log($scope.response.msg)
                                                 });
                                                EventoService.getusuario2(noti.recebeusername).then(function(user) {
                                                  if(user.notiparticipando== '1'){
                                                  $scope.pushnoti.titulo = $scope.evento.nomeevento + ' Cancelado';
                                                  $scope.pushnoti.msg = notifica;
                                                  $scope.pushnoti.token = user.devicetoken;
                                                   EventoService.MandaPushNoti($scope.pushnoti);
                                                 }
                                                });
                                              }
                                            });
                                        }
                                  }
                                 })
                          for(var i = 0; i< $scope.items.length; i++){
                          
                          $http.post('https://ec2.diwoapp.com.br/deletapessoaevento.php', {iduser : $scope.items[i].iduser,
                                                                                             idevento : $scope.evento.idevento});
                        }              
                         $scope.evento.estado = "3";
                         $scope.evento.datamodificacao = new Date();                
                       EventoService.atualizarevento($scope.evento);
                                            $state.go('tabsController.home');
                                            }
                    }]
                   });

                        console.log('criador do evento cancelando proprio evento');
        }
              
      }else{
        if (meuestado!=1) {


         if(zone == 'red' || zone == 'yellow'){
                          if(zone == 'red' ){

                               var confirmPopup = $ionicPopup.show({
                                         title: 'ATENÇÃO!!!',
                                         template: 'Você esta preste a desistir de um evento faltando muito pouco tempo para seu começo, tens certeza disso? Se tu realmente cancelar estaremos te dando um cartão vermelho. Para saber mais sobre eles va no seu indice de confirmação ',
                                         buttons: [
                                            { text: 'Não',
                                              type: 'button-assertive'},
                                            {
                                              text: 'Sim',
                                              type: 'button-positive',
                                              onTap: function(e){
                                               noti.recebeusername = $scope.evento.admusername; 
                                                noti.recebe = $scope.criador;
                                            noti.envia = $scope.aux.iduser;
                                            noti.tipo = 5;
                                            noti.nomeevento = $scope.evento.nomeevento;
                                            EventoService.VerificaNotificacao(noti).then(function(res) {
                                              console.log(res);
                                              if(res){
                                                $http.post('https://ec2.diwoapp.com.br/notificapessoa.php', {notificacao : 'Desisti de ir no seu evento, perdão', 
                                                      idevento : $scope.evento.idevento,
                                                      nomeevento : $scope.evento.nomeevento,
                                                      id_user_envia : $scope.aux.iduser,
                                                      username_envia : $scope.aux.username,
                                                      apelido_envia : $scope.aux.apelido,
                                                      tipo : '5', //pessoa desistiu
                                                      id_user_recebe : $scope.criador});
                                                EventoService.getusuario2(noti.recebeusername).then(function(user) {
                                                  if(user.noticriados== '1'){
                                                  $scope.pushnoti.titulo = 'Desisti';
                                                  $scope.pushnoti.msg = $scope.aux.username + ' desistiu de ir no seu evento';
                                                  $scope.pushnoti.token = user.devicetoken;
                                                   EventoService.MandaPushNoti($scope.pushnoti);
                                                 }
                                                });
                                              }
                                            });
                                            $http.post("https://ec2.diwoapp.com.br/deletanotificacaoporids.php", {id_user_recebe : noti.recebe,
                                                                              id_user_envia: noti.envia,
                                                                              nomeevento: noti.nomeevento,
                                                                              tipo : '1'});
                                            $http.post('https://ec2.diwoapp.com.br/penalidade.php', {iduser : $scope.aux.iduser,
                                                                                           idevento : $scope.evento.idevento,
                                                                                           username : $scope.aux.username,
                                                                                           tipopenalidade : '2'});     // tipo2 saiu na redzone  
                                            if(meuestado == 2){
                                               $scope.evento.patual = parseInt($scope.evento.patual)-1;
                                            }
                                            if(parseInt($scope.evento.patual)<parseInt($scope.evento.pmin)){
                                              $http.post('https://ec2.diwoapp.com.br/mudaestadoevento.php', {idevento : $scope.evento.idevento,
                                                                                                            estado : '2'});
                                              $http.post('https://ec2.diwoapp.com.br/notificapessoa.php', {notificacao : 'ATENÇÃO!! Numero de pessoas agora nao bate o mínimo.', 
                                                          idevento : $scope.evento.idevento,
                                                          nomeevento : $scope.evento.nomeevento,
                                                          id_user_envia : $scope.aux.iduser,
                                                          username_envia : $scope.aux.username,
                                                          apelido_envia : $scope.aux.apelido,
                                                          tipo : '12', //pessoa desistiu com menos pessoas para acontecer ou nao um evento
                                                          id_user_recebe : $scope.criador});
                                            }
                                            $http.post('https://ec2.diwoapp.com.br/addpessoaevento.php', {idevento : $scope.evento.idevento,
                                                                                                            patual : $scope.evento.patual});    
                                            $http.post('https://ec2.diwoapp.com.br/deletapessoaevento.php', {iduser : $scope.aux.iduser,
                                                                                                              idevento : $scope.evento.idevento});
                                            $state.go('tabsController.home');
                                                    }
                                                   }
                                                 ]
                                         })
                             }else{
                                 var confirmPopup = $ionicPopup.show({
                                         title: 'ATENÇÃO!!!',
                                         template: 'Você esta preste a desistir de um evento faltando pouco tempo para seu começo, tens certeza disso? Se tu realmente cancelar estaremos te dando um cartão amarelo. Para saber mais sobre eles va no seu indice de confirmação',
                                         buttons: [
                                            { text: 'Não',
                                              type: 'button-assertive'},
                                            {
                                              text: 'Sim',
                                              type: 'button-positive',
                                              onTap: function(e){
                                                noti.recebeusername = $scope.evento.username;
                                                noti.recebe = $scope.criador;
                                            noti.envia = $scope.aux.iduser;
                                            noti.tipo = 5;
                                            noti.nomeevento = $scope.evento.nomeevento;
                                              EventoService.VerificaNotificacao(noti).then(function(res) {
                                              console.log(res);
                                              if(res){
                                                $http.post('https://ec2.diwoapp.com.br/notificapessoa.php', {notificacao : 'Desisti de ir no seu evento, perdão', 
                                                      idevento : $scope.evento.idevento,
                                                      nomeevento : $scope.evento.nomeevento,
                                                      id_user_envia : $scope.aux.iduser,
                                                      username_envia : $scope.aux.username,
                                                      apelido_envia : $scope.aux.apelido,
                                                      tipo : '5', //pessoa desistiu
                                                      id_user_recebe : $scope.criador});
                                                EventoService.getusuario2(noti.recebeusername).then(function(user) {
                                                  if(user.noticriados== '1'){
                                                  $scope.pushnoti.titulo = 'Desisti';
                                                  $scope.pushnoti.msg = $scope.aux.username + ' desistiu de ir no seu evento';
                                                  $scope.pushnoti.token = user.devicetoken;
                                                   EventoService.MandaPushNoti($scope.pushnoti);
                                                 }
                                                });
                                              }
                                              });
                                              $http.post("https://ec2.diwoapp.com.br/deletanotificacaoporids.php", {id_user_recebe : noti.recebe,
                                                                              id_user_envia: noti.envia,
                                                                              nomeevento: noti.nomeevento,
                                                                              tipo : '1'});
                                                       $http.post('https://ec2.diwoapp.com.br/penalidade.php', {iduser : $scope.aux.iduser,
                                                                                                     idevento : $scope.evento.idevento,
                                                                                                     username : $scope.aux.username,
                                                                                                     tipopenalidade : '1'});   // tipo 1 saiu na yellow zone   
                                                      
                                                         $scope.evento.patual = parseInt($scope.evento.patual)-1;
                                                        $http.post('https://ec2.diwoapp.com.br/addpessoaevento.php', {idevento : $scope.evento.idevento,
                                                                                          patual : $scope.evento.patual});    
                                                    $http.post('https://ec2.diwoapp.com.br/deletapessoaevento.php', {iduser : $scope.aux.iduser,
                                                                                                                        idevento : $scope.evento.idevento});
                                                      $state.go('tabsController.home');
                                                    }
                                                   }
                                                 ]
                                         })

                             }
                           
                         }else{
                             var confirmPopup = $ionicPopup.show({
                                         title: 'ATENÇÃO!!!',
                                         template: 'Você esta preste a desistir de um evento, tens certeza disso?',
                                         buttons: [
                                            { text: 'Não',
                                              type: 'button-assertive'},
                                            {
                                              text: 'Sim',
                                              type: 'button-positive',
                                              onTap: function(e){
                                                noti.recebeusername = $scope.evento.admusername;
                                                noti.recebe =$scope.criador;
                                            noti.envia = $scope.aux.iduser;
                                            noti.tipo = 5;
                                            noti.nomeevento = $scope.evento.nomeevento;
                                            EventoService.VerificaNotificacao(noti).then(function(res) {
                                              console.log(res);
                                              if(res){
                                                $http.post('https://ec2.diwoapp.com.br/notificapessoa.php', {notificacao : 'Desisti de ir no seu evento, perdão', 
                                                      idevento : $scope.evento.idevento,
                                                      nomeevento : $scope.evento.nomeevento,
                                                      id_user_envia : $scope.aux.iduser,
                                                      username_envia : $scope.aux.username,
                                                      apelido_envia : $scope.aux.apelido,
                                                      tipo : '5', //pessoa desistiu
                                                      id_user_recebe : $scope.criador}).then(function (res){
                                                     $scope.response = res.data;
                                                     //console.log($scope.response.msg)
                                                   });
                                                EventoService.getusuario2(noti.recebeusername).then(function(user) {
                                                  if(user.noticriados== '1'){
                                                  $scope.pushnoti.titulo = 'Desisti';
                                                  $scope.pushnoti.msg = $scope.aux.username + ' desistiu de ir no seu evento';
                                                  $scope.pushnoti.token = user.devicetoken;
                                                   EventoService.MandaPushNoti($scope.pushnoti);
                                                 }
                                                });
                                              }
                                            });
                                            $http.post("https://ec2.diwoapp.com.br/deletanotificacaoporids.php", {id_user_recebe : noti.recebe,
                                                                              id_user_envia: noti.envia,
                                                                              nomeevento: noti.nomeevento,
                                                                              tipo : '1'});
                                                       if(meuestado == 2){
                                                         $scope.evento.patual = parseInt($scope.evento.patual)-1;
                                                        }
                                                    $http.post('https://ec2.diwoapp.com.br/addpessoaevento.php', {idevento : $scope.evento.idevento,
                                                                                                                    patual : $scope.evento.patual});    
                                                    $http.post('https://ec2.diwoapp.com.br/deletapessoaevento.php', {iduser : $scope.aux.iduser,
                                                                                                                        idevento : $scope.evento.idevento});
                                                      $state.go('tabsController.home');
                                                    }
                                                   }
                                                 ]
                                         })
                           }


                }else{
                   var confirmPopup = $ionicPopup.show({
                                         title: 'ATENÇÃO!!!',
                                         template: 'Você esta preste a desistir de um evento, tens certeza disso?',
                                         buttons: [
                                            { text: 'Não',
                                              type: 'button-assertive'},
                                            {
                                              text: 'Sim',
                                              type: 'button-positive',
                                              onTap: function(e){
                                                noti.recebeusername = $scope.evento.username;
                                                noti.recebe =$scope.criador;
                                            noti.envia = $scope.aux.iduser;
                                            noti.tipo = 5;
                                            noti.nomeevento = $scope.evento.nomeevento;
                                            EventoService.VerificaNotificacao(noti).then(function(res) {
                                              console.log(res);
                                              if(res){
                                                $http.post('https://ec2.diwoapp.com.br/notificapessoa.php', {notificacao : 'Desisti de ir no seu evento, perdão', 
                                                      idevento : $scope.evento.idevento,
                                                      nomeevento : $scope.evento.nomeevento,
                                                      id_user_envia : $scope.aux.iduser,
                                                      username_envia : $scope.aux.username,
                                                      apelido_envia : $scope.aux.apelido,
                                                      tipo : '5', //pessoa desistiu
                                                      id_user_recebe : $scope.criador}).then(function (res){
                                                     $scope.response = res.data;
                                                     //console.log($scope.response.msg)
                                                   });
                                                EventoService.getusuario2(noti.recebeusername).then(function(user) {
                                                  if(user.noticriados== '1'){
                                                  $scope.pushnoti.titulo = 'Desisti';
                                                  $scope.pushnoti.msg = $scope.aux.username + ' desistiu de ir no seu evento';
                                                  $scope.pushnoti.token = user.devicetoken;
                                                   EventoService.MandaPushNoti($scope.pushnoti);
                                                 }
                                                });
                                              }
                                            });
                                            $http.post("https://ec2.diwoapp.com.br/deletanotificacaoporids.php", {id_user_recebe : noti.recebe,
                                                                              id_user_envia: noti.envia,
                                                                              nomeevento: noti.nomeevento,
                                                                              tipo : '1'});
                                                       if(meuestado == 2){
                                                         $scope.evento.patual = parseInt($scope.evento.patual)-1;
                                                        }
                                                    $http.post('https://ec2.diwoapp.com.br/addpessoaevento.php', {idevento : $scope.evento.idevento,
                                                                                                                    patual : $scope.evento.patual});    
                                                    $http.post('https://ec2.diwoapp.com.br/deletapessoaevento.php', {iduser : $scope.aux.iduser,
                                                                                                                        idevento : $scope.evento.idevento});
                                                      $state.go('tabsController.home');
                                                    }
                                                   }
                                                 ]
                                         })
                }



            }           
            $state.reload();
  }
  
}])

    
.controller('eventoPinzadoCtrl', ['$scope', '$stateParams', 'formItem', 'formUser', 'formtelaCriar', 'formOutro', '$http', '$timeout','$ionicPopup', 'EventoService', '$state', 'formEventoAbertosTab',// The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, formItem, formUser, formtelaCriar, formOutro, $http, $timeout, $ionicPopup, EventoService, $state, formEventoAbertosTab) {

  //$scope.evento = formItem.getForm();
  $scope.evento = formEventoAbertosTab.getForm();
  $scope.aux = formUser.getForm();

  $scope.tag = '';
  $scope.nuser = 0;
  var datainvalida = 0;
  $scope.pushnoti = {};
  $scope.borala = true;
  $scope.aviso =false;
  $scope.desistir = false;
  $scope.reserva = false;
  $scope.chathome = false;
  $scope.pinza = false;
  $scope.despinza = false;
  $scope.data = {};
  $scope.auxdata ={};
  $scope.limiteconfirmacao ={};
  $scope.fim = {};
  $scope.dia = {};

  var hj = $scope.evento.diainicio;
  var ano = (hj[0]+hj[1]+hj[2]+hj[3]).valueOf();
  var mes = (hj[5]+hj[6]).valueOf();
  var dia = (hj[8]+hj[9]).valueOf();

  var h = (hj[11]+hj[12]).valueOf();
  var m = (hj[14]+hj[15]).valueOf();

  var currentdate = new Date(); 
  var curr_date = (currentdate.getDate()<10?'0':'') + currentdate.getDate();
  var curr_month = (currentdate.getMonth()<10?'0':'') + (currentdate.getMonth() + 1); 
  var curr_year = currentdate.getFullYear();
  var h2 = (currentdate.getHours()<10?'0':'') + currentdate.getHours();
  var m2 = (currentdate.getMinutes()<10?'0':'') + currentdate.getMinutes();
    
  var  hjl = $scope.evento.dialimiteconfirmacao;
  $scope.dialimiteconfirmacao =  (hjl[8]+hjl[9]).valueOf()+'/'+(hjl[5]+hjl[6]).valueOf()+'/'+(hjl[0]+hjl[1]+hjl[2]+hjl[3])+' '+(hjl[11]+hjl[12]).valueOf()+':'+(hjl[14]+hjl[15]).valueOf();
    
  //$scope.dia = dia+'/'+mes+'/'+ano+' '+h+':'+m;

  var hjf = $scope.evento.diafim;
  $scope.diafim =  (hjf[8]+hjf[9]).valueOf()+'/'+(hjf[5]+hjf[6]).valueOf()+'/'+(hjf[0]+hjf[1]+hjf[2]+hjf[3])+' '+(hjf[11]+hjf[12]).valueOf()+':'+(hjf[14]+hjf[15]).valueOf();
    
  var zone;
  var meuestado;
  var noti = {};
  var confirm = $scope.aux.iduser;

  var ano5 = (hjl[0]+hjl[1]+hjl[2]+hjl[3]).valueOf()-curr_year;
  var mes5 = (hjl[5]+hjl[6]).valueOf()-curr_month;
  var dia5 = (hjl[8]+hjl[9]).valueOf()-curr_date;
  var h5 = (hjl[11]+hjl[12]).valueOf()-h2;
  var m5 = (hjl[14]+hjl[15]).valueOf()-m2;

  var hjd = $scope.evento.duracao;
  var hd = (hjd[0]+hjd[1]).valueOf();
  var md = (hjd[3]+hjd[4]).valueOf();
  $scope.duracao= hd+':'+md;

  var  hjl = $scope.evento.dialimiteconfirmacao;
  $scope.limiteconfirmacao.dia =  (hjl[8]+hjl[9]).valueOf()+'/'+(hjl[5]+hjl[6]).valueOf();
  $scope.limiteconfirmacao.hora =  (hjl[11]+hjl[12]).valueOf()+':'+(hjl[14]+hjl[15]).valueOf();  
  
  

  var hjf = $scope.evento.diafim;
  $scope.fim.dia =  (hjf[8]+hjf[9]).valueOf()+'/'+(hjf[5]+hjf[6]).valueOf()+'/'+(hjf[0]+hjf[1]+hjf[2]+hjf[3]);
  $scope.fim.hora = (hjf[11]+hjf[12]).valueOf()+':'+(hjf[14]+hjf[15]).valueOf();
  $scope.dia.dia = (hj[8]+hj[9]).valueOf()+'/'+(hj[5]+hj[6]).valueOf();
  $scope.dia.hora = (hj[11]+hj[12]).valueOf()+':'+(hj[14]+hj[15]).valueOf() +' - '+(hjf[11]+hjf[12]).valueOf()+':'+(hjf[14]+hjf[15]).valueOf() ;


  

  if(ano5 == 0 && mes5 == 0 && dia5 == 0 && ((h5 == 1 && m5<30 && m5>0)||(h5==0 && m5 > 30)|| (h5==1 && m5>-30))){
    console.log('YELLOWZONE');
    zone = 'yellow';
    $scope.confirmaPessoa =true;
  }
  if(ano5<0 || mes5 < 0 ||(ano5 == 0 && mes5 == 0 && (dia5 < 0 || (dia5==0 && ((h5 == 0 && m5<=0)||(h5 < 0)))))){
    console.log('REDZONE');
    $scope.borala = false;
    $scope.aviso =true;
    zone = 'red';
    $scope.confirmaPessoa =false;
    $scope.deletarPessoa = false;
    $scope.edita = false;
  }else{
    $scope.borala = true;
    $scope.aviso =false;
  }
  if($scope.evento.preco == 0 || $scope.evento.preco =="Gratuito"){
      $scope.evento.preco = "Gratuito";
      $scope.porpessoa = false;
      $scope.porlocal = false;
    }else{
      if($scope.evento.precopor == 1){
        $scope.porpessoa = true;
        $scope.porlocal = false;
      }else{
        $scope.porpessoa = false;
        $scope.porlocal = true;
      }
    }

  if($scope.evento.adm ==  $scope.aux.iduser){
    $scope.deletarPessoa = true;
    $scope.confirmaPessoa =true;
    if(zone == 'red'){
      $scope.edita = false;
      $scope.deletarPessoa = false;
    }else{
      $scope.edita = true;
    }
    
  }
  if($scope.evento.genero == "masc"){
      $scope.masc = true;
      $scope.fem = false;
    }
    if($scope.evento.genero == "fem"){
        $scope.fem = true;
        $scope.masc = false;
    }
    if($scope.evento.genero == "todos"){
        $scope.fem = false;
        $scope.masc = false;
    }
  

  console.log($scope.evento.patual , $scope.evento.pmin)
  if(parseInt($scope.evento.patual) < parseInt($scope.evento.pmin) && zone == 'red'){
    console.log('Evento não acontece por falta de pessoas')
  }
  if(parseInt($scope.evento.patual) < parseInt($scope.evento.pmin) && zone == 'yellow'){
    console.log('Evento esta com poucas pessoas, talvez ele nao aconteça')
  }
  

  $scope.$on("$ionicView.enter", function(event, data){
    $scope.pushnoti = {};
    $scope.tag = '';
    $scope.items = [];
    $scope.pinza = false;
    $scope.despinza = false;
    //$scope.evento = formItem.getForm();
    $scope.evento = formEventoAbertosTab.getForm();
    $scope.aux = formUser.getForm();
    datainvalida = 0;

    $scope.auxdata ={};

            // Ve se eu tenho ou não interesse nesse evento
    $scope.auxpinza ={};
    $scope.auxpinza.iduser = $scope.aux.iduser;
    $scope.auxpinza.idevento = $scope.evento.idevento;

    EventoService.verificahorariopessoaeventoconfirmados($scope.aux).then(function(items) {
      $scope.auxdata = items;
      for(var r = 0;r<$scope.auxdata.length; r++){
        //console.log($scope.auxdata[r].idevento, $scope.auxdata[r].diainicio, $scope.auxdata[r].diafim , we ,$scope.evento.diafim);
        if($scope.evento.idevento!=$scope.auxdata[r].idevento){
          if (($scope.auxdata[r].diainicio < $scope.evento.diainicio && $scope.auxdata[r].diafim > $scope.evento.diainicio) || ($scope.auxdata[r].diainicio<$scope.evento.diafim && $scope.auxdata[r].diafim>$scope.evento.diafim) ||($scope.auxdata[r].diainicio > $scope.evento.diainicio && $scope.auxdata[r].diafim<$scope.evento.diafim) || ($scope.auxdata[r].diainicio < $scope.evento.diainicio && $scope.auxdata[r].diafim>$scope.evento.diafim) ) {
            console.log('horario invalido');
            datainvalida = 1;
          }
        }
      }
    });

    if($scope.aux.iduser != $scope.evento.adm){
       $scope.edita = false;
       console.log($scope.auxpinza.iduser)

      EventoService.Getpinza($scope.auxpinza).then(function(items) {
        //console.log(items.success)
        if(items.success != false){
          if (items[0].estado == 7) {
            $scope.pinza = false;
            $scope.despinza = true;
            console.log('eh favorito')
          }
        }else{
          console.log('N eh')
          $scope.pinza = true;
          $scope.despinza = false;
        } 
      });
    }else{
       if(zone == 'red'){
          $scope.edita = false;
        }else{
          $scope.edita = true;
        }
      $scope.pinza = false;
      $scope.despinza = false;
    }
    
            //Pega tags do evento
    EventoService.Gettags($scope.evento.idevento).then(function(tags) {
      for(var  i =0; i< tags.length;i++){
        $scope.tag = ($scope.tag + ' ' + tags[i].tag);
      } 
    });
            //Capacidade do evento
    if(parseInt($scope.evento.pmax) <= parseInt($scope.evento.patual)){
        console.log('Evento cheio');
        $scope.borala = false;
        $scope.reserva = true;
    }

    EventoService.GetParticipantes($scope.evento.idevento).then(function(parti) {
      //console.log($scope.items[0].idevento);
      $scope.nomeevento = parti[0].nomeevento;
      for (var i = 0; i < parti.length; i++) {
        if ($scope.aux.iduser == parti[i].iduser && parti[i].estado!=7 && parti[i].estado!=8) {
          $scope.nuser++;
          $scope.borala = false;
          $scope.reserva = false;
          $scope.desistir = true;
          $scope.chathome = true;
        }
        if ($scope.aux.iduser == parti[i].iduser) {
          meuestado = parti[i].estado;
        }
        if ($scope.aux.iduser == parti[i].iduser && parti[i].estado == 7) {
          $scope.pinza = false;
          $scope.despinza = true;
        }
        if ($scope.aux.iduser == parti[i].iduser && parti[i].estado == 8) {
          $scope.reserva = false;
          var alertPopup = $ionicPopup.alert({
                          title: 'ლ(*꒪ヮ꒪*)ლ',
                          template: 'Tais na fila da reserva, se vagar t avisaremos'
          });
          console.log('reservado');
        }            
      }
    });
    
    EventoService.GetParticipantesSemFav($scope.evento.idevento).then(function(items) {
      for (var i = 0; i < items.length; i++) {
        if (items[i].estado == 0) {
          items[i].confirmacao = 'Sou o organizador';
          $scope.criador = items[i].iduser;
        }
        if (items[i].estado == 1) {
          items[i].confirmacao = 'Aguardando confirmação';
        }
        if (items[i].estado == 2) {
          items[i].confirmacao = 'Confirmado';
        }
        if(items[i].borda == 0){
            items[i].bb = false;
            items[i].bs = false;
            items[i].bg = false;
          }
          if(items[i].borda == 1){
            items[i].bb = true;
            items[i].bs = false;
            items[i].bg = false;
          }
          if(items[i].borda == 2){
            items[i].bb = false;
            items[i].bs = true;
            items[i].bg = false;
          }
          if(items[i].borda == 3){
            items[i].bb = false;
            items[i].bs = false;
            items[i].bg = true;
          }
          if((items[i].profilepic[8] == 's' && items[i].profilepic[9] == '3')||(items[i].profilepic[8] == 'd' && items[i].profilepic[9] == 'i')){
          
             items[i].profilepic=items[i].profilepic+"?{{getTimeStamp()}}";
           }else{
             items[i].profilepic=items[i].profilepic;
           }
      }
      $scope.items = items.concat($scope.items);
    });
  });

  $scope.enterItem =  function(item){
      formOutro.updateForm(item);
      $state.go('tabsController.perfil_outro_eventoabertos');
    }
    

    $scope.Vermapa = function(){
      $state.go('tabsController.ver_onde_mapa_Eventoabertos');
    }

  $scope.editar = function(){
    
    $state.go('tabsController.EditaEEAPart1');
  }

  $scope.aprova = function(item){
    console.log(meuestado)
    if(meuestado == 1 || meuestado == 8 || meuestado == 7 ){
                var alertPopup = $ionicPopup.alert({
                          title: '(°ロ°)☝',
                          template: 'Ainda não foi confirmado para poder aprovar alguem'
                        });
    }else{
      if(item.estado == 1 ){
        if (item.iduser!=$scope.aux.iduser  && confirm!= item.iduser) {
                confirm = item.iduser;
                console.log(item.iduser, $scope.aux.iduser);
                $scope.msgnoti = ('Tu foi aceito no evento: ' + $scope.evento.nomeevento);
                $scope.evento.patual = parseInt($scope.evento.patual)+1;
                $http.post('https://ec2.diwoapp.com.br/addpessoaevento.php', {idevento : $scope.evento.idevento,
                                                                                patual : $scope.evento.patual});
                $http.post('https://ec2.diwoapp.com.br/atualizarpessoaevento.php' , {iduser : item.iduser,
                                                                                  idevento : $scope.evento.idevento,
                                                                                  confirmacao : 'Confirmação aceita',
                                                                                  estado :2});
                noti.recebeusername = item.username;
                noti.recebe = item.iduser;
                noti.envia = $scope.aux.iduser;
                noti.tipo = 2;
                noti.nomeevento = $scope.evento.nomeevento;
                $http.post("https://ec2.diwoapp.com.br/deletanotificacaoporids.php", {id_user_recebe : $scope.evento.adm,
                                                                              id_user_envia: item.iduser,
                                                                              nomeevento: noti.nomeevento,
                                                                              tipo : '1'});
                EventoService.VerificaNotificacao(noti).then(function(res) {
                  console.log(res);
                  if(res){
                    $http.post('https://ec2.diwoapp.com.br/notificapessoa.php', {notificacao : $scope.msgnoti, 
                                          idevento : $scope.evento.idevento,
                                          nomeevento : $scope.evento.nomeevento,
                                          id_user_envia : $scope.aux.iduser,
                                          username_envia : $scope.aux.username,
                                          apelido_envia : $scope.aux.apelido,
                                          tipo : '2',
                                          id_user_recebe : noti.recebe});
                    EventoService.getusuario2(noti.recebeusername).then(function(user) {
                      if(user.notiparticipando== '1'){
                      $scope.pushnoti.titulo =  'Boraaa!!!' ;
                      $scope.pushnoti.msg = $scope.msgnoti;
                      $scope.pushnoti.token = user.devicetoken;
                       EventoService.MandaPushNoti($scope.pushnoti);
                     }
                    });
                  }
                });
                 var alertPopup = $ionicPopup.alert({
                          title: '(/^▽^)/',
                          template: 'Vamos avisa-lo que ele foi aprovado, obrigado.'
                        });
                 item.confirmacao = 'Confirmação aprovada';

              
        }else{
          if(confirm ==  item.iduser){
            var alertPopup = $ionicPopup.alert({
                          title: '༼ つ ◕_◕ ༽つ',
                          template: 'Ja esta confirmado nesse evento!!!'
                        });
          }else{
              var alertPopup = $ionicPopup.alert({
                          title: 'ಠ_ಠ',
                          template: 'Seria muito facil tu se aceitar no evento né?'
                        });
          }
        }
      }
      if(item.estado == 2 ){
        var alertPopup = $ionicPopup.alert({
                      title: '༼ つ ◕_◕ ༽つ',
                      template: 'Ja esta confirmado nesse evento!!!'
                    });
        console.log('Ja estou confirmado')
      }
      console.log($scope.evento.diainicio)
      if(item.estado == 8 ){
        if(parseInt($scope.evento.patual)<parseInt($scope.evento.pmax)  && confirm!= item.iduser){
                confirm = item.iduser;
                console.log(item.iduser, $scope.aux.iduser);
                $scope.msgnoti = ('Tu foi aceito no evento: ' + $scope.evento.nomeevento);
                $scope.evento.patual = parseInt($scope.evento.patual)+1;
                $http.post('https://ec2.diwoapp.com.br/addpessoaevento.php', {idevento : $scope.evento.idevento,
                                                                                patual : $scope.evento.patual});
                $http.post('https://ec2.diwoapp.com.br/atualizarpessoaevento.php' , {iduser : item.iduser,
                                                                                  idevento : $scope.evento.idevento,
                                                                                  confirmacao : 'Confirmação aceita',
                                                                                  estado :2});
                noti.recebeusername = item.username;
                noti.recebe = item.iduser;
                noti.envia = $scope.aux.iduser;
                noti.tipo = 2;
                noti.nomeevento = $scope.evento.nomeevento;
                EventoService.VerificaNotificacao(noti).then(function(res) {
                  console.log(res);
                  if(res){
                $http.post('https://ec2.diwoapp.com.br/notificapessoa.php', {notificacao : $scope.msgnoti, 
                                          idevento : $scope.evento.idevento,
                                          nomeevento : $scope.evento.nomeevento,
                                          id_user_envia : $scope.aux.iduser,
                                          username_envia : $scope.aux.username,
                                          apelido_envia : $scope.aux.apelido,
                                          tipo : '2',
                                          id_user_recebe : noti.recebe});
                 EventoService.getusuario2(noti.recebeusername).then(function(user) {
                  if(user.notiparticipando== '1'){
                    $scope.pushnoti.titulo =  'Boraaa!!!' ;
                    $scope.pushnoti.msg = $scope.msgnoti;
                    $scope.pushnoti.token = user.devicetoken;
                     EventoService.MandaPushNoti($scope.pushnoti);
                   }
                  });
                }
              });
                  var alertPopup = $ionicPopup.alert({
                      title: '(°◡°♡).:｡',
                      template: 'Vamos confirmar a presença dele!!'
                    });
                 item.confirmacao = 'Confirmação aprovada';
         
        console.log('Ja estou confirmado')
        }else{
            var alertPopup = $ionicPopup.alert({
                        title: '(◕⌓◕;)',
                        template: 'Evento esta cheio, ou aumenta o numero de vagas ou escolha alguem para excluir do evento'
                      });
          console.log('Esta cheio o evento')
        }
      }
      if (item.estado == 0) {
                var alertPopup = $ionicPopup.alert({
                          title: 'ლ(́◉◞౪◟◉‵ლ)',
                          template: 'Ja sou o organizador, não preciso me confirmar'
                        });
      }
    }
  }

  $scope.onItemDelete = function(item) {
    if (item.iduser == $scope.aux.iduser) {
      var alertPopup = $ionicPopup.alert({
                      title: 'Oi?',
                      template: 'Tu és o organizador, não podes se deletar do seu evento, podes cancelar ele'
      });
    }else{
      var confirmPopup = $ionicPopup.show({
                   title: 'ATENÇÃO!!!',
                   template: 'Você esta preste excluir pessoa do evento, ela não poderá mais entrar neste evento, tens certeza disso?',
                   buttons: [
                      { text: 'Não',
                        type: 'button-assertive'},
                      {
                        text: 'Sim',
                        type: 'button-positive',
                        onTap: function(e){
                        noti.recebeusername = item.username;
                        noti.recebe = item.iduser;
                        noti.envia = $scope.aux.iduser;
                        noti.tipo = 9;
                        noti.nomeevento = $scope.evento.nomeevento;
                        EventoService.VerificaNotificacao(noti).then(function(res) {
                        console.log(res);
                        if(res){
                          $http.post('https://ec2.diwoapp.com.br/notificapessoa.php', {notificacao : 'Tu foi retirado do evento', 
                                                                                          idevento : $scope.evento.idevento,
                                                                                          nomeevento : $scope.evento.nomeevento,
                                                                                          id_user_envia : $scope.aux.iduser,
                                                                                          username_envia : $scope.aux.username,
                                                                                          apelido_envia : $scope.aux.apelido,
                                                                                          tipo : '9', //pessoa kickada
                                                                                          id_user_recebe : noti.recebe});
                          EventoService.getusuario2(noti.recebeusername).then(function(user) {
                            if(user.notiparticipando== '1'){
                            $scope.pushnoti.titulo = 'Retirado do evento';
                            $scope.pushnoti.msg = 'Você foi retirado do evento: ' + $scope.evento.nomeevento;
                            $scope.pushnoti.token = user.devicetoken;
                             EventoService.MandaPushNoti($scope.pushnoti);
                           }
                          });
                        }
                      });
                          $http.post('https://ec2.diwoapp.com.br/deletapessoaevento.php', {iduser :item.iduser,
                                                                                              idevento : $scope.evento.idevento});
                          $http.post('https://ec2.diwoapp.com.br/deletachat.php', {iduser : item.iduser,
                                                                                      idevento : $scope.aux.idevento}); 
                          if(item.estado == 2){
                           $scope.evento.patual = parseInt($scope.evento.patual)-1;
                          }
                          $http.post('https://ec2.diwoapp.com.br/addpessoaevento.php', {idevento : $scope.evento.idevento,
                                                                                          patual : $scope.evento.patual});     
                          $http.post('https://ec2.diwoapp.com.br/pessoanaoevento.php', {iduser : item.iduser, 
                                                                                          idevento : $scope.evento.idevento,
                                                                                          nomeevento : $scope.evento.nomeevento,
                                                                                          estado : '1'});//foi kickado
                                                                                             

                          $scope.items.splice($scope.items.indexOf(item), 1);      
                              }
                             }
                           ]
                   })


      
    }
  }  

  $scope.confirma = function(){
    if(datainvalida==1){
      var alertPopup = $ionicPopup.alert({
        title: 'ಠ_ಠ',
        template: 'Ja tens um evento marcado nesta data querido'
      });
    }else{
      if ($scope.nuser == 0) {
            if (!$scope.evento.idevento || !$scope.aux.iduser) {
                            var alertPopup = $ionicPopup.alert({
                            title: 'Vish deu ruim',
                            template: 'Favor refaça seu login'
                          });

            }else{
              if(zone == 'yellow'){
                var confirmPopup = $ionicPopup.show({
                     title: 'ZONA AMARELA',
                     template: 'Evento esta na ZONA AMARELA, caso voce desista uma vez que confirmado a presença tu sofrerás um cartão amarelo. Deseja ir mesmo assim?',
                     buttons: [
                        { text: 'Não sei se vou',
                          type: 'button-assertive',
                          onTap: function(e){
                            console.log('nada acontece');
                          }},
                        {
                          text: 'Quero ir',
                          type: 'button-positive',
                          onTap: function(e){
                            $scope.confirmacao = 'aguardando confirmação';
                  $scope.estado = '1';
                  // console.log($scope.evento.idevento);
                  // console.log($scope.aux.iduser);
                  // console.log($scope.confirmacao);
                  // console.log($scope.nomeevento);
                  // console.log($scope.estado);
                  var link = 'https://ec2.diwoapp.com.br/irevento.php';
                  $http.post(link, {idevento : $scope.evento.idevento,
                                  idadm : $scope.evento.adm, 
                                  admusername : $scope.evento.admusername, 
                                  diainicio : $scope.evento.diainicio,
                                  diafim : $scope.evento.diafim,
                                  iduser : $scope.aux.iduser,
                                  username: $scope.aux.username,
                                  profilepic : $scope.aux.profilepic,
                                  devicetoken : $scope.aux.devicetoken,
                                  borda : $scope.aux.borda,
                                  apelido : $scope.aux.apelido,
                                  confirmacao : $scope.confirmacao,
                                  nomeevento :  $scope.nomeevento,
                                  eventopic : $scope.evento.eventopic, 
                                  idComercioParceiro : $scope.evento.idComercioParceiro, 
                                  estado : $scope.estado}).then(function (res){
                    $scope.response = res.data;
                    $http.post('https://ec2.diwoapp.com.br/deletapessoaevento.php', {iduser : $scope.aux.iduser,
                                                                                idevento : $scope.evento.idevento,
                                                                                estado: '5'});
                    if ($scope.response.success == true) {
                      $scope.msgnoti = ('To querendo ir no evento: ' + $scope.evento.nomeevento);
                      noti.recebe = $scope.evento.adm;
                      noti.envia = $scope.aux.iduser;
                      noti.tipo = 1;
                      noti.nomeevento = $scope.evento.nomeevento;
                      EventoService.VerificaNotificacao(noti).then(function(res) {
                        console.log(res);
                        if(res){
                           if($scope.evento.tipodeevento != "comercio" && $scope.evento.tipodeevento != "campanha"){
                                $http.post('https://ec2.diwoapp.com.br/notificacriador.php', {notificacao : $scope.msgnoti, 
                                      idevento : $scope.evento.idevento,
                                      nomeevento : $scope.evento.nomeevento,
                                      id_user_envia : $scope.aux.iduser,
                                      username_envia : $scope.aux.username,
                                      apelido_envia : $scope.aux.apelido,
                                      tipo : '1',
                                      id_user_recebe : $scope.evento.adm});
                             EventoService.getusuario2($scope.evento.admusername).then(function(user) {
                              if(user.noticriados== '1'){
                                $scope.pushnoti.titulo = $scope.evento.nomeevento;
                                $scope.pushnoti.msg = $scope.aux.username + " quer participar do evento";
                                $scope.pushnoti.token = user.devicetoken;
                                 EventoService.MandaPushNoti($scope.pushnoti);
                               }
                              });
                              }
                        }
                      });
                      $http.post("https://ec2.diwoapp.com.br/deletanotificacaoporids.php", {id_user_recebe : noti.recebe,
                                                                                id_user_envia: noti.envia,
                                                                                nomeevento: noti.nomeevento,
                                                                                tipo : '5'});
                      var alertPopup = $ionicPopup.alert({
                        title: 'Parabéns',
                        template: $scope.response.msg
                      });
                      alertPopup.then(function(){
                        $http.post('https://ec2.diwoapp.com.br/deletapessoaevento.php', {iduser : $scope.aux.iduser,
                                                                                idevento : $scope.evento.idevento,
                                                                                estado: '7'}).then(function (res){
                        $scope.response = res.data;
                        //console.log(i);
                        $scope.fav = false;
                        });
                        $state.go('tabsController.home');
                      });
                      
                    }else{
                      var alertPopup = $ionicPopup.alert({
                        title: 'Ocorreu uma falha',
                        template: $scope.response.msg
                      });
                    }
                    console.log($scope.response.msg);
                });
                          }}]
                   });
              }else{
                  $scope.confirmacao = 'aguardando confirmação';
                  $scope.estado = '1';
                  // console.log($scope.evento.idevento);
                  // console.log($scope.aux.iduser);
                  // console.log($scope.confirmacao);
                  // console.log($scope.nomeevento);
                  // console.log($scope.estado);
                  var link = 'https://ec2.diwoapp.com.br/irevento.php';
                  $http.post(link, {idevento : $scope.evento.idevento,
                                  idadm : $scope.evento.adm, 
                                  admusername : $scope.evento.admusername, 
                                  diainicio : $scope.evento.diainicio,
                                  diafim : $scope.evento.diafim,
                                  iduser : $scope.aux.iduser,
                                  username: $scope.aux.username,
                                  profilepic : $scope.aux.profilepic,
                                  devicetoken : $scope.aux.devicetoken,
                                  borda : $scope.aux.borda,
                                  apelido : $scope.aux.apelido,
                                  confirmacao : $scope.confirmacao,
                                  nomeevento :  $scope.nomeevento,
                                  eventopic : $scope.evento.eventopic, 
                                  idComercioParceiro : $scope.evento.idComercioParceiro, 
                                  estado : $scope.estado}).then(function (res){
                    $scope.response = res.data;
                    $http.post('https://ec2.diwoapp.com.br/deletapessoaevento.php', {iduser : $scope.aux.iduser,
                                                                                idevento : $scope.evento.idevento,
                                                                                estado: '5'});
                    if ($scope.response.success == true) {
                      $scope.msgnoti = ('To querendo ir no evento: ' + $scope.evento.nomeevento);
                      noti.recebe = $scope.evento.adm;
                      noti.envia = $scope.aux.iduser;
                      noti.tipo = 1;
                      noti.nomeevento = $scope.evento.nomeevento;
                      EventoService.VerificaNotificacao(noti).then(function(res) {
                        console.log(res);
                        if(res){
                          if($scope.evento.tipodeevento != "comercio" && $scope.evento.tipodeevento != "campanha"){
                                $http.post('https://ec2.diwoapp.com.br/notificacriador.php', {notificacao : $scope.msgnoti, 
                                      idevento : $scope.evento.idevento,
                                      nomeevento : $scope.evento.nomeevento,
                                      id_user_envia : $scope.aux.iduser,
                                      username_envia : $scope.aux.username,
                                      apelido_envia : $scope.aux.apelido,
                                      tipo : '1',
                                      id_user_recebe : $scope.evento.adm});
                             EventoService.getusuario2($scope.evento.admusername).then(function(user) {
                              if(user.noticridos== '1'){
                                $scope.pushnoti.titulo = $scope.evento.nomeevento;
                                $scope.pushnoti.msg = $scope.aux.username + " quer participar do evento";
                                $scope.pushnoti.token = user.devicetoken;
                                 EventoService.MandaPushNoti($scope.pushnoti);
                               }
                              });
                              }
                        }
                      });
                      $http.post("https://ec2.diwoapp.com.br/deletanotificacaoporids.php", {id_user_recebe : noti.recebe,
                                                                                id_user_envia: noti.envia,
                                                                                nomeevento: noti.nomeevento,
                                                                                tipo : '5'});
                      var alertPopup = $ionicPopup.alert({
                        title: 'Parabéns',
                        template: $scope.response.msg
                      });
                      alertPopup.then(function(){
                        $http.post('https://ec2.diwoapp.com.br/deletapessoaevento.php', {iduser : $scope.aux.iduser,
                                                                                idevento : $scope.evento.idevento,
                                                                                estado: '7'}).then(function (res){
                        $scope.response = res.data;
                        //console.log(i);
                        $scope.fav = false;
                        });
                        $state.go('tabsController.home');
                      });
                      
                    }else{
                      var alertPopup = $ionicPopup.alert({
                        title: 'Ocorreu uma falha',
                        template: $scope.response.msg
                      });
                    }
                    console.log($scope.response.msg);
                });
              }
            }
      
      }else{
        $scope.borala = false;
        $scope.desistir = true;
      }
      $state.reload();
    }
  }

  $scope.reservar = function(){
    var link = 'https://ec2.diwoapp.com.br/reservar.php';
                  $http.post(link, {idevento : $scope.evento.idevento, 
                                idadm : $scope.evento.adm, 
                                admusername : $scope.evento.admusername, 
                                iduser : $scope.aux.iduser,
                                apelido : $scope.aux.apelido, 
                                diainicio : $scope.evento.diainicio,
                                diafim : $scope.evento.diafim,
                                username: $scope.aux.username,
                                confirmacao : 'na fila',
                                profilepic: $scope.aux.profilepic,
                                devicetoken : $scope.aux.devicetoken,
                                nomeevento :  $scope.nomeevento, 
                                estado : '8'}).then(function (res){
                  $scope.response = res.data;
                  var alertPopup = $ionicPopup.alert({
                      title: 'ヾ(･д･ヾ)',
                      template: 'Vamos avisar que tu ta querendo ir, vai que aumentao o limite máximo ou alguem desiste né? T avisaremos se algo acontecer'
                    });
                    $scope.msgnoti = ('To querendo ir no evento: ' + $scope.evento.nomeevento + ' mas ele esta cheio, da pra fazer algo?');
                    //console.log($scope.msgnoti);
                    noti.recebe = $scope.evento.adm;
                    noti.envia = $scope.aux.iduser;
                    noti.tipo = 8; // solicitando reserva
                    noti.nomeevento = $scope.evento.nomeevento;
                    EventoService.VerificaNotificacao(noti).then(function(res) {
                      console.log(res);
                      if(res){
                         if($scope.evento.tipodeevento != "comercio" && $scope.evento.tipodeevento != "campanha"){
                                $http.post('https://ec2.diwoapp.com.br/notificacriador.php', {notificacao : $scope.msgnoti, 
                                      idevento : $scope.evento.idevento,
                                      nomeevento : $scope.evento.nomeevento,
                                      id_user_envia : $scope.aux.iduser,
                                      username_envia : $scope.aux.username,
                                      apelido_envia : $scope.aux.apelido,
                                      tipo : '1',
                                      id_user_recebe : $scope.evento.adm});
                             EventoService.getusuario2($scope.evento.admusername).then(function(user) {
                              if(user.noticriados== '1'){
                                $scope.pushnoti.titulo = $scope.evento.nomeevento;
                                $scope.pushnoti.msg = $scope.aux.username + " quer participar do evento";
                                $scope.pushnoti.token = user.devicetoken;
                                 EventoService.MandaPushNoti($scope.pushnoti);
                               }
                              });
                              }
                      }
                    });
                    $http.post("https://ec2.diwoapp.com.br/deletanotificacaoporids.php", {id_user_recebe : noti.recebe,
                                                                              id_user_envia: noti.envia,
                                                                              nomeevento: noti.nomeevento,
                                                                              tipo : '5'});
                  $scope.reserva = false;
              });
    $state.reload();
  }

  $scope.desfavorita = function(){
    $http.post('https://ec2.diwoapp.com.br/deletapessoaevento.php', {iduser : $scope.aux.iduser,
                                                                        idevento : $scope.evento.idevento,
                                                                        estado: '7'});
    $scope.pinza = true;
    $scope.despinza = false;
  }

  $scope.favorita = function(){
    var link = 'https://ec2.diwoapp.com.br/irevento.php';
    $http.post(link, {idevento : $scope.evento.idevento, 
                              idadm : $scope.evento.adm, 
                              admusername : $scope.evento.admusername, 
                              iduser : $scope.aux.iduser,
                              diainicio : $scope.evento.diainicio,
                              diafim : $scope.evento.diafim,
                              username: $scope.aux.username,
                              profilepic : $scope.aux.profilepic,
                              devicetoken : $scope.aux.devicetoken,
                              borda : $scope.aux.borda,
                              apelido : $scope.aux.apelido,
                              confirmacao : 'interesse',
                              nomeevento :  $scope.nomeevento,
                              eventopic : $scope.evento.eventopic, 
                              idComercioParceiro : $scope.evento.idComercioParceiro, 
                              estado : '7'});
    $scope.pinza = false;
    $scope.despinza = true;
  }

  $scope.reportar = function(){
    $scope.reportmsg = '';
    //console.log($scope.evento.admusername);
    $scope.report = [
      { text: "Conteúdo impróprio", checked: false },
      { text: "Linguajar inadequado", checked: false },
      { text: "Discurso de ódio", checked: false },
      { text: "Imagem imprópria", checked: false },
      { text: "Substancias ilicitas ", checked: false }
    ];
    $ionicPopup.confirm({
        title: 'Você quer reportar esse evento pq?',
        content: '<ion-checkbox ng-repeat="item in report" style="color: #FCFCFC;" ng-model="item.checked"  ng-checked="item.checked">{{item.text}}</ion-checkbox>',
        scope: $scope
    }).then(function(res) {
        if(res) {
          for (var h=0;h<3;h++){
            //console.log($scope.report[h].checked , h);
            if($scope.report[h].checked){
              $scope.reportmsg = $scope.reportmsg + $scope.report[h].text + ' ';
              //console.log($scope.reportmsg);
            }
          }
          if(h==3){
            console.log($scope.reportmsg);
            $http.post('https://ec2.diwoapp.com.br/reportaevento.php', {namereportado : $scope.evento.admusername,
                                                                            reportadoid : $scope.evento.idevento,
                                                                            iduserreportando : $scope.aux.iduser,
                                                                            usernamereportando : $scope.aux.username,
                                                                            tiporeport : 'evento',
                                                                            motivo : $scope.reportmsg}).then(function (tes){
              $scope.response = tes.data;
              var alertPopup = $ionicPopup.alert({
                                        title: 'Obrigado',
                                        template: 'Este evento esta agora sobre avaliação, obrigado por manter a plataforma organizada'
              });
            });
          }
        }
    });
  }

  $scope.deletar =  function(){
    if ($scope.criador == $scope.aux.iduser) {
      if(zone == 'red' || zone == 'yellow'){
        if(zone == 'red' ){
          var myPopup = $ionicPopup.show({
                template: '<input type="text" placeholder="Escreva aqui pq nao vai rolar" ng-model="data.desculpa">',
                title: 'ATENÇÃO!!!',
                subTitle: 'Você esta preste a cancelar seu evento faltando muito pouco para seu começo, tens certeza disso?. Se tu realmente cancelar estaremos te dando um cartão vermelho. Para saber mais sobre eles va no seu indice de confirmação',
                scope: $scope,
                buttons: [
                  { text: 'Não' },
                  {
                    text: '<b>Sim</b>',
                    type: 'button-positive',
                    onTap: function(e) {
                      // console.log($scope.items.length);
                       var notifica = ("Desisti de fazer o evento, " + $scope.data.desculpa);
                      // console.log(notifica);
                      // console.log($scope.aux.iduser);
                    
                      formtelaCriar.updateForm(1);
                       $http.post('https://ec2.diwoapp.com.br/deletanotificacaoporevento.php' , {idevento : $scope.evento.idevento,
                                                                                    nomeevento : $scope.evento.nomeevento});
                      
                      
                      $http.post('https://ec2.diwoapp.com.br/penalidade.php', {iduser : $scope.aux.iduser,
                                                                                   idevento : $scope.evento.idevento,
                                                                                   username : $scope.aux.username,
                                                                                   tipopenalidade : '2'});     // tipo2 saiu na redzone         
                      EventoService.GetParticipantes($scope.evento.idevento).then(function(ppl) {
                                   for (var i = 0; i < ppl.length; i++) {
                                    if ($scope.aux.iduser != ppl[i].iduser) {
                                          noti.recebeusername = ppl[i].username;
                                          noti.recebe = ppl[i].iduser;
                                          noti.envia = $scope.aux.iduser;
                                          noti.tipo = 4;
                                          noti.nomeevento = $scope.evento.nomeevento;
                                          EventoService.VerificaNotificacao(noti).then(function(res) {
                                            console.log(res);
                                            if(res){
                                              $http.post('https://ec2.diwoapp.com.br/notificapessoa.php', {notificacao : notifica, 
                                                    idevento : $scope.evento.idevento,
                                                    nomeevento : $scope.evento.nomeevento,
                                                    id_user_envia : $scope.aux.iduser,
                                                    username_envia : $scope.aux.username,
                                                    apelido_envia : $scope.aux.apelido,
                                                    tipo : '5',   
                                                    id_user_recebe : noti.recebe}).then(function (res){
                                                   $scope.response = res.data;
                                                   console.log($scope.response.msg)
                                                 });
                                              EventoService.getusuario2(noti.recebeusername).then(function(user) {
                                                if(user.notiparticipando== '1'){
                                                $scope.pushnoti.titulo = $scope.evento.nomeevento + ' Cancelado';
                                                $scope.pushnoti.msg = notifica;
                                                $scope.pushnoti.token = user.devicetoken;
                                                 EventoService.MandaPushNoti($scope.pushnoti);
                                               }
                                              });
                                            }
                                          });
                                        }
                                  }
                                 })
                      for(var i = 0; i< $scope.items.length; i++){
                        $http.post('https://ec2.diwoapp.com.br/deletapessoaevento.php', {iduser : $scope.items[i].iduser,
                                                                                           idevento : $scope.evento.idevento});
                      }
                      $scope.evento.estado = "3";
                      $scope.evento.datamodificacao = new Date();                
                      EventoService.atualizarevento($scope.evento);
                      $state.go('tabsController.home');
                    }
                  }
                ]
          });
          console.log('criador do evento cancelando proprio evento');
        }else{
          var myPopup = $ionicPopup.show({
                      template: '<input type="text" placeholder="Escreva aqui pq nao vai rolar" ng-model="data.desculpa">',
                      title: 'ATENÇÃO!!!',
                      subTitle: 'Você esta preste a cancelar seu evento faltando pouco para seu começo, tens certeza disso?. Se tu realmente cancelar estaremos te dando um cartão amarelo. Para saber mais sobre eles va no seu indice de confirmação',
                      scope: $scope,
                      buttons: [
                        { text: 'Não' },
                        {
                          text: '<b>Sim</b>',
                          type: 'button-positive',
                          onTap: function(e) {
                            // console.log($scope.items.length);
                             var notifica = ("Desisti de fazer o evento, " + $scope.data.desculpa);
                            // console.log(notifica);
                            // console.log($scope.aux.iduser);
                          
                            formtelaCriar.updateForm(1);
                             $http.post('https://ec2.diwoapp.com.br/deletanotificacaoporevento.php' , {idevento : $scope.evento.idevento,
                                                                                          nomeevento : $scope.evento.nomeevento});
                            
                            
                            $http.post('https://ec2.diwoapp.com.br/penalidade.php', {iduser : $scope.aux.iduser,
                                                                                       idevento : $scope.evento.idevento,
                                                                                       username : $scope.aux.username,
                                                                                       tipopenalidade : '1'});   // tipo 1 saiu na yellow zone               
                            EventoService.GetParticipantes($scope.evento.idevento).then(function(ppl) {
                                   for (var i = 0; i < ppl.length; i++) {
                                    if ($scope.aux.iduser != ppl[i].iduser) {
                                          noti.recebeusername = ppl[i].username;
                                          noti.recebe = ppl[i].iduser;
                                          noti.envia = $scope.aux.iduser;
                                          noti.tipo = 4;
                                          noti.nomeevento = $scope.evento.nomeevento;
                                          EventoService.VerificaNotificacao(noti).then(function(res) {
                                            console.log(res);
                                            if(res){
                                              $http.post('https://ec2.diwoapp.com.br/notificapessoa.php', {notificacao : notifica, 
                                                    idevento : $scope.evento.idevento,
                                                    nomeevento : $scope.evento.nomeevento,
                                                    id_user_envia : $scope.aux.iduser,
                                                    username_envia : $scope.aux.username,
                                                    apelido_envia : $scope.aux.apelido,
                                                    tipo : '5',   
                                                    id_user_recebe : noti.recebe}).then(function (res){
                                                   $scope.response = res.data;
                                                   console.log($scope.response.msg)
                                                 });
                                              EventoService.getusuario2(noti.recebeusername).then(function(user) {
                                                if(user.notiparticipando== '1'){
                                                $scope.pushnoti.titulo = $scope.evento.nomeevento + ' Cancelado';
                                                $scope.pushnoti.msg = notifica;
                                                $scope.pushnoti.token = user.devicetoken;
                                                 EventoService.MandaPushNoti($scope.pushnoti);
                                               }
                                              });
                                            }
                                          });
                                        }
                                  }
                                 })
                            for(var i = 0; i< $scope.items.length; i++){
                              $http.post('https://ec2.diwoapp.com.br/deletapessoaevento.php', {iduser : $scope.items[i].iduser,
                                                                                                 idevento : $scope.evento.idevento});
                            }
                            $scope.evento.estado = "3";
                            $scope.evento.datamodificacao = new Date();                
                            EventoService.atualizarevento($scope.evento);
                            $state.go('tabsController.home');
                          }
                        }
                      ]
          });
          console.log('criador do evento cancelando proprio evento');
        }
      }else{
        var myPopup = $ionicPopup.show({
                  template: '<input type="text" placeholder="Escreva aqui pq nao vai rolar" ng-model="data.desculpa">',
                  title: 'ATENÇÃO!!!',
                  subTitle: 'Você esta preste a deletar seu evento, tens certeza disso?',
                  scope: $scope,
                  buttons: [
                    { text: 'Não' },
                    {
                      text: '<b>Sim</b>',
                      type: 'button-positive',
                      onTap: function(e) {
                        // console.log($scope.items.length);
                         var notifica = ("Desisti de fazer o evento, " + $scope.data.desculpa);
                        // console.log(notifica);
                        // console.log($scope.aux.iduser);
                      
                        formtelaCriar.updateForm(1);
                         $http.post('https://ec2.diwoapp.com.br/deletanotificacaoporevento.php' , {idevento : $scope.evento.idevento,
                                                                                                    nomeevento : $scope.evento.nomeevento});
                                     
                        
                        EventoService.GetParticipantes($scope.evento.idevento).then(function(ppl) {
                                   for (var i = 0; i < ppl.length; i++) {
                                    if ($scope.aux.iduser != ppl[i].iduser) {
                                          noti.recebeusername = ppl[i].username;
                                          noti.recebe = ppl[i].iduser;
                                          noti.envia = $scope.aux.iduser;
                                          noti.tipo = 4;
                                          noti.nomeevento = $scope.evento.nomeevento;
                                          EventoService.VerificaNotificacao(noti).then(function(res) {
                                            console.log(res);
                                            if(res){
                                            $http.post('https://ec2.diwoapp.com.br/notificapessoa.php', {notificacao : notifica, 
                                                    idevento : $scope.evento.idevento,
                                                    nomeevento : $scope.evento.nomeevento,
                                                    id_user_envia : $scope.aux.iduser,
                                                    username_envia : $scope.aux.username,
                                                    apelido_envia : $scope.aux.apelido,
                                                    tipo : '5',   
                                                    id_user_recebe : noti.recebe}).then(function (res){
                                                   $scope.response = res.data;
                                                   console.log($scope.response.msg)
                                                 });
                                              EventoService.getusuario2(noti.recebeusername).then(function(user) {
                                                if(user.notiparticipando== '1'){
                                                $scope.pushnoti.titulo = $scope.evento.nomeevento + ' Cancelado';
                                                $scope.pushnoti.msg = notifica;
                                                $scope.pushnoti.token = user.devicetoken;
                                                 EventoService.MandaPushNoti($scope.pushnoti);
                                               }
                                              });
                                            }
                                          });
                                        }
                                  }
                                 })
                        for(var i = 0; i< $scope.items.length; i++){
    
                          $http.post('https://ec2.diwoapp.com.br/deletapessoaevento.php', {iduser : $scope.items[i].iduser,
                                                                                             idevento : $scope.evento.idevento});
                        }                
                        $scope.evento.estado = "3";
                        $scope.evento.datamodificacao = new Date();                
                       EventoService.atualizarevento($scope.evento);
                                            $state.go('tabsController.home');
                                            }
                    }]
                   });

                        console.log('criador do evento cancelando proprio evento');
        }
              
      }else{
        if (meuestado!=1) {


         if(zone == 'red' || zone == 'yellow'){
                          if(zone == 'red' ){

                               var confirmPopup = $ionicPopup.show({
                                         title: 'ATENÇÃO!!!',
                                         template: 'Você esta preste a desistir de um evento faltando muito pouco tempo para seu começo, tens certeza disso? Se tu realmente cancelar estaremos te dando um cartão vermelho. Para saber mais sobre eles va no seu indice de confirmação ',
                                         buttons: [
                                            { text: 'Não',
                                              type: 'button-assertive'},
                                            {
                                              text: 'Sim',
                                              type: 'button-positive',
                                              onTap: function(e){
                                                noti.recebeusername = $scope.evento.admusername
                                                noti.recebe = $scope.criador;
                                            noti.envia = $scope.aux.iduser;
                                            noti.tipo = 5;
                                            noti.nomeevento = $scope.evento.nomeevento;
                                            EventoService.VerificaNotificacao(noti).then(function(res) {
                                              console.log(res);
                                              if(res){
                                                $http.post('https://ec2.diwoapp.com.br/notificapessoa.php', {notificacao : 'Desisti de ir no seu evento, perdão', 
                                                      idevento : $scope.evento.idevento,
                                                      nomeevento : $scope.evento.nomeevento,
                                                      id_user_envia : $scope.aux.iduser,
                                                      username_envia : $scope.aux.username,
                                                      apelido_envia : $scope.aux.apelido,
                                                      tipo : '5', //pessoa desistiu
                                                      id_user_recebe : $scope.criador});
                                                EventoService.getusuario2(noti.recebeusername).then(function(user) {
                                                  if(user.notiparticipando== '1'){
                                                  $scope.pushnoti.titulo = 'Desisti';
                                                  $scope.pushnoti.msg = 'Desisti de ir no seu evento: ' + $scope.evento.nomeevento;;
                                                  $scope.pushnoti.token = user.devicetoken;
                                                   EventoService.MandaPushNoti($scope.pushnoti);
                                                 }
                                                });
                                              }
                                            });
                                            $http.post("https://ec2.diwoapp.com.br/deletanotificacaoporids.php", {id_user_recebe : noti.recebe,
                                                                              id_user_envia: noti.envia,
                                                                              nomeevento: noti.nomeevento,
                                                                              tipo : '1'});
                                            $http.post('https://ec2.diwoapp.com.br/penalidade.php', {iduser : $scope.aux.iduser,
                                                                                           idevento : $scope.evento.idevento,
                                                                                           username : $scope.aux.username,
                                                                                           tipopenalidade : '2'});     // tipo2 saiu na redzone  
                                            if(meuestado == 2){
                                               $scope.evento.patual = parseInt($scope.evento.patual)-1;
                                            }
                                            if(parseInt($scope.evento.patual)<parseInt($scope.evento.pmin)){
                                              $http.post('https://ec2.diwoapp.com.br/mudaestadoevento.php', {idevento : $scope.evento.idevento,
                                                                                                            estado : '2'});
                                              $http.post('https://ec2.diwoapp.com.br/notificapessoa.php', {notificacao : 'ATENÇÃO!! Numero de pessoas agora nao bate o mínimo.', 
                                                          idevento : $scope.evento.idevento,
                                                          nomeevento : $scope.evento.nomeevento,
                                                          id_user_envia : $scope.aux.iduser,
                                                          username_envia : $scope.aux.username,
                                                          apelido_envia : $scope.aux.apelido,
                                                          tipo : '12', //pessoa desistiu com menos pessoas para acontecer ou nao um evento
                                                          id_user_recebe : $scope.criador});
                                            }
                                            $http.post('https://ec2.diwoapp.com.br/addpessoaevento.php', {idevento : $scope.evento.idevento,
                                                                                                            patual : $scope.evento.patual});    
                                            $http.post('https://ec2.diwoapp.com.br/deletapessoaevento.php', {iduser : $scope.aux.iduser,
                                                                                                              idevento : $scope.evento.idevento});
                                            $state.go('tabsController.home');
                                                    }
                                                   }
                                                 ]
                                         })
                             }else{
                                 var confirmPopup = $ionicPopup.show({
                                         title: 'ATENÇÃO!!!',
                                         template: 'Você esta preste a desistir de um evento faltando pouco tempo para seu começo, tens certeza disso? Se tu realmente cancelar estaremos te dando um cartão amarelo. Para saber mais sobre eles va no seu indice de confirmação',
                                         buttons: [
                                            { text: 'Não',
                                              type: 'button-assertive'},
                                            {
                                              text: 'Sim',
                                              type: 'button-positive',
                                              onTap: function(e){
                                                noti.recebeusername = $scope.evento.admusername;
                                                noti.recebe = $scope.criador;
                                            noti.envia = $scope.aux.iduser;
                                            noti.tipo = 5;
                                            noti.nomeevento = $scope.evento.nomeevento;
                                              EventoService.VerificaNotificacao(noti).then(function(res) {
                                              console.log(res);
                                              if(res){
                                                $http.post('https://ec2.diwoapp.com.br/notificapessoa.php', {notificacao : 'Desisti de ir no seu evento, perdão', 
                                                      idevento : $scope.evento.idevento,
                                                      nomeevento : $scope.evento.nomeevento,
                                                      id_user_envia : $scope.aux.iduser,
                                                      username_envia : $scope.aux.username,
                                                      apelido_envia : $scope.aux.apelido,
                                                      tipo : '5', //pessoa desistiu
                                                      id_user_recebe : $scope.criador});
                                                EventoService.getusuario2(noti.recebeusername).then(function(user) {
                                                  if(user.noticriados== '1'){
                                                  $scope.pushnoti.titulo = 'Desisti';
                                                  $scope.pushnoti.msg = 'Desisti de ir no seu evento: ' + $scope.evento.nomeevento;;
                                                  $scope.pushnoti.token = user.devicetoken;
                                                   EventoService.MandaPushNoti($scope.pushnoti);
                                                 }
                                                });
                                              }
                                              });
                                              $http.post("https://ec2.diwoapp.com.br/deletanotificacaoporids.php", {id_user_recebe : noti.recebe,
                                                                              id_user_envia: noti.envia,
                                                                              nomeevento: noti.nomeevento,
                                                                              tipo : '1'});
                                                       $http.post('https://ec2.diwoapp.com.br/penalidade.php', {iduser : $scope.aux.iduser,
                                                                                                     idevento : $scope.evento.idevento,
                                                                                                     username : $scope.aux.username,
                                                                                                     tipopenalidade : '1'});   // tipo 1 saiu na yellow zone   
                                                      
                                                         $scope.evento.patual = parseInt($scope.evento.patual)-1;
                                                        $http.post('https://ec2.diwoapp.com.br/addpessoaevento.php', {idevento : $scope.evento.idevento,
                                                                                          patual : $scope.evento.patual});    
                                                    $http.post('https://ec2.diwoapp.com.br/deletapessoaevento.php', {iduser : $scope.aux.iduser,
                                                                                                                        idevento : $scope.evento.idevento});
                                                      $state.go('tabsController.home');
                                                    }
                                                   }
                                                 ]
                                         })

                             }
                           
                         }else{
                             var confirmPopup = $ionicPopup.show({
                                         title: 'ATENÇÃO!!!',
                                         template: 'Você esta preste a desistir de um evento, tens certeza disso?',
                                         buttons: [
                                            { text: 'Não',
                                              type: 'button-assertive'},
                                            {
                                              text: 'Sim',
                                              type: 'button-positive',
                                              onTap: function(e){
                                                noti.recebeusername = $scope.evento.admusername;
                                                noti.recebe =$scope.criador;
                                            noti.envia = $scope.aux.iduser;
                                            noti.tipo = 5;
                                            noti.nomeevento = $scope.evento.nomeevento;
                                            EventoService.VerificaNotificacao(noti).then(function(res) {
                                              console.log(res);
                                              if(res){
                                                $http.post('https://ec2.diwoapp.com.br/notificapessoa.php', {notificacao : 'Desisti de ir no seu evento, perdão', 
                                                      idevento : $scope.evento.idevento,
                                                      nomeevento : $scope.evento.nomeevento,
                                                      id_user_envia : $scope.aux.iduser,
                                                      username_envia : $scope.aux.username,
                                                      apelido_envia : $scope.aux.apelido,
                                                      tipo : '5', //pessoa desistiu
                                                      id_user_recebe : $scope.criador}).then(function (res){
                                                     $scope.response = res.data;
                                                     //console.log($scope.response.msg)
                                                   });
                                                EventoService.getusuario2(noti.recebeusername).then(function(user) {
                                                  if(user.noticriados== '1'){
                                                  $scope.pushnoti.titulo = 'Desisti';
                                                  $scope.pushnoti.msg = 'Desisti de ir no seu evento: ' + $scope.evento.nomeevento;;
                                                  $scope.pushnoti.token = user.devicetoken;
                                                   EventoService.MandaPushNoti($scope.pushnoti);
                                                 }
                                                });
                                                    }
                                                  });
                                            $http.post("https://ec2.diwoapp.com.br/deletanotificacaoporids.php", {id_user_recebe : noti.recebe,
                                                                              id_user_envia: noti.envia,
                                                                              nomeevento: noti.nomeevento,
                                                                              tipo : '1'});
                                                       if(meuestado == 2){
                                                         $scope.evento.patual = parseInt($scope.evento.patual)-1;
                                                        }
                                                    $http.post('https://ec2.diwoapp.com.br/addpessoaevento.php', {idevento : $scope.evento.idevento,
                                                                                                                    patual : $scope.evento.patual});    
                                                    $http.post('https://ec2.diwoapp.com.br/deletapessoaevento.php', {iduser : $scope.aux.iduser,
                                                                                                                        idevento : $scope.evento.idevento});
                                                      $state.go('tabsController.home');
                                                    }
                                                   }
                                                 ]
                                         })
                           }


                }else{
                   var confirmPopup = $ionicPopup.show({
                                         title: 'ATENÇÃO!!!',
                                         template: 'Você esta preste a desistir de um evento, tens certeza disso?',
                                         buttons: [
                                            { text: 'Não',
                                              type: 'button-assertive'},
                                            {
                                              text: 'Sim',
                                              type: 'button-positive',
                                              onTap: function(e){
                                                noti.recebeusername = $scope.evento.admusername;
                                                noti.recebe =$scope.criador;
                                            noti.envia = $scope.aux.iduser;
                                            noti.tipo = 5;
                                            noti.nomeevento = $scope.evento.nomeevento;
                                            EventoService.VerificaNotificacao(noti).then(function(res) {
                                              console.log(res);
                                              if(res){
                                                $http.post('https://ec2.diwoapp.com.br/notificapessoa.php', {notificacao : 'Desisti de ir no seu evento, perdão', 
                                                      idevento : $scope.evento.idevento,
                                                      nomeevento : $scope.evento.nomeevento,
                                                      id_user_envia : $scope.aux.iduser,
                                                      username_envia : $scope.aux.username,
                                                      apelido_envia : $scope.aux.apelido,
                                                      tipo : '5', //pessoa desistiu
                                                      id_user_recebe : $scope.criador}).then(function (res){
                                                     $scope.response = res.data;
                                                     //console.log($scope.response.msg)
                                                   });
                                                      EventoService.getusuario2(noti.recebeusername).then(function(user) {
                                                        if(user.noticriados== '1'){
                                                  $scope.pushnoti.titulo = 'Desisti';
                                                  $scope.pushnoti.msg = 'Desisti de ir no seu evento: ' + $scope.evento.nomeevento;;
                                                  $scope.pushnoti.token = user.devicetoken;
                                                   EventoService.MandaPushNoti($scope.pushnoti);
                                                 }
                                                });
                                                    }
                                                  });
                                            $http.post("https://ec2.diwoapp.com.br/deletanotificacaoporids.php", {id_user_recebe : noti.recebe,
                                                                              id_user_envia: noti.envia,
                                                                              nomeevento: noti.nomeevento,
                                                                              tipo : '1'});
                                                       if(meuestado == 2){
                                                         $scope.evento.patual = parseInt($scope.evento.patual)-1;
                                                        }
                                                    $http.post('https://ec2.diwoapp.com.br/addpessoaevento.php', {idevento : $scope.evento.idevento,
                                                                                                                    patual : $scope.evento.patual});    
                                                    $http.post('https://ec2.diwoapp.com.br/deletapessoaevento.php', {iduser : $scope.aux.iduser,
                                                                                                                        idevento : $scope.evento.idevento});
                                                      $state.go('tabsController.home');
                                                    }
                                                   }
                                                 ]
                                         })
                }



            }           
            $state.reload();
  }
   

}])

.controller('eventofiltroEncerradoCtrl', ['$scope', '$stateParams', 'formItem', 'formUser', 'formtelaCriar', 'formOutro', '$http', '$timeout','$ionicPopup', 'EventoService', '$state', 'formvimdofiltro', 'formvimdofiltroperfil',// The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, formItem, formUser, formtelaCriar, formOutro, $http, $timeout, $ionicPopup, EventoService, $state,formvimdofiltro, formvimdofiltroperfil) {

  $scope.evento = formItem.getForm();
  $scope.aux = formUser.getForm();
  $scope.diaf = {};
  $scope.tag = '';
  $scope.items = [];
  $scope.coments = {};
  $scope.ncomen = 0;
  console.log($scope.evento.idevento)
  var hj = $scope.evento.diainicio;
  var ano = (hj[0]+hj[1]+hj[2]+hj[3]).valueOf();
  var mes = (hj[5]+hj[6]).valueOf();
  var dia = (hj[8]+hj[9]).valueOf();
  var h = (hj[11]+hj[12]).valueOf();
  var m = (hj[14]+hj[15]).valueOf();
  $scope.dia = dia+'/'+mes+'/'+ano+' '+h+':'+m;
  
  var  hjl = $scope.evento.dialimiteconfirmacao;
  $scope.dialimiteconfirmacao =  (hjl[8]+hjl[9]).valueOf()+'/'+(hjl[5]+hjl[6]).valueOf()+'/'+(hjl[0]+hjl[1]+hjl[2]+hjl[3])+' '+(hjl[11]+hjl[12]).valueOf()+':'+(hjl[14]+hjl[15]).valueOf();
    
  var hjf = $scope.evento.diafim;
  $scope.diafim =  (hjf[8]+hjf[9]).valueOf()+'/'+(hjf[5]+hjf[6]).valueOf()+'/'+(hjf[0]+hjf[1]+hjf[2]+hjf[3])+' '+(hjf[11]+hjf[12]).valueOf()+':'+(hjf[14]+hjf[15]).valueOf();
    
  $scope.diaf.dia = (hj[8]+hj[9]).valueOf()+'/'+(hj[5]+hj[6]).valueOf();
  $scope.diaf.hora = (hj[11]+hj[12]).valueOf()+':'+(hj[14]+hj[15]).valueOf() +' - '+(hjf[11]+hjf[12]).valueOf()+':'+(hjf[14]+hjf[15]).valueOf() ;

    if($scope.evento.genero == "masc"){
      $scope.masc = true;
      $scope.fem = false;
    }
    if($scope.evento.genero == "fem"){
        $scope.fem = true;
        $scope.masc = false;
    }
    if($scope.evento.genero == "todos"){
        $scope.fem = false;
        $scope.masc = false;
    }   
    if($scope.evento.preco == 0 || $scope.evento.preco =="Gratuito"){
      $scope.evento.preco = "Gratuito";
      $scope.porpessoa = false;
      $scope.porlocal = false;
    }else{
      if($scope.evento.precopor == 1){
        $scope.porpessoa = true;
        $scope.porlocal = false;
      }else{
        $scope.porpessoa = false;
        $scope.porlocal = true;
      }
    }
  $scope.$on("$ionicView.enter", function(event, data){

    $scope.tag = '';
    $scope.items = [];
    $scope.nota = 0;
    $scope.coments = {};
    $scope.ncomen = 0;
    //$scope.evento = formItem.getForm();
    $scope.aux = formUser.getForm();


     
    EventoService.GetComentariosevento($scope.evento).then(function(coments) {
      if(coments=='Error'){
        $scope.nota = '';
      }else{
        for (var i = 0; i < coments.length; i++) {
          $scope.nota = parseFloat(coments[i].nota) + $scope.nota ;
        }
        $scope.nota = ($scope.nota/coments.length).toFixed(1);
        $scope.coments = coments;
        $scope.ncomen = $scope.coments.length;
      }     
    });
    
            //Pega tags do evento
    EventoService.Gettags($scope.evento.idevento).then(function(tags) {
      for(var  i =0; i< tags.length;i++){
        $scope.tag = ($scope.tag + ' ' + tags[i].tag);
      } 
    });
    console.log($scope.evento.idevento)
    EventoService.GetParticipantesSemFav($scope.evento.idevento).then(function(items) {
      for (var i = 0; i < items.length; i++) {
        if(items[i].borda == 0){
            items[i].bb = false;
            items[i].bs = false;
            items[i].bg = false;
          }
          if(items[i].borda == 1){
            items[i].bb = true;
            items[i].bs = false;
            items[i].bg = false;
          }
          if(items[i].borda == 2){
            items[i].bb = false;
            items[i].bs = true;
            items[i].bg = false;
          }
          if(items[i].borda == 3){
            items[i].bb = false;
            items[i].bs = false;
            items[i].bg = true;
          }
          if((items[i].profilepic[8] == 's' && items[i].profilepic[9] == '3')||(items[i].profilepic[8] == 'd' && items[i].profilepic[9] == 'i')){
          
             items[i].profilepic=items[i].profilepic+"?{{getTimeStamp()}}";
           }else{
             items[i].profilepic=items[i].profilepic;
           }
      }
      $scope.items = items;
    });
  });

  $scope.enterItem =  function(item){
    formOutro.updateForm(item);
    //console.log(item.iduser);
    formvimdofiltroperfil.updateForm(false);
    $state.go('tabsController.perfilOutro');
  }

  $scope.Vermapa = function(){
    $state.go('tabsController.ver_onde_mapa');
  }

  $scope.reportar = function(){
    $scope.reportmsg = '';
    //console.log($scope.evento.admusername);
    $scope.report = [
      { text: "Conteúdo impróprio", checked: false },
      { text: "Linguajar inadequado", checked: false },
      { text: "Discurso de ódio", checked: false },
      { text: "Imagem imprópria", checked: false },
      { text: "Substancias ilicitas ", checked: false }
    ];
    $ionicPopup.confirm({
        title: 'Você quer reportar esse evento pq?',
        content: '<ion-checkbox ng-repeat="item in report" style="color: #FCFCFC;" ng-model="item.checked"  ng-checked="item.checked">{{item.text}}</ion-checkbox>',
        scope: $scope
    }).then(function(res) {
        if(res) {
          for (var h=0;h<3;h++){
            //console.log($scope.report[h].checked , h);
            if($scope.report[h].checked){
              $scope.reportmsg = $scope.reportmsg + $scope.report[h].text + ' ';
              //console.log($scope.reportmsg);
            }
          }
          if(h==3){
            console.log($scope.reportmsg);
            $http.post('https://ec2.diwoapp.com.br/reportaevento.php', {namereportado : $scope.evento.admusername,
                                                                            reportadoid : $scope.evento.idevento,
                                                                            iduserreportando : $scope.aux.iduser,
                                                                            usernamereportando : $scope.aux.username,
                                                                            tiporeport : 'evento',
                                                                            motivo : $scope.reportmsg}).then(function (tes){
              $scope.response = tes.data;
              var alertPopup = $ionicPopup.alert({
                                        title: 'Obrigado',
                                        template: 'Este evento esta agora sobre avaliação, obrigado por manter a plataforma organizada'
              });
            });
          }
        }
    });
  }

  $scope.entrar = function(){
    if($scope.ncomen>0){
      $state.go('tabsController.comentariosEFE');
    }else{
      var alertPopup = $ionicPopup.alert({title: '٩꒰´·⌢•｀꒱۶⁼³₌₃ﾟ',
                                        template: 'Ninguem comentou sobre este evento ainda'
      });
    }
  }


}])

.controller('ver_onde_mapaCtrl', ['$scope', '$stateParams', '$cordovaGeolocation', '$state', '$ionicLoading', 'formItem','$ionicTabsDelegate',  // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, $cordovaGeolocation, $state, $ionicLoading, formItem, $ionicTabsDelegate) {
 $scope.evento = formItem.getForm();
 //$scope.coord = {};
  console.log($scope.evento.lat);
  console.log($scope.evento.lng);
         $ionicTabsDelegate.showBar(0);
        var latlng = {lat: parseFloat($scope.evento.lat), lng: parseFloat($scope.evento.lng)};


        var mapOptions = {
                center: latlng,
                zoom: 16,
                mapTypeId: google.maps.MapTypeId.ROADMAP
            };          
             

        var map = new google.maps.Map(document.getElementById("map_canvas2"), mapOptions); 
        var geocoder = new google.maps.Geocoder;
        var infowindow = new google.maps.InfoWindow({
                                                      maxWidth: 200
                                                    });

        geocoder.geocode({'location': latlng}, function(results, status) {
          if (status === 'OK') {
            if (results[1]) {
              var marker = new google.maps.Marker({
                position: latlng,
                map: map,
                title: "Borai",
                icon: 'http://maps.google.com/mapfiles/ms/icons/green-dot.png',
                animation: google.maps.Animation.DROP 
              });
              infowindow.setContent(results[0].formatted_address);
              infowindow.open(map, marker);
            } else {
              window.alert('No results found');
            }
          } else {
            window.alert('Geocoder failed due to: ' + status);
          }
        });

        $scope.map = map;  
             
}])

.controller('comentariosEFECtrl', ['$scope', '$stateParams', 'formItem', 'EventoService', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, formItem, EventoService) {
  $scope.evento = formItem.getForm();
  $scope.nota = 0;
  $scope.items ={};
   
  EventoService.GetComentariosevento($scope.evento).then(function(items) {
    console.log(items)
    if(items=='Error'){
      $scope.nota = 0;
      $scope.items ={};
    }else{
      console.log('Tem comentarios')
      $scope.items = items;
      for (var i = 0; i < items.length; i++) {
        $scope.nota = parseFloat(items[i].nota) + $scope.nota ;
        if((items[i].profilepic[8] == 's' && items[i].profilepic[9] == '3')||(items[i].profilepic[8] == 'd' && items[i].profilepic[9] == 'i')){
          
             $scope.items[i].profilepic=items[i].profilepic+"?{{getTimeStamp()}}";
           }else{
             $scope.items[i].profilepic=items[i].profilepic;
           }
        //$scope.items[i].profilepic = items[i].profilepic+"?{{getTimeStamp()}}";;
      }
      $scope.nota = ($scope.nota/items.length).toFixed(1);
      
    }     
  });

}])

.controller('badgesCtrl', ['$scope', '$stateParams', 'formUser', 'EventoService','$ionicPopup', '$timeout','$state', '$cordovaCamera', '$cordovaFile', '$cordovaFileTransfer', '$ionicLoading','formBadge', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, formUser, EventoService, $ionicPopup, $timeout, $state, $cordovaCamera, $cordovaFile, $cordovaFileTransfer, $ionicLoading, formBadge) {


  $scope.user = formUser.getForm();
  $scope.aux = {};
  $scope.aux.iduser = $scope.user.iduser;


  $scope.aux.tag = "#ArteeCultura";
  $scope.auxnbadgeArteeCultura = 0;
  $scope.proximoArteeCultura = 0;
  $scope.proximoimgArteeCultura = '';
  $scope.anteriorimgArteeCultura = '';
  EventoService.getbadges($scope.aux).then(function(badges){
    console.log("badges", badges);
    if(badges!="Error" && badges !="E"){
      $scope.auxnbadgeArteeCultura = badges.length;
      if(badges.length == 0){
        $scope.anteriorimgArteeCultura = 'img/badges/Categorias/ArteeCultura/0.png';
        $scope.proximoArteeCultura = 1;
        $scope.proximoimgArteeCultura = 'img/badges/Categorias/ArteeCultura/1.png';

        document.getElementById("ArteeCultura").src="img/badges/Categorias/ArteeCultura/0.png"
      }
      if(badges.length == 1){
        $scope.anteriorimgArteeCultura = 'img/badges/Categorias/ArteeCultura/0.png';
        $scope.proximoArteeCultura = 2;
        $scope.proximoimgArteeCultura = 'img/badges/Categorias/ArteeCultura/1.1.png';
        document.getElementById("ArteeCultura").src="img/badges/Categorias/ArteeCultura/1.png"
      }
      if(badges.length == 2){
        $scope.anteriorimgArteeCultura = 'img/badges/Categorias/ArteeCultura/1.png';
        $scope.proximoArteeCultura = 3;
        $scope.proximoimgArteeCultura = 'img/badges/Categorias/ArteeCultura/1.2.png';
        document.getElementById("ArteeCultura").src="img/badges/Categorias/ArteeCultura/1.1.png"
      }
      if(badges.length == 3){
        $scope.anteriorimgArteeCultura = 'img/badges/Categorias/ArteeCultura/1.1.png';
        $scope.proximoArteeCultura = 4;
        $scope.proximoimgArteeCultura = 'img/badges/Categorias/ArteeCultura/1.3.png';
        document.getElementById("ArteeCultura").src="img/badges/Categorias/ArteeCultura/1.2.png"
      }
      if(badges.length == 4 || badges.length == 5){
        $scope.anteriorimgArteeCultura = 'img/badges/Categorias/ArteeCultura/1.2.pn';
        $scope.proximoArteeCultura = 6;
        $scope.proximoimgArteeCultura = 'img/badges/Categorias/ArteeCultura/2.png';
        document.getElementById("ArteeCultura").src="img/badges/Categorias/ArteeCultura/1.3.png"
      }

      if(badges.length == 6 || badges.length == 7){
        $scope.anteriorimgArteeCultura = 'img/badges/Categorias/ArteeCultura/1.3.png';
        $scope.proximoArteeCultura = 8;
        $scope.proximoimgArteeCultura = 'img/badges/Categorias/ArteeCultura/2.1.png';
        document.getElementById("ArteeCultura").src="img/badges/Categorias/ArteeCultura/2.png"
      }
      if(badges.length == 8 || badges.length == 9){
        $scope.anteriorimgArteeCultura = 'img/badges/Categorias/ArteeCultura/2.png';
        $scope.proximoArteeCultura = 10;
        $scope.proximoimgArteeCultura = 'img/badges/Categorias/ArteeCultura/2.2.png';
        document.getElementById("ArteeCultura").src="img/badges/Categorias/ArteeCultura/2.1.png"
      }
      if(badges.length == 10 || badges.length == 11){
        $scope.anteriorimgArteeCultura = 'img/badges/Categorias/ArteeCultura/2.1.png';
        $scope.proximoArteeCultura = 12;
        $scope.proximoimgArteeCultura = 'img/badges/Categorias/ArteeCultura/2.3.png';
        document.getElementById("ArteeCultura").src="img/badges/Categorias/ArteeCultura/2.2.png"
      }
      if(badges.length == 12 || badges.length == 13 || badges.length == 14){
        $scope.anteriorimgArteeCultura = 'img/badges/Categorias/ArteeCultura/2.2.png';
        $scope.proximoArteeCultura = 15;
        $scope.proximoimgArteeCultura = 'img/badges/Categorias/ArteeCultura/3.png';
        document.getElementById("ArteeCultura").src="img/badges/Categorias/ArteeCultura/2.3.png"
      }

      if(badges.length >= 15 && badges.length < 20 ){
        $scope.anteriorimgArteeCultura = 'img/badges/Categorias/ArteeCultura/2.3.png';
        $scope.proximoArteeCultura = 20;
        $scope.proximoimgArteeCultura = 'img/badges/Categorias/ArteeCultura/3.1.png';
        document.getElementById("ArteeCultura").src="img/badges/Categorias/ArteeCultura/3.png"
      }
      if(badges.length >= 20 && badges.length < 22 ){
        $scope.anteriorimgArteeCultura = 'img/badges/Categorias/ArteeCultura/3.png';
        $scope.proximoArteeCultura = 25;
        $scope.proximoimgArteeCultura = 'img/badges/Categorias/ArteeCultura/3.2.png';
        document.getElementById("ArteeCultura").src="img/badges/Categorias/ArteeCultura/3.1.png"
      }
      if(badges.length >= 25 && badges.length < 30 ){
        $scope.anteriorimgArteeCultura = 'img/badges/Categorias/ArteeCultura/3.1.png';
        $scope.proximoArteeCultura = 30;
        $scope.proximoimgArteeCultura = 'img/badges/Categorias/ArteeCultura/3.3.png';
        document.getElementById("ArteeCultura").src="img/badges/Categorias/ArteeCultura/3.2.png"
      }
      if(badges.length >= 30 && badges.length < 50 ){
        $scope.anteriorimgArteeCultura = 'img/badges/Categorias/ArteeCultura/3.2.png';
        $scope.proximoArteeCultura = 50;
        $scope.proximoimgArteeCultura = 'img/badges/Categorias/ArteeCultura/Super.png';
        document.getElementById("ArteeCultura").src="img/badges/Categorias/ArteeCultura/3.3.png"
      }

      if(badges.length >= 50){

        $scope.anteriorimgArteeCultura = 'img/badges/Categorias/ArteeCultura/3.3.png';
        $scope.proximoArteeCultura = 10000;
        $scope.proximoimgArteeCultura = 'img/badges/Categorias/ArteeCultura/Super.png';
        document.getElementById("ArteeCultura").src="img/badges/Categorias/ArteeCultura/Super.png"
      }

    }else{
      $scope.auxnbadgeArteeCultura = 0;
      $scope.anteriorimgArteeCultura = 'img/badges/Categorias/ArteeCultura/0.png';
        $scope.proximoArteeCultura = 1;
        $scope.proximoimgArteeCultura = 'img/badges/Categorias/ArteeCultura/1.png';
      document.getElementById("ArteeCultura").src="img/badges/Categorias/ArteeCultura/0.png"
    }
  });

  $scope.aux.tag = "#Ciclismo";
  $scope.auxnbadgeCiclismo = 0;
  $scope.proximoCiclismo = 0;
  $scope.proximoimgCiclismo = '';
  $scope.anteriorimgCiclismo = '';
  EventoService.getbadges($scope.aux).then(function(badges){
    console.log("badges", badges);
    if(badges!="Error" && badges !="E"){
      $scope.auxnbadgeCiclismo = badges.length;
      if(badges.length == 0){
        $scope.anteriorimgCiclismoa = 'img/badges/Categorias/Ciclismo/0.png';
        $scope.proximoCiclismo = 1;
        $scope.proximoimgCiclismo = 'img/badges/Categorias/Ciclismo/1.png';
        document.getElementById("Ciclismo").src="img/badges/Categorias/Ciclismo/0.png"
      }
      if(badges.length == 1){
        $scope.anteriorimgCiclismoa = 'img/badges/Categorias/Ciclismo/0.png';
        $scope.proximoCiclismo = 2;
        $scope.proximoimgCiclismo = 'img/badges/Categorias/Ciclismo/1.1.png';
        document.getElementById("Ciclismo").src="img/badges/Categorias/Ciclismo/1.png"
      }
      if(badges.length == 2){
        $scope.anteriorimgCiclismoa = 'img/badges/Categorias/Ciclismo/1.png';
        $scope.proximoCiclismo = 3;
        $scope.proximoimgCiclismo = 'img/badges/Categorias/Ciclismo/1.2.png';
        document.getElementById("Ciclismo").src="img/badges/Categorias/Ciclismo/1.1.png"
      }
      if(badges.length == 3){
        $scope.anteriorimgCiclismoa = 'img/badges/Categorias/Ciclismo/1.1.png';
        $scope.proximoCiclismo = 4;
        $scope.proximoimgCiclismo = 'img/badges/Categorias/Ciclismo/1.3.png';
        document.getElementById("Ciclismo").src="img/badges/Categorias/Ciclismo/1.2.png"
      }
      if(badges.length == 4 || badges.length == 5){
        $scope.anteriorimgCiclismoa = 'img/badges/Categorias/Ciclismo/1.2.png';
        $scope.proximoCiclismo = 6;
        $scope.proximoimgCiclismo = 'img/badges/Categorias/Ciclismo/2.png';
        document.getElementById("Ciclismo").src="img/badges/Categorias/Ciclismo/1.3.png"
      }

      if(badges.length == 6 || badges.length == 7){
        $scope.anteriorimgCiclismoa = 'img/badges/Categorias/Ciclismo/1.3.png';
        $scope.proximoCiclismo = 8;
        $scope.proximoimgCiclismo = 'img/badges/Categorias/Ciclismo/2.1.png';
        document.getElementById("Ciclismo").src="img/badges/Categorias/Ciclismo/2.png"
      }
      if(badges.length == 8 || badges.length == 9){
        $scope.anteriorimgCiclismoa = 'img/badges/Categorias/Ciclismo/2.png';
        $scope.proximoCiclismo = 10;
        $scope.proximoimgCiclismo = 'img/badges/Categorias/Ciclismo/2.2.png';
        document.getElementById("Ciclismo").src="img/badges/Categorias/Ciclismo/2.1.png"
      }
      if(badges.length == 10 || badges.length == 11){
        $scope.anteriorimgCiclismoa = 'img/badges/Categorias/Ciclismo/2.1.png';
        $scope.proximoCiclismo = 12;
        $scope.proximoimgCiclismo = 'img/badges/Categorias/Ciclismo/2.3.png';
        document.getElementById("Ciclismo").src="img/badges/Categorias/Ciclismo/2.2.png"
      }
      if(badges.length == 12 || badges.length == 13 || badges.length == 14){
        $scope.anteriorimgCiclismoa = 'img/badges/Categorias/Ciclismo/2.2.png';
        $scope.proximoCiclismo = 15;
        $scope.proximoimgCiclismo = 'img/badges/Categorias/Ciclismo/3.png';
        document.getElementById("Ciclismo").src="img/badges/Categorias/Ciclismo/2.3.png"
      }

      if(badges.length >= 15 && badges.length < 20 ){
        $scope.anteriorimgCiclismoa = 'img/badges/Categorias/Ciclismo/2.3.png';
        $scope.proximoCiclismo = 20;
        $scope.proximoimgCiclismo = 'img/badges/Categorias/Ciclismo/3.1.png';
        document.getElementById("Ciclismo").src="img/badges/Categorias/Ciclismo/3.png"
      }
      if(badges.length >= 20 && badges.length < 22 ){
        $scope.anteriorimgCiclismoa = 'img/badges/Categorias/Ciclismo/3.png';
        $scope.proximoCiclismo = 25;
        $scope.proximoimgCiclismo = 'img/badges/Categorias/Ciclismo/3.2.png';
        document.getElementById("Ciclismo").src="img/badges/Categorias/Ciclismo/3.1.png"
      }
      if(badges.length >= 25 && badges.length < 30 ){
        $scope.anteriorimgCiclismoa = 'img/badges/Categorias/Ciclismo/3.1.png';
        $scope.proximoCiclismo = 30;
        $scope.proximoimgCiclismo = 'img/badges/Categorias/Ciclismo/3.3.png';
        document.getElementById("Ciclismo").src="img/badges/Categorias/Ciclismo/3.2.png"
      }
      if(badges.length >= 30 && badges.length < 50 ){
        $scope.anteriorimgCiclismoa = 'img/badges/Categorias/Ciclismo/3.2.png';
        $scope.proximoCiclismo = 50;
        $scope.proximoimgCiclismo = 'img/badges/Categorias/Ciclismo/Super.png';
        document.getElementById("Ciclismo").src="img/badges/Categorias/Ciclismo/3.3.png"
      }

      if(badges.length >= 50){

        $scope.anteriorimgCiclismoa = 'img/badges/Categorias/Ciclismo/3.3.png';
        $scope.proximoCiclismo = 10000;
        $scope.proximoimgCiclismo = 'img/badges/Categorias/Ciclismo/Super.png';
        document.getElementById("Ciclismo").src="img/badges/Categorias/Ciclismo/Super.png"
      }

    }else{
      $scope.auxnbadgeCiclismo = 0;
      $scope.anteriorimgCiclismoa = 'img/badges/Categorias/Ciclismo/0.png';
      $scope.proximoCiclismo = 1;
      $scope.proximoimgCiclismo = 'img/badges/Categorias/Ciclismo/1.png';
      document.getElementById("Ciclismo").src="img/badges/Categorias/Ciclismo/0.png"
    }
  });

  $scope.aux.tag = "#Conversa";
  $scope.auxnbadgeConversa = 0;
  $scope.proximoConversa = 0;
  $scope.proximoimgConversa = '';
  $scope.anteriorimgConversa = '';
  EventoService.getbadges($scope.aux).then(function(badges){
    console.log("badges", badges);
    if(badges!="Error" && badges !="E"){
      $scope.auxnbadgeConversa = badges.length;
      if(badges.length == 0){
        $scope.anteriorimgConversa = 'img/badges/Categorias/Conversa/0.png';
        $scope.proximoConversa = 1;
        $scope.proximoimgConversa = 'img/badges/Categorias/Conversa/1.png';
        document.getElementById("Conversa").src="img/badges/Categorias/Conversa/0.png"
      }
      if(badges.length == 1){
        $scope.anteriorimgConversa = 'img/badges/Categorias/Conversa/0.png';
        $scope.proximoConversa = 2;
        $scope.proximoimgConversa = 'img/badges/Categorias/Conversa/1.1.png';
        document.getElementById("Conversa").src="img/badges/Categorias/Conversa/1.png"
      }
      if(badges.length == 2){
        $scope.anteriorimgConversa = 'img/badges/Categorias/Conversa/1.png';
        $scope.proximoConversa = 3;
        $scope.proximoimgConversa = 'img/badges/Categorias/Conversa/1.2.png';
        document.getElementById("Conversa").src="img/badges/Categorias/Conversa/1.1.png"
      }
      if(badges.length == 3){
        $scope.anteriorimgConversa = 'img/badges/Categorias/Conversa/1.1.png';
        $scope.proximoConversa = 4;
        $scope.proximoimgConversa = 'img/badges/Categorias/Conversa/1.3.png';
        document.getElementById("Conversa").src="img/badges/Categorias/Conversa/1.2.png"
      }
      if(badges.length == 4 || badges.length == 5){
        $scope.anteriorimgConversa = 'img/badges/Categorias/Conversa/1.2.png';
        $scope.proximoConversa = 6;
        $scope.proximoimgConversa = 'img/badges/Categorias/Conversa/2.png';
        document.getElementById("Conversa").src="img/badges/Categorias/Conversa/1.3.png"
      }

      if(badges.length == 6 || badges.length == 7){
        $scope.anteriorimgConversa = 'img/badges/Categorias/Conversa/1.3.png';
        $scope.proximoConversa = 8;
        $scope.proximoimgConversa = 'img/badges/Categorias/Conversa/2.1.png';
        document.getElementById("Conversa").src="img/badges/Categorias/Conversa/2.png"
      }
      if(badges.length == 8 || badges.length == 9){
        $scope.anteriorimgConversa = 'img/badges/Categorias/Conversa/2.png';
        $scope.proximoConversa = 10;
        $scope.proximoimgConversa = 'img/badges/Categorias/Conversa/2.2.png';
        document.getElementById("Conversa").src="img/badges/Categorias/Conversa/2.1.png"
      }
      if(badges.length == 10 || badges.length == 11){
        $scope.anteriorimgConversa = 'img/badges/Categorias/Conversa/2.1.png';
        $scope.proximoConversa = 12;
        $scope.proximoimgConversa = 'img/badges/Categorias/Conversa/2.3.png';
        document.getElementById("Conversa").src="img/badges/Categorias/Conversa/2.2.png"
      }
      if(badges.length == 12 || badges.length == 13 || badges.length == 14){
        $scope.anteriorimgConversa = 'img/badges/Categorias/Conversa/2.2.png';
        $scope.proximoConversa = 15;
        $scope.proximoimgConversa = 'img/badges/Categorias/Conversa/3.png';
        document.getElementById("Conversa").src="img/badges/Categorias/Conversa/2.3.png"
      }

      if(badges.length >= 15 && badges.length < 20 ){
        $scope.anteriorimgConversa = 'img/badges/Categorias/Conversa/2.3.png';
        $scope.proximoConversa = 20;
        $scope.proximoimgConversa = 'img/badges/Categorias/Conversa/3.1.png';
        document.getElementById("Conversa").src="img/badges/Categorias/Conversa/3.png"
      }
      if(badges.length >= 20 && badges.length < 22 ){
        $scope.anteriorimgConversa = 'img/badges/Categorias/Conversa/3.png';
        $scope.proximoConversa = 25;
        $scope.proximoimgConversa = 'img/badges/Categorias/Conversa/3.2.png';
        document.getElementById("Conversa").src="img/badges/Categorias/Conversa/3.1.png"
      }
      if(badges.length >= 25 && badges.length < 30 ){
        $scope.anteriorimgConversa = 'img/badges/Categorias/Conversa/3.1.png';
        $scope.proximoConversa = 30;
        $scope.proximoimgConversa = 'img/badges/Categorias/Conversa/3.3.png';
        document.getElementById("Conversa").src="img/badges/Categorias/Conversa/3.2.png"
      }
      if(badges.length >= 30 && badges.length < 50 ){
        $scope.anteriorimgConversa = 'img/badges/Categorias/Conversa/3.2.png';
        $scope.proximoConversa = 50;
        $scope.proximoimgConversa = 'img/badges/Categorias/Conversa/Super.png';
        document.getElementById("Conversa").src="img/badges/Categorias/Conversa/3.3.png"
      }

      if(badges.length >= 50){
        $scope.anteriorimgConversa = 'img/badges/Categorias/Conversa/3.3.png';
        $scope.proximoConversa = 10000;
        $scope.proximoimgConversa = 'img/badges/Categorias/Conversa/Super.png';
        document.getElementById("Conversa").src="img/badges/Categorias/Conversa/Super.png"
      }

    }else{
      $scope.auxnbadgeConversa = 0;

        $scope.anteriorimgConversa = 'img/badges/Categorias/Conversa/0.png';
        $scope.proximoConversa = 1;
        $scope.proximoimgConversa = 'img/badges/Categorias/Conversa/1.png';
      document.getElementById("Conversa").src="img/badges/Categorias/Conversa/0.png"
    }
  });

  $scope.aux.tag = "#Dança";
  $scope.auxnbadgeDanca = 0;
  $scope.proximoDanca = 0;
  $scope.proximoimgDanca = '';
  $scope.anteriorimgDanca = '';
  EventoService.getbadges($scope.aux).then(function(badges){
    console.log("badges", badges);
    if(badges!="Error" && badges !="E"){
      $scope.auxnbadgeDanca = badges.length;
      if(badges.length == 0){
        $scope.anteriorimgDanca = 'img/badges/Categorias/Danca/0.png';
        $scope.proximoDanca = 1;
        $scope.proximoimgDanca = 'img/badges/Categorias/Danca/1.png';
        document.getElementById("Danca").src="img/badges/Categorias/Danca/0.png"
      }
      if(badges.length == 1){
        $scope.anteriorimgDanca = 'img/badges/Categorias/Danca/0.png';
        $scope.proximoDanca = 2;
        $scope.proximoimgDanca = 'img/badges/Categorias/Danca/1.1.png';
        document.getElementById("Danca").src="img/badges/Categorias/Danca/1.png"
      }
      if(badges.length == 2){
        $scope.anteriorimgDanca = 'img/badges/Categorias/Danca/1.png';
        $scope.proximoDanca = 3;
        $scope.proximoimgDanca = 'img/badges/Categorias/Danca/1.2.png';
        document.getElementById("Danca").src="img/badges/Categorias/Danca/1.1.png"
      }
      if(badges.length == 3){
        $scope.anteriorimgDanca = 'img/badges/Categorias/Danca/1.1.png';
        $scope.proximoDanca = 4;
        $scope.proximoimgDanca = 'img/badges/Categorias/Danca/1.3.png';
        document.getElementById("Danca").src="img/badges/Categorias/Danca/1.2.png"
      }
      if(badges.length == 4 || badges.length == 5){
        $scope.anteriorimgDanca = 'img/badges/Categorias/Danca/1.2.png';
        $scope.proximoDanca = 6;
        $scope.proximoimgDanca = 'img/badges/Categorias/Danca/2.png';
        document.getElementById("Danca").src="img/badges/Categorias/Danca/1.3.png"
      }

      if(badges.length == 6 || badges.length == 7){
        $scope.anteriorimgDanca = 'img/badges/Categorias/Danca/1.3.png';
        $scope.proximoDanca = 8;
        $scope.proximoimgDanca = 'img/badges/Categorias/Danca/2.1.png';
        document.getElementById("Danca").src="img/badges/Categorias/Danca/2.png"
      }
      if(badges.length == 8 || badges.length == 9){
        $scope.anteriorimgDanca = 'img/badges/Categorias/Danca/2.png';
        $scope.proximoDanca = 10;
        $scope.proximoimgDanca = 'img/badges/Categorias/Danca/2.2.png';
        document.getElementById("Danca").src="img/badges/Categorias/Danca/2.1.png"
      }
      if(badges.length == 10 || badges.length == 11){
        $scope.anteriorimgDanca = 'img/badges/Categorias/Danca/2.1.png';
        $scope.proximoDanca = 12;
        $scope.proximoimgDanca = 'img/badges/Categorias/Danca/2.3.png';
        document.getElementById("Danca").src="img/badges/Categorias/Danca/2.2.png"
      }
      if(badges.length == 12 || badges.length == 13 || badges.length == 14){
        $scope.anteriorimgDanca = 'img/badges/Categorias/Danca/2.2.png';
        $scope.proximoDanca = 15;
        $scope.proximoimgDanca = 'img/badges/Categorias/Danca/3.png';
        document.getElementById("Danca").src="img/badges/Categorias/Danca/2.3.png"
      }

      if(badges.length >= 15 && badges.length < 20 ){
        $scope.anteriorimgDanca = 'img/badges/Categorias/Danca/2.3.png';
        $scope.proximoDanca = 20;
        $scope.proximoimgDanca = 'img/badges/Categorias/Danca/3.png';
        document.getElementById("Danca").src="img/badges/Categorias/Danca/3.png"
      }
      if(badges.length >= 20 && badges.length < 22 ){
        $scope.anteriorimgDanca = 'img/badges/Categorias/Danca/3.png';
        $scope.proximoDanca = 25;
        $scope.proximoimgDanca = 'img/badges/Categorias/Danca/3.2.png';
        document.getElementById("Danca").src="img/badges/Categorias/Danca/3.1.png"
      }
      if(badges.length >= 25 && badges.length < 30 ){
        $scope.anteriorimgDanca = 'img/badges/Categorias/Danca/3.1.png';
        $scope.proximoDanca = 30;
        $scope.proximoimgDanca = 'img/badges/Categorias/Danca/3.3.png';
        document.getElementById("Danca").src="img/badges/Categorias/Danca/3.2.png"
      }
      if(badges.length >= 30 && badges.length < 50 ){
        $scope.anteriorimgDanca = 'img/badges/Categorias/Danca/3.2.png';
        $scope.proximoDanca = 50;
        $scope.proximoimgDanca = 'img/badges/Categorias/Danca/Super.png';
        document.getElementById("Danca").src="img/badges/Categorias/Danca/3.3.png"
      }

      if(badges.length >= 50){
        $scope.anteriorimgDanca = 'img/badges/Categorias/Danca/3.3.png';
        $scope.proximoDanca = 10000;
        $scope.proximoimgDanca = 'img/badges/Categorias/Danca/Super.png';
        document.getElementById("Danca").src="img/badges/Categorias/Danca/Super.png"
      }

    }else{
      $scope.auxnbadgeDanca = 0;
        $scope.anteriorimgDanca = 'img/badges/Categorias/Danca/0.png';
        $scope.proximoDanca = 1;
        $scope.proximoimgDanca = 'img/badges/Categorias/Danca/1.png';
      document.getElementById("Danca").src="img/badges/Categorias/Danca/0.png"
    }
  });

  $scope.aux.tag = "#EsportesdePraia";
  $scope.auxnbadgeEsportesdePraia = 0;
  $scope.proximoEsportesdePraia = 0;
  $scope.proximoimgEsportesdePraia = '';
  $scope.anteriorimgEsportesdePraia = '';
  EventoService.getbadges($scope.aux).then(function(badges){
    console.log("badges", badges);
    if(badges!="Error" && badges !="E"){
      $scope.auxnbadgeEsportesdePraia = badges.length;
      if(badges.length == 0){
        $scope.anteriorimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/0.png';
        $scope.proximoEsportesdePraia = 1;
        $scope.proximoimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/1.png';
        document.getElementById("EsportesdePraia").src="img/badges/Categorias/EsportesdePraia/0.png"
      }
      if(badges.length == 1){
        $scope.anteriorimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/0.png';
        $scope.proximoEsportesdePraia = 2;
        $scope.proximoimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/1.1.png';
        document.getElementById("EsportesdePraia").src="img/badges/Categorias/EsportesdePraia/1.png"
      }
      if(badges.length == 2){
        $scope.anteriorimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/1.png';
        $scope.proximoEsportesdePraia = 3;
        $scope.proximoimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/1.2.png';
        document.getElementById("EsportesdePraia").src="img/badges/Categorias/EsportesdePraia/1.1.png"
      }
      if(badges.length == 3){
        $scope.anteriorimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/1.1.png';
        $scope.proximoEsportesdePraia = 4;
        $scope.proximoimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/1.3.png';
        document.getElementById("EsportesdePraia").src="img/badges/Categorias/EsportesdePraia/1.2.png"
      }
      if(badges.length == 4 || badges.length == 5){
        $scope.anteriorimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/1.2.png';
        $scope.proximoEsportesdePraia = 6;
        $scope.proximoimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/2.png';
        document.getElementById("EsportesdePraia").src="img/badges/Categorias/EsportesdePraia/1.3.png"
      }

      if(badges.length == 6 || badges.length == 7){
        $scope.anteriorimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/1.3.png';
        $scope.proximoEsportesdePraia = 8;
        $scope.proximoimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/2.1.png';
        document.getElementById("EsportesdePraia").src="img/badges/Categorias/EsportesdePraia/2.png"
      }
      if(badges.length == 8 || badges.length == 9){
        $scope.anteriorimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/2.png';
        $scope.proximoEsportesdePraia = 10;
        $scope.proximoimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/2.2.png';
        document.getElementById("EsportesdePraia").src="img/badges/Categorias/EsportesdePraia/2.1.png"
      }
      if(badges.length == 10 || badges.length == 11){
        $scope.anteriorimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/2.1.png';
        $scope.proximoEsportesdePraia = 12;
        $scope.proximoimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/2.3.png';
        document.getElementById("EsportesdePraia").src="img/badges/Categorias/EsportesdePraia/2.2.png"
      }
      if(badges.length == 12 || badges.length == 13 || badges.length == 14){
        $scope.anteriorimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/2.2.png';
        $scope.proximoEsportesdePraia = 15;
        $scope.proximoimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/3.png';
        document.getElementById("EsportesdePraia").src="img/badges/Categorias/EsportesdePraia/2.3.png"
      }

      if(badges.length >= 15 && badges.length < 20 ){
        $scope.anteriorimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/2.3.png';
        $scope.proximoEsportesdePraia = 20;
        $scope.proximoimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/3.1.png';
        document.getElementById("EsportesdePraia").src="img/badges/Categorias/EsportesdePraia/3.png"
      }
      if(badges.length >= 20 && badges.length < 22 ){
        $scope.anteriorimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/3.png';
        $scope.proximoEsportesdePraia = 25;
        $scope.proximoimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/3.2.png';
        document.getElementById("EsportesdePraia").src="img/badges/Categorias/EsportesdePraia/3.1.png"
      }
      if(badges.length >= 25 && badges.length < 30 ){
        $scope.anteriorimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/3.1.png';
        $scope.proximoEsportesdePraia = 30;
        $scope.proximoimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/1.png';
        document.getElementById("EsportesdePraia").src="img/badges/Categorias/EsportesdePraia/3.2.png"
      }
      if(badges.length >= 30 && badges.length < 50 ){
        $scope.anteriorimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/3.2.png';
        $scope.proximoEsportesdePraia = 50;
        $scope.proximoimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/Super.png';
        document.getElementById("EsportesdePraia").src="img/badges/Categorias/EsportesdePraia/3.3.png"
      }

      if(badges.length >= 50){
        $scope.anteriorimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/3.3.png';
        $scope.proximoEsportesdePraia = 10000;
        $scope.proximoimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/Super.png';
        document.getElementById("EsportesdePraia").src="img/badges/Categorias/EsportesdePraia/Super.png"
      }

    }else{
      $scope.auxnbadgeEsportesdePraia = 0;
        $scope.anteriorimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/0.png';
        $scope.proximoEsportesdePraia = 1;
        $scope.proximoimgEsportesdePraia = 'img/badges/Categorias/EsportesdePraia/1.png';
      document.getElementById("EsportesdePraia").src="img/badges/Categorias/EsportesdePraia/0.png"
    }
  });

  $scope.aux.tag = "#FestaseBaladas";
  $scope.auxnbadgeFestaseBaladas = 0;
  $scope.proximoFestaseBaladas = 0;
  $scope.proximoimgFestaseBaladas = '';
  $scope.anteriorimgFestaseBaladas = '';
  EventoService.getbadges($scope.aux).then(function(badges){
    console.log("badges", badges);
    if(badges!="Error" && badges !="E"){
      $scope.auxnbadgeFestaseBaladas = badges.length;
      if(badges.length == 0){
        $scope.anteriorimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/0.png';
        $scope.proximoFestaseBaladas = 1;
        $scope.proximoimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/1.png';
        document.getElementById("FestaseBaladas").src="img/badges/Categorias/FestaseBaladas/0.png"
      }
      if(badges.length == 1){
        $scope.anteriorimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/0.png';
        $scope.proximoFestaseBaladas = 2;
        $scope.proximoimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/1.1.png';
        document.getElementById("FestaseBaladas").src="img/badges/Categorias/FestaseBaladas/1.png"
      }
      if(badges.length == 2){
        $scope.anteriorimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/1.png';
        $scope.proximoFestaseBaladas = 3;
        $scope.proximoimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/1.2.png';
        document.getElementById("FestaseBaladas").src="img/badges/Categorias/FestaseBaladas/1.1.png"
      }
      if(badges.length == 3){
        $scope.anteriorimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/1.1.png';
        $scope.proximoFestaseBaladas = 4;
        $scope.proximoimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/1.3.png';
        document.getElementById("FestaseBaladas").src="img/badges/Categorias/FestaseBaladas/1.2.png"
      }
      if(badges.length == 4 || badges.length == 5){
        $scope.anteriorimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/1.2.png';
        $scope.proximoFestaseBaladas = 6;
        $scope.proximoimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/2.png';
        document.getElementById("FestaseBaladas").src="img/badges/Categorias/FestaseBaladas/1.3.png"
      }

      if(badges.length == 6 || badges.length == 7){
        $scope.anteriorimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/1.3.png';
        $scope.proximoFestaseBaladas = 8;
        $scope.proximoimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/2.1.png';
        document.getElementById("FestaseBaladas").src="img/badges/Categorias/FestaseBaladas/2.png"
      }
      if(badges.length == 8 || badges.length == 9){
        $scope.anteriorimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/2.png';
        $scope.proximoFestaseBaladas = 10;
        $scope.proximoimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/2.2.png';
        document.getElementById("FestaseBaladas").src="img/badges/Categorias/FestaseBaladas/2.1.png"
      }
      if(badges.length == 10 || badges.length == 11){
        $scope.anteriorimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/2.1.png';
        $scope.proximoFestaseBaladas = 12;
        $scope.proximoimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/2.3.png';
        document.getElementById("FestaseBaladas").src="img/badges/Categorias/FestaseBaladas/2.2.png"
      }
      if(badges.length == 12 || badges.length == 13 || badges.length == 14){
        $scope.anteriorimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/2.2.png';
        $scope.proximoFestaseBaladas = 15;
        $scope.proximoimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/3.png';
        document.getElementById("FestaseBaladas").src="img/badges/Categorias/FestaseBaladas/2.3.png"
      }

      if(badges.length >= 15 && badges.length < 20 ){
        $scope.anteriorimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/2.3.png';
        $scope.proximoFestaseBaladas = 20;
        $scope.proximoimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/3.1.png';
        document.getElementById("FestaseBaladas").src="img/badges/Categorias/FestaseBaladas/3.png"
      }
      if(badges.length >= 20 && badges.length < 22 ){
        $scope.anteriorimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/3.png';
        $scope.proximoFestaseBaladas = 25;
        $scope.proximoimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/3.2.png';
        document.getElementById("FestaseBaladas").src="img/badges/Categorias/FestaseBaladas/3.1.png"
      }
      if(badges.length >= 25 && badges.length < 30 ){
        $scope.anteriorimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/3.1.png';
        $scope.proximoFestaseBaladas = 30;
        $scope.proximoimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/3.3.png';
        document.getElementById("FestaseBaladas").src="img/badges/Categorias/FestaseBaladas/3.2.png"
      }
      if(badges.length >= 30 && badges.length < 50 ){
        $scope.anteriorimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/3.2.png';
        $scope.proximoFestaseBaladas = 50;
        $scope.proximoimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/Super.png';
        document.getElementById("FestaseBaladas").src="img/badges/Categorias/FestaseBaladas/3.3.png"
      }

      if(badges.length >= 50){
        $scope.anteriorimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/3.3.png';
        $scope.proximoFestaseBaladas = 10000;
        $scope.proximoimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/Super.png';
        document.getElementById("FestaseBaladas").src="img/badges/Categorias/FestaseBaladas/Super.png"
      }

    }else{
      $scope.auxnbadgeFestaseBaladas = 0;
        $scope.anteriorimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/0.png';
        $scope.proximoFestaseBaladas = 1;
        $scope.proximoimgFestaseBaladas = 'img/badges/Categorias/FestaseBaladas/1.png';
      document.getElementById("FestaseBaladas").src="img/badges/Categorias/FestaseBaladas/0.png"
    }
  });

  $scope.aux.tag = "#Futebol";
  $scope.auxnbadgeFutebol = 0;
  $scope.proximoFutebol = 0;
  $scope.proximoimgFutebol = '';
  $scope.anteriorimgFutebol = '';
  EventoService.getbadges($scope.aux).then(function(badges){
    console.log("badges", badges);
    if(badges!="Error" && badges !="E"){
      $scope.auxnbadgeFutebol = badges.length;
      if(badges.length == 0){
        $scope.anteriorimgFutebol = 'img/badges/Categorias/Futebol/0.png';
        $scope.proximoFutebol = 1;
        $scope.proximoimgFutebol = 'img/badges/Categorias/Futebol/1.png';
        document.getElementById("Futebol").src="img/badges/Categorias/Futebol/0.png"
      }
      if(badges.length == 1){
        $scope.anteriorimgFutebol = 'img/badges/Categorias/Futebol/0.png';
        $scope.proximoFutebol = 2;
        $scope.proximoimgFutebol = 'img/badges/Categorias/Futebol/1.1.png';
        document.getElementById("Futebol").src="img/badges/Categorias/Futebol/1.png"
      }
      if(badges.length == 2){
        $scope.anteriorimgFutebol = 'img/badges/Categorias/Futebol/1.png';
        $scope.proximoFutebol = 3;
        $scope.proximoimgFutebol = 'img/badges/Categorias/Futebol/1.2.png';
        document.getElementById("Futebol").src="img/badges/Categorias/Futebol/1.1.png"
      }
      if(badges.length == 3){
        $scope.anteriorimgFutebol = 'img/badges/Categorias/Futebol/1.1.png';
        $scope.proximoFutebol = 4;
        $scope.proximoimgFutebol = 'img/badges/Categorias/Futebol/1.3.png';
        document.getElementById("Futebol").src="img/badges/Categorias/Futebol/1.2.png"
      }
      if(badges.length == 4 || badges.length == 5){
        $scope.anteriorimgFutebol = 'img/badges/Categorias/Futebol/1.2.png';
        $scope.proximoFutebol = 6;
        $scope.proximoimgFutebol = 'img/badges/Categorias/Futebol/2.png';
        document.getElementById("Futebol").src="img/badges/Categorias/Futebol/1.3.png"
      }

      if(badges.length == 6 || badges.length == 7){
        $scope.anteriorimgFutebol = 'img/badges/Categorias/Futebol/1.3.png';
        $scope.proximoFutebol = 8;
        $scope.proximoimgFutebol = 'img/badges/Categorias/Futebol/2.1.png';
        document.getElementById("Futebol").src="img/badges/Categorias/Futebol/2.png"
      }
      if(badges.length == 8 || badges.length == 9){
        $scope.anteriorimgFutebol = 'img/badges/Categorias/Futebol/2.png';
        $scope.proximoFutebol = 10;
        $scope.proximoimgFutebol = 'img/badges/Categorias/Futebol/2.2.png';
        document.getElementById("Futebol").src="img/badges/Categorias/Futebol/2.1.png"
      }
      if(badges.length == 10 || badges.length == 11){
        $scope.anteriorimgFutebol = 'img/badges/Categorias/Futebol/2.1.png';
        $scope.proximoFutebol = 12;
        $scope.proximoimgFutebol = 'img/badges/Categorias/Futebol/2.3.png';
        document.getElementById("Futebol").src="img/badges/Categorias/Futebol/2.2.png"
      }
      if(badges.length == 12 || badges.length == 13 || badges.length == 14){
        $scope.anteriorimgFutebol = 'img/badges/Categorias/Futebol/2.2.png';
        $scope.proximoFutebol = 15;
        $scope.proximoimgFutebol = 'img/badges/Categorias/Futebol/3.png';
        document.getElementById("Futebol").src="img/badges/Categorias/Futebol/2.3.png"
      }

      if(badges.length >= 15 && badges.length < 20 ){
        $scope.anteriorimgFutebol = 'img/badges/Categorias/Futebol/2.3.png';
        $scope.proximoFutebol = 20;
        $scope.proximoimgFutebol = 'img/badges/Categorias/Futebol/3.1.png';
        document.getElementById("Futebol").src="img/badges/Categorias/Futebol/3.png"
      }
      if(badges.length >= 20 && badges.length < 22 ){
        $scope.anteriorimgFutebol = 'img/badges/Categorias/Futebol/3.png';
        $scope.proximoFutebol = 25;
        $scope.proximoimgFutebol = 'img/badges/Categorias/Futebol/3.2.png';
        document.getElementById("Futebol").src="img/badges/Categorias/Futebol/3.1.png"
      }
      if(badges.length >= 25 && badges.length < 30 ){
        $scope.anteriorimgFutebol = 'img/badges/Categorias/Futebol/3.1.png';
        $scope.proximoFutebol = 30;
        $scope.proximoimgFutebol = 'img/badges/Categorias/Futebol/3.3.png';
        document.getElementById("Futebol").src="img/badges/Categorias/Futebol/3.2.png"
      }
      if(badges.length >= 30 && badges.length < 50 ){
        $scope.anteriorimgFutebol = 'img/badges/Categorias/Futebol/3.2.png';
        $scope.proximoFutebol = 50;
        $scope.proximoimgFutebol = 'img/badges/Categorias/Futebol/Super.png';
        document.getElementById("Futebol").src="img/badges/Categorias/Futebol/3.3.png"
      }

      if(badges.length >= 50){
        $scope.anteriorimgFutebol = 'img/badges/Categorias/Futebol/3.3.png';
        $scope.proximoFutebol = 10000;
        $scope.proximoimgFutebol = 'img/badges/Categorias/Futebol/Super.png';
        document.getElementById("Futebol").src="img/badges/Categorias/Futebol/Super.png"
      }

    }else{
      $scope.auxnbadgeFutebol = 0;

        $scope.anteriorimgFutebol = 'img/badges/Categorias/Futebol/0.png';
        $scope.proximoFutebol = 1;
        $scope.proximoimgFutebol = 'img/badges/Categorias/Futebol/1.png';
      document.getElementById("Futebol").src="img/badges/Categorias/Futebol/0.png"
    }
  });

  $scope.aux.tag = "#GrupodeEstudos";
  $scope.auxnbadgeGrupodeEstudos = 0;
  $scope.proximoGrupodeEstudos = 0;
  $scope.proximoimgGrupodeEstudos = '';
  $scope.anteriorimgGrupodeEstudos = '';
  EventoService.getbadges($scope.aux).then(function(badges){
    console.log("badges", badges);
    if(badges!="Error" && badges !="E"){
      $scope.auxnbadgeGrupodeEstudos = badges.length;
      if(badges.length == 0){
        $scope.anteriorimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/0.png';
        $scope.proximoGrupodeEstudos = 1;
        $scope.proximoimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/1.png';
        document.getElementById("GrupodeEstudos").src="img/badges/Categorias/GrupodeEstudos/0.png"
      }
      if(badges.length == 1){
        $scope.anteriorimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/0.png';
        $scope.proximoGrupodeEstudos = 2;
        $scope.proximoimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/1.1.png';
        document.getElementById("GrupodeEstudos").src="img/badges/Categorias/GrupodeEstudos/1.png"
      }
      if(badges.length == 2){
        $scope.anteriorimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/1.png';
        $scope.proximoGrupodeEstudos = 3;
        $scope.proximoimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/1.2.png';
        document.getElementById("GrupodeEstudos").src="img/badges/Categorias/GrupodeEstudos/1.1.png"
      }
      if(badges.length == 3){
        $scope.anteriorimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/1.1.png';
        $scope.proximoGrupodeEstudos = 4;
        $scope.proximoimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/1.3.png';
        document.getElementById("GrupodeEstudos").src="img/badges/Categorias/GrupodeEstudos/1.2.png"
      }
      if(badges.length == 4 || badges.length == 5){
        $scope.anteriorimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/1.2.png';
        $scope.proximoGrupodeEstudos = 6;
        $scope.proximoimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/2.png';
        document.getElementById("GrupodeEstudos").src="img/badges/Categorias/GrupodeEstudos/1.3.png"
      }

      if(badges.length == 6 || badges.length == 7){
        $scope.anteriorimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/1.3.png';
        $scope.proximoGrupodeEstudos = 8;
        $scope.proximoimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/2.1.png';
        document.getElementById("GrupodeEstudos").src="img/badges/Categorias/GrupodeEstudos/2.png"
      }
      if(badges.length == 8 || badges.length == 9){
        $scope.anteriorimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/2.png';
        $scope.proximoGrupodeEstudos = 10;
        $scope.proximoimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/2.2.png';
        document.getElementById("GrupodeEstudos").src="img/badges/Categorias/GrupodeEstudos/2.1.png"
      }
      if(badges.length == 10 || badges.length == 11){
        $scope.anteriorimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/2.1.png';
        $scope.proximoGrupodeEstudos = 12;
        $scope.proximoimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/2.3.png';
        document.getElementById("GrupodeEstudos").src="img/badges/Categorias/GrupodeEstudos/2.2.png"
      }
      if(badges.length == 12 || badges.length == 13 || badges.length == 14){
        $scope.anteriorimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/2.2.png';
        $scope.proximoGrupodeEstudos = 15;
        $scope.proximoimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/3.png';
        document.getElementById("GrupodeEstudos").src="img/badges/Categorias/GrupodeEstudos/2.3.png"
      }

      if(badges.length >= 15 && badges.length < 20 ){
        $scope.anteriorimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/2.3.png';
        $scope.proximoGrupodeEstudos = 20;
        $scope.proximoimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/3.1.png';
        document.getElementById("GrupodeEstudos").src="img/badges/Categorias/GrupodeEstudos/3.png"
      }
      if(badges.length >= 20 && badges.length < 22 ){
        $scope.anteriorimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/3.png';
        $scope.proximoGrupodeEstudos = 25;
        $scope.proximoimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/3.2.png';
        document.getElementById("GrupodeEstudos").src="img/badges/Categorias/GrupodeEstudos/3.1.png"
      }
      if(badges.length >= 25 && badges.length < 30 ){
        $scope.anteriorimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/3.1.png';
        $scope.proximoGrupodeEstudos = 30;
        $scope.proximoimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/3.3.png';
        document.getElementById("GrupodeEstudos").src="img/badges/Categorias/GrupodeEstudos/3.2.png"
      }
      if(badges.length >= 30 && badges.length < 50 ){
        $scope.anteriorimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/3.2.png';
        $scope.proximoGrupodeEstudos = 50;
        $scope.proximoimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/Super.png';
        document.getElementById("GrupodeEstudos").src="img/badges/Categorias/GrupodeEstudos/3.3.png"
      }

      if(badges.length >= 50){
        $scope.anteriorimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/3.3.png';
        $scope.proximoGrupodeEstudos = 10000;
        $scope.proximoimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/Super.png';
        document.getElementById("GrupodeEstudos").src="img/badges/Categorias/GrupodeEstudos/Super.png"
      }

    }else{
      $scope.auxnbadgeGrupodeEstudos = 0;
        $scope.anteriorimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/0.png';
        $scope.proximoGrupodeEstudos = 1;
        $scope.proximoimgGrupodeEstudos = 'img/badges/Categorias/GrupodeEstudos/1.png';
      document.getElementById("GrupodeEstudos").src="img/badges/Categorias/GrupodeEstudos/0.png"
    }
  });

  $scope.aux.tag = "#Jogos";
  $scope.auxnbadgeJogos = 0;
  $scope.proximoJogos = 0;
  $scope.proximoimgJogos = '';
  $scope.anteriorimgJogos = '';
  EventoService.getbadges($scope.aux).then(function(badges){
    //console.log("badges", badges);
    if(badges!="Error" && badges !="E"){
      $scope.auxnbadgeJogos = badges.length;
      if(badges.length == 0){
        $scope.anteriorimgJogos = 'img/badges/Categorias/Jogos/0.png';
        $scope.proximoJogos = 1;
        $scope.proximoimgJogos = 'img/badges/Categorias/Jogos/1.png';
        document.getElementById("Jogos").src="img/badges/Categorias/Jogos/0.png"
      }
      if(badges.length == 1){
        $scope.anteriorimgJogos = 'img/badges/Categorias/Jogos/0.png';
        $scope.proximoJogos = 2;
        $scope.proximoimgJogos = 'img/badges/Categorias/Jogos/1.1.png';
        document.getElementById("Jogos").src="img/badges/Categorias/Jogos/1.png"
      }
      if(badges.length == 2){
        $scope.anteriorimgJogos = 'img/badges/Categorias/Jogos/1.png';
        $scope.proximoJogos = 3;
        $scope.proximoimgJogos = 'img/badges/Categorias/Jogos/1.2.png';
        document.getElementById("Jogos").src="img/badges/Categorias/Jogos/1.1.png"
      }
      if(badges.length == 3){
        $scope.anteriorimgJogos = 'img/badges/Categorias/Jogos/1.1.png';
        $scope.proximoJogos = 4;
        $scope.proximoimgJogos = 'img/badges/Categorias/Jogos/1.3.png';
        document.getElementById("Jogos").src="img/badges/Categorias/Jogos/1.2.png"
      }
      if(badges.length == 4 || badges.length == 5){
        $scope.anteriorimgJogos = 'img/badges/Categorias/Jogos/1.2.png';
        $scope.proximoJogos = 6;
        $scope.proximoimgJogos = 'img/badges/Categorias/Jogos/2.png';
        document.getElementById("Jogos").src="img/badges/Categorias/Jogos/1.3.png"
      }

      if(badges.length == 6 || badges.length == 7){
        $scope.anteriorimgJogos = 'img/badges/Categorias/Jogos/1.3.png';
        $scope.proximoJogos = 8;
        $scope.proximoimgJogos = 'img/badges/Categorias/Jogos/2.1.png';
        document.getElementById("Jogos").src="img/badges/Categorias/Jogos/2.png"
      }
      if(badges.length == 8 || badges.length == 9){
        $scope.anteriorimgJogos = 'img/badges/Categorias/Jogos/2.png';
        $scope.proximoJogos = 10;
        $scope.proximoimgJogos = 'img/badges/Categorias/Jogos/2.2.png';
        document.getElementById("Jogos").src="img/badges/Categorias/Jogos/2.1.png"
      }
      if(badges.length == 10 || badges.length == 11){
        $scope.anteriorimgJogos = 'img/badges/Categorias/Jogos/2.1.png';
        $scope.proximoJogos = 12;
        $scope.proximoimgJogos = 'img/badges/Categorias/Jogos/2.3.png';
        document.getElementById("Jogos").src="img/badges/Categorias/Jogos/2.2.png"
      }
      if(badges.length == 12 || badges.length == 13 || badges.length == 14){
        $scope.anteriorimgJogos = 'img/badges/Categorias/Jogos/2.2.png';
        $scope.proximoJogos = 15;
        $scope.proximoimgJogos = 'img/badges/Categorias/Jogos/3.png';
        document.getElementById("Jogos").src="img/badges/Categorias/Jogos/2.3.png"
      }

      if(badges.length >= 15 && badges.length < 20 ){
        $scope.anteriorimgJogos = 'img/badges/Categorias/Jogos/2.3.png';
        $scope.proximoJogos = 20;
        $scope.proximoimgJogos = 'img/badges/Categorias/Jogos/3.1.png';
        document.getElementById("Jogos").src="img/badges/Categorias/Jogos/3.png"
      }
      if(badges.length >= 20 && badges.length < 22 ){
        $scope.anteriorimgJogos = 'img/badges/Categorias/Jogos/3.png';
        $scope.proximoJogos = 25;
        $scope.proximoimgJogos = 'img/badges/Categorias/Jogos/3.2.png';
        document.getElementById("Jogos").src="img/badges/Categorias/Jogos/3.1.png"
      }
      if(badges.length >= 25 && badges.length < 30 ){
        $scope.anteriorimgJogos = 'img/badges/Categorias/Jogos/3.1.png';
        $scope.proximoJogos = 30;
        $scope.proximoimgJogos = 'img/badges/Categorias/Jogos/3.3.png';
        document.getElementById("Jogos").src="img/badges/Categorias/Jogos/3.2.png"
      }
      if(badges.length >= 30 && badges.length < 50 ){
        $scope.anteriorimgJogos = 'img/badges/Categorias/Jogos/3.2.png';
        $scope.proximoJogos = 50;
        $scope.proximoimgJogos = 'img/badges/Categorias/Jogos/Super.png';
        document.getElementById("Jogos").src="img/badges/Categorias/Jogos/3.3.png"
      }

      if(badges.length >= 50){
        $scope.anteriorimgJogos = 'img/badges/Categorias/Jogos/3.3.png';
        $scope.proximoJogos = 10000;
        $scope.proximoimgJogos = 'img/badges/Categorias/Jogos/Super.png';
        document.getElementById("Jogos").src="img/badges/Categorias/Jogos/Super.png"
      }

    }else{
      $scope.auxnbadgeJogos = 0;
        $scope.anteriorimgJogos = 'img/badges/Categorias/Jogos/0.png';
        $scope.proximoJogos = 1;
        $scope.proximoimgJogos = 'img/badges/Categorias/Jogos/1.png';
      document.getElementById("Jogos").src="img/badges/Categorias/Jogos/0.png"
    }
  });

  $scope.aux.tag = "#Musica";
  $scope.auxnbadgeMusica = 0;
  $scope.proximoMusica = 0;
  $scope.proximoimgMusica = '';
  $scope.anteriorimgMusica = '';
  EventoService.getbadges($scope.aux).then(function(badges){
    //console.log("badges", badges);
    if(badges!="Error" && badges !="E"){
      $scope.auxnbadgeMusica = badges.length;
      if(badges.length == 0){
        $scope.anteriorimgMusica = 'img/badges/Categorias/Musica/0.png';
        $scope.proximoMusica = 1;
        $scope.proximoimgMusica = 'img/badges/Categorias/Musica/1.png';
        document.getElementById("Musica").src="img/badges/Categorias/Musica/0.png"
      }
      if(badges.length == 1){
        $scope.anteriorimgMusica = 'img/badges/Categorias/Musica/0.png';
        $scope.proximoMusica = 2;
        $scope.proximoimgMusica = 'img/badges/Categorias/Musica/1.1.png';
        document.getElementById("Musica").src="img/badges/Categorias/Musica/1.png"
      }
      if(badges.length == 2){
        $scope.anteriorimgMusica = 'img/badges/Categorias/Musica/1.png';
        $scope.proximoMusica = 3;
        $scope.proximoimgMusica = 'img/badges/Categorias/Musica/1.2.png';
        document.getElementById("Musica").src="img/badges/Categorias/Musica/1.1.png"
      }
      if(badges.length == 3){
        $scope.anteriorimgMusica = 'img/badges/Categorias/Musica/1.1.png';
        $scope.proximoMusica = 4;
        $scope.proximoimgMusica = 'img/badges/Categorias/Musica/1.3.png';
        document.getElementById("Musica").src="img/badges/Categorias/Musica/1.2.png"
      }
      if(badges.length == 4 || badges.length == 5){
        $scope.anteriorimgMusica = 'img/badges/Categorias/Musica/1.2.png';
        $scope.proximoMusica = 6;
        $scope.proximoimgMusica = 'img/badges/Categorias/Musica/2.png';
        document.getElementById("Musica").src="img/badges/Categorias/Musica/1.3.png"
      }

      if(badges.length == 6 || badges.length == 7){
        $scope.anteriorimgMusica = 'img/badges/Categorias/Musica/1.3.png';
        $scope.proximoMusica = 8;
        $scope.proximoimgMusica = 'img/badges/Categorias/Musica/2.1.png';
        document.getElementById("Musica").src="img/badges/Categorias/Musica/2.png"
      }
      if(badges.length == 8 || badges.length == 9){
        $scope.anteriorimgMusica = 'img/badges/Categorias/Musica/2.png';
        $scope.proximoMusica = 10;
        $scope.proximoimgMusica = 'img/badges/Categorias/Musica/2.2.png';
        document.getElementById("Musica").src="img/badges/Categorias/Musica/2.1.png"
      }
      if(badges.length == 10 || badges.length == 11){
        $scope.anteriorimgMusica = 'img/badges/Categorias/Musica/2.1.png';
        $scope.proximoMusica = 12;
        $scope.proximoimgMusica = 'img/badges/Categorias/Musica/2.3.png';
        document.getElementById("Musica").src="img/badges/Categorias/Musica/2.2.png"
      }
      if(badges.length == 12 || badges.length == 13 || badges.length == 14){
        $scope.anteriorimgMusica = 'img/badges/Categorias/Musica/2.2.png';
        $scope.proximoMusica = 15;
        $scope.proximoimgMusica = 'img/badges/Categorias/Musica/3.png';
        document.getElementById("Musica").src="img/badges/Categorias/Musica/2.3.png"
      }

      if(badges.length >= 15 && badges.length < 20 ){
        $scope.anteriorimgMusica = 'img/badges/Categorias/Musica/2.3.png';
        $scope.proximoMusica = 20;
        $scope.proximoimgMusica = 'img/badges/Categorias/Musica/3.1.png';
        document.getElementById("Musica").src="img/badges/Categorias/Musica/3.png"
      }
      if(badges.length >= 20 && badges.length < 22 ){
        $scope.anteriorimgMusica = 'img/badges/Categorias/Musica/3.png';
        $scope.proximoMusica = 25;
        $scope.proximoimgMusica = 'img/badges/Categorias/Musica/3.2.png';
        document.getElementById("Musica").src="img/badges/Categorias/Musica/3.1.png"
      }
      if(badges.length >= 25 && badges.length < 30 ){
        $scope.anteriorimgMusica = 'img/badges/Categorias/Musica/3.1.png';
        $scope.proximoMusica = 30;
        $scope.proximoimgMusica = 'img/badges/Categorias/Musica/3.3.png';
        document.getElementById("Musica").src="img/badges/Categorias/Musica/3.2.png"
      }
      if(badges.length >= 30 && badges.length < 50 ){
        $scope.anteriorimgMusica = 'img/badges/Categorias/Musica/3.2.png';
        $scope.proximoMusica = 50;
        $scope.proximoimgMusica = 'img/badges/Categorias/Musica/Super.png';
        document.getElementById("Musica").src="img/badges/Categorias/Musica/3.3.png"
      }

      if(badges.length >= 50){
        $scope.anteriorimgMusica = 'img/badges/Categorias/Musica/3.3.png';
        $scope.proximoMusica = 10000;
        $scope.proximoimgMusica = 'img/badges/Categorias/Musica/Super.png';
        document.getElementById("Musica").src="img/badges/Categorias/Musica/Super.png"
      }

    }else{
      $scope.auxnbadgeMusica = 0;
        $scope.anteriorimgMusica = 'img/badges/Categorias/Musica/0.png';
        $scope.proximoMusica = 1;
        $scope.proximoimgMusica = 'img/badges/Categorias/Musica/1.png';
      document.getElementById("Musica").src="img/badges/Categorias/Musica/0.png"
    }
  });

  $scope.aux.tag = "#Natureza";
  $scope.auxnbadgeNatureza = 0;
  $scope.proximoNatureza = 0;
  $scope.proximoimgNatureza = '';
  $scope.anteriorimgNatureza = '';
  EventoService.getbadges($scope.aux).then(function(badges){
    //console.log("badges", badges);
    if(badges!="Error" && badges !="E"){
      $scope.auxnbadgeNatureza = badges.length;
      if(badges.length == 0){
        $scope.anteriorimgNatureza = 'img/badges/Categorias/Natureza/0.png';
        $scope.proximoNatureza = 1;
        $scope.proximoimgNatureza = 'img/badges/Categorias/Natureza/1.png';
        document.getElementById("Natureza").src="img/badges/Categorias/Natureza/0.png"
      }
      if(badges.length == 1){
        $scope.anteriorimgNatureza = 'img/badges/Categorias/Natureza/0.png';
        $scope.proximoNatureza = 2;
        $scope.proximoimgNatureza = 'img/badges/Categorias/Natureza/1.1.png';
        document.getElementById("Natureza").src="img/badges/Categorias/Natureza/1.png"
      }
      if(badges.length == 2){
        $scope.anteriorimgNatureza = 'img/badges/Categorias/Natureza/1.png';
        $scope.proximoNatureza = 3;
        $scope.proximoimgNatureza = 'img/badges/Categorias/Natureza/1.2.png';
        document.getElementById("Natureza").src="img/badges/Categorias/Natureza/1.1.png"
      }
      if(badges.length == 3){
        $scope.anteriorimgNatureza = 'img/badges/Categorias/Natureza/1.1.png';
        $scope.proximoNatureza = 4;
        $scope.proximoimgNatureza = 'img/badges/Categorias/Natureza/1.3.png';
        document.getElementById("Natureza").src="img/badges/Categorias/Natureza/1.2.png"
      }
      if(badges.length == 4 || badges.length == 5){
        $scope.anteriorimgNatureza = 'img/badges/Categorias/Natureza/1.2.png';
        $scope.proximoNatureza = 6;
        $scope.proximoimgNatureza = 'img/badges/Categorias/Natureza/2.png';
        document.getElementById("Natureza").src="img/badges/Categorias/Natureza/1.3.png"
      }

      if(badges.length == 6 || badges.length == 7){
        $scope.anteriorimgNatureza = 'img/badges/Categorias/Natureza/1.3.png';
        $scope.proximoNatureza = 8;
        $scope.proximoimgNatureza = 'img/badges/Categorias/Natureza/2.1.png';
        document.getElementById("Natureza").src="img/badges/Categorias/Natureza/2.png"
      }
      if(badges.length == 8 || badges.length == 9){
        $scope.anteriorimgNatureza = 'img/badges/Categorias/Natureza/2.png';
        $scope.proximoNatureza = 10;
        $scope.proximoimgNatureza = 'img/badges/Categorias/Natureza/2.2.png';
        document.getElementById("Natureza").src="img/badges/Categorias/Natureza/2.1.png"
      }
      if(badges.length == 10 || badges.length == 11){
        $scope.anteriorimgNatureza = 'img/badges/Categorias/Natureza/2.1.png';
        $scope.proximoNatureza = 12;
        $scope.proximoimgNatureza = 'img/badges/Categorias/Natureza/2.3.png';
        document.getElementById("Natureza").src="img/badges/Categorias/Natureza/2.2.png"
      }
      if(badges.length == 12 || badges.length == 13 || badges.length == 14){
        $scope.anteriorimgNatureza = 'img/badges/Categorias/Natureza/2.2.png';
        $scope.proximoNatureza = 15;
        $scope.proximoimgNatureza = 'img/badges/Categorias/Natureza/3.png';
        document.getElementById("Natureza").src="img/badges/Categorias/Natureza/2.3.png"
      }

      if(badges.length >= 15 && badges.length < 20 ){
        $scope.anteriorimgNatureza = 'img/badges/Categorias/Natureza/2.3.png';
        $scope.proximoNatureza = 20;
        $scope.proximoimgNatureza = 'img/badges/Categorias/Natureza/3.1.png';
        document.getElementById("Natureza").src="img/badges/Categorias/Natureza/3.png"
      }
      if(badges.length >= 20 && badges.length < 22 ){
        $scope.anteriorimgNatureza = 'img/badges/Categorias/Natureza/3.png';
        $scope.proximoNatureza = 25;
        $scope.proximoimgNatureza = 'img/badges/Categorias/Natureza/3.2.png';
        document.getElementById("Natureza").src="img/badges/Categorias/Natureza/3.1.png"
      }
      if(badges.length >= 25 && badges.length < 30 ){
        $scope.anteriorimgNatureza = 'img/badges/Categorias/Natureza/3.1.png';
        $scope.proximoNatureza = 30;
        $scope.proximoimgNatureza = 'img/badges/Categorias/Natureza/3.3.png';
        document.getElementById("Natureza").src="img/badges/Categorias/Natureza/3.2.png"
      }
      if(badges.length >= 30 && badges.length < 50 ){
        $scope.anteriorimgNatureza = 'img/badges/Categorias/Natureza/3.2.png';
        $scope.proximoNatureza = 50;
        $scope.proximoimgNatureza = 'img/badges/Categorias/Natureza/Super.png';
        document.getElementById("Natureza").src="img/badges/Categorias/Natureza/3.3.png"
      }

      if(badges.length >= 50){
        $scope.anteriorimgNatureza = 'img/badges/Categorias/Natureza/3.3.png';
        $scope.proximoNatureza = 10000;
        $scope.proximoimgNatureza = 'img/badges/Categorias/Natureza/Super.png';
        document.getElementById("Natureza").src="img/badges/Categorias/Natureza/Super.png"
      }

    }else{
      $scope.auxnbadgeNatureza = 0;
        $scope.anteriorimgNatureza = 'img/badges/Categorias/Natureza/0.png';
        $scope.proximoNatureza = 1;
        $scope.proximoimgNatureza = 'img/badges/Categorias/Natureza/1.png';
      document.getElementById("Natureza").src="img/badges/Categorias/Natureza/0.png"
    }
  });

  $scope.aux.tag = "#Passeio";
  $scope.auxnbadgePasseio = 0;
  $scope.proximoPasseio = 0;
  $scope.proximoimgPasseio = '';
  $scope.anteriorimgPasseio = '';
  EventoService.getbadges($scope.aux).then(function(badges){
    //console.log("badges", badges);
    if(badges!="Error" && badges !="E"){
      $scope.auxnbadgePasseio = badges.length;
      if(badges.length == 0){
        $scope.anteriorimgPasseio = 'img/badges/Categorias/Passeio/0.png';
        $scope.proximoPasseio = 1;
        $scope.proximoimgPasseio = 'img/badges/Categorias/Passeio/1.png';
        document.getElementById("Passeio").src="img/badges/Categorias/Passeio/0.png"
      }
      if(badges.length == 1){
        $scope.anteriorimgPasseio = 'img/badges/Categorias/Passeio/0.png';
        $scope.proximoPasseio = 2;
        $scope.proximoimgPasseio = 'img/badges/Categorias/Passeio/1.1.png';
        document.getElementById("Passeio").src="img/badges/Categorias/Passeio/1.png"
      }
      if(badges.length == 2){
        $scope.anteriorimgPasseio = 'img/badges/Categorias/Passeio/1.png';
        $scope.proximoPasseio = 3;
        $scope.proximoimgPasseio = 'img/badges/Categorias/Passeio/1.2.png';
        document.getElementById("Passeio").src="img/badges/Categorias/Passeio/1.1.png"
      }
      if(badges.length == 3){
        $scope.anteriorimgPasseio = 'img/badges/Categorias/Passeio/1.1.png';
        $scope.proximoPasseio = 4;
        $scope.proximoimgPasseio = 'img/badges/Categorias/Passeio/1.3.png';
        document.getElementById("Passeio").src="img/badges/Categorias/Passeio/1.2.png"
      }
      if(badges.length == 4 || badges.length == 5){
        $scope.anteriorimgPasseio = 'img/badges/Categorias/Passeio/1.2.png';
        $scope.proximoPasseio = 6;
        $scope.proximoimgPasseio = 'img/badges/Categorias/Passeio/2.png';
        document.getElementById("Passeio").src="img/badges/Categorias/Passeio/1.3.png"
      }

      if(badges.length == 6 || badges.length == 7){
        $scope.anteriorimgPasseio = 'img/badges/Categorias/Passeio/1.3.png';
        $scope.proximoPasseio = 8 ;
        $scope.proximoimgPasseio = 'img/badges/Categorias/Passeio/2.1.png';
        document.getElementById("Passeio").src="img/badges/Categorias/Passeio/2.png"
      }
      if(badges.length == 8 || badges.length == 9){
        $scope.anteriorimgPasseio = 'img/badges/Categorias/Passeio/2.png';
        $scope.proximoPasseio = 10;
        $scope.proximoimgPasseio = 'img/badges/Categorias/Passeio/2.2.png';
        document.getElementById("Passeio").src="img/badges/Categorias/Passeio/2.1.png"
      }
      if(badges.length == 10 || badges.length == 11){
        $scope.anteriorimgPasseio = 'img/badges/Categorias/Passeio/2.1.png';
        $scope.proximoPasseio = 12;
        $scope.proximoimgPasseio = 'img/badges/Categorias/Passeio/2.3.png';
        document.getElementById("Passeio").src="img/badges/Categorias/Passeio/2.2.png"
      }
      if(badges.length == 12 || badges.length == 13 || badges.length == 14){
        $scope.anteriorimgPasseio = 'img/badges/Categorias/Passeio/2.2.png';
        $scope.proximoPasseio = 15;
        $scope.proximoimgPasseio = 'img/badges/Categorias/Passeio/3.png';
        document.getElementById("Passeio").src="img/badges/Categorias/Passeio/2.3.png"
      }

      if(badges.length >= 15 && badges.length < 20 ){
        $scope.anteriorimgPasseio = 'img/badges/Categorias/Passeio/2.3.png';
        $scope.proximoPasseio = 20;
        $scope.proximoimgPasseio = 'img/badges/Categorias/Passeio/3.1.png';
        document.getElementById("Passeio").src="img/badges/Categorias/Passeio/3.png"
      }
      if(badges.length >= 20 && badges.length < 22 ){
        $scope.anteriorimgPasseio = 'img/badges/Categorias/Passeio/3.png';
        $scope.proximoPasseio = 25;
        $scope.proximoimgPasseio = 'img/badges/Categorias/Passeio/3.2.png';
        document.getElementById("Passeio").src="img/badges/Categorias/Passeio/3.1.png"
      }
      if(badges.length >= 25 && badges.length < 30 ){
        $scope.anteriorimgPasseio = 'img/badges/Categorias/Passeio/3.1.png';
        $scope.proximoPasseio = 30;
        $scope.proximoimgPasseio = 'img/badges/Categorias/Passeio/3.3.png';
        document.getElementById("Passeio").src="img/badges/Categorias/Passeio/3.2.png"
      }
      if(badges.length >= 30 && badges.length < 50 ){
        $scope.anteriorimgPasseio = 'img/badges/Categorias/Passeio/3.2.png';
        $scope.proximoPasseio = 50;
        $scope.proximoimgPasseio = 'img/badges/Categorias/Passeio/Super.png';
        document.getElementById("Passeio").src="img/badges/Categorias/Passeio/3.3.png"
      }

      if(badges.length >= 50){
        $scope.anteriorimgPasseio = 'img/badges/Categorias/Passeio/3.3.png';
        $scope.proximoPasseio = 10000;
        $scope.proximoimgPasseio = 'img/badges/Categorias/Passeio/Super.png';
        document.getElementById("Passeio").src="img/badges/Categorias/Passeio/Super.png"
      }

    }else{
      $scope.auxnbadgePasseio = 0;
        $scope.anteriorimgPasseio = 'img/badges/Categorias/Passeio/0.png';
        $scope.proximoPasseio = 1;
        $scope.proximoimgPasseio = 'img/badges/Categorias/Passeio/1.png';
      document.getElementById("Passeio").src="img/badges/Categorias/Passeio/0.png"
    }
  });

  $scope.aux.tag = "#Pets";
  $scope.auxnbadgePets = 0;
  $scope.proximoPets = 0;
  $scope.proximoimgPets = '';
  $scope.anteriorimgPets = '';
  EventoService.getbadges($scope.aux).then(function(badges){
    //console.log("badges", badges);
    if(badges!="Error" && badges !="E"){
      $scope.auxnbadgePets = badges.length;
      if(badges.length == 0){
        $scope.anteriorimgPets = 'img/badges/Categorias/Pets/0.png';
        $scope.proximoPets = 1;
        $scope.proximoimgPets = 'img/badges/Categorias/Pets/1.png';
        document.getElementById("Pets").src="img/badges/Categorias/Pets/0.png"
      }
      if(badges.length == 1){
        $scope.anteriorimgPets = 'img/badges/Categorias/Pets/0.png';
        $scope.proximoPets = 2;
        $scope.proximoimgPets = 'img/badges/Categorias/Pets/1.1.png';
        document.getElementById("Pets").src="img/badges/Categorias/Pets/1.png"
      }
      if(badges.length == 2){
        $scope.anteriorimgPets = 'img/badges/Categorias/Pets/1.png';
        $scope.proximoPets = 3;
        $scope.proximoimgPets = 'img/badges/Categorias/Pets/1.2.png';
        document.getElementById("Pets").src="img/badges/Categorias/Pets/1.1.png"
      }
      if(badges.length == 3){
        $scope.anteriorimgPets = 'img/badges/Categorias/Pets/1.1.png';
        $scope.proximoPets = 4;
        $scope.proximoimgPets = 'img/badges/Categorias/Pets/1.3.png';
        document.getElementById("Pets").src="img/badges/Categorias/Pets/1.2.png"
      }
      if(badges.length == 4 || badges.length == 5){
        $scope.anteriorimgPets = 'img/badges/Categorias/Pets/1.2.png';
        $scope.proximoPets = 6;
        $scope.proximoimgPets = 'img/badges/Categorias/Pets/2.png';
        document.getElementById("Pets").src="img/badges/Categorias/Pets/1.3.png"
      }

      if(badges.length == 6 || badges.length == 7){
        $scope.anteriorimgPets = 'img/badges/Categorias/Pets/1.3.png';
        $scope.proximoPets = 8;
        $scope.proximoimgPets = 'img/badges/Categorias/Pets/2.1.png';
        document.getElementById("Pets").src="img/badges/Categorias/Pets/2.png"
      }
      if(badges.length == 8 || badges.length == 9){
        $scope.anteriorimgPets = 'img/badges/Categorias/Pets/2.png';
        $scope.proximoPets = 10;
        $scope.proximoimgPets = 'img/badges/Categorias/Pets/2.2.png';
        document.getElementById("Pets").src="img/badges/Categorias/Pets/2.1.png"
      }
      if(badges.length == 10 || badges.length == 11){
        $scope.anteriorimgPets = 'img/badges/Categorias/Pets/2.1.png';
        $scope.proximoPets = 12;
        $scope.proximoimgPets = 'img/badges/Categorias/Pets/2.3.png';
        document.getElementById("Pets").src="img/badges/Categorias/Pets/2.2.png"
      }
      if(badges.length == 12 || badges.length == 13 || badges.length == 14){
        $scope.anteriorimgPets = 'img/badges/Categorias/Pets/2.2.png';
        $scope.proximoPets = 15;
        $scope.proximoimgPets = 'img/badges/Categorias/Pets/3.png';
        document.getElementById("Pets").src="img/badges/Categorias/Pets/2.3.png"
      }

      if(badges.length >= 15 && badges.length < 20 ){
        $scope.anteriorimgPets = 'img/badges/Categorias/Pets/2.3.png';
        $scope.proximoPets = 20;
        $scope.proximoimgPets = 'img/badges/Categorias/Pets/3.1.png';
        document.getElementById("Pets").src="img/badges/Categorias/Pets/3.png"
      }
      if(badges.length >= 20 && badges.length < 22 ){
        $scope.anteriorimgPets = 'img/badges/Categorias/Pets/3.png';
        $scope.proximoPets = 25;
        $scope.proximoimgPets = 'img/badges/Categorias/Pets/3.2.png';
        document.getElementById("Pets").src="img/badges/Categorias/Pets/3.1.png"
      }
      if(badges.length >= 25 && badges.length < 30 ){
        $scope.anteriorimgPets = 'img/badges/Categorias/Pets/3.1.png';
        $scope.proximoPets = 30;
        $scope.proximoimgPets = 'img/badges/Categorias/Pets/3.3.png';
        document.getElementById("Pets").src="img/badges/Categorias/Pets/3.2.png"
      }
      if(badges.length >= 30 && badges.length < 50 ){
        $scope.anteriorimgPets = 'img/badges/Categorias/Pets/3.2.png';
        $scope.proximoPets = 50;
        $scope.proximoimgPets = 'img/badges/Categorias/Pets/Super.png';
        document.getElementById("Pets").src="img/badges/Categorias/Pets/3.3.png"
      }

      if(badges.length >= 50){
        $scope.anteriorimgPets = 'img/badges/Categorias/Pets/3.3.png';
        $scope.proximoPets = 10000;
        $scope.proximoimgPets = 'img/badges/Categorias/Pets/Super.png';
        document.getElementById("Pets").src="img/badges/Categorias/Pets/Super.png"
      }

    }else{
      $scope.auxnbadgePets = 0;
        $scope.anteriorimgPets = 'img/badges/Categorias/Pets/0.png';
        $scope.proximoPets = 1;
        $scope.proximoimgPets = 'img/badges/Categorias/Pets/1.png';
      document.getElementById("Pets").src="img/badges/Categorias/Pets/0.png"
    }
  });

  $scope.aux.tag = "#Restaurantesebares";
  $scope.auxnbadgeRestaurantesebares = 0;
  $scope.proximoRestaurantesebares = 0;
  $scope.proximoimgRestaurantesebares = '';
  $scope.anteriorimgRestaurantesebares = '';
  EventoService.getbadges($scope.aux).then(function(badges){
    //console.log("badges", badges);
    if(badges!="Error" && badges !="E"){
      $scope.auxnbadgeRestaurantesebares = badges.length ;
      if(badges.length == 0){
        $scope.anteriorimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/0.png';
        $scope.proximoRestaurantesebares = 1;
        $scope.proximoimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/1.png';
        document.getElementById("Restaurantesebares").src="img/badges/Categorias/Restaurantesebares/0.png"
      }
      if(badges.length == 1){
        $scope.anteriorimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/0.png';
        $scope.proximoRestaurantesebares = 2;
        $scope.proximoimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/1.1.png';
        document.getElementById("Restaurantesebares").src="img/badges/Categorias/Restaurantesebares/1.png"
      }
      if(badges.length == 2){
        $scope.anteriorimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/1.png';
        $scope.proximoRestaurantesebares = 3;
        $scope.proximoimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/1.2.png';
        document.getElementById("Restaurantesebares").src="img/badges/Categorias/Restaurantesebares/1.1.png"
      }
      if(badges.length == 3){
        $scope.anteriorimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/1.1.png';
        $scope.proximoRestaurantesebares = 4;
        $scope.proximoimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/1.3.png';
        document.getElementById("Restaurantesebares").src="img/badges/Categorias/Restaurantesebares/1.2.png"
      }
      if(badges.length == 4 || badges.length == 5){
        $scope.anteriorimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/1.2.png';
        $scope.proximoRestaurantesebares = 6;
        $scope.proximoimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/2.png';
        document.getElementById("Restaurantesebares").src="img/badges/Categorias/Restaurantesebares/1.3.png"
      }

      if(badges.length == 6 || badges.length == 7){
        $scope.anteriorimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/1.3.png';
        $scope.proximoRestaurantesebares = 8;
        $scope.proximoimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/2.1.png';
        document.getElementById("Restaurantesebares").src="img/badges/Categorias/Restaurantesebares/2.png"
      }
      if(badges.length == 8 || badges.length == 9){
        $scope.anteriorimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/2.png';
        $scope.proximoRestaurantesebares = 10;
        $scope.proximoimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/2.2.png';
        document.getElementById("Restaurantesebares").src="img/badges/Categorias/Restaurantesebares/2.1.png"
      }
      if(badges.length == 10 || badges.length == 11){
        $scope.anteriorimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/2.1.png';
        $scope.proximoRestaurantesebares = 12;
        $scope.proximoimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/2.3.png';
        document.getElementById("Restaurantesebares").src="img/badges/Categorias/Restaurantesebares/2.2.png"
      }
      if(badges.length == 12 || badges.length == 13 || badges.length == 14){
        $scope.anteriorimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/2.2.png';
        $scope.proximoRestaurantesebares = 15;
        $scope.proximoimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/3.png';
        document.getElementById("Restaurantesebares").src="img/badges/Categorias/Restaurantesebares/2.3.png"
      }

      if(badges.length >= 15 && badges.length < 20 ){
        $scope.anteriorimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/2.3.png';
        $scope.proximoRestaurantesebares = 20;
        $scope.proximoimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/3.1.png';
        document.getElementById("Restaurantesebares").src="img/badges/Categorias/Restaurantesebares/3.png"
      }
      if(badges.length >= 20 && badges.length < 22 ){
        $scope.anteriorimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/3.png';
        $scope.proximoRestaurantesebares = 25;
        $scope.proximoimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/3.2.png';
        document.getElementById("Restaurantesebares").src="img/badges/Categorias/Restaurantesebares/3.1.png"
      }
      if(badges.length >= 25 && badges.length < 30 ){
        $scope.anteriorimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/3.1.png';
        $scope.proximoRestaurantesebares = 30;
        $scope.proximoimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/3.3.png';
        document.getElementById("Restaurantesebares").src="img/badges/Categorias/Restaurantesebares/3.2.png"
      }
      if(badges.length >= 30 && badges.length < 50 ){
        $scope.anteriorimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/3.2.png';
        $scope.proximoRestaurantesebares = 50;
        $scope.proximoimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/Super.png';
        document.getElementById("Restaurantesebares").src="img/badges/Categorias/Restaurantesebares/3.3.png"
      }

      if(badges.length >= 50){
        $scope.anteriorimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/3.3.png';
        $scope.proximoRestaurantesebares = 10000;
        $scope.proximoimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/Super.png';
        document.getElementById("Restaurantesebares").src="img/badges/Categorias/Restaurantesebares/Super.png"
      }

    }else{
      $scope.auxnbadgeRestaurantesebares = 0;
        $scope.anteriorimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/0.png';
        $scope.proximoRestaurantesebares = 1;
        $scope.proximoimgRestaurantesebares = 'img/badges/Categorias/Restaurantesebares/1.png';
      document.getElementById("Restaurantesebares").src="img/badges/Categorias/Restaurantesebares/0.png"
    }
  });

  $scope.aux.tag = "#Surf";
  $scope.auxnbadgeSurf = 0;
  $scope.proximoSurf = 0;
  $scope.proximoimgSurf = '';
  $scope.anteriorimgSurf = '';
  EventoService.getbadges($scope.aux).then(function(badges){
    //console.log("badges", badges);
    if(badges!="Error" && badges !="E"){
      $scope.auxnbadgeSurf = badges.length;
      if(badges.length == 0){
        $scope.anteriorimgSurf = 'img/badges/Categorias/Surf/0.png';
        $scope.proximoSurf = 1;
        $scope.proximoimgSurf = 'img/badges/Categorias/Surf/1.png';
        document.getElementById("Surf").src="img/badges/Categorias/Surf/0.png"
      }
      if(badges.length == 1){
        $scope.anteriorimgSurf = 'img/badges/Categorias/Surf/0.png';
        $scope.proximoSurf = 2;
        $scope.proximoimgSurf = 'img/badges/Categorias/Surf/1.1.png';
        document.getElementById("Surf").src="img/badges/Categorias/Surf/1.png"
      }
      if(badges.length == 2){
        $scope.anteriorimgSurf = 'img/badges/Categorias/Surf/1.png';
        $scope.proximoSurf = 3;
        $scope.proximoimgSurf = 'img/badges/Categorias/Surf/1.2.png';
        document.getElementById("Surf").src="img/badges/Categorias/Surf/1.1.png"
      }
      if(badges.length == 3){
        $scope.anteriorimgSurf = 'img/badges/Categorias/Surf/1.1.png';
        $scope.proximoSurf = 4;
        $scope.proximoimgSurf = 'img/badges/Categorias/Surf/1.3.png';
        document.getElementById("Surf").src="img/badges/Categorias/Surf/1.2.png"
      }
      if(badges.length == 4 || badges.length == 5){
        $scope.anteriorimgSurf = 'img/badges/Categorias/Surf/1.2.png';
        $scope.proximoSurf = 6;
        $scope.proximoimgSurf = 'img/badges/Categorias/Surf/2.png';
        document.getElementById("Surf").src="img/badges/Categorias/Surf/1.3.png"
      }

      if(badges.length == 6 || badges.length == 7){
        $scope.anteriorimgSurf = 'img/badges/Categorias/Surf/1.3.png';
        $scope.proximoSurf = 8;
        $scope.proximoimgSurf = 'img/badges/Categorias/Surf/2.1.png';
        document.getElementById("Surf").src="img/badges/Categorias/Surf/2.png"
      }
      if(badges.length == 8 || badges.length == 9){
        $scope.anteriorimgSurf = 'img/badges/Categorias/Surf/2.png';
        $scope.proximoSurf = 10;
        $scope.proximoimgSurf = 'img/badges/Categorias/Surf/2.2.png';
        document.getElementById("Surf").src="img/badges/Categorias/Surf/2.1.png"
      }
      if(badges.length == 10 || badges.length == 11){
        $scope.anteriorimgSurf = 'img/badges/Categorias/Surf/2.1.png';
        $scope.proximoSurf = 12;
        $scope.proximoimgSurf = 'img/badges/Categorias/Surf/2.3.png';
        document.getElementById("Surf").src="img/badges/Categorias/Surf/2.2.png"
      }
      if(badges.length == 12 || badges.length == 13 || badges.length == 14){
        $scope.anteriorimgSurf = 'img/badges/Categorias/Surf/2.2.png';
        $scope.proximoSurf = 15;
        $scope.proximoimgSurf = 'img/badges/Categorias/Surf/3.png';
        document.getElementById("Surf").src="img/badges/Categorias/Surf/2.3.png"
      }

      if(badges.length >= 15 && badges.length < 20 ){
        $scope.anteriorimgSurf = 'img/badges/Categorias/Surf/2.3.png';
        $scope.proximoSurf = 20;
        $scope.proximoimgSurf = 'img/badges/Categorias/Surf/3.1.png';
        document.getElementById("Surf").src="img/badges/Categorias/Surf/3.png"
      }
      if(badges.length >= 20 && badges.length < 22 ){
        $scope.anteriorimgSurf = 'img/badges/Categorias/Surf/3.png';
        $scope.proximoSurf = 25;
        $scope.proximoimgSurf = 'img/badges/Categorias/Surf/3.2.png';
        document.getElementById("Surf").src="img/badges/Categorias/Surf/3.1.png"
      }
      if(badges.length >= 25 && badges.length < 30 ){
        $scope.anteriorimgSurf = 'img/badges/Categorias/Surf/3.1.png';
        $scope.proximoSurf = 30;
        $scope.proximoimgSurf = 'img/badges/Categorias/Surf/3.3.png';
        document.getElementById("Surf").src="img/badges/Categorias/Surf/3.2.png"
      }
      if(badges.length >= 30 && badges.length < 50 ){
        $scope.anteriorimgSurf = 'img/badges/Categorias/Surf/3.2.png';
        $scope.proximoSurf = 50;
        $scope.proximoimgSurf = 'img/badges/Categorias/Surf/Super.png';
        document.getElementById("Surf").src="img/badges/Categorias/Surf/3.3.png"
      }

      if(badges.length >= 50){
        $scope.anteriorimgSurf = 'img/badges/Categorias/Surf/3.3.png';
        $scope.proximoSurf = 10000;
        $scope.proximoimgSurf = 'img/badges/Categorias/Surf/Super.png';
        document.getElementById("Surf").src="img/badges/Categorias/Surf/Super.png"
      }

    }else{
      $scope.auxnbadgeSurf = 0;
        $scope.anteriorimgSurf = 'img/badges/Categorias/Surf/0.png';
        $scope.proximoSurf = 1;
        $scope.proximoimgSurf = 'img/badges/Categorias/Surf/1.png';
      document.getElementById("Surf").src="img/badges/Categorias/Surf/0.png"
    }
  });

  $scope.aux.tag = "#Voluntariado";
  $scope.auxnbadgeVoluntariado = 0;
  $scope.proximoVoluntariado = 0;
  $scope.proximoimgVoluntariado = '';
  $scope.anteriorimgVoluntariado = '';
  EventoService.getbadges($scope.aux).then(function(badges){
    //console.log("Voluntariado", badges);
    if(badges!="Error" && badges !="E"){
      $scope.auxnbadgeVoluntariado = badges.length;
      if(badges.length == 0){
        $scope.anteriorimgVoluntariado = 'img/badges/Categorias/Voluntariado/0.png';
        $scope.proximoVoluntariado = 1;
        $scope.proximoimgVoluntariado = 'img/badges/Categorias/Voluntariado/1.png';
        document.getElementById("Voluntariado").src="img/badges/Categorias/Voluntariado/0.png"
      }
      if(badges.length == 1){
        $scope.anteriorimgVoluntariado = 'img/badges/Categorias/Voluntariado/0.png';
        $scope.proximoVoluntariado = 2;
        $scope.proximoimgVoluntariado = 'img/badges/Categorias/Voluntariado/1.1.png';
        document.getElementById("Voluntariado").src="img/badges/Categorias/Voluntariado/1.png"
      }
      if(badges.length == 2){
        $scope.anteriorimgVoluntariado = 'img/badges/Categorias/Voluntariado/1.png';
        $scope.proximoVoluntariado = 3;
        $scope.proximoimgVoluntariado = 'img/badges/Categorias/Voluntariado/1.2.png';
        document.getElementById("Voluntariado").src="img/badges/Categorias/Voluntariado/1.1.png"
      }
      if(badges.length == 3){
        $scope.anteriorimgVoluntariado = 'img/badges/Categorias/Voluntariado/1.1.png';
        $scope.proximoVoluntariado = 4;
        $scope.proximoimgVoluntariado = 'img/badges/Categorias/Voluntariado/1.3.png';
        document.getElementById("Voluntariado").src="img/badges/Categorias/Voluntariado/1.2.png"
      }
      if(badges.length == 4 || badges.length == 5){
        $scope.anteriorimgVoluntariado = 'img/badges/Categorias/Voluntariado/1.2.png';
        $scope.proximoVoluntariado = 6;
        $scope.proximoimgVoluntariado = 'img/badges/Categorias/Voluntariado/2.png';
        document.getElementById("Voluntariado").src="img/badges/Categorias/Voluntariado/1.3.png"
      }

      if(badges.length == 6 || badges.length == 7){
        $scope.anteriorimgVoluntariado = 'img/badges/Categorias/Voluntariado/1.3.png';
        $scope.proximoVoluntariado = 8;
        $scope.proximoimgVoluntariado = 'img/badges/Categorias/Voluntariado/2.1.png';
        document.getElementById("Voluntariado").src="img/badges/Categorias/Voluntariado/2.png"
      }
      if(badges.length == 8 || badges.length == 9){
        $scope.anteriorimgVoluntariado = 'img/badges/Categorias/Voluntariado/2.png';
        $scope.proximoVoluntariado = 10;
        $scope.proximoimgVoluntariado = 'img/badges/Categorias/Voluntariado/2.2.png';
        document.getElementById("Voluntariado").src="img/badges/Categorias/Voluntariado/2.1.png"
      }
      if(badges.length == 10 || badges.length == 11){
        $scope.anteriorimgVoluntariado = 'img/badges/Categorias/Voluntariado/2.1.png';
        $scope.proximoVoluntariado = 12;
        $scope.proximoimgVoluntariado = 'img/badges/Categorias/Voluntariado/2.3.png';
        document.getElementById("Voluntariado").src="img/badges/Categorias/Voluntariado/2.2.png"
      }
      if(badges.length == 12 || badges.length == 13 || badges.length == 14){
        $scope.anteriorimgVoluntariado = 'img/badges/Categorias/Voluntariado/2.2.png';
        $scope.proximoVoluntariado = 15;
        $scope.proximoimgVoluntariado = 'img/badges/Categorias/Voluntariado/3.png';
        document.getElementById("Voluntariado").src="img/badges/Categorias/Voluntariado/2.3.png"
      }

      if(badges.length >= 15 && badges.length < 20 ){
        $scope.anteriorimgVoluntariado = 'img/badges/Categorias/Voluntariado/2.3.png';
        $scope.proximoVoluntariado = 20;
        $scope.proximoimgVoluntariado = 'img/badges/Categorias/Voluntariado/3.1.png';
        document.getElementById("Voluntariado").src="img/badges/Categorias/Voluntariado/3.png"
      }
      if(badges.length >= 20 && badges.length < 22 ){
        $scope.anteriorimgVoluntariado = 'img/badges/Categorias/Voluntariado/3.png';
        $scope.proximoVoluntariado = 25;
        $scope.proximoimgVoluntariado = 'img/badges/Categorias/Voluntariado/3.2.png';
        document.getElementById("Voluntariado").src="img/badges/Categorias/Voluntariado/3.1.png"
      }
      if(badges.length >= 25 && badges.length < 30 ){
        $scope.anteriorimgVoluntariado = 'img/badges/Categorias/Voluntariado/3.1.png';
        $scope.proximoVoluntariado = 30;
        $scope.proximoimgVoluntariado = 'img/badges/Categorias/Voluntariado/3.3.png';
        document.getElementById("Voluntariado").src="img/badges/Categorias/Voluntariado/3.2.png"
      }
      if(badges.length >= 30 && badges.length < 50 ){
        $scope.anteriorimgVoluntariado = 'img/badges/Categorias/Voluntariado/3.2.png';
        $scope.proximoVoluntariado = 50;
        $scope.proximoimgVoluntariado = 'img/badges/Categorias/Voluntariado/Super.png';
        document.getElementById("Voluntariado").src="img/badges/Categorias/Voluntariado/3.3.png"
      }

      if(badges.length >= 50){
        $scope.anteriorimgVoluntariado = 'img/badges/Categorias/Voluntariado/3.3.png';
        $scope.proximoVoluntariado = 10000;
        $scope.proximoimgVoluntariado = 'img/badges/Categorias/Voluntariado/Super.png';
        document.getElementById("Voluntariado").src="img/badges/Categorias/Voluntariado/Super.png"
      }

    }else{
      $scope.auxnbadgeVoluntariado = 0;
        $scope.anteriorimgVoluntariado = 'img/badges/Categorias/Voluntariado/0.png';
        $scope.proximoVoluntariado = 1;
        $scope.proximoimgVoluntariado = 'img/badges/Categorias/Voluntariado/1.png';
      document.getElementById("Voluntariado").src="img/badges/Categorias/Voluntariado/0.png"
    }
  });
  // $scope.auxnbadgeQuantidadePersonalidades = 0;
  // $scope.proximoQuantidadePersonalidades = 0;
  // $scope.proximoimgQuantidadePersonalidades = '';
  // $scope.anteriorimgQuantidadePersonalidades = '';
  // EventoService.GetComments3($scope.user).then(function(badges){
  //   //console.log("GetComments3", badges.mal,"dasd", badges.ruins);
  //   if(badges.mal != "0,0,0,"){
  //     $scope.auxnbadgeQuantidadePersonalidades = badges.tamanho;
  //     if(badges.tamanho == 0){
  //       $scope.anteriorimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/0.png';
  //       $scope.proximoQuantidadePersonalidades = 1;
  //       $scope.proximoimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/1.png';

  //       document.getElementById("QuantidadePersonalidades").src="img/badges/Geral/Avaliacoes/QuantidadePersonalidades/0.png"
  //     }
  //     if(badges.tamanho >= 1 && badges.tamanho < 5){
  //       $scope.anteriorimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/0.png';
  //       $scope.proximoQuantidadePersonalidades = 5;
  //       $scope.proximoimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/1.1.png';
  //       document.getElementById("QuantidadePersonalidades").src="img/badges/Geral/Avaliacoes/QuantidadePersonalidades/1.png"
  //     }
  //     if(badges.tamanho >= 5 && badges.tamanho < 10){
  //       $scope.anteriorimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/1.png';
  //       $scope.proximoQuantidadePersonalidades = 10;
  //       $scope.proximoimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/1.2.png';
  //       document.getElementById("QuantidadePersonalidades").src="img/badges/Geral/Avaliacoes/QuantidadePersonalidades/1.1.png"
  //     }
  //     if(badges.tamanho >= 10 && badges.tamanho < 15){
  //       $scope.anteriorimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/1.1.png';
  //       $scope.proximoQuantidadePersonalidades = 15;
  //       $scope.proximoimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/1.3.png';
  //       document.getElementById("QuantidadePersonalidades").src="img/badges/Geral/Avaliacoes/QuantidadePersonalidades/1.2.png"
  //     }
  //     if(badges.tamanho >= 15 && badges.tamanho < 30){
  //       $scope.anteriorimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/1.2.png';
  //       $scope.proximoQuantidadePersonalidades = 30;
  //       $scope.proximoimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/2.png';
  //       document.getElementById("QuantidadePersonalidades").src="img/badges/Geral/Avaliacoes/QuantidadePersonalidades/1.3.png"
  //     }

  //     if(badges.tamanho >= 30 && badges.tamanho < 40){
  //       $scope.anteriorimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/1.3.png';
  //       $scope.proximoQuantidadePersonalidades = 40;
  //       $scope.proximoimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/2.1.png';
  //       document.getElementById("QuantidadePersonalidades").src="img/badges/Geral/Avaliacoes/QuantidadePersonalidades/2.png"
  //     }
  //     if(badges.tamanho >= 40 && badges.tamanho < 50){
  //       $scope.anteriorimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/2.png';
  //       $scope.proximoQuantidadePersonalidades = 50;
  //       $scope.proximoimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/2.2.png';
  //       document.getElementById("QuantidadePersonalidades").src="img/badges/Geral/Avaliacoes/QuantidadePersonalidades/2.1.png"
  //     }
  //     if(badges.tamanho >= 50 && badges.tamanho < 60){
  //       $scope.anteriorimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/2.1.png';
  //       $scope.proximoQuantidadePersonalidades = 60;
  //       $scope.proximoimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/2.3.png';
  //       document.getElementById("QuantidadePersonalidades").src="img/badges/Geral/Avaliacoes/QuantidadePersonalidades/2.2.png"
  //     }
  //     if(badges.tamanho >= 60 && badges.tamanho < 80){
  //       $scope.anteriorimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/2.2.png';
  //       $scope.proximoQuantidadePersonalidades = 80;
  //       $scope.proximoimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/3.png';
  //       document.getElementById("QuantidadePersonalidades").src="img/badges/Geral/Avaliacoes/QuantidadePersonalidades/2.3.png"
  //     }

  //     if(badges.tamanho >= 80 && badges.tamanho < 110 ){
  //       $scope.anteriorimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/2.3.png';
  //       $scope.proximoQuantidadePersonalidades = 110;
  //       $scope.proximoimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/3.1.png';
  //       document.getElementById("QuantidadePersonalidades").src="img/badges/Geral/Avaliacoes/QuantidadePersonalidades/3.png"
  //     }
  //     if(badges.tamanho >= 110 && badges.tamanho < 140 ){
  //       $scope.anteriorimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/3.png';
  //       $scope.proximoQuantidadePersonalidades = 140;
  //       $scope.proximoimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/3.2.png';
  //       document.getElementById("QuantidadePersonalidades").src="img/badges/Geral/Avaliacoes/QuantidadePersonalidades/3.1.png"
  //     }
  //     if(badges.tamanho >= 140 && badges.tamanho < 170 ){
  //       $scope.anteriorimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/3.1.png';
  //       $scope.proximoQuantidadePersonalidades = 170;
  //       $scope.proximoimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/3.3.png';
  //       document.getElementById("QuantidadePersonalidades").src="img/badges/Geral/Avaliacoes/QuantidadePersonalidades/3.2.png"
  //     }
  //     if(badges.tamanho >= 170 && badges.tamanho < 230 ){
  //       $scope.anteriorimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/3.2.png';
  //       $scope.proximoQuantidadePersonalidades = 230;
  //       $scope.proximoimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/Super.png';
  //       document.getElementById("QuantidadePersonalidades").src="img/badges/Geral/Avaliacoes/QuantidadePersonalidades/3.3.png"
  //     }

  //     if(badges.tamanho >= 230){
  //       $scope.anteriorimgQuantidadePersonalidades = 'img/badges/Geral/Avaliacoes/QuantidadePersonalidades/3.3.png';
  //       $scope.proximoQuantidadePersonalidades = 10000;
  //       $scope.proximoimgQuantidadePersonalidades = '';
  //       document.getElementById("QuantidadePersonalidades").src="img/badges/Geral/Avaliacoes/QuantidadePersonalidades/Super.png"
  //     }

  //   }else{
  //     document.getElementById("QuantidadePersonalidades").src="img/badges/Geral/Avaliacoes/QuantidadePersonalidades/0.png"
  //   }
  // });

  // $scope.auxnbadgeSmartDealer = 0;
  // $scope.proximoSmartDealer = 0;
  // $scope.proximoimgSmartDealer = '';
  // $scope.anteriorimgSmartDealer = '';
  // EventoService.getbadgesCriouComercio($scope.user).then(function(badges){
  //   //console.log("getbadgesCriouComercio", badges.length);
  //   if(badges!="Error" && badges !="E"){
  //     $scope.auxnbadgeSmartDealer = badges.length;
  //     if(badges.length == 0){
  //       $scope.anteriorimgSmartDealer = '"img/badges/Geral/Comercios/SmartDealer/0.png';
  //       $scope.proximoSmartDealer = 1;
  //       $scope.proximoimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/1.png';
  //       document.getElementById("SmartDealer").src="img/badges/Geral/Comercios/SmartDealer/0.png"
  //     }
  //     if(badges.length == 1){
  //       $scope.anteriorimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/0.png';
  //       $scope.proximoSmartDealer = 2;
  //       $scope.proximoimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/1.1.png';
  //       document.getElementById("SmartDealer").src="img/badges/Geral/Comercios/SmartDealer/1.png"
  //     }
  //     if(badges.length == 2){
  //       $scope.anteriorimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/1.png';
  //       $scope.proximoSmartDealer = 3;
  //       $scope.proximoimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/1.2.png';
  //       document.getElementById("SmartDealer").src="img/badges/Geral/Comercios/SmartDealer/1.1.png"
  //     }
  //     if(badges.length == 3){
  //       $scope.anteriorimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/1.1.png';
  //       $scope.proximoSmartDealer = 4;
  //       $scope.proximoimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/1.3.png';
  //       document.getElementById("SmartDealer").src="img/badges/Geral/Comercios/SmartDealer/1.2.png"
  //     }
  //     if(badges.length >= 4 && badges.length < 6){
  //       $scope.anteriorimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/1.2.png';
  //       $scope.proximoSmartDealer = 6;
  //       $scope.proximoimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/2.png';
  //       document.getElementById("SmartDealer").src="img/badges/Geral/Comercios/SmartDealer/1.3.png"
  //     }

  //     if(badges.length >= 6 && badges.length < 8){
  //       $scope.anteriorimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/1.3.png';
  //       $scope.proximoSmartDealer = 8;
  //       $scope.proximoimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/2.1.png';
  //       document.getElementById("SmartDealer").src="img/badges/Geral/Comercios/SmartDealer/2.png"
  //     }
  //     if(badges.length >= 8 && badges.length < 10){
  //       $scope.anteriorimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/2.png';
  //       $scope.proximoSmartDealer = 10;
  //       $scope.proximoimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/2.2.png';
  //       document.getElementById("SmartDealer").src="img/badges/Geral/Comercios/SmartDealer/2.1.png"
  //     }
  //     if(badges.length >= 10 && badges.length < 12){
  //       $scope.anteriorimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/2.1.png';
  //       $scope.proximoSmartDealer = 12;
  //       $scope.proximoimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/2.3.png';
  //       document.getElementById("SmartDealer").src="img/badges/Geral/Comercios/SmartDealer/2.2.png"
  //     }
  //     if(badges.length >= 12 && badges.length < 15){
  //       $scope.anteriorimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/2.2.png';
  //       $scope.proximoSmartDealer = 15;
  //       $scope.proximoimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/3.png';
  //       document.getElementById("SmartDealer").src="img/badges/Geral/Comercios/SmartDealer/2.3.png"
  //     }

  //     if(badges.length >= 15 && badges.length < 20 ){
  //       $scope.anteriorimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/2.3.png';
  //       $scope.proximoSmartDealer = 20;
  //       $scope.proximoimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/3.1.png';
  //       document.getElementById("SmartDealer").src="img/badges/Geral/Comercios/SmartDealer/3.png"
  //     }
  //     if(badges.length >= 20 && badges.length < 25 ){
  //       $scope.anteriorimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/3.png';
  //       $scope.proximoSmartDealer = 25;
  //       $scope.proximoimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/3.2.png';
  //       document.getElementById("SmartDealer").src="img/badges/Geral/Comercios/SmartDealer/3.1.png"
  //     }
  //     if(badges.length >= 25 && badges.length < 30 ){
  //       $scope.anteriorimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/3.1.png';
  //       $scope.proximoSmartDealer = 30;
  //       $scope.proximoimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/3.3.png';
  //       document.getElementById("SmartDealer").src="img/badges/Geral/Comercios/SmartDealer/3.2.png"
  //     }
  //     if(badges.length >= 30 && badges.length < 40 ){
  //       $scope.anteriorimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/3.2.png';
  //       $scope.proximoSmartDealer = 40;
  //       $scope.proximoimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/Super.png';
  //       document.getElementById("SmartDealer").src="img/badges/Geral/Comercios/SmartDealer/3.3.png"
  //     }

  //     if(badges.length >= 40){
  //       $scope.anteriorimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/3.3.png';
  //       $scope.proximoSmartDealer = 10000;
  //       $scope.proximoimgSmartDealer = 'img/badges/Geral/Comercios/SmartDealer/Super.png';
  //       document.getElementById("SmartDealer").src="img/badges/Geral/Comercios/SmartDealer/Super.png"
  //     }

  //   }else{
  //     document.getElementById("SmartDealer").src="img/badges/Geral/Comercios/SmartDealer/0.png"
  //   }
  // });

  // $scope.auxnbadgeCriador = 0;
  // $scope.proximoCriador = 0;
  // $scope.proximoimgCriador = '';
  // $scope.anteriorimgCriador = '';
  // EventoService.GetCriados($scope.user).then(function(badges) {
  //   if(badges!="Error" && badges !="E"){
  //     $scope.auxnbadgeCriador = badges.length;
  //     if(badges.length == 0){
  //       $scope.anteriorimgCriador = 'img/badges/Geral/Eventos/Criador/0.png';
  //       $scope.proximoCriador = 1;
  //       $scope.proximoimgCriador = 'img/badges/Geral/Eventos/Criador/1.png';
  //       document.getElementById("Criador").src="img/badges/Geral/Eventos/Criador/0.png"
  //     }
  //     if(badges.length == 1){
  //       $scope.anteriorimgCriador = 'img/badges/Geral/Eventos/Criador/0.png';
  //       $scope.proximoCriador = 2;
  //       $scope.proximoimgCriador = 'img/badges/Geral/Eventos/Criador/1.1.png';
  //       document.getElementById("Criador").src="img/badges/Geral/Eventos/Criador/1.png"
  //     }
  //     if(badges.length == 2){
  //       $scope.anteriorimgCriador = 'img/badges/Geral/Eventos/Criador/1.png';
  //       $scope.proximoCriador = 3;
  //       $scope.proximoimgCriador = 'img/badges/Geral/Eventos/Criador/1.2.png';
  //       document.getElementById("Criador").src="img/badges/Geral/Eventos/Criador/1.1.png"
  //     }
  //     if(badges.length == 3){
  //       $scope.anteriorimgCriador = 'img/badges/Geral/Eventos/Criador/1.1.png';
  //       $scope.proximoCriador = 4;
  //       $scope.proximoimgCriador = 'img/badges/Geral/Eventos/Criador/1.3.png';
  //       document.getElementById("Criador").src="img/badges/Geral/Eventos/Criador/1.2.png"
  //     }
  //     if(badges.length >= 4 && badges.length < 6){
  //       $scope.anteriorimgCriador = 'img/badges/Geral/Eventos/Criador/1.2.png';
  //       $scope.proximoCriador = 6;
  //       $scope.proximoimgCriador = 'img/badges/Geral/Eventos/Criador/2.png';
  //       document.getElementById("Criador").src="img/badges/Geral/Eventos/Criador/1.3.png"
  //     }

  //     if(badges.length >= 6 && badges.length < 8){
  //       $scope.anteriorimgCriador = 'img/badges/Geral/Eventos/Criador/1.3.png';
  //       $scope.proximoCriador = 8;
  //       $scope.proximoimgCriador = 'img/badges/Geral/Eventos/Criador/2.1.png';
  //       document.getElementById("Criador").src="img/badges/Geral/Eventos/Criador/2.png"
  //     }
  //     if(badges.length >= 8 && badges.length < 10){
  //       $scope.anteriorimgCriador = 'img/badges/Geral/Eventos/Criador/2.png';
  //       $scope.proximoCriador = 10;
  //       $scope.proximoimgCriador = 'img/badges/Geral/Eventos/Criador/2.2.png';
  //       document.getElementById("Criador").src="img/badges/Geral/Eventos/Criador/2.1.png"
  //     }
  //     if(badges.length >= 10 && badges.length < 12){
  //       $scope.anteriorimgCriador = 'img/badges/Geral/Eventos/Criador/2.1.png';
  //       $scope.proximoCriador = 12;
  //       $scope.proximoimgCriador = 'img/badges/Geral/Eventos/Criador/2.3.png';
  //       document.getElementById("Criador").src="img/badges/Geral/Eventos/Criador/2.2.png"
  //     }
  //     if(badges.length >= 12 && badges.length < 15){
  //       $scope.anteriorimgCriador = 'img/badges/Geral/Eventos/Criador/2.2.png';
  //       $scope.proximoCriador = 15;
  //       $scope.proximoimgCriador = 'img/badges/Geral/Eventos/Criador/3.png';
  //       document.getElementById("Criador").src="img/badges/Geral/Eventos/Criador/2.3.png"
  //     }

  //     if(badges.length >= 15 && badges.length < 20 ){
  //       $scope.anteriorimgCriador = 'img/badges/Geral/Eventos/Criador/2.3.png';
  //       $scope.proximoCriador = 20;
  //       $scope.proximoimgCriador = 'img/badges/Geral/Eventos/Criador/3.1.png';
  //       document.getElementById("Criador").src="img/badges/Geral/Eventos/Criador/3.png"
  //     }
  //     if(badges.length >= 20 && badges.length < 25 ){
  //       $scope.anteriorimgCriador = 'img/badges/Geral/Eventos/Criador/3.png';
  //       $scope.proximoCriador = 25;
  //       $scope.proximoimgCriador = 'img/badges/Geral/Eventos/Criador/3.2.png';
  //       document.getElementById("Criador").src="img/badges/Geral/Eventos/Criador/3.1.png"
  //     }
  //     if(badges.length >= 25 && badges.length < 30 ){
  //       $scope.anteriorimgCriador = 'img/badges/Geral/Eventos/Criador/3.1.png';
  //       $scope.proximoCriador = 30;
  //       $scope.proximoimgCriador = 'img/badges/Geral/Eventos/Criador/3.3.png';
  //       document.getElementById("Criador").src="img/badges/Geral/Eventos/Criador/3.2.png"
  //     }
  //     if(badges.length >= 30 && badges.length < 40 ){
  //       $scope.anteriorimgCriador = 'img/badges/Geral/Eventos/Criador/3.2.png';
  //       $scope.proximoCriador = 40;
  //       $scope.proximoimgCriador = 'img/badges/Geral/Eventos/Criador/Super.png';
  //       document.getElementById("Criador").src="img/badges/Geral/Eventos/Criador/3.3.png"
  //     }

  //     if(badges.length >= 40){
  //       $scope.anteriorimgCriador = 'img/badges/Geral/Eventos/Criador/3.3.png';
  //       $scope.proximoCriador = 10000;
  //       $scope.proximoimgCriador = 'img/badges/Geral/Eventos/Criador/Super.png';
  //       document.getElementById("Criador").src="img/badges/Geral/Eventos/Criador/Super.png"
  //     }

  //   }else{
  //     document.getElementById("Criador").src="img/badges/Geral/Eventos/Criador/0.png"
  //   }
  // });

  // $scope.auxnbadgeParticipante = 0;
  // $scope.proximoParticipante = 0;
  // $scope.proximoimgParticipante = '';
  // $scope.anteriorimgParticipante = '';
  // EventoService.GetParticipanteBagde($scope.user).then(function(badges) {
  //   //console.log(badges.length,"GetParticipanteBagde")
  //   if(badges!="Error" && badges !="E"){
  //     $scope.auxnbadgeParticipante = badges.length;
  //     if(badges.length == 0){
  //       $scope.anteriorimgParticipante = 'img/badges/Geral/Eventos/Participante/0.png';
  //       $scope.proximoParticipante = 1;
  //       $scope.proximoimgParticipante = 'img/badges/Geral/Eventos/Participante/1.png';
  //       document.getElementById("Participante").src="img/badges/Geral/Eventos/Participante/0.png"
  //     }
  //     if(badges.length == 1){
  //       $scope.anteriorimgParticipante = 'img/badges/Geral/Eventos/Participante/0.png';
  //       $scope.proximoParticipante = 2;
  //       $scope.proximoimgParticipante = 'img/badges/Geral/Eventos/Participante/1.1.png';
  //       document.getElementById("Participante").src="img/badges/Geral/Eventos/Participante/1.png"
  //     }
  //     if(badges.length == 2){
  //       $scope.anteriorimgParticipante = 'img/badges/Geral/Eventos/Participante/1.png';
  //       $scope.proximoParticipante = 3;
  //       $scope.proximoimgParticipante = 'img/badges/Geral/Eventos/Participante/1.2.png';
  //       document.getElementById("Participante").src="img/badges/Geral/Eventos/Participante/1.1.png"
  //     }
  //     if(badges.length == 3){
  //       $scope.anteriorimgParticipante = 'img/badges/Geral/Eventos/Participante/1.1.png';
  //       $scope.proximoParticipante = 4;
  //       $scope.proximoimgParticipante = 'img/badges/Geral/Eventos/Participante/1.3.png';
  //       document.getElementById("Participante").src="img/badges/Geral/Eventos/Participante/1.2.png"
  //     }
  //     if(badges.length >= 4 && badges.length < 6){
  //       $scope.anteriorimgParticipante = 'img/badges/Geral/Eventos/Participante/1.2.png';
  //       $scope.proximoParticipante = 6;
  //       $scope.proximoimgParticipante = 'img/badges/Geral/Eventos/Participante/2.png';
  //       document.getElementById("Participante").src="img/badges/Geral/Eventos/Participante/1.3.png"
  //     }

  //     if(badges.length >= 6 && badges.length < 8){
  //       $scope.anteriorimgParticipante = 'img/badges/Geral/Eventos/Participante/1.3.png';
  //       $scope.proximoParticipante = 8;
  //       $scope.proximoimgParticipante = 'img/badges/Geral/Eventos/Participante/2.1.png';
  //       document.getElementById("Participante").src="img/badges/Geral/Eventos/Participante/2.png"
  //     }
  //     if(badges.length >= 8 && badges.length < 10){
  //       $scope.anteriorimgParticipante = 'img/badges/Geral/Eventos/Participante/2.png';
  //       $scope.proximoParticipante = 10;
  //       $scope.proximoimgParticipante = 'img/badges/Geral/Eventos/Participante/2.2.png';
  //       document.getElementById("Participante").src="img/badges/Geral/Eventos/Participante/2.1.png"
  //     }
  //     if(badges.length >= 10 && badges.length < 12){
  //       $scope.anteriorimgParticipante = 'img/badges/Geral/Eventos/Participante/2.1.png';
  //       $scope.proximoParticipante = 12;
  //       $scope.proximoimgParticipante = 'img/badges/Geral/Eventos/Participante/2.3.png';
  //       document.getElementById("Participante").src="img/badges/Geral/Eventos/Participante/2.2.png"
  //     }
  //     if(badges.length >= 12 && badges.length < 20){
  //       $scope.anteriorimgParticipante = 'img/badges/Geral/Eventos/Participante/2.2.png';
  //       $scope.proximoParticipante = 20;
  //       $scope.proximoimgParticipante = 'img/badges/Geral/Eventos/Participante/3.png';
  //       document.getElementById("Participante").src="img/badges/Geral/Eventos/Participante/2.3.png"
  //     }

  //     if(badges.length >= 20 && badges.length < 25 ){
  //       $scope.anteriorimgParticipante = 'img/badges/Geral/Eventos/Participante/2.3.png';
  //       $scope.proximoParticipante = 25;
  //       $scope.proximoimgParticipante = 'img/badges/Geral/Eventos/Participante/3.1.png';
  //       document.getElementById("Participante").src="img/badges/Geral/Eventos/Participante/3.png"
  //     }
  //     if(badges.length >= 25 && badges.length < 30 ){
  //       $scope.anteriorimgParticipante = 'img/badges/Geral/Eventos/Participante/3.png';
  //       $scope.proximoParticipante = 30;
  //       $scope.proximoimgParticipante = 'img/badges/Geral/Eventos/Participante/3.2.png';
  //       document.getElementById("Participante").src="img/badges/Geral/Eventos/Participante/3.1.png"
  //     }
  //     if(badges.length >= 30 && badges.length < 35 ){
  //       $scope.anteriorimgParticipante = 'img/badges/Geral/Eventos/Participante/3.1.png';
  //       $scope.proximoParticipante = 35;
  //       $scope.proximoimgParticipante = 'img/badges/Geral/Eventos/Participante/3.3.png';
  //       document.getElementById("Participante").src="img/badges/Geral/Eventos/Participante/3.2.png"
  //     }
  //     if(badges.length >= 35 && badges.length < 50 ){
  //       $scope.anteriorimgParticipante = 'img/badges/Geral/Eventos/Participante/3.2.png';
  //       $scope.proximoParticipante = 50;
  //       $scope.proximoimgParticipante = 'img/badges/Geral/Eventos/Participante/Super.png';
  //       document.getElementById("Participante").src="img/badges/Geral/Eventos/Participante/3.3.png"
  //     }

  //     if(badges.length >= 50){
  //       $scope.anteriorimgParticipante = 'img/badges/Geral/Eventos/Participante/3.3.png';
  //       $scope.proximoParticipante = 10000;
  //       $scope.proximoimgParticipante = 'img/badges/Geral/Eventos/Participante/Super.png';
  //       document.getElementById("Participante").src="img/badges/Geral/Eventos/Participante/Super.png"
  //     }

  //   }else{
  //     document.getElementById("Participante").src="img/badges/Geral/Eventos/Participante/0.png"
  //   }
  // });

  // $scope.auxnbadgeComentarios = 0;
  // $scope.proximoComentarios = 0;
  // $scope.proximoimgComentarios = '';
  // $scope.anteriorimgComentarios = '';
  // EventoService.GetBadgeComentarioPost($scope.user).then(function(badges) {
  //   //console.log(badges.length,"GetBadgeComentarioPost",badges )
  //   if(badges!="Error" && badges !="E"){
  //     $scope.auxnbadgeComentarios = badges.length;
  //     //console.log("faisdfniasidn", badges.length)
  //     if(badges.length == 0){
  //       $scope.anteriorimgComentarios = 'img/badges/Geral/Posts/Comentarios/0.png';
  //       $scope.proximoComentarios = 1;
  //       $scope.proximoimgComentarios = 'img/badges/Geral/Posts/Comentarios/1.png';
  //       document.getElementById("Comentarios").src="img/badges/Geral//Posts/Comentarios/0.png"
  //     }
  //     if(badges.length >= 1 && badges.length < 5){
  //       $scope.anteriorimgComentarios = 'img/badges/Geral/Posts/Comentarios/0.png';
  //       $scope.proximoComentarios = 5;
  //       $scope.proximoimgComentarios = 'img/badges/Geral/Posts/Comentarios/1.1.png';
  //       document.getElementById("Comentarios").src="img/badges/Geral/Posts/Comentarios/1.png"
  //     }
  //     if(badges.length >= 5 && badges.length < 10){
  //       $scope.anteriorimgComentarios = 'img/badges/Geral/Posts/Comentarios/1.png';
  //       $scope.proximoComentarios = 10;
  //       $scope.proximoimgComentarios = 'img/badges/Geral/Posts/Comentarios/1.2.png';
  //       document.getElementById("Comentarios").src="img/badges/Geral/Posts/Comentarios/1.1.png"
  //     }
  //     if(badges.length >= 10 && badges.length < 15){
  //       $scope.anteriorimgComentarios = 'img/badges/Geral/Posts/Comentarios/1.1.png';
  //       $scope.proximoComentarios = 15;
  //       $scope.proximoimgComentarios = 'img/badges/Geral/Posts/Comentarios/1.3.png';
  //       document.getElementById("Comentarios").src="img/badges/Geral/Posts/Comentarios/1.2.png"
  //     }
  //     if(badges.length >= 15 && badges.length < 30){
  //       $scope.anteriorimgComentarios = 'img/badges/Geral/Posts/Comentarios/1.2.png';
  //       $scope.proximoComentarios = 30;
  //       $scope.proximoimgComentarios = 'img/badges/Geral/Posts/Comentarios/2.png';
  //       console.log("faisdfniasidn")
  //       document.getElementById("Comentarios").src="img/badges/Geral/Posts/Comentarios/1.3.png"
  //     }

  //     if(badges.length >= 30 && badges.length < 40){
  //       $scope.anteriorimgComentarios = 'img/badges/Geral/Posts/Comentarios/1.3.png';
  //       $scope.proximoComentarios = 40;
  //       $scope.proximoimgComentarios = 'img/badges/Geral/Posts/Comentarios/2.1.png';
  //       document.getElementById("Comentarios").src="img/badges/Geral/Posts/Comentarios/2.png"
  //     }
  //     if(badges.length >= 40 && badges.length < 50){
  //       $scope.anteriorimgComentarios = 'img/badges/Geral/Posts/Comentarios/2.png';
  //       $scope.proximoComentarios = 50;
  //       $scope.proximoimgComentarios = 'img/badges/Geral/Posts/Comentarios/2.2.png';
  //       document.getElementById("Comentarios").src="img/badges/Geral/Posts/Comentarios/2.1.png"
  //     }
  //     if(badges.length >= 50 && badges.length < 60){
  //       $scope.anteriorimgComentarios = 'img/badges/Geral/Posts/Comentarios/2.1.png';
  //       $scope.proximoComentarios = 60;
  //       $scope.proximoimgComentarios = 'img/badges/Geral/Posts/Comentarios/2.3.png';
  //       document.getElementById("Comentarios").src="img/badges/Geral/Posts/Comentarios/2.2.png"
  //     }
  //     if(badges.length >= 60 && badges.length < 80){
  //       $scope.anteriorimgComentarios = 'img/badges/Geral/Posts/Comentarios/2.2.png';
  //       $scope.proximoComentarios = 80;
  //       $scope.proximoimgComentarios = 'img/badges/Geral/Posts/Comentarios/3.png';
  //       document.getElementById("Comentarios").src="img/badges/Geral/Posts/Comentarios/2.3.png"
  //     }

  //     if(badges.length >= 80 && badges.length < 110 ){
  //       $scope.anteriorimgComentarios = 'img/badges/Geral/Posts/Comentarios/2.3.png';
  //       $scope.proximoComentarios = 110;
  //       $scope.proximoimgComentarios = 'img/badges/Geral/Posts/Comentarios/3.1.png';
  //       document.getElementById("Comentarios").src="img/badges/Geral/Posts/Comentarios/3.png"
  //     }
  //     if(badges.length >= 110 && badges.length < 140 ){
  //       $scope.anteriorimgComentarios = 'img/badges/Geral/Posts/Comentarios/3.png';
  //       $scope.proximoComentarios = 140;
  //       $scope.proximoimgComentarios = 'img/badges/Geral/Posts/Comentarios/3.2.png';
  //       document.getElementById("Comentarios").src="img/badges/Geral/Posts/Comentarios/3.1.png"
  //     }
  //     if(badges.length >= 140 && badges.length < 170 ){
  //       $scope.anteriorimgComentarios = 'img/badges/Geral/Posts/Comentarios/3.1.png';
  //       $scope.proximoComentarios = 170;
  //       $scope.proximoimgComentarios = 'img/badges/Geral/Posts/Comentarios/3.3.png';
  //       document.getElementById("Comentarios").src="img/badges/Geral/Posts/Comentarios/3.2.png"
  //     }
  //     if(badges.length >= 170 && badges.length < 230 ){
  //       $scope.anteriorimgComentarios = 'img/badges/Geral/Posts/Comentarios/3.2.png';
  //       $scope.proximoComentarios = 230;
  //       $scope.proximoimgComentarios = 'img/badges/Geral/Posts/Comentarios/Super.png';
  //       document.getElementById("Comentarios").src="img/badges/Geral/Posts/Comentarios/3.3.png"
  //     }

  //     if(badges.length >= 230){
  //       $scope.anteriorimgComentarios = 'img/badges/Geral/Posts/Comentarios/3.3.png';
  //       $scope.proximoComentarios = 10000;
  //       $scope.proximoimgComentarios = 'img/badges/Geral/Posts/Comentarios/Super.png';
  //       document.getElementById("Comentarios").src="img/badges/Geral/Posts/Comentarios/Super.png"
  //     }

  //   }else{
  //     document.getElementById("Comentarios").src="img/badges/Geral/Posts/Comentarios/0.png"
  //   }
  // });

  // $scope.auxnbadgeOriginalPoster = 0;
  // $scope.proximoOriginalPoster = 0;
  // $scope.proximoimgOriginalPoster = '';
  // $scope.anteriorimgOriginalPoster = '';
  // EventoService.GetFeedMeusPost($scope.user).then(function(badges) {
  //   //console.log(badges.length,"GetBadgeComentarioPost",badges )
  //   if(badges!="Error" && badges !="E"){
  //     $scope.auxnbadgeOriginalPoster = badges.length;
  //     //console.log("faisdfniasidn", badges.length)
  //     if(badges.length == 0){
  //       $scope.anteriorimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/0.png';
  //       $scope.proximoOriginalPoster = 1;
  //       $scope.proximoimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/1.png';
  //       document.getElementById("OriginalPoster").src="img/badges/Geral//Posts/OriginalPoster/0.png"
  //     }
  //     if(badges.length >= 1 && badges.length < 3){
  //       $scope.anteriorimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/0.png';
  //       $scope.proximoOriginalPoster = 3;
  //       $scope.proximoimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/1.1.png';
  //       document.getElementById("OriginalPoster").src="img/badges/Geral/Posts/OriginalPoster/1.png"
  //     }
  //     if(badges.length >= 3 && badges.length < 5){
  //       $scope.anteriorimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/1.png';
  //       $scope.proximoOriginalPoster = 5;
  //       $scope.proximoimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/1.2.png';
  //       document.getElementById("OriginalPoster").src="img/badges/Geral/Posts/OriginalPoster/1.1.png"
  //     }
  //     if(badges.length >= 5 && badges.length < 7){
  //       $scope.anteriorimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/1.1.png';
  //       $scope.proximoOriginalPoster = 7;
  //       $scope.proximoimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/1.3.png';
  //       document.getElementById("OriginalPoster").src="img/badges/Geral/Posts/OriginalPoster/1.2.png"
  //     }
  //     if(badges.length >= 7 && badges.length < 10){
  //       $scope.anteriorimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/1.2.png';
  //       $scope.proximoOriginalPoster = 10;
  //       $scope.proximoimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/2.png';
       
  //       document.getElementById("OriginalPoster").src="img/badges/Geral/Posts/OriginalPoster/1.3.png"
  //     }

  //     if(badges.length >= 10 && badges.length < 15){
  //       $scope.anteriorimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/1.3.png';
  //       $scope.proximoOriginalPoster = 15;
  //       $scope.proximoimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/2.1.png';
  //       document.getElementById("OriginalPoster").src="img/badges/Geral/Posts/OriginalPoster/2.png"
  //     }
  //     if(badges.length >= 15 && badges.length < 20){
  //       $scope.anteriorimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/2.png';
  //       $scope.proximoOriginalPoster = 20;
  //       $scope.proximoimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/2.2.png';
  //       document.getElementById("OriginalPoster").src="img/badges/Geral/Posts/OriginalPoster/2.1.png"
  //     }
  //     if(badges.length >= 20 && badges.length < 25){
  //       $scope.anteriorimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/2.1.png';
  //       $scope.proximoOriginalPoster = 25;
  //       $scope.proximoimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/2.3.png';
  //       document.getElementById("OriginalPoster").src="img/badges/Geral/Posts/OriginalPoster/2.2.png"
  //     }
  //     if(badges.length >= 25 && badges.length < 35){
  //       $scope.anteriorimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/2.2.png';
  //       $scope.proximoOriginalPoster = 35;
  //       $scope.proximoimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/3.png';
  //       document.getElementById("OriginalPoster").src="img/badges/Geral/Posts/OriginalPoster/2.3.png"
  //     }

  //     if(badges.length >= 35 && badges.length < 45 ){
  //       $scope.anteriorimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/2.3.png';
  //       $scope.proximoOriginalPoster = 45;
  //       $scope.proximoimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/3.1.png';
  //       document.getElementById("OriginalPoster").src="img/badges/Geral/Posts/OriginalPoster/3.png"
  //     }
  //     if(badges.length >= 45 && badges.length < 55 ){
  //       $scope.anteriorimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/3.png';
  //       $scope.proximoOriginalPoster = 55;
  //       $scope.proximoimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/3.2.png';
  //       document.getElementById("OriginalPoster").src="img/badges/Geral/Posts/OriginalPoster/3.1.png"
  //     }
  //     if(badges.length >= 55 && badges.length < 65 ){
  //       $scope.anteriorimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/3.1.png';
  //       $scope.proximoOriginalPoster = 65;
  //       $scope.proximoimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/3.3.png';
  //       document.getElementById("OriginalPoster").src="img/badges/Geral/Posts/OriginalPoster/3.2.png"
  //     }
  //     if(badges.length >= 65 && badges.length < 80 ){
  //       $scope.anteriorimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/3.2.png';
  //       $scope.proximoOriginalPoster = 80;
  //       $scope.proximoimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/Super.png';
  //       document.getElementById("OriginalPoster").src="img/badges/Geral/Posts/OriginalPoster/3.3.png"
  //     }

  //     if(badges.length >= 80){
  //       $scope.anteriorimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/3.3.png';
  //       $scope.proximoOriginalPoster = 10000;
  //       $scope.proximoimgOriginalPoster = 'img/badges/Geral/Posts/OriginalPoster/Super.png';
  //       document.getElementById("OriginalPoster").src="img/badges/Geral/Posts/OriginalPoster/Super.png"
  //     }

  //   }else{
  //     document.getElementById("OriginalPoster").src="img/badges/Geral/Posts/OriginalPoster/0.png"
  //   }
  // });
  
  // $scope.auxnbadgeUpvotes = 0;
  // $scope.proximoUpvotes = 0;
  // $scope.proximoimgUpvotes = '';
  // $scope.anteriorimgUpvotes = '';
  // EventoService.GetBadgeUpvote($scope.user).then(function(badges) {
  //   console.log(badges.length,"GetBadgeComentarioPost",badges )
  //   if(badges!="Error" && badges !="E"){
  //     $scope.auxnbadgeUpvotes = badges.length;
  //     console.log("faisdfniasidn", badges.length)
  //     if(badges.length == 0){
  //       $scope.anteriorimgUpvotes = 'img/badges/Geral/Posts/Upvotes/0.png';
  //       $scope.proximoUpvotes = 1;
  //       $scope.proximoimgUpvotes = 'img/badges/Geral/Posts/Upvotes/1.png';
  //       document.getElementById("Upvotes").src="img/badges/Geral//Posts/Upvotes/0.png"
  //     }
  //     if(badges.length >= 1 && badges.length < 5){
  //       $scope.anteriorimgUpvotes = 'img/badges/Geral/Posts/Upvotes/0.png';
  //       $scope.proximoUpvotes = 5;
  //       $scope.proximoimgUpvotes = 'img/badges/Geral/Posts/Upvotes/1.1.png';
  //       document.getElementById("Upvotes").src="img/badges/Geral/Posts/Upvotes/1.png"
  //     }
  //     if(badges.length >= 5 && badges.length < 10){
  //       $scope.anteriorimgUpvotes = 'img/badges/Geral/Posts/Upvotes/1.png';
  //       $scope.proximoUpvotes = 10;
  //       $scope.proximoimgUpvotes = 'img/badges/Geral/Posts/Upvotes/1.2.png';
  //       document.getElementById("Upvotes").src="img/badges/Geral/Posts/Upvotes/1.1.png"
  //     }
  //     if(badges.length >= 10 && badges.length < 15){
  //       $scope.anteriorimgUpvotes = 'img/badges/Geral/Posts/Upvotes/1.1.png';
  //       $scope.proximoUpvotes = 15;
  //       $scope.proximoimgUpvotes = 'img/badges/Geral/Posts/Upvotes/1.3.png';
  //       document.getElementById("Upvotes").src="img/badges/Geral/Posts/Upvotes/1.2.png"
  //     }
  //     if(badges.length >= 15 && badges.length < 25){
  //       $scope.anteriorimgUpvotes = 'img/badges/Geral/Posts/Upvotes/1.2.png';
  //       $scope.proximoUpvotes = 25;
  //       $scope.proximoimgUpvotes = 'img/badges/Geral/Posts/Upvotes/2.png';
       
  //       document.getElementById("Upvotes").src="img/badges/Geral/Posts/Upvotes/1.3.png"
  //     }

  //     if(badges.length >= 25 && badges.length < 35){
  //       $scope.anteriorimgUpvotes = 'img/badges/Geral/Posts/Upvotes/1.3.png';
  //       $scope.proximoUpvotes = 35;
  //       $scope.proximoimgUpvotes = 'img/badges/Geral/Posts/Upvotes/2.1.png';
  //       document.getElementById("Upvotes").src="img/badges/Geral/Posts/Upvotes/2.png"
  //     }
  //     if(badges.length >= 35 && badges.length < 45){
  //       $scope.anteriorimgUpvotes = 'img/badges/Geral/Posts/Upvotes/2.png';
  //       $scope.proximoUpvotes = 45;
  //       $scope.proximoimgUpvotes = 'img/badges/Geral/Posts/Upvotes/2.2.png';
  //       document.getElementById("Upvotes").src="img/badges/Geral/Posts/Upvotes/2.1.png"
  //     }
  //     if(badges.length >= 45 && badges.length < 55){
  //       $scope.anteriorimgUpvotes = 'img/badges/Geral/Posts/Upvotes/2.1.png';
  //       $scope.proximoUpvotes = 55;
  //       $scope.proximoimgUpvotes = 'img/badges/Geral/Posts/Upvotes/2.3.png';
  //       document.getElementById("Upvotes").src="img/badges/Geral/Posts/Upvotes/2.2.png"
  //     }
  //     if(badges.length >= 55 && badges.length < 80){
  //       $scope.anteriorimgUpvotes = 'img/badges/Geral/Posts/Upvotes/2.2.png';
  //       $scope.proximoUpvotes = 80;
  //       $scope.proximoimgUpvotes = 'img/badges/Geral/Posts/Upvotes/3.png';
  //       document.getElementById("Upvotes").src="img/badges/Geral/Posts/Upvotes/2.3.png"
  //     }

  //     if(badges.length >= 80 && badges.length < 100 ){
  //       $scope.anteriorimgUpvotes = 'img/badges/Geral/Posts/Upvotes/2.3.png';
  //       $scope.proximoUpvotes = 100;
  //       $scope.proximoimgUpvotes = 'img/badges/Geral/Posts/Upvotes/3.1.png';
  //       document.getElementById("Upvotes").src="img/badges/Geral/Posts/Upvotes/3.png"
  //     }
  //     if(badges.length >= 100 && badges.length < 120 ){
  //       $scope.anteriorimgUpvotes = 'img/badges/Geral/Posts/Upvotes/3.png';
  //       $scope.proximoUpvotes = 120;
  //       $scope.proximoimgUpvotes = 'img/badges/Geral/Posts/Upvotes/3.2.png';
  //       document.getElementById("Upvotes").src="img/badges/Geral/Posts/Upvotes/3.1.png"
  //     }
  //     if(badges.length >= 120 && badges.length < 140 ){
  //       $scope.anteriorimgUpvotes = 'img/badges/Geral/Posts/Upvotes/3.1.png';
  //       $scope.proximoUpvotes = 140;
  //       $scope.proximoimgUpvotes = 'img/badges/Geral/Posts/Upvotes/3.3.png';
  //       document.getElementById("Upvotes").src="img/badges/Geral/Posts/Upvotes/3.2.png"
  //     }
  //     if(badges.length >= 140 && badges.length < 200 ){
  //       $scope.anteriorimgUpvotes = 'img/badges/Geral/Posts/Upvotes/3.2.png';
  //       $scope.proximoUpvotes = 200;
  //       $scope.proximoimgUpvotes = 'img/badges/Geral/Posts/Upvotes/Super.png';
  //       document.getElementById("Upvotes").src="img/badges/Geral/Posts/Upvotes/3.3.png"
  //     }

  //     if(badges.length >= 200){
  //       $scope.anteriorimgUpvotes = 'img/badges/Geral/Posts/Upvotes/3.3.png';
  //       $scope.proximoUpvotes = 100000;
  //       $scope.proximoimgUpvotes = 'img/badges/Geral/Posts/Upvotes/Super.png';
  //       document.getElementById("Upvotes").src="img/badges/Geral/Posts/Upvotes/Super.png"
  //     }

  //   }else{
  //     document.getElementById("Upvotes").src="img/badges/Geral/Posts/Upvotes/0.png"
  //   }
  // });

  $scope.naotembadgescomercio = ""
  EventoService.GetComercioFinalizado($scope.user).then(function(badges) {  //console.log(badges.length,"GetBadgeComentarioPost",badges )
    console.log("badges error", badges)
    if(badges!="error" && badges !="e"){
      console.log("faisdfniasidn", badges.length)
      for(var i =0 ;i<badges.length;i++){
        if(badges[i].idcomercio == '53'){
          if(badges[i].n == '1'){
            document.getElementById("Paintball").src="img/badges/Comercios/Paintball/1.png"
          }
          if(badges[i].n == '2'){
            document.getElementById("Paintball").src="img/badges/Comercios/Paintball/2.png"
          }
          if(badges[i].n >= '3'){
            document.getElementById("Paintball").src="img/badges/Comercios/Paintball/3.png"
          }
        }
        if(badges[i].idcomercio == '222'){
          if(badges[i].n == '1'){
            document.getElementById("BarcoPirataItapema").src="img/badges/Comercios/BarcoPirataItapema/1.png"
          }
          if(badges[i].n == '2'){
            document.getElementById("BarcoPirataItapema").src="img/badges/Comercios/BarcoPirataItapema/2.png"
          }
          if(badges[i].n >= '3'){
            document.getElementById("BarcoPirataItapema").src="img/badges/Comercios/BarcoPirataItapema/3.png"
          }
        }
        if(badges[i].idcomercio == '223'){
          if(badges[i].n == '1'){
            document.getElementById("BCWalkingTour").src="img/badges/Comercios/BCWalkingTour/1.png"
          }
          if(badges[i].n == '2'){
            document.getElementById("BCWalkingTour").src="img/badges/Comercios/BCWalkingTour/2.png"
          }
          if(badges[i].n >= '3'){
            document.getElementById("BCWalkingTour").src="img/badges/Comercios/BCWalkingTour/3.png"
          }
        }
        if(badges[i].idcomercio == '225'){
          if(badges[i].n == '1'){
            document.getElementById("BravaBeachSports").src="img/badges/Comercios/BravaBeachSports/1.png"
          }
          if(badges[i].n == '2'){
            document.getElementById("BravaBeachSports").src="img/badges/Comercios/BravaBeachSports/2.png"
          }
          if(badges[i].n >= '3'){
            document.getElementById("BravaBeachSports").src="img/badges/Comercios/BravaBeachSports/3.png"
          }
        }
        if(badges[i].idcomercio == '227'){
          if(badges[i].n == '1'){
            document.getElementById("MVBTennisPaddel").src="img/badges/Comercios/MVBTennisPaddel/1.png"
          }
          if(badges[i].n == '2'){
            document.getElementById("MVBTennisPaddel").src="img/badges/Comercios/MVBTennisPaddel/2.png"
          }
          if(badges[i].n >= '3'){
            document.getElementById("MVBTennisPaddel").src="img/badges/Comercios/MVBTennisPaddel/3.png"
          }
        }
        
        if(badges[i].idcomercio == '228'){
          if(badges[i].n == '1'){
            document.getElementById("TriboDaÁgua").src="img/badges/Comercios/TriboDaÁgua/1.png"
          }
          if(badges[i].n == '2'){
            document.getElementById("TriboDaÁgua").src="img/badges/Comercios/TriboDaÁgua/2.png"
          }
          if(badges[i].n >= '3'){
            document.getElementById("TriboDaÁgua").src="img/badges/Comercios/TriboDaÁgua/3.png"
          }
        }
      }
            

    }else{
      $scope.naotembadgescomercio = "Ainda não tem nenhuma conquista em locais parceiros"
    }
  });

  $scope.naotembadgesgeral = ""
  $scope.auxnbadgeNumberOneHExa = 0;
  $scope.proximoNumberOneHExa = 0;
  $scope.proximoimgNumberOneHExa = '';
  $scope.anteriorimgNumberOneHExa = '';
  EventoService.getusuario($scope.user).then(function(user) {
      $scope.user = user;
      if(user.numcodigo){
        if(user.numcodigo == '0'){
          $scope.auxnbadgeNumberOneHExa = 0;
          $scope.anteriorimgNumberOneHExa = 'img/egg_0.png';
          $scope.proximoNumberOneHExa = 1;
          $scope.proximoimgNumberOneHExa = 'img/egg_1.png';
          document.getElementById("NumberOneHExa").src="img/egg_0.png";
        }
        if(user.numcodigo == '1'){
          $scope.auxnbadgeNumberOneHExa = 1;
          $scope.anteriorimgNumberOneHExa = 'img/egg_0.png';
          $scope.proximoNumberOneHExa = 2;
          $scope.proximoimgNumberOneHExa = 'img/egg_2.png';
          document.getElementById("NumberOneHExa").src="img/egg_1.png";
        }
        if(user.numcodigo == '2'){
          $scope.auxnbadgeNumberOneHExa = 2;
          $scope.anteriorimgNumberOneHExa = 'img/egg_1.png';
          $scope.proximoNumberOneHExa = 3;
          $scope.proximoimgNumberOneHExa = 'img/NumberOneHExa.png';
          document.getElementById("NumberOneHExa").src="img/egg_2.png";
        }
        if(parseInt(user.numcodigo) >= 3){
          $scope.auxnbadgeNumberOneHExa = 3;
          $scope.anteriorimgNumberOneHExa = 'img/egg_2.png';
          $scope.proximoNumberOneHExa = 1000;
          $scope.proximoimgNumberOneHExa = 'img/NumberOneHExa.png';
          document.getElementById("NumberOneHExa").src="img/NumberOneHExa.png";
        }
        if(parseInt(user.numcodigo) < 0){
          $scope.auxnbadgeNumberOneHExa = 3;
          $scope.anteriorimgNumberOneHExa = 'img/egg_2.png';
          $scope.proximoNumberOneHExa = 1000;
          $scope.proximoimgNumberOneHExa = 'img/NumberOneHExa.png';
          document.getElementById("NumberOneHExa").src="img/NumberOneHExa.png";
        }
      }else{
        $scope.naotembadgesgeral = "Ainda não tem nenhuma conquista aqui"
      }
     

  });

  $scope.entraBadge = function(badge){
    console.log("badge",badge);
    $scope.badge = {};
    if(badge == 'QuantidadePersonalidades'){
      $scope.badge.titulo = 'Self Awareness';
      $scope.badge.texto = 'Quanto mais avaliações referentes à nossa personalidade, mais entendemos como as pessoas nos veem. Isso pode ser útil para nos conhecermos melhor!';
      $scope.badge.numeroatual = $scope.auxnbadgeQuantidadePersonalidades;
      $scope.badge.numeroproximo = $scope.proximoQuantidadePersonalidades
      $scope.badge.imgatual = document.getElementById("QuantidadePersonalidades").src;
      $scope.badge.imganterior = $scope.anteriorimgQuantidadePersonalidades;
      $scope.badge.imgproximo = $scope.proximoimgQuantidadePersonalidades;
      formBadge.updateForm($scope.badge);
      $state.go('tabsController.badgesexplica');
    }
    if(badge == 'SmartDealer'){
      $scope.badge.titulo = 'Smart Dealer';
      $scope.badge.texto = 'Um Din Din Baggy é inteligente, ele cria eventos que oferecem recompensas para gastar menos fazendo mais.';
      $scope.badge.numeroatual = $scope.auxnbadgeSmartDealer;
      $scope.badge.numeroproximo = $scope.proximoSmartDealer
      $scope.badge.imgatual = document.getElementById("SmartDealer").src;
      $scope.badge.imganterior = $scope.anteriorimgSmartDealer;
      $scope.badge.imgproximo = $scope.proximoimgSmartDealer;
      formBadge.updateForm($scope.badge);
      $state.go('tabsController.badgesexplica');
    }
    if(badge == 'Criador'){
      $scope.badge.titulo = 'Creator';
      $scope.badge.texto = 'Cria eventos no app';
      $scope.badge.numeroatual = $scope.auxnbadgeCriador;
      $scope.badge.numeroproximo = $scope.proximoCriador
      $scope.badge.imgatual = document.getElementById("Criador").src;
      $scope.badge.imganterior = $scope.anteriorimgCriador;
      $scope.badge.imgproximo = $scope.proximoimgCriador;
      formBadge.updateForm($scope.badge);
      $state.go('tabsController.badgesexplica');
    }
    if(badge == 'Participante'){
      $scope.badge.titulo = 'Story Maker';
      $scope.badge.texto = 'Participa de eventos no app';
      $scope.badge.numeroatual = $scope.auxnbadgeParticipante;
      $scope.badge.numeroproximo = $scope.proximoParticipante;
      $scope.badge.imgatual = document.getElementById("Participante").src;
      $scope.badge.imganterior = $scope.anteriorimgParticipante;
      $scope.badge.imgproximo = $scope.proximoimgParticipante;
      formBadge.updateForm($scope.badge);
      $state.go('tabsController.badgesexplica');
    }
    if(badge == 'Comentarios'){
      $scope.badge.titulo = 'Community Activist';
      $scope.badge.texto = 'Um(a) ativista da sua comunidade local através de comentários em posts';
      $scope.badge.numeroatual = $scope.auxnbadgeComentarios;
      $scope.badge.numeroproximo = $scope.proximoComentarios
      $scope.badge.imgatual = document.getElementById("Comentarios").src;
      $scope.badge.imganterior = $scope.anteriorimgComentarios;
      $scope.badge.imgproximo = $scope.proximoimgComentarios;
      formBadge.updateForm($scope.badge);
      $state.go('tabsController.badgesexplica');
    }
    if(badge == 'OriginalPoster'){
      $scope.badge.titulo = 'Original Poster';
      $scope.badge.texto = 'Cria engajamento da sua comunidade local através da criação de posts';
      $scope.badge.numeroatual = $scope.auxnbadgeOriginalPoster;
      $scope.badge.numeroproximo = $scope.proximoOriginalPoster
      $scope.badge.imgatual = document.getElementById("OriginalPoster").src;
      $scope.badge.imganterior = $scope.anteriorimgOriginalPoster;
      $scope.badge.imgproximo = $scope.proximoimgOriginalPoster;
      formBadge.updateForm($scope.badge);
      $state.go('tabsController.badgesexplica');
    }
    if(badge == 'Upvotes'){
      $scope.badge.titulo = 'Community Supporter';
      $scope.badge.texto = 'Um suporte da sua comunidade local que ajuda a filtrar os bons posts dos ruins através de upvotes';
      $scope.badge.numeroatual = $scope.auxnbadgeUpvotes;
      $scope.badge.numeroproximo = $scope.proximoUpvotes
      $scope.badge.imgatual = document.getElementById("Upvotes").src;
      $scope.badge.imganterior = $scope.anteriorimgUpvotes;
      $scope.badge.imgproximo = $scope.proximoimgUpvotes;
      formBadge.updateForm($scope.badge);
      $state.go('tabsController.badgesexplica');
    }
    if(badge == 'NumberOneHExa'){
      $scope.badge.titulo = 'Amigo que chama';
      $scope.badge.texto = 'Convida amigos quando descobre um app novo';
      $scope.badge.numeroatual = $scope.auxnbadgeNumberOneHExa;
      $scope.badge.numeroproximo = $scope.proximoNumberOneHExa
      $scope.badge.imgatual = document.getElementById("NumberOneHExa").src;
      $scope.badge.imganterior = $scope.anteriorimgNumberOneHExa;
      $scope.badge.imgproximo = $scope.proximoimgNumberOneHExa;
      formBadge.updateForm($scope.badge);
      $state.go('tabsController.badgesexplica');
    }
    if(badge == 'ArteeCultura'){
      $scope.badge.titulo = 'Cult';
      $scope.badge.texto = 'Você participou de eventos com #ArteeCultura';
      $scope.badge.numeroatual = $scope.auxnbadgeArteeCultura;
      $scope.badge.numeroproximo = $scope.proximoArteeCultura
      $scope.badge.imgatual = document.getElementById("ArteeCultura").src;
      $scope.badge.imganterior = $scope.anteriorimgArteeCultura;
      $scope.badge.imgproximo = $scope.proximoimgArteeCultura;
      formBadge.updateForm($scope.badge);
      $state.go('tabsController.badgesexplica');
    }
    if(badge == 'Ciclismo'){
      $scope.badge.titulo = 'Pedal';
      $scope.badge.texto = 'Você participou de eventos com #Ciclismo';
      $scope.badge.numeroatual = $scope.auxnbadgeCiclismo;
      $scope.badge.numeroproximo = $scope.proximoCiclismo
      $scope.badge.imgatual = document.getElementById("Ciclismo").src;
      $scope.badge.imganterior = $scope.anteriorimgCiclismo;
      $scope.badge.imgproximo = $scope.proximoimgCiclismo;
      formBadge.updateForm($scope.badge);
      $state.go('tabsController.badgesexplica');
    }
    if(badge == 'Conversa'){
      $scope.badge.titulo = 'Falador(a)';
      $scope.badge.texto = 'Você participou de eventos com #Conversa';
      $scope.badge.numeroatual = $scope.auxnbadgeConversa;
      $scope.badge.numeroproximo = $scope.proximoConversa
      $scope.badge.imgatual = document.getElementById("Conversa").src;
      $scope.badge.imganterior = $scope.anteriorimgConversa;
      $scope.badge.imgproximo = $scope.proximoimgConversa;
      formBadge.updateForm($scope.badge);
      $state.go('tabsController.badgesexplica');
    }
    if(badge == 'Danca'){
      $scope.badge.titulo = 'Pés de valsa';
      $scope.badge.texto = 'Você participou de eventos com #Dança';
      $scope.badge.numeroatual = $scope.auxnbadgeDanca;
      $scope.badge.numeroproximo = $scope.proximoDanca
      $scope.badge.imgatual = document.getElementById("Danca").src;
      $scope.badge.imganterior = $scope.anteriorimgDanca;
      $scope.badge.imgproximo = $scope.proximoimgDanca;
      formBadge.updateForm($scope.badge);
      $state.go('tabsController.badgesexplica');
    }
    if(badge == 'EsportesdePraia'){
      $scope.badge.titulo = 'Esportes de Praia';
      $scope.badge.texto = 'Você participou de eventos com #EsportesdePraia';
      $scope.badge.numeroatual = $scope.auxnbadgeEsportesdePraia;
      $scope.badge.numeroproximo = $scope.proximoEsportesdePraia
      $scope.badge.imgatual = document.getElementById("EsportesdePraia").src;
      $scope.badge.imganterior = $scope.anteriorimgEsportesdePraia;
      $scope.badge.imgproximo = $scope.proximoimgEsportesdePraia;
      formBadge.updateForm($scope.badge);
      $state.go('tabsController.badgesexplica');
    }
    if(badge == 'FestaseBaladas'){
      $scope.badge.titulo = 'Da night';
      $scope.badge.texto = 'Você participou de eventos com #FestaseBaladas';
      $scope.badge.numeroatual = $scope.auxnbadgeFestaseBaladas;
      $scope.badge.numeroproximo = $scope.proximoFestaseBaladas
      $scope.badge.imgatual = document.getElementById("FestaseBaladas").src;
      $scope.badge.imganterior = $scope.anteriorimgFestaseBaladas;
      $scope.badge.imgproximo = $scope.proximoimgFestaseBaladas;
      formBadge.updateForm($scope.badge);
      $state.go('tabsController.badgesexplica');
    }
    if(badge == 'Futebol'){
      $scope.badge.titulo = 'Boleiro';
      $scope.badge.texto = 'Você participou de eventos com #Futebol';
      $scope.badge.numeroatual = $scope.auxnbadgeFutebol;
      $scope.badge.numeroproximo = $scope.proximoFutebol
      $scope.badge.imgatual = document.getElementById("Futebol").src;
      $scope.badge.imganterior = $scope.anteriorimgFutebol;
      $scope.badge.imgproximo = $scope.proximoimgFutebol;
      formBadge.updateForm($scope.badge);
      $state.go('tabsController.badgesexplica');
    }
    if(badge == 'GrupodeEstudos'){
      $scope.badge.titulo = 'CDF';
      $scope.badge.texto = 'Você participou de eventos com #GrupodeEstudos';
      $scope.badge.numeroatual = $scope.auxnbadgeGrupodeEstudos;
      $scope.badge.numeroproximo = $scope.proximoGrupodeEstudos
      $scope.badge.imgatual = document.getElementById("GrupodeEstudos").src;
      $scope.badge.imganterior = $scope.anteriorimgGrupodeEstudos;
      $scope.badge.imgproximo = $scope.proximoimgGrupodeEstudos;
      formBadge.updateForm($scope.badge);
      $state.go('tabsController.badgesexplica');
    }
    if(badge == 'Jogos'){
      $scope.badge.titulo = 'Jogador (a)';
      $scope.badge.texto = 'Você participou de eventos com #Jogos';
      $scope.badge.numeroatual = $scope.auxnbadgeJogos;
      $scope.badge.numeroproximo = $scope.proximoJogos
      $scope.badge.imgatual = document.getElementById("Jogos").src;
      $scope.badge.imganterior = $scope.anteriorimgJogos;
      $scope.badge.imgproximo = $scope.proximoimgJogos;
      formBadge.updateForm($scope.badge);
      $state.go('tabsController.badgesexplica');
    }
    if(badge == 'Musica'){
      $scope.badge.titulo = 'Chill';
      $scope.badge.texto = 'Você participou de eventos com #Musica';
      $scope.badge.numeroatual = $scope.auxnbadgeMusica;
      $scope.badge.numeroproximo = $scope.proximoMusica
      $scope.badge.imgatual = document.getElementById("Musica").src;
      $scope.badge.imganterior = $scope.anteriorimgMusica;
      $scope.badge.imgproximo = $scope.proximoimgMusica;
      formBadge.updateForm($scope.badge);
      $state.go('tabsController.badgesexplica');
    }
    if(badge == 'Natureza'){
      $scope.badge.titulo = 'Do mato';
      $scope.badge.texto = 'Você participou de eventos com #Natureza';
      $scope.badge.numeroatual = $scope.auxnbadgeNatureza;
      $scope.badge.numeroproximo = $scope.proximoNatureza
      $scope.badge.imgatual = document.getElementById("Natureza").src;
      $scope.badge.imganterior = $scope.anteriorimgNatureza;
      $scope.badge.imgproximo = $scope.proximoimgNatureza;
      formBadge.updateForm($scope.badge);
      $state.go('tabsController.badgesexplica');
    }
    if(badge == 'Passeio'){
      $scope.badge.titulo = 'Do rolê';
      $scope.badge.texto = 'Você participou de eventos com #Passeio';
      $scope.badge.numeroatual = $scope.auxnbadgePasseio;
      $scope.badge.numeroproximo = $scope.proximoPasseio
      $scope.badge.imgatual = document.getElementById("Passeio").src;
      $scope.badge.imganterior = $scope.anteriorimgPasseio;
      $scope.badge.imgproximo = $scope.proximoimgPasseio;
      formBadge.updateForm($scope.badge);
      $state.go('tabsController.badgesexplica');
    }
    if(badge == 'Pets'){
      $scope.badge.titulo = 'Amo animais';
      $scope.badge.texto = 'Você participou de eventos com #Pets';
      $scope.badge.numeroatual = $scope.auxnbadgePets;
      $scope.badge.numeroproximo = $scope.proximoPets
      $scope.badge.imgatual = document.getElementById("Pets").src;
      $scope.badge.imganterior = $scope.anteriorimgPets;
      $scope.badge.imgproximo = $scope.proximoimgPets;
      formBadge.updateForm($scope.badge);
      $state.go('tabsController.badgesexplica');
    }
    if(badge == 'Restaurantesebares'){
      $scope.badge.titulo = 'Degustador';
      $scope.badge.texto = 'Você participou de eventos com #Restaurantesebares';
      $scope.badge.numeroatual = $scope.auxnbadgeRestaurantesebares;
      $scope.badge.numeroproximo = $scope.proximoRestaurantesebares
      $scope.badge.imgatual = document.getElementById("Restaurantesebares").src;
      $scope.badge.imganterior = $scope.anteriorimgRestaurantesebares;
      $scope.badge.imgproximo = $scope.proximoimgRestaurantesebares;
      formBadge.updateForm($scope.badge);
      $state.go('tabsController.badgesexplica');
    }
    if(badge == 'Surf'){
      $scope.badge.titulo = 'Surf';
      $scope.badge.texto = 'Você participou de eventos com #Surf';
      $scope.badge.numeroatual = $scope.auxnbadgeSurf;
      $scope.badge.numeroproximo = $scope.proximoSurf
      $scope.badge.imgatual = document.getElementById("Surf").src;
      $scope.badge.imganterior = $scope.anteriorimgSurf;
      $scope.badge.imgproximo = $scope.proximoimgSurf;
      formBadge.updateForm($scope.badge);
      $state.go('tabsController.badgesexplica');
    }
    if(badge == 'Voluntariado'){
      $scope.badge.titulo = 'Ajudar sempre é bom';
      $scope.badge.texto = 'Você participou de eventos com #Voluntariado';
      $scope.badge.numeroatual = $scope.auxnbadgeVoluntariado;
      $scope.badge.numeroproximo = $scope.proximoVoluntariado
      $scope.badge.imgatual = document.getElementById("Voluntariado").src;
      $scope.badge.imganterior = $scope.anteriorimgVoluntariado;
      $scope.badge.imgproximo = $scope.proximoimgVoluntariado;
      formBadge.updateForm($scope.badge);
      $state.go('tabsController.badgesexplica');
    }

  }


}])

.controller('badgesexplicaCtrl', ['$scope', '$stateParams', 'formUser', 'EventoService','$ionicPopup', '$timeout','$state', '$cordovaCamera', '$cordovaFile', '$cordovaFileTransfer', '$ionicLoading','formBadge', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, formUser, EventoService, $ionicPopup, $timeout, $state, $cordovaCamera, $cordovaFile, $cordovaFileTransfer, $ionicLoading, formBadge) {

  // $scope.user = formUser.getForm();
  // $scope.badge = formBadge.getForm();
  // document.getElementById("badgeimg").src=$scope.badge.imgatual;
  // document.getElementById("Atual").src=$scope.badge.imgatual;
  // document.getElementById("Anterior").src=$scope.badge.imganterior;
  // document.getElementById("Proximonivel").src=$scope.badge.imgproximo;
  // $scope.badge.progressPercent = $scope.badge.numeroatual * 100 / $scope.badge.numeroproximo;
  
   

  $scope.$on("$ionicView.enter", function(event, data){
    $scope.user = formUser.getForm();
    $scope.badge = formBadge.getForm();
 
    document.getElementById("Atual").src=$scope.badge.imgatual;
    document.getElementById("Anterior").src=$scope.badge.imganterior;
    document.getElementById("Proximonivel").src=$scope.badge.imgproximo;
    console.log($scope.badge.imgatual)
    $scope.badge.progressPercent = $scope.badge.numeroatual * 100 / $scope.badge.numeroproximo;
   
  });


}])
  
.controller('editarPerfilCtrl', ['$scope', '$stateParams', 'formUser', 'EventoService','$ionicPopup', '$timeout','$state', '$cordovaCamera', '$cordovaFile', '$cordovaFileTransfer', '$ionicLoading', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, formUser, EventoService, $ionicPopup, $timeout, $state, $cordovaCamera, $cordovaFile, $cordovaFileTransfer, $ionicLoading) {

  $scope.user = formUser.getForm();
  $scope.cidade ={};
  $scope.auxusername = $scope.user.username;
  if(!$scope.imgURI){
    $scope.imgURI = $scope.user.profilepic;
    if(($scope.user.profilepic[8] == 's' && $scope.user.profilepic[9] == '3')||($scope.user.profilepic[8] == 'd' && $scope.user.profilepic[9] == 'i')){
          
    //if($scope.user.profilepic[8] == 's' && $scope.user.profilepic[9] == '3'){
             document.getElementById("imageidEditar").src=$scope.user.profilepic+"?{{getTimeStamp()}}";
           }else{
             document.getElementById("imageidEditar").src=$scope.user.profilepic;
           }
    //document.getElementById("imageidEditar").src=$scope.user.profilepic+"?{{getTimeStamp()}}";
  }

  $scope.irinteresse = function(){
    console.log("irinteresse")
    $state.go('tabsController.novacontainteresseEdita')
  }

  $scope.mudarendereco = function(){
    $state.go('tabsController.editaperfilbairrocadastra')
  }
  // EventoService.Getinteresseuser($scope.user.iduser).then(function(interesse) {
  //     console.log(interesse,"interesse")
  //     if(interesse =="E"){
  //       $state.go('tabsController.novacontainteresseEdita')
  //     }else{
        
  //     }
  //   });

  var mudoufoto = false;
      var options = {
        types: ['(cities)'],
        componentRestrictions: {
          country: "br"
        }
      };
      //document.getElementById('pac-searchTextField')[0].setAttribute('data-tap-disabled', true);
       $scope.disableTap = function(){
     container = document.getElementsByClassName('pac-container');
     // disable ionic data tab
     angular.element(container).attr('data-tap-disabled', 'true');
     // leave input field if google-address-entry is selected
     angular.element(container).on("click", function(){
                                   document.getElementById('searchTextField').blur();
                                   });
     };
      var input = document.getElementById('searchTextField');
      var autocomplete = new google.maps.places.Autocomplete(input, options);
     
      $scope.cidade = autocomplete.getPlace();

    $scope.$on("$ionicView.enter", function(event, data){
      $scope.user = formUser.getForm();
      $scope.cidade ={};
      $scope.auxusername = $scope.user.username;
      if(!$scope.imgURI){
        $scope.imgURI = $scope.user.profilepic;
        if(($scope.user.profilepic[8] == 's' && $scope.user.profilepic[9] == '3')||($scope.user.profilepic[8] == 'd' && $scope.user.profilepic[9] == 'i')){
    
           document.getElementById("imageidEditar").src=$scope.user.profilepic+"?{{getTimeStamp()}}";
         }else{
           document.getElementById("imageidEditar").src=$scope.user.profilepic;
         }
      }
    });

    $scope.takePicture = function() {
      var optionsCamera = {
          quality : 100,
          destinationType : Camera.DestinationType.FILE_URL,
          sourceType : Camera.PictureSourceType.CAMERA,
          allowEdit : true,
          encodingType: Camera.EncodingType.JPEG,
          targetWidth: 640,
          targetHeight: 640,
          popoverOptions: CameraPopoverOptions,
          saveToPhotoAlbum: true
      };

      $cordovaCamera.getPicture(optionsCamera).then(function(imageData) {
          $scope.imgURI2 = imageData;
          $scope.imgURI = $scope.imgURI2;
          var mystring = String($scope.user.email);
          mystring = mystring.replace(/[^a-zA-Z0-9]/g, '');
          $scope.user.profilepic = 'https://diwoappprofilepics.s3.amazonaws.com/profilepicsdiwo/' + mystring + '.jpg';
          mudoufoto =true;
          document.getElementById("imageidEditar").src=imageData;
          
      }, function(err) {
          // An error occured. Show a message to the user
      });
    }
    $scope.getPicture = function (optionsCamera) {
      var optionsCamera = {
            quality : 100,
            sourceType : 0,
            allowEdit : true,
            targetWidth: 640,
            targetHeight: 640
      };
      $cordovaCamera.getPicture(optionsCamera).then(function(imageData) {
        $scope.imgURI2 = imageData;
        $scope.imgURI = $scope.imgURI2;
        document.getElementById("imageidEditar").src=imageData;
        var mystring = String($scope.user.email);
        mystring = mystring.replace(/[^a-zA-Z0-9]/g, '');
        $scope.user.profilepic = 'https://diwoappprofilepics.s3.amazonaws.com/profilepicsdiwo/' + mystring + '.jpg';
         
        mudoufoto =true;
      }, function(err) {
        console.log(err);
      });
    };
    $scope.cidade = autocomplete.getPlace();
        if($scope.cidade){
          for(var i = 0;i<$scope.cidade.address_components.length;i++){
            if($scope.cidade.address_components[i].types[0] == "administrative_area_level_2"){
              $scope.user.cidade = $scope.cidade.address_components[i].long_name;
             
            }
          }
        }

  $scope.verifica = function(){
    if($scope.auxusername.toLowerCase() == $scope.user.username.toLowerCase()){
      var alertPopup = $ionicPopup.alert({
              title: 'ԅ( ˘ω˘ ԅ)',
              template: 'Teu username ja é demaix'
        });
      $scope.usernexite = false;
      $scope.userexiste = false;
    }else{
      EventoService.verificanome($scope.user.username).then(function(success){
        console.log(success, "'dasd",$scope.user.email, $scope.user.genero )                         
        if(!success){
          $scope.usernexite = true;
          $scope.userexiste = false;
        }else{
          $scope.userexiste = true;
          $scope.usernexite = false;
        }
      }); 
    }
    
  };

  //$scope.cidade = autocomplete.getPlace();  
  $scope.mudar = function(){
    $scope.cidade = autocomplete.getPlace();
        if($scope.cidade){
          for(var i = 0;i<$scope.cidade.address_components.length;i++){
            if($scope.cidade.address_components[i].types[0] == "administrative_area_level_2"){
              $scope.user.cidade = $scope.cidade.address_components[i].long_name;
             
            }
          }
        }
     var palavrasnaousar = ["ALIAMBA", "ANUS", "BAGULIO"
      , "BANZA", "BARRUFO", "BECK", "BEQUE", "BOCETA"
      , "BOLAGATO", "BOQUETE", "BOLCAT", "BOSSETA", "BOSTANA", "BREXA", "BRIOCO", "BRONHA", "BUCA", "BUCETA"
      , "BUSSETA", "CANABIS", "CANNABIS", "CARALHO"
      , "CASSETA", "CASSETE", "CHECHECA", "CHERECA", "CHIBUMBA", "CHIBUMBO", "CHOTA", "CHOCHOTA", "CHUPADA", "CHUPADO", "CLITORIS"
      , "COCAINA", "C+"
      , "C*", "CURALHO", "CUZAO", "CUZUDA", "CUZUDO", "CUZÃO", "ESPORRADA", "ESPORRADO", "ESPORRO", "estupro"
      , "FELACAO", "FELACÃO", "FODA", "FODAO", "FODÃO", "FODAUM", "FODE", "FODIDA", "FODIDO", "FORNICA", "FUDENDO", "FUDECÃO", "FUDECAO"
      , "FUDIDA", "FUDIDO", "GRELINHO", "GRELO", "ISCROTA", "ISCROTO", "MACONHA", "MASTURBA", "MASTURBAÇÃO", "MASTURBACÃO", "MASTURBACAO"
      , "PENIS", "PEN1S", "PENES", "PENIZ", "PICA", "PIROCA", "PIRU", "PORRA", "POURRA", "PROSTIBULO", "PUTA", "PUNHETA", "PUTO"
      , "RABAO", "TESTUDA", "TESTUDO", "VAGABUNDA", "VAGINA", "VIADO", "VIADAO", "VIADÃO", "XAVASCA", "XERERECA", "XEXECA", "XOTA"
      , "XOCHOTA", "XOXOTA", "XANA", "XANINHA", "MDMA", "VSF", "TNC", "FDP", "CRACK"];
      var error = 0;
      var error1 = 0;  
      for (var i = 0; i < palavrasnaousar.length; i++) {
        var res2 = $scope.user.apelido.split("_") ;
        if(res2.length>1){
          for(var w = 0; w < res2.length; w++){
            var val = palavrasnaousar[i].toLowerCase();
            if ((res2[w].toLowerCase()).indexOf(val.toString()) > -1) {  
              error = error + 1;  
            }
          }
        }else{
          var val = palavrasnaousar[i].toLowerCase();  
          if (($scope.user.apelido.toLowerCase()).indexOf(val.toString()) > -1) {  
            error = error + 1;  
          }
        }
        var res3 = $scope.user.apelido.split(" ") ;
        if(res3.length>1){
          for(var w = 0; w < res3.length; w++){
            var val = palavrasnaousar[i].toLowerCase();
            if ((res3[w].toLowerCase()).indexOf(val.toString()) > -1) {  
              error = error + 1;  
            }
          }
        }else{
          var val = palavrasnaousar[i].toLowerCase();  
          if (($scope.user.apelido.toLowerCase()).indexOf(val.toString()) > -1) {  
            error = error + 1;  
          }
        }
              // PARA A DESCRICAO
        if($scope.user.descricao){
          var res2 = $scope.user.descricao.split("_") ;
          if(res2.length>1){
            for(var w = 0; w < res2.length; w++){
              var val = palavrasnaousar[i].toLowerCase();
              if ((res2[w].toLowerCase()).indexOf(val.toString()) > -1) {  
                error1 = error1 + 1;  
              }
            }
          }else{
            var val = palavrasnaousar[i].toLowerCase();  
            if (($scope.user.descricao.toLowerCase()).indexOf(val.toString()) > -1) {  
              error1 = error1 + 1;  
            }
          }
          var res3 = $scope.user.descricao.split(" ") ;
          if(res3.length>1){
            for(var w = 0; w < res3.length; w++){
              var val = palavrasnaousar[i].toLowerCase();
              if ((res3[w].toLowerCase()).indexOf(val.toString()) > -1) {  
                error1 = error1 + 1;  
              }
            }
          }else{
            var val = palavrasnaousar[i].toLowerCase();  
            if (($scope.user.descricao.toLowerCase()).indexOf(val.toString()) > -1) {  
              error1 = error1 + 1;  
            }
          }   
        }else{
          $scope.user.descricao = "";
        }
         
      } 
      if (error > 0) {  
          var alertPopup = $ionicPopup.alert({
                title: '（・о・；）',
                template: 'Que boquinha suja eim, usaste uma palavra inapropriada no seu apelido'
              }); 
      }else{
        if (error1 > 0) {  
          var alertPopup = $ionicPopup.alert({
                title: '（・о・；）',
                template: 'Que boquinha suja eim, usaste uma palavra inapropriada na sua BIO'
              }); 
        }else{ 
        $scope.cidade = autocomplete.getPlace();
        // if($scope.cidade){
        //   for(var i = 0;i<$scope.cidade.address_components.length;i++){
        //     if($scope.cidade.address_components[i].types[0] == "administrative_area_level_2"){
        //       $scope.user.cidade = $scope.cidade.address_components[i].long_name;
             
        //     }
        //   }
        // }
          EventoService.atualizarperfil($scope.user).then(function(msg){
            if(mudoufoto == true){
              var url = "https://ec2.diwoapp.com.br/upload.php";
                                          // File for Upload
              var targetPath2 = $scope.imgURI2;
              var mystring = String($scope.user.email);
              mystring = mystring.replace(/[^a-zA-Z0-9]/g, '');
              // File name only
              //var name = $scope.imgURI.substr(imageData.lastIndexOf('/') + 1);
              var filename = mystring + '.jpg';

              // NO CASO SERIA O NOME DO USUARIO.jpg O fileName
              var options = {
                fileKey: "file",
                fileName: filename,
                chunkedMode: false,
                mimeType: "multipart/form-data"
              };
              $cordovaFileTransfer.upload(url, targetPath2, options).then(function(result) {
                
                var alertPopup = $ionicPopup.alert({
                  title: 'Perfil Atualizado, obrigado',
                  template: msg
                });
                alertPopup.then(function(){
                  window.localStorage.setItem( 'user', JSON.stringify($scope.user));
                  formUser.updateForm($scope.user);
                  $state.go('tabsController.perfil');
                });
                
                $ionicLoading.hide();
              }, function(err) {
                $ionicPopup.alert({
                  title: 'Sorry!',
                  template: 'Aconteceu um probleminha, tente de novo'
                });
                $ionicLoading.hide();
              }, function (progress) {
                $ionicLoading.show({
                  title: '┗(＾0＾)┓',
                  template: 'Atualizando o perfil'
                });
              });
            }else{
              var alertPopup = $ionicPopup.alert({
                            title: 'Perfil Atualizado, obrigado',
                            template: msg
              });
              alertPopup.then(function(){
                window.localStorage.setItem( 'user', JSON.stringify($scope.user));
                formUser.updateForm($scope.user);
                $state.go('tabsController.perfil');
              }) 
            }
          }, function(errMsg) {
            var alertPopup = $ionicPopup.alert({
              title: 'Register failed!',
              template: errMsg
            });
            alertPopup.then(function(){
                      $state.go('logando');
            })
          })
        }
      }
    }

}])

.controller('editaperfilbairrocadastraCtrl', ['$scope', '$state', '$stateParams','$ionicPopup', '$ionicTabsDelegate','formUser','formMeusPost','formvimdofiltroperfil', 'formPost', 'EventoService', '$http', '$ionicPopup', 'formvimdopost', 'formOutro','formPost','formLimiteatuacao', '$cordovaCamera', '$cordovaFile', '$cordovaFileTransfer', '$cordovaDevice','$cordovaBarcodeScanner',  //nstructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $state, $stateParams,$ionicPopup,$ionicTabsDelegate, formUser,formMeusPost,formvimdofiltroperfil, formPost, EventoService, $http, $ionicPopup, formvimdopost, formOutro, formPost,formLimiteatuacao, $cordovaCamera, $cordovaFile, $cordovaFileTransfer, $cordovaDevice, $cordovaBarcodeScanner) {


  $scope.disableTap = function(){
     container = document.getElementsByClassName('pac-container');
     // disable ionic data tab
     angular.element(container).attr('data-tap-disabled', 'true');
     // leave input field if google-address-entry is selected
     angular.element(container).on("click", function(){
                                   document.getElementById('searchTextField').blur();
                                   });
  };
    
  var input = document.getElementById('searchTextField');
  var autocomplete = new google.maps.places.Autocomplete(input);
     
  $scope.cidade = autocomplete.getPlace();

  $scope.user =formUser.getForm();
  var geocoder = new google.maps.Geocoder();
  $scope.ValidarEndereco = function(){
   
    $scope.cidade = autocomplete.getPlace();
    if($scope.cidade){
      for(var i = 0;i<$scope.cidade.address_components.length;i++){
        //console.log($scope.cidade.address_components[i].types[0] , i , $scope.cidade.address_components[i].long_name)
        if($scope.cidade.address_components[i].types[0] == "administrative_area_level_1"){
          $scope.user.estadoendereco = $scope.cidade.address_components[i].short_name;
        }
        if($scope.cidade.address_components[i].types[0] == "administrative_area_level_2"){
          $scope.user.cidade = $scope.cidade.address_components[i].long_name;
        }
        if($scope.cidade.address_components[i].types[0] == "sublocality_level_1"){
          $scope.user.bairro = $scope.cidade.address_components[i].long_name;
        }
        if($scope.cidade.address_components[i].types[0] == "route"){
          $scope.user.endereco = $scope.cidade.address_components[i].long_name;
        }
        if($scope.cidade.address_components[i].types[0] == "postal_code"){
          $scope.user.cep = $scope.cidade.address_components[i].long_name;
          console.log($scope.user.cep, "scope.user.cep")
        }
        
        // if($scope.cidade.address_components[i].types[0] == "country"){
        //   $scope.user.pais = $scope.cidade.address_components[i].long_name;
        // }
      }
      if(i==$scope.cidade.address_components.length){
        var auxendereco =  $scope.user.endereco + ', '+ $scope.user.numeroendereco + ', '+$scope.user.cidade+ ', '+$scope.user.estadoendereco
       console.log(auxendereco, "auxendereco")
        geocoder.geocode({'address': auxendereco}, function(results, status) {
          if (status === 'OK') {
            if (results[0]) {
              
              console.log(results[0],"results[0]")
              $scope.cidade = results[0];
              for(var j = 0;j<$scope.cidade.address_components.length;j++){
                //console.log($scope.cidade.address_components[i].types[0] , i , $scope.cidade.address_components[i].long_name)
                if($scope.cidade.address_components[j].types[0] == "administrative_area_level_1"){
                  $scope.user.estadoendereco = $scope.cidade.address_components[j].short_name;
                }
                if($scope.cidade.address_components[j].types[0] == "administrative_area_level_2"){
                  $scope.user.cidade = $scope.cidade.address_components[j].long_name;
                }
                if($scope.cidade.address_components[j].types[0] == "sublocality_level_1"){
                  $scope.user.bairro = $scope.cidade.address_components[j].long_name;
                }
                if($scope.cidade.address_components[j].types[0] == "route"){
                  $scope.user.endereco = $scope.cidade.address_components[j].long_name;
                }
                if($scope.cidade.address_components[j].types[0] == "postal_code"){
                  $scope.user.cep = $scope.cidade.address_components[j].long_name;
                  //console.log($scope.user.cep, "scope.user.cep")
                }
              }
              var codigovalido = 0;
              var auxcodigo 
              if(j==$scope.cidade.address_components.length){
                EventoService.GetusersBairroLiberado($scope.user).then(function(resp){
                  if(resp!='E'&&resp!='Error'){
                    
                    $scope.auxusersbairro = resp;
                    console.log($scope.auxusersbairro.length)
                    for(var i = 0 ; i <resp.length ; i++){
                      console.log($scope.auxusersbairro[i].codigodevalidacaodebairro, "$scope.auxusersbairro[i].codigodevalidacaodebairro")
                      if($scope.auxusersbairro[i].enderecovalidado){
                        codigovalido++;
                        
                        console.log(codigovalido,"codigovalido++;")
                      }
                      if($scope.auxusersbairro[i].codigodevalidacaodebairro!=''){
                        auxcodigo = $scope.auxusersbairro[i].codigodevalidacaodebairro;
                      }
                    }
                    console.log(codigovalido,"codigovalido")
                    if(codigovalido>=20){
                      if(codigovalido%20==0){
                        $scope.aux = ($scope.user.iduser + $scope.user.cidade+ $scope.user.bairro + $scope.diadehj).toString();
                        var encrypted = CryptoJS.AES.encrypt($scope.aux, "Diwo bairro");
                        $scope.user.codigodevalidacaodebairro = encrypted.toString();
                        $scope.user.diapedebairro = $scope.diadehj; 
                        EventoService.atualizaendereco($scope.user).then(function(msg){
                          formUser.updateForm($scope.user);
                          window.localStorage.setItem( 'bairrook', 'naofoi');
                          $state.go('tabsController.bairrosolicitado')   
                        });
                      }else{
                        $scope.user.codigodevalidacaodebairro = $scope.auxusersbairro[codigovalido-20].codigodevalidacaodebairro; 
                        $scope.user.diapedebairro = $scope.diadehj; 
                        EventoService.atualizaendereco($scope.user).then(function(msg){
                          formUser.updateForm($scope.user);
                          window.localStorage.setItem( 'bairrook', 'naofoi');
                          $state.go('tabsController.bairrosolicitado')   
                        });
                      }
                    }else{
                      console.log($scope.auxusersbairro[0].codigodevalidacaodebairro,"$scope.auxusersbairro[0].codigodevalidacaodebairro")
                      
                      if($scope.auxusersbairro[0].codigodevalidacaodebairro!=''){
                        $scope.user.codigodevalidacaodebairro = $scope.auxusersbairro[0].codigodevalidacaodebairro
                      }else{
                        $scope.user.codigodevalidacaodebairro = auxcodigo;
                      }
                      $scope.user.diapedebairro = $scope.diadehj; 
                      EventoService.atualizaendereco($scope.user).then(function(msg){
                        formUser.updateForm($scope.user);
                        window.localStorage.setItem( 'bairrook', 'naofoi');
                        $state.go('tabsController.bairrosolicitado')   
                      });
                    }
                  }else{
                    $scope.aux = ($scope.user.iduser + $scope.user.cidade + $scope.user.bairro + $scope.diadehj).toString();
                    var encrypted = CryptoJS.AES.encrypt($scope.aux, "Diwo bairro");
                    console.log(encrypted.toString(),"encrypted")
                    //var dencrypted = CryptoJS.AES.decrypt(encrypted.toString(), "Diwo bairro");
                    //console.log(dencrypted.toString(),"dedas")
                    $scope.user.codigodevalidacaodebairro = encrypted.toString();
                    $scope.user.diapedebairro = $scope.diadehj; 
                    EventoService.atualizaendereco($scope.user).then(function(msg){
                      formUser.updateForm($scope.user);
                      window.localStorage.setItem( 'bairrook', 'naofoi');
                      $state.go('tabsController.bairrosolicitado')   
                    });
                    
                    //$scope.user.codigodevalidacaodebairro = $scope.user.codigodevalidacaodebairro.toString(CryptoJS.enc.Utf8);
                  }
                  //console.log( $scope.user.codigodevalidacaodebairro," $scope.user.codigodevalidacaodebairro")
                  
                })
              }
  
    
  
            } else {
              window.alert('No results found');
            }
          } else {
            window.alert('Geocoder failed due to: ' + status);
          }
        });
       
      }
    
      
        
      
    }
  }

}])


.controller('novacontainteresseEditaCtrl', ['$scope', '$stateParams', '$state', 'EventoService', '$cordovaCamera', '$cordovaFile', '$cordovaFileTransfer', '$cordovaDevice', '$ionicPopup', '$cordovaActionSheet','$ionicLoading','$http','formCodigo', 'formUser', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, $state, EventoService, $cordovaCamera, $cordovaFile, $cordovaFileTransfer, $cordovaDevice, $ionicPopup, $cordovaActionSheet,$ionicLoading,$http,formCodigo, formUser) {
  $scope.user = {};

  $scope.$on("$ionicView.enter", function(event, data){


    $scope.user = JSON.parse( window.localStorage.getItem( 'user' ));
    $scope.auxtagbutton1 = true;
    $scope.auxtagbutton2 = true;
    $scope.auxtagbutton3 = true;
    $scope.auxtagbutton4 = true;
    $scope.auxtagbutton5 = true;
    $scope.auxtagbutton6 = true;
    $scope.auxtagbutton7 = true;
    $scope.auxtagbutton8 = true;
    $scope.auxtagbutton9 = true;
    $scope.auxtagbutton10 = true;
    $scope.auxtagbutton11 = true;
    $scope.auxtagbutton12 = true;
    $scope.auxtagbutton13 = true;
    $scope.auxtagbutton14 = true;
    $scope.auxtagbutton15 = true;
    $scope.auxtagbutton16 = true;
    $scope.auxtagbutton17 = true;
    $scope.auxtagbutton18 = true;
    $scope.auxtagbutton1aux = false;
    $scope.auxtagbutton2aux = false;
    $scope.auxtagbutton3aux = false;
    $scope.auxtagbutton4aux = false;
    $scope.auxtagbutton5aux = false;
    $scope.auxtagbutton6aux = false;
    $scope.auxtagbutton7aux = false;
    $scope.auxtagbutton8aux = false;
    $scope.auxtagbutton9aux = false;
    $scope.auxtagbutton10aux = false;
    $scope.auxtagbutton11aux = false;
    $scope.auxtagbutton12aux = false;
    $scope.auxtagbutton13aux = false;
    $scope.auxtagbutton14aux = false;
    $scope.auxtagbutton15aux = false;
    $scope.auxtagbutton16aux = false;
    $scope.auxtagbutton17aux = false;
    $scope.auxtagbutton18aux = false;
    $scope.user.auxtag1 = 'Voluntariado';
    $scope.user.auxtag2 = 'Passeio'; 
    $scope.user.auxtag3 = 'Esportesdepraia'; 
    $scope.user.auxtag4 = 'Natureza'; 
    $scope.user.auxtag5 = 'Ciclismo';  
    $scope.user.auxtag6 = 'Futebol'; 
    $scope.user.auxtag7 = 'Corrida'; 
    $scope.user.auxtag8 = 'Dança'; 
    $scope.user.auxtag9 = 'Surf'; 
    $scope.user.auxtag10 = 'Música'; 
    $scope.user.auxtag11 = 'ArteeCultura'; 
    $scope.user.auxtag12 = 'Conversa'; 
    $scope.user.auxtag13 = 'Restaurante&Bares'; 
    $scope.user.auxtag14 = 'Festas'; 
    $scope.user.auxtag15 = 'Jogos'; 
    $scope.user.auxtag16 = 'GruposdeEstudos'; 
    $scope.user.auxtag17 = 'Pets'; 
    $scope.user.auxtag18 = 'Praia'; 
    EventoService.Getinteresseuser($scope.user.iduser).then(function(interesse) {
      
      for(var  i =0; i< interesse.length;i++){
        if(interesse[i].interesse =="#Voluntariado"){
          $scope.auxtagbutton1 = false;
          $scope.auxtagbutton1aux = true;
        }
        if(interesse[i].interesse =="#Passeio"){
          $scope.auxtagbutton2 = false;
          $scope.auxtagbutton2aux = true;
        }
        if(interesse[i].interesse =="#Esportesdepraia"){
          $scope.auxtagbutton3 = false;
          $scope.auxtagbutton3aux = true;
        }
        if(interesse[i].interesse =="#Natureza"){
          $scope.auxtagbutton4 = false;
        }
        if(interesse[i].interesse =="#Ciclismo"){
          $scope.auxtagbutton5 = false;
          $scope.auxtagbutton5aux = true;
        }
        if(interesse[i].interesse =="#Futebol"){
          $scope.auxtagbutton6 = false;
          $scope.auxtagbutton6aux = true;
        }
        if(interesse[i].interesse =="#Corrida"){
          $scope.auxtagbutton7 = false;
          $scope.auxtagbutton7aux = true;
        }
        if(interesse[i].interesse =="#Dança"){
          $scope.auxtagbutton8 = false;
          $scope.auxtagbutton8aux = true;
        }
        if(interesse[i].interesse =="#Surf"){
          $scope.auxtagbutton9 = false;
          $scope.auxtagbutton9aux = true;
        }
        if(interesse[i].interesse =="#Música"){
          $scope.auxtagbutton10 = false;
          $scope.auxtagbutton10aux = true;
        }
        if(interesse[i].interesse =="#ArteeCultura"){
          $scope.auxtagbutton11 = false;
          $scope.auxtagbutton11aux = true;
        }
        if(interesse[i].interesse =="#Conversa"){
          $scope.auxtagbutton12 = false;
          $scope.auxtagbutton12aux = true;
        }
        if(interesse[i].interesse =="#Restaurante&Bares"){
          $scope.auxtagbutton13 = false;
          $scope.auxtagbutton13aux = true;
        }
        if(interesse[i].interesse =="#Festas"){
          $scope.auxtagbutton14 = false;
          $scope.auxtagbutton14aux = true;
        }
        if(interesse[i].interesse =="#Jogos"){
          $scope.auxtagbutton15 = false;
          $scope.auxtagbutton15aux = true;
        }
        if(interesse[i].interesse =="#GruposdeEstudos"){
          $scope.auxtagbutton16 = false;
          $scope.auxtagbutton16aux = true;
        }
        if(interesse[i].interesse =="#Pets"){
          $scope.auxtagbutton17 = false;
          $scope.auxtagbutton17aux = true;
        }
        if(interesse[i].interesse =="#Praia"){
          $scope.auxtagbutton18 = false;
          $scope.auxtagbutton18aux = true;
        }
      }   
      
    });


    
    

  });
    $scope.tiratag1 = function(){
        if($scope.auxtagbutton1){
          $scope.auxtagbutton1 = false;
          $scope.auxtagbutton1aux = true;
        }else{
          $scope.auxtagbutton1 = true;
          $scope.auxtagbutton1aux = false;
        }
    }
    $scope.tiratag2 = function(){
        if($scope.auxtagbutton2){
          $scope.auxtagbutton2 = false;
          $scope.auxtagbutton2aux = true;
        }else{
          $scope.auxtagbutton2 = true;
          $scope.auxtagbutton2aux = false;
        }
    }
    $scope.tiratag3 = function(){
        if($scope.auxtagbutton3){
          $scope.auxtagbutton3 = false;
          $scope.auxtagbutton3aux = true;
        }else{
          $scope.auxtagbutton3 = true;
          $scope.auxtagbutton3aux = false;
        }
    }
    $scope.tiratag4 = function(){
        if($scope.auxtagbutton4){
          $scope.auxtagbutton4 = false;
          $scope.auxtagbutton4aux = true;
        }else{
          $scope.auxtagbutton4 = true;
          $scope.auxtagbutton4aux = false;
        }
    }
    $scope.tiratag5 = function(){
        if($scope.auxtagbutton5){
          $scope.auxtagbutton5 = false;
          $scope.auxtagbutton5aux = true;
        }else{
          $scope.auxtagbutton5 = true;
          $scope.auxtagbutton5aux = false;
        }
    }
    $scope.tiratag6 = function(){
        if($scope.auxtagbutton6){
          $scope.auxtagbutton6 = false;
          $scope.auxtagbutton6aux = true;
        }else{
          $scope.auxtagbutton6 = true;
          $scope.auxtagbutton6aux = false;
        }
    }

    $scope.tiratag7 = function(){
        if($scope.auxtagbutton7){
          $scope.auxtagbutton7 = false;
          $scope.auxtagbutton7aux = true;
        }else{
          $scope.auxtagbutton7 = true;
          $scope.auxtagbutton7aux = false;
        }
    }
    $scope.tiratag8 = function(){
        if($scope.auxtagbutton8){
          $scope.auxtagbutton8 = false;
          $scope.auxtagbutton8aux = true;
        }else{
          $scope.auxtagbutton8 = true;
          $scope.auxtagbutton8aux = false;
        }
    }
    $scope.tiratag9 = function(){
        if($scope.auxtagbutton9){
          $scope.auxtagbutton9 = false;
          $scope.auxtagbutton9aux = true;
        }else{
          $scope.auxtagbutton9 = true;
          $scope.auxtagbutton9aux = false;
        }
    }
    $scope.tiratag10 = function(){
        if($scope.auxtagbutton10){
          $scope.auxtagbutton10 = false;
          $scope.auxtagbutton10aux = true;
        }else{
          $scope.auxtagbutton10 = true;
          $scope.auxtagbutton10aux = false;
        }
    }
    $scope.tiratag11 = function(){
        if($scope.auxtagbutton11){
          $scope.auxtagbutton11 = false;
          $scope.auxtagbutton11aux = true;
        }else{
          $scope.auxtagbutton11 = true;
          $scope.auxtagbutton11aux = false;
        }
    }
    $scope.tiratag12 = function(){
        if($scope.auxtagbutton12){
          $scope.auxtagbutton12 = false;
          $scope.auxtagbutton12aux = true;
        }else{
          $scope.auxtagbutton12 = true;
          $scope.auxtagbutton12aux = false;
        }
    }
    $scope.tiratag13 = function(){
        if($scope.auxtagbutton13){
          $scope.auxtagbutton13 = false;
          $scope.auxtagbutton13aux = true;
        }else{
          $scope.auxtagbutton13 = true;
          $scope.auxtagbutton13aux = false;
        }
    }
    $scope.tiratag14 = function(){
        if($scope.auxtagbutton14){
          $scope.auxtagbutton14 = false;
          $scope.auxtagbutton14aux = true;
        }else{
          $scope.auxtagbutton14 = true;
          $scope.auxtagbutton14aux = false;
        }
    }
    $scope.tiratag15 = function(){
        if($scope.auxtagbutton15){
          $scope.auxtagbutton15 = false;
          $scope.auxtagbutton15aux = true;
        }else{
          $scope.auxtagbutton15 = true;
          $scope.auxtagbutton15aux = false;
        }
    }
    $scope.tiratag16 = function(){
        if($scope.auxtagbutton16){
          $scope.auxtagbutton16 = false;
          $scope.auxtagbutton16aux = true;
        }else{
          $scope.auxtagbutton16 = true;
          $scope.auxtagbutton16aux = false;
        }
    }
    $scope.tiratag17 = function(){
        if($scope.auxtagbutton17){
          $scope.auxtagbutton17 = false;
          $scope.auxtagbutton17aux = true;
        }else{
          $scope.auxtagbutton17 = true;
          $scope.auxtagbutton17aux = false;
        }
    }
    $scope.tiratag18 = function(){
        if($scope.auxtagbutton18){
          $scope.auxtagbutton18 = false;
          $scope.auxtagbutton18aux = true;
        }else{
          $scope.auxtagbutton18 = true;
          $scope.auxtagbutton18aux = false;
        }
    }

    
  $scope.Proximo = function() {
 
      if($scope.auxtagbutton1 == false){
        if ($scope.user.interesse == undefined) {
          $scope.user.interesse = $scope.user.auxtag1;
        }else{
          $scope.user.interesse = $scope.user.interesse + ' ' +$scope.user.auxtag1;
        }
      }
      if($scope.auxtagbutton2 == false){
        if ($scope.user.interesse == undefined) {
          $scope.user.interesse = $scope.user.auxtag2;
        }else{
          $scope.user.interesse = $scope.user.interesse + ' ' +$scope.user.auxtag2;
        }
      }
      if($scope.auxtagbutton3 == false){
        if ($scope.user.interesse == undefined) {
          $scope.user.interesse = $scope.user.auxtag3;
        }else{
          $scope.user.interesse = $scope.user.interesse + ' ' +$scope.user.auxtag3;
        }
      }
      if($scope.auxtagbutton4 == false){
        if ($scope.user.interesse == undefined) {
          $scope.user.interesse = $scope.user.auxtag4;
        }else{
          $scope.user.interesse = $scope.user.interesse + ' ' +$scope.user.auxtag4;
        }
      }
      if($scope.auxtagbutton5 == false){
        if ($scope.user.interesse == undefined) {
          $scope.user.interesse = $scope.user.auxtag5;
        }else{
          $scope.user.interesse = $scope.user.interesse + ' ' +$scope.user.auxtag5;
        }
      }
      if($scope.auxtagbutton6 == false){
        if ($scope.user.interesse == undefined) {
          $scope.user.interesse = $scope.user.auxtag6;
        }else{
          $scope.user.interesse = $scope.user.interesse + ' ' +$scope.user.auxtag6;
        }
      }
      if($scope.auxtagbutton7 == false){
        if ($scope.user.interesse == undefined) {
          $scope.user.interesse = $scope.user.auxtag7;
        }else{
          $scope.user.interesse = $scope.user.interesse + ' ' +$scope.user.auxtag7;
        }
      }
      if($scope.auxtagbutton8 == false){
        if ($scope.user.interesse == undefined) {
          $scope.user.interesse = $scope.user.auxtag8;
        }else{
          $scope.user.interesse = $scope.user.interesse + ' ' +$scope.user.auxtag8;
        }
      }
      if($scope.auxtagbutton9 == false){
        if ($scope.user.interesse == undefined) {
          $scope.user.interesse = $scope.user.auxtag9;
        }else{
          $scope.user.interesse = $scope.user.interesse + ' ' +$scope.user.auxtag9;
        }
      }
      if($scope.auxtagbutton10 == false){
        if ($scope.user.interesse == undefined) {
          $scope.user.interesse = $scope.user.auxtag10;
        }else{
          $scope.user.interesse = $scope.user.interesse + ' ' +$scope.user.auxtag10;
        }
      }
      if($scope.auxtagbutton11 == false){
        if ($scope.user.interesse == undefined) {
          $scope.user.interesse = $scope.user.auxtag11;
        }else{
          $scope.user.interesse = $scope.user.interesse + ' ' +$scope.user.auxtag11;
        }
      }
      if($scope.auxtagbutton12 == false){
        if ($scope.user.interesse == undefined) {
          $scope.user.interesse = $scope.user.auxtag12;
        }else{
          $scope.user.interesse = $scope.user.interesse + ' ' +$scope.user.auxtag12;
        }
      }
      if($scope.auxtagbutton13 == false){
        if ($scope.user.interesse == undefined) {
          $scope.user.interesse = $scope.user.auxtag13;
        }else{
          $scope.user.interesse = $scope.user.interesse + ' ' +$scope.user.auxtag13;
        }
      }
      if($scope.auxtagbutton14 == false){
        if ($scope.user.interesse == undefined) {
          $scope.user.interesse = $scope.user.auxtag14;
        }else{
          $scope.user.interesse = $scope.user.interesse + ' ' +$scope.user.auxtag14;
        }
      }
      if($scope.auxtagbutton15 == false){
        if ($scope.user.interesse == undefined) {
          $scope.user.interesse = $scope.user.auxtag15;
        }else{
          $scope.user.interesse = $scope.user.interesse + ' ' +$scope.user.auxtag15;
        }
      }
      if($scope.auxtagbutton16 == false){
        if ($scope.user.interesse == undefined) {
          $scope.user.interesse = $scope.user.auxtag16;
        }else{
          $scope.user.interesse = $scope.user.interesse + ' ' +$scope.user.auxtag16;
        }
      }
      if($scope.auxtagbutton17 == false){
        if ($scope.user.interesse == undefined) {
          $scope.user.interesse = $scope.user.auxtag17;
        }else{
          $scope.user.interesse = $scope.user.interesse + ' ' +$scope.user.auxtag17;
        }
      }
      if($scope.auxtagbutton18 == false){
        if ($scope.user.interesse == undefined) {
          $scope.user.interesse = $scope.user.auxtag18;
        }else{
          $scope.user.interesse = $scope.user.interesse + ' ' +$scope.user.auxtag18;
        }
      }
      if (!$scope.user.interesse) {
        var alertPopup = $ionicPopup.alert({
          title: '(⊙﹏⊙✿)',
          template: 'Selecione pelo menos um desses!'
        });
      }else{
        var link = 'https://ec2.diwoapp.com.br/deletainteresse.php';
        $http.post(link, {iduser : $scope.user.iduser}).then(function (res){
          console.log(res.success, "delete interesse");

            var res = $scope.user.interesse.split(" ") ;
            for (var i = 0; i<res.length;i++){
              if(res[i][0]!='#'){
                res[i]= '#' + res[i];
              }
              console.log(res[i], "tags")
              var link = 'https://ec2.diwoapp.com.br/criarinteresse.php';
                $http.post(link, {iduser : $scope.user.iduser, 
                                  interesse : res[i]}).then(function (res){console.log(
                                    res.success, "criou interesse")
                                });
            }
            window.localStorage.setItem( 'user', JSON.stringify($scope.user));
            formUser.updateForm($scope.user);
            $state.go('tabsController.editarPerfil');

        });
        
      }


            
  };


}])

.controller('criandoEventoPart1Ctrl', ['$scope', '$stateParams', 'formEventoCriar', '$state','$ionicPopup', '$timeout', 'formtela2', 'formUser', 'EventoService','formLimiteatuacao',  // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, formEventoCriar, $state, $ionicPopup, $timeout, formtela2, formUser, EventoService, formLimiteatuacao) {
  $scope.evento = {};
  $scope.evento.nomeevento = '';
  $scope.evento.duracao = '';
  $scope.evento.diainicio = '';
  $scope.evento.diafim = '';
  $scope.evento.dialimiteconfirmacao = '';
  $scope.evento.pmin  = 2;
  $scope.evento.patual = 0;
  $scope.evento.pmax = 16;
  $scope.evento.preco = '';
  $scope.evento.nomelocal = '';
  $scope.evento.endereco = '';
  $scope.evento.cidade = '';
  $scope.evento.lat = -26.9829029;
  $scope.evento.lng = -48.6340998;
  $scope.evento.dificuldade="Qual a dificuldade do evento?";
  $scope.evento.genero = "todos";
  $scope.evento.descricao = '';
  $scope.evento.tags = '';
  $scope.evento.addtag = '';
  $scope.auxdata = {};
  $scope.evento.dificuldaden = 1;
  $scope.evento.semana = 0;
  $scope.evento.precopor = 1; 
    $scope.evento.auxtag1 = '';
    $scope.evento.auxtag2 = '';
    $scope.evento.auxtag3 = '';
    $scope.evento.auxtagbutton1 = false;
    $scope.evento.auxtagbutton2 = false;
    $scope.evento.auxtagbutton3 = false;
    $scope.evento.auxtag4 = '';
    $scope.evento.auxtag5 = '';
    $scope.evento.auxtag6 = '';
    $scope.evento.auxtagbutton4 = false;
    $scope.evento.auxtagbutton5 = false;
    $scope.evento.auxtagbutton6 = false;
    $scope.evento.auxtag7 = '';
    $scope.evento.auxtag8 = '';
    $scope.evento.auxtag9 = '';
    $scope.evento.auxtagbutton7 = false;
    $scope.evento.auxtagbutton8 = false;
    $scope.evento.auxtagbutton9 = false;
  var somatag = 0;
  $scope.limiteatuacao = formLimiteatuacao.getForm();
  $scope.user = formUser.getForm();
  if(!$scope.user.genero){
      $state.go('idadegenero');
    }else{
      if($scope.user.genero == "fem"){
        $scope.femin = true;
      }else{
        $scope.femin = false;
      }
  }
  

  $scope.$on("$ionicView.enter", function(event, data){
    $scope.evento = {};
    $scope.evento.dificuldaden = 1;
    $scope.evento.nomeevento = '';
    $scope.evento.duracao = '';
    $scope.evento.diainicio = '';
    $scope.evento.diafim = '';
    $scope.evento.dialimiteconfirmacao = '';
    $scope.evento.pmin  = 0;
    $scope.evento.patual = 0;
    $scope.evento.pmax = 0;
    $scope.evento.preco = '';
    $scope.evento.nomelocal = '';
    $scope.evento.endereco = '';
    $scope.evento.cidade = '';
    $scope.evento.lat = -26.9829029;
    $scope.evento.lng = -48.6340998;
    $scope.evento.genero = "todos";
    $scope.evento.descricao = '';
    $scope.evento.redzone = "1";
    $scope.evento.addtag = '';
    $scope.evento.precopor = 1;
    $scope.evento.auxtag1 = '';
    $scope.evento.auxtag2 = '';
    $scope.evento.auxtag3 = '';
    $scope.evento.auxtagbutton1 = false;
    $scope.evento.auxtagbutton2 = false;
    $scope.evento.auxtagbutton3 = false;
    $scope.evento.auxtag4 = '';
    $scope.evento.auxtag5 = '';
    $scope.evento.auxtag6 = '';
    $scope.evento.auxtagbutton4 = false;
    $scope.evento.auxtagbutton5 = false;
    $scope.evento.auxtagbutton6 = false;
    $scope.evento.auxtag7 = '';
    $scope.evento.auxtag8 = '';
    $scope.evento.auxtag9 = '';
    $scope.evento.auxtagbutton7 = false;
    $scope.evento.auxtagbutton8 = false;
    $scope.evento.auxtagbutton9 = false;
    $scope.limiteatuacao = formLimiteatuacao.getForm();
    var somatag = 0;
    formtela2.updateForm(0);
    $scope.evento.dificuldade="Qual a dificuldade do evento?";
    EventoService.verificahorariopessoaevento($scope.user).then(function(items) {
      $scope.auxdata = items;
    }); 
    if(!$scope.user.genero){
      $state.go('idadegenero');
    }
  });

  var header = document.getElementById("barpor");
  var btns = header.getElementsByClassName("btnpor");
  for (var i = 0; i < btns.length; i++) {
    btns[i].addEventListener("click", function() {
      var current = document.getElementsByClassName("actr");
      current[0].className = current[0].className.replace(" actr", "");
      this.className += " actr";
    });
  }

  $scope.pessoa = function() {$scope.evento.precopor = 1;};
  $scope.hora = function() {$scope.evento.precopor = 2;};

  $scope.duvida = function() {var alertPopup = $ionicPopup.alert({
                      title: 'Para ver se vai rolar ou não',
                      template: 'Uma vez que chega na data limite de confirmação, caso o evento não atinja o número mínimo de pessoas, o evento será cancelado automaticamente.'
                    });};
  $scope.duvida2 = function() {var alertPopup = $ionicPopup.alert({
                      title: 'Cobrar como?',
                      template: 'Em alguns casos como quadras é cobrado por hora e em outros é cobrado por pessoa, então é melhor deixar avisado certinho né.'
                    });};
  $scope.duvida3= function() {var alertPopup = $ionicPopup.alert({
                      title: 'Respeito ao gênero',
                      template: 'O evento não aparecerá para pessoas que não forem do gênero selecionado'
                    });};
   $scope.duvida4= function() {var alertPopup = $ionicPopup.alert({
                      title: 'Pra que serve essas hashtags?',
                      template: 'Fica mais fácil para outras pessoas acharem seu evento pelas tags.'
                    });};

  var currentdate = new Date(); 
  var curr_date2 = (currentdate.getDate()<10?'0':'') + currentdate.getDate();
  var curr_month2 = (currentdate.getMonth()<10?'0':'') + (currentdate.getMonth() + 1); //Months are zero based
  var curr_year2 = currentdate.getFullYear();
  var h22 = (currentdate.getHours()<10?'0':'') + currentdate.getHours();
  var m22 = (currentdate.getMinutes()<10?'0':'') + currentdate.getMinutes();

  var curr_date
  var h2
  var m2 
  var curr_month
  var s2
  var curr_year
  var datainvalida = 0;

  var curr_date4;
  var curr_date5;
  var h4
  var m4 
  var curr_month4;
  var curr_month5;
  var s4
  var curr_year4
  var curr_year5;

  var ano;
  var mes ;
  var dia;
  var h;
  var m;
  var diainiciodoevento = new Date();

  $scope.evento.genero = "todos";
  $scope.evento.redzone = "1";

  $scope.ch = function(){
    if($scope.evento.dificuldaden == 1){
      $scope.evento.dificuldade = "Não importa";
    }
    if($scope.evento.dificuldaden == 2){
      $scope.evento.dificuldade = "Fácil";
    }
    if($scope.evento.dificuldaden == 3){
      $scope.evento.dificuldade = "Moderado";
    }
    if($scope.evento.dificuldaden == 4){
      $scope.evento.dificuldade = "Difícil";
    }
  }

  $scope.muda = function(){
          curr_date = ($scope.evento.date.getDate()<10?'0':'') + $scope.evento.date.getDate();
          curr_month = ($scope.evento.date.getMonth()<9?'0':'') + ($scope.evento.date.getMonth() + 1); //Months are zero based
          curr_year = $scope.evento.date.getFullYear();
          h2 = ($scope.evento.date.getHours()<10?'0':'') + $scope.evento.date.getHours();
          m2 = ($scope.evento.date.getMinutes()<10?'0':'') + $scope.evento.date.getMinutes();
          s2 = ($scope.evento.date.getSeconds()<10?'0':'') + $scope.evento.date.getSeconds();
          $scope.evento.semana = $scope.evento.date.getDay();
          var j = curr_year + "-" + curr_month + "-" + curr_date+ ' '+h2 + ':' + m2 + ':' + s2;
          
          $scope.evento.diainicio = j;
          diainiciodoevento = $scope.evento.date;
          datainvalida = 0;
          ano = curr_year-curr_year2;
          mes = curr_month-curr_month2;
          dia = curr_date-curr_date2;
          h = h2-h22;
          m = m2-m22;
          
              if(ano<0){
                 var alertPopup = $ionicPopup.alert({
                    title: 'Falha na data!!',
                    template: 'Coloque uma data valida s`il vous plait'
                  });
                 $scope.evento.date = '';
                console.log('data invalida');
              }else{
                if (ano == 0) {
                  if(mes<0){
                    var alertPopup = $ionicPopup.alert({
                      title: 'Falha na data!!',
                      template: 'Coloque uma data valida s`il vous plait'
                    });
                    $scope.evento.date = '';
                    console.log('data invalida');
                  }else{
                    if (mes==0) {
                      if(dia<0){
                        var alertPopup = $ionicPopup.alert({
                        title: 'Falha na data!!',
                        template: 'Coloque uma data valida s`il vous plait'
                      });
                        $scope.evento.date = '';
                        console.log('data invalida');
                      }else{
                        if (dia==0 && h<3){
                          var alertPopup = $ionicPopup.alert({
                            title: 'ヽ ( ꒪д꒪ )ﾉ',
                            template: 'Muito em cima da hora para criar um evento, no mínimo umas 3 horas de antecedência'
                          });
                          console.log('data invalida');
                          $scope.evento.date = '';
                        }else{
                          $scope.evento.date = $scope.evento.date.toLocaleString();

                        }
                      }
                    }
                  }
                }
              }
  }

  $scope.red = function(){
    if(ano==0 && mes == 0 && (dia == 0 && $scope.evento.redzone >= h) || (dia == 1 && $scope.evento.redzone >= h+24)){
      console.log($scope.evento.redzone)
      var alertPopup = $ionicPopup.alert({
        title: 'ლ(ﾟдﾟლ)',
        template: 'A hora limite para confirmação ja passou de agora, ninguem vai conseguir confirmar ida. Selecione um horario válido'
      });
      $scope.evento.redzone = "1";
    }
  }

  var auxauxtagbut = false;
  $scope.adicionatag = function(){
    if($scope.evento.addtag!=''){
      var res2 = $scope.evento.addtag.split(" ") ;
        if(res2.length>1){
          for(var w = 0; w < res2.length; w++){
            var t = res2[w].toLowerCase();
           console.log(t)
          }
          $scope.evento.addtag = res2[0];
        }
      if(!auxauxtagbut){
        auxauxtagbut = true;
        if($scope.evento.auxtagbutton1 == false && auxauxtagbut){
          $scope.evento.auxtag1 = '#' +$scope.evento.addtag;
          $scope.evento.auxtagbutton1 = true;
          auxauxtagbut = false;
        }
        if($scope.evento.auxtagbutton2 == false && auxauxtagbut){
          $scope.evento.auxtag2 = '#' +$scope.evento.addtag;
          $scope.evento.auxtagbutton2 = true;
          auxauxtagbut = false;
        }
        if($scope.evento.auxtagbutton3 == false && auxauxtagbut){
          $scope.evento.auxtag3 = '#' +$scope.evento.addtag;
          $scope.evento.auxtagbutton3 = true;
          auxauxtagbut = false;
        }
        if($scope.evento.auxtagbutton4 == false && auxauxtagbut){
          $scope.evento.auxtag4 = '#' +$scope.evento.addtag;
          $scope.evento.auxtagbutton4 = true;
          auxauxtagbut = false;
        }
        if($scope.evento.auxtagbutton5 == false && auxauxtagbut){
          $scope.evento.auxtag5 = '#' +$scope.evento.addtag;
          $scope.evento.auxtagbutton5 = true;
          auxauxtagbut = false;
        }
        if($scope.evento.auxtagbutton6 == false && auxauxtagbut){
          $scope.evento.auxtag6 = '#' +$scope.evento.addtag;
          $scope.evento.auxtagbutton6 = true;
          auxauxtagbut = false;
        }
        if($scope.evento.auxtagbutton7 == false && auxauxtagbut){
          $scope.evento.auxtag7 = '#' +$scope.evento.addtag;
          $scope.evento.auxtagbutton7 = true;
          auxauxtagbut = false;
        }
        if($scope.evento.auxtagbutton8 == false && auxauxtagbut){
          $scope.evento.auxtag8 = '#' +$scope.evento.addtag;
          $scope.evento.auxtagbutton8 = true;
          auxauxtagbut = false;
        }
        if($scope.evento.auxtagbutton9 == false && auxauxtagbut){
          $scope.evento.auxtag9 = '#' +$scope.evento.addtag;
          $scope.evento.auxtagbutton9 = true;
          auxauxtagbut = false;
        }
      }
    }
    $scope.evento.addtag = '';
  }

  $scope.tiratag1 = function(){
      $scope.evento.auxtagbutton1 = false;
      $scope.evento.auxtag1 = '';
  }
  $scope.tiratag2 = function(){
      $scope.evento.auxtagbutton2 = false;
      $scope.evento.auxtag2 = '';
  }
  $scope.tiratag3 = function(){
      $scope.evento.auxtagbutton3 = false;
      $scope.evento.auxtag3 = '';
  }
  $scope.tiratag4 = function(){
      $scope.evento.auxtagbutton4 = false;
      $scope.evento.auxtag4 = '';
  }
  $scope.tiratag5 = function(){
      $scope.evento.auxtagbutton5 = false;
      $scope.evento.auxtag5 = '';
  }
  $scope.tiratag6 = function(){
      $scope.evento.auxtagbutton6 = false;
      $scope.evento.auxtag6 = '';
  }
  $scope.tiratag7 = function(){
      $scope.evento.auxtagbutton7 = false;
      $scope.evento.auxtag7 = '';
  }
  $scope.tiratag8 = function(){
      $scope.evento.auxtagbutton8 = false;
      $scope.evento.auxtag8 = '';
  }
  $scope.tiratag9 = function(){
      $scope.evento.auxtagbutton9 = false;
      $scope.evento.auxtag9 = '';
  }
  
  $scope.getCriar = function(evento) {
     if($scope.evento.auxtagbutton1 == true){
        if ($scope.evento.tags == undefined) {
          $scope.evento.tags = $scope.evento.auxtag1;
        }else{
          $scope.evento.tags = $scope.evento.tags + ' ' +$scope.evento.auxtag1;
        }
      }
      if($scope.evento.auxtagbutton2 == true){
        if ($scope.evento.tags == undefined) {
          $scope.evento.tags = $scope.evento.auxtag2;
        }else{
          $scope.evento.tags = $scope.evento.tags + ' ' +$scope.evento.auxtag2;
        }
      }
      if($scope.evento.auxtagbutton3 == true){
        if ($scope.evento.tags == undefined) {
          $scope.evento.tags = $scope.evento.auxtag3;
        }else{
        $scope.evento.tags = $scope.evento.tags + ' ' +$scope.evento.auxtag3;
        }
      }
      if($scope.evento.auxtagbutton4 == true){
        if ($scope.evento.tags == undefined) {
          $scope.evento.tags = $scope.evento.auxtag4;
        }else{
          $scope.evento.tags = $scope.evento.tags + ' ' +$scope.evento.auxtag4;
        }
      }
      if($scope.evento.auxtagbutton5 == true){
        if ($scope.evento.tags == undefined) {
          $scope.evento.tags = $scope.evento.auxtag5;
        }else{
          $scope.evento.tags = $scope.evento.tags + ' ' +$scope.evento.auxtag5;
        }
      }
      if($scope.evento.auxtagbutton6 == true){
        if ($scope.evento.tags == undefined) {
          $scope.evento.tags = $scope.evento.auxtag6;
        }else{
          $scope.evento.tags = $scope.evento.tags + ' ' +$scope.evento.auxtag6;
        }
      }
      if($scope.evento.auxtagbutton7 == true){
        if ($scope.evento.tags == undefined) {
          $scope.evento.tags = $scope.evento.auxtag7;
        }else{
          $scope.evento.tags = $scope.evento.tags + ' ' +$scope.evento.auxtag7;
        }
      }
      if($scope.evento.auxtagbutton8 == true){
        if ($scope.evento.tags == undefined) {
          $scope.evento.tags = $scope.evento.auxtauxtag8ag2;
        }else{
          $scope.evento.tags = $scope.evento.tags + ' ' +$scope.evento.auxtag8;
        }
      }
      if($scope.evento.auxtagbutton9 == true ){
        if ($scope.evento.tags == undefined) {
          $scope.evento.tags = $scope.evento.auxtag9;
        }else{
          $scope.evento.tags = $scope.evento.tags + ' ' +$scope.evento.auxtag9;
        }
      }

    if (!$scope.evento.tags) {
      var alertPopup = $ionicPopup.alert({
        title: '(⊙﹏⊙✿)',
        template: 'Coloque pelo menos uma tag para facilitar a procura do seu evento'
      });
    }else{
      $scope.test = formtela2.getForm();
    //console.log($scope.evento.duracao res);
    //$scope.evento.duracao= $scope.evento.duracao.toLocaleString().replace(/:\d+ /, ' ');
    //console.log($scope.evento.duracao);
    // console.log($scope.evento.data);
    // console.log($scope.evento.duracao);
    // console.log($scope.evento.horas);
      if (!$scope.evento.preco) {$scope.evento.preco=0}
      if($scope.evento.dificuldaden == 1){
        $scope.evento.dificuldade = "Não importa";
      }
      if (!$scope.evento.duracao || !$scope.evento.date ) {
        var alertPopup = $ionicPopup.alert({
          title: '( ͒ ́ඉ .̫ ඉ ̀ ͒)',
          template: 'Preciso saber a data e/ou duração do evento'
        });

         }else{
              if($scope.evento.semana == 0){
                $scope.evento.semana = "Domingo";
              }
              if($scope.evento.semana == 1){
                $scope.evento.semana = "Segunda-feira";
              }
              if($scope.evento.semana == 2){
                $scope.evento.semana = "Terça-feira";
              }
              if($scope.evento.semana == 3){
                $scope.evento.semana = "Quarta-feira";
              }
              if($scope.evento.semana == 4){
                $scope.evento.semana = "Quinta-feira";
              }
              if($scope.evento.semana == 5){
                $scope.evento.semana = "Sexta-feira";
              }
              if($scope.evento.semana == 6){
                $scope.evento.semana = "Sábado";
              }

              var h = ($scope.evento.duracao.getHours()<10?'0':'') + $scope.evento.duracao.getHours();
              var m = ($scope.evento.duracao.getMinutes()<10?'0':'') + $scope.evento.duracao.getMinutes();
              var i = h + ':' + m;
              var diafimeventodate; 
              var diafimeventomonth;
              var diafimeventoyear;
              var fimfim;
              $scope.evento.duracao = i;
              var horapositiva = parseFloat(h)-parseFloat(h2);
              var minutopositiva = parseFloat(m)-parseFloat(m2);
              if(horapositiva<0){
                var diafimevento = new Date();
                diafimevento.setDate(diainiciodoevento.getDate() + 1);
                diafimeventodate = (diafimevento.getDate()<10?'0':'') + diafimevento.getDate();
                diafimeventomonth = (diafimevento.getMonth()<10?'0':'') + (diafimevento.getMonth() + 1); //Months are zero based
                diafimeventoyear = diafimevento.getFullYear();
                fimfim = diafimeventoyear + "-" + diafimeventomonth + "-" + diafimeventodate+ ' '+h + ':' + m;
                $scope.evento.diafim = fimfim;
              }else{
                if(horapositiva == 0 && minutopositiva<0 ){
                  var diafimevento = new Date();
                  diafimevento.setDate(diainiciodoevento.getDate() + 1);
                  diafimeventodate = (diafimevento.getDate()<10?'0':'') + diafimevento.getDate();
                  diafimeventomonth = (diafimevento.getMonth()<10?'0':'') + (diafimevento.getMonth() + 1); //Months are zero based
                  diafimeventoyear = diafimevento.getFullYear();
                  fimfim = diafimeventoyear + "-" + diafimeventomonth + "-" + diafimeventodate+ ' '+h + ':' + m;
                  $scope.evento.diafim = fimfim;
                }else{
                  $scope.evento.diafim = curr_year + "-" + curr_month + "-" + curr_date+ ' '+h + ':' + m;
                }
              }
              var we = curr_year + "-" + curr_month + "-" + curr_date+ ' '+h2 + ':' + m2 + ':' + s2;


            curr_year5 = curr_year;
            curr_date5 = curr_date;
            curr_month5 = curr_month;
            h4 = parseFloat(h2)-parseFloat($scope.evento.redzone);
            //console.log(h4)
            if(h4<0){
              h4 = h4.valueOf()+24;
              curr_date5 = parseFloat(curr_date)-1;
              if(curr_date5<1){
                curr_month5 = parseFloat(curr_month)-1;
                if(curr_month5==1||curr_month5==3||curr_month5==5||curr_month5==7||curr_month5==8||curr_month5==10||curr_month5==12){
                  curr_date5 = curr_date5.valueOf()+31;
                }
                if(curr_month5==4||curr_month5==6||curr_month5==9||curr_month5==11){
                  curr_date5 = curr_date5.valueOf()+30;
                }
                if(curr_month5==2){
                  curr_date5 = curr_date5.valueOf()+28;
                }
                if(curr_month5<1){
                  curr_year5 = parseFloat(curr_year)-1;
                }
              }
            }
            if(h4 == 0){
              curr_date5 = parseFloat(curr_date5)-1;
              if(curr_date5<1){
                curr_month5 = parseFloat(curr_month5)-1;
                if(curr_month5==1||curr_month5==3||curr_month5==5||curr_month5==7||curr_month5==8||curr_month5==10||curr_month5==12){
                  curr_date5 = curr_date5.valueOf()+31;
                }
                if(curr_month5==4||curr_month5==6||curr_month5==9||curr_month5==11){
                  curr_date5 = curr_date5.valueOf()+30;
                }
                if(curr_month5==2){
                  curr_date5 = curr_date5.valueOf()+28;
                }
                if(curr_month5<1){
                  curr_year5 = parseFloat(curr_year5)-1;
                }
              }
            }
            h4 = (h4<10?'0':'')+h4;
            curr_date5 = (parseFloat(curr_date5)<10?'0':'')+parseFloat(curr_date5);
            curr_month5 = (parseFloat(curr_month5)<9?'0':'')+parseFloat(curr_month5);
            var j = curr_year5 + "-" + curr_month5 + "-" + curr_date5+ ' '+h4 + ':' + m2 + ':' + s2;
            
            $scope.evento.dialimiteconfirmacao = j;
            console.log($scope.evento.diafim ,  $scope.evento.dialimiteconfirmacao);
              
              for(var r = 0;r<$scope.auxdata.length; r++){
                console.log($scope.auxdata[r].idevento, $scope.auxdata[r].diainicio, $scope.auxdata[r].diafim , we ,$scope.evento.diafim);
                if (($scope.auxdata[r].diainicio < we && $scope.auxdata[r].diafim > we) || ($scope.auxdata[r].diainicio<$scope.evento.diafim && $scope.auxdata[r].diafim>$scope.evento.diafim) ||($scope.auxdata[r].diainicio > we && $scope.auxdata[r].diafim<$scope.evento.diafim) || ($scope.auxdata[r].diainicio < we && $scope.auxdata[r].diafim>$scope.evento.diafim) ) {
                  console.log('horario invalido');
                  datainvalida = 1;
                }
              }
             //console.log (datainvalida , r)
              ///        ╭∩╮(︶‿︶)╭∩╮
            if(datainvalida == 0 && r==$scope.auxdata.length){
              // $scope.evento.date = $scope.evento.date.toDateString("yyyy-MM-dd HH:mm");
              // $scope.evento.diafim = $scope.evento.diafim.toDateString("yyyy-MM-dd HH:mm");
               formEventoCriar.updateForm($scope.evento);
               //console.log($scope.evento.duracao);
              // console.log($scope.evento.date);
               $state.go('tabsController.criandoEventoPart2');
            }
            if(datainvalida ==1){
              var alertPopup = $ionicPopup.alert({
                    title: 'Oww!!',
                    template: 'Tu ja tem um evento marcado nesse horário :/'
                  });
            }
          

          }
        }
    }

}])
     
.controller('criandoEventoPart2Ctrl', ['$scope', '$stateParams', '$cordovaGeolocation', '$state', '$ionicLoading', 'formEventoCriar', '$ionicPopup',  // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, $cordovaGeolocation, $state, $ionicLoading, formEventoCriar, $ionicPopup) {
  $scope.evento = formEventoCriar.getForm();
  $scope.evento.nomelocal = 'Casa do Igor';
  $scope.evento.endereco = 'Secreto';
  $scope.evento.cidade = 'Balneário Camboriú';
  $scope.evento.lat = -26.9829029;
  $scope.evento.lng = -48.6340998;
  $scope.centerPoint={};
  $scope.centerPointFB={};
  $scope.LimiteFuncionamentoDiwo = false;
  $scope.LimiteFuncionamentoDiwoFB = false;
  $scope.disableTap = function(){
     container = document.getElementsByClassName('pac-container');
     // disable ionic data tab
     angular.element(container).attr('data-tap-disabled', 'true');
     // leave input field if google-address-entry is selected
     angular.element(container).on("click", function(){
                                   document.getElementById('pac-input').blur();
                                   });
     };

  $scope.$on("$ionicView.enter", function(event, data){
    $scope.evento = formEventoCriar.getForm();
    $scope.centerPoint={};
    $scope.LimiteFuncionamentoDiwo = false;
    navigator.geolocation.getCurrentPosition(function(position){
            var lat  = position.coords.latitude;
            var long = position.coords.longitude;
            var myLatlng = new google.maps.LatLng(lat, long);
            var mapOptions = {
                center: myLatlng,
                zoom: 16,
                mapTypeId: google.maps.MapTypeId.ROADMAP
            };          
            var map = new google.maps.Map(document.getElementById("map_canvas"), mapOptions); 
            var marker = new google.maps.Marker({
                      position: new google.maps.LatLng(position.coords.latitude, position.coords.longitude),
                      map: map,
                      title: "Borai",
                      draggable: true,
                      icon: 'http://maps.google.com/mapfiles/ms/icons/green-dot.png',
                      animation: google.maps.Animation.DROP 
                  })

            var geocoder = new google.maps.Geocoder;
            var infowindow = new google.maps.InfoWindow({maxWidth: 200});

            geocoder.geocode({'location': myLatlng}, function(results, status) {
                  if (status === 'OK') {
                    if (results[1]) {
                      $scope.evento.nomelocal = results[0].address_components[0].long_name;
                      $scope.evento.endereco = results[0].formatted_address;
                      for(var i = 0;i<results[0].address_components.length;i++){
                        if(results[0].address_components[i].types[0] == "administrative_area_level_2"){
                          $scope.evento.cidade = results[0].address_components[i].long_name;
                          console.log($scope.evento.cidade)
                        }
                      }
                      //$scope.evento.cidade = results[0].address_components[4].long_name;
                      $scope.evento.lat = position.coords.latitude;
                      $scope.evento.lng = position.coords.longitude;
                      $scope.centerPoint.lat = -26.997799;
                      $scope.centerPoint.lng = -48.632733; 
                      // $scope.centerPoint.lat = -25.473466587692343;
                      // $scope.centerPoint.lng = -49.29164589792566;
                      $scope.centerPointKM = 30;
                      $scope.LimiteFuncionamentoDiwo = arePointsNear($scope.evento, $scope.centerPoint,$scope.centerPointKM );
                      $scope.centerPointKMFB = 2500;
                      $scope.centerPointFB.lat = 39.1882887948499;
                      $scope.centerPointFB.lng = -100.07746794288232;
                      $scope.LimiteFuncionamentoDiwoFB = arePointsNear($scope.user, $scope.centerPointFB,$scope.centerPointKMFB );
                      
                      if($scope.LimiteFuncionamentoDiwoFB){
                        $scope.LimiteFuncionamentoDiwo = true;
                      }
                      infowindow.setContent(results[0].formatted_address);
                      console.log($scope.evento.endereco);
                      console.log($scope.evento.cidade);
                      console.log($scope.evento.lng);
                      console.log($scope.evento.lat);
                      //infowindow.setContent(results[0].address_components[2].long_name);
                      infowindow.open(map, marker);
                      setTimeout(function () { infowindow.close(); }, 5000);
                    } else {
                      window.alert('No results found');
                    }
                  } else {
                    window.alert('Geocoder failed due to: ' + status);
                  }
                });


            google.maps.event.addListener(marker, "dragstart", function (event) {
               marker.setAnimation(3); // raise
            });

            google.maps.event.addListener(marker, "dragend", function (event) {
               marker.setAnimation(4); // raise
            });

            marker.addListener('dragend', handleEvent);

            google.maps.event.addListener(map, 'click', function(e) {
                
                markers.forEach(function(marker) {
                marker.setMap(null);
                });
                markers = [];

                placeMarker(e.latLng, map, marker);

            });

            function placeMarker(latlng, map, marker) {
                marker.setPosition(latlng);
                marker.setMap(map);
                map.panTo(latlng);
                $scope.evento.lat = latlng.lat();
                $scope.evento.lng = latlng.lng();

                $scope.centerPoint.lat = -26.997799;
                $scope.centerPoint.lng = -48.632733; 
                // $scope.centerPoint.lat = -25.473466587692343;
                // $scope.centerPoint.lng = -49.29164589792566;
                $scope.centerPointKM = 30;
                $scope.LimiteFuncionamentoDiwo = arePointsNear($scope.evento, $scope.centerPoint,$scope.centerPointKM );
                      $scope.centerPointKMFB = 2500;
                      $scope.centerPointFB.lat = 39.1882887948499;
                      $scope.centerPointFB.lng = -100.07746794288232;
                      $scope.LimiteFuncionamentoDiwoFB = arePointsNear($scope.user, $scope.centerPointFB,$scope.centerPointKMFB );
                      
                      if($scope.LimiteFuncionamentoDiwoFB){
                        $scope.LimiteFuncionamentoDiwo = true;
                      }
                geocoder.geocode({'location': latlng}, function(results, status) {
                  if (status === 'OK') {
                    if (results[1]) {
                      $scope.evento.nomelocal = results[0].address_components[0].long_name;
                      for(var i = 0;i<results[0].address_components.length;i++){
                        if(results[0].address_components[i].types[0] == "administrative_area_level_2"){
                          $scope.evento.cidade = results[0].address_components[i].long_name;
                          console.log($scope.evento.cidade)
                        }
                      }
                      //$scope.evento.cidade = results[0].address_components[4].long_name;
                      $scope.evento.endereco = results[0].formatted_address;
                      console.log($scope.evento.endereco);
                      console.log($scope.evento.cidade);
                      console.log($scope.evento.lng);
                      console.log($scope.evento.lat);
                      infowindow.setContent(results[0].formatted_address);
                     
                      infowindow.open(map, marker);
                      setTimeout(function () { infowindow.close(); }, 5000);
                    } else {
                      window.alert('No results found');
                    }
                  } else {
                    window.alert('Geocoder failed due to: ' + status);
                  }
                });
            };

            function arePointsNear(checkPoint, centerPoint, km) {
                  var ky = 40000 / 360;
                  var kx = Math.cos(Math.PI * centerPoint.lat / 180.0) * ky;
                  var dx = Math.abs(centerPoint.lng - $scope.evento.lng) * kx;
                  var dy = Math.abs(centerPoint.lat - $scope.evento.lat) * ky;
                  return Math.sqrt(dx * dx + dy * dy) <= km;
                }    

            function handleEvent(event) {
                $scope.evento.lat = event.latLng.lat();
                $scope.evento.lng = event.latLng.lng();
                $scope.centerPoint.lat = -26.997799;
                $scope.centerPoint.lng = -48.632733; 
                // $scope.centerPoint.lat = -25.473466587692343;
                // $scope.centerPoint.lng = -49.29164589792566;
                $scope.centerPointKM = 30;
                $scope.LimiteFuncionamentoDiwo = arePointsNear($scope.evento, $scope.centerPoint,$scope.centerPointKM );
                $scope.centerPointKMFB = 2500;
                      $scope.centerPointFB.lat = 39.1882887948499;
                      $scope.centerPointFB.lng = -100.07746794288232;
                      $scope.LimiteFuncionamentoDiwoFB = arePointsNear($scope.user, $scope.centerPointFB,$scope.centerPointKMFB );
                      
                      if($scope.LimiteFuncionamentoDiwoFB){
                        $scope.LimiteFuncionamentoDiwo = true;
                      }
                              // GEOCODER INVERSO

                var geocoder = new google.maps.Geocoder;
                var infowindow = new google.maps.InfoWindow({
                                                              maxWidth: 200
                                                            });;    
            
                geocoder.geocode({'location': event.latLng}, function(results, status) {
                  if (status === 'OK') {
                    if (results[1]) {
                      $scope.evento.nomelocal = results[0].address_components[0].long_name;
                      for(var i = 0;i<results[0].address_components.length;i++){
                        if(results[0].address_components[i].types[0] == "administrative_area_level_2"){
                          $scope.evento.cidade = results[0].address_components[i].long_name;
                          console.log($scope.evento.cidade)
                        }
                      }
                      //$scope.evento.cidade = results[0].address_components[4].long_name;
                      $scope.evento.endereco = results[0].formatted_address;
                      // console.log($scope.evento.endereco);
                      // console.log($scope.evento.cidade);
                      console.log($scope.evento.lng);
                      console.log($scope.evento.lat);
                      infowindow.setContent(results[0].formatted_address);
                     
                      infowindow.open(map, marker);
                      setTimeout(function () { infowindow.close(); }, 5000);
                    } else {
                      window.alert('No results found');
                    }
                  } else {
                    window.alert('Geocoder failed due to: ' + status);
                  }
                });
            }
            var input = document.getElementById('pac-input');
            var searchBox = new google.maps.places.SearchBox(input);
            map.addListener('bounds_changed', function() {
                searchBox.setBounds(map.getBounds());
            });
            var markers = [];
            searchBox.addListener('places_changed', function() {
                var places = searchBox.getPlaces();

                if (places.length == 0) {
                  return;
                }

                // Clear out the old markers.
                markers.forEach(function(marker) {
                  marker.setMap(null);
                });
                markers = [];

                // For each place, get the icon, name and location.
                var bounds = new google.maps.LatLngBounds();
                places.forEach(function(place) {
                  if (!place.geometry) {
                    console.log("Returned place contains no geometry");
                    return;
                  }
                  // var icon = {
                  //   url: place.icon,
                  //   size: new google.maps.Size(71, 71),
                  //   origin: new google.maps.Point(0, 0),
                  //   anchor: new google.maps.Point(17, 34),
                  //   scaledSize: new google.maps.Size(25, 25)
                  // };

                  // Create a marker for each place.
                  markers.push(new google.maps.Marker({
                    map: map,
                    // icon: icon,
                    title: place.name,
                    position: place.geometry.location
                  }));

                  $scope.evento.nomelocal = place.name;
                  $scope.evento.endereco = place.formatted_address;
             
                  for(var i = 0;i<place.address_components.length;i++){
                    //console.log(place.address_components[i].types[0])
                    if(place.address_components[i].types[0] == "administrative_area_level_2"){
                      $scope.evento.cidade = place.address_components[i].long_name;
                      console.log($scope.evento.cidade)
                    }
                  }
                 
                  $scope.evento.lat = place.geometry.location.lat();
                  $scope.evento.lng = place.geometry.location.lng();
                  $scope.centerPoint.lat = -26.997799;
                  $scope.centerPoint.lng = -48.632733; 
                  // $scope.centerPoint.lat = -25.473466587692343;
                  // $scope.centerPoint.lng = -49.29164589792566;
                  $scope.centerPointKM = 30;
                  $scope.LimiteFuncionamentoDiwo = arePointsNear($scope.evento, $scope.centerPoint,$scope.centerPointKM );
                  $scope.centerPointKMFB = 2500;
                      $scope.centerPointFB.lat = 39.1882887948499;
                      $scope.centerPointFB.lng = -100.07746794288232;
                      $scope.LimiteFuncionamentoDiwoFB = arePointsNear($scope.user, $scope.centerPointFB,$scope.centerPointKMFB );
                      
                      if($scope.LimiteFuncionamentoDiwoFB){
                        $scope.LimiteFuncionamentoDiwo = true;
                      }
                  console.log($scope.evento.lng, $scope.evento.lat, "lssdd", $scope.evento.nomelocal, $scope.evento.endereco);

                  if (place.geometry.viewport) {
                    // Only geocodes have viewport.
                    bounds.union(place.geometry.viewport);
                  } else {
                    bounds.extend(place.geometry.location);
                  }
                });
                map.fitBounds(bounds);
            });

            $scope.map = map;  
             
        }, function(err) {
            console.log(err.code);
            console.log(err.message);
        });

  })

  var posOptions = {
      enableHighAccuracy: true,
      timeout: 200000,
      maximumAge: 0
  };

    navigator.geolocation.getCurrentPosition(function(position){
          
            var lat  = position.coords.latitude;
            var long = position.coords.longitude;
             

            var myLatlng = new google.maps.LatLng(lat, long);
             
            var mapOptions = {
                center: myLatlng,
                zoom: 16,
                mapTypeId: google.maps.MapTypeId.ROADMAP
            };          
             
            var map = new google.maps.Map(document.getElementById("map_canvas"), mapOptions); 


            var marker = new google.maps.Marker({
                      position: new google.maps.LatLng(position.coords.latitude, position.coords.longitude),
                      map: map,
                      title: "Borai",
                      draggable: true,
                      icon: 'http://maps.google.com/mapfiles/ms/icons/green-dot.png',
                      animation: google.maps.Animation.DROP 
                  })

            var geocoder = new google.maps.Geocoder;
            var infowindow = new google.maps.InfoWindow({maxWidth: 200});

            geocoder.geocode({'location': myLatlng}, function(results, status) {
                  if (status === 'OK') {
                    if (results[1]) {
                      $scope.evento.nomelocal = results[0].address_components[0].long_name;
                      $scope.evento.endereco = results[0].formatted_address;
                      for(var i = 0;i<results[0].address_components.length;i++){
                        if(results[0].address_components[i].types[0] == "administrative_area_level_2"){
                          $scope.evento.cidade = results[0].address_components[i].long_name;
                          console.log($scope.evento.cidade)
                        }
                      }
                      //$scope.evento.cidade = results[0].address_components[4].long_name;
                      $scope.evento.lat = position.coords.latitude;
                      $scope.evento.lng = position.coords.longitude;
                      $scope.centerPoint.lat = -26.997799;
                      $scope.centerPoint.lng = -48.632733; 
                      // $scope.centerPoint.lat = -25.473466587692343;
                      // $scope.centerPoint.lng = -49.29164589792566;
                      $scope.centerPointKM = 30;
                      $scope.LimiteFuncionamentoDiwo = arePointsNear($scope.evento, $scope.centerPoint,$scope.centerPointKM );
                      $scope.centerPointKMFB = 2500;
                      $scope.centerPointFB.lat = 39.1882887948499;
                      $scope.centerPointFB.lng = -100.07746794288232;
                      $scope.LimiteFuncionamentoDiwoFB = arePointsNear($scope.user, $scope.centerPointFB,$scope.centerPointKMFB );
                      
                      if($scope.LimiteFuncionamentoDiwoFB){
                        $scope.LimiteFuncionamentoDiwo = true;
                      }
                      infowindow.setContent(results[0].formatted_address);
                      console.log($scope.evento.endereco);
                      console.log($scope.evento.cidade);
                      console.log($scope.evento.lng);
                      console.log($scope.evento.lat);
                      //infowindow.setContent(results[0].address_components[2].long_name);
                      infowindow.open(map, marker);
                      setTimeout(function () { infowindow.close(); }, 5000);
                    } else {
                      window.alert('No results found');
                    }
                  } else {
                    window.alert('Geocoder failed due to: ' + status);
                  }
                });


            google.maps.event.addListener(marker, "dragstart", function (event) {
               marker.setAnimation(3); // raise
            });

            google.maps.event.addListener(marker, "dragend", function (event) {
               marker.setAnimation(4); // raise
            });

            marker.addListener('dragend', handleEvent);

            google.maps.event.addListener(map, 'click', function(e) {
              
                markers.forEach(function(marker) {
                marker.setMap(null);
                });
                markers = [];

                placeMarker(e.latLng, map, marker);

            });
             function arePointsNear(checkPoint, centerPoint, km) {
                  var ky = 40000 / 360;
                  var kx = Math.cos(Math.PI * centerPoint.lat / 180.0) * ky;
                  var dx = Math.abs(centerPoint.lng - $scope.evento.lng) * kx;
                  var dy = Math.abs(centerPoint.lat - $scope.evento.lat) * ky;
                  return Math.sqrt(dx * dx + dy * dy) <= km;
                } 

            function placeMarker(latlng, map, marker) {
                marker.setPosition(latlng);
                marker.setMap(map);
                map.panTo(latlng);
                $scope.evento.lat = latlng.lat();
                $scope.evento.lng = latlng.lng();
                $scope.centerPoint.lat = -26.997799;
                $scope.centerPoint.lng = -48.632733;
                // $scope.centerPoint.lat = -25.473466587692343;
                // $scope.centerPoint.lng = -49.29164589792566; 
                $scope.centerPointKM = 30;
                $scope.LimiteFuncionamentoDiwo = arePointsNear($scope.evento, $scope.centerPoint,$scope.centerPointKM );
                $scope.centerPointKMFB = 2500;
                      $scope.centerPointFB.lat = 39.1882887948499;
                      $scope.centerPointFB.lng = -100.07746794288232;
                      $scope.LimiteFuncionamentoDiwoFB = arePointsNear($scope.user, $scope.centerPointFB,$scope.centerPointKMFB );
                      
                      if($scope.LimiteFuncionamentoDiwoFB){
                        $scope.LimiteFuncionamentoDiwo = true;
                      }
                geocoder.geocode({'location': latlng}, function(results, status) {
                  if (status === 'OK') {
                    if (results[1]) {
                      $scope.evento.nomelocal = results[0].address_components[0].long_name;
                      for(var i = 0;i<results[0].address_components.length;i++){
                        if(results[0].address_components[i].types[0] == "administrative_area_level_2"){
                          $scope.evento.cidade = results[0].address_components[i].long_name;
                          console.log($scope.evento.cidade)
                        }
                      }
                      //$scope.evento.cidade = results[0].address_components[4].long_name;
                      $scope.evento.endereco = results[0].formatted_address;
                      console.log($scope.evento.endereco);
                      console.log($scope.evento.cidade);
                      console.log($scope.evento.lng);
                      console.log($scope.evento.lat);
                      infowindow.setContent(results[0].formatted_address);
                     
                      infowindow.open(map, marker);
                      setTimeout(function () { infowindow.close(); }, 5000);
                    } else {
                      window.alert('No results found');
                    }
                  } else {
                    window.alert('Geocoder failed due to: ' + status);
                  }
                });
            };        

            function handleEvent(event) {
                $scope.evento.lat = event.latLng.lat();
                $scope.evento.lng = event.latLng.lng();
                $scope.centerPoint.lat = -26.997799;
                $scope.centerPoint.lng = -48.632733; 
                // $scope.centerPoint.lat = -25.473466587692343;
                // $scope.centerPoint.lng = -49.29164589792566;
                $scope.centerPointKM = 30;
                $scope.LimiteFuncionamentoDiwo = arePointsNear($scope.evento, $scope.centerPoint,$scope.centerPointKM );
                $scope.centerPointKMFB = 2500;
                      $scope.centerPointFB.lat = 39.1882887948499;
                      $scope.centerPointFB.lng = -100.07746794288232;
                      $scope.LimiteFuncionamentoDiwoFB = arePointsNear($scope.user, $scope.centerPointFB,$scope.centerPointKMFB );
                      
                      if($scope.LimiteFuncionamentoDiwoFB){
                        $scope.LimiteFuncionamentoDiwo = true;
                      }
                              // GEOCODER INVERSO

                var geocoder = new google.maps.Geocoder;
                var infowindow = new google.maps.InfoWindow({
                                                              maxWidth: 200
                                                            });;    
            
                geocoder.geocode({'location': event.latLng}, function(results, status) {
                  if (status === 'OK') {
                    if (results[1]) {
                      $scope.evento.nomelocal = results[0].address_components[0].long_name;
                      for(var i = 0;i<results[0].address_components.length;i++){
                        if(results[0].address_components[i].types[0] == "administrative_area_level_2"){
                          $scope.evento.cidade = results[0].address_components[i].long_name;
                          console.log($scope.evento.cidade)
                        }
                      }
                      //$scope.evento.cidade = results[0].address_components[4].long_name;
                      $scope.evento.endereco = results[0].formatted_address;
                      // console.log($scope.evento.endereco);
                      // console.log($scope.evento.cidade);
                      console.log($scope.evento.lng);
                      console.log($scope.evento.lat);
                      infowindow.setContent(results[0].formatted_address);
                     
                      infowindow.open(map, marker);
                      setTimeout(function () { infowindow.close(); }, 5000);
                    } else {
                      window.alert('No results found');
                    }
                  } else {
                    window.alert('Geocoder failed due to: ' + status);
                  }
                });
            }

                              // GEOCODER INVERSO

                

                
            
                    //        SEARCHBOX

            var input = document.getElementById('pac-input');
            var searchBox = new google.maps.places.SearchBox(input);
          //map.controls[google.maps.ControlPosition.TOP_LEFT].push(input);

        // Bias the SearchBox results towards current map's viewport.
            map.addListener('bounds_changed', function() {
                searchBox.setBounds(map.getBounds());
            });

            var markers = [];
        // Listen for the event fired when the user selects a prediction and retrieve
        // more details for that place.
            searchBox.addListener('places_changed', function() {
                var places = searchBox.getPlaces();

                if (places.length == 0) {
                  return;
                }

                // Clear out the old markers.
                markers.forEach(function(marker) {
                  marker.setMap(null);
                });
                markers = [];

                // For each place, get the icon, name and location.
                var bounds = new google.maps.LatLngBounds();
                places.forEach(function(place) {
                  if (!place.geometry) {
                    console.log("Returned place contains no geometry");
                    return;
                  }
                  // var icon = {
                  //   url: place.icon,
                  //   size: new google.maps.Size(71, 71),
                  //   origin: new google.maps.Point(0, 0),
                  //   anchor: new google.maps.Point(17, 34),
                  //   scaledSize: new google.maps.Size(25, 25)
                  // };

                  // Create a marker for each place.
                  markers.push(new google.maps.Marker({
                    map: map,
                    // icon: icon,
                    title: place.name,
                    position: place.geometry.location
                  }));

                  $scope.evento.nomelocal = place.name;
                  $scope.evento.endereco = place.formatted_address;
                  for(var i = 0;i<place.address_components.length;i++){
                    //console.log(place.address_components[i].types[0])
                    if(place.address_components[i].types[0] == "administrative_area_level_2"){
                      $scope.evento.cidade = place.address_components[i].long_name;
                      console.log($scope.evento.cidade)
                    }
                  }
                 
                  $scope.evento.lat = place.geometry.location.lat();
                  $scope.evento.lng = place.geometry.location.lng();
                  $scope.centerPoint.lat = -26.997799;
                  $scope.centerPoint.lng = -48.632733; 
                  // $scope.centerPoint.lat = -25.473466587692343;
                  // $scope.centerPoint.lng = -49.29164589792566;
                  $scope.centerPointKM = 30;
                  $scope.LimiteFuncionamentoDiwo = arePointsNear($scope.evento, $scope.centerPoint,$scope.centerPointKM );
                  $scope.centerPointKMFB = 2500;
                      $scope.centerPointFB.lat = 39.1882887948499;
                      $scope.centerPointFB.lng = -100.07746794288232;
                      $scope.LimiteFuncionamentoDiwoFB = arePointsNear($scope.user, $scope.centerPointFB,$scope.centerPointKMFB );
                      
                      if($scope.LimiteFuncionamentoDiwoFB){
                        $scope.LimiteFuncionamentoDiwo = true;
                      }
                  // console.log($scope.coord.endereco);
                  // console.log($scope.coord.long);
                  // console.log($scope.coord.lat);

                  if (place.geometry.viewport) {
                    // Only geocodes have viewport.
                    bounds.union(place.geometry.viewport);
                  } else {
                    bounds.extend(place.geometry.location);
                  }
                });
                map.fitBounds(bounds);
            });

            $scope.map = map;  
             
        }, function(err) {
            console.log(err.code);
            console.log(err.message);
        });


        $scope.getCriar = function(evento) {
          if($scope.LimiteFuncionamentoDiwo){
            formEventoCriar.updateForm($scope.evento);
            $state.go('tabsController.criandoEventoPart3');
          }else{
            var alertPopup = $ionicPopup.alert({
                title: '( ꒪Д꒪)ノ',
                template: 'Ótimo saber que você quer criar um evento! Mas parece que a região onde você quer criar seu evento não está na nossa área de cobertura :/'
              }); 
          }
          
        }

}])

.controller('criandoEventoPart3Ctrl', ['$scope', '$stateParams', '$state', 'formEventoCriar', '$ionicPopup', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, $state, formEventoCriar, $ionicPopup) {
  $scope.evento = formEventoCriar.getForm();
  $scope.$on("$ionicView.enter", function(event, data){
    $scope.evento = formEventoCriar.getForm();
  })
    $scope.getCriar = function(evento) {
      var palavrasnaousar = ["ALIAMBA", "ANUS", "BAGULIO"
      , "BANZA", "BARRUFO", "BECK", "BEQUE", "BOCETA"
      , "BOLAGATO", "BOQUETE", "BOLCAT", "BOSSETA", "BOSTANA", "BREXA", "BRIOCO", "BRONHA", "BUCA", "BUCETA"
      , "BUSSETA", "CANABIS", "CANNABIS", "CARALHO"
      , "CASSETA", "CASSETE", "CHECHECA", "CHERECA", "CHIBUMBA", "CHIBUMBO", "CHOTA", "CHOCHOTA", "CHUPADA", "CHUPADO", "CLITORIS"
      , "COCAINA","C+"
      , "C*", "CURALHO", "CUZAO", "CUZUDA", "CUZUDO", "CUZÃO", "ESPORRADA", "ESPORRADO", "ESPORRO", "estupro"
      , "FELACAO", "FELACÃO", "FODA", "FODAO", "FODÃO", "FODAUM", "FODE", "FODIDA", "FODIDO", "FORNICA", "FUDENDO", "FUDECÃO", "FUDECAO"
      , "FUDIDA", "FUDIDO", "GRELINHO", "GRELO", "ISCROTA", "ISCROTO", "MACONHA", "MASTURBA", "MASTURBAÇÃO", "MASTURBACÃO", "MASTURBACAO"
      , "PENIS", "PEN1S", "PENES", "PENIZ", "PICA", "PIROCA", "PIRU", "PORRA", "POURRA", "PROSTIBULO", "PUTA", "PUNHETA", "PUTO"
      , "RABAO", "TESTUDA", "TESTUDO", "VAGABUNDA", "VAGINA", "VIADO", "VIADAO", "VIADÃO", "XAVASCA", "XERERECA", "XEXECA", "XOTA"
      , "XOCHOTA", "XOXOTA", "XANA", "XANINHA", "MDMA", "VSF", "TNC", "FDP", "CRACK"];
      var error = 0; 
      for (var i = 0; i < palavrasnaousar.length; i++) {
        var res2 = $scope.evento.descricao.split("_") ;
        if(res2.length>1){
          for(var w = 0; w < res2.length; w++){
            var val = palavrasnaousar[i].toLowerCase();
            if ((res2[w].toLowerCase()).indexOf(val.toString()) > -1) {  
              error = error + 1;  
            }
          }
        }else{
          var val = palavrasnaousar[i].toLowerCase();  
          if (($scope.evento.descricao.toLowerCase()).indexOf(val.toString()) > -1) {  
            error = error + 1;  
          }
        }
        var res3 = $scope.evento.descricao.split(" ") ;
        if(res3.length>1){
          for(var w = 0; w < res3.length; w++){
            var val = palavrasnaousar[i].toLowerCase();
            if ((res3[w].toLowerCase()).indexOf(val.toString()) > -1) {  
              error = error + 1;  
            }
          }
        }else{
          var val = palavrasnaousar[i].toLowerCase();  
          if (($scope.evento.descricao.toLowerCase()).indexOf(val.toString()) > -1) {  
            error = error + 1;  
          }
        }   
      } 
      if (error > 0) {  
          var alertPopup = $ionicPopup.alert({
                title: '（・о・；）',
                template: 'Que boquinha suja eim, usaste uma palavra inapropriada né'
              }); 
      }else{   
        if(evento.descricao){
          formEventoCriar.updateForm($scope.evento);
          $state.go('tabsController.criandoEventoPart4');
        }else{
          var alertPopup = $ionicPopup.alert({
                title: '( ꒪Д꒪)ノ',
                template: 'Escreva algo na descrição do evento para ajudar as pessoas a entenderem o que será feito'
              }); 
        }
        
      }

 }

}])
   
.controller('criandoEventoPart4Ctrl', ['$scope', '$stateParams', '$state', 'formEventoCriar', 'formUser','$ionicPopup', '$http', 'formtela2', 'formtelaCriar', 'EventoService', '$cordovaCamera', '$cordovaFile', '$cordovaFileTransfer', '$cordovaDevice',  '$ionicLoading',// The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, $state, formEventoCriar, formUser, $ionicPopup, $http, formtela2, formtelaCriar, EventoService, $cordovaCamera, $cordovaFile, $cordovaFileTransfer, $cordovaDevice,  $ionicLoading) {
  $scope.evento = formEventoCriar.getForm();
  $scope.user = formUser.getForm();
  $scope.auxtela = formtela2.getForm();
  var noti = {};
  $scope.imgURI = "img/ev.png"
  $scope.pushnoti ={};
  $scope.auxfoto = '';
  $scope.confirmacao = 'aprovado';
  $scope.estado = '0';
  $scope.ic = {};
  var evpic ='';
  EventoService.getIC($scope.user).then(function(ic) {
    if(ic){
     $scope.ic = ic;
   }
  });
  
  document.getElementById("imageidEvento").src="img/ev.png";
    $scope.getPicture = function (optionsCamera) {
      var optionsCamera = {
            quality : 100,
            sourceType : 0,
            allowEdit : true,
            targetWidth: 640,
            targetHeight: 640
      };
      $cordovaCamera.getPicture(optionsCamera).then(function(imageData) {
        $scope.imgURI = imageData;
        document.getElementById("imageidEvento").src=imageData;
      }, function(err) {
        console.log(err);
      });
    };


     $scope.$on("$ionicView.enter", function(event, data){
      $scope.auxtela = formtela2.getForm();
      $scope.evento = formEventoCriar.getForm();

      if ($scope.auxtela == 1) {
        $state.go('tabsController.criandoEventoPart1');
      }
     });

     $scope.getCriar = function(evento) {
      if (!$scope.evento.pmax || !$scope.evento.pmin) {
                    var alertPopup = $ionicPopup.alert({
                    title: '( ͒•·̫|',
                    template: 'Favor preencher todos os campos'
                  });

         }else{
          if (parseInt($scope.evento.pmin)<=1) {
            var alertPopup = $ionicPopup.alert({
                    title: '=/',
                    template: 'Não da pra fazer um evento só com você né'
                  });
          }else{
            if (parseInt($scope.evento.pmax) <= parseInt($scope.evento.pmin)) {
              var alertPopup = $ionicPopup.alert({
                      title: 'Matematimatematica',
                      template: 'Mínimo de pessoas nao pode ser maior ou igual ao máximo xD'
                    });
            }else{
              if (parseInt($scope.evento.pmax) >= 50) {
                var alertPopup = $ionicPopup.alert({
                        title: 'Muuuuita gente',
                        template: 'Limite máximo de pessoas para um evento é 50 personas'
                      });
              }else{



                $ionicPopup.prompt({
                    title: 'Qual nome devo dar?',
                    template: 'Não vamos esquecer de dar nomes aos bois',
                   inputType: 'text',
                   inputPlaceholder: ' Nome legal'
                 }).then(function(nomeevento) {
                  if (nomeevento && nomeevento !='' && nomeevento !=' ') {

                    var palavrasnaousar = ["ALIAMBA", "ANUS", "BAGULIO"
      , "BANZA", "BARRUFO", "BECK", "BEQUE", "BOCETA"
      , "BOLAGATO", "BOQUETE", "BOLCAT", "BOSSETA", "BOSTANA", "BREXA", "BRIOCO", "BRONHA", "BUCA", "BUCETA"
      , "BUSSETA", "CANABIS", "CANNABIS", "CARALHO"
      , "CASSETA", "CASSETE", "CHECHECA", "CHERECA", "CHIBUMBA", "CHIBUMBO", "CHOTA", "CHOCHOTA", "CHUPADA", "CHUPADO", "CLITORIS"
      , "COCAINA", "C+"
      , "C*", "CURALHO", "CUZAO", "CUZUDA", "CUZUDO", "CUZÃO", "ESPORRADA", "ESPORRADO", "ESPORRO", "estupro"
      , "FELACAO", "FELACÃO", "FODA", "FODAO", "FODÃO", "FODAUM", "FODE", "FODIDA", "FODIDO", "FORNICA", "FUDENDO", "FUDECÃO", "FUDECAO"
      , "FUDIDA", "FUDIDO", "GRELINHO", "GRELO", "ISCROTA", "ISCROTO", "MACONHA", "MASTURBA", "MASTURBAÇÃO", "MASTURBACÃO", "MASTURBACAO"
      , "PENIS", "PEN1S", "PENES", "PENIZ", "PICA", "PIROCA", "PIRU", "PORRA", "POURRA", "PROSTIBULO", "PUTA", "PUNHETA", "PUTO"
      , "RABAO", "TESTUDA", "TESTUDO", "VAGABUNDA", "VAGINA", "VIADO", "VIADAO", "VIADÃO", "XAVASCA", "XERERECA", "XEXECA", "XOTA"
      , "XOCHOTA", "XOXOTA", "XANA", "XANINHA", "MDMA",  "VSF", "TNC", "FDP", "CRACK"];
      var error = 0; 
      for (var i = 0; i < palavrasnaousar.length; i++) {
        var res2 = nomeevento.split("_") ;
        if(res2.length>1){
          for(var w = 0; w < res2.length; w++){
            var val = palavrasnaousar[i].toLowerCase();
            if ((res2[w].toLowerCase()).indexOf(val.toString()) > -1) {  
              error = error + 1;  
            }
          }
        }else{
          var val = palavrasnaousar[i].toLowerCase();  
          if ((nomeevento.toLowerCase()).indexOf(val.toString()) > -1) {  
            error = error + 1;  
          }
        }
        var res3 = nomeevento.split(" ");
        if(res3.length>1){
          for(var w = 0; w < res3.length; w++){
            var val = palavrasnaousar[i].toLowerCase();
            if ((res3[w].toLowerCase()).indexOf(val.toString()) > -1) {  
              error = error + 1;  
            }
          }
        }else{
          var val = palavrasnaousar[i].toLowerCase();  
          if ((nomeevento.toLowerCase()).indexOf(val.toString()) > -1) {  
            error = error + 1;  
          }
        }   
      } 
      if (error > 0) {  
          var alertPopup = $ionicPopup.alert({
                title: '（・о・；）',
                template: 'Que boquinha suja eim, usaste uma palavra inapropriada né'
              }); 
      }else{ 
        console.log($scope.imgURI)
        if($scope.imgURI != "img/ev.png"){ 
          $scope.auxfoto = nomeevento + $scope.evento.diainicio;
          var mystring = String($scope.auxfoto);
          mystring = mystring.replace(/[^a-zA-Z0-9]/g, '');
          evpic = 'https://s3.amazonaws.com/diwoappprofilepics/eventopicsdiwo/' + mystring + '.jpg';
        }else{
          evpic = "img/ev.png";
        } 
                    $scope.evento.nomeevento = nomeevento;
                    var link = 'https://ec2.diwoapp.com.br/criarevento.php';
                    $http.post(link, {nomeevento : $scope.evento.nomeevento, 
                                  duracao : $scope.evento.duracao,
                                  diainicio : $scope.evento.diainicio,
                                  semana : $scope.evento.semana,
                                  diafim : $scope.evento.diafim,
                                  dialimiteconfirmacao: $scope.evento.dialimiteconfirmacao,
                                  pmin : $scope.evento.pmin, 
                                  patual : 1, 
                                  pmax : $scope.evento.pmax,
                                  adm : $scope.user.iduser,
                                  admusername : $scope.user.username,
                                  admapelido : $scope.user.apelido,
                                  preco : $scope.evento.preco,
                                  precopor : $scope.evento.precopor,  
                                  nomelocal : $scope.evento.nomelocal,
                                  endereco : $scope.evento.endereco,
                                  cidade : $scope.evento.cidade,
                                  lat : $scope.evento.lat,
                                  lng : $scope.evento.lng,
                                  dificuldade :$scope.evento.dificuldade,
                                  genero : $scope.evento.genero,
                                  eventopic : evpic,
                                  descricao : $scope.evento.descricao,
                                  comerciodevicetoken : $scope.user.devicetoken}).then(function (res){
                    $scope.responsecriado = res.data;
                    console.log(res.data.success, "criou");
                  if ($scope.responsecriado.success == true) {
                    if($scope.imgURI != "img/ev.png"){
                      $scope.auxfoto = $scope.evento.nomeevento + $scope.evento.diainicio;
                      var mystring = String($scope.auxfoto);
                      mystring = mystring.replace(/[^a-zA-Z0-9]/g, '');
                      var url = "https://ec2.diwoapp.com.br/uploadfotoevento.php";
                                              // File for Upload
                      var targetPath = $scope.imgURI;
                     
                      // File name only
                      //var name = $scope.imgURI.substr(imageData.lastIndexOf('/') + 1);
                      var filename = mystring + '.jpg';
                      // NO CASO SERIA O NOME DO USUARIO.jpg O fileName
                      var options = {
                        fileKey: "file",
                        fileName: filename,
                        chunkedMode: false,
                        mimeType: "multipart/form-data"
                      };
                      $cordovaFileTransfer.upload(url, targetPath, options).then(function(result) {
                         $ionicLoading.hide();
                         var alertPopup = $ionicPopup.alert({
                          title: 'Parabéns',
                          template: $scope.responsecriado.msg
                        }); 
                        alertPopup.then(function(){
                          $ionicLoading.hide();
                          formtelaCriar.updateForm(1);
                          formtela2.updateForm(1);
                          $scope.evento = {};
                          $state.go('tabsController.home');
                       })
                      }, function(err) {
                        $ionicPopup.alert({
                          title: 'Sorry!',
                          template: 'Aconteceu um probleminha, tente de novo'
                        });
                        $ionicLoading.hide();
                      }, function (progress) {
                        $ionicLoading.show({
                          title: '┗(＾0＾)┓',
                          template: '┗(＾0＾)┓'
                        });
                      });
                    }
                          // CRIO TAG
              var res = $scope.evento.tags.split(" ") ;
              for (var i = 0; i<res.length;i++){
                if(res[i][0]!='#'){
                  res[i]= '#' + res[i];
                }
                console.log(res[i], "tags")
                var link = 'https://ec2.diwoapp.com.br/criartag.php';
                  $http.post(link, {idevento : $scope.responsecriado.last, 
                                    tag : res[i]}).then(function (res){console.log(res.success, "criou tag")});
              }
              var link = 'https://ec2.diwoapp.com.br/irevento.php';
                  $http.post(link, {idevento : $scope.responsecriado.last, 
                                    iduser : $scope.user.iduser,
                                    idadm : $scope.user.iduser,
                                    admusername : $scope.user.username,  
                                    diainicio : $scope.evento.diainicio,
                                    diafim : $scope.evento.diafim,
                                    username : $scope.user.username,
                                    borda : $scope.user.borda,
                                    apelido : $scope.user.apelido,
                                    profilepic : $scope.user.profilepic,
                                    devicetoken : $scope.user.devicetoken,
                                    confirmacao : $scope.confirmacao,
                                    nomeevento :  $scope.evento.nomeevento,
                                    idComercioParceiro : $scope.evento.idComercioParceiro, 
                                    eventopic : evpic, 
                                    estado : $scope.estado}).then(function (res){
                  $scope.response = res.data;
                  console.log($scope.response);
                  $http.post("https://ec2.diwoapp.com.br/getstalkers.php", {iduser : $scope.user.iduser}).then(function(response) {
                    console.log(response.data[0])
                    if(response.data[0] != 'E'){
                      $scope.auxresp = response.data[0]; 
                      for(var  i = 0 ; i<response.data[0].length;i++){
                        $scope.pushnoti.titulo =$scope.user.apelido + " criou um evento novo";
                        $scope.pushnoti.msg = $scope.user.apelido + " criou um evento novo: " +$scope.evento.nomeevento;
                        $scope.pushnoti.token = $scope.auxresp[i].devicetokenseguidor;
                        EventoService.MandaPushNoti($scope.pushnoti);
                      }
                     }
                  });
                    if ($scope.response.success == true) {
                       if($scope.imgURI == "img/ev.png"){
                        $ionicLoading.hide();
                         var alertPopup = $ionicPopup.alert({
                          title: 'Parabéns',
                          template: $scope.responsecriado.msg
                        }); 
                        alertPopup.then(function(){
                          $ionicLoading.hide();
                          formtelaCriar.updateForm(1);
                          formtela2.updateForm(1);
                          $scope.evento = {};
                          $state.go('tabsController.home');
                       })
                       }
                    }else{
                        var alertPopup = $ionicPopup.alert({
                          title: 'Ocorreu uma falha',
                          template: $scope.responsecriado.msg
                        });
                        alertPopup.then(function(){
                          $ionicLoading.hide();
                          $scope.evento = {};
                          formEventoCriar.updateForm($scope.evento);
                          $state.go('tabsController.home');
                       })
                      }
                    })
                  }

            });
                                } /// do palavrao
          }else{
            console.log('adsidisa')
          }
            });
          }
         }
         }}
     }

}])

.controller('eventoFechadoCtrl', ['$scope', '$stateParams', 'formItem', 'formUser', 'formOutro', '$http', '$timeout','$ionicPopup', 'EventoService', '$state', 'formpontos' ,'formtelaStalkear', 'formEventoPerfil',// The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, formItem, formUser, formOutro, $http, $timeout, $ionicPopup, EventoService, $state, formpontos, formtelaStalkear, formEventoPerfil) {

    //$scope.evento = formItem.getForm();
    $scope.evento = formEventoPerfil.getForm();
    
    $scope.nota = $scope.evento.nota;
    $scope.dia = {};
    $http.post('https://ec2.diwoapp.com.br/geteventoporid.php', {idevento : $scope.evento.idevento}).then(function (result){
    $scope.evento = result.data[0];
      var hj = new Date();
      hj = $scope.evento.diainicio;
      $scope.dia.dia = (hj[8]+hj[9]).valueOf()+'/'+(hj[5]+hj[6]).valueOf();
      $scope.dia.hora = (hj[11]+hj[12]).valueOf()+':'+(hj[14]+hj[15]).valueOf() ;

      //$scope.dia = (hj[8]+hj[9]).valueOf()+'/'+(hj[5]+hj[6]).valueOf()+'/'+(hj[0]+hj[1]+hj[2]+hj[3])+' '+(hj[11]+hj[12]).valueOf()+':'+(hj[14]+hj[15]).valueOf();
      var hjf = $scope.evento.diafim;
      $scope.diafim =  (hjf[8]+hjf[9]).valueOf()+'/'+(hjf[5]+hjf[6]).valueOf()+'/'+(hjf[0]+hjf[1]+hjf[2]+hjf[3])+' '+(hjf[11]+hjf[12]).valueOf()+':'+(hjf[14]+hjf[15]).valueOf();
      
    });



    $scope.aux = formUser.getForm();

    $scope.comentariovalido = {};
    var aux1 = 0;
    var aux2 = 0;
    var aux3 = 0;
    var k = 0;
    var bool = false;
    $scope.validacriador = {};
    $scope.participantes ={};
    $scope.atualiza= {};

    $scope.nuser = 0;
    if($scope.evento.genero == "masc"){
      $scope.masc = true;
      $scope.fem = false;
    }
    if($scope.evento.genero == "fem"){
        $scope.fem = true;
        $scope.masc = false;
    }
    if($scope.evento.genero == "todos"){
        $scope.fem = false;
        $scope.masc = false;
    }
    if($scope.evento.preco == 0 || $scope.evento.preco =="Gratuito"){
      $scope.evento.preco = "Gratuito";
      $scope.porpessoa = false;
      $scope.porlocal = false;
    }else{
      if($scope.evento.precopor == 1){
        $scope.porpessoa = true;
        $scope.porlocal = false;
      }else{
        $scope.porpessoa = false;
        $scope.porlocal = true;
      }
    }

    $scope.$on("$ionicView.enter", function(event, data){
      //$scope.evento = formItem.getForm();
      $scope.evento = formEventoPerfil.getForm();
      
      $scope.nota = $scope.evento.nota;
      $http.post('https://ec2.diwoapp.com.br/geteventoporid.php', {idevento : $scope.evento.idevento}).then(function (result){
        $scope.evento = result.data[0];
        var hj = new Date();
        hj = $scope.evento.diainicio;
        //$scope.dia = (hj[8]+hj[9]).valueOf()+'/'+(hj[5]+hj[6]).valueOf()+'/'+(hj[0]+hj[1]+hj[2]+hj[3])+' '+(hj[11]+hj[12]).valueOf()+':'+(hj[14]+hj[15]).valueOf();
        $scope.dia.dia = (hj[8]+hj[9]).valueOf()+'/'+(hj[5]+hj[6]).valueOf();
        $scope.dia.hora = (hj[11]+hj[12]).valueOf()+':'+(hj[14]+hj[15]).valueOf() ;

        var hjf = $scope.evento.diafim;
        $scope.diafim =  (hjf[8]+hjf[9]).valueOf()+'/'+(hjf[5]+hjf[6]).valueOf()+'/'+(hjf[0]+hjf[1]+hjf[2]+hjf[3])+' '+(hjf[11]+hjf[12]).valueOf()+':'+(hjf[14]+hjf[15]).valueOf();
      });

        
      $scope.items = [];
      var k2 = 0;
      $scope.pessoaduvida ={};
      EventoService.GetParticipantes($scope.evento.idevento).then(function(items) {
        aux3 = items.length;
        $scope.participantes = items;
        for(var  i = 0 ; i<items.length;i++){
          if(items[i].iduser == $scope.aux.iduser){
            if(items[i].estado =='9'){
              $scope.ocultabotao = false;
            }else{
              $scope.ocultabotao = true;
            }
          }
          if(items[i].borda == 0){
            items[i].bb = false;
            items[i].bs = false;
            items[i].bg = false;
          }
          if(items[i].borda == 1){
            items[i].bb = true;
            items[i].bs = false;
            items[i].bg = false;
          }
          if(items[i].borda == 2){
            items[i].bb = false;
            items[i].bs = true;
            items[i].bg = false;
          }
          if(items[i].borda == 3){
            items[i].bb = false;
            items[i].bs = false;
            items[i].bg = true;
          } 
          if(items[i].confirmacao == 'Organizador não lembra dele no evento, avalie-o se vc se lembra dele'){
            $scope.pessoaduvida[k2] = items[i]; 
            k2++;
          }
           if((items[i].profilepic[8] == 's' && items[i].profilepic[9] == '3')||(items[i].profilepic[8] == 'd' && items[i].profilepic[9] == 'i')){
          
             items[i].profilepic=items[i].profilepic+"?{{getTimeStamp()}}";
           }else{
             items[i].profilepic=items[i].profilepic;
           }
          //items[i].profilepic = items[i].profilepic+"?{{getTimeStamp()}}";
        }
        if(i==items.length){
          $scope.nomeevento = items[0].nomeevento;
          $scope.items = items;
        }
        
      });

      EventoService.GetComentariosfeitos($scope.aux).then(function(coments) { //
        aux1 = coments.length;
        $scope.feitos = coments;
      }); 
      $scope.validacriador.iduser =  $scope.evento.idevento; 
      $scope.validacriador.username =  $scope.evento.nomeevento; 
      EventoService.GetComentarios($scope.validacriador).then(function(recebido) {
        for(var  v = 0 ; v<recebido.length;v++){
            if(recebido[v].presenca == true){
               bool = true;
            }
          }
          console.log(aux3);
          if (!bool && recebido.length == aux3-1) {
            console.log('Organizador não foi');
          }
      });
    });

    $scope.Ocultar =  function(evento){
      $scope.ocultabotao = false;
      $http.post("https://ec2.diwoapp.com.br/ocultarpessoaevento.php", {idevento : evento.idevento,
                                                                          iduser: $scope.aux.iduser,
                                                                          estado : 9});
    }
    $scope.DESOcultar =  function(evento){
      $scope.ocultabotao = true;
      $http.post("https://ec2.diwoapp.com.br/ocultarpessoaevento.php", {idevento : evento.idevento,
                                                                          iduser: $scope.aux.iduser,
                                                                          estado : 3});
    }
    $scope.enterItem =  function(item){
      formOutro.updateForm(item);
      console.log(item.iduser);
      aux2 = 0;
      console.log(aux2);
      if (item.iduser == $scope.aux.iduser) {
        
          var alertPopup = $ionicPopup.alert({
                      title: 'Oxi',
                      template: 'Não podes se avaliar né quiridu'
                    }); 

      }else{
        $scope.auxcomente={};
        $scope.auxcomente.iduser = item.iduser;
        $scope.auxcomente.username = item.username;
        $scope.auxcomente.idevento = $scope.evento.idevento;
        $scope.auxcomente.stakeriduser = $scope.aux.iduser;
        //console.log("iduser" ,$scope.auxcomente.stakeriduser,"idevento", $scope.auxcomente.idevento,"nomepessoaavaliada", $scope.auxcomente.username ,"idpessoaavaliada", $scope.auxcomente.iduser)
        EventoService.GetComentariosDesseEventoPessoaAvaliou($scope.auxcomente).then(function(items) {
          if(items != "Error" ){
            formOutro.updateForm(item);
            $state.go('tabsController.perfil_outro_evento_criados');
          }else{
            formEventoPerfil.updateForm($scope.evento);
            $state.go('tabsController.avaliaODoUsuario');
          }
        });


        //   for (var i = 0 ; i<aux1 ; i++){
        //     console.log($scope.feitos[i].idevento, item.idevento , item.iduser, $scope.feitos[i].idpessoaavaliada)
        //     if ($scope.feitos[i].idevento == item.idevento && item.iduser == $scope.feitos[i].idpessoaavaliada) {
        //       aux2=1;
        //     }
        //   }
        //   console.log(aux2, "aux2")
        // if (aux2==1) {
        //   formOutro.updateForm(item);
        //   $state.go('tabsController.perfil_outro_evento_criados');
        // }else{
        //   $state.go('tabsController.avaliaODoUsuario');
        // }
      }
    }
    $scope.chatrou = function(){
      $state.go('tabsController.chatfechado');
    }

    $scope.entrar = function(){
      $state.go('tabsController.comentRiosEvento');
    }

}])

.controller('chatfechadoCtrl', ['$scope', '$stateParams', '$timeout', '$ionicScrollDelegate', 'formUser', '$http', 'formItem', '$interval', 'EventoService', 'formEventoPerfil',  // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, $timeout, $ionicScrollDelegate, formUser, $http, formItem, $interval, EventoService, formEventoPerfil) {
   $scope.user = formUser.getForm();
  $scope.evento = formEventoPerfil.getForm();
  $scope.data = {};
  $scope.messages = [];
  // $scope.hideTime = true;
  //console.log( $scope.user.username);
  var isIOS = ionic.Platform.isWebView() && ionic.Platform.isIOS();


  $scope.$on("$ionicView.enter", function(event, data){
    $scope.evento = formEventoPerfil.getForm();
    $scope.user = formUser.getForm();
    $scope.data = {};
    $scope.messages = {};
    $scope.messages = [];
    //alert($scope.evento.idevento)
     EventoService.Getmsg($scope.evento.idevento).then(function(result) {
        $scope.messages = result;
      });
  });

   $interval( function() {
          //   $http.post('https://ec2.diwoapp.com.br/getmsg.php' , {idevento : $scope.evento.idevento}).then(function(result) {
          // // console.log(result.data[0].idevento);
          // //   console.log("estou aqui");
          // if (result.data.success != false) {
          //     $scope.messages = result.data;
          // }
          // });
      EventoService.Getmsg($scope.evento.idevento).then(function(result) {
        $scope.messages = result;
      });

    }, 5000);

  // $http.post('https://ec2.diwoapp.com.br/getmsg.php' , {idevento : $scope.evento.idevento}).then(function(result) {
  //         if (result.data.success != false ) {
  //             $scope.messages = result.data;
  //         }
          
  //         });

   EventoService.Getmsg($scope.evento.idevento).then(function(result) {
        $scope.messages = result;
      });


  $scope.auxev = {};
  $scope.auxev.iduser = $scope.user.iduser;
  $scope.auxev.idevento = $scope.evento.idevento;
  EventoService.GetNotiOn($scope.auxev).then(function(notion) {
    $scope.notion = notion;
  });
  $scope.ativanoti = function(){
    $http.post('https://ec2.diwoapp.com.br/mudanotievento.php', {idevento : $scope.auxev.idevento, iduser : $scope.auxev.iduser, chatnotion : 0});
    $scope.notion = true;
  }
  $scope.desativanoti = function(){
    $http.post('https://ec2.diwoapp.com.br/mudanotievento.php', {idevento : $scope.auxev.idevento, iduser : $scope.auxev.iduser, chatnotion : 1});
    $scope.notion = false;
  }

  $scope.sendMessage = function() {
    var d = new Date();
    console.log(d);
    d = d.toLocaleTimeString().replace(/:\d+ /, ' ');
    var data = new Date();
    var dataFormatada = ("0" + data.getDate()).substr(-2) + "/" 
        + ("0" + (data.getMonth() + 1)).substr(-2) + "/" + data.getFullYear();

     // var dataFormatada2 =  (data.getFullYear() + "-" + ("0" + (data.getMonth() + 1)).substr(-2) + "-" + ("0" + data.getDate()).substr(-2) );


        dataFormatada = (d + ' '+dataFormatada);
        console.log(dataFormatada);

    if(!$scope.data.message){
      console.log(  "mensagem "+$scope.data.message);
     }else{
      console.log($scope.data.message,  $scope.messages,  $scope.messages[0]);
    
      if($scope.messages[0]){
        $scope.messages.push({
          username: $scope.user.username,
          mensagem: $scope.data.message,
          tempo: dataFormatada,
          idevento : $scope.evento.idevento, 
          iduser : $scope.user.iduser, 
          apelido : $scope.user.apelido
        });
      }else{
        $scope.messages[0] = {
          username: $scope.user.username,
          mensagem: $scope.data.message,
          tempo: dataFormatada,
          idevento : $scope.evento.idevento, 
          iduser : $scope.user.iduser, 
          apelido : $scope.user.apelido
        };
      }
      if($scope.data.message != '' || $scope.data.message){
         var link = 'https://ec2.diwoapp.com.br/criarmsg.php';
                      $http.post(link, {idevento : $scope.evento.idevento, 
                                        mensagem :  $scope.data.message,
                                        iduser : $scope.user.iduser, 
                                        username : $scope.user.username,
                                        apelido : $scope.user.apelido,
                                        tempo : dataFormatada}).then(function (res){
                    $scope.response = res.data;
                    console.log($scope.response.msg);
                  });
          EventoService.GetParticipantesNotifica($scope.evento.idevento).then(function(parti) {
            for (var i = 0; i < parti.length; i++) {
              if (parti[i].estado!=7 && parti[i].estado!=8 && parti[i].iduser != $scope.user.iduser) {
                console.log(parti[i].username,"parti[i].username")
                EventoService.getusuario2(parti[i].username).then(function(user) {
                  if(user.notichat== '1'){
                    $scope.pushnoti = {};
                    console.log(user.username,"getusuario2")
                    $scope.pushnoti.titulo = "Nova mensagem";
                    var hj = $scope.evento.diainicio;      
                    var mes = (hj[5]+hj[6]).valueOf();
                    var dia = (hj[8]+hj[9]).valueOf();
                    var diadia = dia+'/'+mes;
                    $scope.pushnoti.msg = 'Chat do '+$scope.evento.nomeevento + ' ' + diadia + ' ' + ' tem mensagem nova' ;
                    $scope.pushnoti.token = user.devicetoken;
                    EventoService.MandaPushNoti($scope.pushnoti);
                  }
                });
              }          
            }      
          });
      }
      delete $scope.data.message;
      $ionicScrollDelegate.scrollBottom(true);
     }
  };


  $scope.inputUp = function() {
    if (isIOS) $scope.data.keyboardHeight = 216;
    $timeout(function() {
      $ionicScrollDelegate.scrollBottom(true);
    }, 300);

  };

  $scope.inputDown = function() {
    if (isIOS) $scope.data.keyboardHeight = 0;
    $ionicScrollDelegate.resize();
  };

  $scope.closeKeyboard = function() {
    // cordova.plugins.Keyboard.close();
  };
}])

.controller('chathomeCtrl', ['$scope', '$stateParams', '$timeout', '$ionicScrollDelegate', 'formUser', '$http', 'formItem', '$interval', 'EventoService','$state', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, $timeout, $ionicScrollDelegate, formUser, $http, formItem, $interval, EventoService, $state) {
  $scope.user = formUser.getForm();
  $scope.evento = formItem.getForm();
  $scope.data = {};

    $scope.messages = {
      mensagem: '',
      tempo: '',
      idevento : '', 
      iduser : '', 
      username : '',
      apelido : ''
    };
    $scope.pushnoti = {};
  // $scope.hideTime = true;
  //console.log( $scope.user.username);
  var isIOS = ionic.Platform.isWebView() && ionic.Platform.isIOS();
  EventoService.Getmsg($scope.evento.idevento).then(function(result) {
    if (result.success != false) {
      $scope.messages =result;
      //$scope.messages = result.concat($scope.messages);
      $timeout(function() {
        $ionicScrollDelegate.scrollBottom(true);
      }, 300);
    }
  });
  $scope.nomeevento = '';
 

  $scope.$on("$ionicView.enter", function(event, data){
    $scope.user = formUser.getForm();
    $scope.evento = formItem.getForm();
    $scope.data = {};
    $scope.messages = {
      mensagem: '',
      tempo: '',
      idevento : '', 
      iduser : '', 
      username : '',
      apelido : ''
    };
    var isIOS = ionic.Platform.isWebView() && ionic.Platform.isIOS();
    //$scope.messages = [];
    EventoService.Getmsg($scope.evento.idevento).then(function(result) {
      if (result.success != false) {
        $scope.messages =result;
        //$scope.messages = result.concat($scope.messages);
        $timeout(function() {
        $ionicScrollDelegate.scrollBottom(true);
      }, 300);
      }
    });
  });

   $interval( function() {
      EventoService.Getmsg($scope.evento.idevento).then(function(result) {
        if (result.success != false) {
          $scope.messages =result;
        }
      });
    }, 5000);

   $scope.volta =  function(){
    $state.go('tabsController.eventoAberto');
  }
  $scope.auxev = {};
  $scope.auxev.iduser = $scope.user.iduser;
  $scope.auxev.idevento = $scope.evento.idevento;
  EventoService.GetNotiOn($scope.auxev).then(function(notion) {
    $scope.notion = notion;
  });
  $scope.ativanoti = function(){
    $http.post('https://ec2.diwoapp.com.br/mudanotievento.php', {idevento : $scope.auxev.idevento, iduser : $scope.auxev.iduser, chatnotion : 0});
    $scope.notion = true;
  }
  $scope.desativanoti = function(){
    $http.post('https://ec2.diwoapp.com.br/mudanotievento.php', {idevento : $scope.auxev.idevento, iduser : $scope.auxev.iduser, chatnotion : 1});
    $scope.notion = false;
  }


  $scope.sendMessage = function() {
    var d = new Date();
    console.log(d);
    d = d.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
    d = d.replace(/:\d+ /, ' ');
    var data = new Date();
    var dataFormatada = ("0" + data.getDate()).substr(-2) + "/" 
        + ("0" + (data.getMonth() + 1)).substr(-2) + "/" + data.getFullYear();

     // var dataFormatada2 =  (data.getFullYear() + "-" + ("0" + (data.getMonth() + 1)).substr(-2) + "-" + ("0" + data.getDate()).substr(-2) );


        dataFormatada = (d + ' '+dataFormatada);
        console.log(dataFormatada);
     if(!$scope.data.message){
      console.log(  "mensagem "+$scope.data.message);
     }else{
      console.log($scope.data.message,  $scope.messages,  $scope.messages[0]);
    
      if($scope.messages[0]){
        $scope.messages.push({
          username: $scope.user.username,
          mensagem: $scope.data.message,
          tempo: dataFormatada,
          idevento : $scope.evento.idevento, 
          iduser : $scope.user.iduser, 
          apelido : $scope.user.apelido
        });
      }else{
        $scope.messages[0] = {
          username: $scope.user.username,
          mensagem: $scope.data.message,
          tempo: dataFormatada,
          idevento : $scope.evento.idevento, 
          iduser : $scope.user.iduser, 
          apelido : $scope.user.apelido
        };
      }
      if($scope.data.message != '' || $scope.data.message){
        var link = 'https://ec2.diwoapp.com.br/criarmsg.php';
                      $http.post(link, {idevento : $scope.evento.idevento, 
                                        mensagem :  $scope.data.message,
                                        iduser : $scope.user.iduser, 
                                        username : $scope.user.username,
                                        apelido : $scope.user.apelido,
                                        tempo : dataFormatada}).then(function (res){
                    $scope.response = res.data;
                    console.log($scope.response.msg);
                  });
          EventoService.GetParticipantesNotifica($scope.evento.idevento).then(function(parti) {
            for (var i = 0; i < parti.length; i++) {
              if (parti[i].estado!=7 && parti[i].estado!=8 && parti[i].iduser != $scope.user.iduser) {
                EventoService.getusuario2(parti[i].username).then(function(user) {
                  if(user.notichat== '1'){
                    $scope.pushnoti = {};
                    $scope.pushnoti.titulo = "Nova mensagem";
                    $scope.pushnoti.msg = 'Chat do '+$scope.evento.nomeevento + ' tem mensagem nova' ;
                    $scope.pushnoti.token = user.devicetoken;
                    EventoService.MandaPushNoti($scope.pushnoti);
                  }
                });
              }          
            }      
          });
      }
      delete $scope.data.message;
      $ionicScrollDelegate.scrollBottom(true);
     }
      
  };


  $scope.inputUp = function() {
    if (isIOS) $scope.data.keyboardHeight = 216;
    $ionicScrollDelegate.resize();
    $timeout(function() {
      $ionicScrollDelegate.scrollBottom(true);
    }, 300);

  };

  $scope.inputDown = function() {
    if (isIOS) $scope.data.keyboardHeight = 0;
    $ionicScrollDelegate.resize();
  };

  $scope.closeKeyboard = function() {
     cordova.plugins.Keyboard.close();
  };

}])

.controller('comentRiosEventoCtrl', ['$scope', '$stateParams', 'formItem', 'EventoService', '$ionicPopup', '$http', 'formEventoPerfil', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, formItem, EventoService, $ionicPopup, $http,formEventoPerfil ) {
  $scope.evento = formEventoPerfil.getForm();
  $scope.nota = 0;
  $scope.items ={};

  EventoService.GetComentariosevento($scope.evento).then(function(items) {
    console.log(items)
    if(items=='Error'){
      $scope.nota = 0;
      $scope.items ={};
    }else{
      console.log('Tem comentarios')
      $scope.items = items;
      for (var i = 0; i < items.length; i++) {
        $scope.nota = parseFloat(items[i].nota) + $scope.nota ;
         if((items[i].profilepic[8] == 's' && items[i].profilepic[9] == '3')||(items[i].profilepic[8] == 'd' && items[i].profilepic[9] == 'i')){
          
             $scope.items[i].profilepic=items[i].profilepic+"?{{getTimeStamp()}}";
           }else{
             $scope.items[i].profilepic=items[i].profilepic;
           }
        //$scope.items[i].profilepic = items[i].profilepic+"?{{getTimeStamp()}}";;
      }
      $scope.nota = ($scope.nota/items.length).toFixed(1);
    }     
  });
  $scope.reportcoment = function(item){
      $ionicPopup.prompt({
                    title: 'Você quer reportar essa comentário pq?',
                    template: 'Não me venha reportando só pq tu quer, não me venha dar trabalho!!!!',
                   inputType: 'text',
                   inputPlaceholder: ' Linguajar ofensivo ou inapropriado'
                 }).then(function(texto) {
                  if(texto){
                    $scope.reportmsg = item.idavaliacao + ' (idavaliação) '+texto;
                    $http.post('https://ec2.diwoapp.com.br/reportaevento.php', {namereportado : item.nomeavaliador,
                                                                              reportadoid : item.iduser,
                                                                              iduserreportando : $scope.user.iduser,
                                                                              usernamereportando : $scope.user.username,
                                                                              tiporeport : 'comentario',
                                                                              motivo : $scope.reportmsg}).then(function (tes){
                                 $scope.response = tes.data;
                                  var alertPopup = $ionicPopup.alert({
                                                          title: 'Obrigado',
                                                          template: 'Esta pessoa esta agora sobre investigação, obrigado por manter a plataforma segura'
                                                        });

                               });
                  }
                 });
  }

}])

.controller('sigoCtrl', ['$scope', '$stateParams', 'formUser', '$http', 'formOutro', '$state', 'formtelaStalkear',  '$ionicPopup','EventoService',   // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, formUser, $http, formOutro, $state, formtelaStalkear,  $ionicPopup, EventoService) {
  $scope.user = formUser.getForm();
  $scope.items = {};
  $scope.estadobutton = 0; 
  $scope.seguindo = true;
  $scope.seguido = false; 
  $scope.desbloque = false; 
  $scope.bloqueado = false;
  $scope.dessegue = true; 
  $scope.auxamigos = {};


  // EventoService.GetAmigos($scope.user.iduser).then(function(amigos) {
  //   $scope.auxamigos = amigos;
  //   console.log($scope.auxamigos, $scope.auxamigos[0].iduser)
  //   if($scope.auxamigos!= 'E'){
  //     for(var  i = 0 ; i<$scope.auxamigos.length;i++){
  //       if(($scope.auxamigos[i].profilepic[8] == 's' && $scope.auxamigos[i].profilepic[9] == '3')||($scope.auxamigos[i].profilepic[8] == 'd' && $scope.auxamigos[i].profilepic[9] == 'i')){

  //       //if(response.data[0][i].profilepicseguindo[8] == 's' && response.data[0][i].profilepicseguindo[9] == '3'){
  //          $scope.auxamigos[i].profilepic=$scope.auxamigos[i].profilepicseguindo+"?{{getTimeStamp()}}";
  //        }else{
  //          $scope.auxamigos[i].profilepic=$scope.auxamigos[i].profilepicseguindo;
  //        }
  //     }
  //     if(i==$scope.auxamigos.length){
  //       $scope.items = response.data[0];
  //     }
  //   }else{
  //     $scope.items = {};
  //   }
  // });
    $http.post("https://ec2.diwoapp.com.br/getamigos.php", {iduser : $scope.user.iduser}).then(function(response) {
      //console.log( response.data[0].profilepicseguindo[8] )
      if(response.data[0] != 'E'){
        for(var  i = 0 ; i<response.data.length;i++){
          if((response.data[i].profilepicseguindo[8] == 's' && response.data[i].profilepicseguindo[9] == '3')||(response.data[i].profilepicseguindo[8] == 'd' && response.data[i].profilepicseguindo[9] == 'i')){

          //if(response.data[0][i].profilepicseguindo[8] == 's' && response.data[0][i].profilepicseguindo[9] == '3'){
             response.data[i].profilepic=response.data[i].profilepicseguindo+"?{{getTimeStamp()}}";
           }else{
             response.data[i].profilepic=response.data[i].profilepicseguindo;
           }
        }
        if(i==response.data.length){
          $scope.items = response.data;
        }  
      }else{
          $scope.items = {};
      }
    });

 

  var header = document.getElementById("barsigo");
    var btns = header.getElementsByClassName("btneva2");
    for (var i = 0; i < btns.length; i++) {
      btns[i].addEventListener("click", function() {
        var current = document.getElementsByClassName("actis");
        current[0].className = current[0].className.replace(" actis", "");
        this.className += " actis";
      });
    }

    $scope.duvida4= function() {var alertPopup = $ionicPopup.alert({
                      title: '|_・)',
                      template: 'Ao seguir uma pessoa, você poderá ver os eventos nos quais ela está confirmada. Mas atenção, ela saberá que você está stalkeando-a. Ao bloquear uma pessoa que te segue, ela não conseguirá mais ver os eventos que você marcou de ir (arraste para o lado para bloquear).'
                    });};

  $scope.sigo = function(){
    $scope.items = {};
    $scope.estadobutton = 0;
    $scope.seguindo = true;
    $scope.seguido = false;
    $scope.desbloque = false; 
    $scope.bloqueado = false;
    $scope.dessegue = true; 
    $http.post("https://ec2.diwoapp.com.br/getamigos.php", {iduser : $scope.user.iduser}).then(function(response) {
      //console.log( response.data[0].profilepicseguindo[8] )
          if(response.data[0] != 'E'){
            for(var  i = 0 ; i<response.data.length;i++){
              if((response.data[i].profilepicseguindo[8] == 's' && response.data[i].profilepicseguindo[9] == '3')||(response.data[i].profilepicseguindo[8] == 'd' && response.data[i].profilepicseguindo[9] == 'i')){
    
              //if(response.data[0][i].profilepicseguindo[8] == 's' && response.data[0][i].profilepicseguindo[9] == '3'){
                 response.data[i].profilepic=response.data[i].profilepicseguindo+"?{{getTimeStamp()}}";
               }else{
                 response.data[i].profilepic=response.data[i].profilepicseguindo;
               }
            }
            if(i==response.data.length){
              $scope.items = response.data;
            }  
          }else{
              $scope.items = {};
          }
        });
  }
  $scope.seguem = function(){
    $scope.items = {};
    $scope.estadobutton = 1;
    $scope.seguindo = false;
    $scope.desbloque = false; 
    $scope.seguido = true;
    $scope.bloqueado = false;
    $scope.dessegue = false; 
    $http.post("https://ec2.diwoapp.com.br/getstalkers.php", {iduser : $scope.user.iduser}).then(function(response) {
          if(response.data[0] != 'E'){
            for(var  i = 0 ; i<response.data[0].length;i++){
              if((response.data[0][i].profilepicseguidor[8] == 's' && response.data[0][i].profilepicseguidor[9] == '3')||(response.data[0][i].profilepicseguidor[8] == 'd' && response.data[0][i].profilepicseguidor[9] == 'i')){
    
              //if(response.data[0][i].profilepicseguidor[8] == 's' && response.data[0][i].profilepicseguidor[9] == '3'){
                 response.data[0][i].profilepic=response.data[0][i].profilepicseguidor+"?{{getTimeStamp()}}";
               }else{
                 response.data[0][i].profilepic=response.data[0][i].profilepicseguidor;
               }
               //console.log("das",response.data[0][i].profilepicseguidor);
            }

            if(i==response.data[0].length){
              $scope.items = response.data[0];
            }  
          }else{
              $scope.items = {};
          }
        });
    }
   $scope.bloqueados = function(){
    $scope.items = {};
    $scope.desbloque = true; 
    $scope.estadobutton = 2;
    $scope.seguindo = false;
    $scope.seguido = false;
    $scope.bloqueado = true;
    $scope.dessegue = false; 
    $http.post("https://ec2.diwoapp.com.br/getbloqueados.php", {iduser : $scope.user.iduser}).then(function(response) {
          if(response.data[0] != 'E'){
            for(var  i = 0 ; i<response.data[0].length;i++){
              if((response.data[0][i].profilepicseguidor[8] == 's' && response.data[0][i].profilepicseguidor[9] == '3')||(response.data[0][i].profilepicseguidor[8] == 'd' && response.data[0][i].profilepicseguidor[9] == 'i')){
    
              ///if(response.data[0][i].profilepicseguidor[8] == 's' && response.data[0][i].profilepicseguidor[9] == '3'){
                 response.data[0][i].profilepic=response.data[0][i].profilepicseguidor+"?{{getTimeStamp()}}";
               }else{
                 response.data[0][i].profilepic=response.data[0][i].profilepicseguidor;
               }
            }
            if(i==response.data[0].length){
              $scope.items = response.data[0];
            }  
          }else{
              $scope.items = {};
          }
        });
  }

  //// BLOQUEAR PESSOA

  $scope.bloquear = function(item) {
    var link = 'https://ec2.diwoapp.com.br/bloquear.php'; // estado "Bloqueado"  = 1;
            $http.post(link, {iduserseguindo : item.iduserseguindo, 
                              iduserseguidor : item.iduserseguidor}).then(function(res) {
                            
                                var alertPopup = $ionicPopup.alert({
                                                            title: '( ง ᵒ̌皿ᵒ̌)ง⁼³₌₃',
                                                            template: 'Pessoa não poderá mais te seguir'
                                                          }); 
                            $scope.items.splice($scope.items.indexOf(item), 1);  
                          });
  }
  $scope.desbloquear = function(item) {
    console.log(item.iduserseguindo , item.iduserseguidor)
    var link = 'https://ec2.diwoapp.com.br/desbloquear.php'; // estado "desBloqueado"  = 0;
            $http.post(link, {iduserseguindo : item.iduserseguindo, 
                              iduserseguidor : item.iduserseguidor}).then(function(res) {
                            
                                var alertPopup = $ionicPopup.alert({
                                                            title: 's2',
                                                            template: 'Pessoa desbloqueada'
                                                          });  
                                $scope.items.splice($scope.items.indexOf(item), 1);  
                          });
  }
  $scope.desseguir = function(item) {
    console.log(item.iduserseguindo , item.iduserseguidor)
    var link = 'https://ec2.diwoapp.com.br/desfollow.php'; // estado "Bloqueado"  = 2;
            $http.post(link, {iduserseguindo : item.iduserseguindo, 
                          iduserseguidor : item.iduserseguidor}).then(function(res) {
                            
                                var alertPopup = $ionicPopup.alert({
                                                            title: '(*꒦ິ⌓꒦ີ)',
                                                            template: 'Não segues mais esta pessoa'
                                                          }); 
                                $scope.items.splice($scope.items.indexOf(item), 1);  
                            
                          });
  }



          //// ARRUMAR PARA NÃO IR NA TAB DE EVENTOS ABERTOS

  $scope.enterItem = function(item){
    console.log(item.iduserseguidor,"entrando no bloqueado")
      if($scope.estadobutton  == 0 ){
          $scope.stalkeada={};
          $scope.stalkeada.iduser = item.iduserseguindo;
          $scope.stalkeada.username = item.usernameseguindo;
          formOutro.updateForm($scope.stalkeada);
          formtelaStalkear.updateForm(1);
          $state.go('tabsController.perfilFollow');
      }
      if($scope.estadobutton  == 1 ){
        $scope.stalkeada={};
        $scope.stalkeada.iduser = item.iduserseguidor;
        $scope.stalkeada.username = item.usernameseguidor;
        formOutro.updateForm($scope.stalkeada);
        formtelaStalkear.updateForm(1);
        $state.go('tabsController.perfilFollow');
      }
      if($scope.estadobutton  == 2 ){
        $scope.stalkeada={};
        $scope.stalkeada.iduser = item.iduserseguidor;
        $scope.stalkeada.username = item.usernameseguidor;
        formOutro.updateForm($scope.stalkeada);
        formtelaStalkear.updateForm(1);
        $state.go('tabsController.perfilFollow');
      }
      
 
    
  }

}])
   
.controller('qmFoiMesmoCtrl', ['$scope', '$stateParams', 'EventoService', '$state', 'formAux', 'formUser', 'formItem', 'formpontos','$http', '$ionicPopup', 'formtelanoti','formEventoPerfil',  // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, EventoService, $state, formAux, formUser, formItem, formpontos, $http, $ionicPopup, formtelanoti,formEventoPerfil) {

  $scope.evento = formAux.getAux();

  $scope.aux = formUser.getForm();
  $scope.items = {};
  $scope.pessoaevento = {};
  $scope.p = 0;
  $scope.atualiza={};
  var idnoti = $scope.evento.idnotificacao;

  $scope.telano = formtelanoti.getForm();

  EventoService.GetParticipantes($scope.evento.idevento).then(function(items) {
              items.shift();
              $scope.items = items;
              for (var i = 0; i < items.length; i++) {
                 if((items[i].profilepic[8] == 's' && items[i].profilepic[9] == '3')||(items[i].profilepic[8] == 'd' && items[i].profilepic[9] == 'i')){
          
                   $scope.items[i].profilepic=items[i].profilepic+"?{{getTimeStamp()}}";
                 }else{
                   $scope.items[i].profilepic=items[i].profilepic;
                 }
                 $scope.items[i].checked = true;
                //$scope.items[i].profilepic = items[i].profilepic+"?{{getTimeStamp()}}";;
              }

  });

  $http.post("https://ec2.diwoapp.com.br/getpessoaeventopontos.php", {iduser : $scope.aux.iduser,
                                                                   estado : '3'}).then(function(response) {
    ajuda = response.data[0];
      for(var i=0;i<ajuda.length;i++){
        if (ajuda[i].idevento == $scope.evento.idevento){
           $scope.p += parseFloat(ajuda[i].pontos);
        }
      }
  });

  $scope.$on("$ionicView.enter", function(event, data){
    $scope.evento = formAux.getAux();
    $scope.aux = formUser.getForm();
    idnoti = $scope.evento.idnotificacao;
    $scope.items = {};
    $scope.pessoaevento = {};
    $scope.p = 0;
    //console.log($scope.telano,"TEalaaa")
    
    EventoService.GetParticipantes($scope.evento.idevento).then(function(items) {
              items.shift();
              $scope.items = items;
              for (var i = 0; i < items.length; i++) {
                 if((items[i].profilepic[8] == 's' && items[i].profilepic[9] == '3')||(items[i].profilepic[8] == 'd' && items[i].profilepic[9] == 'i')){
          
                   $scope.items[i].profilepic=items[i].profilepic+"?{{getTimeStamp()}}";
                 }else{
                   $scope.items[i].profilepic=items[i].profilepic;
                 }
                $scope.items[i].checked = true;
                //$scope.items[i].profilepic = items[i].profilepic+"?{{getTimeStamp()}}";;
              }
    });

    $http.post("https://ec2.diwoapp.com.br/getpessoaeventopontos.php", {iduser : $scope.aux.iduser,
                                                                    estado : '3'}).then(function(response) {
      ajuda = response.data[0];
      for(var i=0;i<ajuda.length;i++){
        if (ajuda[i].idevento == $scope.evento.idevento){
           $scope.p += parseFloat(ajuda[i].pontos);
        }
      }
    });
  });


  $scope.onClickAdd = function(item){
    //console.log(item.added);
    if (!item.added){
      console.log(item.username);
      item.foi = "não fui"
    }else{
      item.foi = "fui"
      console.log('add');
    } 
    item.checked = !item.checked
    item.added = !item.added;
  };  

  $scope.confirma = function(items){
    console.log(items.length);
    for(var i = 0; i<items.length;i++){ 
      if (items[i].added) {
        console.log(items[i].iduser);
        $scope.pessoaevento.id_user_envia = items[i].iduser;
        $scope.pessoaevento.idevento = $scope.evento.idevento;
        $scope.pessoaevento.confirmacao = 'Organizador não lembra dele no evento, avalie-o se vc se lembra dele'; //estado significa que o usuário não foi ao evento de acordo com o criador
        $scope.pessoaevento.aceito = '3';
        $scope.pessoaevento.pontos = 0; 
        EventoService.atualizarpessoaevento($scope.pessoaevento).then(function(msg){
        });
      }
    }
           ///PONTOS PARA CRIADOR DO EVENTO POR CONFIRMAR A PRESENÇA DOS USUÁRIOS +4
    $scope.atualiza.idevento = $scope.evento.idevento;
    $scope.atualiza.id_user_envia = $scope.aux.iduser;  
    $scope.atualiza.pontos =  $scope.p+4;
    $scope.atualiza.auxpontos = 0;
    EventoService.pontospessoaevento($scope.atualiza);
    EventoService.ncriadoscriador($scope.aux.iduser);
    $http.post('https://ec2.diwoapp.com.br/deletanotificacao.php', {idnotificacao : idnoti});

    formItem.updateForm($scope.evento);
    var alertPopup = $ionicPopup.alert({
        title: '¡¡¡( •̀ ᴗ •́ )و!!!',
        template: 'Veja nos seus eventos finalizados e avalie os participantes'
    });
    formEventoPerfil.updateForm($scope.evento);
    if($scope.telano == 1){
      $state.go('tabsController.geral'); ///teste
    }else{
      $state.go('tabsController.notificaEs'); ///teste
    } 
    
  }

}])


.controller('avaliaODoUsuarioCtrl', ['$scope', '$stateParams', '$state', 'formOutro', 'EventoService','formItem', 'formUser', '$http','$timeout','$ionicPopup','formpontos', 'formEventoPerfil', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, $state, formOutro, EventoService, formItem, formUser, $http, $timeout, $ionicPopup,formpontos, formEventoPerfil) {
  
  $scope.teste = formOutro.getForm();
  //$scope.evento = formItem.getForm();
  $scope.evento = formEventoPerfil.getForm();
  
  $scope.aux = formUser.getForm();
  $scope.cars = 0;
  $scope.pessoa = {};
  $scope.atualiza ={};
  $scope.pontos = {};
  $scope.pushnoti = {};
  $scope.p = 0;
  $scope.stalkeada = {};
  $scope.notificaapelido = "";
  $scope.notificafoto = "";
  $scope.pessoa.nota = 8;
  var aux = 0;
  var noti = {};
  $scope.comentbem = true;

    var btns = document.getElementsByClassName("btnavaliauser");
    for (var i = 0; i < btns.length; i++) {
      btns[i].addEventListener("click", function() {
        var current = document.getElementsByClassName("actauser");
        current[0].className = current[0].className.replace(" actauser", "");
        this.className += " actauser";
      });
    }

 

  EventoService.GetStalkear($scope.teste.iduser).then(function(items) {
    $scope.stalkeada = items;
    //console.log($scope.stalkeada, 'depois de stalkear');
    if(($scope.stalkeada.profilepic[8] == 's' && $scope.stalkeada.profilepic[9] == '3')||($scope.stalkeada.profilepic[8] == 'd' && $scope.stalkeada.profilepic[9] == 'i')){
         
    //if($scope.stalkeada.profilepic[8] == 's' && $scope.stalkeada.profilepic[9] == '3'){
            document.getElementById("imageidavaliaODoUsuario").src=$scope.stalkeada.profilepic+"?{{getTimeStamp()}}";
           }else{
             document.getElementById("imageidavaliaODoUsuario").src=$scope.stalkeada.profilepic;
           }
    //document.getElementById("imageidavaliaODoUsuario").src=$scope.stalkeada.profilepic+"?{{getTimeStamp()}}";
  });

  $http.post("https://ec2.diwoapp.com.br/getpessoaeventopontos.php", {iduser : $scope.aux.iduser,
                                                                  estado : '3'}).then(function(response) {
    $scope.pontos = response.data[0];
      for(var i=0;i<$scope.pontos.length;i++){
        if ($scope.pontos[i].idevento == $scope.evento.idevento) {
          console.log('alouuu');
          $scope.p += parseFloat($scope.pontos[i].pontos);
        }
      }
    console.log($scope.p);
  });

  var Areatxt = document.getElementById("Areatxt");

  Areatxt.addEventListener("keydown",function(){
    var characters = Areatxt.value.split('');
    $scope.cars= characters.length+1;
    console.log($scope.cars)
    if(characters.length > 300){
      Areatxt.value = Areatxt.value.substring(0,300);
    }
  });
  
  $scope.Extrovertido = function() {$scope.pessoa.nota = 1;$scope.comentbem = true;}
  $scope.Introvertido = function() {$scope.pessoa.nota = 2;$scope.comentbem = true;}
  $scope.Realista = function() {$scope.pessoa.nota = 3;$scope.comentbem = true;}
  $scope.Curioso = function() {$scope.pessoa.nota = 4;$scope.comentbem = true;}
  $scope.Solidario = function() {$scope.pessoa.nota = 5;$scope.comentbem = true;}
  $scope.Racional = function() {$scope.pessoa.nota = 6;$scope.comentbem = true;}
  $scope.Organizado = function() {$scope.pessoa.nota = 7;$scope.comentbem = true;}
  $scope.Criativo = function() {$scope.pessoa.nota = 8;$scope.comentbem = true;}
  $scope.mal = function(){$scope.pessoa.nota = 9;$scope.comentbem = false;}

  $scope.auxcomente={};
 // $scope.testee = function(){
    $scope.auxcomente.iduser = $scope.aux.iduser;
    $scope.auxcomente.username = $scope.aux.username;
    $scope.auxcomente.idevento = $scope.evento.idevento;
    $scope.auxcomente.stakeriduser = $scope.teste.iduser;
    //console.log("iduser" ,$scope.auxcomente.stakeriduser,"idevento", $scope.auxcomente.idevento,"nomepessoaavaliada", $scope.auxcomente.username ,"idpessoaavaliada", $scope.auxcomente.iduser)
    EventoService.GetComentariosDesseEventoPessoaAvaliou($scope.auxcomente).then(function(items) {
      if(items != "Error" ){
        $scope.auxcomente.estado = 1;
        console.log("Essa pessoa te avaliou ja")
      }else{
        $scope.auxcomente.estado = 0;
        console.log("Não foi avaliado por essa pessoa")
      }
    });
  //}

  



    $scope.reportar = function(){
    $scope.reportmsg = '';
    console.log($scope.stalkeada.username);
    $scope.report = [
    { text: "Nome impróprio", checked: false },
    { text: "Comportamento inadequado", checked: false },
    { text: "Foto inapropriada", checked: false },
    { text: "É um impostor", checked: false }
    ];
    $ionicPopup.confirm({
      title: 'Você quer reportar essa pessoa pq?',
      content: '<ion-checkbox ng-repeat="item in report" style="color: #FCFCFC;" ng-model="item.checked"  ng-checked="item.checked">{{item.text}}</ion-checkbox>',
      scope: $scope
    }).then(function(res) {
      if(res) {
        for (var h=0;h<3;h++){
          //console.log($scope.report[h].checked , h);
          if($scope.report[h].checked){
            $scope.reportmsg = $scope.reportmsg + $scope.report[h].text + ' ';
            //console.log($scope.reportmsg);
          }
        }
        if(h==3){
          console.log($scope.reportmsg);
          $http.post('https://ec2.diwoapp.com.br/reportaevento.php', {namereportado : $scope.stalkeada.username,
                                                                          reportadoid : $scope.stalkeada.iduser,
                                                                          iduserreportando : $scope.user.iduser,
                                                                          usernamereportando : $scope.user.username,
                                                                          tiporeport : 'usuario',
                                                                          motivo : $scope.reportmsg}).then(function (tes){
            $scope.response = tes.data;
            var alertPopup = $ionicPopup.alert({
              title: 'Obrigado',
              template: 'Esta pessoa esta agora sobre investigação, obrigado por manter a plataforma segura'
            });
          });
        }
      }
    });
  }


  $scope.pushNotificationChange = function() {
    console.log('Push Notification Change', $scope.pushNotification.checked);
  };
  $scope.pushNotification = { checked: false };

  $scope.pronto = function(){
    if($scope.pushNotification.checked){
      $scope.notificaapelido = "Anônimo";
      $scope.notificafoto = "img/anonimo.jpg";
      $scope.msg = "Você foi avaliado";
    }else{
      $scope.notificaapelido =  $scope.aux.apelido;
      $scope.msg = $scope.aux.username + " te avaliou";
      $scope.notificafoto = $scope.aux.profilepic;
    }
    console.log($scope.pessoa.comentario)
    if($scope.pessoa.comentario == '' || !$scope.pessoa.comentario){
      var alertPopup = $ionicPopup.alert({
        title: 'Bleeee',
        template: 'Escreva algo!!!!'
      });
    
    }else{
      $scope.atualiza.confirmacao = 'Avaliado';
      $scope.atualiza.aceito = '3';
      $scope.atualiza.idevento = $scope.evento.idevento;
      $scope.atualiza.id_user_envia = $scope.stalkeada.iduser;
      $scope.atualiza.pontos = 3;     // Confirma que a pessoa esteve presente no evento
      EventoService.atualizarpessoaevento($scope.atualiza);
      for(var i = 0; i<$scope.pontos.length;i++){
        if ($scope.pontos[i].idevento==$scope.evento.idevento && $scope.pontos[i].auxpontos==1) {
          aux = 1;
        }
      }
      if (aux != 1){
        $scope.atualiza.idevento = $scope.evento.idevento;
        $scope.atualiza.id_user_envia = $scope.aux.iduser;  
        $scope.atualiza.pontos =  parseFloat($scope.p)+3;
        $scope.atualiza.auxpontos = 1;
        EventoService.pontospessoaevento($scope.atualiza);
      }
      if($scope.auxcomente.estado ==  1){
        EventoService.AtualizaComentariosDesseEventoPessoaAvaliou($scope.auxcomente)
      }
      $http.post('https://ec2.diwoapp.com.br/avaliar.php', {idevento : $scope.evento.idevento,
                                                            iduser : $scope.aux.iduser,
                                                             nomeavaliador : $scope.aux.username,
                                                             apelidoavaliador : $scope.notificaapelido,
                                                             profilepic :$scope.notificafoto,
                                                            idpessoaavaliada : $scope.stalkeada.iduser,
                                                            nomepessoaavaliada: $scope.stalkeada.username,
                                                            estado :  $scope.auxcomente.estado,    //pessoa avaliou pessoa
                                                            nota : $scope.pessoa.nota,
                                                            tipoavaliacao : 'user',
                                                            comentario: $scope.pessoa.comentario,
                                                                presenca: true}).then(function (res){
        $http.post('https://ec2.diwoapp.com.br/atualizarauxfrase.php' , {iduser :$scope.aux.iduser}).then(function (resp){console.log(resp.data.success)});;
        var alertPopup = $ionicPopup.alert({
          title: 'Obrigado',
          template: 'Por favor avalie as outras pessoas que compareceram ao evento'
        });
        alertPopup.then(function(){
          noti.recebe = $scope.stalkeada.iduser;
          noti.envia = $scope.aux.iduser;
          noti.tipo = 7;
          noti.nomeevento = $scope.evento.nomeevento;
          EventoService.VerificaNotificacao(noti).then(function(res) {
            console.log(res);
            if(res){
              if(!$scope.pushNotification.checked){
                $http.post('https://ec2.diwoapp.com.br/notificapessoa.php', {notificacao : $scope.msg, 
                                                                              idevento : $scope.evento.idevento,
                                                                              nomeevento : $scope.evento.nomeevento,
                                                                              id_user_envia : $scope.aux.iduser,
                                                                              username_envia : $scope.aux.username,
                                                                              apelido_envia : $scope.aux.apelido,
                                                                              tipo : '7', 
                                                                              id_user_recebe : $scope.stalkeada.iduser});
              
                
                if($scope.stalkeada.notiavaliacao== '1'){
                  $scope.pushnoti.titulo = "Você foi avaliado";
                  $scope.pushnoti.msg = $scope.aux.username + ' te avaliou sobre o evento:' + $scope.evento.nomeevento;
                  $scope.pushnoti.token = $scope.stalkeada.devicetoken;
                  EventoService.MandaPushNoti($scope.pushnoti);
                }
              }
            }
          });
          $scope.aux = formUser.getForm();
          $state.go('tabsController.eventoFechado');
        })
      });
    }
  }

  $scope.enterItem =  function(){
    formOutro.updateForm($scope.stalkeada);
    $state.go('tabsController.perfil_outro_evento_criados');
  }


}])
   
.controller('avaliaODoEventoCtrl', ['$scope', '$stateParams', '$state', 'formAux', 'formItem', '$http', '$timeout','$ionicPopup', 'formtela', 'formUser', 'formEventoPerfil', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, $state, formAux, formItem, $http, $timeout, $ionicPopup, formtela, formUser, formEventoPerfil) {

  $scope.evento = {};
  $scope.infoevento = {};
  $scope.noti = {};
  $scope.presente=true;
  $scope.evento.nota = '5';
  $scope.cars = 0;

    $scope.ratingsObject = {
        iconOn : 'ion-ios-star',
        iconOff : 'ion-ios-star-outline',
        iconOnColor: '#ff4444',
        iconOffColor:  '#ff4444',
        rating:  4,
        minRating:1,
        callback: function(rating) {
          $scope.ratingsCallback(rating);
        }
      };
  
      $scope.ratingsCallback = function(rating) {
        console.log('Selected rating is : ', rating);
        $scope.evento.nota = rating;
      };


  $scope.user = formUser.getForm();
  $scope.infoevento = formItem.getForm();
  $scope.noti = formAux.getAux();          /// itens da notificação

  formtela.updateForm(1);

  $scope.$on("$ionicView.enter", function(event, data){
    $scope.evento = {};
    $scope.infoevento = {};
    $scope.evento.nota = '5';

    $scope.tela = formtela.getForm();
    $scope.noti = formAux.getAux();
    $scope.user = formUser.getForm();
    $scope.infoevento = formItem.getForm();
    
    if ($scope.tela==0) {
      formEventoPerfil.updateForm($scope.infoevento);
      $state.go('tabsController.home');
    }
  });

  var Areatxt = document.getElementById("Areatxt");

  Areatxt.addEventListener("keyup",function(){
    var characters = Areatxt.value.split('');
    $scope.cars= characters.length+1;
    console.log($scope.cars)
    if(characters.length > 300){
      Areatxt.value = Areatxt.value.substring(0,300);
    }
  });

  $scope.change = function(){
    $scope.presente = !$scope.presente;
  }
  $scope.reportcoment = function(item){
      $ionicPopup.prompt({
                    title: 'Você quer reportar esse evento pq?',
                    template: 'Não me venha reportando só pq tu quer, não me venha dar trabalho!!!!',
                   inputType: 'text',
                   inputPlaceholder: ' Não foi o que era para ter sido'
                 }).then(function(texto) {
        if(texto){
          $scope.reportmsg = item.idavaliacao + ' (idavaliação) '+texto;
          $http.post('https://ec2.diwoapp.com.br/reportaevento.php', {namereportado : item.nomeevento,
                                                                    reportadoid : item.idevento,
                                                                    iduserreportando : $scope.user.iduser,
                                                                    usernamereportando : $scope.user.username,
                                                                    tiporeport : 'comentario',
                                                                    motivo : $scope.reportmsg}).then(function (tes){
            $scope.response = tes.data;
            var alertPopup = $ionicPopup.alert({
                                      title: 'Obrigado',
                                      template: 'Este evento esta agora sobre investigação'
                                    });
          });
        }
      });
    }

  $scope.pronto = function(){
    console.log($scope.evento.comentario)
    if($scope.evento.comentario == '' || !$scope.evento.comentario){
      var alertPopup = $ionicPopup.alert({
        title: '(๑•̆૩•̆)',
        template: 'Escreva algo!!!!'
      });
    
    }else{
      console.log($scope.presente, $scope.evento.nota);
      $http.post('https://ec2.diwoapp.com.br/deletanotificacao.php', {idnotificacao : $scope.noti.idnotificacao});
      $http.post('https://ec2.diwoapp.com.br/avaliar.php', {idevento : $scope.noti.idevento,
                                                                iduser : $scope.noti.id_user_envia,
                                                                nomeavaliador : $scope.user.username,
                                                                apelidoavaliador : $scope.user.apelido,
                                                                profilepic : $scope.user.profilepic,
                                                                idpessoaavaliada : $scope.noti.idevento,
                                                                nomepessoaavaliada : $scope.noti.nomeevento,
                                                                estado : '0',    //pessoa avaliou
                                                                nota : $scope.evento.nota,
                                                                tipoavaliacao : 'evento',
                                                                comentario: $scope.evento.comentario,
                                                                presenca: $scope.presente}).then(function (res){
        var alertPopup = $ionicPopup.alert({
          title: 'Obrigado',
          template: 'Por favor avalie as outras pessoas que compareceram ao evento'
        });
        alertPopup.then(function(){
          formEventoPerfil.updateForm($scope.infoevento);
          $state.go('tabsController.eventoFechado');
        })
      });
    }
  }

}])

.controller('repeteEventoPart1Ctrl', ['$scope', '$stateParams', 'formEvento', '$state','$ionicPopup', '$timeout', '$http', 'formItem', 'EventoService', 'formUser', 'formEventoEditaperfil', 'formEventoPerfil', '$cordovaCamera', '$cordovaFile', '$cordovaFileTransfer', '$cordovaDevice',  '$ionicLoading','$ionicTabsDelegate', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, formEvento, $state, $ionicPopup, $timeout, $http, formItem, EventoService, formUser, formEventoEditaperfil, formEventoPerfil,$cordovaCamera, $cordovaFile, $cordovaFileTransfer, $cordovaDevice,  $ionicLoading, $ionicTabsDelegate) {
  $scope.evento = {};
  $scope.evento = formEventoEditaperfil.getForm();

  $scope.user = formUser.getForm();
   $scope.auxfoto = '';
  var noti = {};
  $scope.pushnoti = {};

  $scope.limiteconfirmacao ={};
  $scope.fim = {};
  $scope.inicio = {};
  var mudoufoto = false;
  var auxdiainicio = $scope.evento.diainicio;

  $scope.evento.dateconfirma = $scope.evento.dialimiteconfirmacao.toLocaleString();
  $scope.evento.dateinicio = $scope.evento.diainicio;
  $scope.evento.datefim = $scope.evento.diafim;
  
  var currentdate = new Date(); 
  var curr_date = (currentdate.getDate()<10?'0':'') + currentdate.getDate();
  var curr_month = (currentdate.getMonth()<9?'0':'') + (currentdate.getMonth() + 1); //Months are zero based
  var curr_year = currentdate.getFullYear();
  var curr_h = (currentdate.getHours()<10?'0':'') + currentdate.getHours();
  var curr_m = (currentdate.getMinutes()<10?'0':'') + currentdate.getMinutes();
  var curr_j = curr_year + "-" + curr_month + "-" + curr_date+ ' '+curr_h + ':' + curr_m + ':' + '00';
  
  $ionicTabsDelegate.showBar(0);

  EventoService.verificahorariopessoaevento($scope.user).then(function(items) {
    if (items!="Error") {
      $scope.auxdata = items;
    }
  });
  document.getElementById("imageidEventoRPT").src=$scope.evento.eventopic;
  $scope.mudafotoevento = function (optionsCamera) {
    var optionsCamera = {
          quality : 100,
          sourceType : 0,
          allowEdit : true,
          targetWidth: 640,
          targetHeight: 640
    };
    $cordovaCamera.getPicture(optionsCamera).then(function(imageData) {
      $scope.imgURI = imageData;
      mudoufoto = true;
      document.getElementById("imageidEventoRPT").src=imageData;
    }, function(err) {
      console.log(err);
    });
    
  }

  $scope.mudaconfirma = function(){
    novaconfirma_date = ($scope.evento.dateconfirma.getDate()<10?'0':'') + $scope.evento.dateconfirma.getDate();
    novaconfirma_month = ($scope.evento.dateconfirma.getMonth()<9?'0':'') + ($scope.evento.dateconfirma.getMonth() + 1); //Months are zero based
    novaconfirma_year = $scope.evento.dateconfirma.getFullYear();
    novaconfirma_h = ($scope.evento.dateconfirma.getHours()<10?'0':'') + $scope.evento.dateconfirma.getHours();
    novaconfirma_m = ($scope.evento.dateconfirma.getMinutes()<10?'0':'') + $scope.evento.dateconfirma.getMinutes();
    novaconfirma_s = ($scope.evento.dateconfirma.getSeconds()<10?'0':'') + $scope.evento.dateconfirma.getSeconds();
    var novaconfirmaj = novaconfirma_year + "-" + novaconfirma_month + "-" + novaconfirma_date+ ' '+novaconfirma_h + ':' + novaconfirma_m + ':' + novaconfirma_s;
    

    if(curr_j>novaconfirmaj){
      var alertPopup = $ionicPopup.alert({
                  title: '(*ﾉ´□`)ﾉ~',
                  template: 'Muito em cima da hora para mudar pra ontem'
                });
      
    }else{
      if(novaconfirmaj>$scope.evento.diainicio){
        var alertPopup = $ionicPopup.alert({
                  title: 'ヽ ( ꒪д꒪ )ﾉ',
                  template: 'Evento nao pode começar depois da data limite de confirmação'
                });
      }else{
        $scope.limiteconfirmacao.dia =  novaconfirma_date +'/'+ novaconfirma_month;
        $scope.limiteconfirmacao.hora =  novaconfirma_h+':'+novaconfirma_m;  
        $scope.evento.dialimiteconfirmacao = novaconfirmaj;
        $scope.evento.dateconfirma = $scope.evento.dateconfirma.toLocaleString();
      }
    }
  }
  
  $scope.mudainicio = function(){
    var datainvalida = 0;
    
    novadateinicio_date = ($scope.evento.dateinicio.getDate()<10?'0':'') + $scope.evento.dateinicio.getDate();
    novadateinicio_month = ($scope.evento.dateinicio.getMonth()<9?'0':'') + ($scope.evento.dateinicio.getMonth() + 1); //Months are zero based
    novadateinicio_year = $scope.evento.dateinicio.getFullYear();
    novadateinicio_h = ($scope.evento.dateinicio.getHours()<10?'0':'') + $scope.evento.dateinicio.getHours();
    novadateinicio_m = ($scope.evento.dateinicio.getMinutes()<10?'0':'') + $scope.evento.dateinicio.getMinutes();
    novadateinicio_s = ($scope.evento.dateinicio.getSeconds()<10?'0':'') + $scope.evento.dateinicio.getSeconds();
    $scope.evento.semana = $scope.evento.dateinicio.getDay();
    var novadateinicioj = novadateinicio_year + "-" + novadateinicio_month + "-" + novadateinicio_date+ ' '+novadateinicio_h + ':' + novadateinicio_m + ':' + novadateinicio_s;
    
    if(curr_j>novadateinicioj){
      var alertPopup = $ionicPopup.alert({
                  title: '(*ﾉ´□`)ﾉ~',
                  template: 'Muito em cima da hora para mudar pra ontem'
                });
      
    }else{
      if($scope.evento.dialimiteconfirmacao>novadateinicioj){
        var alertPopup = $ionicPopup.alert({
                    title: '(*ﾉ´□`)ﾉ~',
                    template: 'Data de inicio não pode ser antes que a data limite de confirmação'
                  });
        
      }else{
        for(var r = 0;r<$scope.auxdata.length; r++){
          //console.log($scope.auxdata[r].idevento, $scope.auxdata[r].diainicio, $scope.auxdata[r].diafim , we ,$scope.evento.diafim);
          if($scope.evento.idevento!=$scope.auxdata[r].idevento){
            if (($scope.auxdata[r].diainicio <= novadateinicioj && $scope.auxdata[r].diafim >= novadateinicioj)  ) {
              datainvalida = 1;
            }
          }
        }
        if(r==$scope.auxdata.length && datainvalida == 1){
          var alertPopup = $ionicPopup.alert({
            title: 'Oww!!',
            template: 'Tu ja tem um evento marcado nesse horário :/'
          });
        }
        if(novadateinicioj>$scope.evento.datefim){
          console.log("to aquiwenqieni")
          $scope.fim.dia =  '??'+'/'+'??';
          $scope.fim.hora = '??'+':'+'??';
        }
        if(r==$scope.auxdata.length && datainvalida == 0){
          if($scope.evento.semana == 0){
            $scope.evento.semana = "Domingo";
          }
          if($scope.evento.semana == 1){
            $scope.evento.semana = "Segunda-feira";
          }
          if($scope.evento.semana == 2){
            $scope.evento.semana = "Terça-feira";
          }
          if($scope.evento.semana == 3){
            $scope.evento.semana = "Quarta-feira";
          }
          if($scope.evento.semana == 4){
            $scope.evento.semana = "Quinta-feira";
          }
          if($scope.evento.semana == 5){
            $scope.evento.semana = "Sexta-feira";
          }
          if($scope.evento.semana == 6){
            $scope.evento.semana = "Sábado";
          }
          $scope.inicio.dia =  novadateinicio_date +'/'+ novadateinicio_month;
          $scope.inicio.hora =  novadateinicio_h+':'+novadateinicio_m;  
          $scope.evento.diainicio = novadateinicioj;
          $scope.evento.dateinicio = $scope.evento.dateinicio.toLocaleString();
        }
      }
    }
  }

  $scope.mudafim = function(){
    var datainvalida = 0;
    
    novadatefim_date = ($scope.evento.datefim.getDate()<10?'0':'') + $scope.evento.datefim.getDate();
    novadatefim_month = ($scope.evento.datefim.getMonth()<9?'0':'') + ($scope.evento.datefim.getMonth() + 1); //Months are zero based
    novadatefim_year = $scope.evento.datefim.getFullYear();
    novadatefim_h = ($scope.evento.datefim.getHours()<10?'0':'') + $scope.evento.datefim.getHours();
    novadatefim_m = ($scope.evento.datefim.getMinutes()<10?'0':'') + $scope.evento.datefim.getMinutes();
    novadatefim_s = ($scope.evento.datefim.getSeconds()<10?'0':'') + $scope.evento.datefim.getSeconds();
    var novadatedatefimj = novadatefim_year + "-" + novadatefim_month + "-" + novadatefim_date+ ' '+novadatefim_h + ':' + novadatefim_m + ':' + novadatefim_s;
    
    if(curr_j>novadatedatefimj){
      var alertPopup = $ionicPopup.alert({
                  title: '(*ﾉ´□`)ﾉ~',
                  template: 'Muito em cima da hora para mudar pra ontem'
                });
      
    }else{
      if($scope.evento.dialimiteconfirmacao>novadatedatefimj){
        var alertPopup = $ionicPopup.alert({
                    title: '(*ﾉ´□`)ﾉ~',
                    template: 'Data de fim não pode ser antes que a data limite de confirmação'
                  });
        
      }else{
        if($scope.evento.diainicio>=novadatedatefimj){
        var alertPopup = $ionicPopup.alert({
                    title: '(*ﾉ´□`)ﾉ~',
                    template: 'Data de fim não pode ser antes que a data de início'
                  });
        }else{
          for(var r = 0;r<$scope.auxdata.length; r++){
            if($scope.evento.idevento!=$scope.auxdata[r].idevento){
              if (($scope.auxdata[r].diainicio <= novadatedatefimj && $scope.auxdata[r].diafim >= novadatedatefimj)  ) {
                datainvalida = 1;
              }
            }
          }
          if(r==$scope.auxdata.length && datainvalida == 1){
            var alertPopup = $ionicPopup.alert({
              title: 'Oww!!',
              template: 'Tu ja tem um evento marcado nesse horário :/'
            });
          }
          if(r==$scope.auxdata.length && datainvalida == 0){
            $scope.fim.dia =  novadatefim_date +'/'+ novadatefim_month;
            $scope.fim.hora =  novadatefim_h+':'+novadatefim_m;  
            $scope.evento.diafim = novadatedatefimj;
            $scope.evento.datefim = $scope.evento.datefim.toLocaleString();
          }
        }
      }
    }
  }
  
  var hjf = $scope.evento.diafim;
  $scope.fim.dia =  (hjf[8]+hjf[9]).valueOf()+'/'+(hjf[5]+hjf[6]).valueOf();
  $scope.fim.hora = (hjf[11]+hjf[12]).valueOf()+':'+(hjf[14]+hjf[15]).valueOf();
  
  var hj = $scope.evento.diainicio;
  $scope.inicio.dia = (hj[8]+hj[9]).valueOf()+'/'+(hj[5]+hj[6]).valueOf();
  $scope.inicio.hora = (hj[11]+hj[12]).valueOf()+':'+(hj[14]+hj[15]).valueOf();


  var  hjl = $scope.evento.dialimiteconfirmacao;
  $scope.limiteconfirmacao.dia =  (hjl[8]+hjl[9]).valueOf()+'/'+(hjl[5]+hjl[6]).valueOf();
  $scope.limiteconfirmacao.hora =  (hjl[11]+hjl[12]).valueOf()+':'+(hjl[14]+hjl[15]).valueOf();  
  
    $scope.evento.auxtag1 = '';
    $scope.evento.auxtag2 = '';
    $scope.evento.auxtag3 = '';
    $scope.evento.auxtagbutton1 = false;
    $scope.evento.auxtagbutton2 = false;
    $scope.evento.auxtagbutton3 = false;
    $scope.evento.auxtag4 = '';
    $scope.evento.auxtag5 = '';
    $scope.evento.auxtag6 = '';
    $scope.evento.auxtagbutton4 = false;
    $scope.evento.auxtagbutton5 = false;
    $scope.evento.auxtagbutton6 = false;
    $scope.evento.auxtag7 = '';
    $scope.evento.auxtag8 = '';
    $scope.evento.auxtag9 = '';
    $scope.evento.auxtagbutton7 = false;
    $scope.evento.auxtagbutton8 = false;
    $scope.evento.auxtagbutton9 = false;


    $scope.auxtags = {};
    EventoService.Gettags($scope.evento.idevento).then(function(tags) {
      var auxauxtagbut = true;
      $scope.auxtags = tags;
      for(var  i =0; i< tags.length;i++){
         if($scope.evento.auxtagbutton1 == false && auxauxtagbut){
            $scope.evento.auxtag1 = tags[i].tag;
            $scope.evento.auxtagbutton1 = true;
            auxauxtagbut = false;
          }
          if($scope.evento.auxtagbutton2 == false && auxauxtagbut){
            console.log($scope.evento.auxtagbutton2)
            $scope.evento.auxtag2 = tags[i].tag;
            $scope.evento.auxtagbutton2 = true;
            auxauxtagbut = false;
          }
          if($scope.evento.auxtagbutton3 == false && auxauxtagbut){
            $scope.evento.auxtag3 = tags[i].tag;
            $scope.evento.auxtagbutton3 = true;
            auxauxtagbut = false;
          }
          if($scope.evento.auxtagbutton4 == false && auxauxtagbut){
            $scope.evento.auxtag4 = tags[i].tag;
            $scope.evento.auxtagbutton4 = true;
            auxauxtagbut = false;
          }
          if($scope.evento.auxtagbutton5 == false && auxauxtagbut){
            $scope.evento.auxtag5 = tags[i].tag;
            $scope.evento.auxtagbutton5 = true;
            auxauxtagbut = false;
          }
          if($scope.evento.auxtagbutton6 == false && auxauxtagbut){
            $scope.evento.auxtag6 = tags[i].tag;
            $scope.evento.auxtagbutton6 = true;
            auxauxtagbut = false;
          }
          if($scope.evento.auxtagbutton7 == false && auxauxtagbut){
            $scope.evento.auxtag7 = tags[i].tag;
            $scope.evento.auxtagbutton7 = true;
            auxauxtagbut = false;
          }
          if($scope.evento.auxtagbutton8 == false && auxauxtagbut){
            $scope.evento.auxtag8 = tags[i].tag;
            $scope.evento.auxtagbutton8 = true;
            auxauxtagbut = false;
          }
          if($scope.evento.auxtagbutton9 == false && auxauxtagbut){
            $scope.evento.auxtag9 = tags[i].tag;
            $scope.evento.auxtagbutton9 = true;
            auxauxtagbut = false;
          }
          auxauxtagbut = true;
      } 
    });

    var auxauxtagbut = false;
    $scope.adicionatag = function(){
      if($scope.evento.addtag!=''){
        var res2 = $scope.evento.addtag.split(" ") ;
          if(res2.length>1){
            for(var w = 0; w < res2.length; w++){
              var t = res2[w].toLowerCase();
             console.log(t)
            }
            $scope.evento.addtag = res2[0];
          }
        if(!auxauxtagbut){
          auxauxtagbut = true;
          if($scope.evento.auxtagbutton1 == false && auxauxtagbut){
            $scope.evento.auxtag1 = '#' +$scope.evento.addtag;
            $scope.evento.auxtagbutton1 = true;
            auxauxtagbut = false;
          }
          if($scope.evento.auxtagbutton2 == false && auxauxtagbut){
            $scope.evento.auxtag2 = '#' +$scope.evento.addtag;
            $scope.evento.auxtagbutton2 = true;
            auxauxtagbut = false;
          }
          if($scope.evento.auxtagbutton3 == false && auxauxtagbut){
            $scope.evento.auxtag3 = '#' +$scope.evento.addtag;
            $scope.evento.auxtagbutton3 = true;
            auxauxtagbut = false;
          }
          if($scope.evento.auxtagbutton4 == false && auxauxtagbut){
            $scope.evento.auxtag4 = '#' +$scope.evento.addtag;
            $scope.evento.auxtagbutton4 = true;
            auxauxtagbut = false;
          }
          if($scope.evento.auxtagbutton5 == false && auxauxtagbut){
            $scope.evento.auxtag5 = '#' +$scope.evento.addtag;
            $scope.evento.auxtagbutton5 = true;
            auxauxtagbut = false;
          }
          if($scope.evento.auxtagbutton6 == false && auxauxtagbut){
            $scope.evento.auxtag6 = '#' +$scope.evento.addtag;
            $scope.evento.auxtagbutton6 = true;
            auxauxtagbut = false;
          }
          if($scope.evento.auxtagbutton7 == false && auxauxtagbut){
            $scope.evento.auxtag7 = '#' +$scope.evento.addtag;
            $scope.evento.auxtagbutton7 = true;
            auxauxtagbut = false;
          }
          if($scope.evento.auxtagbutton8 == false && auxauxtagbut){
            $scope.evento.auxtag8 = '#' +$scope.evento.addtag;
            $scope.evento.auxtagbutton8 = true;
            auxauxtagbut = false;
          }
          if($scope.evento.auxtagbutton9 == false && auxauxtagbut){
            $scope.evento.auxtag9 = '#' +$scope.evento.addtag;
            $scope.evento.auxtagbutton9 = true;
            auxauxtagbut = false;
          }
        }
      }
      $scope.evento.addtag = '';
    }

    $scope.tiratag1 = function(){
        $scope.evento.auxtagbutton1 = false;
        $scope.evento.auxtag1 = '';
    }
    $scope.tiratag2 = function(){
        $scope.evento.auxtagbutton2 = false;
        $scope.evento.auxtag2 = '';
    }
    $scope.tiratag3 = function(){
        $scope.evento.auxtagbutton3 = false;
        $scope.evento.auxtag3 = '';
    }
    $scope.tiratag4 = function(){
        $scope.evento.auxtagbutton4 = false;
        $scope.evento.auxtag4 = '';
    }
    $scope.tiratag5 = function(){
        $scope.evento.auxtagbutton5 = false;
        $scope.evento.auxtag5 = '';
    }
    $scope.tiratag6 = function(){
        $scope.evento.auxtagbutton6 = false;
        $scope.evento.auxtag6 = '';
    }
    $scope.tiratag7 = function(){
        $scope.evento.auxtagbutton7 = false;
        $scope.evento.auxtag7 = '';
    }
    $scope.tiratag8 = function(){
        $scope.evento.auxtagbutton8 = false;
        $scope.evento.auxtag8 = '';
    }
    $scope.tiratag9 = function(){
        $scope.evento.auxtagbutton9 = false;
        $scope.evento.auxtag9 = '';
    }

    $scope.mudaloc = function(){
      formEventoEditaperfil.updateForm($scope.evento);
      $state.go('tabsController.repeteEventoPart2')
    }

    $scope.mudamais = function(){
      formEventoEditaperfil.updateForm($scope.evento);
      $state.go('tabsController.repeteEventoPart3')
    }

    $scope.salvar = function(evento){
      if ($scope.evento.nomeevento == '') {
        var alertPopup = $ionicPopup.alert({
          title: 'ʕ•ᴥ•ʔ',
          template: 'Coloque um titulo válido'
        });
      }else{
        if($scope.evento.diafim <$scope.evento.diainicio){
          var alertPopup = $ionicPopup.alert({
            title: 'ʕ•ᴥ•ʔ',
            template: 'Data de termino eh antes do dia de inicio!! Assim não da'
          });
        }else{
          var existe = 0;
          var link = 'https://ec2.diwoapp.com.br/deletatag.php';
          $http.post(link, {idevento : $scope.evento.idevento}).then(function(items) {
            if($scope.evento.auxtagbutton1 == true){
              existe = 0;
              var link = 'https://ec2.diwoapp.com.br/criartag.php';
              $http.post(link, {idevento : $scope.evento.idevento, 
                                      tag : $scope.evento.auxtag1});
            }
            if($scope.evento.auxtagbutton2 == true){
              existe = 0;
              var link = 'https://ec2.diwoapp.com.br/criartag.php';
              $http.post(link, {idevento : $scope.evento.idevento, 
                                      tag : $scope.evento.auxtag2});
            }
            if($scope.evento.auxtagbutton3 == true){
              existe = 0;
              var link = 'https://ec2.diwoapp.com.br/criartag.php';
              $http.post(link, {idevento : $scope.evento.idevento, 
                                      tag : $scope.evento.auxtag3});
            }
            if($scope.evento.auxtagbutton4 == true){
              existe = 0;
              var link = 'https://ec2.diwoapp.com.br/criartag.php';
              $http.post(link, {idevento : $scope.evento.idevento, 
                                      tag : $scope.evento.auxtag4});
            }
            if($scope.evento.auxtagbutton5 == true){
              existe = 0;
              var link = 'https://ec2.diwoapp.com.br/criartag.php';
              $http.post(link, {idevento : $scope.evento.idevento, 
                                      tag : $scope.evento.auxtag5});
            }
            if($scope.evento.auxtagbutton6 == true){
              existe = 0;
              var link = 'https://ec2.diwoapp.com.br/criartag.php';
              $http.post(link, {idevento : $scope.evento.idevento, 
                                      tag : $scope.evento.auxtag6});
            }
            if($scope.evento.auxtagbutton7 == true){
              existe = 0;
              var link = 'https://ec2.diwoapp.com.br/criartag.php';
              $http.post(link, {idevento : $scope.evento.idevento, 
                                      tag : $scope.evento.auxtag7});
            }
            if($scope.evento.auxtagbutton8 == true){
              existe = 0;
              var link = 'https://ec2.diwoapp.com.br/criartag.php';
              $http.post(link, {idevento : $scope.evento.idevento, 
                                      tag : $scope.evento.auxtag8});
            }
            if($scope.evento.auxtagbutton9 == true){
              existe = 0;
              var link = 'https://ec2.diwoapp.com.br/criartag.php';
              $http.post(link, {idevento : $scope.evento.idevento, 
                                      tag : $scope.evento.auxtag9});
            }
          });

          
          if(mudoufoto == true){
            console.log($scope.imgURI)
              if($scope.imgURI != "img/ev.png"){ 
                $scope.auxfoto = $scope.evento.nomeevento + $scope.evento.diainicio;
                var mystring = String($scope.auxfoto);
                mystring = mystring.replace(/[^a-zA-Z0-9]/g, '');
                $scope.evento.eventopic = 'https://s3.amazonaws.com/diwoappprofilepics/eventopicsdiwo/' + mystring + '.jpg';
              }else{
                 $scope.evento.eventopic = "img/ev.png";
              }
              var url = "https://ec2.diwoapp.com.br/uploadfotoevento.php";
                                      // File for Upload
              var targetPath = $scope.imgURI;
             
              // File name only
              //var name = $scope.imgURI.substr(imageData.lastIndexOf('/') + 1);
              var filename = mystring + '.jpg';
              // NO CASO SERIA O NOME DO USUARIO.jpg O fileName
              var options = {
                fileKey: "file",
                fileName: filename,
                chunkedMode: false,
                mimeType: "multipart/form-data"
              };
              $cordovaFileTransfer.upload(url, targetPath, options).then(function(result) {
                $scope.evento.datamodificacao = new Date();
               EventoService.atualizarevento($scope.evento).then(function(msg){
                $ionicLoading.hide();
                var alertPopup = $ionicPopup.alert({
                title: 'ʕ•ᴥ•ʔ',
                template: msg
              });
        alertPopup.then(function(){
          EventoService.GetParticipantes($scope.evento.idevento).then(function(items) {
            $scope.msgnoti = 'O evento: '+$scope.evento.nomeevento +' foi mudado'
            for (var i = 0; i < items.length; i++) {
              if ($scope.user.iduser != items[i].iduser) {
                noti.recebeusername = items[i].username;
                noti.recebe = items[i].iduser;
                noti.envia = $scope.user.iduser;
                noti.tipo = 4;
                noti.nomeevento = $scope.evento.nomeevento;
                EventoService.VerificaNotificacao(noti).then(function(res) {
                  console.log(res);
                  if(res){
                    $http.post('https://ec2.diwoapp.com.br/notificapessoa.php', {notificacao : $scope.msgnoti, 
                          idevento : $scope.evento.idevento,
                          nomeevento : $scope.evento.nomeevento,
                          id_user_envia : $scope.user.iduser,
                          username_envia : $scope.user.username,
                          apelido_envia : $scope.user.apelido,
                          tipo : '4',    //update no evento
                          id_user_recebe : noti.recebe}).then(function (res){
                         $scope.response = res.data;
                         console.log($scope.response.msg)
                    });
                    EventoService.getusuario2(noti.recebeusername).then(function(user) {
                      if(user.notiparticipando== '1'){
                      $scope.pushnoti.titulo =  'Mudanças!' ;
                      $scope.pushnoti.msg = $scope.msgnoti;
                      $scope.pushnoti.token = user.devicetoken;
                      EventoService.MandaPushNoti($scope.pushnoti);
                    }
                    });
                  }
                });
              }
            }
          })
          formEventoPerfil.updateForm($scope.evento);
          $state.go('tabsController.eventoCriado');
        })
        }, function(errMsg) {
          var alertPopup = $ionicPopup.alert({
            title: 'Register failed!',
            template: errMsg
          });
        })
              }, function(err) {
                $ionicPopup.alert({
                  title: 'Sorry!',
                  template: 'Aconteceu um probleminha, tente de novo'
                });
                $ionicLoading.hide();
              }, function (progress) {
                $ionicLoading.show({
                  title: '┗(＾0＾)┓',
                  template: '┗(＾0＾)┓'
                });
              });
            }else{
              $scope.evento.datamodificacao = new Date();
               EventoService.atualizarevento($scope.evento).then(function(msg){
                $ionicLoading.hide();
        var alertPopup = $ionicPopup.alert({
                title: 'ʕ•ᴥ•ʔ',
                template: msg
              });
        alertPopup.then(function(){
          EventoService.GetParticipantes($scope.evento.idevento).then(function(items) {
            $scope.msgnoti = 'O evento: '+$scope.evento.nomeevento +' foi mudado'
            for (var i = 0; i < items.length; i++) {
              if ($scope.user.iduser != items[i].iduser) {
                noti.recebeusername = items[i].username;
                noti.recebe = items[i].iduser;
                noti.envia = $scope.user.iduser;
                noti.tipo = 4;
                noti.nomeevento = $scope.evento.nomeevento;
                EventoService.VerificaNotificacao(noti).then(function(res) {
                  console.log(res);
                  if(res){
                    $http.post('https://ec2.diwoapp.com.br/notificapessoa.php', {notificacao : $scope.msgnoti, 
                          idevento : $scope.evento.idevento,
                          nomeevento : $scope.evento.nomeevento,
                          id_user_envia : $scope.user.iduser,
                          username_envia : $scope.user.username,
                          apelido_envia : $scope.user.apelido,
                          tipo : '4',    //update no evento
                          id_user_recebe : noti.recebe}).then(function (res){
                         $scope.response = res.data;
                         console.log($scope.response.msg)
                    });
                    EventoService.getusuario2(noti.recebeusername).then(function(user) {
                      if(user.notiparticipando== '1'){
                      $scope.pushnoti.titulo =  'Mudanças!' ;
                      $scope.pushnoti.msg = $scope.msgnoti;
                      $scope.pushnoti.token = user.devicetoken;
                      EventoService.MandaPushNoti($scope.pushnoti);
                    }
                    });
                  }
                });
              }
            }
          })
          formEventoPerfil.updateForm($scope.evento);
          $state.go('tabsController.eventoCriado');
        })
        }, function(errMsg) {
          var alertPopup = $ionicPopup.alert({
            title: 'Register failed!',
            template: errMsg
          });
        })
            }
          
       
      }
    }
    }


}])
     
.controller('repeteEventoPart2Ctrl', ['$scope', '$stateParams', '$cordovaGeolocation', '$state', '$ionicLoading', 'formEventoEditaperfil', 'formItem', '$ionicPopup',  // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, $cordovaGeolocation, $state, $ionicLoading, formEventoEditaperfil, formItem, $ionicPopup) {
  $scope.evento = {};
  $scope.evento = formEventoEditaperfil.getForm();
  $scope.centerPoint={};
  $scope.LimiteFuncionamentoDiwo = false;
 //$scope.coord = {};
  var lat;
  var long;
  var map;
  var myLatlng;
  var mapOptions;
  var marker;
  var geocoder;
  var infowindow;
  $scope.disableTap = function(){
     container = document.getElementsByClassName('pac-container');
     // disable ionic data tab
     angular.element(container).attr('data-tap-disabled', 'true');
     // leave input field if google-address-entry is selected
     angular.element(container).on("click", function(){
                                   document.getElementById('pac-input').blur();
                                   });
     };
  $scope.$on("$ionicView.enter", function(event, data){
    $scope.evento = {};
    $scope.evento = formEventoEditaperfil.getForm();
    $scope.centerPoint={};
    $scope.LimiteFuncionamentoDiwo = false; 
    lat  = $scope.evento.lat;
    long = $scope.evento.lng;     
    myLatlng = new google.maps.LatLng(lat, long);
    mapOptions = {
          center: myLatlng,
          zoom: 16,
          mapTypeId: google.maps.MapTypeId.ROADMAP
      };          
             
       map = new google.maps.Map(document.getElementById("map_canvas"), mapOptions); 
       marker = new google.maps.Marker({
                position: new google.maps.LatLng(lat, long),
                map: map,
                title: "Borai",
                draggable: true,
                icon: 'http://maps.google.com/mapfiles/ms/icons/green-dot.png',
                animation: google.maps.Animation.DROP 
            })
       geocoder = new google.maps.Geocoder;
       infowindow = new google.maps.InfoWindow({maxWidth: 200});
       function arePointsNear(checkPoint, centerPoint, km) {
                  var ky = 40000 / 360;
                  var kx = Math.cos(Math.PI * centerPoint.lat / 180.0) * ky;
                  var dx = Math.abs(centerPoint.lng - $scope.evento.lng) * kx;
                  var dy = Math.abs(centerPoint.lat - $scope.evento.lat) * ky;
                  return Math.sqrt(dx * dx + dy * dy) <= km;
                }
      geocoder.geocode({'location': myLatlng}, function(results, status) {
        if (status === 'OK') {
          if (results[1]) {
            $scope.evento.nomelocal = results[0].address_components[0].long_name;
            $scope.evento.endereco = results[0].formatted_address;
            for(var i = 0;i<results[0].address_components.length;i++){
              if(results[0].address_components[i].types[0] == "administrative_area_level_2"){
                $scope.evento.cidade = results[0].address_components[i].long_name;
                console.log($scope.evento.cidade)
              }
            }
            $scope.evento.lat = lat;
            $scope.evento.lng = long;
            $scope.centerPoint.lat = -26.997799;
            $scope.centerPoint.lng = -48.632733; 
            $scope.centerPointKM = 30;
            $scope.LimiteFuncionamentoDiwo = arePointsNear($scope.evento, $scope.centerPoint,$scope.centerPointKM );
            
            infowindow.setContent(results[0].formatted_address);
            // console.log($scope.evento.endereco);
            // console.log($scope.evento.cidade);
            // console.log($scope.evento.lng);
            // console.log($scope.evento.lat);
            infowindow.open(map, marker);
            setTimeout(function () { infowindow.close(); }, 5000);
          } else {
            window.alert('Resultado não encontrado');
          }
        } else {
          window.alert('Ocorreu uma falha doida :' + status);
        }
      });
  });
  
     var posOptions = {
            enableHighAccuracy: true,
            timeout: 200000,
            maximumAge: 0
        };

    navigator.geolocation.getCurrentPosition(function(position){
          
            lat  = $scope.evento.lat;
            long = $scope.evento.lng;
             

            myLatlng = new google.maps.LatLng(lat, long);
             
            mapOptions = {
                center: myLatlng,
                zoom: 16,
                mapTypeId: google.maps.MapTypeId.ROADMAP
            };          
             
            map = new google.maps.Map(document.getElementById("map_canvas"), mapOptions); 


            marker = new google.maps.Marker({
                      position: new google.maps.LatLng(lat, long),
                      map: map,
                      title: "Borai",
                      draggable: true,
                      icon: 'http://maps.google.com/mapfiles/ms/icons/green-dot.png',
                      animation: google.maps.Animation.DROP 
                  })

            geocoder = new google.maps.Geocoder;
            infowindow = new google.maps.InfoWindow({
                                                              maxWidth: 200
                                                            });

            geocoder.geocode({'location': myLatlng}, function(results, status) {
                  if (status === 'OK') {
                    if (results[1]) {
                      $scope.evento.nomelocal = results[0].address_components[0].long_name;
                      $scope.evento.endereco = results[0].formatted_address;
                      for(var i = 0;i<results[0].address_components.length;i++){
                        if(results[0].address_components[i].types[0] == "administrative_area_level_2"){
                          $scope.evento.cidade = results[0].address_components[i].long_name;
                          console.log($scope.evento.cidade)
                        }
                      }
                      $scope.evento.lat = lat;
                      $scope.evento.lng = long;
                      $scope.centerPoint.lat = -26.997799;
                      $scope.centerPoint.lng = -48.632733; 
                      $scope.centerPointKM = 30;
                      $scope.LimiteFuncionamentoDiwo = arePointsNear($scope.evento, $scope.centerPoint,$scope.centerPointKM );
                      
                      // $scope.evento.lat = position.coords.latitude;
                      // $scope.evento.lng = position.coords.longitude;
                      infowindow.setContent(results[0].formatted_address);
                      console.log($scope.evento.endereco);
                      console.log($scope.evento.cidade);
                      console.log($scope.evento.lng);
                      console.log($scope.evento.lat);
                      //infowindow.setContent(results[0].address_components[2].long_name);
                      infowindow.open(map, marker);
                      setTimeout(function () { infowindow.close(); }, 5000);
                    } else {
                      window.alert('Resultado não encontrado');
                    }
                  } else {
                    window.alert('Ocorreu uma falha doida :' + status);
                  }
                });


            google.maps.event.addListener(marker, "dragstart", function (event) {
               marker.setAnimation(3); // raise
            });

            google.maps.event.addListener(marker, "dragend", function (event) {
               marker.setAnimation(4); // raise
            });

            marker.addListener('dragend', handleEvent);
            google.maps.event.addListener(map, 'click', function(e) {
              
                markers.forEach(function(marker) {
                  marker.setMap(null);
                });
                markers = [];

                placeMarker(e.latLng, map, marker);

            });
            function arePointsNear(checkPoint, centerPoint, km) {
                  var ky = 40000 / 360;
                  var kx = Math.cos(Math.PI * centerPoint.lat / 180.0) * ky;
                  var dx = Math.abs(centerPoint.lng - $scope.evento.lng) * kx;
                  var dy = Math.abs(centerPoint.lat - $scope.evento.lat) * ky;
                  return Math.sqrt(dx * dx + dy * dy) <= km;
                }

            function placeMarker(latlng, map, marker) {
                marker.setPosition(latlng);
                marker.setMap(map);
                map.panTo(latlng);
                $scope.evento.lat = latlng.lat();
                $scope.evento.lng = latlng.lng();
                $scope.centerPoint.lat = -26.997799;
                $scope.centerPoint.lng = -48.632733; 
                $scope.centerPointKM = 30;
                $scope.LimiteFuncionamentoDiwo = arePointsNear($scope.evento, $scope.centerPoint,$scope.centerPointKM );
            
                geocoder.geocode({'location': latlng}, function(results, status) {
                  if (status === 'OK') {
                    if (results[1]) {
                      $scope.evento.nomelocal = results[0].address_components[0].long_name;
                      for(var i = 0;i<results[0].address_components.length;i++){
                        if(results[0].address_components[i].types[0] == "administrative_area_level_2"){
                          $scope.evento.cidade = results[0].address_components[i].long_name;
                          console.log($scope.evento.cidade)
                        }
                      }
                      $scope.evento.endereco = results[0].formatted_address;
                      console.log($scope.evento.endereco);
                      console.log($scope.evento.cidade);
                      console.log($scope.evento.lng);
                      console.log($scope.evento.lat);
                      infowindow.setContent(results[0].formatted_address);
                     
                      infowindow.open(map, marker);
                      setTimeout(function () { infowindow.close(); }, 5000);
                    } else {
                      window.alert('Resultado não encontrado');
                    }
                  } else {
                    window.alert('Ocorreu uma falha doida :' + status);
                  }
                });
            };        

            function handleEvent(event) {
                $scope.evento.lat = event.latLng.lat();
                $scope.evento.lng = event.latLng.lng();
                $scope.centerPoint.lat = -26.997799;
                $scope.centerPoint.lng = -48.632733; 
                $scope.centerPointKM = 30;
                $scope.LimiteFuncionamentoDiwo = arePointsNear($scope.evento, $scope.centerPoint,$scope.centerPointKM );
            
                              // GEOCODER INVERSO

                var geocoder = new google.maps.Geocoder;
                var infowindow = new google.maps.InfoWindow({
                                                              maxWidth: 200
                                                            });;    
            
                geocoder.geocode({'location': event.latLng}, function(results, status) {
                  if (status === 'OK') {
                    if (results[1]) {
                      $scope.evento.nomelocal = results[0].address_components[0].long_name;
                      for(var i = 0;i<results[0].address_components.length;i++){
                        if(results[0].address_components[i].types[0] == "administrative_area_level_2"){
                          $scope.evento.cidade = results[0].address_components[i].long_name;
                          console.log($scope.evento.cidade)
                        }
                      }
                      $scope.evento.endereco = results[0].formatted_address;
                      // console.log($scope.evento.endereco);
                      // console.log($scope.evento.cidade);
                      // console.log($scope.evento.lng);
                      // console.log($scope.evento.lat);
                      infowindow.setContent(results[0].formatted_address);
                     
                      infowindow.open(map, marker);
                      setTimeout(function () { infowindow.close(); }, 5000);
                    } else {
                      window.alert('Resultado não encontrado');
          }
        } else {
          window.alert('Ocorreu uma falha doida :' + status); 
                  }
                });
            }

                              // GEOCODER INVERSO

                
            function arePointsNear(checkPoint, centerPoint, km) {
                  var ky = 40000 / 360;
                  var kx = Math.cos(Math.PI * centerPoint.lat / 180.0) * ky;
                  var dx = Math.abs(centerPoint.lng - $scope.evento.lng) * kx;
                  var dy = Math.abs(centerPoint.lat - $scope.evento.lat) * ky;
                  return Math.sqrt(dx * dx + dy * dy) <= km;
                }
                
            
                    //        SEARCHBOX

            var input = document.getElementById('pac-input');
            var searchBox = new google.maps.places.SearchBox(input);
        //map.controls[google.maps.ControlPosition.TOP_LEFT].push(input);

        // Bias the SearchBox results towards current map's viewport.
            map.addListener('bounds_changed', function() {
                searchBox.setBounds(map.getBounds());
            });

            var markers = [];
        // Listen for the event fired when the user selects a prediction and retrieve
        // more details for that place.
            searchBox.addListener('places_changed', function() {
                var places = searchBox.getPlaces();

                if (places.length == 0) {
                  return;
                }

                // Clear out the old markers.
                markers.forEach(function(marker) {
                  marker.setMap(null);
                });
                markers = [];

                // For each place, get the icon, name and location.
                var bounds = new google.maps.LatLngBounds();
                places.forEach(function(place) {
                  if (!place.geometry) {
                    console.log("Returned place contains no geometry");
                    return;
                  }
                  // var icon = {
                  //   url: place.icon,
                  //   size: new google.maps.Size(71, 71),
                  //   origin: new google.maps.Point(0, 0),
                  //   anchor: new google.maps.Point(17, 34),
                  //   scaledSize: new google.maps.Size(25, 25)
                  // };

                  // Create a marker for each place.
                  markers.push(new google.maps.Marker({
                    map: map,
                    // icon: icon,
                    title: place.name,
                    position: place.geometry.location
                  }));

                  $scope.evento.nomelocal = place.name;
                  $scope.evento.endereco = place.formatted_address;
                  for(var i = 0;i<place.address_components.length;i++){
                    //console.log(place.address_components[i].types[0])
                    if(place.address_components[i].types[0] == "administrative_area_level_2"){
                      $scope.evento.cidade = place.address_components[i].long_name;
                      console.log($scope.evento.cidade)
                    }
                  }
                  $scope.evento.lat = place.geometry.location.lat();
                  $scope.evento.lng = place.geometry.location.lng();
                  $scope.centerPoint.lat = -26.997799;
                  $scope.centerPoint.lng = -48.632733; 
                  $scope.centerPointKM = 30;
                  $scope.LimiteFuncionamentoDiwo = arePointsNear($scope.evento, $scope.centerPoint,$scope.centerPointKM );
            

                  // console.log($scope.coord.endereco);
                  // console.log($scope.coord.long);
                  // console.log($scope.coord.lat);

                  if (place.geometry.viewport) {
                    // Only geocodes have viewport.
                    bounds.union(place.geometry.viewport);
                  } else {
                    bounds.extend(place.geometry.location);
                  }
                });
                map.fitBounds(bounds);
            });
            $scope.map = map;  
             
        }, function(err) {
            console.log(err.code);
            console.log(err.message);
        });


        $scope.getCriar = function(evento) {
          if($scope.LimiteFuncionamentoDiwo){
            formEventoEditaperfil.updateForm($scope.evento);
            $state.go('tabsController.repeteEventoPart1');
          }else{
            var alertPopup = $ionicPopup.alert({
                title: '( ꒪Д꒪)ノ',
                template: 'Ótimo saber que você quer criar um evento! Mas parece que a região onde você quer criar seu evento não está na nossa área de cobertura :/'
              }); 
          }
          
        }

}])

.controller('repeteEventoPart3Ctrl', ['$scope', '$stateParams', '$state', 'formEventoEditaperfil', 'formItem', '$ionicPopup','formUser', '$ionicTabsDelegate',  // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, $state, formEventoEditaperfil, formItem, $ionicPopup, formUser, $ionicTabsDelegate) {
  $scope.evento = {};
  $scope.evento = formEventoEditaperfil.getForm();

  $scope.user = formUser.getForm();
  
  if($scope.user.genero == "fem"){
    $scope.femin = true;
  }else{
    $scope.femin = false;
  }
  $ionicTabsDelegate.showBar(0);


  // if($scope.evento.dificuldade == "Não importa"){
  //   $scope.evento.dificuldaden = 1;
  // }
  // if($scope.evento.dificuldade == "Fácil"){
  //   $scope.evento.dificuldaden = 2;
  // }
  // if($scope.evento.dificuldade == "Moderado"){
  //   $scope.evento.dificuldaden = 3;
  // }
  // if($scope.evento.dificuldade == "Difícil"){
  //   $scope.evento.dificuldaden = 4;
  // }

  // $scope.ch = function(){
  //   if($scope.evento.dificuldaden == 1){
  //     $scope.evento.dificuldade = "Não importa";
  //   }
  //   if($scope.evento.dificuldaden == 2){
  //     $scope.evento.dificuldade = "Fácil";
  //   }
  //   if($scope.evento.dificuldaden == 3){
  //     $scope.evento.dificuldade = "Moderado";
  //   }
  //   if($scope.evento.dificuldaden == 4){
  //     $scope.evento.dificuldade = "Difícil";
  //   }
  // }

  var header = document.getElementById("barpor");
  var btns = header.getElementsByClassName("btnpor");
  for (var i = 0; i < btns.length; i++) {
    btns[i].addEventListener("click", function() {
      var current = document.getElementsByClassName("actr");
      current[0].className = current[0].className.replace(" actr", "");
      this.className += " actr";
    });
  }
  $scope.menos = function(){
    if($scope.evento.pmin >2){
      $scope.evento.pmin--;
    }
  }
  $scope.mais = function(){
    if($scope.evento.pmin < 49){
      $scope.evento.pmin++;
      if($scope.evento.pmin >= $scope.evento.pmax){
        $scope.evento.pmax = $scope.evento.pmin+1;
      }
      
    }
  }

  $scope.menosmax = function(){
    if($scope.evento.pmax >3){
      $scope.evento.pmax--;
      if($scope.evento.pmax <= $scope.evento.pmin){
        $scope.evento.pmin = $scope.evento.pmax-1;
      }
    }
  }
  $scope.maismax = function(){
    if($scope.evento.pmax < 50){
      $scope.evento.pmax++;
    }
  }
  // $scope.evento.auxpmax = $scope.evento.pmax;
  // $scope.mudamax = function() {
  //   if (!$scope.evento.pmax) {
  //     var alertPopup = $ionicPopup.alert({
  //     title: 'Register failed!',
  //     template: 'Favor preencher todos os campos'
  //   });
  //   }else{    
  //     if (parseInt($scope.evento.pmax) < parseInt($scope.evento.pmin)) {
  //       var alertPopup = $ionicPopup.alert({
  //               title: 'Matematimatematica',
  //               template: 'Máximo de pessoas nao pode ser maior que mínino xD'
  //             });
  //     }else{
  //       if (parseInt($scope.evento.pmax) >= 50) {
  //         var alertPopup = $ionicPopup.alert({
  //                 title: 'Muuuuita gente',
  //                 template: 'Limite máximo de pessoas para um evento é 50 personas'
  //               });
  //       }else{
  //         $scope.evento.pmax = $scope.evento.auxpmax;
  //       }
  //     }
  //   }
  // };
  // $scope.evento.auxpmin = $scope.evento.pmin;
  // $scope.mudamin = function() {
  //   if (!$scope.evento.pmin) {
  //     var alertPopup = $ionicPopup.alert({
  //     title: 'Register failed!',
  //     template: 'Favor preencher todos os campos'
  //   });
  //   }else{    
  //     if (parseInt($scope.evento.pmin)<=1) {
  //       var alertPopup = $ionicPopup.alert({
  //               title: '=/',
  //               template: 'Não da pra fazer um evento só com você né'
  //             });
  //     }else{
  //       $scope.evento.pmin = $scope.evento.auxpmin;
  //     }
  //   }
  // };

  $scope.pessoa = function() {$scope.evento.precopor = 1;};
  $scope.hora = function() {$scope.evento.precopor = 2;};

  $scope.getCriar = function(evento) {
  var palavrasnaousar = ["ALIAMBA", "ANUS", "BAGULIO"
      , "BANZA", "BARRUFO", "BECK", "BEQUE", "BOCETA"
      , "BOLAGATO", "BOQUETE", "BOLCAT", "BOSSETA", "BOSTANA", "BREXA", "BRIOCO", "BRONHA", "BUCA", "BUCETA"
      , "BUSSETA", "CANABIS", "CANNABIS", "CARALHO"
      , "CASSETA", "CASSETE", "CHECHECA", "CHERECA", "CHIBUMBA", "CHIBUMBO", "CHOTA", "CHOCHOTA", "CHUPADA", "CHUPADO", "CLITORIS"
      , "COCAINA","C+"
      , "C*", "CURALHO", "CUZAO", "CUZUDA", "CUZUDO", "CUZÃO", "ESPORRADA", "ESPORRADO", "ESPORRO", "estupro"
      , "FELACAO", "FELACÃO", "FODA", "FODAO", "FODÃO", "FODAUM", "FODE", "FODIDA", "FODIDO", "FORNICA", "FUDENDO", "FUDECÃO", "FUDECAO"
      , "FUDIDA", "FUDIDO", "GRELINHO", "GRELO", "ISCROTA", "ISCROTO", "MACONHA", "MASTURBA", "MASTURBAÇÃO", "MASTURBACÃO", "MASTURBACAO"
      , "PENIS", "PEN1S", "PENES", "PENIZ", "PICA", "PIROCA", "PIRU", "PORRA", "POURRA", "PROSTIBULO", "PUTA", "PUNHETA", "PUTO"
      , "RABAO", "TESTUDA", "TESTUDO", "VAGABUNDA", "VAGINA", "VIADO", "VIADAO", "VIADÃO", "XAVASCA", "XERERECA", "XEXECA", "XOTA"
      , "XOCHOTA", "XOXOTA", "XANA", "XANINHA", "MDMA",  "VSF", "TNC", "FDP", "CRACK"];
      var error = 0; 
      for (var i = 0; i < palavrasnaousar.length; i++) {
        var res2 = $scope.evento.descricao.split("_") ;
        if(res2.length>1){
          for(var w = 0; w < res2.length; w++){
            var val = palavrasnaousar[i].toLowerCase();
            if ((res2[w].toLowerCase()).indexOf(val.toString()) > -1) {  
              error = error + 1;  
            }
          }
        }else{
          var val = palavrasnaousar[i].toLowerCase();  
          if (($scope.evento.descricao.toLowerCase()).indexOf(val.toString()) > -1) {  
            error = error + 1;  
          }
        }
        var res3 = $scope.evento.descricao.split(" ") ;
        if(res3.length>1){
          for(var w = 0; w < res3.length; w++){
            var val = palavrasnaousar[i].toLowerCase();
            if ((res3[w].toLowerCase()).indexOf(val.toString()) > -1) {  
              error = error + 1;  
            }
          }
        }else{
          var val = palavrasnaousar[i].toLowerCase();  
          if (($scope.evento.descricao.toLowerCase()).indexOf(val.toString()) > -1) {  
            error = error + 1;  
          }
        }   
      } 
      if (error > 0) {  
          var alertPopup = $ionicPopup.alert({
                title: '（・о・；）',
                template: 'Que boquinha suja eim, usaste uma palavra inapropriada né'
              }); 
      }else{
        if (!$scope.evento.pmax || !$scope.evento.pmin) {
                    var alertPopup = $ionicPopup.alert({
                    title: 'Register failed!',
                    template: 'Favor preencher todos os campos'
                  });

        }else{
          if (parseInt($scope.evento.pmin)<=1) {
            var alertPopup = $ionicPopup.alert({
                    title: '=/',
                    template: 'Não da pra fazer um evento só com você né'
                  });
          }else{
            if (parseInt($scope.evento.pmax) <= parseInt($scope.evento.pmin)) {
              var alertPopup = $ionicPopup.alert({
                      title: 'Matematimatematica',
                      template: 'Mínimo de pessoas nao pode ser maior que máximo xD'
                    });
            }else{
              if (parseInt($scope.evento.pmax) >= 50) {
                var alertPopup = $ionicPopup.alert({
                        title: 'Muuuuita gente',
                        template: 'Limite máximo de pessoas para um evento é 50 personas'
                      });
              }else{
        if(evento.descricao){
          formEventoEditaperfil.updateForm($scope.evento);
          $state.go('tabsController.repeteEventoPart1');
        }else{
          var alertPopup = $ionicPopup.alert({
                title: '( ꒪Д꒪)ノ',
                template: 'Escreva algo na descrição do evento para ajudar as pessoas a entenderem o que será feito'
              }); 
        }   
            }
          }
        }
      }
      }
  }


   
}])
   
.controller('repeteEventoPart4Ctrl', ['$scope', '$stateParams', '$state', 'formEvento', 'formUser','$ionicPopup', '$http', 'formtela2','formEditar', 'EventoService', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, $state, formEvento, formUser, $ionicPopup, $http, formtela2, formEditar, EventoService) {
 $scope.evento = formEvento.getForm();
 $scope.telaeditar = formEditar.getForm();

 $scope.confirmacao = 'aprovado';
  $scope.estado = '0';
  $scope.auxtela = formtela2.getForm();
  var res2 = [];
  var noti = {};
  console.log($scope.auxtela);
  EventoService.Gettags($scope.evento.idevento).then(function(tags) {
    for(var  i =0; i< tags.length;i++){
         res2[i] =  tags[i].tag;
        } 
  });
  $scope.mudanome = false;
  $scope.pushnoti = {};
   $scope.user = formUser.getForm(); /// mudar aqui o Formuser
    //console.log($scope.user.iduser);
  $scope.$on("$ionicView.enter", function(event, data){
    $scope.evento = {};
    $scope.evento = formEvento.getForm();
    $scope.telaeditar = 1;
    $scope.pushnoti = {};
    $scope.confirmacao = 'aprovado';
    $scope.estado = '0';
    $scope.auxtela = formtela2.getForm();
    var res2 = [];
    var noti = {};
    console.log($scope.auxtela);
    EventoService.Gettags($scope.evento.idevento).then(function(tags) {
      for(var  i =0; i< tags.length;i++){
           res2[i] =  tags[i].tag;
          } 
    });
    $scope.mudanome = false;
    $scope.user = formUser.getForm();
    if ($scope.telaeditar == 1) {
      $scope.mudanome = true;
     }
    $scope.auxtela = formtela2.getForm();
    if ($scope.auxtela == 1) {
      $state.go('tabsController.EditaEEAPart1');
    }
  });
  
  $scope.getCriar = function(evento) {
      if (!$scope.evento.pmax || !$scope.evento.pmin) {
                    var alertPopup = $ionicPopup.alert({
                    title: 'Register failed!',
                    template: 'Favor preencher todos os campos'
                  });

         }else{
          if (parseInt($scope.evento.pmin)<=1) {
            var alertPopup = $ionicPopup.alert({
                    title: '=/',
                    template: 'Não da pra fazer um evento só com você né'
                  });
          }else{
            if (parseInt($scope.evento.pmax) < parseInt($scope.evento.pmin)) {
              var alertPopup = $ionicPopup.alert({
                      title: 'Matematimatematica',
                      template: 'Mínimo de pessoas nao pode ser maior que máximo xD'
                    });
            }else{
          if (parseInt($scope.evento.pmax) >= 50) {
                var alertPopup = $ionicPopup.alert({
                        title: 'Muuuuita gente',
                        template: 'Limite máximo de pessoas para um evento é 50 personas'
                      });
              }else{
            if ($scope.telaeditar == 1) {
              console.log('oi');
              $scope.evento.datamodificacao = new Date();
             EventoService.atualizarevento($scope.evento).then(function(msg){
             var alertPopup = $ionicPopup.alert({
                      title: 'ʕ•ᴥ•ʔ',
                      template: msg
                    });
                       alertPopup.then(function(){
                        EventoService.GetParticipantes($scope.evento.idevento).then(function(items) {
                        $scope.msgnoti = 'O evento: '+$scope.evento.nomeevento +' foi mudado'
                           for (var i = 0; i < items.length; i++) {
                            if ($scope.user.iduser != items[i].iduser) {
                                  noti.recebeusername = items[i].username;
                                  noti.recebe = items[i].iduser;
                                  noti.envia = $scope.user.iduser;
                                  noti.tipo = 4;
                                  noti.nomeevento = $scope.evento.nomeevento;
                                  EventoService.VerificaNotificacao(noti).then(function(res) {
                                    console.log(res);
                                    if(res){
                                      $http.post('https://ec2.diwoapp.com.br/notificapessoa.php', {notificacao : $scope.msgnoti, 
                                            idevento : $scope.evento.idevento,
                                            nomeevento : $scope.evento.nomeevento,
                                            id_user_envia : $scope.user.iduser,
                                            username_envia : $scope.user.username,
                                            apelido_envia : $scope.aux.apelido,
                                            tipo : '4',    //update no evento
                                            id_user_recebe : noti.recebe}).then(function (res){
                                           $scope.response = res.data;
                                           console.log($scope.response.msg)
                                         });
                                      EventoService.getusuario2(noti.recebeusername).then(function(user) {
                                        if(user.notiparticipando== '1'){
                                        $scope.pushnoti.titulo =  'Mudanças!' ;
                                        $scope.pushnoti.msg = $scope.msgnoti;
                                        $scope.pushnoti.token = user.devicetoken;
                                         EventoService.MandaPushNoti($scope.pushnoti);
                                       }
                                      } );
                                    }
                                  });
                                }
                          }
                         })
                             $state.go('tabsController.perfil');
                        })
                  }, function(errMsg) {
                    var alertPopup = $ionicPopup.alert({
                      title: 'Register failed!',
                      template: errMsg
                    });
                  })
                            /// AQUI TEMOS QUE COMPARAR SE HOUVE INCLUSAO DE UMA TAG NOVA
                  if( $scope.evento.tags!=''){
                    console.log("com tag adicionada");
                    var res = $scope.evento.tags.split(" ") ;
                    var array3 = res.filter(function(obj) { return res2.indexOf(obj) == -1; });
                    for (var i = 0; i<array3.length;i++){
                      if(array3[i][0]!='#'){
                        array3[i]= '#' + array3[i];
                      }
                      var link = 'https://ec2.diwoapp.com.br/criartag.php';
                        $http.post(link, {idevento : $scope.evento.idevento, 
                                          tag : array3[i]});
                      }
                  }
                  
            }else{
                $ionicPopup.prompt({
                    title: 'Qual nome devo dar?',
                    template: 'Não vamos esquecer de dar nomes aos bois',
                   inputType: 'text',
                   inputPlaceholder: ' Nome legal'
                 }).then(function(nomeevento) {
                  $scope.evento.nomeevento = nomeevento;
                    console.log('Nome do evento é', nomeevento);
                 
           if (nomeevento && nomeevento !='' && nomeevento !=' ') {
            console.log($scope.evento.dialimiteconfirmacao)
            var link = 'https://ec2.diwoapp.com.br/criarevento.php';
            $http.post(link, {nomeevento : $scope.evento.nomeevento, 
                          duracao : $scope.evento.duracao,
                          diainicio : $scope.evento.diainicio,
                          semana : $scope.evento.semana,
                          diafim : $scope.evento.diafim,
                          dialimiteconfirmacao: $scope.evento.dialimiteconfirmacao,
                          pmin : $scope.evento.pmin, 
                          pmax : $scope.evento.pmax,
                          patual : 1, 
                          adm : $scope.user.iduser,
                          admusername : $scope.user.username,
                          admapelido : $scope.user.apelido,
                          preco : $scope.evento.preco,
                          precopor : $scope.evento.precopor, 
                          nomelocal : $scope.evento.nomelocal,
                          endereco : $scope.evento.endereco,
                          estado : '0',
                          cidade : $scope.evento.cidade,
                          lat : $scope.evento.lat,
                          lng : $scope.evento.lng,
                          dificuldade :$scope.evento.dificuldade,
                          genero : $scope.evento.genero,
                          descricao : $scope.evento.descricao,
                          comerciodevicetoken : $scope.user.devicetoken}).then(function (res){
            $scope.responsecriado = res.data;
            

            if ($scope.responsecriado.success == true) {
                // console.log($scope.responsecriado.last);
                // console.log($scope.user.iduser);
                // console.log($scope.evento.nomeevento);
                // console.log($scope.confirmacao);
                // console.log($scope.evento.estado);
                if( $scope.evento.tags!=''){
                  console.log("com tag adicionada");
                  var res = $scope.evento.tags.split(" ") ;
                  var array3 = res.filter(function(obj) { return res2.indexOf(obj) == -1; });
                  for (var i = 0; i<array3.length;i++){
                    var link = 'https://ec2.diwoapp.com.br/criartag.php';
                    $http.post(link, {idevento : $scope.responsecriado.last, 
                                      tag : array3[i]});
                   }
                 }

              var link = 'https://ec2.diwoapp.com.br/irevento.php';
                  $http.post(link, {idevento : $scope.responsecriado.last, 
                                    iduser : $scope.user.iduser,
                                    idadm : $scope.user.iduser, 
                                    admusername : $scope.user.username,
                                    borda : $scope.user.borda,
                                    username : $scope.user.username,
                                    apelido : $scope.user.apelido,
                                    borda : $scope.user.borda,
                                    profilepic : $scope.user.profilepic,
                                    devicetoken : $scope.user.devicetoken,
                                    diainicio : $scope.evento.diainicio,
                                    confirmacao : $scope.confirmacao,
                                    nomeevento :  $scope.evento.nomeevento,
                                    idComercioParceiro : $scope.evento.idComercioParceiro, 
                                    //eventopic : $scope.evento.eventopic, 
                                    estado : $scope.estado}).then(function (res){
                  $scope.response = res.data;
                  console.log($scope.response);
                    if ($scope.response.success == true) {
                        var alertPopup = $ionicPopup.alert({
                      title: 'Parabéns',
                      template: $scope.responsecriado.msg
                    }); 
                        alertPopup.then(function(){
                        formtela2.updateForm(1);
                        $scope.evento = {};
                        formEvento.updateForm($scope.evento);
                         $state.go('tabsController.home');
                       })
                      }else{
                        var alertPopup = $ionicPopup.alert({
                      title: 'Ocorreu uma falha',
                      template: $scope.responsecriado.msg
                    });
                        alertPopup.then(function(){
                        $state.go('tabsController.home');
                       })
                      }
                    })
                  }
            });

           }else{console.log('dasd');}
        });
            }
  }
         
          }}

         }
  }

}])

.controller('EditaEventoPart1Ctrl', ['$scope', '$stateParams', 'formEvento', '$state','$ionicPopup', '$timeout', 'formtela2', 'formItem', 'EventoService', 'formUser', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, formEvento, $state, $ionicPopup, $timeout, formtela2, formItem, EventoService, formUser) {
  $scope.evento = {};
  $scope.evento = formItem.getForm();
  $scope.user = formUser.getForm();
   $scope.auxfoto = '';
  $scope.auxdata = {};
  $scope.evento.date = $scope.evento.diainicio;
  $scope.evento.tags = '';
  $scope.evento.tagsvelhos = '';
  var auxh;
  var h2;
  var auxdiainicio
  EventoService.Gettags($scope.evento.idevento).then(function(tags) {
        for(var  i =0; i< tags.length;i++){
          if(i == 0){
            $scope.evento.tagsvelhos = tags[i].tag;
          }else{
            $scope.evento.tagsvelhos = ($scope.evento.tagsvelhos + ' ' + tags[i].tag);
          } 
        } 
      });
  var currentdate = new Date(); 
  var curr_date2 = (currentdate.getDate()<10?'0':'') + currentdate.getDate();
  var curr_month2 = (currentdate.getMonth()<9?'0':'') + (currentdate.getMonth() + 1); //Months are zero based
  var curr_year2 = currentdate.getFullYear();
  var h22 = (currentdate.getHours()<10?'0':'') + currentdate.getHours();
  var m22 = (currentdate.getMinutes()<10?'0':'') + currentdate.getMinutes();

  var curr_date = ($scope.evento.diainicio[8]+$scope.evento.diainicio[9]).valueOf();
  h2 = ($scope.evento.diainicio[11]+$scope.evento.diainicio[12]).valueOf();
  var m2 = ($scope.evento.diainicio[14]+$scope.evento.diainicio[15]).valueOf();
  var curr_month = ($scope.evento.diainicio[5]+$scope.evento.diainicio[6]).valueOf();
  var s2 = ($scope.evento.diainicio[17]+$scope.evento.diainicio[18]).valueOf();
  var curr_year = ($scope.evento.diainicio[0]+$scope.evento.diainicio[1]+$scope.evento.diainicio[2]+$scope.evento.diainicio[3]).valueOf();
  var datainvalida = 0;
  var h = ($scope.evento.duracao[0]+$scope.evento.duracao[1]).valueOf();
  var m  = ($scope.evento.duracao[3]+$scope.evento.duracao[4]).valueOf(); 
  var ano = curr_year-curr_year2;
  var mes = curr_month-curr_month2;
  var dia = curr_date-curr_date2;
  var he = h2-h22;             
  var me = m2-m22;

  var header = document.getElementById("barpor");
  var btns = header.getElementsByClassName("btnpor");
  for (var i = 0; i < btns.length; i++) {
    btns[i].addEventListener("click", function() {
      var current = document.getElementsByClassName("actr");
      current[0].className = current[0].className.replace(" actr", "");
      this.className += " actr";
    });
  }
  $scope.pessoa = function() {$scope.evento.precopor = 1;};
  $scope.hora = function() {$scope.evento.precopor = 2;};

  $scope.duvida = function() {var alertPopup = $ionicPopup.alert({
                      title: 'Para ver se vai rolar ou não',
                      template: 'Uma vez que chega na data limite de confirmação, caso o evento não atinja o número mínimo de pessoas, o evento será cancelado automaticamente.'
                    });};
  $scope.duvida2 = function() {var alertPopup = $ionicPopup.alert({
                      title: 'Cobrar como?',
                      template: 'Em alguns casos como quadras é cobrado por hora e em outros é cobrado por pessoa, então é melhor deixar avisado certinho né.'
                    });};
  $scope.duvida3= function() {var alertPopup = $ionicPopup.alert({
                      title: 'Respeito ao gênero',
                      template: 'O evento não aparecerá para pessoas que não forem do gênero selecionado'
                    });};
   $scope.duvida4= function() {var alertPopup = $ionicPopup.alert({
                      title: 'Pra que serve essas hashtags?',
                      template: 'Fica mais fácil para outras pessoas acharem seu evento pelas tags.'
                    });};
  $scope.user = formUser.getForm();
  if($scope.user.genero == "fem"){
    $scope.femin = true;
  }else{
    $scope.femin = false;
  }
  $scope.$on("$ionicView.enter", function(event, data){
    formtela2.updateForm(0);
    $scope.evento = {};
    $scope.evento = formItem.getForm();
    $scope.evento.tags = '';
    $scope.evento.tagsvelhos = '';
    $scope.evento.date = $scope.evento.diainicio;
    auxdiainicio = $scope.evento.diainicio;
    h2 = ($scope.evento.diainicio[11]+$scope.evento.diainicio[12]).valueOf();
    auxh = ($scope.evento.dialimiteconfirmacao[11]+$scope.evento.dialimiteconfirmacao[12]).valueOf();
    if(0>=(h2 - auxh)){
      $scope.evento.redzone = (h2 - auxh +24).toString();
    }else{
      $scope.evento.redzone = (h2 - auxh).toString();
    }
    console.log($scope.evento.redzone, auxh , h2)
    EventoService.Gettags($scope.evento.idevento).then(function(tags) {
        for(var  i =0; i< tags.length;i++){
          if(i == 0){
            $scope.evento.tagsvelhos = tags[i].tag;
          }else{
            $scope.evento.tagsvelhos = ($scope.evento.tagsvelhos + ' ' + tags[i].tag);
          } 
        } 
      });
    EventoService.verificahorariopessoaevento($scope.user).then(function(items) {
      $scope.auxdata = items;
    });
     currentdate = new Date(); 
     curr_date2 = (currentdate.getDate()<10?'0':'') + currentdate.getDate();
     curr_month2 = (currentdate.getMonth()<9?'0':'') + (currentdate.getMonth() + 1); //Months are zero based
     curr_year2 = currentdate.getFullYear();
     h22 = (currentdate.getHours()<10?'0':'') + currentdate.getHours();
     m22 = (currentdate.getMinutes()<10?'0':'') + currentdate.getMinutes();

     curr_date = ($scope.evento.diainicio[8]+$scope.evento.diainicio[9]).valueOf();
     h2 = ($scope.evento.diainicio[11]+$scope.evento.diainicio[12]).valueOf();
     m2 = ($scope.evento.diainicio[14]+$scope.evento.diainicio[15]).valueOf();
     curr_month = ($scope.evento.diainicio[5]+$scope.evento.diainicio[6]).valueOf();
     s2 = ($scope.evento.diainicio[17]+$scope.evento.diainicio[18]).valueOf();
     curr_year = ($scope.evento.diainicio[0]+$scope.evento.diainicio[1]+$scope.evento.diainicio[2]+$scope.evento.diainicio[3]).valueOf();
     datainvalida = 0;
     h = ($scope.evento.duracao[0]+$scope.evento.duracao[1]).valueOf();
     m  = ($scope.evento.duracao[3]+$scope.evento.duracao[4]).valueOf();
     ano = curr_year-curr_year2;
      mes = curr_month-curr_month2;
      dia = curr_date-curr_date2;
      he = h2-h22;             
      me = m2-m22;
     auxh = ($scope.evento.dialimiteconfirmacao[11]+$scope.evento.dialimiteconfirmacao[12]).valueOf();
    if(0>=(h2 - auxh)){
      $scope.evento.redzone = (h2 - auxh +24).toString();
    }else{
      $scope.evento.redzone = (h2 - auxh).toString();
    } 

    if($scope.evento.dificuldade == "Não importa"){
      $scope.evento.dificuldaden = 1;
    }
    if($scope.evento.dificuldade == "Fácil"){
      $scope.evento.dificuldaden = 2;
    }
    if($scope.evento.dificuldade == "Moderado"){
      $scope.evento.dificuldaden = 3;
    }
    if($scope.evento.dificuldade == "Difícil"){
      $scope.evento.dificuldaden = 4;
    }
    
  });

  
  console.log(curr_date);

  auxh = ($scope.evento.dialimiteconfirmacao[11]+$scope.evento.dialimiteconfirmacao[12]).valueOf();

  
  if(0>=(h2 - auxh)){
    $scope.evento.redzone = (h2 - auxh +24).toString();
  }else{
    $scope.evento.redzone = (h2 - auxh).toString();
  }
  console.log($scope.evento.redzone, auxh , h2)

  var curr_date4;
  var curr_date5;
  var h4
  var m4 
  var curr_month4;
  var curr_month5;
  var s4
  var curr_year4
  var curr_year5;
  var i;

  $scope.ch = function(){
    if($scope.evento.dificuldaden == 1){
      $scope.evento.dificuldade = "Não importa";
    }
    if($scope.evento.dificuldaden == 2){
      $scope.evento.dificuldade = "Fácil";
    }
    if($scope.evento.dificuldaden == 3){
      $scope.evento.dificuldade = "Moderado";
    }
    if($scope.evento.dificuldaden == 4){
      $scope.evento.dificuldade = "Difícil";
    }
  }

  $scope.muda = function(){
    curr_date = ($scope.evento.date.getDate()<10?'0':'') + $scope.evento.date.getDate();
    curr_month = ($scope.evento.date.getMonth()<9?'0':'') + ($scope.evento.date.getMonth() + 1); //Months are zero based
    curr_year = $scope.evento.date.getFullYear();
    h2 = ($scope.evento.date.getHours()<10?'0':'') + $scope.evento.date.getHours();
    m2 = ($scope.evento.date.getMinutes()<10?'0':'') + $scope.evento.date.getMinutes();
    s2 = ($scope.evento.date.getSeconds()<10?'0':'') + $scope.evento.date.getSeconds();
    $scope.evento.semana = $scope.evento.date.getDay();
     if($scope.evento.semana == 0){
      $scope.evento.semana = "Domingo";
    }
    if($scope.evento.semana == 1){
      $scope.evento.semana = "Segunda-feira";
    }
    if($scope.evento.semana == 2){
      $scope.evento.semana = "Terça-feira";
    }
    if($scope.evento.semana == 3){
      $scope.evento.semana = "Quarta-feira";
    }
    if($scope.evento.semana == 4){
      $scope.evento.semana = "Quinta-feira";
    }
    if($scope.evento.semana == 5){
      $scope.evento.semana = "Sexta-feira";
    }
    if($scope.evento.semana == 6){
      $scope.evento.semana = "Sábado";
    }
    var j = curr_year + "-" + curr_month + "-" + curr_date+ ' '+h2 + ':' + m2 + ':' + s2;
            //$scope.evento.date = $scope.evento.date.toLocaleString();
    $scope.evento.diainicio = j;

    datainvalida = 0;
    ano = curr_year-curr_year2;
    mes = curr_month-curr_month2;
    dia = curr_date-curr_date2;
    he = h2-h22;             
    me = m2-m22;

    if(ano<0){
     var alertPopup = $ionicPopup.alert({
        title: 'Falha na data!!',
        template: 'Coloque uma data valida s`il vous plait'
      });
      console.log('data invalida');
    }else{
      if (ano == 0) {
        if(mes<0){
          var alertPopup = $ionicPopup.alert({
            title: 'Falha na data!!',
            template: 'Coloque uma data valida s`il vous plait'
          });
          console.log('data invalida');
        }else{
          if (mes==0) {
            if(dia<0){
              var alertPopup = $ionicPopup.alert({
                title: 'Falha na data!!',
                template: 'Coloque uma data valida s`il vous plait'
              });
              console.log('data invalida');
            }else{
              if((dia==1 && j<auxdiainicio && he <=0)||(dia==0 && j<auxdiainicio)){
                var alertPopup = $ionicPopup.alert({
                  title: '(*ﾉ´□`)ﾉ~',
                  template: 'Muito em cima da hora para mudar a data do evento para mais cedo!!'
                });
                $scope.evento.diainicio = auxdiainicio;
                console.log('data invalida');
              }
              if (dia==0 && he<3){
              var alertPopup = $ionicPopup.alert({
                title: 'ヽ ( ꒪д꒪ )ﾉ',
                template: 'Muito em cima da hora para mudar um evento, no mínimo umas 3 horas de antecedência'
              });
              console.log('data invalida');
              }else{
                $scope.evento.date = $scope.evento.date.toLocaleString();
              }
            }
          }
        }
      }
    }
  }


  $scope.red = function(){
    if(ano==0 && mes == 0 && (dia == 0 && $scope.evento.redzone >= h) || (dia == 1 && $scope.evento.redzone >= h+24)){
      console.log($scope.evento.redzone)
      var alertPopup = $ionicPopup.alert({
        title: 'ლ(ﾟдﾟლ)',
        template: 'A hora limite para confirmação ja passou de agora, ninguem vai conseguir confirmar ida. Selecione um horario válido'
      });
      $scope.evento.redzone = "1";
    }
  }

  $scope.muda2 = function(){
    h = ($scope.evento.duracao.getHours()<10?'0':'') + $scope.evento.duracao.getHours();
    m = ($scope.evento.duracao.getMinutes()<10?'0':'') + $scope.evento.duracao.getMinutes();
    i = h + ':' + m;
    $scope.evento.duracao = i;
  }

  $scope.getCriar = function(evento) {
    
      var res = $scope.evento.tags.split(/[ #]+/) ;
      $scope.test = formtela2.getForm();
      if (!$scope.evento.preco) {$scope.preco=0}
      if (!$scope.evento.duracao || !$scope.evento.date ) {
        var alertPopup = $ionicPopup.alert({
          title: 'Falha no engano!!',
          template: 'Preciso saber a data e ou duração do evento'
        });
      }else{
        i = h + ':' + m;
        $scope.evento.duracao = i;
        console.log($scope.evento.duracao)
              var h3 = parseFloat(h2)+parseFloat(h);
              var m3 = parseFloat(m2) +parseFloat(m);

              var diafimeventodate; 
              var diafimeventomonth;
              var diafimeventoyear;
              var fimfim;
              $scope.evento.duracao = i;
              var horapositiva = parseFloat(h)-parseFloat(h2);
              var minutopositiva = parseFloat(m)-parseFloat(m2);
              if(horapositiva<0){
                var diafimevento = new Date();
                diafimevento.setDate(diainiciodoevento.getDate() + 1);
                diafimeventodate = (diafimevento.getDate()<10?'0':'') + diafimevento.getDate();
                diafimeventomonth = (diafimevento.getMonth()<10?'0':'') + (diafimevento.getMonth() + 1); //Months are zero based
                diafimeventoyear = diafimevento.getFullYear();
                fimfim = diafimeventoyear + "-" + diafimeventomonth + "-" + diafimeventodate+ ' '+h + ':' + m;
                $scope.evento.diafim = fimfim;
              }else{
                if(horapositiva == 0 && minutopositiva<0 ){
                  var diafimevento = new Date();
                  diafimevento.setDate(diainiciodoevento.getDate() + 1);
                  diafimeventodate = (diafimevento.getDate()<10?'0':'') + diafimevento.getDate();
                  diafimeventomonth = (diafimevento.getMonth()<10?'0':'') + (diafimevento.getMonth() + 1); //Months are zero based
                  diafimeventoyear = diafimevento.getFullYear();
                  fimfim = diafimeventoyear + "-" + diafimeventomonth + "-" + diafimeventodate+ ' '+h + ':' + m;
                  $scope.evento.diafim = fimfim;
                }else{
                  $scope.evento.diafim = curr_year + "-" + curr_month + "-" + curr_date+ ' '+h + ':' + m;
                }
              }
              var we = curr_year + "-" + curr_month + "-" + curr_date+ ' '+h2 + ':' + m2 + ':' + s2;
              // var we = curr_year + "-" + curr_month + "-" + curr_date+ ' '+h2 + ':' + m2 + ':' + s2;
              // if(m3>59){
              //   m3 = m3.valueOf()-60;
              //   h3 = h3.valueOf()+1;
              // }
              // curr_year4 = curr_year;
              // curr_month4 = curr_month;
              // curr_date4 = curr_date;
              // if(h3.valueOf()>23){
              //   h3 = h3.valueOf()-24;
              //   curr_date4 = parseFloat(curr_date)+1;
              //     if(curr_date4<1){
              //       curr_month4 = parseFloat(curr_month)-1;
              //       if(curr_month4==1||curr_month4==3||curr_month4==5||curr_month4==7||curr_month4==8||curr_month4==10||curr_month4==12){
              //         curr_date4 = curr_date4.valueOf()+31;
              //       }
              //       if(curr_month4==4||curr_month4==6||curr_month4==9||curr_month4==11){
              //         curr_date4 = curr_date4.valueOf()+30;
              //       }
              //       if(curr_month4==2){
              //         curr_date4 = curr_date4.valueOf()+28;
              //       }
              //       if(curr_month4<1){
              //         curr_year4 = parseFloat(curr_year)-1;
              //       }
              //     }
              // }

              // h3 = (h3<10?'0':'')+h3;
              // m3 = (m3<10?'0':'')+m3;
              // curr_date4 = (curr_date4<10?'0':'')+curr_date4;
              // $scope.evento.diafim = curr_year4 + "-" + curr_month4 + "-" + curr_date4+ ' '+h3 + ':' + m3 + ':' + s2;
              //console.log(h2 ,$scope.evento.redzone );

            curr_year5 = curr_year;
            curr_date5 = curr_date;
            curr_month5 = curr_month;
            h4 = parseFloat(h2)-parseFloat($scope.evento.redzone);
            //console.log(h4)
            if(h4<0){
              h4 = h4.valueOf()+24;
              curr_date5 = parseFloat(curr_date)-1;
              if(curr_date5<1){
                curr_month5 = parseFloat(curr_month)-1;
                if(curr_month5==1||curr_month5==3||curr_month5==5||curr_month5==7||curr_month5==8||curr_month5==10||curr_month5==12){
                  curr_date5 = curr_date5.valueOf()+31;
                }
                if(curr_month5==4||curr_month5==6||curr_month5==9||curr_month5==11){
                  curr_date5 = curr_date5.valueOf()+30;
                }
                if(curr_month5==2){
                  curr_date5 = curr_date5.valueOf()+28;
                }
                if(curr_month5<1){
                  curr_year5 = parseFloat(curr_year)-1;
                }
              }
            }
            if(h4 == 0){
              curr_date5 = parseFloat(curr_date5)-1;
              if(curr_date5<1){
                curr_month5 = parseFloat(curr_month5)-1;
                if(curr_month5==1||curr_month5==3||curr_month5==5||curr_month5==7||curr_month5==8||curr_month5==10||curr_month5==12){
                  curr_date5 = curr_date5.valueOf()+31;
                }
                if(curr_month5==4||curr_month5==6||curr_month5==9||curr_month5==11){
                  curr_date5 = curr_date5.valueOf()+30;
                }
                if(curr_month5==2){
                  curr_date5 = curr_date5.valueOf()+28;
                }
                if(curr_month5<1){
                  curr_year5 = parseFloat(curr_year5)-1;
                }
              }
            }
            h4 = (h4<10?'0':'')+h4;
            curr_date5 = (parseFloat(curr_date5)<10?'0':'')+parseFloat(curr_date5);
            curr_month5 = (parseFloat(curr_month5)<9?'0':'')+parseFloat(curr_month5);
            var j = curr_year5 + "-" + curr_month5 + "-" + curr_date5+ ' '+h4 + ':' + m2 + ':' + s2;
            
            $scope.evento.dialimiteconfirmacao = j;
            console.log($scope.evento.diafim ,  $scope.evento.dialimiteconfirmacao);
              if($scope.evento.semana == 0){
                $scope.evento.semana = "Domingo";
              }
              if($scope.evento.semana == 1){
                $scope.evento.semana = "Segunda-feira";
              }
              if($scope.evento.semana == 2){
                $scope.evento.semana = "Terça-feira";
              }
              if($scope.evento.semana == 3){
                $scope.evento.semana = "Quarta-feira";
              }
              if($scope.evento.semana == 4){
                $scope.evento.semana = "Quinta-feira";
              }
              if($scope.evento.semana == 5){
                $scope.evento.semana = "Sexta-feira";
              }
              if($scope.evento.semana == 6){
                $scope.evento.semana = "Sábado";
              }
               for(var r = 0;r<$scope.auxdata.length; r++){
                //console.log($scope.auxdata[r].idevento, $scope.auxdata[r].diainicio, $scope.auxdata[r].diafim , we ,$scope.evento.diafim);
                if($scope.evento.idevento!=$scope.auxdata[r].idevento){
                  if (($scope.auxdata[r].diainicio < we && $scope.auxdata[r].diafim > we) || ($scope.auxdata[r].diainicio<$scope.evento.diafim && $scope.auxdata[r].diafim>$scope.evento.diafim) ||($scope.auxdata[r].diainicio > we && $scope.auxdata[r].diafim<$scope.evento.diafim) || ($scope.auxdata[r].diainicio < we && $scope.auxdata[r].diafim>$scope.evento.diafim) ) {
                    console.log('horario invalido');
                    datainvalida = 1;
                  }
                }
              }
             //console.log (datainvalida , r)
              ///        ╭∩╮(︶‿︶)╭∩╮
            if(datainvalida == 0 && r==$scope.auxdata.length){
              // $scope.evento.date = $scope.evento.date.toDateString("yyyy-MM-dd HH:mm");
              // $scope.evento.diafim = $scope.evento.diafim.toDateString("yyyy-MM-dd HH:mm");
               formEvento.updateForm($scope.evento);
               //console.log($scope.evento.duracao);
              // console.log($scope.evento.date);
               $state.go('tabsController.EditaEventoPart2');
            }
            if(datainvalida ==1){
              var alertPopup = $ionicPopup.alert({
                    title: 'Oww!!',
                    template: 'Tu ja tem um evento marcado nesse horário :/'
                  });
            }
          

          }
        
    }


}])
     
.controller('EditaEventoPart2Ctrl', ['$scope', '$stateParams', '$cordovaGeolocation', '$state', '$ionicLoading', 'formEventoEdita', 'formItem', '$ionicPopup',  // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, $cordovaGeolocation, $state, $ionicLoading, formEventoEdita, formItem, $ionicPopup) {
  $scope.evento = {};
  $scope.evento = formEventoEdita.getForm();
  $scope.centerPoint={};
  $scope.LimiteFuncionamentoDiwo = false;
  var lat;
  var long;
  var map;
  var myLatlng;
  var mapOptions;
  var marker;
  var geocoder;
  var infowindow;
  $scope.disableTap = function(){
     container = document.getElementsByClassName('pac-container');
     // disable ionic data tab
     angular.element(container).attr('data-tap-disabled', 'true');
     // leave input field if google-address-entry is selected
     angular.element(container).on("click", function(){
                                   document.getElementById('pac-input').blur();
                                   });
     };
    
    lat  = $scope.evento.lat;
    long = $scope.evento.lng;     
    myLatlng = new google.maps.LatLng(lat, long);
    mapOptions = {
          center: myLatlng,
          zoom: 16,
          mapTypeId: google.maps.MapTypeId.ROADMAP
      };          
             
       map = new google.maps.Map(document.getElementById("map_canvas"), mapOptions); 
       marker = new google.maps.Marker({
                position: new google.maps.LatLng(lat, long),
                map: map,
                title: "Borai",
                draggable: true,
                icon: 'http://maps.google.com/mapfiles/ms/icons/green-dot.png',
                animation: google.maps.Animation.DROP 
            })
       geocoder = new google.maps.Geocoder;
       infowindow = new google.maps.InfoWindow({maxWidth: 200});
      function arePointsNear(checkPoint, centerPoint, km) {
                  var ky = 40000 / 360;
                  var kx = Math.cos(Math.PI * centerPoint.lat / 180.0) * ky;
                  var dx = Math.abs(centerPoint.lng - $scope.evento.lng) * kx;
                  var dy = Math.abs(centerPoint.lat - $scope.evento.lat) * ky;
                  return Math.sqrt(dx * dx + dy * dy) <= km;
                }
      geocoder.geocode({'location': myLatlng}, function(results, status) {
        if (status === 'OK') {
          if (results[1]) {
            $scope.evento.nomelocal = results[0].address_components[0].long_name;
            $scope.evento.endereco = results[0].formatted_address;
            for(var i = 0;i<results[0].address_components.length;i++){
              if(results[0].address_components[i].types[0] == "administrative_area_level_2"){
                $scope.evento.cidade = results[0].address_components[i].long_name;
                console.log($scope.evento.cidade)
              }
            }
            $scope.evento.lat = lat;
            $scope.evento.lng = long;
            $scope.centerPoint.lat = -26.997799;
            $scope.centerPoint.lng = -48.632733; 
            $scope.centerPointKM = 30;
            $scope.LimiteFuncionamentoDiwo = arePointsNear($scope.evento, $scope.centerPoint,$scope.centerPointKM );
            infowindow.setContent(results[0].formatted_address);
            infowindow.open(map, marker);
            setTimeout(function () { infowindow.close(); }, 5000);
          } else {
            window.alert('Resultado não encontrado');
          }
        } else {
          window.alert('Ocorreu uma falha doida :' + status);
        }
      });

  $scope.$on("$ionicView.enter", function(event, data){
    $scope.evento = {};
    $scope.evento = formEventoEdita.getForm();
    $scope.centerPoint={};
    $scope.LimiteFuncionamentoDiwo = false;
    var posOptions = {
            enableHighAccuracy: true,
            timeout: 200000,
            maximumAge: 0
        };

    navigator.geolocation.getCurrentPosition(function(position){
          
            lat  = $scope.evento.lat;
            long = $scope.evento.lng;
             

            myLatlng = new google.maps.LatLng(lat, long);
             
            mapOptions = {
                center: myLatlng,
                zoom: 16,
                mapTypeId: google.maps.MapTypeId.ROADMAP
            };          
             
            map = new google.maps.Map(document.getElementById("map_canvas"), mapOptions); 


            marker = new google.maps.Marker({
                      position: new google.maps.LatLng(lat, long),
                      map: map,
                      title: "Borai",
                      draggable: true,
                      icon: 'http://maps.google.com/mapfiles/ms/icons/green-dot.png',
                      animation: google.maps.Animation.DROP 
                  })

            geocoder = new google.maps.Geocoder;
            infowindow = new google.maps.InfoWindow({
                                                              maxWidth: 200
                                                            });

            geocoder.geocode({'location': myLatlng}, function(results, status) {
                  if (status === 'OK') {
                    if (results[1]) {
                      $scope.evento.nomelocal = results[0].address_components[0].long_name;
                      $scope.evento.endereco = results[0].formatted_address;
                      for(var i = 0;i<results[0].address_components.length;i++){
                        if(results[0].address_components[i].types[0] == "administrative_area_level_2"){
                          $scope.evento.cidade = results[0].address_components[i].long_name;
                          console.log($scope.evento.cidade)
                        }
                      }
                      $scope.evento.lat = lat;
                      $scope.evento.lng = long;
                      $scope.centerPoint.lat = -26.997799;
                      $scope.centerPoint.lng = -48.632733; 
                      $scope.centerPointKM = 30;
                      $scope.LimiteFuncionamentoDiwo = arePointsNear($scope.evento, $scope.centerPoint,$scope.centerPointKM );
                      // $scope.evento.lat = position.coords.latitude;
                      // $scope.evento.lng = position.coords.longitude;
                      infowindow.setContent(results[0].formatted_address);
                      console.log($scope.evento.endereco);
                      console.log($scope.evento.cidade);
                      console.log($scope.evento.lng);
                      console.log($scope.evento.lat);
                      //infowindow.setContent(results[0].address_components[2].long_name);
                      infowindow.open(map, marker);
                      setTimeout(function () { infowindow.close(); }, 5000);
                    } else {
                      window.alert('Resultado não encontrado');
          }
        } else {
          window.alert('Ocorreu uma falha doida :' + status);
                  }
                });


            google.maps.event.addListener(marker, "dragstart", function (event) {
               marker.setAnimation(3); // raise
            });

            google.maps.event.addListener(marker, "dragend", function (event) {
               marker.setAnimation(4); // raise
            });

            marker.addListener('dragend', handleEvent);
            google.maps.event.addListener(map, 'click', function(e) {
              
                markers.forEach(function(marker) {
                  marker.setMap(null);
                });
                markers = [];

                placeMarker(e.latLng, map, marker);

            });
            function arePointsNear(checkPoint, centerPoint, km) {
                  var ky = 40000 / 360;
                  var kx = Math.cos(Math.PI * centerPoint.lat / 180.0) * ky;
                  var dx = Math.abs(centerPoint.lng - $scope.evento.lng) * kx;
                  var dy = Math.abs(centerPoint.lat - $scope.evento.lat) * ky;
                  return Math.sqrt(dx * dx + dy * dy) <= km;
                }

            function placeMarker(latlng, map, marker) {
                marker.setPosition(latlng);
                marker.setMap(map);
                map.panTo(latlng);
                $scope.evento.lat = latlng.lat();
                $scope.evento.lng = latlng.lng();
                $scope.centerPoint.lat = -26.997799;
                $scope.centerPoint.lng = -48.632733; 
                $scope.centerPointKM = 30;
                $scope.LimiteFuncionamentoDiwo = arePointsNear($scope.evento, $scope.centerPoint,$scope.centerPointKM );
                geocoder.geocode({'location': latlng}, function(results, status) {
                  if (status === 'OK') {
                    if (results[1]) {
                      $scope.evento.nomelocal = results[0].address_components[0].long_name;
                      for(var i = 0;i<results[0].address_components.length;i++){
                        if(results[0].address_components[i].types[0] == "administrative_area_level_2"){
                          $scope.evento.cidade = results[0].address_components[i].long_name;
                          console.log($scope.evento.cidade)
                        }
                      }
                      $scope.evento.endereco = results[0].formatted_address;
                      infowindow.setContent(results[0].formatted_address);
                     
                      infowindow.open(map, marker);
                      setTimeout(function () { infowindow.close(); }, 5000);
                    } else {
                      window.alert('Resultado não encontrado');
          }
        } else {
          window.alert('Ocorreu uma falha doida :' + status);
                  }
                });
            };        

            function handleEvent(event) {
                $scope.evento.lat = event.latLng.lat();
                $scope.evento.lng = event.latLng.lng();
                $scope.centerPoint.lat = -26.997799;
                $scope.centerPoint.lng = -48.632733; 
                $scope.centerPointKM = 30;
                $scope.LimiteFuncionamentoDiwo = arePointsNear($scope.evento, $scope.centerPoint,$scope.centerPointKM );
                              // GEOCODER INVERSO

                var geocoder = new google.maps.Geocoder;
                var infowindow = new google.maps.InfoWindow({
                                                              maxWidth: 200
                                                            });;    
            
                geocoder.geocode({'location': event.latLng}, function(results, status) {
                  if (status === 'OK') {
                    if (results[1]) {
                      $scope.evento.nomelocal = results[0].address_components[0].long_name;
                      for(var i = 0;i<results[0].address_components.length;i++){
                        if(results[0].address_components[i].types[0] == "administrative_area_level_2"){
                          $scope.evento.cidade = results[0].address_components[i].long_name;
                          console.log($scope.evento.cidade)
                        }
                      }
                      $scope.evento.endereco = results[0].formatted_address;
                      // console.log($scope.evento.endereco);
                      // console.log($scope.evento.cidade);
                      // console.log($scope.evento.lng);
                      // console.log($scope.evento.lat);
                      infowindow.setContent(results[0].formatted_address);
                     
                      infowindow.open(map, marker);
                      setTimeout(function () { infowindow.close(); }, 5000);
                    } else {
                      window.alert('Resultado não encontrado');
          }
        } else {
          window.alert('Ocorreu uma falha doida :' + status);
                  }
                });
            }

                              // GEOCODER INVERSO

                function arePointsNear(checkPoint, centerPoint, km) {
                  var ky = 40000 / 360;
                  var kx = Math.cos(Math.PI * centerPoint.lat / 180.0) * ky;
                  var dx = Math.abs(centerPoint.lng - $scope.evento.lng) * kx;
                  var dy = Math.abs(centerPoint.lat - $scope.evento.lat) * ky;
                  return Math.sqrt(dx * dx + dy * dy) <= km;
                }

                
            
                    //        SEARCHBOX

            var input = document.getElementById('pac-input');
            var searchBox = new google.maps.places.SearchBox(input);
        //map.controls[google.maps.ControlPosition.TOP_LEFT].push(input);

        // Bias the SearchBox results towards current map's viewport.
            map.addListener('bounds_changed', function() {
                searchBox.setBounds(map.getBounds());
            });

            var markers = [];
        // Listen for the event fired when the user selects a prediction and retrieve
        // more details for that place.
            searchBox.addListener('places_changed', function() {
                var places = searchBox.getPlaces();

                if (places.length == 0) {
                  return;
                }

                // Clear out the old markers.
                markers.forEach(function(marker) {
                  marker.setMap(null);
                });
                markers = [];

                // For each place, get the icon, name and location.
                var bounds = new google.maps.LatLngBounds();
                places.forEach(function(place) {
                  if (!place.geometry) {
                    console.log("Returned place contains no geometry");
                    return;
                  }
                  markers.push(new google.maps.Marker({
                    map: map,
                    // icon: icon,
                    title: place.name,
                    position: place.geometry.location
                  }));

                  $scope.evento.nomelocal = place.name;
                  $scope.evento.endereco = place.formatted_address;
                  for(var i = 0;i<place.address_components.length;i++){
                    //console.log(place.address_components[i].types[0])
                    if(place.address_components[i].types[0] == "administrative_area_level_2"){
                      $scope.evento.cidade = place.address_components[i].long_name;
                      console.log($scope.evento.cidade)
                    }
                  }
                  $scope.evento.lat = place.geometry.location.lat();
                  $scope.evento.lng = place.geometry.location.lng();
                  $scope.centerPoint.lat = -26.997799;
                  $scope.centerPoint.lng = -48.632733; 
                  $scope.centerPointKM = 30;
                  $scope.LimiteFuncionamentoDiwo = arePointsNear($scope.evento, $scope.centerPoint,$scope.centerPointKM );
                  if (place.geometry.viewport) {
                    // Only geocodes have viewport.
                    bounds.union(place.geometry.viewport);
                  } else {
                    bounds.extend(place.geometry.location);
                  }
                });
                map.fitBounds(bounds);
            });
            $scope.map = map;  
             
        }, function(err) {
            console.log(err.code);
            console.log(err.message);
        });




  });
  
     


        $scope.getCriar = function(evento) {
          if($scope.LimiteFuncionamentoDiwo){
            formEventoEdita.updateForm($scope.evento);
            $state.go('tabsController.EditEv');
          }else{
            var alertPopup = $ionicPopup.alert({
                title: '( ꒪Д꒪)ノ',
                template: 'Ótimo saber que você quer criar um evento! Mas parece que a região onde você quer criar seu evento não está na nossa área de cobertura :/'
              }); 
          }
        }

}])

.controller('EditaEventoPart3Ctrl', ['$scope', '$stateParams', '$state', 'formEvento', 'formItem', '$ionicPopup', 'formEventoEdita', 'formUser','$ionicTabsDelegate', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, $state, formEvento, formItem, $ionicPopup,formEventoEdita, formUser, $ionicTabsDelegate) {
  $scope.evento = {};
  $scope.evento = formEventoEdita.getForm();

  $scope.user = formUser.getForm();
  
  if($scope.user.genero == "fem"){
    $scope.femin = true;
  }else{
    $scope.femin = false;
  }
  $ionicTabsDelegate.showBar(0);


  // if($scope.evento.dificuldade == "Não importa"){
  //   $scope.evento.dificuldaden = 1;
  // }
  // if($scope.evento.dificuldade == "Fácil"){
  //   $scope.evento.dificuldaden = 2;
  // }
  // if($scope.evento.dificuldade == "Moderado"){
  //   $scope.evento.dificuldaden = 3;
  // }
  // if($scope.evento.dificuldade == "Difícil"){
  //   $scope.evento.dificuldaden = 4;
  // }

  // $scope.ch = function(){
  //   if($scope.evento.dificuldaden == 1){
  //     $scope.evento.dificuldade = "Não importa";
  //   }
  //   if($scope.evento.dificuldaden == 2){
  //     $scope.evento.dificuldade = "Fácil";
  //   }
  //   if($scope.evento.dificuldaden == 3){
  //     $scope.evento.dificuldade = "Moderado";
  //   }
  //   if($scope.evento.dificuldaden == 4){
  //     $scope.evento.dificuldade = "Difícil";
  //   }
  // }

  var header = document.getElementById("barpor");
  var btns = header.getElementsByClassName("btnpor");
  for (var i = 0; i < btns.length; i++) {
    btns[i].addEventListener("click", function() {
      var current = document.getElementsByClassName("actr");
      current[0].className = current[0].className.replace(" actr", "");
      this.className += " actr";
    });
  }
  $scope.menos = function(){
    if($scope.evento.pmin >2){
      $scope.evento.pmin--;
    }
  }
  $scope.mais = function(){
    if($scope.evento.pmin < 49){
      $scope.evento.pmin++;
      if($scope.evento.pmin >= $scope.evento.pmax){
        $scope.evento.pmax = $scope.evento.pmin+1;
      }
      
    }
  }

  $scope.menosmax = function(){
    if($scope.evento.pmax >3){
      $scope.evento.pmax--;
      if($scope.evento.pmax <= $scope.evento.pmin){
        $scope.evento.pmin = $scope.evento.pmax-1;
      }
    }
  }
  $scope.maismax = function(){
    if($scope.evento.pmax < 50){
      $scope.evento.pmax++;
    }
  }
  // $scope.evento.auxpmax = $scope.evento.pmax;
  // $scope.mudamax = function() {
  //   if (!$scope.evento.pmax) {
  //     var alertPopup = $ionicPopup.alert({
  //     title: 'Register failed!',
  //     template: 'Favor preencher todos os campos'
  //   });
  //   }else{    
  //     if (parseInt($scope.evento.pmax) < parseInt($scope.evento.pmin)) {
  //       var alertPopup = $ionicPopup.alert({
  //               title: 'Matematimatematica',
  //               template: 'Máximo de pessoas nao pode ser maior que mínino xD'
  //             });
  //     }else{
  //       if (parseInt($scope.evento.pmax) >= 50) {
  //         var alertPopup = $ionicPopup.alert({
  //                 title: 'Muuuuita gente',
  //                 template: 'Limite máximo de pessoas para um evento é 50 personas'
  //               });
  //       }else{
  //         $scope.evento.pmax = $scope.evento.auxpmax;
  //       }
  //     }
  //   }
  // };
  // $scope.evento.auxpmin = $scope.evento.pmin;
  // $scope.mudamin = function() {
  //   if (!$scope.evento.pmin) {
  //     var alertPopup = $ionicPopup.alert({
  //     title: 'Register failed!',
  //     template: 'Favor preencher todos os campos'
  //   });
  //   }else{    
  //     if (parseInt($scope.evento.pmin)<=1) {
  //       var alertPopup = $ionicPopup.alert({
  //               title: '=/',
  //               template: 'Não da pra fazer um evento só com você né'
  //             });
  //     }else{
  //       $scope.evento.pmin = $scope.evento.auxpmin;
  //     }
  //   }
  // };

  $scope.pessoa = function() {$scope.evento.precopor = 1;};
  $scope.hora = function() {$scope.evento.precopor = 2;};

  $scope.getCriar = function(evento) {
  var palavrasnaousar = ["ALIAMBA", "ANUS", "BAGULIO"
      , "BANZA", "BARRUFO", "BECK", "BEQUE", "BOCETA"
      , "BOLAGATO", "BOQUETE", "BOLCAT", "BOSSETA", "BOSTANA", "BREXA", "BRIOCO", "BRONHA", "BUCA", "BUCETA"
      , "BUSSETA", "CANABIS", "CANNABIS", "CARALHO"
      , "CASSETA", "CASSETE", "CHECHECA", "CHERECA", "CHIBUMBA", "CHIBUMBO", "CHOTA", "CHOCHOTA", "CHUPADA", "CHUPADO", "CLITORIS"
      , "COCAINA","C+"
      , "C*", "CURALHO", "CUZAO", "CUZUDA", "CUZUDO", "CUZÃO", "ESPORRADA", "ESPORRADO", "ESPORRO", "estupro"
      , "FELACAO", "FELACÃO", "FODA", "FODAO", "FODÃO", "FODAUM", "FODE", "FODIDA", "FODIDO", "FORNICA", "FUDENDO", "FUDECÃO", "FUDECAO"
      , "FUDIDA", "FUDIDO", "GRELINHO", "GRELO", "ISCROTA", "ISCROTO", "MACONHA", "MASTURBA", "MASTURBAÇÃO", "MASTURBACÃO", "MASTURBACAO"
      , "PENIS", "PEN1S", "PENES", "PENIZ", "PICA", "PIROCA", "PIRU", "PORRA", "POURRA", "PROSTIBULO", "PUTA", "PUNHETA", "PUTO"
      , "RABAO", "TESTUDA", "TESTUDO", "VAGABUNDA", "VAGINA", "VIADO", "VIADAO", "VIADÃO", "XAVASCA", "XERERECA", "XEXECA", "XOTA"
      , "XOCHOTA", "XOXOTA", "XANA", "XANINHA", "MDMA",  "VSF", "TNC", "FDP", "CRACK"];
      var error = 0; 
      for (var i = 0; i < palavrasnaousar.length; i++) {
        var res2 = $scope.evento.descricao.split("_") ;
        if(res2.length>1){
          for(var w = 0; w < res2.length; w++){
            var val = palavrasnaousar[i].toLowerCase();
            if ((res2[w].toLowerCase()).indexOf(val.toString()) > -1) {  
              error = error + 1;  
            }
          }
        }else{
          var val = palavrasnaousar[i].toLowerCase();  
          if (($scope.evento.descricao.toLowerCase()).indexOf(val.toString()) > -1) {  
            error = error + 1;  
          }
        }
        var res3 = $scope.evento.descricao.split(" ") ;
        if(res3.length>1){
          for(var w = 0; w < res3.length; w++){
            var val = palavrasnaousar[i].toLowerCase();
            if ((res3[w].toLowerCase()).indexOf(val.toString()) > -1) {  
              error = error + 1;  
            }
          }
        }else{
          var val = palavrasnaousar[i].toLowerCase();  
          if (($scope.evento.descricao.toLowerCase()).indexOf(val.toString()) > -1) {  
            error = error + 1;  
          }
        }   
      } 
      if (error > 0) {  
          var alertPopup = $ionicPopup.alert({
                title: '（・о・；）',
                template: 'Que boquinha suja eim, usaste uma palavra inapropriada né'
              }); 
      }else{
        if (!$scope.evento.pmax || !$scope.evento.pmin) {
                    var alertPopup = $ionicPopup.alert({
                    title: 'Register failed!',
                    template: 'Favor preencher todos os campos'
                  });

        }else{
          if (parseInt($scope.evento.pmin)<=1) {
            var alertPopup = $ionicPopup.alert({
                    title: '=/',
                    template: 'Não da pra fazer um evento só com você né'
                  });
          }else{
            if (parseInt($scope.evento.pmax) <= parseInt($scope.evento.pmin)) {
              var alertPopup = $ionicPopup.alert({
                      title: 'Matematimatematica',
                      template: 'Mínimo de pessoas nao pode ser maior que máximo xD'
                    });
            }else{
              if (parseInt($scope.evento.pmax) >= 50) {
                var alertPopup = $ionicPopup.alert({
                        title: 'Muuuuita gente',
                        template: 'Limite máximo de pessoas para um evento é 50 personas'
                      });
              }else{
        if(evento.descricao){
          formEventoEdita.updateForm($scope.evento);
          $state.go('tabsController.EditEv');
        }else{
          var alertPopup = $ionicPopup.alert({
                title: '( ꒪Д꒪)ノ',
                template: 'Escreva algo na descrição do evento para ajudar as pessoas a entenderem o que será feito'
              }); 
        }   
            }
          }
        }
      }
      }
  }

}])
   
.controller('EditaEventoPart4Ctrl', ['$scope', '$stateParams', '$state', 'formEvento', 'formUser','$ionicPopup', '$http', 'formtela2','formEditar', 'EventoService', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, $state, formEvento, formUser, $ionicPopup, $http, formtela2, formEditar, EventoService) {
  
  $scope.evento = formEvento.getForm();
  $scope.telaeditar = 1;
  $scope.pushnoti = {};
  $scope.confirmacao = 'aprovado';
  $scope.estado = '0';
  $scope.auxtela = formtela2.getForm();
  var res2 = [];
  var noti = {};
  console.log($scope.auxtela);
  EventoService.Gettags($scope.evento.idevento).then(function(tags) {
    for(var  i =0; i < tags.length;i++){
         res2[i] =  tags[i].tag;
        } 
  });
  $scope.mudanome = false;
  
   $scope.user = formUser.getForm(); /// mudar aqui o Formuser
    //console.log($scope.user.iduser);
  $scope.$on("$ionicView.enter", function(event, data){
    $scope.evento = {};
    $scope.evento = formEvento.getForm();
    $scope.telaeditar = 1;
    $scope.pushnoti = {};
    $scope.confirmacao = 'aprovado';
    $scope.estado = '0';
    $scope.auxtela = formtela2.getForm();
    var res2 = [];
    var noti = {};
    console.log($scope.auxtela);
    EventoService.Gettags($scope.evento.idevento).then(function(tags) {
      for(var  i =0; i< tags.length;i++){
           res2[i] =  tags[i].tag;
          } 
    });
    $scope.mudanome = false;
    $scope.user = formUser.getForm();
    if ($scope.telaeditar == 1) {
      $scope.mudanome = true;
     }
    $scope.auxtela = formtela2.getForm();
    if ($scope.auxtela == 1) {
      $state.go('tabsController.EditaEEAPart1');
    }
  });
  
  $scope.getCriar = function(evento) {
      if (!$scope.evento.pmax || !$scope.evento.pmin) {
                    var alertPopup = $ionicPopup.alert({
                    title: 'Register failed!',
                    template: 'Favor preencher todos os campos'
                  });

         }else{
          if (parseInt($scope.evento.pmin)<=1) {
            var alertPopup = $ionicPopup.alert({
                    title: '=/',
                    template: 'Não da pra fazer um evento só com você né'
                  });
          }else{
            if (parseInt($scope.evento.pmax) < parseInt($scope.evento.pmin)) {
              var alertPopup = $ionicPopup.alert({
                      title: 'Matematimatematica',
                      template: 'Mínimo de pessoas nao pode ser maior que máximo xD'
                    });
            }else{
          if (parseInt($scope.evento.pmax) >= 50) {
                var alertPopup = $ionicPopup.alert({
                        title: 'Muuuuita gente',
                        template: 'Limite máximo de pessoas para um evento é 50 personas'
                      });
              }else{
            if ($scope.telaeditar == 1) {
              console.log('oi');
              $scope.evento.datamodificacao = new Date();
              EventoService.atualizarevento($scope.evento).then(function(msg){
              var alertPopup = $ionicPopup.alert({
                      title: 'ʕ•ᴥ•ʔ',
                      template: msg
                    });
                       alertPopup.then(function(){
                EventoService.GetParticipantes($scope.evento.idevento).then(function(items) {
                  $scope.msgnoti = 'O evento: '+$scope.evento.nomeevento +' foi mudado'
                           for (var i = 0; i < items.length; i++) {
                            if ($scope.user.iduser != items[i].iduser) {
                              noti.recebeusername = items[i].username;
                              noti.recebe = items[i].iduser;
                              noti.envia = $scope.user.iduser;
                              noti.tipo = 4;
                              noti.nomeevento = $scope.evento.nomeevento;
                              EventoService.VerificaNotificacao(noti).then(function(res) {
                                console.log(res);
                                if(res){
                                  $http.post('https://ec2.diwoapp.com.br/notificapessoa.php', {notificacao : $scope.msgnoti, 
                                        idevento : $scope.evento.idevento,
                                        nomeevento : $scope.evento.nomeevento,
                                        id_user_envia : $scope.user.iduser,
                                        username_envia : $scope.user.username,
                                        apelido_envia : $scope.aux.apelido,
                                        tipo : '4',    //update no evento
                                        id_user_recebe : noti.recebe}).then(function (res){
                                       $scope.response = res.data;
                                       console.log($scope.response.msg)
                                     });
                                  EventoService.getusuario2(noti.recebeusername).then(function(user) {
                                    if(user.notiparticipando== '1'){
                                    $scope.pushnoti.titulo =  'Mudanças!' ;
                                    $scope.pushnoti.msg = $scope.msgnoti;
                                    $scope.pushnoti.token = user.devicetoken;
                                     EventoService.MandaPushNoti($scope.pushnoti);
                                   }
                                  } );
                                }
                              });
                            }
                          }
                         })

                             $state.go('tabsController.home');
                        })
                  }, function(errMsg) {
                    var alertPopup = $ionicPopup.alert({
                      title: 'Register failed!',
                      template: errMsg
                    });
                  })
                            /// AQUI TEMOS QUE COMPARAR SE HOUVE INCLUSAO DE UMA TAG NOVA
                if( $scope.evento.tags!=''){
                  var res = $scope.evento.tags.split(" ") ;
                  var array3 = res.filter(function(obj) { return res2.indexOf(obj) == -1; });
                    for (var i = 0; i<array3.length;i++){
                      if(array3[i][0]!='#'){
                        array3[i]= '#' + array3[i];
                      }
                      var link = 'https://ec2.diwoapp.com.br/criartag.php';
                        $http.post(link, {idevento : $scope.evento.idevento, 
                                          tag : array3[i]});
                      }
                }
            }else{
                $ionicPopup.prompt({
                    title: 'Qual nome devo dar?',
                    template: 'Não vamos esquecer de dar nomes aos bois',
                   inputType: 'text',
                   inputPlaceholder: ' Nome legal'
                 }).then(function(nomeevento) {
                  $scope.evento.nomeevento = nomeevento;
                    console.log('Nome do evento é', nomeevento);
                 
           if (nomeevento && nomeevento !='' && nomeevento !=' ') {
            $scope.evento.datamodificacao = new Date();
            var link = 'https://ec2.diwoapp.com.br/atualizarevento.php';
            $http.post(link, {nomeevento : $scope.evento.nomeevento, 
                          duracao : $scope.evento.duracao,
                          diainicio : $scope.evento.diainicio,
                          diafim : $scope.evento.diafim,
                          dialimiteconfirmacao: $scope.evento.dialimiteconfirmacao,
                          pmin : $scope.evento.pmin, 
                          pmax : $scope.evento.pmax,
                          patual : $scope.evento.patual,  
                          adm : $scope.user.iduser,
                          admusername : $scope.user.username,
                          admapelido : $scope.user.apelido,
                          preco : $scope.evento.preco,
                          precopor : $scope.evento.precopor, 
                          nomelocal : $scope.evento.nomelocal,
                          endereco : $scope.evento.endereco,
                          datamodificacao : $scope.evento.datamodificacao,
                          estado : '0',
                          cidade : $scope.evento.cidade,
                          lat : $scope.evento.lat,
                          lng : $scope.evento.lng,
                          dificuldade :$scope.evento.dificuldade,
                          genero : $scope.evento.genero,
                          descricao : $scope.evento.descricao}).then(function (res){
            $scope.responsecriado = res.data;

            if ($scope.responsecriado.success == true) {
                if( $scope.evento.tags!=''){
              var res = $scope.evento.tags.split(" ") ;
               var array3 = res.filter(function(obj) { return res2.indexOf(obj) == -1; });
                for (var i = 0; i<array3.length;i++){
                  var link = 'https://ec2.diwoapp.com.br/criartag.php';
                    $http.post(link, {idevento : $scope.responsecriado.last, 
                                      tag : array3[i]})
                   }
                 }
              var link = 'https://ec2.diwoapp.com.br/irevento.php';
                  $http.post(link, {idevento : $scope.responsecriado.last, 
                                    iduser : $scope.user.iduser,
                                    idadm : $scope.user.iduser, 
                                    admusername : $scope.user.username,
                                    username : $scope.user.username,
                                    apelido : $scope.user.apelido,
                                    borda : $scope.user.borda,
                                    profilepic : $scope.user.profilepic,
                                    devicetoken : $scope.user.devicetoken,
                                    diainicio : $scope.evento.diainicio,
                                    confirmacao : $scope.confirmacao,
                                    nomeevento :  $scope.evento.nomeevento,
                                    idComercioParceiro : $scope.evento.idComercioParceiro, 
                                    //eventopic : $scope.evento.eventopic,
                                    estado : $scope.estado}).then(function (res){
                  $scope.response = res.data;
                  console.log($scope.response);
                    if ($scope.response.success == true) {
                        var alertPopup = $ionicPopup.alert({
                      title: 'Parabéns',
                      template: $scope.responsecriado.msg
                    }); 
                        alertPopup.then(function(){
                        formtela2.updateForm(1);
                        $scope.evento = {};
                        formEvento.updateForm($scope.evento);
                         $state.go('tabsController.home');
                       })
                      }else{
                        var alertPopup = $ionicPopup.alert({
                      title: 'Ocorreu uma falha',
                      template: $scope.responsecriado.msg
                    });
                        alertPopup.then(function(){
                        $state.go('tabsController.home');
                       })
                      }
                    })
                  }
            });

           }else{console.log('dasd');}
        });
            }

         }
          }}

         }
  }

}])



.controller('criarmarcandodiaCtrl', ['$scope', '$stateParams', 'formUser', 'formLoc', 'EventoService', 'formAux', '$state','$timeout', '$ionicPopup', '$http', 'formOutro', 'formItem', 'formtela', 'formtelanoti', 'formtipologin','formEventoNovoCriar', '$ionicTabsDelegate','formLimiteatuacao','formtelaCriar',  // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, formUser, formLoc, EventoService, formAux, $state, $timeout, $ionicPopup, $http, formOutro, formItem, formtela, formtelanoti, formtipologin, formEventoNovoCriar, $ionicTabsDelegate,formLimiteatuacao, formtelaCriar) {
  
  $scope.evento = {};
  $scope.user = formUser.getForm();
  var datainvalida = 0;
  $scope.$on("$ionicView.enter", function(event, data){
    $ionicTabsDelegate.showBar(1);
    $scope.evento = formEventoNovoCriar.getForm();
    $scope.user = formUser.getForm();
    $scope.LimiteFuncionamentoDiwo = formLimiteatuacao.getForm();
    console.log($scope.LimiteFuncionamentoDiwo, "LimiteFuncionamentoDiwo")
    //$scope.evento.iniciohora =  new Date(6, 0)
    formtelaCriar.updateForm(0);
     // $scope.evento.iniciohora.setHours(6, 0)
    if(!$scope.evento.date){
      $scope.evento.date = new Date();
      $scope.evento.hj = new Date();
      $scope.evento.date.setDate($scope.evento.date.getDate() + 1);
      $scope.evento.semana = $scope.evento.date.getDay();
    }
    
    
   
    
    if($scope.evento.semana == 0){
      $scope.evento.semana = "Domingo";
    }
    if($scope.evento.semana == 1){
      $scope.evento.semana = "Segunda-feira";
    }
    if($scope.evento.semana == 2){
      $scope.evento.semana = "Terça-feira";
    }
    if($scope.evento.semana == 3){
      $scope.evento.semana = "Quarta-feira";
    }
    if($scope.evento.semana == 4){
      $scope.evento.semana = "Quinta-feira";
    }
    if($scope.evento.semana == 5){
      $scope.evento.semana = "Sexta-feira";
    }
    if($scope.evento.semana == 6){
      $scope.evento.semana = "Sábado";
    }
    var curr_date = ($scope.evento.date.getDate()<10?'0':'') + $scope.evento.date.getDate();
    var curr_month = ($scope.evento.date.getMonth()<9?'0':'') + ($scope.evento.date.getMonth() + 1); //Months are zero based
    var curr_year = $scope.evento.date.getFullYear();
    var h2 = ($scope.evento.date.getHours()<10?'0':'') + $scope.evento.date.getHours();
    var m2 = ($scope.evento.date.getMinutes()<10?'0':'') + $scope.evento.date.getMinutes();
    var s2 = ($scope.evento.date.getSeconds()<10?'0':'') + $scope.evento.date.getSeconds();
    var j = curr_year + "-" + curr_month + "-" + curr_date+ ' '+h2 + ':' + m2 + ':' + s2;
    $scope.evento.diainicio = j;
    $scope.auxdata = {};
    EventoService.verificahorariopessoaevento($scope.user).then(function(items) {
      $scope.auxdata = items;
      console.log(items, "verificahorariopessoaevento")
    }); 
    var datainvalida = 0;
  })

  $scope.muda = function(){

    if( $scope.evento.date < $scope.evento.hj){
      var alertPopup = $ionicPopup.alert({
        title: 'Falha na data!!',
        template: 'Coloque uma data valida s`il vous plait'
      });
      datainvalida = 2;
    }else{
      datainvalida = 0;
      $scope.evento.semana = $scope.evento.date.getDay();
      var curr_date = ($scope.evento.date.getDate()<10?'0':'') + $scope.evento.date.getDate();
      var curr_month = ($scope.evento.date.getMonth()<9?'0':'') + ($scope.evento.date.getMonth() + 1); //Months are zero based
      var curr_year = $scope.evento.date.getFullYear();
      var h2 = ($scope.evento.date.getHours()<10?'0':'') + $scope.evento.date.getHours();
      var m2 = ($scope.evento.date.getMinutes()<10?'0':'') + $scope.evento.date.getMinutes();
      var s2 = ($scope.evento.date.getSeconds()<10?'0':'') + $scope.evento.date.getSeconds();
      var j = curr_year + "-" + curr_month + "-" + curr_date+ ' '+h2 + ':' + m2 + ':' + s2;
      $scope.evento.diainicio = j;
       if($scope.evento.semana == 0){
        $scope.evento.semana = "Domingo";
      }
      if($scope.evento.semana == 1){
        $scope.evento.semana = "Segunda-feira";
      }
      if($scope.evento.semana == 2){
        $scope.evento.semana = "Terça-feira";
      }
      if($scope.evento.semana == 3){
        $scope.evento.semana = "Quarta-feira";
      }
      if($scope.evento.semana == 4){
        $scope.evento.semana = "Quinta-feira";
      }
      if($scope.evento.semana == 5){
        $scope.evento.semana = "Sexta-feira";
      }
      if($scope.evento.semana == 6){
        $scope.evento.semana = "Sábado";
      }
    }
          // curr_date = ($scope.evento.date.getDate()<10?'0':'') + $scope.evento.date.getDate();
          // curr_month = ($scope.evento.date.getMonth()<9?'0':'') + ($scope.evento.date.getMonth() + 1); //Months are zero based
          // curr_year = $scope.evento.date.getFullYear();
          // h2 = ($scope.evento.date.getHours()<10?'0':'') + $scope.evento.date.getHours();
          // m2 = ($scope.evento.date.getMinutes()<10?'0':'') + $scope.evento.date.getMinutes();
          // s2 = ($scope.evento.date.getSeconds()<10?'0':'') + $scope.evento.date.getSeconds();
          // $scope.evento.semana = $scope.evento.date.getDay();
          // var j = curr_year + "-" + curr_month + "-" + curr_date+ ' '+h2 + ':' + m2 + ':' + s2;
          
          // $scope.evento.diainicio = j;
          // diainiciodoevento = $scope.evento.date;
          // datainvalida = 0;
          // ano = curr_year-curr_year2;
          // mes = curr_month-curr_month2;
          // dia = curr_date-curr_date2;
          // h = h2-h22;
          // m = m2-m22;
          
              // if(ano<0){
              //    var alertPopup = $ionicPopup.alert({
              //       title: 'Falha na data!!',
              //       template: 'Coloque uma data valida s`il vous plait'
              //     });
              //    $scope.evento.date = '';
              //   console.log('data invalida');
              // }else{
              //   if (ano == 0) {
              //     if(mes<0){
              //       var alertPopup = $ionicPopup.alert({
              //         title: 'Falha na data!!',
              //         template: 'Coloque uma data valida s`il vous plait'
              //       });
              //       $scope.evento.date = '';
              //       console.log('data invalida');
              //     }else{
              //       if (mes==0) {
              //         if(dia<0){
              //           var alertPopup = $ionicPopup.alert({
              //           title: 'Falha na data!!',
              //           template: 'Coloque uma data valida s`il vous plait'
              //         });
              //           $scope.evento.date = '';
              //           console.log('data invalida');
              //         }else{
              //           if (dia==0 && h<3){
              //             var alertPopup = $ionicPopup.alert({
              //               title: 'ヽ ( ꒪д꒪ )ﾉ',
              //               template: 'Muito em cima da hora para criar um evento, no mínimo umas 3 horas de antecedência'
              //             });
              //             console.log('data invalida');
              //             $scope.evento.date = '';
              //           }else{
              //             $scope.evento.date = $scope.evento.date.toLocaleString();

              //           }
              //         }
              //       }
              //     }
              //   }
              // }
  }

  $scope.Proximo = function(evento){
    if($scope.evento.semana == 0){
      $scope.evento.semana = "Domingo";
    }
    if($scope.evento.semana == 1){
      $scope.evento.semana = "Segunda-feira";
    }
    if($scope.evento.semana == 2){
      $scope.evento.semana = "Terça-feira";
    }
    if($scope.evento.semana == 3){
      $scope.evento.semana = "Quarta-feira";
    }
    if($scope.evento.semana == 4){
      $scope.evento.semana = "Quinta-feira";
    }
    if($scope.evento.semana == 5){
      $scope.evento.semana = "Sexta-feira";
    }
    if($scope.evento.semana == 6){
      $scope.evento.semana = "Sábado";
    }

    for(var r = 0;r<$scope.auxdata.length; r++){
      console.log($scope.auxdata[r].diainicio ,"$scope.auxdata[r].diainicio", $scope.evento.diainicio)
      if ($scope.auxdata[r].diainicio < $scope.evento.diainicio && $scope.auxdata[r].diafim > $scope.evento.diainicio){
        //console.log('horario invalido');
        datainvalida = 1;
      }
    }
             //console.log (datainvalida , r)
              ///        ╭∩╮(︶‿︶)╭∩╮
    if(datainvalida == 0 && r==$scope.auxdata.length){
              // $scope.evento.date = $scope.evento.date.toDateString("yyyy-MM-dd HH:mm");
              // $scope.evento.diafim = $scope.evento.diafim.toDateString("yyyy-MM-dd HH:mm");
               
      formEventoNovoCriar.updateForm(evento);
      $state.go('tabsController.criarduracao')
    }
    if(datainvalida ==1){
      var alertPopup = $ionicPopup.alert({
            title: 'Oww!!',
            template: 'Tu ja tem um evento marcado nesse horário :/'
          });
    }
    if(datainvalida ==2){
      var alertPopup = $ionicPopup.alert({
        title: 'Falha na data!!',
        template: 'Coloque uma data valida s`il vous plait'
      });
    }
          
     
    //console.log($scope.evento.iniciohora, "$scope.evento.iniciohora", $scope.evento.diainicio);

  }





}])




.controller('criarduracaoCtrl', ['$scope', '$stateParams', 'formUser', 'formLoc', 'EventoService', 'formAux', '$state','$timeout', '$ionicPopup', '$http', 'formOutro', 'formItem', 'formtela', 'formtelanoti', 'formtipologin','formEventoNovoCriar', '$ionicTabsDelegate',  // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, formUser, formLoc, EventoService, formAux, $state, $timeout, $ionicPopup, $http, formOutro, formItem, formtela, formtelanoti, formtipologin, formEventoNovoCriar, $ionicTabsDelegate) {
 
  $scope.evento = {};
  $scope.user = formUser.getForm();


  $scope.$on("$ionicView.enter", function(event, data){
    $ionicTabsDelegate.showBar(0);
    $scope.evento = formEventoNovoCriar.getForm();
    $scope.user = formUser.getForm();
    if(!$scope.evento.duracao){
      $scope.evento.duracao =  new Date(1, 0)
      $scope.evento.duracao.setHours(1, 0)
    }
  })

  $scope.Proximo = function(evento){
    if(!$scope.evento.duracao){
      $scope.evento.duracao =  new Date(1, 0)
      $scope.evento.duracao.setHours(1, 0)
    }
    var hora =$scope.evento.duracao.getHours();
    var min = $scope.evento.duracao.getMinutes();
    var currentdatefim = new Date($scope.evento.diainicio);
    if(min == 0){
      min = 60;
    }
    if(hora == 0){
      currentdatefim.setTime(currentdatefim.getTime() + (min*60*1000));
    }else{
      currentdatefim.setTime(currentdatefim.getTime() + (hora*min*60*1000));
    }
    
    
    var curr_datefim = (currentdatefim.getDate()<10?'0':'') + currentdatefim.getDate();
    var curr_monthfim = (currentdatefim.getMonth()<9?'0':'') + (currentdatefim.getMonth() + 1); //Months are zero based
    var curr_yearfim = currentdatefim.getFullYear();
    var curr_hfim = (currentdatefim.getHours()<10?'0':'') + currentdatefim.getHours();
    var curr_mfim = (currentdatefim.getMinutes()<10?'0':'') + currentdatefim.getMinutes();
    var curr_jfim = curr_yearfim + "-" + curr_monthfim + "-" + curr_datefim+ ' '+curr_hfim + ':' + curr_mfim + ':' + '00';
    
    $scope.evento.diafim = curr_jfim;
    
    console.log($scope.evento.diafim, "$scope.evento.diafim", $scope.evento.semana)
    formEventoNovoCriar.updateForm(evento);
    $state.go('tabsController.criarlimiteconfirma')
  }

}])

.controller('criarlimiteconfirmaCtrl', ['$scope', '$stateParams', 'formUser', 'formLoc', 'EventoService', 'formAux', '$state','$timeout', '$ionicPopup', '$http', 'formOutro', 'formItem', 'formtela', 'formtelanoti', 'formtipologin','formEventoNovoCriar', '$ionicTabsDelegate',  // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, formUser, formLoc, EventoService, formAux, $state, $timeout, $ionicPopup, $http, formOutro, formItem, formtela, formtelanoti, formtipologin, formEventoNovoCriar, $ionicTabsDelegate) {
 
  $scope.evento = {};
  $scope.user = formUser.getForm();


  $scope.$on("$ionicView.enter", function(event, data){
    $ionicTabsDelegate.showBar(0);
    $scope.evento = formEventoNovoCriar.getForm();
    $scope.user = formUser.getForm();
      console.log($scope.evento.date,"$scope.evento.date")
    if(!$scope.evento.dialimiteconfirmacao){
      $scope.evento.redzone = 1;
      var currentdate = new Date(); 
      var curr_date2 = (currentdate.getDate()<10?'0':'') + currentdate.getDate();
      var curr_month2 = (currentdate.getMonth()<10?'0':'') + (currentdate.getMonth() + 1); //Months are zero based
      var curr_year2 = currentdate.getFullYear();
      var h22 = (currentdate.getHours()<10?'0':'') + currentdate.getHours();
      var m22 = (currentdate.getMinutes()<10?'0':'') + currentdate.getMinutes();

      var curr_date
      var h2
      var m2 
      var curr_month
      var s2
      var curr_year
      var datainvalida = 0;

      var curr_date4;
      var curr_date5;
      var h4
      var m4 
      var curr_month4;
      var curr_month5;
      var s4
      var curr_year4
      var curr_year5;

      $scope.ano;
      $scope.mes ;
      $scope.dia;
      $scope.h;
      $scope.m;

      curr_date = ($scope.evento.date.getDate()<10?'0':'') + $scope.evento.date.getDate();
      curr_month = ($scope.evento.date.getMonth()<9?'0':'') + ($scope.evento.date.getMonth() + 1); //Months are zero based
      curr_year = $scope.evento.date.getFullYear();
      h2 = ($scope.evento.date.getHours()<10?'0':'') + $scope.evento.date.getHours();
      m2 = ($scope.evento.date.getMinutes()<10?'0':'') + $scope.evento.date.getMinutes();
      s2 = ($scope.evento.date.getSeconds()<10?'0':'') + $scope.evento.date.getSeconds();

      var j = curr_year + "-" + curr_month + "-" + curr_date+ ' '+h2 + ':' + m2 + ':' + s2;
      
      $scope.evento.diainicio = j;
      diainiciodoevento = $scope.evento.date;
      datainvalida = 0;
      $scope.ano = curr_year-curr_year2;
      $scope.mes = curr_month-curr_month2;
      $scope.dia = curr_date-curr_date2;
      $scope.h = h2-h22;
      $scope.m = m2-m22;

    }
    
    
  })



  $scope.red = function(){

    if($scope.ano==0 && $scope.mes == 0 && ($scope.dia == 0 && $scope.evento.redzone >= $scope.h) || ($scope.dia == 1 && $scope.evento.redzone >= $scope.h+24)){
      console.log($scope.evento.redzone)
      var alertPopup = $ionicPopup.alert({
        title: 'ლ(ﾟдﾟლ)',
        template: 'A hora limite para confirmação ja passou de agora, ninguem vai conseguir confirmar ida. Selecione um horario válido'
      });
      $scope.evento.redzone = "1";
    }
  }

  $scope.Proximo = function(evento){
    var curr_date5 = $scope.evento.diainicio[8]+$scope.evento.diainicio[9];
    var curr_month5 = $scope.evento.diainicio[5]+$scope.evento.diainicio[6]; //Months are zero based
    var curr_year5 = $scope.evento.diainicio[0]+$scope.evento.diainicio[1] +$scope.evento.diainicio[2]+$scope.evento.diainicio[3];
     
     
    var hora =($scope.evento.date.getHours()<10?'0':'') + $scope.evento.date.getHours();
    var m2 =($scope.evento.date.getMinutes()<10?'0':'') + $scope.evento.date.getMinutes();

    var h4 = parseFloat(hora)-parseFloat($scope.evento.redzone);
    //console.log(h4)
    if(h4<0){
      h4 = h4.valueOf()+24;
      curr_date5 = parseFloat(curr_date5)-1;
      if(curr_date5<1){
        curr_month5 = parseFloat(curr_month5)-1;
        if(curr_month5==1||curr_month5==3||curr_month5==5||curr_month5==7||curr_month5==8||curr_month5==10||curr_month5==12){
          curr_date5 = curr_date5.valueOf()+31;
        }
        if(curr_month5==4||curr_month5==6||curr_month5==9||curr_month5==11){
          curr_date5 = curr_date5.valueOf()+30;
        }
        if(curr_month5==2){
          curr_date5 = curr_date5.valueOf()+28;
        }
        if(curr_month5<1){
          curr_year5 = parseFloat(curr_year5)-1;
        }
      }
    }
    if(h4 == 0){
      curr_date5 = parseFloat(curr_date5)-1;
      if(curr_date5<1){
        curr_month5 = parseFloat(curr_month5)-1;
        if(curr_month5==1||curr_month5==3||curr_month5==5||curr_month5==7||curr_month5==8||curr_month5==10||curr_month5==12){
          curr_date5 = curr_date5.valueOf()+31;
        }
        if(curr_month5==4||curr_month5==6||curr_month5==9||curr_month5==11){
          curr_date5 = curr_date5.valueOf()+30;
        }
        if(curr_month5==2){
          curr_date5 = curr_date5.valueOf()+28;
        }
        if(curr_month5<1){
          curr_year5 = parseFloat(curr_year5)-1;
        }
      }
    }
    h4 = (h4<10?'0':'')+h4;
    curr_date5 = (parseFloat(curr_date5)<10?'0':'')+parseFloat(curr_date5);
    curr_month5 = (parseFloat(curr_month5)<9?'0':'')+parseFloat(curr_month5);
    var j = curr_year5 + "-" + curr_month5 + "-" + curr_date5+ ' '+h4 + ':' + m2 + ':00' ;
    
    $scope.evento.dialimiteconfirmacao = j;
    //console.log($scope.evento.dialimiteconfirmacao)
    formEventoNovoCriar.updateForm(evento);
    $state.go('tabsController.criarlocal')
  }

}])

.controller('criarlocalCtrl', ['$scope', '$stateParams', 'formUser', 'formLoc', 'EventoService', 'formAux', '$state','$timeout', '$ionicPopup', '$http', 'formOutro', 'formItem', 'formtela', 'formtelanoti', '$cordovaGeolocation','formEventoNovoCriar', '$ionicTabsDelegate', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, formUser, formLoc, EventoService, formAux, $state, $timeout, $ionicPopup, $http, formOutro, formItem, formtela, formtelanoti, $cordovaGeolocation, formEventoNovoCriar, $ionicTabsDelegate) {
  
  $scope.evento = {};
  $scope.user = formUser.getForm();
  $scope.evento = formEventoNovoCriar.getForm();
  $scope.evento.nomelocal = 'Casa do Igor';
  $scope.evento.endereco = 'Secreto';
  $scope.evento.cidade = 'Balneário Camboriú';
  $scope.evento.lat = -26.9829029;
  $scope.evento.lng = -48.6340998;
  $scope.centerPoint={};
  $scope.centerPointFB={};
  $scope.LimiteFuncionamentoDiwo = false;
  $scope.LimiteFuncionamentoDiwoFB = false;
  $scope.disableTap = function(){
     container = document.getElementsByClassName('pac-container');
     // disable ionic data tab
     angular.element(container).attr('data-tap-disabled', 'true');
     // leave input field if google-address-entry is selected
     angular.element(container).on("click", function(){
                                   document.getElementById('pac-input').blur();
                                   });
     };

  $scope.$on("$ionicView.enter", function(event, data){
    $ionicTabsDelegate.showBar(0);
    $scope.evento = formEventoNovoCriar.getForm();
    $scope.user = formUser.getForm();
    $scope.centerPoint={};
    $scope.LimiteFuncionamentoDiwo = false;
    console.log($scope.evento.semana)
    if(!$scope.evento.lat){
        navigator.geolocation.getCurrentPosition(function(position){
            var lat  = position.coords.latitude;
            var long = position.coords.longitude;
            var myLatlng = new google.maps.LatLng(lat, long);
            var mapOptions = {
                center: myLatlng,
                zoom: 16,
                mapTypeId: google.maps.MapTypeId.ROADMAP
            };          
            var map = new google.maps.Map(document.getElementById("map_canvas"), mapOptions); 
            var marker = new google.maps.Marker({
                      position: new google.maps.LatLng(position.coords.latitude, position.coords.longitude),
                      map: map,
                      title: "Borai",
                      draggable: true,
                      icon: 'http://maps.google.com/mapfiles/ms/icons/green-dot.png',
                      animation: google.maps.Animation.DROP 
                  })

            var geocoder = new google.maps.Geocoder;
            var infowindow = new google.maps.InfoWindow({maxWidth: 200});

            geocoder.geocode({'location': myLatlng}, function(results, status) {
                  if (status === 'OK') {
                    if (results[1]) {
                      $scope.evento.nomelocal = results[0].address_components[0].long_name;
                      $scope.evento.endereco = results[0].formatted_address;
                      for(var i = 0;i<results[0].address_components.length;i++){
                        if(results[0].address_components[i].types[0] == "administrative_area_level_2"){
                          $scope.evento.cidade = results[0].address_components[i].long_name;
                          console.log($scope.evento.cidade)
                        }
                      }
                      //$scope.evento.cidade = results[0].address_components[4].long_name;
                      $scope.evento.lat = position.coords.latitude;
                      $scope.evento.lng = position.coords.longitude;
                      $scope.centerPoint.lat = -26.997799;
                      $scope.centerPoint.lng = -48.632733; 
                      // $scope.centerPoint.lat = -25.473466587692343;
                      // $scope.centerPoint.lng = -49.29164589792566;
                      $scope.centerPointKM = 30;
                      $scope.LimiteFuncionamentoDiwo = arePointsNear($scope.evento, $scope.centerPoint,$scope.centerPointKM );
                      $scope.centerPointKMFB = 2500;
                      $scope.centerPointFB.lat = 39.1882887948499;
                      $scope.centerPointFB.lng = -100.07746794288232;
                      $scope.LimiteFuncionamentoDiwoFB = arePointsNear($scope.user, $scope.centerPointFB,$scope.centerPointKMFB );
                      
                      if($scope.LimiteFuncionamentoDiwoFB){
                        $scope.LimiteFuncionamentoDiwo = true;
                      }
                      infowindow.setContent(results[0].formatted_address);
                      console.log($scope.evento.endereco);
                      console.log($scope.evento.cidade);
                      console.log($scope.evento.lng);
                      console.log($scope.evento.lat);
                      //infowindow.setContent(results[0].address_components[2].long_name);
                      infowindow.open(map, marker);
                      setTimeout(function () { infowindow.close(); }, 5000);
                    } else {
                      window.alert('No results found');
                    }
                  } else {
                    window.alert('Geocoder failed due to: ' + status);
                  }
            });


            google.maps.event.addListener(marker, "dragstart", function (event) {
               marker.setAnimation(3); // raise
            });

            google.maps.event.addListener(marker, "dragend", function (event) {
               marker.setAnimation(4); // raise
            });

            marker.addListener('dragend', handleEvent);

            google.maps.event.addListener(map, 'click', function(e) {
                
                markers.forEach(function(marker) {
                marker.setMap(null);
                });
                markers = [];

                placeMarker(e.latLng, map, marker);

            });

            function placeMarker(latlng, map, marker) {
                marker.setPosition(latlng);
                marker.setMap(map);
                map.panTo(latlng);
                $scope.evento.lat = latlng.lat();
                $scope.evento.lng = latlng.lng();

                $scope.centerPoint.lat = -26.997799;
                $scope.centerPoint.lng = -48.632733; 
                // $scope.centerPoint.lat = -25.473466587692343;
                // $scope.centerPoint.lng = -49.29164589792566;
                $scope.centerPointKM = 30;
                $scope.LimiteFuncionamentoDiwo = arePointsNear($scope.evento, $scope.centerPoint,$scope.centerPointKM );
                      $scope.centerPointKMFB = 2500;
                      $scope.centerPointFB.lat = 39.1882887948499;
                      $scope.centerPointFB.lng = -100.07746794288232;
                      $scope.LimiteFuncionamentoDiwoFB = arePointsNear($scope.user, $scope.centerPointFB,$scope.centerPointKMFB );
                      
                      if($scope.LimiteFuncionamentoDiwoFB){
                        $scope.LimiteFuncionamentoDiwo = true;
                      }
                geocoder.geocode({'location': latlng}, function(results, status) {
                  if (status === 'OK') {
                    if (results[1]) {
                      $scope.evento.nomelocal = results[0].address_components[0].long_name;
                      for(var i = 0;i<results[0].address_components.length;i++){
                        if(results[0].address_components[i].types[0] == "administrative_area_level_2"){
                          $scope.evento.cidade = results[0].address_components[i].long_name;
                          console.log($scope.evento.cidade)
                        }
                      }
                      //$scope.evento.cidade = results[0].address_components[4].long_name;
                      $scope.evento.endereco = results[0].formatted_address;
                      console.log($scope.evento.endereco);
                      console.log($scope.evento.cidade);
                      console.log($scope.evento.lng);
                      console.log($scope.evento.lat);
                      infowindow.setContent(results[0].formatted_address);
                     
                      infowindow.open(map, marker);
                      setTimeout(function () { infowindow.close(); }, 5000);
                    } else {
                      window.alert('No results found');
                    }
                  } else {
                    window.alert('Geocoder failed due to: ' + status);
                  }
                });
            };

            function arePointsNear(checkPoint, centerPoint, km) {
                  var ky = 40000 / 360;
                  var kx = Math.cos(Math.PI * centerPoint.lat / 180.0) * ky;
                  var dx = Math.abs(centerPoint.lng - $scope.evento.lng) * kx;
                  var dy = Math.abs(centerPoint.lat - $scope.evento.lat) * ky;
                  return Math.sqrt(dx * dx + dy * dy) <= km;
                }    

            function handleEvent(event) {
                $scope.evento.lat = event.latLng.lat();
                $scope.evento.lng = event.latLng.lng();
                $scope.centerPoint.lat = -26.997799;
                $scope.centerPoint.lng = -48.632733; 
                // $scope.centerPoint.lat = -25.473466587692343;
                // $scope.centerPoint.lng = -49.29164589792566;
                $scope.centerPointKM = 30;
                $scope.LimiteFuncionamentoDiwo = arePointsNear($scope.evento, $scope.centerPoint,$scope.centerPointKM );
                $scope.centerPointKMFB = 2500;
                      $scope.centerPointFB.lat = 39.1882887948499;
                      $scope.centerPointFB.lng = -100.07746794288232;
                      $scope.LimiteFuncionamentoDiwoFB = arePointsNear($scope.user, $scope.centerPointFB,$scope.centerPointKMFB );
                      
                      if($scope.LimiteFuncionamentoDiwoFB){
                        $scope.LimiteFuncionamentoDiwo = true;
                      }
                              // GEOCODER INVERSO

                var geocoder = new google.maps.Geocoder;
                var infowindow = new google.maps.InfoWindow({
                                                              maxWidth: 200
                                                            });;    
            
                geocoder.geocode({'location': event.latLng}, function(results, status) {
                  if (status === 'OK') {
                    if (results[1]) {
                      $scope.evento.nomelocal = results[0].address_components[0].long_name;
                      for(var i = 0;i<results[0].address_components.length;i++){
                        if(results[0].address_components[i].types[0] == "administrative_area_level_2"){
                          $scope.evento.cidade = results[0].address_components[i].long_name;
                          console.log($scope.evento.cidade)
                        }
                      }
                      //$scope.evento.cidade = results[0].address_components[4].long_name;
                      $scope.evento.endereco = results[0].formatted_address;
                      // console.log($scope.evento.endereco);
                      // console.log($scope.evento.cidade);
                      console.log($scope.evento.lng);
                      console.log($scope.evento.lat);
                      infowindow.setContent(results[0].formatted_address);
                     
                      infowindow.open(map, marker);
                      setTimeout(function () { infowindow.close(); }, 5000);
                    } else {
                      window.alert('No results found');
                    }
                  } else {
                    window.alert('Geocoder failed due to: ' + status);
                  }
                });
            }
            var input = document.getElementById('pac-input');
            var searchBox = new google.maps.places.SearchBox(input);
            map.addListener('bounds_changed', function() {
                searchBox.setBounds(map.getBounds());
            });
            var markers = [];
            searchBox.addListener('places_changed', function() {
                var places = searchBox.getPlaces();

                if (places.length == 0) {
                  return;
                }

                // Clear out the old markers.
                markers.forEach(function(marker) {
                  marker.setMap(null);
                });
                markers = [];

                // For each place, get the icon, name and location.
                var bounds = new google.maps.LatLngBounds();
                places.forEach(function(place) {
                  if (!place.geometry) {
                    console.log("Returned place contains no geometry");
                    return;
                  }
                  // var icon = {
                  //   url: place.icon,
                  //   size: new google.maps.Size(71, 71),
                  //   origin: new google.maps.Point(0, 0),
                  //   anchor: new google.maps.Point(17, 34),
                  //   scaledSize: new google.maps.Size(25, 25)
                  // };

                  // Create a marker for each place.
                  markers.push(new google.maps.Marker({
                    map: map,
                    // icon: icon,
                    title: place.name,
                    position: place.geometry.location
                  }));

                  $scope.evento.nomelocal = place.name;
                  $scope.evento.endereco = place.formatted_address;
             
                  for(var i = 0;i<place.address_components.length;i++){
                    //console.log(place.address_components[i].types[0])
                    if(place.address_components[i].types[0] == "administrative_area_level_2"){
                      $scope.evento.cidade = place.address_components[i].long_name;
                      console.log($scope.evento.cidade)
                    }
                  }
                 
                  $scope.evento.lat = place.geometry.location.lat();
                  $scope.evento.lng = place.geometry.location.lng();
                  $scope.centerPoint.lat = -26.997799;
                  $scope.centerPoint.lng = -48.632733; 
                  // $scope.centerPoint.lat = -25.473466587692343;
                  // $scope.centerPoint.lng = -49.29164589792566;
                  $scope.centerPointKM = 30;
                  $scope.LimiteFuncionamentoDiwo = arePointsNear($scope.evento, $scope.centerPoint,$scope.centerPointKM );
                  $scope.centerPointKMFB = 2500;
                      $scope.centerPointFB.lat = 39.1882887948499;
                      $scope.centerPointFB.lng = -100.07746794288232;
                      $scope.LimiteFuncionamentoDiwoFB = arePointsNear($scope.user, $scope.centerPointFB,$scope.centerPointKMFB );
                      
                      if($scope.LimiteFuncionamentoDiwoFB){
                        $scope.LimiteFuncionamentoDiwo = true;
                      }
                  console.log($scope.evento.lng, $scope.evento.lat, "lssdd", $scope.evento.nomelocal, $scope.evento.endereco);

                  if (place.geometry.viewport) {
                    // Only geocodes have viewport.
                    bounds.union(place.geometry.viewport);
                  } else {
                    bounds.extend(place.geometry.location);
                  }
                });
                map.fitBounds(bounds);
            });

            $scope.map = map;  
             
        }, function(err) {
            console.log(err.code);
            console.log(err.message);
        });
    }
      

  })

  var posOptions = {
      enableHighAccuracy: true,
      timeout: 200000,
      maximumAge: 0
  };

    navigator.geolocation.getCurrentPosition(function(position){
          
            var lat  = position.coords.latitude;
            var long = position.coords.longitude;
             

            var myLatlng = new google.maps.LatLng(lat, long);
             
            var mapOptions = {
                center: myLatlng,
                zoom: 16,
                mapTypeId: google.maps.MapTypeId.ROADMAP
            };          
             
            var map = new google.maps.Map(document.getElementById("map_canvas"), mapOptions); 


            var marker = new google.maps.Marker({
                      position: new google.maps.LatLng(position.coords.latitude, position.coords.longitude),
                      map: map,
                      title: "Borai",
                      draggable: true,
                      icon: 'http://maps.google.com/mapfiles/ms/icons/green-dot.png',
                      animation: google.maps.Animation.DROP 
                  })

            var geocoder = new google.maps.Geocoder;
            var infowindow = new google.maps.InfoWindow({maxWidth: 200});

            geocoder.geocode({'location': myLatlng}, function(results, status) {
                  if (status === 'OK') {
                    if (results[1]) {
                      $scope.evento.nomelocal = results[0].address_components[0].long_name;
                      $scope.evento.endereco = results[0].formatted_address;
                      for(var i = 0;i<results[0].address_components.length;i++){
                        if(results[0].address_components[i].types[0] == "administrative_area_level_2"){
                          $scope.evento.cidade = results[0].address_components[i].long_name;
                          console.log($scope.evento.cidade)
                        }
                      }
                      //$scope.evento.cidade = results[0].address_components[4].long_name;
                      $scope.evento.lat = position.coords.latitude;
                      $scope.evento.lng = position.coords.longitude;
                      $scope.centerPoint.lat = -26.997799;
                      $scope.centerPoint.lng = -48.632733; 
                      // $scope.centerPoint.lat = -25.473466587692343;
                      // $scope.centerPoint.lng = -49.29164589792566;
                      $scope.centerPointKM = 30;
                      $scope.LimiteFuncionamentoDiwo = arePointsNear($scope.evento, $scope.centerPoint,$scope.centerPointKM );
                      $scope.centerPointKMFB = 2500;
                      $scope.centerPointFB.lat = 39.1882887948499;
                      $scope.centerPointFB.lng = -100.07746794288232;
                      $scope.LimiteFuncionamentoDiwoFB = arePointsNear($scope.user, $scope.centerPointFB,$scope.centerPointKMFB );
                      
                      if($scope.LimiteFuncionamentoDiwoFB){
                        $scope.LimiteFuncionamentoDiwo = true;
                      }
                      infowindow.setContent(results[0].formatted_address);
                      console.log($scope.evento.endereco);
                      console.log($scope.evento.cidade);
                      console.log($scope.evento.lng);
                      console.log($scope.evento.lat);
                      //infowindow.setContent(results[0].address_components[2].long_name);
                      infowindow.open(map, marker);
                      setTimeout(function () { infowindow.close(); }, 5000);
                    } else {
                      window.alert('No results found');
                    }
                  } else {
                    window.alert('Geocoder failed due to: ' + status);
                  }
                });


            google.maps.event.addListener(marker, "dragstart", function (event) {
               marker.setAnimation(3); // raise
            });

            google.maps.event.addListener(marker, "dragend", function (event) {
               marker.setAnimation(4); // raise
            });

            marker.addListener('dragend', handleEvent);

            google.maps.event.addListener(map, 'click', function(e) {
              
                markers.forEach(function(marker) {
                marker.setMap(null);
                });
                markers = [];

                placeMarker(e.latLng, map, marker);

            });
             function arePointsNear(checkPoint, centerPoint, km) {
                  var ky = 40000 / 360;
                  var kx = Math.cos(Math.PI * centerPoint.lat / 180.0) * ky;
                  var dx = Math.abs(centerPoint.lng - $scope.evento.lng) * kx;
                  var dy = Math.abs(centerPoint.lat - $scope.evento.lat) * ky;
                  return Math.sqrt(dx * dx + dy * dy) <= km;
                } 

            function placeMarker(latlng, map, marker) {
                marker.setPosition(latlng);
                marker.setMap(map);
                map.panTo(latlng);
                $scope.evento.lat = latlng.lat();
                $scope.evento.lng = latlng.lng();
                $scope.centerPoint.lat = -26.997799;
                $scope.centerPoint.lng = -48.632733;
                // $scope.centerPoint.lat = -25.473466587692343;
                // $scope.centerPoint.lng = -49.29164589792566; 
                $scope.centerPointKM = 30;
                $scope.LimiteFuncionamentoDiwo = arePointsNear($scope.evento, $scope.centerPoint,$scope.centerPointKM );
                $scope.centerPointKMFB = 2500;
                      $scope.centerPointFB.lat = 39.1882887948499;
                      $scope.centerPointFB.lng = -100.07746794288232;
                      $scope.LimiteFuncionamentoDiwoFB = arePointsNear($scope.user, $scope.centerPointFB,$scope.centerPointKMFB );
                      
                      if($scope.LimiteFuncionamentoDiwoFB){
                        $scope.LimiteFuncionamentoDiwo = true;
                      }
                geocoder.geocode({'location': latlng}, function(results, status) {
                  if (status === 'OK') {
                    if (results[1]) {
                      $scope.evento.nomelocal = results[0].address_components[0].long_name;
                      for(var i = 0;i<results[0].address_components.length;i++){
                        if(results[0].address_components[i].types[0] == "administrative_area_level_2"){
                          $scope.evento.cidade = results[0].address_components[i].long_name;
                          console.log($scope.evento.cidade)
                        }
                      }
                      //$scope.evento.cidade = results[0].address_components[4].long_name;
                      $scope.evento.endereco = results[0].formatted_address;
                      console.log($scope.evento.endereco);
                      console.log($scope.evento.cidade);
                      console.log($scope.evento.lng);
                      console.log($scope.evento.lat);
                      infowindow.setContent(results[0].formatted_address);
                     
                      infowindow.open(map, marker);
                      setTimeout(function () { infowindow.close(); }, 5000);
                    } else {
                      window.alert('No results found');
                    }
                  } else {
                    window.alert('Geocoder failed due to: ' + status);
                  }
                });
            };        

            function handleEvent(event) {
                $scope.evento.lat = event.latLng.lat();
                $scope.evento.lng = event.latLng.lng();
                $scope.centerPoint.lat = -26.997799;
                $scope.centerPoint.lng = -48.632733; 
                // $scope.centerPoint.lat = -25.473466587692343;
                // $scope.centerPoint.lng = -49.29164589792566;
                $scope.centerPointKM = 30;
                $scope.LimiteFuncionamentoDiwo = arePointsNear($scope.evento, $scope.centerPoint,$scope.centerPointKM );
                $scope.centerPointKMFB = 2500;
                      $scope.centerPointFB.lat = 39.1882887948499;
                      $scope.centerPointFB.lng = -100.07746794288232;
                      $scope.LimiteFuncionamentoDiwoFB = arePointsNear($scope.user, $scope.centerPointFB,$scope.centerPointKMFB );
                      
                      if($scope.LimiteFuncionamentoDiwoFB){
                        $scope.LimiteFuncionamentoDiwo = true;
                      }
                              // GEOCODER INVERSO

                var geocoder = new google.maps.Geocoder;
                var infowindow = new google.maps.InfoWindow({
                                                              maxWidth: 200
                                                            });;    
            
                geocoder.geocode({'location': event.latLng}, function(results, status) {
                  if (status === 'OK') {
                    if (results[1]) {
                      $scope.evento.nomelocal = results[0].address_components[0].long_name;
                      for(var i = 0;i<results[0].address_components.length;i++){
                        if(results[0].address_components[i].types[0] == "administrative_area_level_2"){
                          $scope.evento.cidade = results[0].address_components[i].long_name;
                          console.log($scope.evento.cidade)
                        }
                      }
                      //$scope.evento.cidade = results[0].address_components[4].long_name;
                      $scope.evento.endereco = results[0].formatted_address;
                      // console.log($scope.evento.endereco);
                      // console.log($scope.evento.cidade);
                      console.log($scope.evento.lng);
                      console.log($scope.evento.lat);
                      infowindow.setContent(results[0].formatted_address);
                     
                      infowindow.open(map, marker);
                      setTimeout(function () { infowindow.close(); }, 5000);
                    } else {
                      window.alert('No results found');
                    }
                  } else {
                    window.alert('Geocoder failed due to: ' + status);
                  }
                });
            }

                              // GEOCODER INVERSO

                

                
            
                    //        SEARCHBOX

            var input = document.getElementById('pac-input');
            var searchBox = new google.maps.places.SearchBox(input);
          //map.controls[google.maps.ControlPosition.TOP_LEFT].push(input);

        // Bias the SearchBox results towards current map's viewport.
            map.addListener('bounds_changed', function() {
                searchBox.setBounds(map.getBounds());
            });

            var markers = [];
        // Listen for the event fired when the user selects a prediction and retrieve
        // more details for that place.
            searchBox.addListener('places_changed', function() {
                var places = searchBox.getPlaces();

                if (places.length == 0) {
                  return;
                }

                // Clear out the old markers.
                markers.forEach(function(marker) {
                  marker.setMap(null);
                });
                markers = [];

                // For each place, get the icon, name and location.
                var bounds = new google.maps.LatLngBounds();
                places.forEach(function(place) {
                  if (!place.geometry) {
                    console.log("Returned place contains no geometry");
                    return;
                  }
                  // var icon = {
                  //   url: place.icon,
                  //   size: new google.maps.Size(71, 71),
                  //   origin: new google.maps.Point(0, 0),
                  //   anchor: new google.maps.Point(17, 34),
                  //   scaledSize: new google.maps.Size(25, 25)
                  // };

                  // Create a marker for each place.
                  markers.push(new google.maps.Marker({
                    map: map,
                    // icon: icon,
                    title: place.name,
                    position: place.geometry.location
                  }));

                  $scope.evento.nomelocal = place.name;
                  $scope.evento.endereco = place.formatted_address;
                  for(var i = 0;i<place.address_components.length;i++){
                    //console.log(place.address_components[i].types[0])
                    if(place.address_components[i].types[0] == "administrative_area_level_2"){
                      $scope.evento.cidade = place.address_components[i].long_name;
                      console.log($scope.evento.cidade)
                    }
                  }
                 
                  $scope.evento.lat = place.geometry.location.lat();
                  $scope.evento.lng = place.geometry.location.lng();
                  $scope.centerPoint.lat = -26.997799;
                  $scope.centerPoint.lng = -48.632733; 
                  // $scope.centerPoint.lat = -25.473466587692343;
                  // $scope.centerPoint.lng = -49.29164589792566;
                  $scope.centerPointKM = 30;
                  $scope.LimiteFuncionamentoDiwo = arePointsNear($scope.evento, $scope.centerPoint,$scope.centerPointKM );
                  $scope.centerPointKMFB = 2500;
                      $scope.centerPointFB.lat = 39.1882887948499;
                      $scope.centerPointFB.lng = -100.07746794288232;
                      $scope.LimiteFuncionamentoDiwoFB = arePointsNear($scope.user, $scope.centerPointFB,$scope.centerPointKMFB );
                      
                      if($scope.LimiteFuncionamentoDiwoFB){
                        $scope.LimiteFuncionamentoDiwo = true;
                      }
                  // console.log($scope.coord.endereco);
                  // console.log($scope.coord.long);
                  // console.log($scope.coord.lat);

                  if (place.geometry.viewport) {
                    // Only geocodes have viewport.
                    bounds.union(place.geometry.viewport);
                  } else {
                    bounds.extend(place.geometry.location);
                  }
                });
                map.fitBounds(bounds);
            });

            $scope.map = map;  
             
        }, function(err) {
            console.log(err.code);
            console.log(err.message);
        });


        $scope.Proximo = function(evento) {
          if($scope.LimiteFuncionamentoDiwo){
            formEventoNovoCriar.updateForm($scope.evento);
            $state.go('tabsController.criarpreco');
          }else{
            var alertPopup = $ionicPopup.alert({
                title: '( ꒪Д꒪)ノ',
                template: 'Ótimo saber que você quer criar um evento! Mas parece que a região onde você quer criar seu evento não está na nossa área de cobertura :/'
              }); 
          }
          
        }

}])

.controller('criarprecoCtrl', ['$scope', '$stateParams', 'formUser', 'formLoc', 'EventoService', 'formAux', '$state','$timeout', '$ionicPopup', '$http', 'formOutro', 'formItem', 'formtela', 'formtelanoti', 'formtipologin','formEventoNovoCriar', '$ionicTabsDelegate', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, formUser, formLoc, EventoService, formAux, $state, $timeout, $ionicPopup, $http, formOutro, formItem, formtela, formtelanoti, formtipologin, formEventoNovoCriar, $ionicTabsDelegate) {  
  $scope.evento = {};
  $scope.user = formUser.getForm();

  var header = document.getElementById("barmpre");
  var btns = header.getElementsByClassName("btnmpre");
  for (var i = 0; i < btns.length; i++) {
    btns[i].addEventListener("click", function() {
      var current = document.getElementsByClassName("actmpre");
      current[0].className = current[0].className.replace(" actmpre", "");
      this.className += " actmpre";
    });
  }

  $scope.$on("$ionicView.enter", function(event, data){
    $ionicTabsDelegate.showBar(0);
    $scope.evento = formEventoNovoCriar.getForm();
    $scope.user = formUser.getForm();
    if(!$scope.evento.preco){
      delete $scope.evento.preco;
    }
    
  })
  
  $scope.evento.precopor = 1;
  $scope.pessoa = function() {$scope.evento.precopor = 1;};
  $scope.hora = function() {$scope.evento.precopor = 2;};

  $scope.Proximo = function(evento){
    if(!$scope.evento.preco){
      $scope.evento.preco = 0;
    }
    formEventoNovoCriar.updateForm(evento);
    $state.go('tabsController.criargenero')
  }



}])

.controller('criargeneroCtrl', ['$scope', '$stateParams', 'formUser', 'formLoc', 'EventoService', 'formAux', '$state','$timeout', '$ionicPopup', '$http', 'formOutro', 'formItem', 'formtela', 'formtelanoti', 'formtipologin','formEventoNovoCriar', '$ionicTabsDelegate', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, formUser, formLoc, EventoService, formAux, $state, $timeout, $ionicPopup, $http, formOutro, formItem, formtela, formtelanoti, formtipologin, formEventoNovoCriar, $ionicTabsDelegate) {

  $scope.evento = {};
  $scope.user = formUser.getForm();

  $scope.$on("$ionicView.enter", function(event, data){
    $ionicTabsDelegate.showBar(0);
    $scope.evento = formEventoNovoCriar.getForm();
    $scope.user = formUser.getForm();
    console.log("$scope.evento.genero", $scope.evento.genero)
   
    
  })

  if(!$scope.user.genero){
      $state.go('idadegenero');
    }else{
      if($scope.user.genero == "fem"){
        $scope.femin = true;
      }else{
        $scope.femin = false;
      }
  }

  $scope.Proximo = function(evento){
    console.log($scope.evento.genero,"$scope.evento.genero")
    if(! $scope.evento.genero){
       $scope.evento.genero = 'todos';
    }
    formEventoNovoCriar.updateForm(evento);
    $state.go('tabsController.criarpminmax')
  }




}])

.controller('criarpminmaxCtrl', ['$scope', '$stateParams', 'formUser', 'formLoc', 'EventoService', 'formAux', '$state','$timeout', '$ionicPopup', '$http', 'formOutro', 'formItem', 'formtela', 'formtelanoti', 'formtipologin','formEventoNovoCriar', '$ionicTabsDelegate', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, formUser, formLoc, EventoService, formAux, $state, $timeout, $ionicPopup, $http, formOutro, formItem, formtela, formtelanoti, formtipologin, formEventoNovoCriar, $ionicTabsDelegate) {


  $scope.evento = {};
  $scope.user = formUser.getForm();

  $scope.$on("$ionicView.enter", function(event, data){
    $ionicTabsDelegate.showBar(0);
    $scope.evento = formEventoNovoCriar.getForm();
    $scope.user = formUser.getForm();
    if(!$scope.evento.pmax){
      $scope.evento.pmin = 2;
      $scope.evento.pmax = 10;
    }

    console.log($scope.evento.semana)
  })

  $scope.menos = function(){
    if($scope.evento.pmin >2){
      $scope.evento.pmin--;
    }
  }
  $scope.mais = function(){
    if($scope.evento.pmin < 49){
      $scope.evento.pmin++;
      if($scope.evento.pmin >= $scope.evento.pmax){
        $scope.evento.pmax = $scope.evento.pmin+1;
      }
      
    }
  }

  $scope.menosmax = function(){
    if($scope.evento.pmax >3){
      $scope.evento.pmax--;
      if($scope.evento.pmax <= $scope.evento.pmin){
        $scope.evento.pmin = $scope.evento.pmax-1;
      }
    }
  }
  $scope.maismax = function(){
    if($scope.evento.pmax < 50){
      $scope.evento.pmax++;
    }
  }
  

  $scope.Proximo = function(evento){

    formEventoNovoCriar.updateForm(evento);
    $state.go('tabsController.criartag')
  }




}])

.controller('criartagCtrl', ['$scope', '$stateParams', 'formUser', 'formLoc', 'EventoService', 'formAux', '$state','$timeout', '$ionicPopup', '$http', 'formOutro', 'formItem', 'formtela', 'formtelanoti', 'formtipologin','formEventoNovoCriar', '$ionicTabsDelegate', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, formUser, formLoc, EventoService, formAux, $state, $timeout, $ionicPopup, $http, formOutro, formItem, formtela, formtelanoti, formtipologin, formEventoNovoCriar, $ionicTabsDelegate) {

  $scope.evento = {};
  $scope.user = formUser.getForm();

  $scope.$on("$ionicView.enter", function(event, data){
    $ionicTabsDelegate.showBar(0);
    $scope.evento = formEventoNovoCriar.getForm();
    $scope.user = formUser.getForm();
    if(!$scope.evento.auxtag1){
      $scope.evento.auxtag1 = '';
      $scope.evento.auxtagbutton1 = false;
    }
    if(!$scope.evento.auxtag2){
      $scope.evento.auxtag2 = '';
      $scope.evento.auxtagbutton2 = false;
    }
    if(!$scope.evento.auxtag3){
      $scope.evento.auxtag3 = '';
      $scope.evento.auxtagbutton3 = false;
    }
    if(!$scope.evento.auxtag4){
      $scope.evento.auxtag4 = '';
      $scope.evento.auxtagbutton4 = false;
    }
    if(!$scope.evento.auxtag5){
      $scope.evento.auxtag5 = '';
      $scope.evento.auxtagbutton5 = false;
    }
    if(!$scope.evento.auxtag6){
      $scope.evento.auxtag6 = '';
      $scope.evento.auxtagbutton6 = false;
    }
    if(!$scope.evento.auxtag7){
      $scope.evento.auxtag7 = '';
      $scope.evento.auxtagbutton7 = false;
    }
    if(!$scope.evento.auxtag8){
      $scope.evento.auxtag8 = '';
      $scope.evento.auxtagbutton8 = false;
    }
    if(!$scope.evento.auxtag9){
      $scope.evento.auxtag9 = '';
      $scope.evento.auxtagbutton9 = false;
    }
    console.log($scope.evento.semana)
  })

  var auxauxtagbut = false;
  $scope.adicionatag = function(){
    if($scope.evento.addtag!=''){
      var res2 = $scope.evento.addtag.split(" ") ;
        if(res2.length>1){
          for(var w = 0; w < res2.length; w++){
            var t = res2[w].toLowerCase();
           console.log(t)
          }
          $scope.evento.addtag = res2[0];
        }
      if(!auxauxtagbut){
        auxauxtagbut = true;
        if($scope.evento.auxtagbutton1 == false && auxauxtagbut){
          $scope.evento.auxtag1 = '#' +$scope.evento.addtag;
          $scope.evento.auxtagbutton1 = true;
          auxauxtagbut = false;
        }
        if($scope.evento.auxtagbutton2 == false && auxauxtagbut){
          $scope.evento.auxtag2 = '#' +$scope.evento.addtag;
          $scope.evento.auxtagbutton2 = true;
          auxauxtagbut = false;
        }
        if($scope.evento.auxtagbutton3 == false && auxauxtagbut){
          $scope.evento.auxtag3 = '#' +$scope.evento.addtag;
          $scope.evento.auxtagbutton3 = true;
          auxauxtagbut = false;
        }
        if($scope.evento.auxtagbutton4 == false && auxauxtagbut){
          $scope.evento.auxtag4 = '#' +$scope.evento.addtag;
          $scope.evento.auxtagbutton4 = true;
          auxauxtagbut = false;
        }
        if($scope.evento.auxtagbutton5 == false && auxauxtagbut){
          $scope.evento.auxtag5 = '#' +$scope.evento.addtag;
          $scope.evento.auxtagbutton5 = true;
          auxauxtagbut = false;
        }
        if($scope.evento.auxtagbutton6 == false && auxauxtagbut){
          $scope.evento.auxtag6 = '#' +$scope.evento.addtag;
          $scope.evento.auxtagbutton6 = true;
          auxauxtagbut = false;
        }
        if($scope.evento.auxtagbutton7 == false && auxauxtagbut){
          $scope.evento.auxtag7 = '#' +$scope.evento.addtag;
          $scope.evento.auxtagbutton7 = true;
          auxauxtagbut = false;
        }
        if($scope.evento.auxtagbutton8 == false && auxauxtagbut){
          $scope.evento.auxtag8 = '#' +$scope.evento.addtag;
          $scope.evento.auxtagbutton8 = true;
          auxauxtagbut = false;
        }
        if($scope.evento.auxtagbutton9 == false && auxauxtagbut){
          $scope.evento.auxtag9 = '#' +$scope.evento.addtag;
          $scope.evento.auxtagbutton9 = true;
          auxauxtagbut = false;
        }
      }
    }
    $scope.evento.addtag = '';
  }

  $scope.tiratag1 = function(){
      $scope.evento.auxtagbutton1 = false;
      $scope.evento.auxtag1 = '';
  }
  $scope.tiratag2 = function(){
      $scope.evento.auxtagbutton2 = false;
      $scope.evento.auxtag2 = '';
  }
  $scope.tiratag3 = function(){
      $scope.evento.auxtagbutton3 = false;
      $scope.evento.auxtag3 = '';
  }
  $scope.tiratag4 = function(){
      $scope.evento.auxtagbutton4 = false;
      $scope.evento.auxtag4 = '';
  }
  $scope.tiratag5 = function(){
      $scope.evento.auxtagbutton5 = false;
      $scope.evento.auxtag5 = '';
  }
  $scope.tiratag6 = function(){
      $scope.evento.auxtagbutton6 = false;
      $scope.evento.auxtag6 = '';
  }
  $scope.tiratag7 = function(){
      $scope.evento.auxtagbutton7 = false;
      $scope.evento.auxtag7 = '';
  }
  $scope.tiratag8 = function(){
      $scope.evento.auxtagbutton8 = false;
      $scope.evento.auxtag8 = '';
  }
  $scope.tiratag9 = function(){
      $scope.evento.auxtagbutton9 = false;
      $scope.evento.auxtag9 = '';
  }

  $scope.Proximo = function(evento){
     if($scope.evento.auxtagbutton1 == true){
        if ($scope.evento.tags == undefined) {
          $scope.evento.tags = $scope.evento.auxtag1;
        }else{
          $scope.evento.tags = $scope.evento.tags + ' ' +$scope.evento.auxtag1;
        }
      }
      if($scope.evento.auxtagbutton2 == true){
        if ($scope.evento.tags == undefined) {
          $scope.evento.tags = $scope.evento.auxtag2;
        }else{
          $scope.evento.tags = $scope.evento.tags + ' ' +$scope.evento.auxtag2;
        }
      }
      if($scope.evento.auxtagbutton3 == true){
        if ($scope.evento.tags == undefined) {
          $scope.evento.tags = $scope.evento.auxtag3;
        }else{
        $scope.evento.tags = $scope.evento.tags + ' ' +$scope.evento.auxtag3;
        }
      }
      if($scope.evento.auxtagbutton4 == true){
        if ($scope.evento.tags == undefined) {
          $scope.evento.tags = $scope.evento.auxtag4;
        }else{
          $scope.evento.tags = $scope.evento.tags + ' ' +$scope.evento.auxtag4;
        }
      }
      if($scope.evento.auxtagbutton5 == true){
        if ($scope.evento.tags == undefined) {
          $scope.evento.tags = $scope.evento.auxtag5;
        }else{
          $scope.evento.tags = $scope.evento.tags + ' ' +$scope.evento.auxtag5;
        }
      }
      if($scope.evento.auxtagbutton6 == true){
        if ($scope.evento.tags == undefined) {
          $scope.evento.tags = $scope.evento.auxtag6;
        }else{
          $scope.evento.tags = $scope.evento.tags + ' ' +$scope.evento.auxtag6;
        }
      }
      if($scope.evento.auxtagbutton7 == true){
        if ($scope.evento.tags == undefined) {
          $scope.evento.tags = $scope.evento.auxtag7;
        }else{
          $scope.evento.tags = $scope.evento.tags + ' ' +$scope.evento.auxtag7;
        }
      }
      if($scope.evento.auxtagbutton8 == true){
        if ($scope.evento.tags == undefined) {
          $scope.evento.tags = $scope.evento.auxtauxtag8ag2;
        }else{
          $scope.evento.tags = $scope.evento.tags + ' ' +$scope.evento.auxtag8;
        }
      }
      if($scope.evento.auxtagbutton9 == true ){
        if ($scope.evento.tags == undefined) {
          $scope.evento.tags = $scope.evento.auxtag9;
        }else{
          $scope.evento.tags = $scope.evento.tags + ' ' +$scope.evento.auxtag9;
        }
      }

    if (!$scope.evento.tags) {
      var alertPopup = $ionicPopup.alert({
        title: '(⊙﹏⊙✿)',
        template: 'Coloque pelo menos uma tag para facilitar a procura do seu evento'
      });
    }else{
      formEventoNovoCriar.updateForm(evento);
      $state.go('tabsController.criartitulo')
    }
  }


}])

.controller('criartituloCtrl', ['$scope', '$stateParams', 'formUser', 'formLoc', 'EventoService', 'formAux', '$state','$timeout', '$ionicPopup', '$http', 'formOutro', 'formItem', 'formtela', 'formtelanoti', 'formtipologin','formEventoNovoCriar', '$ionicTabsDelegate', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, formUser, formLoc, EventoService, formAux, $state, $timeout, $ionicPopup, $http, formOutro, formItem, formtela, formtelanoti, formtipologin, formEventoNovoCriar, $ionicTabsDelegate) {

  $scope.evento = {};
  $scope.user = formUser.getForm();

  $scope.$on("$ionicView.enter", function(event, data){
    $ionicTabsDelegate.showBar(0);
    $scope.evento = formEventoNovoCriar.getForm();
    $scope.user = formUser.getForm();
    // if(!$scope.evento.nomeevento)
    // console.log($scope.evento.semana)
    // delete $scope.evento.nomeevento
  })



  $scope.Proximo = function(evento){

    if($scope.evento.nomeevento){
      var palavrasnaousar = ["ALIAMBA", "ANUS", "BAGULIO"
      , "BANZA", "BARRUFO", "BECK", "BEQUE", "BOCETA"
      , "BOLAGATO", "BOQUETE", "BOLCAT", "BOSSETA", "BOSTANA", "BREXA", "BRIOCO", "BRONHA", "BUCA", "BUCETA"
      , "BUSSETA", "CANABIS", "CANNABIS", "CARALHO"
      , "CASSETA", "CASSETE", "CHECHECA", "CHERECA", "CHIBUMBA", "CHIBUMBO", "CHOTA", "CHOCHOTA", "CHUPADA", "CHUPADO", "CLITORIS"
      , "COCAINA", "C+"
      , "C*", "CURALHO", "CUZAO", "CUZUDA", "CUZUDO", "CUZÃO", "ESPORRADA", "ESPORRADO", "ESPORRO", "estupro"
      , "FELACAO", "FELACÃO", "FODA", "FODAO", "FODÃO", "FODAUM", "FODE", "FODIDA", "FODIDO", "FORNICA", "FUDENDO", "FUDECÃO", "FUDECAO"
      , "FUDIDA", "FUDIDO", "GRELINHO", "GRELO", "ISCROTA", "ISCROTO", "MACONHA", "MASTURBA", "MASTURBAÇÃO", "MASTURBACÃO", "MASTURBACAO"
      , "PENIS", "PEN1S", "PENES", "PENIZ", "PICA", "PIROCA", "PIRU", "PORRA", "POURRA", "PROSTIBULO", "PUTA", "PUNHETA", "PUTO"
      , "RABAO", "TESTUDA", "TESTUDO", "VAGABUNDA", "VAGINA", "VIADO", "VIADAO", "VIADÃO", "XAVASCA", "XERERECA", "XEXECA", "XOTA"
      , "XOCHOTA", "XOXOTA", "XANA", "XANINHA", "MDMA",  "VSF", "TNC", "FDP", "CRACK"];
      var error = 0; 
      for (var i = 0; i < palavrasnaousar.length; i++) {
        var res2 = $scope.evento.nomeevento.split("_") ;
        if(res2.length>1){
          for(var w = 0; w < res2.length; w++){
            var val = palavrasnaousar[i].toLowerCase();
            if ((res2[w].toLowerCase()).indexOf(val.toString()) > -1) {  
              error = error + 1;  
            }
          }
        }else{
          var val = palavrasnaousar[i].toLowerCase();  
          if (($scope.evento.nomeevento.toLowerCase()).indexOf(val.toString()) > -1) {  
            error = error + 1;  
          }
        }
        var res3 = $scope.evento.nomeevento.split(" ");
        if(res3.length>1){
          for(var w = 0; w < res3.length; w++){
            var val = palavrasnaousar[i].toLowerCase();
            if ((res3[w].toLowerCase()).indexOf(val.toString()) > -1) {  
              error = error + 1;  
            }
          }
        }else{
          var val = palavrasnaousar[i].toLowerCase();  
          if (($scope.evento.nomeevento.toLowerCase()).indexOf(val.toString()) > -1) {  
            error = error + 1;  
          }
        }   
      } 
      if (error > 0) {  
          var alertPopup = $ionicPopup.alert({
                title: '（・о・；）',
                template: 'Que boquinha suja eim, usaste uma palavra inapropriada né'
              }); 
      }else{
        formEventoNovoCriar.updateForm(evento);
        $state.go('tabsController.criardescricao') 
      }
    }else{
      var alertPopup = $ionicPopup.alert({
        title: '（ΦωΦ）',
        template: 'Coloque um nome legal'
      });
    }
    
  }



}])

.controller('criardescricaoCtrl', ['$scope', '$stateParams', 'formUser', 'formLoc', 'EventoService', 'formAux', '$state','$timeout', '$ionicPopup', '$http', 'formOutro', 'formItem', 'formtela', 'formtelanoti', 'formtipologin','formEventoNovoCriar', '$ionicTabsDelegate','$ionicLoading','formtelaCriar','formtela2', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, formUser, formLoc, EventoService, formAux, $state, $timeout, $ionicPopup, $http, formOutro, formItem, formtela, formtelanoti, formtipologin, formEventoNovoCriar, $ionicTabsDelegate, $ionicLoading, formtelaCriar, ) {
  $scope.evento = {};
  $scope.user = formUser.getForm();

  $scope.$on("$ionicView.enter", function(event, data){
    $ionicTabsDelegate.showBar(0);
    $scope.evento = formEventoNovoCriar.getForm();
    $scope.user = formUser.getForm();
    console.log($scope.evento.semana)
  })



  $scope.Proximo = function(evento){

      var palavrasnaousar = ["ALIAMBA", "ANUS", "BAGULIO"
      , "BANZA", "BARRUFO", "BECK", "BEQUE", "BOCETA"
      , "BOLAGATO", "BOQUETE", "BOLCAT", "BOSSETA", "BOSTANA", "BREXA", "BRIOCO", "BRONHA", "BUCA", "BUCETA"
      , "BUSSETA", "CANABIS", "CANNABIS", "CARALHO"
      , "CASSETA", "CASSETE", "CHECHECA", "CHERECA", "CHIBUMBA", "CHIBUMBO", "CHOTA", "CHOCHOTA", "CHUPADA", "CHUPADO", "CLITORIS"
      , "COCAINA","C+"
      , "C*", "CURALHO", "CUZAO", "CUZUDA", "CUZUDO", "CUZÃO", "ESPORRADA", "ESPORRADO", "ESPORRO", "estupro"
      , "FELACAO", "FELACÃO", "FODA", "FODAO", "FODÃO", "FODAUM", "FODE", "FODIDA", "FODIDO", "FORNICA", "FUDENDO", "FUDECÃO", "FUDECAO"
      , "FUDIDA", "FUDIDO", "GRELINHO", "GRELO", "ISCROTA", "ISCROTO", "MACONHA", "MASTURBA", "MASTURBAÇÃO", "MASTURBACÃO", "MASTURBACAO"
      , "PENIS", "PEN1S", "PENES", "PENIZ", "PICA", "PIROCA", "PIRU", "PORRA", "POURRA", "PROSTIBULO", "PUTA", "PUNHETA", "PUTO"
      , "RABAO", "TESTUDA", "TESTUDO", "VAGABUNDA", "VAGINA", "VIADO", "VIADAO", "VIADÃO", "XAVASCA", "XERERECA", "XEXECA", "XOTA"
      , "XOCHOTA", "XOXOTA", "XANA", "XANINHA", "MDMA", "VSF", "TNC", "FDP", "CRACK"];
      var error = 0; 
      for (var i = 0; i < palavrasnaousar.length; i++) {
        var res2 = $scope.evento.descricao.split("_") ;
        if(res2.length>1){
          for(var w = 0; w < res2.length; w++){
            var val = palavrasnaousar[i].toLowerCase();
            if ((res2[w].toLowerCase()).indexOf(val.toString()) > -1) {  
              error = error + 1;  
            }
          }
        }else{
          var val = palavrasnaousar[i].toLowerCase();  
          if (($scope.evento.descricao.toLowerCase()).indexOf(val.toString()) > -1) {  
            error = error + 1;  
          }
        }
        var res3 = $scope.evento.descricao.split(" ") ;
        if(res3.length>1){
          for(var w = 0; w < res3.length; w++){
            var val = palavrasnaousar[i].toLowerCase();
            if ((res3[w].toLowerCase()).indexOf(val.toString()) > -1) {  
              error = error + 1;  
            }
          }
        }else{
          var val = palavrasnaousar[i].toLowerCase();  
          if (($scope.evento.descricao.toLowerCase()).indexOf(val.toString()) > -1) {  
            error = error + 1;  
          }
        }   
      } 
      if (error > 0) {  
          var alertPopup = $ionicPopup.alert({
                title: '（・о・；）',
                template: 'Que boquinha suja eim, usaste uma palavra inapropriada né'
              }); 
      }else{   
        if(evento.descricao){
          formEventoNovoCriar.updateForm($scope.evento);
          $state.go('tabsController.criarfoto');
        }else{
          var alertPopup = $ionicPopup.alert({
                title: '( ꒪Д꒪)ノ',
                template: 'Escreva algo na descrição do evento para ajudar as pessoas a entenderem o que será feito'
              }); 
        }
        
      }
  }

  var secret = 0;
  $scope.segredo = function(){
    secret++;
  }

  var secret2 = 0;
  $scope.segredo2 = function(){
    secret2++;
    if(secret2 > 5 && secret > 5){
      
      var alertPopup = $ionicPopup.alert({
                        title: 'NANIIII? ',
                        template: 'AREA RESTRITA!!! Somente para japoneses!!!'
                      });
        alertPopup.then(function(){
          secret2 = 0;
          secret = 0;
          $ionicLoading.show({
            template: '<ion-spinner icon="ripple" class="spinner-diwo"></ion-spinner>'+
                      '<p style="color:#ff4444;font-weight:bold;font-family:Kollektif;padding:auto;margin:auto;">Aguarde enquanto juntamos as peças</p>'
          });
          $scope.evento.eventopic = "img/ev.png";
          var link = 'https://ec2.diwoapp.com.br/criareventoprivado.php';
              $http.post(link, {nomeevento : $scope.evento.nomeevento, 
                                        duracao : $scope.evento.duracao,
                                        diainicio : $scope.evento.diainicio,
                                        semana : $scope.evento.semana,
                                        diafim : $scope.evento.diafim,
                                        dialimiteconfirmacao: $scope.evento.dialimiteconfirmacao,
                                        pmin : $scope.evento.pmin, 
                                        patual : 1, 
                                        pmax : $scope.evento.pmax,
                                        adm : $scope.user.iduser,
                                        admusername : $scope.user.username,
                                        admapelido : $scope.user.apelido,
                                        preco : $scope.evento.preco,
                                        precopor : $scope.evento.precopor,  
                                        nomelocal : $scope.evento.nomelocal,
                                        endereco : $scope.evento.endereco,
                                        cidade : $scope.evento.cidade,
                                        lat : $scope.evento.lat,
                                        lng : $scope.evento.lng,
                                        genero : $scope.evento.genero,
                                        eventopic : $scope.evento.eventopic,
                                        descricao : $scope.evento.descricao,
                                        comerciodevicetoken : $scope.user.devicetoken}).then(function (res){
                          $scope.responsecriado = res.data;
                console.log(res.data.success, "criou", $scope.responsecriado.last);
                if ($scope.responsecriado.success == true) {
                  
                        // CRIO TAG
                  var res = $scope.evento.tags.split(" ") ;
                  for (var i = 0; i<res.length;i++){
                    if(res[i][0]!='#'){
                      res[i]= '#' + res[i];
                    }
                    console.log(res[i], "tags", $scope.responsecriado.last)
                    var link = 'https://ec2.diwoapp.com.br/criartag.php';
                      $http.post(link, {idevento : $scope.responsecriado.last, 
                                        tag : res[i]}).then(function (res){console.log(res.success, "criou tag")});
                  }
                  console.log(res.data,"res.data",$scope.responsecriado.last)
                  var link = 'https://ec2.diwoapp.com.br/irevento.php';
                  $http.post(link, {idevento : $scope.responsecriado.last, 
                                    iduser : $scope.user.iduser,
                                    idadm : $scope.user.iduser,
                                    admusername : $scope.user.username,  
                                    diainicio : $scope.evento.diainicio,
                                    diafim : $scope.evento.diafim,
                                    username : $scope.user.username,
                                    borda : $scope.user.borda,
                                    apelido : $scope.user.apelido,
                                    profilepic : $scope.user.profilepic,
                                    devicetoken : $scope.user.devicetoken,
                                    confirmacao :  'aprovado',
                                    nomeevento :  $scope.evento.nomeevento,
                                    idComercioParceiro : $scope.evento.idComercioParceiro, 
                                    eventopic : $scope.evento.eventopic, 
                                    estado : '0'}).then(function (res){
                    $scope.response = res.data;
                    console.log(res.data,"res.data",$scope.responsecriado.last)
                    $http.post('https://ec2.diwoapp.com.br/pessoanaoevento.php', {iduser : $scope.user.iduser, 
                                                                              idevento : $scope.responsecriado.last,
                                                                              nomeevento : $scope.evento.nomeevento,
                                                                              estado : '10'});
                    $ionicLoading.hide();
                    formtelaCriar.updateForm(1);
                    formtela2.updateForm(1);
                    $scope.evento = {};
                    $state.go('tabsController.home');
                  }) 
                }
                       
        }); 
      }); 
    }
  }


}])


.controller('criarfotoCtrl', ['$scope', '$stateParams', '$state', 'formEventoCriar', 'formUser','$ionicPopup', '$http', 'formtela2', 'formtelaCriar', 'EventoService', '$cordovaCamera', '$cordovaFile', '$cordovaFileTransfer', '$cordovaDevice',  '$ionicLoading','formEventoNovoCriar', '$ionicTabsDelegate','$timeout', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, $state, formEventoCriar, formUser, $ionicPopup, $http, formtela2, formtelaCriar, EventoService, $cordovaCamera, $cordovaFile, $cordovaFileTransfer, $cordovaDevice,  $ionicLoading,  formEventoNovoCriar, $ionicTabsDelegate, $timeout) {
 
  $scope.user = formUser.getForm();
  var noti = {};
  $scope.pushnoti ={};
  $scope.auxfoto = '';
  $scope.confirmacao = 'aprovado';
  $scope.estado = '0';
  $scope.ic = {};
  var evpic ='';
  
  document.getElementById("imageCriarFoto").src="img/ev.png";
    $scope.getPicture = function (optionsCamera) {
      var optionsCamera = {
            quality : 100,
            sourceType : 0,
            allowEdit : true,
            targetWidth: 640,
            targetHeight: 640
      };
      $cordovaCamera.getPicture(optionsCamera).then(function(imageData) {
        $scope.imgURI = imageData;
        document.getElementById("imageCriarFoto").src=imageData;
      }, function(err) {
        console.log(err);
      });
    };


    $scope.$on("$ionicView.enter", function(event, data){
      $ionicTabsDelegate.showBar(0);
      $scope.evento = formEventoNovoCriar.getForm();
      $scope.user = formUser.getForm();
      var deu =false;
      var tela = formtelaCriar.getForm();
      if(tela == 1 ){
        $state.go('tabsController.criarmarcandodia')
      }
    });
    var deu =false;
    $scope.Proximo = function() {
       $ionicLoading.show({
            template: '<ion-spinner icon="ripple" class="spinner-diwo"></ion-spinner>'+
                      '<p style="color:#ff4444;font-weight:bold;font-family:Kollektif;padding:auto;margin:auto;">Aguarde enquanto juntamos as peças</p>'
          });
       
        if(deu==false){
          var hj = $scope.evento.diainicio;      

          var mes = (hj[5]+hj[6]).valueOf();
          var dia = (hj[8]+hj[9]).valueOf();
          var diadia = dia+'/'+mes;
          if(document.getElementById("imageCriarFoto").src != "img/ev.png"){ 
            $scope.auxfoto = $scope.evento.nomeevento + $scope.evento.diainicio;
            var mystring = String($scope.auxfoto);
            mystring = mystring.replace(/[^a-zA-Z0-9]/g, '');
            $scope.evento.eventopic = 'https://s3.amazonaws.com/diwoappprofilepics/eventopicsdiwo/' + mystring + '.jpg';
          }else{
            $scope.evento.eventopic = "img/ev.png";
          }
          var url = "https://ec2.diwoapp.com.br/uploadfotoevento.php";
                                  // File for Upload


          if($scope.imgURI){
            var targetPath = $scope.imgURI;
           
            // File name only
            //var name = $scope.imgURI.substr(imageData.lastIndexOf('/') + 1);
            var filename = mystring + '.jpg';
            // NO CASO SERIA O NOME DO USUARIO.jpg O fileName
            var options = {
              fileKey: "file",
              fileName: filename,
              chunkedMode: false,
              mimeType: "multipart/form-data"
            };
            $cordovaFileTransfer.upload(url, targetPath, options).then(function(result) {
              var link = 'https://ec2.diwoapp.com.br/criarevento.php';
              $http.post(link, {nomeevento : $scope.evento.nomeevento, 
                                        duracao : $scope.evento.duracao,
                                        diainicio : $scope.evento.diainicio,
                                        semana : $scope.evento.semana,
                                        diafim : $scope.evento.diafim,
                                        dialimiteconfirmacao: $scope.evento.dialimiteconfirmacao,
                                        pmin : $scope.evento.pmin, 
                                        patual : 1, 
                                        pmax : $scope.evento.pmax,
                                        adm : $scope.user.iduser,
                                        admusername : $scope.user.username,
                                        admapelido : $scope.user.apelido,
                                        preco : $scope.evento.preco,
                                        precopor : $scope.evento.precopor,  
                                        nomelocal : $scope.evento.nomelocal,
                                        endereco : $scope.evento.endereco,
                                        cidade : $scope.evento.cidade,
                                        lat : $scope.evento.lat,
                                        lng : $scope.evento.lng,
                                        genero : $scope.evento.genero,
                                        eventopic : $scope.evento.eventopic,
                                        descricao : $scope.evento.descricao,
                                        comerciodevicetoken : $scope.user.devicetoken}).then(function (res){
                          $scope.responsecriado = res.data;
                  console.log(res.data.success, "criou");
                  if ($scope.responsecriado.success == true) {
                          // CRIO TAG
                    var res = $scope.evento.tags.split(" ") ;
                    for (var i = 0; i<res.length;i++){
                      if(res[i][0]!='#'){
                        res[i]= '#' + res[i];
                      }
                      console.log(res[i], "tags")
                      var link = 'https://ec2.diwoapp.com.br/criartag.php';
                        $http.post(link, {idevento : $scope.responsecriado.last, 
                                          tag : res[i]}).then(function (res){console.log(res.success, "criou tag")});
                    }
                    var link = 'https://ec2.diwoapp.com.br/irevento.php';
                    $http.post(link, {idevento : $scope.responsecriado.last, 
                                      iduser : $scope.user.iduser,
                                      idadm : $scope.user.iduser,
                                      admusername : $scope.user.username,  
                                      diainicio : $scope.evento.diainicio,
                                      diafim : $scope.evento.diafim,
                                      username : $scope.user.username,
                                      borda : $scope.user.borda,
                                      apelido : $scope.user.apelido,
                                      profilepic : $scope.user.profilepic,
                                      devicetoken : $scope.user.devicetoken,
                                      confirmacao : $scope.confirmacao,
                                      nomeevento :  $scope.evento.nomeevento,
                                      idComercioParceiro : $scope.evento.idComercioParceiro, 
                                      eventopic : $scope.evento.eventopic, 
                                      estado : $scope.estado}).then(function (res){
                    $scope.response = res.data;
                          $http.post('https://ec2.diwoapp.com.br/pessoanaoevento.php', {iduser : $scope.user.iduser, 
                                                                                idevento : $scope.responsecriado.last,
                                                                                nomeevento : $scope.evento.nomeevento,
                                                                                estado : '10'});
                          $http.post("https://ec2.diwoapp.com.br/getavisafollow.php", {iduser : $scope.user.iduser}).then(function(response) {
                            console.log(response.data[0])
                            if(response.data[0] != 'E'){
                              $scope.auxresp = response.data[0]; 
                              for(var  i = 0 ; i<response.data[0].length;i++){
                                $scope.pushnoti.titulo =$scope.user.apelido + " criou um evento novo!!";
                                $scope.pushnoti.msg = $scope.evento.nomeevento  + " acontecerá na " +$scope.evento.semana +" dia "+$scope.evento.diainicio[8]+$scope.evento.diainicio[9]+'/'+$scope.evento.diainicio[5]+$scope.evento.diainicio[6]  + " fique de ligado 👻";
                                $scope.pushnoti.token = $scope.auxresp[i].devicetoken;
                                EventoService.MandaPushNoti($scope.pushnoti);
                              }
                             }
                          });
                          $http.post("https://ec2.diwoapp.com.br/getavisareventoscriados.php", {iduser : $scope.user.iduser}).then(function(response) {
                            console.log(response.data[0])
                            if(response.data[0] != 'E'){
                              $scope.auxresp = response.data[0]; 
                              for(var  i = 0 ; i<response.data[0].length;i++){
                                $scope.pushnoti.titulo = "Eeeii pssssiu!!";
                                $scope.pushnoti.msg =  "Um novo evento foi criado perto de vc, bora dar uma checada?👀";
                                $scope.pushnoti.token = $scope.auxresp[i].devicetoken;
                                EventoService.MandaPushNoti($scope.pushnoti);
                              }
                             }
                          });
                          
                      if ($scope.response.success == true) {
                         deu = true;
                         // if($scope.imgURI == "img/ev.png"){
                          $ionicLoading.hide();
                           var alertPopup = $ionicPopup.alert({
                            title: 'Parabéns',
                            template: $scope.responsecriado.msg
                          }); 
                          alertPopup.then(function(){
                            $ionicLoading.hide();
                            formtelaCriar.updateForm(1);
                            formtela2.updateForm(1);
                            delete $scope.evento 
                            $state.go('tabsController.home');
                         })
                         // }
                      }else{
                          var alertPopup = $ionicPopup.alert({
                            title: 'Ocorreu uma falha',
                            template: $scope.responsecriado.msg
                          });
                          alertPopup.then(function(){
                            $ionicLoading.hide();
                            $scope.evento = {};
                            formEventoCriar.updateForm($scope.evento);
                            $state.go('tabsController.home');
                         })
                      }
                    }) 
                  }

              }, function(err) {
                $ionicPopup.alert({
                  title: 'Sorry!',
                  template: 'Aconteceu um probleminha, tente de novo'
                });
                $ionicLoading.hide();
              }, function (progress) {
                $ionicLoading.show({
                  title: '┗(＾0＾)┓',
                  template: 'DANCE, DANCE, DANCE!!'
                });
              });


            });
          }else{
            var link = 'https://ec2.diwoapp.com.br/criarevento.php';
              $http.post(link, {nomeevento : $scope.evento.nomeevento, 
                                        duracao : $scope.evento.duracao,
                                        diainicio : $scope.evento.diainicio,
                                        semana : $scope.evento.semana,
                                        diafim : $scope.evento.diafim,
                                        dialimiteconfirmacao: $scope.evento.dialimiteconfirmacao,
                                        pmin : $scope.evento.pmin, 
                                        patual : 1, 
                                        pmax : $scope.evento.pmax,
                                        adm : $scope.user.iduser,
                                        admusername : $scope.user.username,
                                        admapelido : $scope.user.apelido,
                                        preco : $scope.evento.preco,
                                        precopor : $scope.evento.precopor,  
                                        nomelocal : $scope.evento.nomelocal,
                                        endereco : $scope.evento.endereco,
                                        cidade : $scope.evento.cidade,
                                        lat : $scope.evento.lat,
                                        lng : $scope.evento.lng,
                                        genero : $scope.evento.genero,
                                        eventopic : $scope.evento.eventopic,
                                        descricao : $scope.evento.descricao,
                                        comerciodevicetoken : $scope.user.devicetoken}).then(function (res){
                          $scope.responsecriado = res.data;
                  console.log(res.data.success, "criou");
                  if ($scope.responsecriado.success == true) {
                          // CRIO TAG
                    var res = $scope.evento.tags.split(" ") ;
                    for (var i = 0; i<res.length;i++){
                      if(res[i][0]!='#'){
                        res[i]= '#' + res[i];
                      }
                      console.log(res[i], "tags")
                      var link = 'https://ec2.diwoapp.com.br/criartag.php';
                        $http.post(link, {idevento : $scope.responsecriado.last, 
                                          tag : res[i]}).then(function (res){console.log(res.success, "criou tag")});
                    }
                    var link = 'https://ec2.diwoapp.com.br/irevento.php';
                    $http.post(link, {idevento : $scope.responsecriado.last, 
                                      iduser : $scope.user.iduser,
                                      idadm : $scope.user.iduser,
                                      admusername : $scope.user.username,  
                                      diainicio : $scope.evento.diainicio,
                                      diafim : $scope.evento.diafim,
                                      username : $scope.user.username,
                                      borda : $scope.user.borda,
                                      apelido : $scope.user.apelido,
                                      profilepic : $scope.user.profilepic,
                                      devicetoken : $scope.user.devicetoken,
                                      confirmacao : $scope.confirmacao,
                                      nomeevento :  $scope.evento.nomeevento,
                                      idComercioParceiro : $scope.evento.idComercioParceiro, 
                                      eventopic : $scope.evento.eventopic, 
                                      estado : $scope.estado}).then(function (res){
                    $scope.response = res.data;
                          $http.post('https://ec2.diwoapp.com.br/pessoanaoevento.php', {iduser : $scope.user.iduser, 
                                                                                idevento : $scope.responsecriado.last,
                                                                                nomeevento : $scope.evento.nomeevento,
                                                                                estado : '10'});
                          $http.post("https://ec2.diwoapp.com.br/getavisafollow.php", {iduser : $scope.user.iduser}).then(function(response) {
                            console.log(response.data[0])
                            if(response.data[0] != 'E'){
                              $scope.auxresp = response.data[0]; 
                              for(var  i = 0 ; i<response.data[0].length;i++){
                                $scope.pushnoti.titulo =$scope.user.apelido + " criou um evento novo!!";
                                $scope.pushnoti.msg = $scope.evento.nomeevento  + " acontecerá na " +$scope.evento.semana +" dia "+$scope.evento.diainicio[8]+$scope.evento.diainicio[9]+'/'+$scope.evento.diainicio[5]+$scope.evento.diainicio[6]  + " fique de ligado 👻";
                                $scope.pushnoti.token = $scope.auxresp[i].devicetoken;
                                EventoService.MandaPushNoti($scope.pushnoti);
                              }
                             }
                          });
                          $http.post("https://ec2.diwoapp.com.br/getavisareventoscriados.php", {iduser : $scope.user.iduser}).then(function(response) {
                            console.log(response.data[0])
                            if(response.data[0] != 'E'){
                              $scope.auxresp = response.data[0]; 
                              for(var  i = 0 ; i<response.data[0].length;i++){
                                $scope.pushnoti.titulo = "Eeeii pssssiu!!";
                                $scope.pushnoti.msg =  "Um novo evento foi criado perto de vc, bora dar uma checada?👀";
                                $scope.pushnoti.token = $scope.auxresp[i].devicetoken;
                                EventoService.MandaPushNoti($scope.pushnoti);
                              }
                             }
                          });
                          
                      if ($scope.response.success == true) {
                         deu = true;
                         // if($scope.imgURI == "img/ev.png"){
                          $ionicLoading.hide();
                           var alertPopup = $ionicPopup.alert({
                            title: 'Parabéns',
                            template: $scope.responsecriado.msg
                          }); 
                          alertPopup.then(function(){
                            $ionicLoading.hide();
                            formtelaCriar.updateForm(1);
                            formtela2.updateForm(1);
                            delete $scope.evento 
                            $state.go('tabsController.home');
                         })
                         // }
                      }else{
                          var alertPopup = $ionicPopup.alert({
                            title: 'Ocorreu uma falha',
                            template: $scope.responsecriado.msg
                          });
                          alertPopup.then(function(){
                            $ionicLoading.hide();
                            $scope.evento = {};
                            formEventoCriar.updateForm($scope.evento);
                            $state.go('tabsController.home');
                         })
                      }
                    }) 
                  }

              }, function(err) {
                $ionicPopup.alert({
                  title: 'Sorry!',
                  template: 'Aconteceu um probleminha, tente de novo'
                });
                $ionicLoading.hide();
              }, function (progress) {
                $ionicLoading.show({
                  title: '┗(＾0＾)┓',
                  template: 'DANCE, DANCE, DANCE!!'
                });
              });
          }
        }
          
    }

}])


.controller('EditaEEAPart1Ctrl', ['$scope', '$stateParams', 'formEvento', '$state','$ionicPopup', '$timeout', 'formtela2', 'formItem', 'EventoService', 'formUser', 'formEventoEditahome','$http', '$cordovaCamera', '$cordovaFile', '$cordovaFileTransfer', '$cordovaDevice',  '$ionicLoading', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, formEvento, $state, $ionicPopup, $timeout, formtela2, formItem, EventoService, formUser, formEventoEditahome, $http, $cordovaCamera, $cordovaFile, $cordovaFileTransfer, $cordovaDevice,  $ionicLoading) {
  $scope.evento = {};
  $scope.evento = formEventoEditahome.getForm();

  $scope.user = formUser.getForm();

  var noti = {};
  $scope.pushnoti = {};
   $scope.auxfoto = '';
  $scope.limiteconfirmacao ={};
  $scope.fim = {};
  $scope.inicio = {};
  var mudoufoto = false;
  var auxdiainicio = $scope.evento.diainicio;

  $scope.evento.dateconfirma = $scope.evento.dialimiteconfirmacao.toLocaleString();
  $scope.evento.dateinicio = $scope.evento.diainicio;
  $scope.evento.datefim = $scope.evento.diafim;
  
  var currentdate = new Date(); 
  var curr_date = (currentdate.getDate()<10?'0':'') + currentdate.getDate();
  var curr_month = (currentdate.getMonth()<9?'0':'') + (currentdate.getMonth() + 1); //Months are zero based
  var curr_year = currentdate.getFullYear();
  var curr_h = (currentdate.getHours()<10?'0':'') + currentdate.getHours();
  var curr_m = (currentdate.getMinutes()<10?'0':'') + currentdate.getMinutes();
  var curr_j = curr_year + "-" + curr_month + "-" + curr_date+ ' '+curr_h + ':' + curr_m + ':' + '00';
  
  EventoService.verificahorariopessoaevento($scope.user).then(function(items) {
    if (items!="Error") {
      $scope.auxdata = items;
    }
  });
  if(!$scope.evento.eventopic){
    $scope.imgURI ="img/ev.png"; 
    document.getElementById("imageidEventoEEA").src="img/ev.png";
  }else{
    $scope.imgURI =$scope.evento.eventopic;
    document.getElementById("imageidEventoEEA").src=$scope.evento.eventopic;
  }
  
  $scope.mudafotoevento = function (optionsCamera) {
    var optionsCamera = {
          quality : 100,
          sourceType : 0,
          allowEdit : true,
          targetWidth: 640,
          targetHeight: 640
    };
    $cordovaCamera.getPicture(optionsCamera).then(function(imageData) {
      $scope.imgURI = imageData;
      mudoufoto = true;
      document.getElementById("imageidEventoEEA").src=imageData;
    }, function(err) {
      console.log(err);
    });
    
  }

  $scope.mudaconfirma = function(){
    novaconfirma_date = ($scope.evento.dateconfirma.getDate()<10?'0':'') + $scope.evento.dateconfirma.getDate();
    novaconfirma_month = ($scope.evento.dateconfirma.getMonth()<9?'0':'') + ($scope.evento.dateconfirma.getMonth() + 1); //Months are zero based
    novaconfirma_year = $scope.evento.dateconfirma.getFullYear();
    novaconfirma_h = ($scope.evento.dateconfirma.getHours()<10?'0':'') + $scope.evento.dateconfirma.getHours();
    novaconfirma_m = ($scope.evento.dateconfirma.getMinutes()<10?'0':'') + $scope.evento.dateconfirma.getMinutes();
    novaconfirma_s = ($scope.evento.dateconfirma.getSeconds()<10?'0':'') + $scope.evento.dateconfirma.getSeconds();
    var novaconfirmaj = novaconfirma_year + "-" + novaconfirma_month + "-" + novaconfirma_date+ ' '+novaconfirma_h + ':' + novaconfirma_m + ':' + novaconfirma_s;
    

    if(curr_j>novaconfirmaj){
      var alertPopup = $ionicPopup.alert({
                  title: '(*ﾉ´□`)ﾉ~',
                  template: 'Muito em cima da hora para mudar pra ontem'
                });
      
    }else{
      if(novaconfirmaj>$scope.evento.diainicio){
        var alertPopup = $ionicPopup.alert({
                  title: 'ヽ ( ꒪д꒪ )ﾉ',
                  template: 'Evento nao pode começar depois da data limite de confirmação'
                });
      }else{
        $scope.limiteconfirmacao.dia =  novaconfirma_date +'/'+ novaconfirma_month;
        $scope.limiteconfirmacao.hora =  novaconfirma_h+':'+novaconfirma_m;  
        $scope.evento.dialimiteconfirmacao = novaconfirmaj;
        $scope.evento.dateconfirma = $scope.evento.dateconfirma.toLocaleString();
      }
    }
  }
  
  $scope.mudainicio = function(){
    var datainvalida = 0;
    
    novadateinicio_date = ($scope.evento.dateinicio.getDate()<10?'0':'') + $scope.evento.dateinicio.getDate();
    novadateinicio_month = ($scope.evento.dateinicio.getMonth()<9?'0':'') + ($scope.evento.dateinicio.getMonth() + 1); //Months are zero based
    novadateinicio_year = $scope.evento.dateinicio.getFullYear();
    novadateinicio_h = ($scope.evento.dateinicio.getHours()<10?'0':'') + $scope.evento.dateinicio.getHours();
    novadateinicio_m = ($scope.evento.dateinicio.getMinutes()<10?'0':'') + $scope.evento.dateinicio.getMinutes();
    novadateinicio_s = ($scope.evento.dateinicio.getSeconds()<10?'0':'') + $scope.evento.dateinicio.getSeconds();
    $scope.evento.semana = $scope.evento.dateinicio.getDay();
    var novadateinicioj = novadateinicio_year + "-" + novadateinicio_month + "-" + novadateinicio_date+ ' '+novadateinicio_h + ':' + novadateinicio_m + ':' + novadateinicio_s;
    
    if(curr_j>novadateinicioj){
      var alertPopup = $ionicPopup.alert({
                  title: '(*ﾉ´□`)ﾉ~',
                  template: 'Muito em cima da hora para mudar pra ontem'
                });
      
    }else{
      if($scope.evento.dialimiteconfirmacao>novadateinicioj){
        var alertPopup = $ionicPopup.alert({
                    title: '(*ﾉ´□`)ﾉ~',
                    template: 'Data de inicio não pode ser antes que a data limite de confirmação'
                  });
        
      }else{
        for(var r = 0;r<$scope.auxdata.length; r++){
          //console.log($scope.auxdata[r].idevento, $scope.auxdata[r].diainicio, $scope.auxdata[r].diafim , we ,$scope.evento.diafim);
          if($scope.evento.idevento!=$scope.auxdata[r].idevento){
            if (($scope.auxdata[r].diainicio <= novadateinicioj && $scope.auxdata[r].diafim >= novadateinicioj)  ) {
              datainvalida = 1;
            }
          }
        }
        if(r==$scope.auxdata.length && datainvalida == 1){
          var alertPopup = $ionicPopup.alert({
            title: 'Oww!!',
            template: 'Tu ja tem um evento marcado nesse horário :/'
          });
        }
        if(novadateinicioj>$scope.evento.datefim){
          console.log("to aquiwenqieni")
          $scope.fim.dia =  '??'+'/'+'??';
          $scope.fim.hora = '??'+':'+'??';
        }
        if(r==$scope.auxdata.length && datainvalida == 0){
          if($scope.evento.semana == 0){
            $scope.evento.semana = "Domingo";
          }
          if($scope.evento.semana == 1){
            $scope.evento.semana = "Segunda-feira";
          }
          if($scope.evento.semana == 2){
            $scope.evento.semana = "Terça-feira";
          }
          if($scope.evento.semana == 3){
            $scope.evento.semana = "Quarta-feira";
          }
          if($scope.evento.semana == 4){
            $scope.evento.semana = "Quinta-feira";
          }
          if($scope.evento.semana == 5){
            $scope.evento.semana = "Sexta-feira";
          }
          if($scope.evento.semana == 6){
            $scope.evento.semana = "Sábado";
          }
          $scope.inicio.dia =  novadateinicio_date +'/'+ novadateinicio_month;
          $scope.inicio.hora =  novadateinicio_h+':'+novadateinicio_m;  
          $scope.evento.diainicio = novadateinicioj;
          $scope.evento.dateinicio = $scope.evento.dateinicio.toLocaleString();
        }
      }
    }
  }

  $scope.mudafim = function(){
    var datainvalida = 0;
    
    novadatefim_date = ($scope.evento.datefim.getDate()<10?'0':'') + $scope.evento.datefim.getDate();
    novadatefim_month = ($scope.evento.datefim.getMonth()<9?'0':'') + ($scope.evento.datefim.getMonth() + 1); //Months are zero based
    novadatefim_year = $scope.evento.datefim.getFullYear();
    novadatefim_h = ($scope.evento.datefim.getHours()<10?'0':'') + $scope.evento.datefim.getHours();
    novadatefim_m = ($scope.evento.datefim.getMinutes()<10?'0':'') + $scope.evento.datefim.getMinutes();
    novadatefim_s = ($scope.evento.datefim.getSeconds()<10?'0':'') + $scope.evento.datefim.getSeconds();
    var novadatedatefimj = novadatefim_year + "-" + novadatefim_month + "-" + novadatefim_date+ ' '+novadatefim_h + ':' + novadatefim_m + ':' + novadatefim_s;
    
    if(curr_j>novadatedatefimj){
      var alertPopup = $ionicPopup.alert({
                  title: '(*ﾉ´□`)ﾉ~',
                  template: 'Muito em cima da hora para mudar pra ontem'
                });
      
    }else{
      if($scope.evento.dialimiteconfirmacao>novadatedatefimj){
        var alertPopup = $ionicPopup.alert({
                    title: '(*ﾉ´□`)ﾉ~',
                    template: 'Data de fim não pode ser antes que a data limite de confirmação'
                  });
        
      }else{
        if($scope.evento.diainicio>=novadatedatefimj){
        var alertPopup = $ionicPopup.alert({
                    title: '(*ﾉ´□`)ﾉ~',
                    template: 'Data de fim não pode ser antes que a data de início'
                  });
        }else{
          for(var r = 0;r<$scope.auxdata.length; r++){
            if($scope.evento.idevento!=$scope.auxdata[r].idevento){
              if (($scope.auxdata[r].diainicio <= novadatedatefimj && $scope.auxdata[r].diafim >= novadatedatefimj)  ) {
                datainvalida = 1;
              }
            }
          }
          if(r==$scope.auxdata.length && datainvalida == 1){
            var alertPopup = $ionicPopup.alert({
              title: 'Oww!!',
              template: 'Tu ja tem um evento marcado nesse horário :/'
            });
          }
          if(r==$scope.auxdata.length && datainvalida == 0){
            $scope.fim.dia =  novadatefim_date +'/'+ novadatefim_month;
            $scope.fim.hora =  novadatefim_h+':'+novadatefim_m;  
            $scope.evento.diafim = novadatedatefimj;
            $scope.evento.datefim = $scope.evento.datefim.toLocaleString();
          }
        }
      }
    }
  }
  
  var hjf = $scope.evento.diafim;
  $scope.fim.dia =  (hjf[8]+hjf[9]).valueOf()+'/'+(hjf[5]+hjf[6]).valueOf();
  $scope.fim.hora = (hjf[11]+hjf[12]).valueOf()+':'+(hjf[14]+hjf[15]).valueOf();
  
  var hj = $scope.evento.diainicio;
  $scope.inicio.dia = (hj[8]+hj[9]).valueOf()+'/'+(hj[5]+hj[6]).valueOf();
  $scope.inicio.hora = (hj[11]+hj[12]).valueOf()+':'+(hj[14]+hj[15]).valueOf();


  var  hjl = $scope.evento.dialimiteconfirmacao;
  $scope.limiteconfirmacao.dia =  (hjl[8]+hjl[9]).valueOf()+'/'+(hjl[5]+hjl[6]).valueOf();
  $scope.limiteconfirmacao.hora =  (hjl[11]+hjl[12]).valueOf()+':'+(hjl[14]+hjl[15]).valueOf();  
  
    $scope.evento.auxtag1 = '';
    $scope.evento.auxtag2 = '';
    $scope.evento.auxtag3 = '';
    $scope.evento.auxtagbutton1 = false;
    $scope.evento.auxtagbutton2 = false;
    $scope.evento.auxtagbutton3 = false;
    $scope.evento.auxtag4 = '';
    $scope.evento.auxtag5 = '';
    $scope.evento.auxtag6 = '';
    $scope.evento.auxtagbutton4 = false;
    $scope.evento.auxtagbutton5 = false;
    $scope.evento.auxtagbutton6 = false;
    $scope.evento.auxtag7 = '';
    $scope.evento.auxtag8 = '';
    $scope.evento.auxtag9 = '';
    $scope.evento.auxtagbutton7 = false;
    $scope.evento.auxtagbutton8 = false;
    $scope.evento.auxtagbutton9 = false;


    $scope.auxtags = {};
    EventoService.Gettags($scope.evento.idevento).then(function(tags) {
      var auxauxtagbut = true;
      $scope.auxtags = tags;
      for(var  i =0; i< tags.length;i++){
         if($scope.evento.auxtagbutton1 == false && auxauxtagbut){
            $scope.evento.auxtag1 = tags[i].tag;
            $scope.evento.auxtagbutton1 = true;
            auxauxtagbut = false;
          }
          if($scope.evento.auxtagbutton2 == false && auxauxtagbut){
            console.log($scope.evento.auxtagbutton2)
            $scope.evento.auxtag2 = tags[i].tag;
            $scope.evento.auxtagbutton2 = true;
            auxauxtagbut = false;
          }
          if($scope.evento.auxtagbutton3 == false && auxauxtagbut){
            $scope.evento.auxtag3 = tags[i].tag;
            $scope.evento.auxtagbutton3 = true;
            auxauxtagbut = false;
          }
          if($scope.evento.auxtagbutton4 == false && auxauxtagbut){
            $scope.evento.auxtag4 = tags[i].tag;
            $scope.evento.auxtagbutton4 = true;
            auxauxtagbut = false;
          }
          if($scope.evento.auxtagbutton5 == false && auxauxtagbut){
            $scope.evento.auxtag5 = tags[i].tag;
            $scope.evento.auxtagbutton5 = true;
            auxauxtagbut = false;
          }
          if($scope.evento.auxtagbutton6 == false && auxauxtagbut){
            $scope.evento.auxtag6 = tags[i].tag;
            $scope.evento.auxtagbutton6 = true;
            auxauxtagbut = false;
          }
          if($scope.evento.auxtagbutton7 == false && auxauxtagbut){
            $scope.evento.auxtag7 = tags[i].tag;
            $scope.evento.auxtagbutton7 = true;
            auxauxtagbut = false;
          }
          if($scope.evento.auxtagbutton8 == false && auxauxtagbut){
            $scope.evento.auxtag8 = tags[i].tag;
            $scope.evento.auxtagbutton8 = true;
            auxauxtagbut = false;
          }
          if($scope.evento.auxtagbutton9 == false && auxauxtagbut){
            $scope.evento.auxtag9 = tags[i].tag;
            $scope.evento.auxtagbutton9 = true;
            auxauxtagbut = false;
          }
          auxauxtagbut = true;
      } 
    });

    var auxauxtagbut = false;
    $scope.adicionatag = function(){
      if($scope.evento.addtag!=''){
        var res2 = $scope.evento.addtag.split(" ") ;
          if(res2.length>1){
            for(var w = 0; w < res2.length; w++){
              var t = res2[w].toLowerCase();
             console.log(t)
            }
            $scope.evento.addtag = res2[0];
          }
        if(!auxauxtagbut){
          auxauxtagbut = true;
          if($scope.evento.auxtagbutton1 == false && auxauxtagbut){
            $scope.evento.auxtag1 = '#' +$scope.evento.addtag;
            $scope.evento.auxtagbutton1 = true;
            auxauxtagbut = false;
          }
          if($scope.evento.auxtagbutton2 == false && auxauxtagbut){
            $scope.evento.auxtag2 = '#' +$scope.evento.addtag;
            $scope.evento.auxtagbutton2 = true;
            auxauxtagbut = false;
          }
          if($scope.evento.auxtagbutton3 == false && auxauxtagbut){
            $scope.evento.auxtag3 = '#' +$scope.evento.addtag;
            $scope.evento.auxtagbutton3 = true;
            auxauxtagbut = false;
          }
          if($scope.evento.auxtagbutton4 == false && auxauxtagbut){
            $scope.evento.auxtag4 = '#' +$scope.evento.addtag;
            $scope.evento.auxtagbutton4 = true;
            auxauxtagbut = false;
          }
          if($scope.evento.auxtagbutton5 == false && auxauxtagbut){
            $scope.evento.auxtag5 = '#' +$scope.evento.addtag;
            $scope.evento.auxtagbutton5 = true;
            auxauxtagbut = false;
          }
          if($scope.evento.auxtagbutton6 == false && auxauxtagbut){
            $scope.evento.auxtag6 = '#' +$scope.evento.addtag;
            $scope.evento.auxtagbutton6 = true;
            auxauxtagbut = false;
          }
          if($scope.evento.auxtagbutton7 == false && auxauxtagbut){
            $scope.evento.auxtag7 = '#' +$scope.evento.addtag;
            $scope.evento.auxtagbutton7 = true;
            auxauxtagbut = false;
          }
          if($scope.evento.auxtagbutton8 == false && auxauxtagbut){
            $scope.evento.auxtag8 = '#' +$scope.evento.addtag;
            $scope.evento.auxtagbutton8 = true;
            auxauxtagbut = false;
          }
          if($scope.evento.auxtagbutton9 == false && auxauxtagbut){
            $scope.evento.auxtag9 = '#' +$scope.evento.addtag;
            $scope.evento.auxtagbutton9 = true;
            auxauxtagbut = false;
          }
        }
      }
      $scope.evento.addtag = '';
    }

    $scope.tiratag1 = function(){
        $scope.evento.auxtagbutton1 = false;
        $scope.evento.auxtag1 = '';
    }
    $scope.tiratag2 = function(){
        $scope.evento.auxtagbutton2 = false;
        $scope.evento.auxtag2 = '';
    }
    $scope.tiratag3 = function(){
        $scope.evento.auxtagbutton3 = false;
        $scope.evento.auxtag3 = '';
    }
    $scope.tiratag4 = function(){
        $scope.evento.auxtagbutton4 = false;
        $scope.evento.auxtag4 = '';
    }
    $scope.tiratag5 = function(){
        $scope.evento.auxtagbutton5 = false;
        $scope.evento.auxtag5 = '';
    }
    $scope.tiratag6 = function(){
        $scope.evento.auxtagbutton6 = false;
        $scope.evento.auxtag6 = '';
    }
    $scope.tiratag7 = function(){
        $scope.evento.auxtagbutton7 = false;
        $scope.evento.auxtag7 = '';
    }
    $scope.tiratag8 = function(){
        $scope.evento.auxtagbutton8 = false;
        $scope.evento.auxtag8 = '';
    }
    $scope.tiratag9 = function(){
        $scope.evento.auxtagbutton9 = false;
        $scope.evento.auxtag9 = '';
    }

    $scope.mudaloc = function(){
      formEventoEditahome.updateForm($scope.evento);
      $state.go('tabsController.EditaEEAPart2')
    }

    $scope.mudamais = function(){
      formEventoEditahome.updateForm($scope.evento);
      $state.go('tabsController.EditaEEAPart3')
    }

    $scope.teste = function(evento){
      console.log(evento.diafim)
    }

    $scope.salvar = function(evento){
      if ($scope.evento.nomeevento == '') {
        var alertPopup = $ionicPopup.alert({
          title: 'ʕ•ᴥ•ʔ',
          template: 'Coloque um titulo válido'
        });
      }else{
        if($scope.evento.diafim <$scope.evento.diainicio){
          var alertPopup = $ionicPopup.alert({
            title: 'ʕ•ᴥ•ʔ',
            template: 'Data de termino eh antes do dia de inicio!! Assim não da'
          });
        }else{
          var existe = 0;
          var link = 'https://ec2.diwoapp.com.br/deletatag.php';
          $http.post(link, {idevento : $scope.evento.idevento}).then(function(items) {
            if($scope.evento.auxtagbutton1 == true){
              existe = 0;
              var link = 'https://ec2.diwoapp.com.br/criartag.php';
              $http.post(link, {idevento : $scope.evento.idevento, 
                                      tag : $scope.evento.auxtag1});
            }
            if($scope.evento.auxtagbutton2 == true){
              existe = 0;
              var link = 'https://ec2.diwoapp.com.br/criartag.php';
              $http.post(link, {idevento : $scope.evento.idevento, 
                                      tag : $scope.evento.auxtag2});
            }
            if($scope.evento.auxtagbutton3 == true){
              existe = 0;
              var link = 'https://ec2.diwoapp.com.br/criartag.php';
              $http.post(link, {idevento : $scope.evento.idevento, 
                                      tag : $scope.evento.auxtag3});
            }
            if($scope.evento.auxtagbutton4 == true){
              existe = 0;
              var link = 'https://ec2.diwoapp.com.br/criartag.php';
              $http.post(link, {idevento : $scope.evento.idevento, 
                                      tag : $scope.evento.auxtag4});
            }
            if($scope.evento.auxtagbutton5 == true){
              existe = 0;
              var link = 'https://ec2.diwoapp.com.br/criartag.php';
              $http.post(link, {idevento : $scope.evento.idevento, 
                                      tag : $scope.evento.auxtag5});
            }
            if($scope.evento.auxtagbutton6 == true){
              existe = 0;
              var link = 'https://ec2.diwoapp.com.br/criartag.php';
              $http.post(link, {idevento : $scope.evento.idevento, 
                                      tag : $scope.evento.auxtag6});
            }
            if($scope.evento.auxtagbutton7 == true){
              existe = 0;
              var link = 'https://ec2.diwoapp.com.br/criartag.php';
              $http.post(link, {idevento : $scope.evento.idevento, 
                                      tag : $scope.evento.auxtag7});
            }
            if($scope.evento.auxtagbutton8 == true){
              existe = 0;
              var link = 'https://ec2.diwoapp.com.br/criartag.php';
              $http.post(link, {idevento : $scope.evento.idevento, 
                                      tag : $scope.evento.auxtag8});
            }
            if($scope.evento.auxtagbutton9 == true){
              existe = 0;
              var link = 'https://ec2.diwoapp.com.br/criartag.php';
              $http.post(link, {idevento : $scope.evento.idevento, 
                                      tag : $scope.evento.auxtag9});
            }
          });

          console.log($scope.imgURI, mudoufoto)
          
            if(mudoufoto == true){
              if($scope.imgURI != "img/ev.png"){ 
                $scope.auxfoto = $scope.evento.nomeevento + $scope.evento.diainicio;
                var mystring = String($scope.auxfoto);
                mystring = mystring.replace(/[^a-zA-Z0-9]/g, '');
                $scope.evento.eventopic = 'https://s3.amazonaws.com/diwoappprofilepics/eventopicsdiwo/' + mystring + '.jpg';
              }else{
                $scope.evento.eventopic = "img/ev.png";
              }
              var url = "https://ec2.diwoapp.com.br/uploadfotoevento.php";
                                      // File for Upload
              var targetPath = $scope.imgURI;
             
              // File name only
              //var name = $scope.imgURI.substr(imageData.lastIndexOf('/') + 1);
              var filename = mystring + '.jpg';
              // NO CASO SERIA O NOME DO USUARIO.jpg O fileName
              var options = {
                fileKey: "file",
                fileName: filename,
                chunkedMode: false,
                mimeType: "multipart/form-data"
              };
              $cordovaFileTransfer.upload(url, targetPath, options).then(function(result) {
                $scope.evento.datamodificacao = new Date();
                EventoService.atualizarevento($scope.evento).then(function(msg){
                var alertPopup = $ionicPopup.alert({
                          title: 'ʕ•ᴥ•ʔ',
                          template: msg
                  });
                $ionicLoading.hide();
                alertPopup.then(function(){
                  EventoService.GetParticipantes($scope.evento.idevento).then(function(items) {
                    $scope.msgnoti = 'O evento: '+$scope.evento.nomeevento +' foi mudado'
                    for (var i = 0; i < items.length; i++) {
                      if ($scope.user.iduser != items[i].iduser) {
                        noti.recebeusername = items[i].username;
                        noti.recebe = items[i].iduser;
                        noti.envia = $scope.user.iduser;
                        noti.tipo = 4;
                        noti.nomeevento = $scope.evento.nomeevento;
                        EventoService.VerificaNotificacao(noti).then(function(res) {
                          console.log(res);
                          if(res){
                            $http.post('https://ec2.diwoapp.com.br/notificapessoa.php', {notificacao : $scope.msgnoti, 
                                  idevento : $scope.evento.idevento,
                                  nomeevento : $scope.evento.nomeevento,
                                  id_user_envia : $scope.user.iduser,
                                  username_envia : $scope.user.username,
                                  apelido_envia : $scope.user.apelido,
                                  tipo : '4',    //update no evento
                                  id_user_recebe : noti.recebe}).then(function (res){
                                 $scope.response = res.data;
                                 console.log($scope.response.msg)
                            });
                            EventoService.getusuario2(noti.recebeusername).then(function(user) {
                              if(user.notiparticipando== '1'){
                              $scope.pushnoti.titulo =  'Mudanças!' ;
                              $scope.pushnoti.msg = $scope.msgnoti;
                              $scope.pushnoti.token = user.devicetoken;
                              EventoService.MandaPushNoti($scope.pushnoti);
                            }
                            });
                          }
                        });
                      }
                    }
                  })
                  formItem.updateForm($scope.evento);
                  $state.go('tabsController.eventoAberto');
                })
                }, function(errMsg) {
                  var alertPopup = $ionicPopup.alert({
                    title: 'Register failed!',
                    template: errMsg
                  });
                })

              }, function(err) {
                $ionicPopup.alert({
                  title: 'Sorry!',
                  template: 'Aconteceu um probleminha, tente de novo'
                });
                $ionicLoading.hide();
              }, function (progress) {
                $ionicLoading.show({
                  title: '┗(＾0＾)┓',
                  template: 'DANCE, DANCE, DANCE!!'
                });
              });
            }else{
              $scope.evento.datamodificacao = new Date();
               EventoService.atualizarevento($scope.evento).then(function(msg){
          var alertPopup = $ionicPopup.alert({
                  title: 'ʕ•ᴥ•ʔ',
                  template: msg
                });
          $ionicLoading.hide();
          alertPopup.then(function(){
            EventoService.GetParticipantes($scope.evento.idevento).then(function(items) {
              $scope.msgnoti = 'O evento: '+$scope.evento.nomeevento +' foi mudado'
              for (var i = 0; i < items.length; i++) {
                if ($scope.user.iduser != items[i].iduser) {
                  noti.recebeusername = items[i].username;
                  noti.recebe = items[i].iduser;
                  noti.envia = $scope.user.iduser;
                  noti.tipo = 4;
                  noti.nomeevento = $scope.evento.nomeevento;
                  EventoService.VerificaNotificacao(noti).then(function(res) {
                    console.log(res);
                    if(res){
                      $http.post('https://ec2.diwoapp.com.br/notificapessoa.php', {notificacao : $scope.msgnoti, 
                            idevento : $scope.evento.idevento,
                            nomeevento : $scope.evento.nomeevento,
                            id_user_envia : $scope.user.iduser,
                            username_envia : $scope.user.username,
                            apelido_envia : $scope.user.apelido,
                            tipo : '4',    //update no evento
                            id_user_recebe : noti.recebe}).then(function (res){
                           $scope.response = res.data;
                           console.log($scope.response.msg)
                      });
                      EventoService.getusuario2(noti.recebeusername).then(function(user) {
                        if(user.notiparticipando== '1'){
                        $scope.pushnoti.titulo =  'Mudanças!' ;
                        $scope.pushnoti.msg = $scope.msgnoti;
                        $scope.pushnoti.token = user.devicetoken;
                        EventoService.MandaPushNoti($scope.pushnoti);
                      }
                      });
                    }
                  });
                }
              }
            })
            formItem.updateForm($scope.evento);
            $state.go('tabsController.eventoAberto');
          })
          }, function(errMsg) {
            var alertPopup = $ionicPopup.alert({
              title: 'Register failed!',
              template: errMsg
            });
          })
            }
            
         
        }  
      }
    }
  

}])
     
.controller('EditaEEAPart2Ctrl', ['$scope', '$stateParams', '$cordovaGeolocation', '$state', '$ionicLoading', 'formEventoEditahome', 'formItem', '$ionicPopup',  // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, $cordovaGeolocation, $state, $ionicLoading, formEventoEditahome, formItem, $ionicPopup) {
  $scope.evento = {};
  $scope.evento = formEventoEditahome.getForm();
  $scope.centerPoint={};
  $scope.LimiteFuncionamentoDiwo = false;
  var lat;
  var long;
  var map;
  var myLatlng;
  var mapOptions;
  var marker;
  var geocoder;
  var infowindow;
  $scope.disableTap = function(){
     container = document.getElementsByClassName('pac-container');
     // disable ionic data tab
     angular.element(container).attr('data-tap-disabled', 'true');
     // leave input field if google-address-entry is selected
     angular.element(container).on("click", function(){
                                   document.getElementById('pac-input').blur();
                                   });
     };
    
    lat  = $scope.evento.lat;
    long = $scope.evento.lng;     
    myLatlng = new google.maps.LatLng(lat, long);
    mapOptions = {
          center: myLatlng,
          zoom: 16,
          mapTypeId: google.maps.MapTypeId.ROADMAP
      };          
             
       map = new google.maps.Map(document.getElementById("map_canvas"), mapOptions); 
       marker = new google.maps.Marker({
                position: new google.maps.LatLng(lat, long),
                map: map,
                title: "Borai",
                draggable: true,
                icon: 'http://maps.google.com/mapfiles/ms/icons/green-dot.png',
                animation: google.maps.Animation.DROP 
            })
       geocoder = new google.maps.Geocoder;
       infowindow = new google.maps.InfoWindow({maxWidth: 200});
        function arePointsNear(checkPoint, centerPoint, km) {
                  var ky = 40000 / 360;
                  var kx = Math.cos(Math.PI * centerPoint.lat / 180.0) * ky;
                  var dx = Math.abs(centerPoint.lng - $scope.evento.lng) * kx;
                  var dy = Math.abs(centerPoint.lat - $scope.evento.lat) * ky;
                  return Math.sqrt(dx * dx + dy * dy) <= km;
                } 
      geocoder.geocode({'location': myLatlng}, function(results, status) {
        if (status === 'OK') {
          if (results[1]) {
            $scope.evento.nomelocal = results[0].address_components[0].long_name;
            $scope.evento.endereco = results[0].formatted_address;
            for(var i = 0;i<results[0].address_components.length;i++){
              if(results[0].address_components[i].types[0] == "administrative_area_level_2"){
                $scope.evento.cidade = results[0].address_components[i].long_name;
                console.log($scope.evento.cidade)
              }
            }
            $scope.evento.lat = lat;
            $scope.evento.lng = long;
            $scope.centerPoint.lat = -26.997799;
            $scope.centerPoint.lng = -48.632733; 
            $scope.centerPointKM = 30;
            $scope.LimiteFuncionamentoDiwo = arePointsNear($scope.evento, $scope.centerPoint,$scope.centerPointKM );
            
            infowindow.setContent(results[0].formatted_address);
            infowindow.open(map, marker);
            setTimeout(function () { infowindow.close(); }, 5000);
          } else {
            window.alert('Resultado não encontrado');
          }
        } else {
          window.alert('Ocorreu uma falha doida :' + status);
        }
      });

  $scope.$on("$ionicView.enter", function(event, data){
    $scope.centerPoint={};
    $scope.LimiteFuncionamentoDiwo = false;
    $scope.evento = {};
    $scope.evento = formEventoEditahome.getForm();
    var posOptions = {
            enableHighAccuracy: true,
            timeout: 200000,
            maximumAge: 0
        };

    navigator.geolocation.getCurrentPosition(function(position){
          
            lat  = $scope.evento.lat;
            long = $scope.evento.lng;
             

            myLatlng = new google.maps.LatLng(lat, long);
             
            mapOptions = {
                center: myLatlng,
                zoom: 16,
                mapTypeId: google.maps.MapTypeId.ROADMAP
            };          
             
            map = new google.maps.Map(document.getElementById("map_canvas"), mapOptions); 


            marker = new google.maps.Marker({
                      position: new google.maps.LatLng(lat, long),
                      map: map,
                      title: "Borai",
                      draggable: true,
                      icon: 'http://maps.google.com/mapfiles/ms/icons/green-dot.png',
                      animation: google.maps.Animation.DROP 
                  })

            geocoder = new google.maps.Geocoder;
            infowindow = new google.maps.InfoWindow({
                                                              maxWidth: 200
                                                            });

            geocoder.geocode({'location': myLatlng}, function(results, status) {
                  if (status === 'OK') {
                    if (results[1]) {
                      $scope.evento.nomelocal = results[0].address_components[0].long_name;
                      $scope.evento.endereco = results[0].formatted_address;
                      for(var i = 0;i<results[0].address_components.length;i++){
                        if(results[0].address_components[i].types[0] == "administrative_area_level_2"){
                          $scope.evento.cidade = results[0].address_components[i].long_name;
                          console.log($scope.evento.cidade)
                        }
                      }
                      $scope.evento.lat = lat;
                      $scope.evento.lng = long;
                      $scope.centerPoint.lat = -26.997799;
                      $scope.centerPoint.lng = -48.632733; 
                      $scope.centerPointKM = 30;
                      $scope.LimiteFuncionamentoDiwo = arePointsNear($scope.evento, $scope.centerPoint,$scope.centerPointKM );
                      
                      // $scope.evento.lat = position.coords.latitude;
                      // $scope.evento.lng = position.coords.longitude;
                      infowindow.setContent(results[0].formatted_address);
                      console.log($scope.evento.endereco);
                      console.log($scope.evento.cidade);
                      console.log($scope.evento.lng);
                      console.log($scope.evento.lat);
                      //infowindow.setContent(results[0].address_components[2].long_name);
                      infowindow.open(map, marker);
                      setTimeout(function () { infowindow.close(); }, 5000);
                    } else {
                      window.alert('Resultado não encontrado');
          }
        } else {
          window.alert('Ocorreu uma falha doida :' + status);
                  }
                });


            google.maps.event.addListener(marker, "dragstart", function (event) {
               marker.setAnimation(3); // raise
            });

            google.maps.event.addListener(marker, "dragend", function (event) {
               marker.setAnimation(4); // raise
            });

            marker.addListener('dragend', handleEvent);
            google.maps.event.addListener(map, 'click', function(e) {
              
                markers.forEach(function(marker) {
                  marker.setMap(null);
                });
                markers = [];

                placeMarker(e.latLng, map, marker);

            });
             function arePointsNear(checkPoint, centerPoint, km) {
                  var ky = 40000 / 360;
                  var kx = Math.cos(Math.PI * centerPoint.lat / 180.0) * ky;
                  var dx = Math.abs(centerPoint.lng - $scope.evento.lng) * kx;
                  var dy = Math.abs(centerPoint.lat - $scope.evento.lat) * ky;
                  return Math.sqrt(dx * dx + dy * dy) <= km;
                } 

            function placeMarker(latlng, map, marker) {
                marker.setPosition(latlng);
                marker.setMap(map);
                map.panTo(latlng);
                $scope.evento.lat = latlng.lat();
                $scope.evento.lng = latlng.lng();
                $scope.centerPoint.lat = -26.997799;
                $scope.centerPoint.lng = -48.632733; 
                $scope.centerPointKM = 30;
                $scope.LimiteFuncionamentoDiwo = arePointsNear($scope.evento, $scope.centerPoint,$scope.centerPointKM );
                
                geocoder.geocode({'location': latlng}, function(results, status) {
                  if (status === 'OK') {
                    if (results[1]) {
                      $scope.evento.nomelocal = results[0].address_components[0].long_name;
                      for(var i = 0;i<results[0].address_components.length;i++){
                        if(results[0].address_components[i].types[0] == "administrative_area_level_2"){
                          $scope.evento.cidade = results[0].address_components[i].long_name;
                          console.log($scope.evento.cidade)
                        }
                      }
                      $scope.evento.endereco = results[0].formatted_address;
                      infowindow.setContent(results[0].formatted_address);
                     
                      infowindow.open(map, marker);
                      setTimeout(function () { infowindow.close(); }, 5000);
                    } else {
                      window.alert('Resultado não encontrado');
          }
        } else {
          window.alert('Ocorreu uma falha doida :' + status);
                  }
                });
            };        

            function handleEvent(event) {
                $scope.evento.lat = event.latLng.lat();
                $scope.evento.lng = event.latLng.lng();
                $scope.centerPoint.lat = -26.997799;
                $scope.centerPoint.lng = -48.632733; 
                $scope.centerPointKM = 30;
                $scope.LimiteFuncionamentoDiwo = arePointsNear($scope.evento, $scope.centerPoint,$scope.centerPointKM );
                
                              // GEOCODER INVERSO

                var geocoder = new google.maps.Geocoder;
                var infowindow = new google.maps.InfoWindow({
                                                              maxWidth: 200
                                                            });;    
            
                geocoder.geocode({'location': event.latLng}, function(results, status) {
                  if (status === 'OK') {
                    if (results[1]) {
                      $scope.evento.nomelocal = results[0].address_components[0].long_name;
                      for(var i = 0;i<results[0].address_components.length;i++){
                        if(results[0].address_components[i].types[0] == "administrative_area_level_2"){
                          $scope.evento.cidade = results[0].address_components[i].long_name;
                          console.log($scope.evento.cidade)
                        }
                      }
                      $scope.evento.endereco = results[0].formatted_address;
                      // console.log($scope.evento.endereco);
                      // console.log($scope.evento.cidade);
                      // console.log($scope.evento.lng);
                      // console.log($scope.evento.lat);
                      infowindow.setContent(results[0].formatted_address);
                     
                      infowindow.open(map, marker);
                      setTimeout(function () { infowindow.close(); }, 5000);
                    } else {
                      window.alert('Resultado não encontrado');
          }
        } else {
          window.alert('Ocorreu uma falha doida :' + status);
                  }
                });
            }

                              // GEOCODER INVERSO

                

                
            
                    //        SEARCHBOX

            var input = document.getElementById('pac-input');
            var searchBox = new google.maps.places.SearchBox(input);
        //map.controls[google.maps.ControlPosition.TOP_LEFT].push(input);

        // Bias the SearchBox results towards current map's viewport.
            map.addListener('bounds_changed', function() {
                searchBox.setBounds(map.getBounds());
            });

            var markers = [];
        // Listen for the event fired when the user selects a prediction and retrieve
        // more details for that place.
            searchBox.addListener('places_changed', function() {
                var places = searchBox.getPlaces();

                if (places.length == 0) {
                  return;
                }

                // Clear out the old markers.
                markers.forEach(function(marker) {
                  marker.setMap(null);
                });
                markers = [];

                // For each place, get the icon, name and location.
                var bounds = new google.maps.LatLngBounds();
                places.forEach(function(place) {
                  if (!place.geometry) {
                    console.log("Returned place contains no geometry");
                    return;
                  }
                  markers.push(new google.maps.Marker({
                    map: map,
                    // icon: icon,
                    title: place.name,
                    position: place.geometry.location
                  }));

                  $scope.evento.nomelocal = place.name;
                  $scope.evento.endereco = place.formatted_address;
                  for(var i = 0;i<place.address_components.length;i++){
                    //console.log(place.address_components[i].types[0])
                    if(place.address_components[i].types[0] == "administrative_area_level_2"){
                      $scope.evento.cidade = place.address_components[i].long_name;
                      console.log($scope.evento.cidade)
                    }
                  }
                  $scope.evento.lat = place.geometry.location.lat();
                  $scope.evento.lng = place.geometry.location.lng();
                  $scope.centerPoint.lat = -26.997799;
                  $scope.centerPoint.lng = -48.632733; 
                  $scope.centerPointKM = 30;
                  $scope.LimiteFuncionamentoDiwo = arePointsNear($scope.evento, $scope.centerPoint,$scope.centerPointKM );
                  
                  if (place.geometry.viewport) {
                    // Only geocodes have viewport.
                    bounds.union(place.geometry.viewport);
                  } else {
                    bounds.extend(place.geometry.location);
                  }
                });
                map.fitBounds(bounds);
            });
            $scope.map = map;  
             
        }, function(err) {
            console.log(err.code);
            console.log(err.message);
        });




  });


    $scope.getCriar = function(evento) {
      if($scope.LimiteFuncionamentoDiwo){
            formEventoEditahome.updateForm($scope.evento);
            $state.go('tabsController.EditaEEAPart1');
      }else{
        var alertPopup = $ionicPopup.alert({
            title: '( ꒪Д꒪)ノ',
            template: 'Ótimo saber que você quer criar um evento! Mas parece que a região onde você quer criar seu evento não está na nossa área de cobertura :/'
          }); 
      }
      
    }

}])

.controller('EditaEEAPart3Ctrl', ['$scope', '$stateParams', '$state', 'formEventoEditahome', 'formItem', '$ionicPopup', 'formUser', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, $state, formEventoEditahome, formItem, $ionicPopup, formUser) {
  $scope.evento = {};
  $scope.evento = formEventoEditahome.getForm();
  //$scope.eventorepete = formEvento.getForm().comentario;
  $scope.user = formUser.getForm();
  
  if($scope.user.genero == "fem"){
    $scope.femin = true;
  }else{
    $scope.femin = false;
  }


  if($scope.evento.dificuldade == "Não importa"){
    $scope.evento.dificuldaden = 1;
  }
  if($scope.evento.dificuldade == "Fácil"){
    $scope.evento.dificuldaden = 2;
  }
  if($scope.evento.dificuldade == "Moderado"){
    $scope.evento.dificuldaden = 3;
  }
  if($scope.evento.dificuldade == "Difícil"){
    $scope.evento.dificuldaden = 4;
  }

  $scope.ch = function(){
    if($scope.evento.dificuldaden == 1){
      $scope.evento.dificuldade = "Não importa";
    }
    if($scope.evento.dificuldaden == 2){
      $scope.evento.dificuldade = "Fácil";
    }
    if($scope.evento.dificuldaden == 3){
      $scope.evento.dificuldade = "Moderado";
    }
    if($scope.evento.dificuldaden == 4){
      $scope.evento.dificuldade = "Difícil";
    }
  }

  var header = document.getElementById("barpor");
  var btns = header.getElementsByClassName("btnpor");
  for (var i = 0; i < btns.length; i++) {
    btns[i].addEventListener("click", function() {
      var current = document.getElementsByClassName("actr");
      current[0].className = current[0].className.replace(" actr", "");
      this.className += " actr";
    });
  }
  // $scope.evento.auxpmax = $scope.evento.pmax;
  // $scope.mudamax = function() {
  //   if (!$scope.evento.pmax) {
  //     var alertPopup = $ionicPopup.alert({
  //     title: 'Register failed!',
  //     template: 'Favor preencher todos os campos'
  //   });
  //   }else{    
  //     if (parseInt($scope.evento.pmax) < parseInt($scope.evento.pmin)) {
  //       var alertPopup = $ionicPopup.alert({
  //               title: 'Matematimatematica',
  //               template: 'Máximo de pessoas nao pode ser maior que mínino xD'
  //             });
  //     }else{
  //       if (parseInt($scope.evento.pmax) >= 50) {
  //         var alertPopup = $ionicPopup.alert({
  //                 title: 'Muuuuita gente',
  //                 template: 'Limite máximo de pessoas para um evento é 50 personas'
  //               });
  //       }else{
  //         $scope.evento.pmax = $scope.evento.auxpmax;
  //       }
  //     }
  //   }
  // };
  // $scope.evento.auxpmin = $scope.evento.pmin;
  // $scope.mudamin = function() {
  //   if (!$scope.evento.pmin) {
  //     var alertPopup = $ionicPopup.alert({
  //     title: 'Register failed!',
  //     template: 'Favor preencher todos os campos'
  //   });
  //   }else{    
  //     if (parseInt($scope.evento.pmin)<=1) {
  //       var alertPopup = $ionicPopup.alert({
  //               title: '=/',
  //               template: 'Não da pra fazer um evento só com você né'
  //             });
  //     }else{
  //       $scope.evento.pmin = $scope.evento.auxpmin;
  //     }
  //   }
  // };

  $scope.pessoa = function() {$scope.evento.precopor = 1;};
  $scope.hora = function() {$scope.evento.precopor = 2;};

  $scope.getCriar = function(evento) {
  var palavrasnaousar = ["ALIAMBA", "ANUS", "BAGULIO"
      , "BANZA", "BARRUFO", "BECK", "BEQUE", "BOCETA"
      , "BOLAGATO", "BOQUETE", "BOLCAT", "BOSSETA", "BOSTANA", "BREXA", "BRIOCO", "BRONHA", "BUCA", "BUCETA"
      , "BUSSETA", "CANABIS", "CANNABIS", "CARALHO"
      , "CASSETA", "CASSETE", "CHECHECA", "CHERECA", "CHIBUMBA", "CHIBUMBO", "CHOTA", "CHOCHOTA", "CHUPADA", "CHUPADO", "CLITORIS"
      , "COCAINA", "C+"
      , "C*", "CURALHO", "CUZAO", "CUZUDA", "CUZUDO", "CUZÃO", "ESPORRADA", "ESPORRADO", "ESPORRO", "estupro"
      , "FELACAO", "FELACÃO", "FODA", "FODAO", "FODÃO", "FODAUM", "FODE", "FODIDA", "FODIDO", "FORNICA", "FUDENDO", "FUDECÃO", "FUDECAO"
      , "FUDIDA", "FUDIDO", "GRELINHO", "GRELO", "ISCROTA", "ISCROTO", "MACONHA", "MASTURBA", "MASTURBAÇÃO", "MASTURBACÃO", "MASTURBACAO"
      , "PENIS", "PEN1S", "PENES", "PENIZ", "PICA", "PIROCA", "PIRU", "PORRA", "POURRA", "PROSTIBULO", "PUTA", "PUNHETA", "PUTO"
      , "RABAO", "TESTUDA", "TESTUDO", "VAGABUNDA", "VAGINA", "VIADO", "VIADAO", "VIADÃO", "XAVASCA", "XERERECA", "XEXECA", "XOTA"
      , "XOCHOTA", "XOXOTA", "XANA", "XANINHA", "MDMA", "VSF", "TNC", "FDP", "CRACK"];
      var error = 0; 
      for (var i = 0; i < palavrasnaousar.length; i++) {
        var res2 = $scope.evento.descricao.split("_") ;
        if(res2.length>1){
          for(var w = 0; w < res2.length; w++){
            var val = palavrasnaousar[i].toLowerCase();
            if ((res2[w].toLowerCase()).indexOf(val.toString()) > -1) {  
              error = error + 1;  
            }
          }
        }else{
          var val = palavrasnaousar[i].toLowerCase();  
          if (($scope.evento.descricao.toLowerCase()).indexOf(val.toString()) > -1) {  
            error = error + 1;  
          }
        }
        var res3 = $scope.evento.descricao.split(" ") ;
        if(res3.length>1){
          for(var w = 0; w < res3.length; w++){
            var val = palavrasnaousar[i].toLowerCase();
            if ((res3[w].toLowerCase()).indexOf(val.toString()) > -1) {  
              error = error + 1;  
            }
          }
        }else{
          var val = palavrasnaousar[i].toLowerCase();  
          if (($scope.evento.descricao.toLowerCase()).indexOf(val.toString()) > -1) {  
            error = error + 1;  
          }
        }   
      } 
      if (error > 0) {  
          var alertPopup = $ionicPopup.alert({
                title: '（・о・；）',
                template: 'Que boquinha suja eim, usaste uma palavra inapropriada né'
              }); 
      }else{
        if (!$scope.evento.pmax || !$scope.evento.pmin) {
                    var alertPopup = $ionicPopup.alert({
                    title: 'Register failed!',
                    template: 'Favor preencher todos os campos'
                  });

        }else{
          if (parseInt($scope.evento.pmin)<=1) {
            var alertPopup = $ionicPopup.alert({
                    title: '=/',
                    template: 'Não da pra fazer um evento só com você né'
                  });
          }else{
            if (parseInt($scope.evento.pmax) <= parseInt($scope.evento.pmin)) {
              var alertPopup = $ionicPopup.alert({
                      title: 'Matematimatematica',
                      template: 'Mínimo de pessoas nao pode ser maior que máximo xD'
                    });
            }else{
              if (parseInt($scope.evento.pmax) >= 50) {
                var alertPopup = $ionicPopup.alert({
                        title: 'Muuuuita gente',
                        template: 'Limite máximo de pessoas para um evento é 50 personas'
                      });
              }else{
                if(evento.descricao){
                  formEventoEditahome.updateForm($scope.evento);
                  $state.go('tabsController.EditaEEAPart1');
                }else{
                  var alertPopup = $ionicPopup.alert({
                        title: '( ꒪Д꒪)ノ',
                        template: 'Escreva algo na descrição do evento para ajudar as pessoas a entenderem o que será feito'
                      }); 
                } 
              }
            }
          }
        }  
      }
  }


}])
   
.controller('EditaEEAPart4Ctrl', ['$scope', '$stateParams', '$state', 'formEvento', 'formUser','$ionicPopup', '$http', 'formtela2','formEditar', 'EventoService', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, $state, formEvento, formUser, $ionicPopup, $http, formtela2, formEditar, EventoService) {
  $scope.evento = {};
  $scope.evento = formEvento.getForm();
  $scope.telaeditar = 1;
  $scope.pushnoti = {};
  $scope.confirmacao = 'aprovado';
  $scope.estado = '0';
  $scope.auxtela = formtela2.getForm();
  var res2 = [];
  var noti = {};
  console.log($scope.auxtela);
  EventoService.Gettags($scope.evento.idevento).then(function(tags) {
    for(var  i =0; i< tags.length;i++){
         res2[i] =  tags[i].tag;
        } 
  });

  $scope.mudanome = false;
  $scope.user = formUser.getForm();

  $scope.$on("$ionicView.enter", function(event, data){
    $scope.evento = {};
    $scope.evento = formEvento.getForm();
    $scope.telaeditar = 1;
    $scope.pushnoti = {};
    $scope.confirmacao = 'aprovado';
    $scope.estado = '0';
    $scope.auxtela = formtela2.getForm();
    var res2 = [];
    var noti = {};
    console.log($scope.auxtela);
    EventoService.Gettags($scope.evento.idevento).then(function(tags) {
      for(var  i =0; i< tags.length;i++){
           res2[i] =  tags[i].tag;
          } 
    });
    $scope.mudanome = false;
    $scope.user = formUser.getForm();
    if ($scope.telaeditar == 1) {
      $scope.mudanome = true;
     }
    $scope.auxtela = formtela2.getForm();
    if ($scope.auxtela == 1) {
      $state.go('tabsController.EditaEEAPart1');
    }
  });

  $scope.getCriar = function(evento) {
    if (!$scope.evento.pmax || !$scope.evento.pmin) {
                  var alertPopup = $ionicPopup.alert({
                  title: 'Register failed!',
                  template: 'Favor preencher todos os campos'
                });

       }else{
        if (parseInt($scope.evento.pmin)<=1) {
          var alertPopup = $ionicPopup.alert({
                  title: '=/',
                  template: 'Não da pra fazer um evento só com você né'
                });
        }else{
          if (parseInt($scope.evento.pmax) < parseInt($scope.evento.pmin)) {
            var alertPopup = $ionicPopup.alert({
                    title: 'Matematimatematica',
                    template: 'Mínimo de pessoas nao pode ser maior que máximo xD'
                  });
          }else{
        if (parseInt($scope.evento.pmax) >= 50) {
                var alertPopup = $ionicPopup.alert({
                        title: 'Muuuuita gente',
                        template: 'Limite máximo de pessoas para um evento é 50 personas'
                      });
              }else{
          if ($scope.telaeditar == 1) {
            console.log('oi');
            $scope.evento.datamodificacao = new Date();
           EventoService.atualizarevento($scope.evento).then(function(msg){
           var alertPopup = $ionicPopup.alert({
                    title: 'ʕ•ᴥ•ʔ',
                    template: msg
                  });
                     alertPopup.then(function(){
                      EventoService.GetParticipantes($scope.evento.idevento).then(function(items) {
                  $scope.msgnoti = 'O evento: '+$scope.evento.nomeevento +' foi mudado'
                           for (var i = 0; i < items.length; i++) {
                            if ($scope.user.iduser != items[i].iduser) {
                                  noti.recebeusername = items[i].username;
                                  noti.recebe = items[i].iduser;
                                  noti.envia = $scope.user.iduser;
                                  noti.tipo = 4;
                                  noti.nomeevento = $scope.evento.nomeevento;
                                  EventoService.VerificaNotificacao(noti).then(function(res) {
                                    console.log(res);
                                    if(res){
                                      $http.post('https://ec2.diwoapp.com.br/notificapessoa.php', {notificacao : $scope.msgnoti, 
                                            idevento : $scope.evento.idevento,
                                            nomeevento : $scope.evento.nomeevento,
                                            id_user_envia : $scope.user.iduser,
                                            username_envia : $scope.user.username,
                                            apelido_envia : $scope.aux.apelido,
                                            tipo : '4',    //update no evento
                                            id_user_recebe : noti.recebe}).then(function (res){
                                           $scope.response = res.data;
                                           console.log($scope.response.msg)
                                      });
                                      EventoService.getusuario2(noti.recebeusername).then(function(user) {
                                        if(user.notiparticipando== '1'){
                                        $scope.pushnoti.titulo =  'Mudanças!' ;
                                        $scope.pushnoti.msg = $scope.msgnoti;
                                        $scope.pushnoti.token = user.devicetoken;
                                          EventoService.MandaPushNoti($scope.pushnoti);
                                        }
                                      } );
                                    }
                                  });
                                }
                          }
                         })
                           $state.go('tabsController.eventosAbertos');
                      })
                }, function(errMsg) {
                  var alertPopup = $ionicPopup.alert({
                    title: 'Register failed!',
                    template: errMsg
                  });
                })


       
                          /// AQUI TEMOS QUE COMPARAR SE HOUVE INCLUSAO DE UMA TAG NOVA
          if( $scope.evento.tags!=''){
                var res = $scope.evento.tags.split(" ") ;
                var array3 = res.filter(function(obj) { return res2.indexOf(obj) == -1; });
                  for (var i = 0; i<array3.length;i++){
                    if(array3[i][0]!='#'){
                      array3[i]= '#' + array3[i];
                    }
                    var link = 'https://ec2.diwoapp.com.br/criartag.php';
                    $http.post(link, {idevento : $scope.evento.idevento, 
                                      tag : array3[i]});
                    }
                  }
          }else{
              $ionicPopup.prompt({
                  title: 'Qual nome devo dar?',
                  template: 'Não vamos esquecer de dar nomes aos bois',
                 inputType: 'text',
                 inputPlaceholder: ' Nome legal'
               }).then(function(nomeevento) {
                $scope.evento.nomeevento = nomeevento;
                  console.log('Nome do evento é', nomeevento);
               
         if (nomeevento && nomeevento !='' && nomeevento !=' ') {
          $scope.evento.datamodificacao = new Date();
          var link = 'https://ec2.diwoapp.com.br/atualizarevento.php';
          $http.post(link, {nomeevento : $scope.evento.nomeevento, 
                        duracao : $scope.evento.duracao,
                        diainicio : $scope.evento.diainicio,
                        semana : $scope.evento.semana,
                        diafim : $scope.evento.diafim,
                        dialimiteconfirmacao: $scope.evento.dialimiteconfirmacao,
                        pmin : $scope.evento.pmin, 
                        pmax : $scope.evento.pmax,
                        patual : $scope.evento.patual, 
                        adm : $scope.user.iduser,
                        admusername : $scope.user.username,
                        admapelido : $scope.user.apelido,
                        preco : $scope.evento.preco,
                        precopor : $scope.evento.precopor, 
                        nomelocal : $scope.evento.nomelocal,
                        endereco : $scope.evento.endereco,
                        datamodificacao: $scope.evento.datamodificacao,
                        estado : '0',
                        cidade : $scope.evento.cidade,
                        lat : $scope.evento.lat,
                        lng : $scope.evento.lng,
                        dificuldade :$scope.evento.dificuldade,
                        genero : $scope.evento.genero,
                        descricao : $scope.evento.descricao}).then(function (res){
          $scope.responsecriado = res.data;
          
                /// FAÇO O UPDATE DAS PENALIDADES QUE ME FODEM MATANDO A PENALIDADE RED 

          // if($scope.ic.red >=3){
          //   $http.post("https://ec2.diwoapp.com.br/atualizarpenalidades.php", {idpenalidade : $scope.ic.idred[0]});
          //   $http.post("https://ec2.diwoapp.com.br/atualizarpenalidades.php", {idpenalidade : $scope.ic.idred[1]});
          //   $http.post("https://ec2.diwoapp.com.br/atualizarpenalidades.php", {idpenalidade : $scope.ic.idred[2]});
          //   console.log('Matei a penalidade RED');
          // }
          //     /// FAÇO O UPDATE DAS PENALIDADES QUE ME FODEM E CRIO ANTI RED DE CRIAÇÃO (TIPOPENALIDADE = 5)

          // if($scope.ic.black >=3){
          //     /// FAÇO O UPDATE DAS PENALIDADES QUE ME FODEM MATANDO A PENALIDADE BLACK    
          //   if($scope.ic.antiblack >= 3){
          //     $http.post("https://ec2.diwoapp.com.br/atualizarpenalidades.php", {idpenalidade : $scope.ic.idblack[0]});
          //     $http.post("https://ec2.diwoapp.com.br/atualizarpenalidades.php", {idpenalidade : $scope.ic.idblack[1]});
          //     $http.post("https://ec2.diwoapp.com.br/atualizarpenalidades.php", {idpenalidade : $scope.ic.idblack[2]});
          //     $http.post("https://ec2.diwoapp.com.br/atualizarpenalidades.php", {idpenalidade : $scope.ic.idantiblack[0]});
          //     $http.post("https://ec2.diwoapp.com.br/atualizarpenalidades.php", {idpenalidade : $scope.ic.idantiblack[1]});
          //     $http.post("https://ec2.diwoapp.com.br/atualizarpenalidades.php", {idpenalidade : $scope.ic.idantiblack[2]});
          //     console.log('Matei a penalidade BLACK');
          //   }else{
          //     /// CRIO O ANTIRED (TIPOPENALIDADE = 5)
          //     $http.post('https://ec2.diwoapp.com.br/penalidade.php' , {iduser : $scope.user.iduser,
          //                                                                 idevento : '42',
          //                                                                 username : $scope.user.username,
          //                                                                 tipopenalidade : '5'});
          //     console.log('Criou antiRED do BLACK');
          //   }

          // }

          if ($scope.responsecriado.success == true) {
              // console.log($scope.responsecriado.last);
              // console.log($scope.user.iduser);
              // console.log($scope.evento.nomeevento);
              // console.log($scope.confirmacao);
              // console.log($scope.evento.estado);
              if( $scope.evento.tags!=''){
            var res = $scope.evento.tags.split(" ") ;
             var array3 = res.filter(function(obj) { return res2.indexOf(obj) == -1; });
              for (var i = 0; i<array3.length;i++){
                var link = 'https://ec2.diwoapp.com.br/criartag.php';
                  $http.post(link, {idevento : $scope.responsecriado.last, 
                                    tag : array3[i]})
                 }
               }

            var link = 'https://ec2.diwoapp.com.br/irevento.php';
                $http.post(link, {idevento : $scope.responsecriado.last, 
                                  iduser : $scope.user.iduser,
                                  idadm : $scope.user.iduser, 
                                  admusername : $scope.user.username,
                                  username : $scope.user.username,
                                  borda : $scope.user.borda,
                                  apelido : $scope.user.apelido,
                                  profilepic : $scope.user.profilepic,
                                  devicetoken : $scope.user.devicetoken,
                                  diainicio : $scope.evento.diainicio,
                                  confirmacao : $scope.confirmacao,
                                  nomeevento :  $scope.evento.nomeevento,
                                  idComercioParceiro : $scope.evento.idComercioParceiro, 
                                  //eventopic : $scope.evento.eventopic, 
                                  estado : $scope.estado}).then(function (res){
                $scope.response = res.data;
                console.log($scope.response);
                  if ($scope.response.success == true) {
                      var alertPopup = $ionicPopup.alert({
                    title: 'Parabéns',
                    template: $scope.responsecriado.msg
                  }); 
                      alertPopup.then(function(){
                      formtela2.updateForm(1);
                      $scope.evento = {};
                      formEvento.updateForm($scope.evento);
                       $state.go('tabsConteroller.eventosAbertos');
                     })
                    }else{
                      var alertPopup = $ionicPopup.alert({
                    title: 'Ocorreu uma falha',
                    template: $scope.responsecriado.msg
                  });
                      alertPopup.then(function(){
                      $state.go('tabsController.eventosAbertos');
                     })
                    }
                  })
                }
          });

         }else{console.log('dasd');}
      });
          }
 }
       
        }}

       }
  }

}])

.controller('novacontaemailCtrl', ['$scope', '$stateParams', '$state', 'EventoService', '$cordovaCamera', '$cordovaFile', '$cordovaFileTransfer', '$cordovaDevice', '$ionicPopup', '$cordovaActionSheet','$ionicLoading','$http','formCodigo', 'formNovaconta', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, $state, EventoService, $cordovaCamera, $cordovaFile, $cordovaFileTransfer, $cordovaDevice, $ionicPopup, $cordovaActionSheet,$ionicLoading,$http,formCodigo, formNovaconta) {
  $scope.user = {};



  $scope.Proximo = function() {
     //$scope.user.apelido = $scope.user.username;

     EventoService.verificaemail($scope.user).then(function(res) {
      if(res.success==false){
        var alertPopup = $ionicPopup.alert({
              title: 'ಠ_ಠ',
              template: 'Este email ja esta sendo utilizado'
            });
      }else{
                poolData = {
                    UserPoolId : 'us-east-1_nOWA67ADf', // Your user pool id here
                    ClientId : '8k5rbqhifi5r1hb2j4n1u07li'// Your client id here
                  };    
                var userPool = new AmazonCognitoIdentity.CognitoUserPool(poolData);

                var attributeList = [];
                
                var dataEmail = {
                  Name : 'email', 
                  Value : $scope.user.email, //get from form field
                };
                
                var dataPersonalName = {
                  Name : 'gender', 
                  Value : 'mf', //get from form field
                };

                var dataPersonalNickname = {
                  Name : 'nickname', 
                  Value : $scope.user.email, //get from form field
                };

                var attributeEmail = new AmazonCognitoIdentity.CognitoUserAttribute(dataEmail);
                var attributePersonalName = new AmazonCognitoIdentity.CognitoUserAttribute(dataPersonalName);
                var attributePersonalNickname = new AmazonCognitoIdentity.CognitoUserAttribute(dataPersonalNickname);
                
                attributeList.push(attributeEmail);
                attributeList.push(attributePersonalName);
                attributeList.push(attributePersonalNickname);
                console.log($scope.user)
               
                userPool.signUp($scope.user.email, $scope.user.password, attributeList, null, function(err, result){
                  if (err) {
                    console.log("ja existe", err.message, err.stack)
                    if(err.message == "Password did not conform with policy: Password must have uppercase characters"){
                      var alertPopup = $ionicPopup.alert({
                      title: '(҂⌣̀_⌣́)',
                      template: 'Senha precisa ter caracter em maiúsculo'
                    });
                    }
                    if(err.message == "Password did not conform with policy: Password must have lowercase characters"){
                      var alertPopup = $ionicPopup.alert({
                      title: '(ꐦ ಠ皿ಠ )',
                      template: 'Senha precisa ter caracter em minúsculo'
                    });
                    }
                    if(err.message == "Password did not conform with policy: Password not long enough" || err.message =="1 validation error detected: Value at 'password' failed to satisfy constraint: Member must have length greater than or equal to 6"){
                      var alertPopup = $ionicPopup.alert({
                      title: '(ﾒﾟ皿ﾟ)',
                      template: 'Senha precisa ter 8 caracteres no mínimo'
                    });
                    }
                    if(err.message == "Password did not conform with policy: Password must have numeric characters"){
                      var alertPopup = $ionicPopup.alert({
                        title: '(¬_¬)',
                        template: 'Senha precisa ter número'
                      });
                    }
                    if(err.message == "User already exists"){
                      window.localStorage.setItem( 'criandouser', JSON.stringify($scope.user));
                      formNovaconta.updateForm($scope.user);
                      
                      const poolData = {
                        UserPoolId : 'us-east-1_nOWA67ADf', // Your user pool id here
                        ClientId : '8k5rbqhifi5r1hb2j4n1u07li'// Your client id here
                      };    
                        var userPool = new AmazonCognitoIdentity.CognitoUserPool(poolData);

                        var userData = {
                            Username: $scope.user.email,
                            Pool: userPool
                        };

                        var cognitoUser = new AmazonCognitoIdentity.CognitoUser(userData);


                        cognitoUser.resendConfirmationCode(function(err, result) {
                          if (err) {
                              alert(err.message);
                              $state.go('novacontaconfirma');
                            return;
                          }
                          $state.go('novacontaconfirma');
                            // var alertPopup = $ionicPopup.alert({
                            //   title: 'Deve ter chego',
                            //   template: 'Foi reenviado no seu email de cadastro outro código de validação, se nao chegou ainda, chegará'
                            // });
                        });
                    }
                    // var alertPopup = $ionicPopup.alert({
                    //   title: 'ಠ_ಠ',
                    //   template: 'Ja existe uma conta vinculada a esse email ou username'
                    // });
                    return;
                  }
                  cognitoUser = result.user;
                  $scope.cognito = result.user;
                  //console.log('user name is ' + cognitoUser.getUsername(), result.status, result.UserStatus ,cognitoUser.getUserStatus() );
                  if(cognitoUser.getUsername() == $scope.user.email){
                    console.log("entra", $scope.user.email)
                    window.localStorage.setItem( 'criandouser',  JSON.stringify($scope.user));
                    formNovaconta.updateForm($scope.user);
                    $state.go('novacontaconfirma');
                  }
                   
                  });       
             }
             });    

  };
  $scope.Cancela = function () {
       window.localStorage.removeItem('criandouser')
       $state.go('logando')
    };
  

}])

.controller('novacontaconfirmaCtrl', ['$scope', '$stateParams', '$state', 'EventoService', '$cordovaCamera', '$cordovaFile', '$cordovaFileTransfer', '$cordovaDevice', '$ionicPopup', '$cordovaActionSheet','$ionicLoading','$http','formCodigo', 'formNovaconta', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, $state, EventoService, $cordovaCamera, $cordovaFile, $cordovaFileTransfer, $cordovaDevice, $ionicPopup, $cordovaActionSheet,$ionicLoading,$http,formCodigo, formNovaconta) {
  $scope.user = {};
  $scope.$on("$ionicView.enter", function(event, data){
    $scope.user = JSON.parse(window.localStorage.getItem( 'criandouser' ) ); 
    //cognitoUser = formCognito.getForm();
  });
  //cognitotoUser = formCognito.getForm();


  
  $scope.Proximo = function() {

    const poolData = {
                    UserPoolId : 'us-east-1_nOWA67ADf', // Your user pool id here
                    ClientId : '8k5rbqhifi5r1hb2j4n1u07li'// Your client id here
                  };    
    var userPool = new AmazonCognitoIdentity.CognitoUserPool(poolData);

    var userData = {
        Username: $scope.user.email,
        Pool: userPool
    };

    var cognitoUser = new AmazonCognitoIdentity.CognitoUser(userData);
    cognitoUser.confirmRegistration($scope.user.naws, true, function(err, result) {
        if (err) {
            console.log(err);
            console.log('call result: ' + result);
          return;
        }

        console.log('call result: ' + result);
        if(result == "SUCCESS"){
          $scope.user.confirmado = true;
          window.localStorage.setItem( 'criandouser',  JSON.stringify($scope.user));
          formNovaconta.updateForm($scope.user);
          $state.go('novacontausername');
         console.log('call result: ' + result);
        }else{
          console.log("dasdassdaofjnwenovn")
          var alertPopup = $ionicPopup.alert({
              title: 'Código de confirmação incorreto',
              template: 'Verifique no seu email novamente o código de confirmação'
            });
        }
    });


  };

    $scope.Reenviar = function() {

    const poolData = {
                    UserPoolId : 'us-east-1_nOWA67ADf', // Your user pool id here
                    ClientId : '8k5rbqhifi5r1hb2j4n1u07li'// Your client id here
                  };    
    var userPool = new AmazonCognitoIdentity.CognitoUserPool(poolData);

    var userData = {
        Username: $scope.user.email,
        Pool: userPool
    };

    var cognitoUser = new AmazonCognitoIdentity.CognitoUser(userData);


    cognitoUser.resendConfirmationCode(function(err, result) {
      if (err) {
          alert(err);
        return;
      }
        var alertPopup = $ionicPopup.alert({
          title: 'Deve ter chego',
          template: 'Foi reenviado no seu email de cadastro outro código de validação, se nao chegou ainda, chegará'
        });
    });
    
  };
  $scope.Cancela = function () {
       window.localStorage.removeItem('criandouser')
       $state.go('logando')
    };
  

}])

.controller('novacontausernameCtrl', ['$scope', '$stateParams', '$state', 'EventoService', '$cordovaCamera', '$cordovaFile', '$cordovaFileTransfer', '$cordovaDevice', '$ionicPopup', '$cordovaActionSheet','$ionicLoading','$http','formCodigo', 'formNovaconta', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, $state, EventoService, $cordovaCamera, $cordovaFile, $cordovaFileTransfer, $cordovaDevice, $ionicPopup, $cordovaActionSheet,$ionicLoading,$http,formCodigo, formNovaconta) {
  $scope.user = {};
  $scope.$on("$ionicView.enter", function(event, data){
    $scope.user = JSON.parse( window.localStorage.getItem( 'criandouser' ));    //cognitoUser = formCognito.getForm();
  });
  //cognitoUser = formCognito.getForm();
  
  $scope.Proximo = function() {
    if($scope.user.username){
      EventoService.verificausername($scope.user).then(function(result) {
        if(result.success==false){
          var alertPopup = $ionicPopup.alert({
                  title: 'ಠ_ಠ',
                  template: 'Ja tem alguem com esse nome de usuário'
                });
        }else{
            var palavrasnaousar = ["ALIAMBA", "ANUS", "BAGULIO"
            , "BANZA", "BARRUFO", "BECK", "BEQUE", "BOCETA"
            , "BOLAGATO", "BOQUETE", "BOLCAT", "BOSSETA", "BOSTANA", "BREXA", "BRIOCO", "BRONHA", "BUCA", "BUCETA"
            , "BUSSETA", "CANABIS", "CANNABIS", "CARALHO"
            , "CASSETA", "CASSETE", "CHECHECA", "CHERECA", "CHIBUMBA", "CHIBUMBO", "CHOTA", "CHOCHOTA", "CHUPADA", "CHUPADO", "CLITORIS"
            , "COCAINA", "C+"
            , "C*", "CURALHO", "CUZAO", "CUZUDA", "CUZUDO", "CUZÃO", "ESPORRADA", "ESPORRADO", "ESPORRO", "estupro"
            , "FELACAO", "FELACÃO", "FODA", "FODAO", "FODÃO", "FODAUM", "FODE", "FODIDA", "FODIDO", "FORNICA", "FUDENDO", "FUDECÃO", "FUDECAO"
            , "FUDIDA", "FUDIDO", "GRELINHO", "GRELO", "ISCROTA", "ISCROTO", "MACONHA", "MASTURBA", "MASTURBAÇÃO", "MASTURBACÃO", "MASTURBACAO"
            , "PENIS", "PEN1S", "PENES", "PENIZ", "PICA", "PIROCA", "PIRU", "PORRA", "POURRA", "PROSTIBULO", "PUTA", "PUNHETA", "PUTO"
            , "RABAO", "TESTUDA", "TESTUDO", "VAGABUNDA", "VAGINA", "VIADO", "VIADAO", "VIADÃO", "XAVASCA", "XERERECA", "XEXECA", "XOTA"
            , "XOCHOTA", "XOXOTA", "XANA", "XANINHA", "MDMA", "VSF", "TNC", "FDP", "CRACK"];
            var error = 0; 
            for (var i = 0; i < palavrasnaousar.length; i++) {
              var res2 = $scope.user.username.split("_") ;
              if(res2.length>1){
                for(var w = 0; w < res2.length; w++){
                  var val = palavrasnaousar[i].toLowerCase();
                  if ((res2[w].toLowerCase()).indexOf(val.toString()) > -1) {  
                    error = error + 1;  
                  }
                }
              }else{
                var val = palavrasnaousar[i].toLowerCase();  
                if (($scope.user.username.toLowerCase()).indexOf(val.toString()) > -1) {  
                  error = error + 1;  
                }
              }   
            } 
            if (error > 0) {  
                var alertPopup = $ionicPopup.alert({
                      title: '（・о・；）',
                      template: 'Que boquinha suja eim, usaste uma palavra inapropriada né'
                    }); 
            }else{
                window.localStorage.setItem( 'criandouser',  JSON.stringify($scope.user));
                formNovaconta.updateForm($scope.user);
                $state.go('novacontagenero');
            }
        }
      });
    }
   

  };
  $scope.Cancela = function () {
       window.localStorage.removeItem('criandouser')
       $state.go('logando')
    };
  

}])

.controller('novacontageneroCtrl', ['$scope', '$stateParams', '$state', 'EventoService', '$cordovaCamera', '$cordovaFile', '$cordovaFileTransfer', '$cordovaDevice', '$ionicPopup', '$cordovaActionSheet','$ionicLoading','$http','formCodigo', 'formNovaconta', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, $state, EventoService, $cordovaCamera, $cordovaFile, $cordovaFileTransfer, $cordovaDevice, $ionicPopup, $cordovaActionSheet,$ionicLoading,$http,formCodigo, formNovaconta) {
  $scope.user = {};
  $scope.$on("$ionicView.enter", function(event, data){
    $scope.user = JSON.parse( window.localStorage.getItem( 'criandouser' ));
    //cognitoUser = formCognito.getForm();
  });
  //cognitoUser = formCognito.getForm();
  

    var header = document.getElementById("barsexon");
    var btns = header.getElementsByClassName("btnsexn");
    for (var i = 0; i < btns.length; i++) {
      btns[i].addEventListener("click", function() {
        var current = document.getElementsByClassName("actn");
        current[0].className = current[0].className.replace(" actn", "");
        this.className += " actn";
      });
    }
  $scope.macho = function() {
    $scope.user.genero = 'masc'
    window.localStorage.setItem( 'criandouser',  JSON.stringify($scope.user));
    formNovaconta.updateForm($scope.user);
    $state.go('novacontaidade');
  };
  $scope.femea = function() {
    $scope.user.genero = 'fem'
    window.localStorage.setItem( 'criandouser',  JSON.stringify($scope.user));
    formNovaconta.updateForm($scope.user);
    $state.go('novacontaidade');
   
  };
  $scope.Cancela = function () {
       window.localStorage.removeItem('criandouser')
       $state.go('logando')
    };
}])

.controller('novacontaidadeCtrl', ['$scope', '$stateParams', '$state', 'EventoService', '$cordovaCamera', '$cordovaFile', '$cordovaFileTransfer', '$cordovaDevice', '$ionicPopup', '$cordovaActionSheet','$ionicLoading','$http','formCodigo', 'formNovaconta', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, $state, EventoService, $cordovaCamera, $cordovaFile, $cordovaFileTransfer, $cordovaDevice, $ionicPopup, $cordovaActionSheet,$ionicLoading,$http,formCodigo, formNovaconta) {
  $scope.user = {};
  $scope.$on("$ionicView.enter", function(event, data){
    $scope.user = JSON.parse( window.localStorage.getItem( 'criandouser' ));
    //cognitoUser = formCognito.getForm();
  });
  //cognitoUser = formCognito.getForm();
    
  $scope.Proximo = function() {
    // birthday is a date
   var ageDifMs = Date.now() - $scope.user.birthday;
   var ageDate = new Date(ageDifMs); // miliseconds from epoch
  $scope.user.idade =  Math.abs(ageDate.getUTCFullYear() - 1970);
    if($scope.user.idade <18){
      var alertPopup = $ionicPopup.alert({
        title: '=//',
        template: 'Você é muito novo para usar o app'
      });
    }else{
      window.localStorage.setItem( 'criandouser', JSON.stringify($scope.user));
      formNovaconta.updateForm($scope.user);
      $state.go('novacontainteresse');
    }
  };
  $scope.Cancela = function () {
       window.localStorage.removeItem('criandouser')
       $state.go('logando')
    };

 

}])

.controller('novacontainteresseCtrl', ['$scope', '$stateParams', '$state', 'EventoService', '$cordovaCamera', '$cordovaFile', '$cordovaFileTransfer', '$cordovaDevice', '$ionicPopup', '$cordovaActionSheet','$ionicLoading','$http','formCodigo', 'formNovaconta', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, $state, EventoService, $cordovaCamera, $cordovaFile, $cordovaFileTransfer, $cordovaDevice, $ionicPopup, $cordovaActionSheet,$ionicLoading,$http,formCodigo, formNovaconta) {
  $scope.user = {};

  $scope.$on("$ionicView.enter", function(event, data){
    $scope.user = JSON.parse( window.localStorage.getItem( 'criandouser' ));
    $scope.auxtagbutton1 = true;
    $scope.auxtagbutton2 = true;
    $scope.auxtagbutton3 = true;
    $scope.auxtagbutton4 = true;
    $scope.auxtagbutton5 = true;
    $scope.auxtagbutton6 = true;
    $scope.auxtagbutton7 = true;
    $scope.auxtagbutton8 = true;
    $scope.auxtagbutton9 = true;
    $scope.auxtagbutton10 = true;
    $scope.auxtagbutton11 = true;
    $scope.auxtagbutton12 = true;
    $scope.auxtagbutton13 = true;
    $scope.auxtagbutton14 = true;
    $scope.auxtagbutton15 = true;
    $scope.auxtagbutton16 = true;
    $scope.auxtagbutton17 = true;
    $scope.auxtagbutton18 = true;
    $scope.auxtagbutton1aux = false;
    $scope.auxtagbutton2aux = false;
    $scope.auxtagbutton3aux = false;
    $scope.auxtagbutton4aux = false;
    $scope.auxtagbutton5aux = false;
    $scope.auxtagbutton6aux = false;
    $scope.auxtagbutton7aux = false;
    $scope.auxtagbutton8aux = false;
    $scope.auxtagbutton9aux = false;
    $scope.auxtagbutton10aux = false;
    $scope.auxtagbutton11aux = false;
    $scope.auxtagbutton12aux = false;
    $scope.auxtagbutton13aux = false;
    $scope.auxtagbutton14aux = false;
    $scope.auxtagbutton15aux = false;
    $scope.auxtagbutton16aux = false;
    $scope.auxtagbutton17aux = false;
    $scope.auxtagbutton18aux = false;
    $scope.user.auxtag1 = 'Voluntariado';
    $scope.user.auxtag2 = 'Passeio'; 
    $scope.user.auxtag3 = 'Esportesdepraia'; 
    $scope.user.auxtag4 = 'Natureza'; 
    $scope.user.auxtag5 = 'Ciclismo';  
    $scope.user.auxtag6 = 'Futebol'; 
    $scope.user.auxtag7 = 'Corrida'; 
    $scope.user.auxtag8 = 'Dança'; 
    $scope.user.auxtag9 = 'Surf'; 
    $scope.user.auxtag10 = 'Música'; 
    $scope.user.auxtag11 = 'ArteeCultura'; 
    $scope.user.auxtag12 = 'Conversa'; 
    $scope.user.auxtag13 = 'Restaurante&Bares'; 
    $scope.user.auxtag14 = 'Festas'; 
    $scope.user.auxtag15 = 'Jogos'; 
    $scope.user.auxtag16 = 'GruposdeEstudos'; 
    $scope.user.auxtag17 = 'Pets'; 
    $scope.user.auxtag18 = 'Praia'; 

  });
    $scope.tiratag1 = function(){
        if($scope.auxtagbutton1){
          $scope.auxtagbutton1 = false;
          $scope.auxtagbutton1aux = true;
        }else{
          $scope.auxtagbutton1 = true;
          $scope.auxtagbutton1aux = false;
        }
    }
    $scope.tiratag2 = function(){
        if($scope.auxtagbutton2){
          $scope.auxtagbutton2 = false;
          $scope.auxtagbutton2aux = true;
        }else{
          $scope.auxtagbutton2 = true;
          $scope.auxtagbutton2aux = false;
        }
    }
    $scope.tiratag3 = function(){
        if($scope.auxtagbutton3){
          $scope.auxtagbutton3 = false;
          $scope.auxtagbutton3aux = true;
        }else{
          $scope.auxtagbutton3 = true;
          $scope.auxtagbutton3aux = false;
        }
    }
    $scope.tiratag4 = function(){
        if($scope.auxtagbutton4){
          $scope.auxtagbutton4 = false;
          $scope.auxtagbutton4aux = true;
        }else{
          $scope.auxtagbutton4 = true;
          $scope.auxtagbutton4aux = false;
        }
    }
    $scope.tiratag5 = function(){
        if($scope.auxtagbutton5){
          $scope.auxtagbutton5 = false;
          $scope.auxtagbutton5aux = true;
        }else{
          $scope.auxtagbutton5 = true;
          $scope.auxtagbutton5aux = false;
        }
    }
    $scope.tiratag6 = function(){
        if($scope.auxtagbutton6){
          $scope.auxtagbutton6 = false;
          $scope.auxtagbutton6aux = true;
        }else{
          $scope.auxtagbutton6 = true;
          $scope.auxtagbutton6aux = false;
        }
    }

    $scope.tiratag7 = function(){
        if($scope.auxtagbutton7){
          $scope.auxtagbutton1 = false;
          $scope.auxtagbutton7aux = true;
        }else{
          $scope.auxtagbutton7 = true;
          $scope.auxtagbutton7aux = false;
        }
    }
    $scope.tiratag8 = function(){
        if($scope.auxtagbutton8){
          $scope.auxtagbutton8 = false;
          $scope.auxtagbutton8aux = true;
        }else{
          $scope.auxtagbutton8 = true;
          $scope.auxtagbutton8aux = false;
        }
    }
    $scope.tiratag9 = function(){
        if($scope.auxtagbutton9){
          $scope.auxtagbutton9 = false;
          $scope.auxtagbutton9aux = true;
        }else{
          $scope.auxtagbutton9 = true;
          $scope.auxtagbutton9aux = false;
        }
    }
    $scope.tiratag10 = function(){
        if($scope.auxtagbutton10){
          $scope.auxtagbutton10 = false;
          $scope.auxtagbutton10aux = true;
        }else{
          $scope.auxtagbutton10 = true;
          $scope.auxtagbutton10aux = false;
        }
    }
    $scope.tiratag11 = function(){
        if($scope.auxtagbutton11){
          $scope.auxtagbutton11 = false;
          $scope.auxtagbutton11aux = true;
        }else{
          $scope.auxtagbutton11 = true;
          $scope.auxtagbutton11aux = false;
        }
    }
    $scope.tiratag12 = function(){
        if($scope.auxtagbutton12){
          $scope.auxtagbutton12 = false;
          $scope.auxtagbutton12aux = true;
        }else{
          $scope.auxtagbutton12 = true;
          $scope.auxtagbutton12aux = false;
        }
    }
    $scope.tiratag13 = function(){
        if($scope.auxtagbutton13){
          $scope.auxtagbutton13 = false;
          $scope.auxtagbutton13aux = true;
        }else{
          $scope.auxtagbutton13 = true;
          $scope.auxtagbutton13aux = false;
        }
    }
    $scope.tiratag14 = function(){
        if($scope.auxtagbutton14){
          $scope.auxtagbutton14 = false;
          $scope.auxtagbutton14aux = true;
        }else{
          $scope.auxtagbutton14 = true;
          $scope.auxtagbutton14aux = false;
        }
    }
    $scope.tiratag15 = function(){
        if($scope.auxtagbutton15){
          $scope.auxtagbutton15 = false;
          $scope.auxtagbutton15aux = true;
        }else{
          $scope.auxtagbutton15 = true;
          $scope.auxtagbutton15aux = false;
        }
    }
    $scope.tiratag16 = function(){
        if($scope.auxtagbutton16){
          $scope.auxtagbutton16 = false;
          $scope.auxtagbutton16aux = true;
        }else{
          $scope.auxtagbutton16 = true;
          $scope.auxtagbutton16aux = false;
        }
    }
    $scope.tiratag17 = function(){
        if($scope.auxtagbutton17){
          $scope.auxtagbutton17 = false;
          $scope.auxtagbutton17aux = true;
        }else{
          $scope.auxtagbutton17 = true;
          $scope.auxtagbutton17aux = false;
        }
    }
    $scope.tiratag18 = function(){
        if($scope.auxtagbutton18){
          $scope.auxtagbutton18 = false;
          $scope.auxtagbutton18aux = true;
        }else{
          $scope.auxtagbutton18 = true;
          $scope.auxtagbutton18aux = false;
        }
    }

    
  $scope.Proximo = function() {
 
      if($scope.auxtagbutton1 == false){
        if ($scope.user.interesse == undefined) {
          $scope.user.interesse = $scope.user.auxtag1;
        }else{
          $scope.user.interesse = $scope.user.interesse + ' ' +$scope.user.auxtag1;
        }
      }
      if($scope.auxtagbutton2 == false){
        if ($scope.user.interesse == undefined) {
          $scope.user.interesse = $scope.user.auxtag2;
        }else{
          $scope.user.interesse = $scope.user.interesse + ' ' +$scope.user.auxtag2;
        }
      }
      if($scope.auxtagbutton3 == false){
        if ($scope.user.interesse == undefined) {
          $scope.user.interesse = $scope.user.auxtag3;
        }else{
          $scope.user.interesse = $scope.user.interesse + ' ' +$scope.user.auxtag3;
        }
      }
      if($scope.auxtagbutton4 == false){
        if ($scope.user.interesse == undefined) {
          $scope.user.interesse = $scope.user.auxtag4;
        }else{
          $scope.user.interesse = $scope.user.interesse + ' ' +$scope.user.auxtag4;
        }
      }
      if($scope.auxtagbutton5 == false){
        if ($scope.user.interesse == undefined) {
          $scope.user.interesse = $scope.user.auxtag5;
        }else{
          $scope.user.interesse = $scope.user.interesse + ' ' +$scope.user.auxtag5;
        }
      }
      if($scope.auxtagbutton6 == false){
        if ($scope.user.interesse == undefined) {
          $scope.user.interesse = $scope.user.auxtag6;
        }else{
          $scope.user.interesse = $scope.user.interesse + ' ' +$scope.user.auxtag6;
        }
      }
      if($scope.auxtagbutton7 == false){
        if ($scope.user.interesse == undefined) {
          $scope.user.interesse = $scope.user.auxtag7;
        }else{
          $scope.user.interesse = $scope.user.interesse + ' ' +$scope.user.auxtag7;
        }
      }
      if($scope.auxtagbutton8 == false){
        if ($scope.user.interesse == undefined) {
          $scope.user.interesse = $scope.user.auxtag8;
        }else{
          $scope.user.interesse = $scope.user.interesse + ' ' +$scope.user.auxtag8;
        }
      }
      if($scope.auxtagbutton9 == false){
        if ($scope.user.interesse == undefined) {
          $scope.user.interesse = $scope.user.auxtag9;
        }else{
          $scope.user.interesse = $scope.user.interesse + ' ' +$scope.user.auxtag9;
        }
      }
      if($scope.auxtagbutton10 == false){
        if ($scope.user.interesse == undefined) {
          $scope.user.interesse = $scope.user.auxtag10;
        }else{
          $scope.user.interesse = $scope.user.interesse + ' ' +$scope.user.auxtag10;
        }
      }
      if($scope.auxtagbutton11 == false){
        if ($scope.user.interesse == undefined) {
          $scope.user.interesse = $scope.user.auxtag11;
        }else{
          $scope.user.interesse = $scope.user.interesse + ' ' +$scope.user.auxtag11;
        }
      }
      if($scope.auxtagbutton12 == false){
        if ($scope.user.interesse == undefined) {
          $scope.user.interesse = $scope.user.auxtag12;
        }else{
          $scope.user.interesse = $scope.user.interesse + ' ' +$scope.user.auxtag12;
        }
      }
      if($scope.auxtagbutton13 == false){
        if ($scope.user.interesse == undefined) {
          $scope.user.interesse = $scope.user.auxtag13;
        }else{
          $scope.user.interesse = $scope.user.interesse + ' ' +$scope.user.auxtag13;
        }
      }
      if($scope.auxtagbutton14 == false){
        if ($scope.user.interesse == undefined) {
          $scope.user.interesse = $scope.user.auxtag14;
        }else{
          $scope.user.interesse = $scope.user.interesse + ' ' +$scope.user.auxtag14;
        }
      }
      if($scope.auxtagbutton15 == false){
        if ($scope.user.interesse == undefined) {
          $scope.user.interesse = $scope.user.auxtag15;
        }else{
          $scope.user.interesse = $scope.user.interesse + ' ' +$scope.user.auxtag15;
        }
      }
      if($scope.auxtagbutton16 == false){
        if ($scope.user.interesse == undefined) {
          $scope.user.interesse = $scope.user.auxtag16;
        }else{
          $scope.user.interesse = $scope.user.interesse + ' ' +$scope.user.auxtag16;
        }
      }
      if($scope.auxtagbutton17 == false){
        if ($scope.user.interesse == undefined) {
          $scope.user.interesse = $scope.user.auxtag17;
        }else{
          $scope.user.interesse = $scope.user.interesse + ' ' +$scope.user.auxtag17;
        }
      }
      if($scope.auxtagbutton18 == false){
        if ($scope.user.interesse == undefined) {
          $scope.user.interesse = $scope.user.auxtag18;
        }else{
          $scope.user.interesse = $scope.user.interesse + ' ' +$scope.user.auxtag18;
        }
      }

      if (!$scope.user.interesse) {
        var alertPopup = $ionicPopup.alert({
          title: '(⊙﹏⊙✿)',
          template: 'Selecione pelo menos um desses!'
        });
      }else{
        window.localStorage.setItem( 'criandouser', JSON.stringify($scope.user));
        formNovaconta.updateForm($scope.user);
        $state.go('novacontafoto');
      }


            
  };
  $scope.Cancela = function () {
       window.localStorage.removeItem('criandouser')
       $state.go('logando')
    };

 

}])

.controller('novacontainteresseFBCtrl', ['$scope', '$stateParams', '$state', 'EventoService', '$cordovaCamera', '$cordovaFile', '$cordovaFileTransfer', '$cordovaDevice', '$ionicPopup', '$cordovaActionSheet','$ionicLoading','$http','formCodigo', 'formUser', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, $state, EventoService, $cordovaCamera, $cordovaFile, $cordovaFileTransfer, $cordovaDevice, $ionicPopup, $cordovaActionSheet,$ionicLoading,$http,formCodigo, formUser) {
  $scope.user = {};

  $scope.$on("$ionicView.enter", function(event, data){
    $scope.user = JSON.parse( window.localStorage.getItem( 'user' ));
    $scope.auxtagbutton1 = true;
    $scope.auxtagbutton2 = true;
    $scope.auxtagbutton3 = true;
    $scope.auxtagbutton4 = true;
    $scope.auxtagbutton5 = true;
    $scope.auxtagbutton6 = true;
    $scope.auxtagbutton7 = true;
    $scope.auxtagbutton8 = true;
    $scope.auxtagbutton9 = true;
    $scope.auxtagbutton10 = true;
    $scope.auxtagbutton11 = true;
    $scope.auxtagbutton12 = true;
    $scope.auxtagbutton13 = true;
    $scope.auxtagbutton14 = true;
    $scope.auxtagbutton15 = true;
    $scope.auxtagbutton16 = true;
    $scope.auxtagbutton17 = true;
    $scope.auxtagbutton18 = true;
    $scope.auxtagbutton1aux = false;
    $scope.auxtagbutton2aux = false;
    $scope.auxtagbutton3aux = false;
    $scope.auxtagbutton4aux = false;
    $scope.auxtagbutton5aux = false;
    $scope.auxtagbutton6aux = false;
    $scope.auxtagbutton7aux = false;
    $scope.auxtagbutton8aux = false;
    $scope.auxtagbutton9aux = false;
    $scope.auxtagbutton10aux = false;
    $scope.auxtagbutton11aux = false;
    $scope.auxtagbutton12aux = false;
    $scope.auxtagbutton13aux = false;
    $scope.auxtagbutton14aux = false;
    $scope.auxtagbutton15aux = false;
    $scope.auxtagbutton16aux = false;
    $scope.auxtagbutton17aux = false;
    $scope.auxtagbutton18aux = false;
    $scope.user.auxtag1 = 'Voluntariado';
    $scope.user.auxtag2 = 'Passeio'; 
    $scope.user.auxtag3 = 'Esportesdepraia'; 
    $scope.user.auxtag4 = 'Natureza'; 
    $scope.user.auxtag5 = 'Ciclismo';  
    $scope.user.auxtag6 = 'Futebol'; 
    $scope.user.auxtag7 = 'Corrida'; 
    $scope.user.auxtag8 = 'Dança'; 
    $scope.user.auxtag9 = 'Surf'; 
    $scope.user.auxtag10 = 'Música'; 
    $scope.user.auxtag11 = 'ArteeCultura'; 
    $scope.user.auxtag12 = 'Conversa'; 
    $scope.user.auxtag13 = 'Restaurante&Bares'; 
    $scope.user.auxtag14 = 'Festas'; 
    $scope.user.auxtag15 = 'Jogos'; 
    $scope.user.auxtag16 = 'GruposdeEstudos'; 
    $scope.user.auxtag17 = 'Pets'; 
    $scope.user.auxtag18 = 'Praia';  

  });
    $scope.tiratag1 = function(){
        if($scope.auxtagbutton1){
          $scope.auxtagbutton1 = false;
          $scope.auxtagbutton1aux = true;
        }else{
          $scope.auxtagbutton1 = true;
          $scope.auxtagbutton1aux = false;
        }
    }
    $scope.tiratag2 = function(){
        if($scope.auxtagbutton2){
          $scope.auxtagbutton2 = false;
          $scope.auxtagbutton2aux = true;
        }else{
          $scope.auxtagbutton2 = true;
          $scope.auxtagbutton2aux = false;
        }
    }
    $scope.tiratag3 = function(){
        if($scope.auxtagbutton3){
          $scope.auxtagbutton3 = false;
          $scope.auxtagbutton3aux = true;
        }else{
          $scope.auxtagbutton3 = true;
          $scope.auxtagbutton3aux = false;
        }
    }
    $scope.tiratag4 = function(){
        if($scope.auxtagbutton4){
          $scope.auxtagbutton4 = false;
          $scope.auxtagbutton4aux = true;
        }else{
          $scope.auxtagbutton4 = true;
          $scope.auxtagbutton4aux = false;
        }
    }
    $scope.tiratag5 = function(){
        if($scope.auxtagbutton5){
          $scope.auxtagbutton5 = false;
          $scope.auxtagbutton5aux = true;
        }else{
          $scope.auxtagbutton5 = true;
          $scope.auxtagbutton5aux = false;
        }
    }
    $scope.tiratag6 = function(){
        if($scope.auxtagbutton6){
          $scope.auxtagbutton6 = false;
          $scope.auxtagbutton6aux = true;
        }else{
          $scope.auxtagbutton6 = true;
          $scope.auxtagbutton6aux = false;
        }
    }

    $scope.tiratag7 = function(){
        if($scope.auxtagbutton7){
          $scope.auxtagbutton7 = false;
          $scope.auxtagbutton7aux = true;
        }else{
          $scope.auxtagbutton7 = true;
          $scope.auxtagbutton7aux = false;
        }
    }
    $scope.tiratag8 = function(){
        if($scope.auxtagbutton8){
          $scope.auxtagbutton8 = false;
          $scope.auxtagbutton8aux = true;
        }else{
          $scope.auxtagbutton8 = true;
          $scope.auxtagbutton8aux = false;
        }
    }
    $scope.tiratag9 = function(){
        if($scope.auxtagbutton9){
          $scope.auxtagbutton9 = false;
          $scope.auxtagbutton9aux = true;
        }else{
          $scope.auxtagbutton9 = true;
          $scope.auxtagbutton9aux = false;
        }
    }
    $scope.tiratag10 = function(){
        if($scope.auxtagbutton10){
          $scope.auxtagbutton10 = false;
          $scope.auxtagbutton10aux = true;
        }else{
          $scope.auxtagbutton10 = true;
          $scope.auxtagbutton10aux = false;
        }
    }
    $scope.tiratag11 = function(){
        if($scope.auxtagbutton11){
          $scope.auxtagbutton11 = false;
          $scope.auxtagbutton11aux = true;
        }else{
          $scope.auxtagbutton11 = true;
          $scope.auxtagbutton11aux = false;
        }
    }
    $scope.tiratag12 = function(){
        if($scope.auxtagbutton12){
          $scope.auxtagbutton12 = false;
          $scope.auxtagbutton12aux = true;
        }else{
          $scope.auxtagbutton12 = true;
          $scope.auxtagbutton12aux = false;
        }
    }
    $scope.tiratag13 = function(){
        if($scope.auxtagbutton13){
          $scope.auxtagbutton13 = false;
          $scope.auxtagbutton13aux = true;
        }else{
          $scope.auxtagbutton13 = true;
          $scope.auxtagbutton13aux = false;
        }
    }
    $scope.tiratag14 = function(){
        if($scope.auxtagbutton14){
          $scope.auxtagbutton14 = false;
          $scope.auxtagbutton14aux = true;
        }else{
          $scope.auxtagbutton14 = true;
          $scope.auxtagbutton14aux = false;
        }
    }
    $scope.tiratag15 = function(){
        if($scope.auxtagbutton15){
          $scope.auxtagbutton15 = false;
          $scope.auxtagbutton15aux = true;
        }else{
          $scope.auxtagbutton15 = true;
          $scope.auxtagbutton15aux = false;
        }
    }
    $scope.tiratag16 = function(){
        if($scope.auxtagbutton16){
          $scope.auxtagbutton16 = false;
          $scope.auxtagbutton16aux = true;
        }else{
          $scope.auxtagbutton16 = true;
          $scope.auxtagbutton16aux = false;
        }
    }
    $scope.tiratag17 = function(){
        if($scope.auxtagbutton17){
          $scope.auxtagbutton17 = false;
          $scope.auxtagbutton17aux = true;
        }else{
          $scope.auxtagbutton17 = true;
          $scope.auxtagbutton17aux = false;
        }
    }
    $scope.tiratag18 = function(){
        if($scope.auxtagbutton18){
          $scope.auxtagbutton18 = false;
          $scope.auxtagbutton18aux = true;
        }else{
          $scope.auxtagbutton18 = true;
          $scope.auxtagbutton18aux = false;
        }
    }


    
  $scope.Proximo = function() {
 
       if($scope.auxtagbutton1 == false){
        if ($scope.user.interesse == undefined) {
          $scope.user.interesse = $scope.user.auxtag1;
        }else{
          $scope.user.interesse = $scope.user.interesse + ' ' +$scope.user.auxtag1;
        }
      }
      if($scope.auxtagbutton2 == false){
        if ($scope.user.interesse == undefined) {
          $scope.user.interesse = $scope.user.auxtag2;
        }else{
          $scope.user.interesse = $scope.user.interesse + ' ' +$scope.user.auxtag2;
        }
      }
      if($scope.auxtagbutton3 == false){
        if ($scope.user.interesse == undefined) {
          $scope.user.interesse = $scope.user.auxtag3;
        }else{
          $scope.user.interesse = $scope.user.interesse + ' ' +$scope.user.auxtag3;
        }
      }
      if($scope.auxtagbutton4 == false){
        if ($scope.user.interesse == undefined) {
          $scope.user.interesse = $scope.user.auxtag4;
        }else{
          $scope.user.interesse = $scope.user.interesse + ' ' +$scope.user.auxtag4;
        }
      }
      if($scope.auxtagbutton5 == false){
        if ($scope.user.interesse == undefined) {
          $scope.user.interesse = $scope.user.auxtag5;
        }else{
          $scope.user.interesse = $scope.user.interesse + ' ' +$scope.user.auxtag5;
        }
      }
      if($scope.auxtagbutton6 == false){
        if ($scope.user.interesse == undefined) {
          $scope.user.interesse = $scope.user.auxtag6;
        }else{
          $scope.user.interesse = $scope.user.interesse + ' ' +$scope.user.auxtag6;
        }
      }
      if($scope.auxtagbutton7 == false){
        if ($scope.user.interesse == undefined) {
          $scope.user.interesse = $scope.user.auxtag7;
        }else{
          $scope.user.interesse = $scope.user.interesse + ' ' +$scope.user.auxtag7;
        }
      }
      if($scope.auxtagbutton8 == false){
        if ($scope.user.interesse == undefined) {
          $scope.user.interesse = $scope.user.auxtag8;
        }else{
          $scope.user.interesse = $scope.user.interesse + ' ' +$scope.user.auxtag8;
        }
      }
      if($scope.auxtagbutton9 == false){
        if ($scope.user.interesse == undefined) {
          $scope.user.interesse = $scope.user.auxtag9;
        }else{
          $scope.user.interesse = $scope.user.interesse + ' ' +$scope.user.auxtag9;
        }
      }
      if($scope.auxtagbutton10 == false){
        if ($scope.user.interesse == undefined) {
          $scope.user.interesse = $scope.user.auxtag10;
        }else{
          $scope.user.interesse = $scope.user.interesse + ' ' +$scope.user.auxtag10;
        }
      }
      if($scope.auxtagbutton11 == false){
        if ($scope.user.interesse == undefined) {
          $scope.user.interesse = $scope.user.auxtag11;
        }else{
          $scope.user.interesse = $scope.user.interesse + ' ' +$scope.user.auxtag11;
        }
      }
      if($scope.auxtagbutton12 == false){
        if ($scope.user.interesse == undefined) {
          $scope.user.interesse = $scope.user.auxtag12;
        }else{
          $scope.user.interesse = $scope.user.interesse + ' ' +$scope.user.auxtag12;
        }
      }
      if($scope.auxtagbutton13 == false){
        if ($scope.user.interesse == undefined) {
          $scope.user.interesse = $scope.user.auxtag13;
        }else{
          $scope.user.interesse = $scope.user.interesse + ' ' +$scope.user.auxtag13;
        }
      }
      if($scope.auxtagbutton14 == false){
        if ($scope.user.interesse == undefined) {
          $scope.user.interesse = $scope.user.auxtag14;
        }else{
          $scope.user.interesse = $scope.user.interesse + ' ' +$scope.user.auxtag14;
        }
      }
      if($scope.auxtagbutton15 == false){
        if ($scope.user.interesse == undefined) {
          $scope.user.interesse = $scope.user.auxtag15;
        }else{
          $scope.user.interesse = $scope.user.interesse + ' ' +$scope.user.auxtag15;
        }
      }
      if($scope.auxtagbutton16 == false){
        if ($scope.user.interesse == undefined) {
          $scope.user.interesse = $scope.user.auxtag16;
        }else{
          $scope.user.interesse = $scope.user.interesse + ' ' +$scope.user.auxtag16;
        }
      }
      if($scope.auxtagbutton17 == false){
        if ($scope.user.interesse == undefined) {
          $scope.user.interesse = $scope.user.auxtag17;
        }else{
          $scope.user.interesse = $scope.user.interesse + ' ' +$scope.user.auxtag17;
        }
      }
      if($scope.auxtagbutton18 == false){
        if ($scope.user.interesse == undefined) {
          $scope.user.interesse = $scope.user.auxtag18;
        }else{
          $scope.user.interesse = $scope.user.interesse + ' ' +$scope.user.auxtag18;
        }
      }
      if (!$scope.user.interesse) {
        var alertPopup = $ionicPopup.alert({
          title: '(⊙﹏⊙✿)',
          template: 'Selecione pelo menos um desses!'
        });
      }else{
        console.log($scope.user.interesse,"$scope.user.interesse", $scope.user.iduser)
        var res = $scope.user.interesse.split(" ") ;
        for (var i = 0; i<res.length;i++){
          if(res[i][0]!='#'){
            res[i]= '#' + res[i];
          }
          console.log(res[i], "tags")
          var link = 'https://ec2.diwoapp.com.br/criarinteresse.php';
            $http.post(link, {iduser : $scope.user.iduser, 
                              interesse : res[i]}).then(function (res){console.log(res.success, "criou interesse")});
        }
        window.localStorage.setItem( 'user', JSON.stringify($scope.user));
        formUser.updateForm($scope.user);
        $state.go('tabsController.home');
      }


            
  };


 

}])
 

.controller('novacontafotoCtrl', ['$scope', '$stateParams', '$state', 'EventoService', '$cordovaCamera', '$cordovaFile', '$cordovaFileTransfer', '$cordovaDevice', '$ionicPopup', '$cordovaActionSheet','$ionicLoading','$http','formCodigo', 'formNovaconta','formUser', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, $state, EventoService, $cordovaCamera, $cordovaFile, $cordovaFileTransfer, $cordovaDevice, $ionicPopup, $cordovaActionSheet,$ionicLoading,$http,formCodigo, formNovaconta,formUser) {
  $scope.user = {};
  $scope.$on("$ionicView.enter", function(event, data){
    $scope.user = JSON.parse( window.localStorage.getItem( 'criandouser' ));
    //cognitoUser = formCognito.getForm();
  });
  //cognitoUser = formCognito.getForm();
  $scope.codigo = formCodigo.getForm();
  $scope.imgURI = "img/pessoasn/perfil.png";
 
    $scope.takePicture = function() {
      var optionsCamera = {
          quality : 100,
          destinationType : Camera.DestinationType.FILE_URL,
          sourceType : Camera.PictureSourceType.CAMERA,
          allowEdit : true,
          encodingType: Camera.EncodingType.JPEG,
          targetWidth: 640,
          targetHeight: 640,
          popoverOptions: CameraPopoverOptions,
          saveToPhotoAlbum: true
      };

      $cordovaCamera.getPicture(optionsCamera).then(function(imageData) {
          $scope.imgURI = imageData;
          
      }, function(err) {
      });
    }
    $scope.getPicture = function (optionsCamera) {
      var optionsCamera = {
            quality : 100,
            sourceType : 0,
            allowEdit : true,
            targetWidth: 640,
            targetHeight: 640
      };
      $cordovaCamera.getPicture(optionsCamera).then(function(imageData) {
        $scope.imgURI = imageData;
      }, function(err) {
        console.log(err);
      });
    };
    $scope.Cancela = function () {
       window.localStorage.removeItem('criandouser')
       $state.go('logando')
    };

  $scope.Proximo = function() {
    if($scope.imgURI == "img/pessoasn/perfil.png"){
      var alertPopup = $ionicPopup.alert({
        title: '(*ﾟｰﾟ)ゞ',
        template: 'Tire uma foto para as pessoas saberem quem tu é quando for conhecer elas'
      });
    }else{
      if($scope.codigo){
        EventoService.confereconvite($scope.codigo).then(function(resp) {
          var currentdate = new Date();
          currentdate.setDate(currentdate.getDate() - 14);
          var curr_date = (currentdate.getDate()<10?'0':'') + currentdate.getDate();
          var curr_month = (currentdate.getMonth()<10?'0':'') + (currentdate.getMonth() + 1); 
          var curr_year = currentdate.getFullYear();
          var h2 = (currentdate.getHours()<10?'0':'') + currentdate.getHours();
          var m2 = (currentdate.getMinutes()<10?'0':'') + currentdate.getMinutes();
          var j = curr_year + "-" + curr_month + "-" + curr_date+ ' '+h2 + ':' + m2 + ':00';
          console.log(j, resp[0].codigodatacriacao)
          if(resp[0].codigodatacriacao > j){
            resp[0].numcodigo = parseInt(resp[0].numcodigo) + 1
            console.log(resp[0].numcodigo)
            if(resp[0].numcodigo == 3){
              $http.post('https://ec2.diwoapp.com.br/gastapontospessoaevento.php', {idevento : -100,
                        iduser : resp[0].iduser,
                        borda : '0',
                        username: resp[0].username,
                        apelido : resp[0].apelido,
                        nomeevento :  "Entrou com convite", 
                        estado : 10,
                        pontos: 10});
              $scope.atualiza = {};
              var po = resp[0].pontos.valueOf()+10;
              $scope.atualiza.pontos = po;
              $scope.atualiza.iduser = resp[0].iduser;
              EventoService.atualizarpontos($scope.atualiza);
            }
            $http.post('https://ec2.diwoapp.com.br/somanumcodigo.php', {iduser : resp[0].iduser,
                                                                                  numcodigo : resp[0].numcodigo});
          }
        });
        var mystring = String($scope.user.email);
        mystring = mystring.replace(/[^a-zA-Z0-9]/g, '');
        $scope.user.profilepic = 'https://diwoappprofilepics.s3.amazonaws.com/profilepicsdiwo/' + mystring + '.jpg'; 

        EventoService.CriaConta($scope.user).then(function(result) {
          if(result.success){
            var url = "https://ec2.diwoapp.com.br/upload.php";
            // File for Upload
            var targetPath = $scope.imgURI;
           
                 // File name only
            //var name = $scope.imgURI.substr(imageData.lastIndexOf('/') + 1);
            var filename = mystring + '.jpg';

            // NO CASO SERIA O NOME DO USUARIO.jpg O fileName
            var options = {
              fileKey: "file",
              fileName: filename,
              chunkedMode: false,
              mimeType: "multipart/form-data"
            };
            $cordovaFileTransfer.upload(url, targetPath, options).then(function(result) {
              
              var alertPopup = $ionicPopup.alert({
                title: 'Parabéns',
                template: 'Você ganhou 10 Pontos e com grandes poderes vêm grandes responsabilidades! Vá ao seu Perfil para saber como ganhar +10!'
              });
              alertPopup.then(function(){
                
                  EventoService.Entrando($scope.user).then(function(data){
                    $http.post('https://ec2.diwoapp.com.br/gastapontospessoaevento.php', {idevento : -100,
                                                        iduser : data[0].iduser,
                                                        borda : '0',
                                                        username: $scope.user.username,
                                                        apelido : $scope.user.apelido,
                                                        nomeevento :  "Criou conta", 
                                                        estado : 10,
                                                        pontos: 10});
                     // CRIO TAG
                    var res = $scope.user.interesse.split(" ") ;
                    for (var i = 0; i<res.length;i++){
                      if(res[i][0]!='#'){
                        res[i]= '#' + res[i];
                      }
                      console.log(res[i], "tags")
                      var link = 'https://ec2.diwoapp.com.br/criarinteresse.php';
                        $http.post(link, {iduser : data[0].iduser, 
                                          interesse : res[i]}).then(function (res){console.log(res.success, "criou interesse")});
                    }
                    window.localStorage.setItem( 'user', JSON.stringify(data[0]));
                    window.localStorage.removeItem('criandouser')
                    formUser.updateForm(data[0]);
                    $state.go('tabsController.home');
                  })
              });
              
              $ionicLoading.hide();
            }, function(err) {
              $ionicPopup.alert({
                title: 'Sorry!',
                template: 'Aconteceu um probleminha, tente de novo'
              });
              $ionicLoading.hide();
            }, function (progress) {
              $ionicLoading.show({
                title: '┗(＾0＾)┓',
                template: 'DANCE, DANCE, DANCE!!'
              });
            });
          }
        }); 
      }else{
        var mystring = String($scope.user.email);
        mystring = mystring.replace(/[^a-zA-Z0-9]/g, '');
        $scope.user.profilepic = 'https://diwoappprofilepics.s3.amazonaws.com/profilepicsdiwo/' + mystring + '.jpg';
        
        EventoService.CriaConta($scope.user).then(function(result) {
          if(result.success){
            var url = "https://ec2.diwoapp.com.br/upload.php";
            // File for Upload
            var targetPath = $scope.imgURI;
           
            // File name only
            //var name = $scope.imgURI.substr(imageData.lastIndexOf('/') + 1);
            var filename = mystring + '.jpg';

            // NO CASO SERIA O NOME DO USUARIO.jpg O fileName
            var options = {
              fileKey: "file",
              fileName: filename,
              chunkedMode: false,
              mimeType: "multipart/form-data"
            };
            $cordovaFileTransfer.upload(url, targetPath, options).then(function(result) {
              
              var alertPopup = $ionicPopup.alert({
                title: 'Parabéns',
                template: 'Você ganhou 10 Pontos e com grandes poderes vêm grandes responsabilidades! Vá ao seu Perfil para saber como ganhar +10!'
              });
              alertPopup.then(function(){

                  EventoService.Entrando($scope.user).then(function(data){
                    $http.post('https://ec2.diwoapp.com.br/gastapontospessoaevento.php', {idevento : -100,
                                                        iduser : data[0].iduser,
                                                        borda : '0',
                                                        username: $scope.user.username,
                                                        apelido : $scope.user.apelido,
                                                        nomeevento :  "Criou conta", 
                                                        estado : 10,
                                                        pontos: 10});
                    var res = $scope.user.interesse.split(" ") ;
                    for (var i = 0; i<res.length;i++){
                      if(res[i][0]!='#'){
                        res[i]= '#' + res[i];
                      }
                      console.log(res[i], "tags")
                      var link = 'https://ec2.diwoapp.com.br/criarinteresse.php';
                        $http.post(link, {iduser : data[0].iduser, 
                                          interesse : res[i]}).then(function (res){console.log(res.success, "criou interesse")});
                    }
                    window.localStorage.setItem( 'user', JSON.stringify(data[0]));
                    window.localStorage.removeItem('criandouser');
                    formUser.updateForm(data[0]);
                    $state.go('tabsController.home');
                  })
              });
              
              $ionicLoading.hide();
            }, function(err) {
              $ionicPopup.alert({
                title: 'Sorry!',
                template: 'Aconteceu um probleminha, tente de novo'
              });
              $ionicLoading.hide();
            }, function (progress) {
              $ionicLoading.show({
                title: '┗(＾0＾)┓',
                template: 'DANCE, DANCE, DANCE!!'
              });
            });
          }
        });
      }
    }

  };

 

}])

.controller('contacomercioemailCtrl', ['$scope', '$stateParams', '$state', 'EventoService', '$cordovaCamera', '$cordovaFile', '$cordovaFileTransfer', '$cordovaDevice', '$ionicPopup', '$cordovaActionSheet','$ionicLoading','$http','formCodigo', 'formcontacomercio', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, $state, EventoService, $cordovaCamera, $cordovaFile, $cordovaFileTransfer, $cordovaDevice, $ionicPopup, $cordovaActionSheet,$ionicLoading,$http,formCodigo, formcontacomercio) {
  $scope.comercio = {};



  $scope.Proximo = function() {
     $scope.comercio.apelido = $scope.comercio.username 
     EventoService.verificaemail($scope.comercio).then(function(res) {
      if(res.success==false){
        var alertPopup = $ionicPopup.alert({
              title: 'ಠ_ಠ',
              template: 'Este email ja esta sendo utilizado'
            });
      }else{
               window.localStorage.setItem( 'criandocomercio', JSON.stringify($scope.comercio));
                      formcontacomercio.updateForm($scope.comercio);
                      $state.go('contacomerciousername');
             }
             });    

  };
  $scope.Cancela = function () {
       window.localStorage.removeItem('criandocomercio')
       $state.go('novahomesemlogin')
    };
  

}])

// .controller('contacomercioconfirmaCtrl', ['$scope', '$stateParams', '$state', 'EventoService', '$cordovaCamera', '$cordovaFile', '$cordovaFileTransfer', '$cordovaDevice', '$ionicPopup', '$cordovaActionSheet','$ionicLoading','$http','formCodigo', 'formNovaconta', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// // You can include any angular dependencies as parameters for this function
// // TIP: Access Route Parameters for your page via $stateParams.parameterName
// function ($scope, $stateParams, $state, EventoService, $cordovaCamera, $cordovaFile, $cordovaFileTransfer, $cordovaDevice, $ionicPopup, $cordovaActionSheet,$ionicLoading,$http,formCodigo, formNovaconta) {
//   $scope.comercio = {};
//   $scope.$on("$ionicView.enter", function(event, data){
//     $scope.comercio = JSON.parse(window.localStorage.getItem( 'criandocomercio' ) ); 
//     //cognitoUser = formCognito.getForm();
//   });
//   //cognitotoUser = formCognito.getForm();


  
//   $scope.Proximo = function() {

//     const poolData = {
//                     UserPoolId : 'us-east-1_nOWA67ADf', // Your user pool id here
//                     ClientId : '8k5rbqhifi5r1hb2j4n1u07li'// Your client id here
//                   };    
//     var userPool = new AmazonCognitoIdentity.CognitoUserPool(poolData);

//     var userData = {
//         Username: $scope.user.email,
//         Pool: userPool
//     };

//     var cognitoUser = new AmazonCognitoIdentity.CognitoUser(userData);
//     cognitoUser.confirmRegistration($scope.user.naws, true, function(err, result) {
//         if (err) {
//             console.log(err);
//             console.log('call result: ' + result);
//           return;
//         }

//         console.log('call result: ' + result);
//         if(result == "SUCCESS"){
//           $scope.user.confirmado = true;
//           window.localStorage.setItem( 'criandouser',  JSON.stringify($scope.user));
//           formNovaconta.updateForm($scope.user);
//           $state.go('novacontausername');
//          console.log('call result: ' + result);
//         }else{
//           console.log("dasdassdaofjnwenovn")
//           var alertPopup = $ionicPopup.alert({
//               title: 'Código de confirmação incorreto',
//               template: 'Verifique no seu email novamente o código de confirmação'
//             });
//         }
//     });


//   };

//     $scope.Reenviar = function() {

//     const poolData = {
//                     UserPoolId : 'us-east-1_nOWA67ADf', // Your user pool id here
//                     ClientId : '8k5rbqhifi5r1hb2j4n1u07li'// Your client id here
//                   };    
//     var userPool = new AmazonCognitoIdentity.CognitoUserPool(poolData);

//     var userData = {
//         Username: $scope.user.email,
//         Pool: userPool
//     };

//     var cognitoUser = new AmazonCognitoIdentity.CognitoUser(userData);


//     cognitoUser.resendConfirmationCode(function(err, result) {
//       if (err) {
//           alert(err);
//         return;
//       }
//         var alertPopup = $ionicPopup.alert({
//           title: 'Deve ter chego',
//           template: 'Foi reenviado no seu email de cadastro outro código de validação, se nao chegou ainda, chegará'
//         });
//     });
    
//   };
//   $scope.Cancela = function () {
//        window.localStorage.removeItem('criandouser')
//        $state.go('logando')
//     };
  

// }])

.controller('contacomerciousernameCtrl', ['$scope', '$stateParams', '$state', 'EventoService', '$cordovaCamera', '$cordovaFile', '$cordovaFileTransfer', '$cordovaDevice', '$ionicPopup', '$cordovaActionSheet','$ionicLoading','$http','formCodigo', 'formcontacomercio', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, $state, EventoService, $cordovaCamera, $cordovaFile, $cordovaFileTransfer, $cordovaDevice, $ionicPopup, $cordovaActionSheet,$ionicLoading,$http,formCodigo, formcontacomercio) {
  $scope.comercio = {};
  $scope.$on("$ionicView.enter", function(event, data){
    $scope.comercio = JSON.parse( window.localStorage.getItem( 'criandocomercio' ));    //cognitoUser = formCognito.getForm();
  });
  //cognitoUser = formCognito.getForm();
  
  $scope.Proximo = function() {
    $scope.comercio.username = $scope.comercio.apelido;
    console.log($scope.comercio.username ,$scope.comercio.apelido,"$scope.comercio.username")
    if($scope.comercio.username){
      EventoService.verificausername($scope.comercio).then(function(result) {
        if(result.success==false){
          var alertPopup = $ionicPopup.alert({
                  title: 'ಠ_ಠ',
                  template: 'Ja tem alguem com esse nome de usuário'
                });
        }else{
            var palavrasnaousar = ["ALIAMBA", "ANUS", "BAGULIO"
            , "BANZA", "BARRUFO", "BECK", "BEQUE", "BOCETA"
            , "BOLAGATO", "BOQUETE", "BOLCAT", "BOSSETA", "BOSTANA", "BREXA", "BRIOCO", "BRONHA", "BUCA", "BUCETA"
            , "BUSSETA", "CANABIS", "CANNABIS", "CARALHO"
            , "CASSETA", "CASSETE", "CHECHECA", "CHERECA", "CHIBUMBA", "CHIBUMBO", "CHOTA", "CHOCHOTA", "CHUPADA", "CHUPADO", "CLITORIS"
            , "COCAINA", "C+"
            , "C*", "CURALHO", "CUZAO", "CUZUDA", "CUZUDO", "CUZÃO", "ESPORRADA", "ESPORRADO", "ESPORRO", "estupro"
            , "FELACAO", "FELACÃO", "FODA", "FODAO", "FODÃO", "FODAUM", "FODE", "FODIDA", "FODIDO", "FORNICA", "FUDENDO", "FUDECÃO", "FUDECAO"
            , "FUDIDA", "FUDIDO", "GRELINHO", "GRELO", "ISCROTA", "ISCROTO", "MACONHA", "MASTURBA", "MASTURBAÇÃO", "MASTURBACÃO", "MASTURBACAO"
            , "PENIS", "PEN1S", "PENES", "PENIZ", "PICA", "PIROCA", "PIRU", "PORRA", "POURRA", "PROSTIBULO", "PUTA", "PUNHETA", "PUTO"
            , "RABAO", "TESTUDA", "TESTUDO", "VAGABUNDA", "VAGINA", "VIADO", "VIADAO", "VIADÃO", "XAVASCA", "XERERECA", "XEXECA", "XOTA"
            , "XOCHOTA", "XOXOTA", "XANA", "XANINHA", "MDMA", "VSF", "TNC", "FDP", "CRACK"];
            var error = 0; 
            for (var i = 0; i < palavrasnaousar.length; i++) {
              var res2 = $scope.comercio.username.split("_") ;
              if(res2.length>1){
                for(var w = 0; w < res2.length; w++){
                  var val = palavrasnaousar[i].toLowerCase();
                  if ((res2[w].toLowerCase()).indexOf(val.toString()) > -1) {  
                    error = error + 1;  
                  }
                }
              }else{
                var val = palavrasnaousar[i].toLowerCase();  
                if (($scope.comercio.username.toLowerCase()).indexOf(val.toString()) > -1) {  
                  error = error + 1;  
                }
              }   
            } 
            if (error > 0) {  
                var alertPopup = $ionicPopup.alert({
                      title: '（・о・；）',
                      template: 'Que boquinha suja eim, usaste uma palavra inapropriada né'
                    }); 
            }else{
                window.localStorage.setItem( 'criandocomercio',  JSON.stringify($scope.comercio));
                formcontacomercio.updateForm($scope.comercio);
                $state.go('contacomerciotelefone');
            }
        }
      });
    }else{
       var alertPopup = $ionicPopup.alert({
                  title: 'ಠ_ಠ',
                  template: 'Digite um nome por favor'
                });
    }
  

  };
  $scope.Cancela = function () {
       window.localStorage.removeItem('criandocomercio')
       $state.go('novahomesemlogin')
    };
  

}])
.controller('contacomerciotelefoneCtrl', ['$scope', '$stateParams', '$state', 'EventoService', '$cordovaCamera', '$cordovaFile', '$cordovaFileTransfer', '$cordovaDevice', '$ionicPopup', '$cordovaActionSheet','$ionicLoading','$http','formCodigo', 'formcontacomercio', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, $state, EventoService, $cordovaCamera, $cordovaFile, $cordovaFileTransfer, $cordovaDevice, $ionicPopup, $cordovaActionSheet,$ionicLoading,$http,formCodigo, formcontacomercio) {
  $scope.comercio = {};
  $scope.$on("$ionicView.enter", function(event, data){
    $scope.comercio = JSON.parse( window.localStorage.getItem( 'criandocomercio' ));    //cognitoUser = formCognito.getForm();
    
  });
  //cognitoUser = formCognito.getForm();
  
  $scope.Proximo = function() {
    if($scope.comercio.telefone){
      window.localStorage.setItem( 'criandocomercio',  JSON.stringify($scope.comercio));
      formcontacomercio.updateForm($scope.comercio);
      $state.go('contacomercioatendimento');
    }else{
       var alertPopup = $ionicPopup.alert({
                  title: 'Alooo!',
                  template: 'Digite um número de telefone por favor, precisamos dele para validar sua conta'
                });
    }
   

  };
  $scope.Cancela = function () {
       window.localStorage.removeItem('criandocomercio')
       $state.go('novahomesemlogin')
    };
  

}])

.controller('contacomercioatendimentoCtrl', ['$scope', '$stateParams', '$state', 'EventoService', '$cordovaCamera', '$cordovaFile', '$cordovaFileTransfer', '$cordovaDevice', '$ionicPopup', '$cordovaActionSheet','$ionicLoading','$http','formCodigo', 'formcontacomercio', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, $state, EventoService, $cordovaCamera, $cordovaFile, $cordovaFileTransfer, $cordovaDevice, $ionicPopup, $cordovaActionSheet,$ionicLoading,$http,formCodigo, formcontacomercio) {

 $scope.comercio = {};

  $scope.$on("$ionicView.enter", function(event, data){
    $scope.comercio = {};
    $scope.comercio = JSON.parse( window.localStorage.getItem( 'criandocomercio' ));
    console.log($scope.comercio.apelido)
    $scope.auxtagbutton1 = true;
    $scope.auxtagbutton2 = true;
    $scope.auxtagbutton3 = true;
    $scope.auxtagbutton4 = true;
    $scope.auxtagbutton5 = true;
    $scope.auxtagbutton6 = true;
    $scope.auxtagbutton7 = true;
    $scope.auxtagbutton8 = true;
    $scope.auxtagbutton9 = true;
    $scope.auxtagbutton10 = true;
    $scope.auxtagbutton11 = true;
    $scope.auxtagbutton12 = true;
    $scope.auxtagbutton13 = true;
    $scope.auxtagbutton14 = true;
    $scope.auxtagbutton15 = true;
    $scope.auxtagbutton16 = true;
    $scope.auxtagbutton17 = true;
    $scope.auxtagbutton18 = true;
    $scope.auxtagbutton19 = true;
    $scope.auxtagbutton20 = true;
    $scope.auxtagbutton21 = true;
    $scope.auxtagbutton22 = true;
    $scope.auxtagbutton23 = true;
    $scope.auxtagbutton24 = true;

    $scope.auxsemanabutton1 = true;
    $scope.auxsemanabutton2 = true;
    $scope.auxsemanabutton3 = true;
    $scope.auxsemanabutton4 = true;
    $scope.auxsemanabutton5 = true;
    $scope.auxsemanabutton6 = true;
    $scope.auxsemanabutton7 = true;

    $scope.auxtagbutton1aux = false;
    $scope.auxtagbutton2aux = false;
    $scope.auxtagbutton3aux = false;
    $scope.auxtagbutton4aux = false;
    $scope.auxtagbutton5aux = false;
    $scope.auxtagbutton6aux = false;
    $scope.auxtagbutton7aux = false;
    $scope.auxtagbutton8aux = false;
    $scope.auxtagbutton9aux = false;
    $scope.auxtagbutton10aux = false;
    $scope.auxtagbutton11aux = false;
    $scope.auxtagbutton12aux = false;
    $scope.auxtagbutton13aux = false;
    $scope.auxtagbutton14aux = false;
    $scope.auxtagbutton15aux = false;
    $scope.auxtagbutton16aux = false;
    $scope.auxtagbutton17aux = false;
    $scope.auxtagbutton18aux = false;
    $scope.auxtagbutton19aux = false;
    $scope.auxtagbutton20aux = false;
    $scope.auxtagbutton21aux = false;
    $scope.auxtagbutton22aux = false;
    $scope.auxtagbutton23aux = false;
    $scope.auxtagbutton24aux = false;

    $scope.auxsemanabutton1aux = false;
    $scope.auxsemanabutton2aux = false;
    $scope.auxsemanabutton3aux = false;
    $scope.auxsemanabutton4aux = false;
    $scope.auxsemanabutton5aux = false;
    $scope.auxsemanabutton6aux = false;
    $scope.auxsemanabutton7aux = false;

    $scope.comercio.auxtag1 = '00:00';
    $scope.comercio.auxtag2 = '01:00'; 
    $scope.comercio.auxtag3 = '02:00'; 
    $scope.comercio.auxtag4 = '03:00'; 
    $scope.comercio.auxtag5 = '04:00';  
    $scope.comercio.auxtag6 = '05:00'; 
    $scope.comercio.auxtag7 = '06:00'; 
    $scope.comercio.auxtag8 = '07:00'; 
    $scope.comercio.auxtag9 = '08:00'; 
    $scope.comercio.auxtag10 = '09:00'; 
    $scope.comercio.auxtag11 = '10:00'; 
    $scope.comercio.auxtag12 = '11:00'; 
    $scope.comercio.auxtag13 = '12:00'; 
    $scope.comercio.auxtag14 = '13:00'; 
    $scope.comercio.auxtag15 = '14:00'; 
    $scope.comercio.auxtag16 = '15:00'; 
    $scope.comercio.auxtag17 = '16:00'; 
    $scope.comercio.auxtag18 = '17:00';
    $scope.comercio.auxtag19 = '18:00'; 
    $scope.comercio.auxtag20 = '19:00'; 
    $scope.comercio.auxtag21 = '20:00'; 
    $scope.comercio.auxtag22 = '21:00'; 
    $scope.comercio.auxtag23 = '22:00'; 
    $scope.comercio.auxtag24 = '23:00'; 

    $scope.comercio.auxsemana1 = 'Dom';
    $scope.comercio.auxsemana2 = 'Seg'; 
    $scope.comercio.auxsemana3 = 'Ter'; 
    $scope.comercio.auxsemana4 = 'Qua'; 
    $scope.comercio.auxsemana5 = 'Qui';  
    $scope.comercio.auxsemana6 = 'Sex'; 
    $scope.comercio.auxsemana7 = 'Sab';

  });
    $scope.tiratag1 = function(){
        if($scope.auxtagbutton1){
          $scope.auxtagbutton1 = false;
          $scope.auxtagbutton1aux = true;
        }else{
          $scope.auxtagbutton1 = true;
          $scope.auxtagbutton1aux = false;
        }
    }
    $scope.tiratag2 = function(){
        if($scope.auxtagbutton2){
          $scope.auxtagbutton2 = false;
          $scope.auxtagbutton2aux = true;
        }else{
          $scope.auxtagbutton2 = true;
          $scope.auxtagbutton2aux = false;
        }
    }
    $scope.tiratag3 = function(){
        if($scope.auxtagbutton3){
          $scope.auxtagbutton3 = false;
          $scope.auxtagbutton3aux = true;
        }else{
          $scope.auxtagbutton3 = true;
          $scope.auxtagbutton3aux = false;
        }
    }
    $scope.tiratag4 = function(){
        if($scope.auxtagbutton4){
          $scope.auxtagbutton4 = false;
          $scope.auxtagbutton4aux = true;
        }else{
          $scope.auxtagbutton4 = true;
          $scope.auxtagbutton4aux = false;
        }
    }
    $scope.tiratag5 = function(){
        if($scope.auxtagbutton5){
          $scope.auxtagbutton5 = false;
          $scope.auxtagbutton5aux = true;
        }else{
          $scope.auxtagbutton5 = true;
          $scope.auxtagbutton5aux = false;
        }
    }
    $scope.tiratag6 = function(){
        if($scope.auxtagbutton6){
          $scope.auxtagbutton6 = false;
          $scope.auxtagbutton6aux = true;
        }else{
          $scope.auxtagbutton6 = true;
          $scope.auxtagbutton6aux = false;
        }
    }

    $scope.tiratag7 = function(){
        if($scope.auxtagbutton7){
          $scope.auxtagbutton7 = false;
          $scope.auxtagbutton7aux = true;
        }else{
          $scope.auxtagbutton7 = true;
          $scope.auxtagbutton7aux = false;
        }
    }
    $scope.tiratag8 = function(){
        if($scope.auxtagbutton8){
          $scope.auxtagbutton8 = false;
          $scope.auxtagbutton8aux = true;
        }else{
          $scope.auxtagbutton8 = true;
          $scope.auxtagbutton8aux = false;
        }
    }
    $scope.tiratag9 = function(){
        if($scope.auxtagbutton9){
          $scope.auxtagbutton9 = false;
          $scope.auxtagbutton9aux = true;
        }else{
          $scope.auxtagbutton9 = true;
          $scope.auxtagbutton9aux = false;
        }
    }
    $scope.tiratag10 = function(){
        if($scope.auxtagbutton10){
          $scope.auxtagbutton10 = false;
          $scope.auxtagbutton10aux = true;
        }else{
          $scope.auxtagbutton10 = true;
          $scope.auxtagbutton10aux = false;
        }
    }
    $scope.tiratag11 = function(){
        if($scope.auxtagbutton11){
          $scope.auxtagbutton11 = false;
          $scope.auxtagbutton11aux = true;
        }else{
          $scope.auxtagbutton11 = true;
          $scope.auxtagbutton11aux = false;
        }
    }
    $scope.tiratag12 = function(){
        if($scope.auxtagbutton12){
          $scope.auxtagbutton12 = false;
          $scope.auxtagbutton12aux = true;
        }else{
          $scope.auxtagbutton12 = true;
          $scope.auxtagbutton12aux = false;
        }
    }
    $scope.tiratag13 = function(){
        if($scope.auxtagbutton13){
          $scope.auxtagbutton13 = false;
          $scope.auxtagbutton13aux = true;
        }else{
          $scope.auxtagbutton13 = true;
          $scope.auxtagbutton13aux = false;
        }
    }
    $scope.tiratag14 = function(){
        if($scope.auxtagbutton14){
          $scope.auxtagbutton14 = false;
          $scope.auxtagbutton14aux = true;
        }else{
          $scope.auxtagbutton14 = true;
          $scope.auxtagbutton14aux = false;
        }
    }
    $scope.tiratag15 = function(){
        if($scope.auxtagbutton15){
          $scope.auxtagbutton15 = false;
          $scope.auxtagbutton15aux = true;
        }else{
          $scope.auxtagbutton15 = true;
          $scope.auxtagbutton15aux = false;
        }
    }
    $scope.tiratag16 = function(){
        if($scope.auxtagbutton16){
          $scope.auxtagbutton16 = false;
          $scope.auxtagbutton16aux = true;
        }else{
          $scope.auxtagbutton16 = true;
          $scope.auxtagbutton16aux = false;
        }
    }
    $scope.tiratag17 = function(){
        if($scope.auxtagbutton17){
          $scope.auxtagbutton17 = false;
          $scope.auxtagbutton17aux = true;
        }else{
          $scope.auxtagbutton17 = true;
          $scope.auxtagbutton17aux = false;
        }
    }
    $scope.tiratag18 = function(){
        if($scope.auxtagbutton18){
          $scope.auxtagbutton18 = false;
          $scope.auxtagbutton18aux = true;
        }else{
          $scope.auxtagbutton18 = true;
          $scope.auxtagbutton18aux = false;
        }
    }
    $scope.tiratag19 = function(){
        if($scope.auxtagbutton19){
          $scope.auxtagbutton19 = false;
          $scope.auxtagbutton19aux = true;
        }else{
          $scope.auxtagbutton19 = true;
          $scope.auxtagbutton19aux = false;
        }
    }
    $scope.tiratag20 = function(){
        if($scope.auxtagbutton20){
          $scope.auxtagbutton20 = false;
          $scope.auxtagbutton20aux = true;
        }else{
          $scope.auxtagbutton20 = true;
          $scope.auxtagbutton20aux = false;
        }
    }
    $scope.tiratag21 = function(){
        if($scope.auxtagbutton21){
          $scope.auxtagbutton21 = false;
          $scope.auxtagbutton21aux = true;
        }else{
          $scope.auxtagbutton21 = true;
          $scope.auxtagbutton21aux = false;
        }
    }
    $scope.tiratag22 = function(){
        if($scope.auxtagbutton22){
          $scope.auxtagbutton22 = false;
          $scope.auxtagbutton22aux = true;
        }else{
          $scope.auxtagbutton22 = true;
          $scope.auxtagbutton22aux = false;
        }
    }
    $scope.tiratag23 = function(){
        if($scope.auxtagbutton23){
          $scope.auxtagbutton23 = false;
          $scope.auxtagbutton23aux = true;
        }else{
          $scope.auxtagbutton23 = true;
          $scope.auxtagbutton23aux = false;
        }
    }
    $scope.tiratag24 = function(){
        if($scope.auxtagbutton24){
          $scope.auxtagbutton24 = false;
          $scope.auxtagbutton24aux = true;
        }else{
          $scope.auxtagbutton24 = true;
          $scope.auxtagbutton24aux = false;
        }
    }


    $scope.tirasemana1 = function(){
        if($scope.auxsemanabutton1){
          $scope.auxsemanabutton1 = false;
          $scope.auxsemanabutton1aux = true;
        }else{
          $scope.auxsemanabutton1 = true;
          $scope.auxsemanabutton1aux = false;
        }
    }
    $scope.tirasemana2 = function(){
        if($scope.auxsemanabutton2){
          $scope.auxsemanabutton2 = false;
          $scope.auxsemanabutton2aux = true;
        }else{
          $scope.auxsemanabutton2 = true;
          $scope.auxsemanabutton2aux = false;
        }
    }
    $scope.tirasemana3 = function(){
        if($scope.auxsemanabutton3){
          $scope.auxsemanabutton3 = false;
          $scope.auxsemanabutton3aux = true;
        }else{
          $scope.auxsemanabutton3 = true;
          $scope.auxsemanabutton3aux = false;
        }
    }
    $scope.tirasemana4 = function(){
        if($scope.auxsemanabutton4){
          $scope.auxsemanabutton4 = false;
          $scope.auxsemanabutton4aux = true;
        }else{
          $scope.auxsemanabutton4 = true;
          $scope.auxsemanabutton4aux = false;
        }
    }
    $scope.tirasemana5 = function(){
        if($scope.auxsemanabutton5){
          $scope.auxsemanabutton5 = false;
          $scope.auxsemanabutton5aux = true;
        }else{
          $scope.auxsemanabutton5 = true;
          $scope.auxsemanabutton5aux = false;
        }
    }
    $scope.tirasemana6 = function(){
        if($scope.auxsemanabutton6){
          $scope.auxsemanabutton6 = false;
          $scope.auxsemanabutton6aux = true;
        }else{
          $scope.auxsemanabutton6 = true;
          $scope.auxsemanabutton6aux = false;
        }
    }

    $scope.tirasemana7 = function(){
        if($scope.auxsemanabutton7){
          $scope.auxsemanabutton7 = false;
          $scope.auxsemanabutton7aux = true;
        }else{
          $scope.auxsemanabutton7 = true;
          $scope.auxsemanabutton7aux = false;
        }
    }

    
  $scope.Proximo = function() {
  delete $scope.comercio.horariofuncionamento
  delete $scope.comercio.semanafuncionamento
      if($scope.auxtagbutton1 == false){
        if ($scope.comercio.horariofuncionamento == undefined) {
          $scope.comercio.horariofuncionamento = $scope.comercio.auxtag1;
        }else{
          $scope.comercio.horariofuncionamento = $scope.comercio.horariofuncionamento + ' ' +$scope.comercio.auxtag1;
        }
      }
      if($scope.auxtagbutton2 == false){
        if ($scope.comercio.horariofuncionamento == undefined) {
          $scope.comercio.horariofuncionamento = $scope.comercio.auxtag2;
        }else{
          $scope.comercio.horariofuncionamento = $scope.comercio.horariofuncionamento + ' ' +$scope.comercio.auxtag2;
        }
      }
      if($scope.auxtagbutton3 == false){
        if ($scope.comercio.horariofuncionamento == undefined) {
          $scope.comercio.horariofuncionamento = $scope.comercio.auxtag3;
        }else{
          $scope.comercio.horariofuncionamento = $scope.comercio.horariofuncionamento + ' ' +$scope.comercio.auxtag3;
        }
      }
      if($scope.auxtagbutton4 == false){
        if ($scope.comercio.horariofuncionamento == undefined) {
          $scope.comercio.horariofuncionamento = $scope.comercio.auxtag4;
        }else{
          $scope.comercio.horariofuncionamento = $scope.comercio.horariofuncionamento + ' ' +$scope.comercio.auxtag4;
        }
      }
      if($scope.auxtagbutton5 == false){
        if ($scope.comercio.horariofuncionamento == undefined) {
          $scope.comercio.horariofuncionamento = $scope.comercio.auxtag5;
        }else{
          $scope.comercio.horariofuncionamento = $scope.comercio.horariofuncionamento + ' ' +$scope.comercio.auxtag5;
        }
      }
      if($scope.auxtagbutton6 == false){
        if ($scope.comercio.horariofuncionamento == undefined) {
          $scope.comercio.horariofuncionamento = $scope.comercio.auxtag6;
        }else{
          $scope.comercio.horariofuncionamento = $scope.comercio.horariofuncionamento + ' ' +$scope.comercio.auxtag6;
        }
      }
      if($scope.auxtagbutton7 == false){
        if ($scope.comercio.horariofuncionamento == undefined) {
          $scope.comercio.horariofuncionamento = $scope.comercio.auxtag7;
        }else{
          $scope.comercio.horariofuncionamento = $scope.comercio.horariofuncionamento + ' ' +$scope.comercio.auxtag7;
        }
      }
      if($scope.auxtagbutton8 == false){
        if ($scope.comercio.horariofuncionamento == undefined) {
          $scope.comercio.horariofuncionamento = $scope.comercio.auxtag8;
        }else{
          $scope.comercio.horariofuncionamento = $scope.comercio.horariofuncionamento + ' ' +$scope.comercio.auxtag8;
        }
      }
      if($scope.auxtagbutton9 == false){
        if ($scope.comercio.horariofuncionamento == undefined) {
          $scope.comercio.horariofuncionamento = $scope.comercio.auxtag9;
        }else{
          $scope.comercio.horariofuncionamento = $scope.comercio.horariofuncionamento + ' ' +$scope.comercio.auxtag9;
        }
      }
      if($scope.auxtagbutton10 == false){
        if ($scope.comercio.horariofuncionamento == undefined) {
          $scope.comercio.horariofuncionamento = $scope.comercio.auxtag10;
        }else{
          $scope.comercio.horariofuncionamento = $scope.comercio.horariofuncionamento + ' ' +$scope.comercio.auxtag10;
        }
      }
      if($scope.auxtagbutton11 == false){
        if ($scope.comercio.horariofuncionamento == undefined) {
          $scope.comercio.horariofuncionamento = $scope.comercio.auxtag11;
        }else{
          $scope.comercio.horariofuncionamento = $scope.comercio.horariofuncionamento + ' ' +$scope.comercio.auxtag11;
        }
      }
      if($scope.auxtagbutton12 == false){
        if ($scope.comercio.horariofuncionamento == undefined) {
          $scope.comercio.horariofuncionamento = $scope.comercio.auxtag12;
        }else{
          $scope.comercio.horariofuncionamento = $scope.comercio.horariofuncionamento + ' ' +$scope.comercio.auxtag12;
        }
      }
      if($scope.auxtagbutton13 == false){
        if ($scope.comercio.horariofuncionamento == undefined) {
          $scope.comercio.horariofuncionamento = $scope.comercio.auxtag13;
        }else{
          $scope.comercio.horariofuncionamento = $scope.comercio.horariofuncionamento + ' ' +$scope.comercio.auxtag13;
        }
      }
      if($scope.auxtagbutton14 == false){
        if ($scope.comercio.horariofuncionamento == undefined) {
          $scope.comercio.horariofuncionamento = $scope.comercio.auxtag14;
        }else{
          $scope.comercio.horariofuncionamento = $scope.comercio.horariofuncionamento + ' ' +$scope.comercio.auxtag14;
        }
      }
      if($scope.auxtagbutton15 == false){
        if ($scope.comercio.horariofuncionamento == undefined) {
          $scope.comercio.horariofuncionamento = $scope.comercio.auxtag15;
        }else{
          $scope.comercio.horariofuncionamento = $scope.comercio.horariofuncionamento + ' ' +$scope.comercio.auxtag15;
        }
      }
      if($scope.auxtagbutton16 == false){
        if ($scope.comercio.horariofuncionamento == undefined) {
          $scope.comercio.horariofuncionamento = $scope.comercio.auxtag16;
        }else{
          $scope.comercio.horariofuncionamento = $scope.comercio.horariofuncionamento + ' ' +$scope.comercio.auxtag16;
        }
      }
      if($scope.auxtagbutton17 == false){
        if ($scope.comercio.horariofuncionamento == undefined) {
          $scope.comercio.horariofuncionamento = $scope.comercio.auxtag17;
        }else{
          $scope.comercio.horariofuncionamento = $scope.comercio.horariofuncionamento + ' ' +$scope.comercio.auxtag17;
        }
      }
      if($scope.auxtagbutton18 == false){
        if ($scope.comercio.horariofuncionamento == undefined) {
          $scope.comercio.horariofuncionamento = $scope.comercio.auxtag18;
        }else{
          $scope.comercio.horariofuncionamento = $scope.comercio.horariofuncionamento + ' ' +$scope.comercio.auxtag18;
        }
      }
      if($scope.auxtagbutton19 == false){
        if ($scope.comercio.horariofuncionamento == undefined) {
          $scope.comercio.horariofuncionamento = $scope.comercio.auxtag19;
        }else{
          $scope.comercio.horariofuncionamento = $scope.comercio.horariofuncionamento + ' ' +$scope.comercio.auxtag19;
        }
      }
      if($scope.auxtagbutton20 == false){
        if ($scope.comercio.horariofuncionamento == undefined) {
          $scope.comercio.horariofuncionamento = $scope.comercio.auxtag20;
        }else{
          $scope.comercio.horariofuncionamento = $scope.comercio.horariofuncionamento + ' ' +$scope.comercio.auxtag20;
        }
      }
      if($scope.auxtagbutton21 == false){
        if ($scope.comercio.horariofuncionamento == undefined) {
          $scope.comercio.horariofuncionamento = $scope.comercio.auxtag21;
        }else{
          $scope.comercio.horariofuncionamento = $scope.comercio.horariofuncionamento + ' ' +$scope.comercio.auxtag21;
        }
      }
      if($scope.auxtagbutton22 == false){
        if ($scope.comercio.horariofuncionamento == undefined) {
          $scope.comercio.horariofuncionamento = $scope.comercio.auxtag22;
        }else{
          $scope.comercio.horariofuncionamento = $scope.comercio.horariofuncionamento + ' ' +$scope.comercio.auxtag22;
        }
      }
      if($scope.auxtagbutton23 == false){
        if ($scope.comercio.horariofuncionamento == undefined) {
          $scope.comercio.horariofuncionamento = $scope.comercio.auxtag23;
        }else{
          $scope.comercio.horariofuncionamento = $scope.comercio.horariofuncionamento + ' ' +$scope.comercio.auxtag23;
        }
      }
      if($scope.auxtagbutton24 == false){
        if ($scope.comercio.horariofuncionamento == undefined) {
          $scope.comercio.horariofuncionamento = $scope.comercio.auxtag24;
        }else{
          $scope.comercio.horariofuncionamento = $scope.comercio.horariofuncionamento + ' ' +$scope.comercio.auxtag24;
        }
      }


      if($scope.auxsemanabutton1 == false){
        if ($scope.comercio.semanafuncionamento == undefined) {
          $scope.comercio.semanafuncionamento = $scope.comercio.auxsemana1;
        }else{
          $scope.comercio.semanafuncionamento = $scope.comercio.semanafuncionamento + ' ' +$scope.comercio.auxsemana1;
        }
      }
      if($scope.auxsemanabutton2 == false){
        if ($scope.comercio.semanafuncionamento == undefined) {
          $scope.comercio.semanafuncionamento = $scope.comercio.auxsemana2;
        }else{
          $scope.comercio.semanafuncionamento = $scope.comercio.semanafuncionamento + ' ' +$scope.comercio.auxsemana2;
        }
      }
      if($scope.auxsemanabutton3 == false){
        if ($scope.comercio.semanafuncionamento == undefined) {
          $scope.comercio.semanafuncionamento = $scope.comercio.auxsemana3;
        }else{
          $scope.comercio.semanafuncionamento = $scope.comercio.semanafuncionamento + ' ' +$scope.comercio.auxsemana3;
        }
      }
      if($scope.auxsemanabutton4 == false){
        if ($scope.comercio.semanafuncionamento == undefined) {
          $scope.comercio.semanafuncionamento = $scope.comercio.auxsemana4;
        }else{
          $scope.comercio.semanafuncionamento = $scope.comercio.semanafuncionamento + ' ' +$scope.comercio.auxsemana4;
        }
      }
      if($scope.auxsemanabutton5 == false){
        if ($scope.comercio.semanafuncionamento == undefined) {
          $scope.comercio.semanafuncionamento = $scope.comercio.auxsemana5;
        }else{
          $scope.comercio.semanafuncionamento = $scope.comercio.semanafuncionamento + ' ' +$scope.comercio.auxsemana5;
        }
      }
      if($scope.auxsemanabutton6 == false){
        if ($scope.comercio.semanafuncionamento == undefined) {
          $scope.comercio.semanafuncionamento = $scope.comercio.auxsemana6;
        }else{
          $scope.comercio.semanafuncionamento = $scope.comercio.semanafuncionamento + ' ' +$scope.comercio.auxsemana6;
        }
      }
      if($scope.auxsemanabutton7 == false){
        if ($scope.comercio.semanafuncionamento == undefined) {
          $scope.comercio.semanafuncionamento = $scope.comercio.auxsemana;
        }else{
          $scope.comercio.semanafuncionamento = $scope.comercio.semanafuncionamento + ' ' +$scope.comercio.auxsemana7;
        }
      }


      // if (!$scope.comercio.horariofuncionamento && !$scope.comercio.semanafuncionamento) {
      //   var alertPopup = $ionicPopup.alert({
      //     title: '(⊙﹏⊙✿)',
      //     template: 'Selecione pelo menos um desses!'
      //   });
      // }else{
        window.localStorage.setItem( 'criandocomercio', JSON.stringify($scope.comercio));
        formcontacomercio.updateForm($scope.comercio);
        $state.go('contacomercioduracao');
      //}


            
  };
  $scope.Cancela = function () {
       window.localStorage.removeItem('criandocomercio')
       $state.go('novahomesemlogin')
    };



}])


.controller('contacomercioduracaoCtrl', ['$scope', '$stateParams', '$state', 'EventoService', '$cordovaCamera', '$cordovaFile', '$cordovaFileTransfer', '$cordovaDevice', '$ionicPopup', '$cordovaActionSheet','$ionicLoading','$http','formCodigo', 'formcontacomercio', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, $state, EventoService, $cordovaCamera, $cordovaFile, $cordovaFileTransfer, $cordovaDevice, $ionicPopup, $cordovaActionSheet,$ionicLoading,$http,formCodigo, formcontacomercio) {
  $scope.comercio = {};
  $scope.$on("$ionicView.enter", function(event, data){
    $scope.comercio = JSON.parse( window.localStorage.getItem( 'criandocomercio' ));
    //cognitoUser = formCognito.getForm();
    console.log($scope.comercio.apelido)
  });
  $scope.Proximo = function() {

    if($scope.comercio.duracao){
      window.localStorage.setItem( 'criandocomercio',  JSON.stringify($scope.comercio));
      formcontacomercio.updateForm($scope.comercio);
      $state.go('contacomerciolocal');
    }
    else{
       var alertPopup = $ionicPopup.alert({
                  title: 'ಠ_ಠ',
                  template: 'Digite quanto tempo demora em média'
                });
    }
  }

  $scope.Cancela = function () {
       window.localStorage.removeItem('criandocomercio')
       $state.go('novahomesemlogin')
    };
}])

.controller('contacomerciolocalCtrl', ['$scope', '$stateParams', 'formUser', 'formLoc', 'EventoService', 'formAux', '$state','$timeout', '$ionicPopup', '$http', 'formOutro', 'formItem', 'formtela', 'formtelanoti', '$cordovaGeolocation','formEventoAbertosTab', '$ionicTabsDelegate', 'formcontacomercio',// The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, formUser, formLoc, EventoService, formAux, $state, $timeout, $ionicPopup, $http, formOutro, formItem, formtela, formtelanoti, $cordovaGeolocation, formEventoAbertosTab, $ionicTabsDelegate, formcontacomercio) {
  
  $scope.comercio = {};
  $scope.comercio = formcontacomercio.getForm();
  $scope.comercio.nomelocal = 'Casa do Igor';
  $scope.comercio.endereco = 'Secreto';
  $scope.comercio.cidade = 'Balneário Camboriú';
  $scope.comercio.lat = -26.9829029;
  $scope.comercio.lng = -48.6340998;
  $scope.centerPoint={};
  $scope.LimiteFuncionamentoDiwo = false;
  $scope.disableTap = function(){
     container = document.getElementsByClassName('pac-container');
     // disable ionic data tab
     angular.element(container).attr('data-tap-disabled', 'true');
     // leave input field if google-address-entry is selected
     angular.element(container).on("click", function(){
                                   document.getElementById('pac-input').blur();
                                   });
     };

  $scope.$on("$ionicView.enter", function(event, data){
    $scope.comercio = formcontacomercio.getForm();
    $scope.centerPoint={};
    $scope.LimiteFuncionamentoDiwo = false;
    console.log($scope.comercio.apelido)
    if(!$scope.comercio.lat){
         navigator.geolocation.getCurrentPosition(function(position){
            var lat  = position.coords.latitude;
            var long = position.coords.longitude;
            var myLatlng = new google.maps.LatLng(lat, long);
            var mapOptions = {
                center: myLatlng,
                zoom: 16,
                mapTypeId: google.maps.MapTypeId.ROADMAP
            };          
            var map = new google.maps.Map(document.getElementById("map_canvas"), mapOptions); 
            var marker = new google.maps.Marker({
                      position: new google.maps.LatLng(position.coords.latitude, position.coords.longitude),
                      map: map,
                      title: "Borai",
                      draggable: true,
                      icon: 'http://maps.google.com/mapfiles/ms/icons/green-dot.png',
                      animation: google.maps.Animation.DROP 
                  })

            var geocoder = new google.maps.Geocoder;
            var infowindow = new google.maps.InfoWindow({maxWidth: 200});

            geocoder.geocode({'location': myLatlng}, function(results, status) {
                  if (status === 'OK') {
                    if (results[1]) {
                      $scope.comercio.nomelocal = results[0].address_components[0].long_name;
                      $scope.comercio.endereco = results[0].formatted_address;
                      for(var i = 0;i<results[0].address_components.length;i++){
                        if(results[0].address_components[i].types[0] == "administrative_area_level_2"){
                          $scope.comercio.cidade = results[0].address_components[i].long_name;
                          console.log($scope.evento.cidade)
                        }
                      }
                      //$scope.evento.cidade = results[0].address_components[4].long_name;
                      $scope.comercio.lat = position.coords.latitude;
                      $scope.comercio.lng = position.coords.longitude;
                      $scope.centerPoint.lat = -26.997799;
                      $scope.centerPoint.lng = -48.632733; 
                      // $scope.centerPoint.lat = -25.473466587692343;
                      // $scope.centerPoint.lng = -49.29164589792566;
                      $scope.centerPointKM = 30;
                      $scope.LimiteFuncionamentoDiwo = arePointsNear($scope.comercio, $scope.centerPoint,$scope.centerPointKM );
                      // $scope.centerPointKMFB = 2500;
                      // $scope.centerPointFB.lat = 39.1882887948499;
                      // $scope.centerPointFB.lng = -100.07746794288232;
                      // $scope.LimiteFuncionamentoDiwoFB = arePointsNear($scope.user, $scope.centerPointFB,$scope.centerPointKMFB );
                      
                      // if($scope.LimiteFuncionamentoDiwoFB){
                      //   $scope.LimiteFuncionamentoDiwo = true;
                      // }
                      infowindow.setContent(results[0].formatted_address);
                      console.log($scope.comercio.endereco);
                      console.log($scope.comercio.cidade);
                      console.log($scope.comercio.lng);
                      console.log($scope.comercio.lat);
                      //infowindow.setContent(results[0].address_components[2].long_name);
                      infowindow.open(map, marker);
                      setTimeout(function () { infowindow.close(); }, 5000);
                    } else {
                      window.alert('No results found');
                    }
                  } else {
                    window.alert('Geocoder failed due to: ' + status);
                  }
                });


            google.maps.event.addListener(marker, "dragstart", function (event) {
               marker.setAnimation(3); // raise
            });

            google.maps.event.addListener(marker, "dragend", function (event) {
               marker.setAnimation(4); // raise
            });

            marker.addListener('dragend', handleEvent);

            google.maps.event.addListener(map, 'click', function(e) {
                
                markers.forEach(function(marker) {
                marker.setMap(null);
                });
                markers = [];

                placeMarker(e.latLng, map, marker);

            });

            function placeMarker(latlng, map, marker) {
                marker.setPosition(latlng);
                marker.setMap(map);
                map.panTo(latlng);
                $scope.comercio.lat = latlng.lat();
                $scope.comercio.lng = latlng.lng();

                $scope.centerPoint.lat = -26.997799;
                $scope.centerPoint.lng = -48.632733; 
                // $scope.centerPoint.lat = -25.473466587692343;
                // $scope.centerPoint.lng = -49.29164589792566;
                $scope.centerPointKM = 30;
                $scope.LimiteFuncionamentoDiwo = arePointsNear($scope.comercio, $scope.centerPoint,$scope.centerPointKM );
                      // $scope.centerPointKMFB = 2500;
                      // $scope.centerPointFB.lat = 39.1882887948499;
                      // $scope.centerPointFB.lng = -100.07746794288232;
                      // $scope.LimiteFuncionamentoDiwoFB = arePointsNear($scope.user, $scope.centerPointFB,$scope.centerPointKMFB );
                      
                      // if($scope.LimiteFuncionamentoDiwoFB){
                      //   $scope.LimiteFuncionamentoDiwo = true;
                      // }
                geocoder.geocode({'location': latlng}, function(results, status) {
                  if (status === 'OK') {
                    if (results[1]) {
                      $scope.comercio.nomelocal = results[0].address_components[0].long_name;
                      for(var i = 0;i<results[0].address_components.length;i++){
                        if(results[0].address_components[i].types[0] == "administrative_area_level_2"){
                          $scope.comercio.cidade = results[0].address_components[i].long_name;
                          console.log($scope.comercio.cidade)
                        }
                      }
                      //$scope.comercio.cidade = results[0].address_components[4].long_name;
                      $scope.comercio.endereco = results[0].formatted_address;
                      console.log($scope.comercio.endereco);
                      console.log($scope.comercio.cidade);
                      console.log($scope.comercio.lng);
                      console.log($scope.comercio.lat);
                      infowindow.setContent(results[0].formatted_address);
                     
                      infowindow.open(map, marker);
                      setTimeout(function () { infowindow.close(); }, 5000);
                    } else {
                      window.alert('No results found');
                    }
                  } else {
                    window.alert('Geocoder failed due to: ' + status);
                  }
                });
            };

            function arePointsNear(checkPoint, centerPoint, km) {
                  var ky = 40000 / 360;
                  var kx = Math.cos(Math.PI * centerPoint.lat / 180.0) * ky;
                  var dx = Math.abs(centerPoint.lng - $scope.comercio.lng) * kx;
                  var dy = Math.abs(centerPoint.lat - $scope.comercio.lat) * ky;
                  return Math.sqrt(dx * dx + dy * dy) <= km;
                }    

            function handleEvent(event) {
                $scope.comercio.lat = event.latLng.lat();
                $scope.comercio.lng = event.latLng.lng();
                $scope.centerPoint.lat = -26.997799;
                $scope.centerPoint.lng = -48.632733; 
                // $scope.centerPoint.lat = -25.473466587692343;
                // $scope.centerPoint.lng = -49.29164589792566;
                $scope.centerPointKM = 30;
                $scope.LimiteFuncionamentoDiwo = arePointsNear($scope.comercio, $scope.centerPoint,$scope.centerPointKM );
                $scope.centerPointKMFB = 2500;
                      // $scope.centerPointFB.lat = 39.1882887948499;
                      // $scope.centerPointFB.lng = -100.07746794288232;
                      // $scope.LimiteFuncionamentoDiwoFB = arePointsNear($scope.user, $scope.centerPointFB,$scope.centerPointKMFB );
                      
                      // if($scope.LimiteFuncionamentoDiwoFB){
                      //   $scope.LimiteFuncionamentoDiwo = true;
                      // }
                              // GEOCODER INVERSO

                var geocoder = new google.maps.Geocoder;
                var infowindow = new google.maps.InfoWindow({
                                                              maxWidth: 200
                                                            });;    
            
                geocoder.geocode({'location': event.latLng}, function(results, status) {
                  if (status === 'OK') {
                    if (results[1]) {
                      $scope.comercio.nomelocal = results[0].address_components[0].long_name;
                      for(var i = 0;i<results[0].address_components.length;i++){
                        if(results[0].address_components[i].types[0] == "administrative_area_level_2"){
                          $scope.comercio.cidade = results[0].address_components[i].long_name;
                          console.log($scope.comercio.cidade)
                        }
                      }
                      //$scope.evento.cidade = results[0].address_components[4].long_name;
                      $scope.comercio.endereco = results[0].formatted_address;
                      // console.log($scope.comercio.endereco);
                      // console.log($scope.evento.cidade);
                      console.log($scope.comercio.lng);
                      console.log($scope.comercio.lat);
                      infowindow.setContent(results[0].formatted_address);
                     
                      infowindow.open(map, marker);
                      setTimeout(function () { infowindow.close(); }, 5000);
                    } else {
                      window.alert('No results found');
                    }
                  } else {
                    window.alert('Geocoder failed due to: ' + status);
                  }
                });
            }
            var input = document.getElementById('pac-input');
            var searchBox = new google.maps.places.SearchBox(input);
            map.addListener('bounds_changed', function() {
                searchBox.setBounds(map.getBounds());
            });
            var markers = [];
            searchBox.addListener('places_changed', function() {
                var places = searchBox.getPlaces();

                if (places.length == 0) {
                  return;
                }

                // Clear out the old markers.
                markers.forEach(function(marker) {
                  marker.setMap(null);
                });
                markers = [];

                // For each place, get the icon, name and location.
                var bounds = new google.maps.LatLngBounds();
                places.forEach(function(place) {
                  if (!place.geometry) {
                    console.log("Returned place contains no geometry");
                    return;
                  }
                  // var icon = {
                  //   url: place.icon,
                  //   size: new google.maps.Size(71, 71),
                  //   origin: new google.maps.Point(0, 0),
                  //   anchor: new google.maps.Point(17, 34),
                  //   scaledSize: new google.maps.Size(25, 25)
                  // };

                  // Create a marker for each place.
                  markers.push(new google.maps.Marker({
                    map: map,
                    // icon: icon,
                    title: place.name,
                    position: place.geometry.location
                  }));

                  $scope.comercio.nomelocal = place.name;
                  $scope.comercio.endereco = place.formatted_address;
             
                  for(var i = 0;i<place.address_components.length;i++){
                    //console.log(place.address_components[i].types[0])
                    if(place.address_components[i].types[0] == "administrative_area_level_2"){
                      $scope.comercio.cidade = place.address_components[i].long_name;
                      console.log($scope.comercio.cidade)
                    }
                  }
                 
                  $scope.comercio.lat = place.geometry.location.lat();
                  $scope.comercio.lng = place.geometry.location.lng();
                  $scope.centerPoint.lat = -26.997799;
                  $scope.centerPoint.lng = -48.632733; 
                  // $scope.centerPoint.lat = -25.473466587692343;
                  // $scope.centerPoint.lng = -49.29164589792566;
                  $scope.centerPointKM = 30;
                  $scope.LimiteFuncionamentoDiwo = arePointsNear($scope.comercio, $scope.centerPoint,$scope.centerPointKM );
                  // $scope.centerPointKMFB = 2500;
                  //     $scope.centerPointFB.lat = 39.1882887948499;
                  //     $scope.centerPointFB.lng = -100.07746794288232;
                  //     $scope.LimiteFuncionamentoDiwoFB = arePointsNear($scope.user, $scope.centerPointFB,$scope.centerPointKMFB );
                      
                  //     if($scope.LimiteFuncionamentoDiwoFB){
                  //       $scope.LimiteFuncionamentoDiwo = true;
                  //     }
                  console.log($scope.comercio.lng, $scope.comercio.lat, "lssdd", $scope.comercio.nomelocal, $scope.comercio.endereco);

                  if (place.geometry.viewport) {
                    // Only geocodes have viewport.
                    bounds.union(place.geometry.viewport);
                  } else {
                    bounds.extend(place.geometry.location);
                  }
                });
                map.fitBounds(bounds);
            });

            $scope.map = map;  
             
        }, function(err) {
            console.log(err.code);
            console.log(err.message);
        });
    }
 

  })

  var posOptions = {
      enableHighAccuracy: true,
      timeout: 200000,
      maximumAge: 0
  };

    navigator.geolocation.getCurrentPosition(function(position){
          
            var lat  = position.coords.latitude;
            var long = position.coords.longitude;
             

            var myLatlng = new google.maps.LatLng(lat, long);
             
            var mapOptions = {
                center: myLatlng,
                zoom: 16,
                mapTypeId: google.maps.MapTypeId.ROADMAP
            };          
             
            var map = new google.maps.Map(document.getElementById("map_canvas"), mapOptions); 


            var marker = new google.maps.Marker({
                      position: new google.maps.LatLng(position.coords.latitude, position.coords.longitude),
                      map: map,
                      title: "Borai",
                      draggable: true,
                      icon: 'http://maps.google.com/mapfiles/ms/icons/green-dot.png',
                      animation: google.maps.Animation.DROP 
                  })

            var geocoder = new google.maps.Geocoder;
            var infowindow = new google.maps.InfoWindow({maxWidth: 200});

            geocoder.geocode({'location': myLatlng}, function(results, status) {
                  if (status === 'OK') {
                    if (results[1]) {
                      $scope.comercio.nomelocal = results[0].address_components[0].long_name;
                      $scope.comercio.endereco = results[0].formatted_address;
                      for(var i = 0;i<results[0].address_components.length;i++){
                        if(results[0].address_components[i].types[0] == "administrative_area_level_2"){
                          $scope.comercio.cidade = results[0].address_components[i].long_name;
                          console.log($scope.comercio.cidade)
                        }
                      }
                      //$scope.evento.cidade = results[0].address_components[4].long_name;
                      $scope.comercio.lat = position.coords.latitude;
                      $scope.comercio.lng = position.coords.longitude;
                      $scope.centerPoint.lat = -26.997799;
                      $scope.centerPoint.lng = -48.632733; 
                      // $scope.centerPoint.lat = -25.473466587692343;
                      // $scope.centerPoint.lng = -49.29164589792566;
                      $scope.centerPointKM = 30;
                      $scope.LimiteFuncionamentoDiwo = arePointsNear($scope.comercio, $scope.centerPoint,$scope.centerPointKM );
                      // $scope.centerPointKMFB = 2500;
                      // $scope.centerPointFB.lat = 39.1882887948499;
                      // $scope.centerPointFB.lng = -100.07746794288232;
                      // $scope.LimiteFuncionamentoDiwoFB = arePointsNear($scope.user, $scope.centerPointFB,$scope.centerPointKMFB );
                      
                      // if($scope.LimiteFuncionamentoDiwoFB){
                      //   $scope.LimiteFuncionamentoDiwo = true;
                      // }
                      infowindow.setContent(results[0].formatted_address);
                      console.log($scope.comercio.endereco);
                      console.log($scope.comercio.cidade);
                      console.log($scope.comercio.lng);
                      console.log($scope.comercio.lat);
                      //infowindow.setContent(results[0].address_components[2].long_name);
                      infowindow.open(map, marker);
                      setTimeout(function () { infowindow.close(); }, 5000);
                    } else {
                      window.alert('No results found');
                    }
                  } else {
                    window.alert('Geocoder failed due to: ' + status);
                  }
                });


            google.maps.event.addListener(marker, "dragstart", function (event) {
               marker.setAnimation(3); // raise
            });

            google.maps.event.addListener(marker, "dragend", function (event) {
               marker.setAnimation(4); // raise
            });

            marker.addListener('dragend', handleEvent);

            google.maps.event.addListener(map, 'click', function(e) {
              
                markers.forEach(function(marker) {
                marker.setMap(null);
                });
                markers = [];

                placeMarker(e.latLng, map, marker);

            });
             function arePointsNear(checkPoint, centerPoint, km) {
                  var ky = 40000 / 360;
                  var kx = Math.cos(Math.PI * centerPoint.lat / 180.0) * ky;
                  var dx = Math.abs(centerPoint.lng - $scope.comercio.lng) * kx;
                  var dy = Math.abs(centerPoint.lat - $scope.comercio.lat) * ky;
                  return Math.sqrt(dx * dx + dy * dy) <= km;
                } 

            function placeMarker(latlng, map, marker) {
                marker.setPosition(latlng);
                marker.setMap(map);
                map.panTo(latlng);
                $scope.comercio.lat = latlng.lat();
                $scope.comercio.lng = latlng.lng();
                $scope.centerPoint.lat = -26.997799;
                $scope.centerPoint.lng = -48.632733;
                // $scope.centerPoint.lat = -25.473466587692343;
                // $scope.centerPoint.lng = -49.29164589792566; 
                $scope.centerPointKM = 30;
                $scope.LimiteFuncionamentoDiwo = arePointsNear($scope.comercio, $scope.centerPoint,$scope.centerPointKM );
                // $scope.centerPointKMFB = 2500;
                //       $scope.centerPointFB.lat = 39.1882887948499;
                //       $scope.centerPointFB.lng = -100.07746794288232;
                //       $scope.LimiteFuncionamentoDiwoFB = arePointsNear($scope.user, $scope.centerPointFB,$scope.centerPointKMFB );
                      
                //       if($scope.LimiteFuncionamentoDiwoFB){
                //         $scope.LimiteFuncionamentoDiwo = true;
                //       }
                geocoder.geocode({'location': latlng}, function(results, status) {
                  if (status === 'OK') {
                    if (results[1]) {
                      $scope.comercio.nomelocal = results[0].address_components[0].long_name;
                      for(var i = 0;i<results[0].address_components.length;i++){
                        if(results[0].address_components[i].types[0] == "administrative_area_level_2"){
                          $scope.comercio.cidade = results[0].address_components[i].long_name;
                          console.log($scope.comercio.cidade)
                        }
                      }
                      //$scope.evento.cidade = results[0].address_components[4].long_name;
                      $scope.comercio.endereco = results[0].formatted_address;
                      console.log($scope.comercio.endereco);
                      console.log($scope.comercio.cidade);
                      console.log($scope.comercio.lng);
                      console.log($scope.comercio.lat);
                      infowindow.setContent(results[0].formatted_address);
                     
                      infowindow.open(map, marker);
                      setTimeout(function () { infowindow.close(); }, 5000);
                    } else {
                      window.alert('No results found');
                    }
                  } else {
                    window.alert('Geocoder failed due to: ' + status);
                  }
                });
            };        

            function handleEvent(event) {
                $scope.comercio.lat = event.latLng.lat();
                $scope.comercio.lng = event.latLng.lng();
                $scope.centerPoint.lat = -26.997799;
                $scope.centerPoint.lng = -48.632733; 
                // $scope.centerPoint.lat = -25.473466587692343;
                // $scope.centerPoint.lng = -49.29164589792566;
                $scope.centerPointKM = 30;
                $scope.LimiteFuncionamentoDiwo = arePointsNear($scope.comercio, $scope.centerPoint,$scope.centerPointKM );
                // $scope.centerPointKMFB = 2500;
                //       $scope.centerPointFB.lat = 39.1882887948499;
                //       $scope.centerPointFB.lng = -100.07746794288232;
                //       $scope.LimiteFuncionamentoDiwoFB = arePointsNear($scope.user, $scope.centerPointFB,$scope.centerPointKMFB );
                      
                //       if($scope.LimiteFuncionamentoDiwoFB){
                //         $scope.LimiteFuncionamentoDiwo = true;
                //       }
                              // GEOCODER INVERSO

                var geocoder = new google.maps.Geocoder;
                var infowindow = new google.maps.InfoWindow({
                                                              maxWidth: 200
                                                            });;    
            
                geocoder.geocode({'location': event.latLng}, function(results, status) {
                  if (status === 'OK') {
                    if (results[1]) {
                      $scope.comercio.nomelocal = results[0].address_components[0].long_name;
                      for(var i = 0;i<results[0].address_components.length;i++){
                        if(results[0].address_components[i].types[0] == "administrative_area_level_2"){
                          $scope.comercio.cidade = results[0].address_components[i].long_name;
                          console.log($scope.comercio.cidade)
                        }
                      }
                      //$scope.evento.cidade = results[0].address_components[4].long_name;
                      $scope.comercio.endereco = results[0].formatted_address;
                      // console.log($scope.evento.endereco);
                      // console.log($scope.evento.cidade);
                      console.log($scope.comercio.lng);
                      console.log($scope.comercio.lat);
                      infowindow.setContent(results[0].formatted_address);
                     
                      infowindow.open(map, marker);
                      setTimeout(function () { infowindow.close(); }, 5000);
                    } else {
                      window.alert('No results found');
                    }
                  } else {
                    window.alert('Geocoder failed due to: ' + status);
                  }
                });
            }

                              // GEOCODER INVERSO

                

                
            
                    //        SEARCHBOX

            var input = document.getElementById('pac-input');
            var searchBox = new google.maps.places.SearchBox(input);
          //map.controls[google.maps.ControlPosition.TOP_LEFT].push(input);

        // Bias the SearchBox results towards current map's viewport.
            map.addListener('bounds_changed', function() {
                searchBox.setBounds(map.getBounds());
            });

            var markers = [];
        // Listen for the event fired when the user selects a prediction and retrieve
        // more details for that place.
            searchBox.addListener('places_changed', function() {
                var places = searchBox.getPlaces();

                if (places.length == 0) {
                  return;
                }

                // Clear out the old markers.
                markers.forEach(function(marker) {
                  marker.setMap(null);
                });
                markers = [];

                // For each place, get the icon, name and location.
                var bounds = new google.maps.LatLngBounds();
                places.forEach(function(place) {
                  if (!place.geometry) {
                    console.log("Returned place contains no geometry");
                    return;
                  }
                  // var icon = {
                  //   url: place.icon,
                  //   size: new google.maps.Size(71, 71),
                  //   origin: new google.maps.Point(0, 0),
                  //   anchor: new google.maps.Point(17, 34),
                  //   scaledSize: new google.maps.Size(25, 25)
                  // };

                  // Create a marker for each place.
                  markers.push(new google.maps.Marker({
                    map: map,
                    // icon: icon,
                    title: place.name,
                    position: place.geometry.location
                  }));

                  $scope.comercio.nomelocal = place.name;
                  $scope.comercio.endereco = place.formatted_address;
                  for(var i = 0;i<place.address_components.length;i++){
                    //console.log(place.address_components[i].types[0])
                    if(place.address_components[i].types[0] == "administrative_area_level_2"){
                      $scope.comercio.cidade = place.address_components[i].long_name;
                      console.log($scope.comercio.cidade)
                    }
                  }
                 
                  $scope.comercio.lat = place.geometry.location.lat();
                  $scope.comercio.lng = place.geometry.location.lng();
                  $scope.centerPoint.lat = -26.997799;
                  $scope.centerPoint.lng = -48.632733; 
                  // $scope.centerPoint.lat = -25.473466587692343;
                  // $scope.centerPoint.lng = -49.29164589792566;
                  $scope.centerPointKM = 30;
                  $scope.LimiteFuncionamentoDiwo = arePointsNear($scope.comercio, $scope.centerPoint,$scope.centerPointKM );
                  // $scope.centerPointKMFB = 2500;
                  //     $scope.centerPointFB.lat = 39.1882887948499;
                  //     $scope.centerPointFB.lng = -100.07746794288232;
                  //     $scope.LimiteFuncionamentoDiwoFB = arePointsNear($scope.user, $scope.centerPointFB,$scope.centerPointKMFB );
                      
                  //     if($scope.LimiteFuncionamentoDiwoFB){
                  //       $scope.LimiteFuncionamentoDiwo = true;
                  //     }
                  // console.log($scope.coord.endereco);
                  // console.log($scope.coord.long);
                  // console.log($scope.coord.lat);

                  if (place.geometry.viewport) {
                    // Only geocodes have viewport.
                    bounds.union(place.geometry.viewport);
                  } else {
                    bounds.extend(place.geometry.location);
                  }
                });
                map.fitBounds(bounds);
            });

            $scope.map = map;  
             
        }, function(err) {
            console.log(err.code);
            console.log(err.message);
        });


  $scope.Proximo = function() {
    if($scope.comercio.lat){
      window.localStorage.setItem( 'criandocomercio',  JSON.stringify($scope.comercio));
      formcontacomercio.updateForm($scope.comercio);
      $state.go('contacomerciointeresse');
    }
  }

  $scope.Cancela = function () {
       window.localStorage.removeItem('criandouser')
       $state.go('novahomesemlogin')
    };

}])

.controller('contacomerciointeresseCtrl', ['$scope', '$stateParams', '$state', 'EventoService', '$cordovaCamera', '$cordovaFile', '$cordovaFileTransfer', '$cordovaDevice', '$ionicPopup', '$cordovaActionSheet','$ionicLoading','$http','formCodigo', 'formcontacomercio', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, $state, EventoService, $cordovaCamera, $cordovaFile, $cordovaFileTransfer, $cordovaDevice, $ionicPopup, $cordovaActionSheet,$ionicLoading,$http,formCodigo, formcontacomercio) {
  $scope.comercio = {};

  $scope.$on("$ionicView.enter", function(event, data){
    $scope.comercio = JSON.parse( window.localStorage.getItem( 'criandocomercio' ));
    $scope.auxtagbutton1 = true;
    $scope.auxtagbutton2 = true;
    $scope.auxtagbutton3 = true;
    $scope.auxtagbutton4 = true;
    $scope.auxtagbutton5 = true;
    $scope.auxtagbutton6 = true;
    $scope.auxtagbutton7 = true;
    $scope.auxtagbutton8 = true;
    $scope.auxtagbutton9 = true;
    $scope.auxtagbutton10 = true;
    $scope.auxtagbutton11 = true;
    $scope.auxtagbutton12 = true;
    $scope.auxtagbutton13 = true;
    $scope.auxtagbutton14 = true;
    $scope.auxtagbutton15 = true;
    $scope.auxtagbutton16 = true;
    $scope.auxtagbutton17 = true;
    $scope.auxtagbutton18 = true;
    $scope.auxtagbutton1aux = false;
    $scope.auxtagbutton2aux = false;
    $scope.auxtagbutton3aux = false;
    $scope.auxtagbutton4aux = false;
    $scope.auxtagbutton5aux = false;
    $scope.auxtagbutton6aux = false;
    $scope.auxtagbutton7aux = false;
    $scope.auxtagbutton8aux = false;
    $scope.auxtagbutton9aux = false;
    $scope.auxtagbutton10aux = false;
    $scope.auxtagbutton11aux = false;
    $scope.auxtagbutton12aux = false;
    $scope.auxtagbutton13aux = false;
    $scope.auxtagbutton14aux = false;
    $scope.auxtagbutton15aux = false;
    $scope.auxtagbutton16aux = false;
    $scope.auxtagbutton17aux = false;
    $scope.auxtagbutton18aux = false;
    $scope.comercio.auxtag1 = 'Voluntariado';
    $scope.comercio.auxtag2 = 'Passeio'; 
    $scope.comercio.auxtag3 = 'Esportesdepraia'; 
    $scope.comercio.auxtag4 = 'Natureza'; 
    $scope.comercio.auxtag5 = 'Ciclismo';  
    $scope.comercio.auxtag6 = 'Futebol'; 
    $scope.comercio.auxtag7 = 'Corrida'; 
    $scope.comercio.auxtag8 = 'Dança'; 
    $scope.comercio.auxtag9 = 'Surf'; 
    $scope.comercio.auxtag10 = 'Música'; 
    $scope.comercio.auxtag11 = 'ArteeCultura'; 
    $scope.comercio.auxtag12 = 'Conversa'; 
    $scope.comercio.auxtag13 = 'Restaurante&Bares'; 
    $scope.comercio.auxtag14 = 'Festas'; 
    $scope.comercio.auxtag15 = 'Jogos'; 
    $scope.comercio.auxtag16 = 'GruposdeEstudos'; 
    $scope.comercio.auxtag17 = 'Pets'; 
    $scope.comercio.auxtag18 = 'Praia'; 

  });
    $scope.tiratag1 = function(){
        if($scope.auxtagbutton1){
          $scope.auxtagbutton1 = false;
          $scope.auxtagbutton1aux = true;
        }else{
          $scope.auxtagbutton1 = true;
          $scope.auxtagbutton1aux = false;
        }
    }
    $scope.tiratag2 = function(){
        if($scope.auxtagbutton2){
          $scope.auxtagbutton2 = false;
          $scope.auxtagbutton2aux = true;
        }else{
          $scope.auxtagbutton2 = true;
          $scope.auxtagbutton2aux = false;
        }
    }
    $scope.tiratag3 = function(){
        if($scope.auxtagbutton3){
          $scope.auxtagbutton3 = false;
          $scope.auxtagbutton3aux = true;
        }else{
          $scope.auxtagbutton3 = true;
          $scope.auxtagbutton3aux = false;
        }
    }
    $scope.tiratag4 = function(){
        if($scope.auxtagbutton4){
          $scope.auxtagbutton4 = false;
          $scope.auxtagbutton4aux = true;
        }else{
          $scope.auxtagbutton4 = true;
          $scope.auxtagbutton4aux = false;
        }
    }
    $scope.tiratag5 = function(){
        if($scope.auxtagbutton5){
          $scope.auxtagbutton5 = false;
          $scope.auxtagbutton5aux = true;
        }else{
          $scope.auxtagbutton5 = true;
          $scope.auxtagbutton5aux = false;
        }
    }
    $scope.tiratag6 = function(){
        if($scope.auxtagbutton6){
          $scope.auxtagbutton6 = false;
          $scope.auxtagbutton6aux = true;
        }else{
          $scope.auxtagbutton6 = true;
          $scope.auxtagbutton6aux = false;
        }
    }

    $scope.tiratag7 = function(){
        if($scope.auxtagbutton7){
          $scope.auxtagbutton7 = false;
          $scope.auxtagbutton7aux = true;
        }else{
          $scope.auxtagbutton7 = true;
          $scope.auxtagbutton7aux = false;
        }
    }
    $scope.tiratag8 = function(){
        if($scope.auxtagbutton8){
          $scope.auxtagbutton8 = false;
          $scope.auxtagbutton8aux = true;
        }else{
          $scope.auxtagbutton8 = true;
          $scope.auxtagbutton8aux = false;
        }
    }
    $scope.tiratag9 = function(){
        if($scope.auxtagbutton9){
          $scope.auxtagbutton9 = false;
          $scope.auxtagbutton9aux = true;
        }else{
          $scope.auxtagbutton9 = true;
          $scope.auxtagbutton9aux = false;
        }
    }
    $scope.tiratag10 = function(){
        if($scope.auxtagbutton10){
          $scope.auxtagbutton10 = false;
          $scope.auxtagbutton10aux = true;
        }else{
          $scope.auxtagbutton10 = true;
          $scope.auxtagbutton10aux = false;
        }
    }
    $scope.tiratag11 = function(){
        if($scope.auxtagbutton11){
          $scope.auxtagbutton11 = false;
          $scope.auxtagbutton11aux = true;
        }else{
          $scope.auxtagbutton11 = true;
          $scope.auxtagbutton11aux = false;
        }
    }
    $scope.tiratag12 = function(){
        if($scope.auxtagbutton12){
          $scope.auxtagbutton12 = false;
          $scope.auxtagbutton12aux = true;
        }else{
          $scope.auxtagbutton12 = true;
          $scope.auxtagbutton12aux = false;
        }
    }
    $scope.tiratag13 = function(){
        if($scope.auxtagbutton13){
          $scope.auxtagbutton13 = false;
          $scope.auxtagbutton13aux = true;
        }else{
          $scope.auxtagbutton13 = true;
          $scope.auxtagbutton13aux = false;
        }
    }
    $scope.tiratag14 = function(){
        if($scope.auxtagbutton14){
          $scope.auxtagbutton14 = false;
          $scope.auxtagbutton14aux = true;
        }else{
          $scope.auxtagbutton14 = true;
          $scope.auxtagbutton14aux = false;
        }
    }
    $scope.tiratag15 = function(){
        if($scope.auxtagbutton15){
          $scope.auxtagbutton15 = false;
          $scope.auxtagbutton15aux = true;
        }else{
          $scope.auxtagbutton15 = true;
          $scope.auxtagbutton15aux = false;
        }
    }
    $scope.tiratag16 = function(){
        if($scope.auxtagbutton16){
          $scope.auxtagbutton16 = false;
          $scope.auxtagbutton16aux = true;
        }else{
          $scope.auxtagbutton16 = true;
          $scope.auxtagbutton16aux = false;
        }
    }
    $scope.tiratag17 = function(){
        if($scope.auxtagbutton17){
          $scope.auxtagbutton17 = false;
          $scope.auxtagbutton17aux = true;
        }else{
          $scope.auxtagbutton17 = true;
          $scope.auxtagbutton17aux = false;
        }
    }
    $scope.tiratag18 = function(){
        if($scope.auxtagbutton18){
          $scope.auxtagbutton18 = false;
          $scope.auxtagbutton18aux = true;
        }else{
          $scope.auxtagbutton18 = true;
          $scope.auxtagbutton18aux = false;
        }
    }

    
  $scope.Proximo = function() {
 
      if($scope.auxtagbutton1 == false){
        if ($scope.comercio.interesse == undefined) {
          $scope.comercio.interesse = $scope.comercio.auxtag1;
        }else{
          $scope.comercio.interesse = $scope.comercio.interesse + ' ' +$scope.comercio.auxtag1;
        }
      }
      if($scope.auxtagbutton2 == false){
        if ($scope.comercio.interesse == undefined) {
          $scope.comercio.interesse = $scope.comercio.auxtag2;
        }else{
          $scope.comercio.interesse = $scope.comercio.interesse + ' ' +$scope.comercio.auxtag2;
        }
      }
      if($scope.auxtagbutton3 == false){
        if ($scope.comercio.interesse == undefined) {
          $scope.comercio.interesse = $scope.comercio.auxtag3;
        }else{
          $scope.comercio.interesse = $scope.comercio.interesse + ' ' +$scope.comercio.auxtag3;
        }
      }
      if($scope.auxtagbutton4 == false){
        if ($scope.comercio.interesse == undefined) {
          $scope.comercio.interesse = $scope.comercio.auxtag4;
        }else{
          $scope.comercio.interesse = $scope.comercio.interesse + ' ' +$scope.comercio.auxtag4;
        }
      }
      if($scope.auxtagbutton5 == false){
        if ($scope.comercio.interesse == undefined) {
          $scope.comercio.interesse = $scope.comercio.auxtag5;
        }else{
          $scope.comercio.interesse = $scope.comercio.interesse + ' ' +$scope.comercio.auxtag5;
        }
      }
      if($scope.auxtagbutton6 == false){
        if ($scope.comercio.interesse == undefined) {
          $scope.comercio.interesse = $scope.comercio.auxtag6;
        }else{
          $scope.comercio.interesse = $scope.comercio.interesse + ' ' +$scope.comercio.auxtag6;
        }
      }
      if($scope.auxtagbutton7 == false){
        if ($scope.comercio.interesse == undefined) {
          $scope.comercio.interesse = $scope.comercio.auxtag7;
        }else{
          $scope.comercio.interesse = $scope.comercio.interesse + ' ' +$scope.comercio.auxtag7;
        }
      }
      if($scope.auxtagbutton8 == false){
        if ($scope.comercio.interesse == undefined) {
          $scope.comercio.interesse = $scope.comercio.auxtag8;
        }else{
          $scope.comercio.interesse = $scope.comercio.interesse + ' ' +$scope.comercio.auxtag8;
        }
      }
      if($scope.auxtagbutton9 == false){
        if ($scope.comercio.interesse == undefined) {
          $scope.comercio.interesse = $scope.comercio.auxtag9;
        }else{
          $scope.comercio.interesse = $scope.comercio.interesse + ' ' +$scope.comercio.auxtag9;
        }
      }
      if($scope.auxtagbutton10 == false){
        if ($scope.comercio.interesse == undefined) {
          $scope.comercio.interesse = $scope.comercio.auxtag10;
        }else{
          $scope.comercio.interesse = $scope.comercio.interesse + ' ' +$scope.comercio.auxtag10;
        }
      }
      if($scope.auxtagbutton11 == false){
        if ($scope.comercio.interesse == undefined) {
          $scope.comercio.interesse = $scope.comercio.auxtag11;
        }else{
          $scope.comercio.interesse = $scope.comercio.interesse + ' ' +$scope.comercio.auxtag11;
        }
      }
      if($scope.auxtagbutton12 == false){
        if ($scope.comercio.interesse == undefined) {
          $scope.comercio.interesse = $scope.comercio.auxtag12;
        }else{
          $scope.comercio.interesse = $scope.comercio.interesse + ' ' +$scope.comercio.auxtag12;
        }
      }
      if($scope.auxtagbutton13 == false){
        if ($scope.comercio.interesse == undefined) {
          $scope.comercio.interesse = $scope.comercio.auxtag13;
        }else{
          $scope.comercio.interesse = $scope.comercio.interesse + ' ' +$scope.comercio.auxtag13;
        }
      }
      if($scope.auxtagbutton14 == false){
        if ($scope.comercio.interesse == undefined) {
          $scope.comercio.interesse = $scope.comercio.auxtag14;
        }else{
          $scope.comercio.interesse = $scope.comercio.interesse + ' ' +$scope.comercio.auxtag14;
        }
      }
      if($scope.auxtagbutton15 == false){
        if ($scope.comercio.interesse == undefined) {
          $scope.comercio.interesse = $scope.comercio.auxtag15;
        }else{
          $scope.comercio.interesse = $scope.comercio.interesse + ' ' +$scope.comercio.auxtag15;
        }
      }
      if($scope.auxtagbutton16 == false){
        if ($scope.comercio.interesse == undefined) {
          $scope.comercio.interesse = $scope.comercio.auxtag16;
        }else{
          $scope.comercio.interesse = $scope.comercio.interesse + ' ' +$scope.comercio.auxtag16;
        }
      }
      if($scope.auxtagbutton17 == false){
        if ($scope.comercio.interesse == undefined) {
          $scope.comercio.interesse = $scope.comercio.auxtag17;
        }else{
          $scope.comercio.interesse = $scope.comercio.interesse + ' ' +$scope.comercio.auxtag17;
        }
      }
      if($scope.auxtagbutton18 == false){
        if ($scope.comercio.interesse == undefined) {
          $scope.comercio.interesse = $scope.comercio.auxtag18;
        }else{
          $scope.comercio.interesse = $scope.comercio.interesse + ' ' +$scope.comercio.auxtag18;
        }
      }

      if (!$scope.comercio.interesse) {
        var alertPopup = $ionicPopup.alert({
          title: '(⊙﹏⊙✿)',
          template: 'Selecione pelo menos um desses!'
        });
      }else{
        window.localStorage.setItem( 'criandocomercio', JSON.stringify($scope.comercio));
        formcontacomercio.updateForm($scope.comercio);
        $state.go('contacomercionumeropessoas');
      }


            
  };
  $scope.Cancela = function () {
       window.localStorage.removeItem('criandocomercio')
       $state.go('novahomesemlogin')
    };

 

}])

.controller('contacomercionumeropessoasCtrl', ['$scope', '$stateParams', '$state', 'EventoService', '$cordovaCamera', '$cordovaFile', '$cordovaFileTransfer', '$cordovaDevice', '$ionicPopup', '$cordovaActionSheet','$ionicLoading','$http','formCodigo', 'formcontacomercio', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, $state, EventoService, $cordovaCamera, $cordovaFile, $cordovaFileTransfer, $cordovaDevice, $ionicPopup, $cordovaActionSheet,$ionicLoading,$http,formCodigo, formcontacomercio) {
  $scope.comercio = {};
  
  $scope.$on("$ionicView.enter", function(event, data){
     $scope.comercio = JSON.parse( window.localStorage.getItem( 'criandocomercio' ));
    if(!$scope.comercio.pmin){
      $scope.comercio.pmin = 2;
      $scope.comercio.pmax = 10;
    }
    console.log($scope.comercio.apelido)
   
  })

  $scope.menos = function(){
    if($scope.comercio.pmin >2){
      $scope.comercio.pmin--;
    }
  }
  $scope.mais = function(){
    if($scope.comercio.pmin < 49){
      $scope.comercio.pmin++;
      if($scope.comercio.pmin >= $scope.comercio.pmax){
        $scope.comercio.pmax = $scope.comercio.pmin+1;
      }
      
    }
  }

  $scope.menosmax = function(){
    if($scope.comercio.pmax >3){
      $scope.comercio.pmax--;
      if($scope.comercio.pmax <= $scope.comercio.pmin){
        $scope.comercio.pmin = $scope.comercio.pmax-1;
      }
    }
  }
  $scope.maismax = function(){
    if($scope.comercio.pmax < 50){
      $scope.comercio.pmax++;
    }
  }

  $scope.Proximo = function() {
    if(!$scope.comercio.pmedio){
      $scope.comercio.pmedio = $scope.comercio.pmin;
    }
      window.localStorage.setItem( 'criandocomercio',  JSON.stringify($scope.comercio));
      formcontacomercio.updateForm($scope.comercio);
      $state.go('contacomerciopreco');
    
  }

  $scope.Cancela = function () {
       window.localStorage.removeItem('criandocomercio')
       $state.go('novahomesemlogin')
    };
}])

.controller('contacomercioprecoCtrl', ['$scope', '$stateParams', '$state', 'EventoService', '$cordovaCamera', '$cordovaFile', '$cordovaFileTransfer', '$cordovaDevice', '$ionicPopup', '$cordovaActionSheet','$ionicLoading','$http','formCodigo', 'formcontacomercio', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, $state, EventoService, $cordovaCamera, $cordovaFile, $cordovaFileTransfer, $cordovaDevice, $ionicPopup, $cordovaActionSheet,$ionicLoading,$http,formCodigo, formcontacomercio) {
  $scope.comercio = {};
  
  $scope.$on("$ionicView.enter", function(event, data){
    $scope.comercio = JSON.parse( window.localStorage.getItem( 'criandocomercio' )); 
    console.log($scope.comercio.apelido)
  })

  var header = document.getElementById("barcomercio");
  var btns = header.getElementsByClassName("btncomercio");
  for (var i = 0; i < btns.length; i++) {
    btns[i].addEventListener("click", function() {
      var current = document.getElementsByClassName("actcomercio");
      current[0].className = current[0].className.replace(" actcomercio", "");
      this.className += " actcomercio";
    });
  }

  $scope.comercio.precopor = 1;
  $scope.pessoa = function() {$scope.comercio.precopor = 1;};
  $scope.hora = function() {$scope.comercio.precopor = 2;};

  $scope.Proximo = function(){
    if(!$scope.comercio.preco){
      $scope.comercio.preco = 0;
    }
    if(!$scope.comercio.precopor){
      $scope.comercio.precopor = 1;
    }
      window.localStorage.setItem( 'criandocomercio',  JSON.stringify($scope.comercio));
      formcontacomercio.updateForm($scope.comercio);
      $state.go('contacomerciodescontopacote');
  }
  
  

  $scope.Cancela = function () {
       window.localStorage.removeItem('criandocomercio')
       $state.go('novahomesemlogin')
    };
}])

.controller('contacomerciodescontopacoteCtrl', ['$scope', '$stateParams', '$state', 'EventoService', '$cordovaCamera', '$cordovaFile', '$cordovaFileTransfer', '$cordovaDevice', '$ionicPopup', '$cordovaActionSheet','$ionicLoading','$http','formCodigo', 'formcontacomercio', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, $state, EventoService, $cordovaCamera, $cordovaFile, $cordovaFileTransfer, $cordovaDevice, $ionicPopup, $cordovaActionSheet,$ionicLoading,$http,formCodigo, formcontacomercio) {
  $scope.comercio = {};
  
  $scope.$on("$ionicView.enter", function(event, data){
    $scope.comercio = JSON.parse( window.localStorage.getItem( 'criandocomercio' )); 
    console.log($scope.comercio.apelido)
  })

 
  var auxadd = 0
  $scope.addDesconto = function() {
    if(auxadd == 0){
      $scope.desc1 = true;
      auxadd++; 
    }else{
      if(auxadd == 1){
        $scope.desc2 = true; 
      }
    }
  };

  $scope.removeDesconto = function() {
    if(auxadd == 1){
      $scope.desc2 = false;
      auxadd--; 
    }else{
      if(auxadd == 0){
        $scope.desc1 = false; 
      }
    }
  };

  $scope.Proximo = function(){
    if($scope.comercio.descontomin){
       $scope.comercio.descontopacote = 'Para ' + $scope.comercio.pmin + ' pessoas posso fazer ' + $scope.comercio.descontomin+ '.'; 
    }
    if($scope.desc1){
      if($scope.comercio.descontopacote){
        $scope.comercio.descontopacote += '\n\r' + 'Para ' + $scope.comercio.paux1 + ' pessoas posso fazer ' + $scope.comercio.descontoaux1+ '.'; 
      }else{
       $scope.comercio.descontopacote = 'Para ' + $scope.comercio.paux1 + ' pessoas posso fazer ' + $scope.comercio.descontoaux1+ '.'; 
      }
    }
    if($scope.desc2){
      if($scope.comercio.descontopacote){
        $scope.comercio.descontopacote += '\n\r' + 'Para ' + $scope.comercio.paux2 + ' pessoas posso fazer ' + $scope.comercio.descontoaux2+ '.'; 
      }else{
       $scope.comercio.descontopacote = 'Para ' + $scope.comercio.paux2 + ' pessoas posso fazer ' + $scope.comercio.descontoaux2+ '.'; 
      }
    }
    if($scope.comercio.descontomax){
      if($scope.comercio.descontopacote){
        $scope.comercio.descontopacote += '\n\r' + 'Para ' + $scope.comercio.pmax + ' pessoas posso fazer ' + $scope.comercio.descontomax+ '.'; 
      }else{
       $scope.comercio.descontopacote = 'Para ' + $scope.comercio.pmax + ' pessoas posso fazer ' + $scope.comercio.descontomax+ '.'; 
      }
    }
    if($scope.comercio.descontopacote){
      window.localStorage.setItem( 'criandocomercio',  JSON.stringify($scope.comercio));
      formcontacomercio.updateForm($scope.comercio);
      $state.go('contacomercioqmehcomercio');
    }else{
      var alertPopup = $ionicPopup.alert({
        title: 'Por favor preencha os campos',
        template: 'Para podermos mostrar melhor para as pessoas sobre o você precisamos que você preencha todos os campos. Obrigado.'
      });
    }
      
  }
  
  

  $scope.Cancela = function () {
    window.localStorage.removeItem('criandocomercio')
    $state.go('novahomesemlogin')
  };
    
}])

.controller('contacomercioqmehcomercioCtrl', ['$scope', '$stateParams', '$state', 'EventoService', '$cordovaCamera', '$cordovaFile', '$cordovaFileTransfer', '$cordovaDevice', '$ionicPopup', '$cordovaActionSheet','$ionicLoading','$http','formCodigo', 'formcontacomercio', 'formUser', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, $state, EventoService, $cordovaCamera, $cordovaFile, $cordovaFileTransfer, $cordovaDevice, $ionicPopup, $cordovaActionSheet,$ionicLoading,$http,formCodigo, formcontacomercio,formUser) {
  $scope.comercio = {};
  $scope.$on("$ionicView.enter", function(event, data){
    $scope.comercio = JSON.parse( window.localStorage.getItem( 'criandocomercio' ));
    //cognitoUser = formCognito.getForm();

  });
  // $scope.Proximo = function() {
  //   if($scope.comercio.descricao){
  //     window.localStorage.setItem( 'criandocomercio',  JSON.stringify($scope.comercio));
  //     formcontacomercio.updateForm($scope.comercio);
  //     $state.go('contacomerciofoto');
  //   }
  // }

  $scope.Proximo = function(){
    console.log($scope.comercio.qmehcomercio,"$scope.comercio.infocomercio", $scope.comercio.apelido)
    if($scope.comercio.qmehcomercio ){
      window.localStorage.setItem( 'criandocomercio',  JSON.stringify($scope.comercio));
      formcontacomercio.updateForm($scope.comercio);
      $state.go('contacomerciooqtem');
    }else{
      var alertPopup = $ionicPopup.alert({
        title: 'Por favor preencha os campos',
        template: 'Para podermos mostrar melhor para as pessoas sobre o você precisamos que você preencha todos os campos. Obrigado.'
      });
    }
  }

  $scope.Cancela = function () {
       window.localStorage.removeItem('criandocomercio')
       $state.go('novahomesemlogin')
    };
}])


.controller('contacomerciooqtemCtrl', ['$scope', '$stateParams', '$state', 'EventoService', '$cordovaCamera', '$cordovaFile', '$cordovaFileTransfer', '$cordovaDevice', '$ionicPopup', '$cordovaActionSheet','$ionicLoading','$http','formCodigo', 'formcontacomercio', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, $state, EventoService, $cordovaCamera, $cordovaFile, $cordovaFileTransfer, $cordovaDevice, $ionicPopup, $cordovaActionSheet,$ionicLoading,$http,formCodigo, formcontacomercio) {

 $scope.comercio = {};

  $scope.$on("$ionicView.enter", function(event, data){
    $scope.comercio = {};
    $scope.comercio = JSON.parse( window.localStorage.getItem( 'criandocomercio' ));
    

    $scope.auxsemanabutton1 = true;
    $scope.auxsemanabutton2 = true;
    $scope.auxsemanabutton3 = true;
    $scope.auxsemanabutton4 = true;
    $scope.auxsemanabutton5 = true;
    $scope.auxsemanabutton6 = true;
    $scope.auxsemanabutton7 = true;


    $scope.auxsemanabutton1aux = false;
    $scope.auxsemanabutton2aux = false;
    $scope.auxsemanabutton3aux = false;
    $scope.auxsemanabutton4aux = false;
    $scope.auxsemanabutton5aux = false;
    $scope.auxsemanabutton6aux = false;
    $scope.auxsemanabutton7aux = false;

    $scope.comercio.auxsemana1 = 'Arcondicionado';
    $scope.comercio.auxsemana2 = 'Areadefumante'; 
    $scope.comercio.auxsemana3 = 'Estacionamento'; 
    $scope.comercio.auxsemana4 = 'Pets'; 
    $scope.comercio.auxsemana5 = 'PNE';  
    $scope.comercio.auxsemana6 = 'Wifi'; 
    //$scope.comercio.auxsemana7 = 'Sab';

  });
   


    $scope.tirasemana1 = function(){
        if($scope.auxsemanabutton1){
          $scope.auxsemanabutton1 = false;
          $scope.auxsemanabutton1aux = true;
        }else{
          $scope.auxsemanabutton1 = true;
          $scope.auxsemanabutton1aux = false;
        }
    }
    $scope.tirasemana2 = function(){
        if($scope.auxsemanabutton2){
          $scope.auxsemanabutton2 = false;
          $scope.auxsemanabutton2aux = true;
        }else{
          $scope.auxsemanabutton2 = true;
          $scope.auxsemanabutton2aux = false;
        }
    }
    $scope.tirasemana3 = function(){
        if($scope.auxsemanabutton3){
          $scope.auxsemanabutton3 = false;
          $scope.auxsemanabutton3aux = true;
        }else{
          $scope.auxsemanabutton3 = true;
          $scope.auxsemanabutton3aux = false;
        }
    }
    $scope.tirasemana4 = function(){
        if($scope.auxsemanabutton4){
          $scope.auxsemanabutton4 = false;
          $scope.auxsemanabutton4aux = true;
        }else{
          $scope.auxsemanabutton4 = true;
          $scope.auxsemanabutton4aux = false;
        }
    }
    $scope.tirasemana5 = function(){
        if($scope.auxsemanabutton5){
          $scope.auxsemanabutton5 = false;
          $scope.auxsemanabutton5aux = true;
        }else{
          $scope.auxsemanabutton5 = true;
          $scope.auxsemanabutton5aux = false;
        }
    }
    $scope.tirasemana6 = function(){
        if($scope.auxsemanabutton6){
          $scope.auxsemanabutton6 = false;
          $scope.auxsemanabutton6aux = true;
        }else{
          $scope.auxsemanabutton6 = true;
          $scope.auxsemanabutton6aux = false;
        }
    }

    $scope.tirasemana7 = function(){
        if($scope.auxsemanabutton7){
          $scope.auxsemanabutton7 = false;
          $scope.auxsemanabutton7aux = true;
        }else{
          $scope.auxsemanabutton7 = true;
          $scope.auxsemanabutton7aux = false;
        }
    }

    
  $scope.Proximo = function() {
  delete $scope.comercio.oqtem


      if($scope.auxsemanabutton1 == false){
        if ($scope.comercio.oqtem == undefined) {
          $scope.comercio.oqtem = $scope.comercio.auxsemana1;
        }else{
          $scope.comercio.oqtem = $scope.comercio.oqtem + ' ' +$scope.comercio.auxsemana1;
        }
      }
      if($scope.auxsemanabutton2 == false){
        if ($scope.comercio.oqtem == undefined) {
          $scope.comercio.oqtem = $scope.comercio.auxsemana2;
        }else{
          $scope.comercio.oqtem = $scope.comercio.oqtem + ' ' +$scope.comercio.auxsemana2;
        }
      }
      if($scope.auxsemanabutton3 == false){
        if ($scope.comercio.oqtem == undefined) {
          $scope.comercio.oqtem = $scope.comercio.auxsemana3;
        }else{
          $scope.comercio.oqtem = $scope.comercio.oqtem + ' ' +$scope.comercio.auxsemana3;
        }
      }
      if($scope.auxsemanabutton4 == false){
        if ($scope.comercio.oqtem == undefined) {
          $scope.comercio.oqtem = $scope.comercio.auxsemana4;
        }else{
          $scope.comercio.oqtem = $scope.comercio.oqtem + ' ' +$scope.comercio.auxsemana4;
        }
      }
      if($scope.auxsemanabutton5 == false){
        if ($scope.comercio.oqtem == undefined) {
          $scope.comercio.oqtem = $scope.comercio.auxsemana5;
        }else{
          $scope.comercio.oqtem = $scope.comercio.oqtem + ' ' +$scope.comercio.auxsemana5;
        }
      }
      if($scope.auxsemanabutton6 == false){
        if ($scope.comercio.oqtem == undefined) {
          $scope.comercio.oqtem = $scope.comercio.auxsemana6;
        }else{
          $scope.comercio.oqtem = $scope.comercio.oqtem + ' ' +$scope.comercio.auxsemana6;
        }
      }
      if($scope.auxsemanabutton7 == false){
        if ($scope.comercio.oqtem == undefined) {
          $scope.comercio.oqtem = $scope.comercio.auxsemana;
        }else{
          $scope.comercio.oqtem = $scope.comercio.oqtem + ' ' +$scope.comercio.auxsemana7;
        }
      }


      // if (!$scope.comercio.horariofuncionamento && !$scope.comercio.semanafuncionamento) {
      //   var alertPopup = $ionicPopup.alert({
      //     title: '(⊙﹏⊙✿)',
      //     template: 'Selecione pelo menos um desses!'
      //   });
      // }else{
        //console.log($scope.comercio.oqtem)
        window.localStorage.setItem( 'criandocomercio', JSON.stringify($scope.comercio));
        formcontacomercio.updateForm($scope.comercio);
        $state.go('contacomerciodescricao');
      //}


            
  };
  $scope.Cancela = function () {
       window.localStorage.removeItem('criandocomercio')
       $state.go('novahomesemlogin')
    };



}])

.controller('contacomerciodescricaoCtrl', ['$scope', '$stateParams', '$state', 'EventoService', '$cordovaCamera', '$cordovaFile', '$cordovaFileTransfer', '$cordovaDevice', '$ionicPopup', '$cordovaActionSheet','$ionicLoading','$http','formCodigo', 'formcontacomercio', 'formUser', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, $state, EventoService, $cordovaCamera, $cordovaFile, $cordovaFileTransfer, $cordovaDevice, $ionicPopup, $cordovaActionSheet,$ionicLoading,$http,formCodigo, formcontacomercio,formUser) {
  $scope.comercio = {};
  $scope.$on("$ionicView.enter", function(event, data){
    $scope.comercio = JSON.parse( window.localStorage.getItem( 'criandocomercio' ));
    //cognitoUser = formCognito.getForm();

  });
  // $scope.Proximo = function() {
  //   if($scope.comercio.descricao){
  //     window.localStorage.setItem( 'criandocomercio',  JSON.stringify($scope.comercio));
  //     formcontacomercio.updateForm($scope.comercio);
  //     $state.go('contacomerciofoto');
  //   }
  // }

  $scope.Proximo = function(){
    //console.log($scope.comercio.infocomercio,"$scope.comercio.infocomercio", $scope.comercio.apelido)
    if($scope.comercio.infocomercio && $scope.comercio.incluso){
      window.localStorage.setItem( 'criandocomercio',  JSON.stringify($scope.comercio));
      formcontacomercio.updateForm($scope.comercio);
      $state.go('contacomerciofoto');
    }else{
      var alertPopup = $ionicPopup.alert({
        title: 'Por favor preencha os campos',
        template: 'Para podermos mostrar melhor para as pessoas sobre o você precisamos que você preencha todos os campos. Obrigado.'
      });
    }
  }

  $scope.Cancela = function () {
       window.localStorage.removeItem('criandocomercio')
       $state.go('novahomesemlogin')
    };
}])




 

.controller('contacomerciofotoCtrl', ['$scope', '$stateParams', '$state', 'EventoService', '$cordovaCamera', '$cordovaFile', '$cordovaFileTransfer', '$cordovaDevice', '$ionicPopup', '$cordovaActionSheet','$ionicLoading','$http','formCodigo', 'formcontacomercio','formUser', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, $state, EventoService, $cordovaCamera, $cordovaFile, $cordovaFileTransfer, $cordovaDevice, $ionicPopup, $cordovaActionSheet,$ionicLoading,$http,formCodigo, formcontacomercio,formUser) {
  $scope.comercio = {};
  $scope.$on("$ionicView.enter", function(event, data){
    $scope.comercio = JSON.parse( window.localStorage.getItem( 'criandocomercio' ));
    //cognitoUser = formCognito.getForm();
  });
  //cognitoUser = formCognito.getForm();
  //$scope.codigo = formCodigo.getForm();
  $scope.imgURI = "img/pessoasn/perfil.png";
 
    $scope.takePicture = function() {
      var optionsCamera = {
          quality : 100,
          destinationType : Camera.DestinationType.FILE_URL,
          sourceType : Camera.PictureSourceType.CAMERA,
          allowEdit : true,
          encodingType: Camera.EncodingType.JPEG,
          targetWidth: 640,
          targetHeight: 640,
          popoverOptions: CameraPopoverOptions,
          saveToPhotoAlbum: true
      };

      $cordovaCamera.getPicture(optionsCamera).then(function(imageData) {
          $scope.imgURI = imageData;
          
      }, function(err) {
      });
    }
    $scope.getPicture = function (optionsCamera) {
      var optionsCamera = {
            quality : 100,
            sourceType : 0,
            allowEdit : true,
            targetWidth: 640,
            targetHeight: 640
      };
      $cordovaCamera.getPicture(optionsCamera).then(function(imageData) {
        $scope.imgURI = imageData;
      }, function(err) {
        console.log(err);
      });
    };
    $scope.Cancela = function () {
       window.localStorage.removeItem('criandocomercio')
       $state.go('novahomesemlogin')
    };

  $scope.Proximo = function() {
    if($scope.imgURI == "img/pessoasn/perfil.png"){
      var alertPopup = $ionicPopup.alert({
        title: '(*ﾟｰﾟ)ゞ',
        template: 'Tire uma foto para as pessoas saberem quem tu é quando for conhecer elas'
      });
    }else{
       $ionicLoading.show({
        template: '<ion-spinner icon="ripple" class="spinner-diwo"></ion-spinner>'+
                  '<p style="color:#ff4444;font-weight:bold;font-family:Kollektif;padding:auto;margin:auto;">Tecendo uma nova conta!</p>'
      });

        var mystring = String($scope.comercio.email);
        mystring = mystring.replace(/[^a-zA-Z0-9]/g, '');
        $scope.comercio.profilepic = 'https://diwoappprofilepics.s3.amazonaws.com/profilepicsdiwo/' + mystring + '.jpg';
           
          //EventoService.CriaConta($scope.user);
        
            var url = "https://ec2.diwoapp.com.br/upload.php";
            // File for Upload
            var targetPath = $scope.imgURI;
           
            // File name only
            //var name = $scope.imgURI.substr(imageData.lastIndexOf('/') + 1);
            var filename = mystring + '.jpg';

            // NO CASO SERIA O NOME DO USUARIO.jpg O fileName
            var options = {
              fileKey: "file",
              fileName: filename,
              chunkedMode: false,
              mimeType: "multipart/form-data"
            };
            $cordovaFileTransfer.upload(url, targetPath, options).then(function(result) {
          
                EventoService.CriaContaUserComercio($scope.comercio).then(function(result) {
                  //console.log(result.success, "CriaContaUserComercio")
                  if(result.success){ 
                    EventoService.Entrando($scope.comercio).then(function(data){
                      //console.log(data[0].iduser , "Entrando")
                      $scope.comercio.iduser = data[0].iduser;
                      EventoService.CriaContaComercio($scope.comercio).then(function(result) {
                        if(result.success){ 
                          var alertPopup = $ionicPopup.alert({
                            title: 'Seu cadastro foi realizado com sucesso!',
                            template: 'Vamos conferir os dados fornecidos e entraremos em contato assim que aprovarmos a liberação dela em alguns dias!'
                          });
                          alertPopup.then(function(){
                            EventoService.Entrando($scope.comercio).then(function(data){
                              $ionicLoading.hide();
                              var res = $scope.comercio.interesse.split(" ") ;
                              for (var i = 0; i<res.length;i++){
                                if(res[i][0]!='#'){
                                  res[i]= '#' + res[i];
                                }
                                console.log(res[i], "tags")
                                var link = 'https://ec2.diwoapp.com.br/criarcategoria.php';
                                  $http.post(link, {iduser : data[0].iduser, 
                                                    categoria : res[i]}).then(function (res){console.log(res.success, "criou interesse")});
                              }
                              window.localStorage.setItem( 'user', JSON.stringify(data[0]));
                              window.localStorage.removeItem('criandocomercio');
                              formUser.updateForm(data[0]);
                              $state.go('novahomesemlogin');
                            })
                          }); 
                        }
                      });   
                    });
                  }
                });
              
              
              
            }, function(err) {
              $ionicPopup.alert({
                title: 'Sorry!',
                template: 'Aconteceu um probleminha, tente de novo'
              });
              $ionicLoading.hide();
            }, function (progress) {
             
            });
         
    }

  };

 

}])

.controller('onboardingcomercioCtrl', ['$scope', '$stateParams', '$state', 'EventoService', '$cordovaCamera', '$cordovaFile', '$cordovaFileTransfer', '$cordovaDevice', '$ionicPopup', '$cordovaActionSheet','$ionicLoading','$http','formCodigo', 'formcontacomercio', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, $state, EventoService, $cordovaCamera, $cordovaFile, $cordovaFileTransfer, $cordovaDevice, $ionicPopup, $cordovaActionSheet,$ionicLoading,$http,formCodigo, formcontacomercio) {
  
  $scope.pessoa = function () {
    $state.go('onboardingcomerciopessoa1')
  };
  $scope.negocio = function () {
    $state.go('onboardingcomercionegocio1')
  };
  $scope.Vercomofunciona = function () {
    window.location.href = "http://diwoapp.com.br/contas-de-parceiros-diwo-como-funciona/";
  };
  

}])

.controller('onboardingcomercionegocio1Ctrl', ['$scope', '$stateParams', '$state', 'EventoService', '$cordovaCamera', '$cordovaFile', '$cordovaFileTransfer', '$cordovaDevice', '$ionicPopup', '$cordovaActionSheet','$ionicLoading','$http','formCodigo', 'formcontacomercio', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, $state, EventoService, $cordovaCamera, $cordovaFile, $cordovaFileTransfer, $cordovaDevice, $ionicPopup, $cordovaActionSheet,$ionicLoading,$http,formCodigo, formcontacomercio) {
  
  $scope.Proximo = function () {
    $state.go('onboardingcomercionegocio2')
  };
  

}])
.controller('onboardingcomercionegocio2Ctrl', ['$scope', '$stateParams', '$state', 'EventoService', '$cordovaCamera', '$cordovaFile', '$cordovaFileTransfer', '$cordovaDevice', '$ionicPopup', '$cordovaActionSheet','$ionicLoading','$http','formCodigo', 'formcontacomercio', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, $state, EventoService, $cordovaCamera, $cordovaFile, $cordovaFileTransfer, $cordovaDevice, $ionicPopup, $cordovaActionSheet,$ionicLoading,$http,formCodigo, formcontacomercio) {
  
  $scope.Proximo = function () {
    $state.go('onboardingcomercionegocio3')
  };
  

}])
.controller('onboardingcomercionegocio3Ctrl', ['$scope', '$stateParams', '$state', 'EventoService', '$cordovaCamera', '$cordovaFile', '$cordovaFileTransfer', '$cordovaDevice', '$ionicPopup', '$cordovaActionSheet','$ionicLoading','$http','formCodigo', 'formcontacomercio', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, $state, EventoService, $cordovaCamera, $cordovaFile, $cordovaFileTransfer, $cordovaDevice, $ionicPopup, $cordovaActionSheet,$ionicLoading,$http,formCodigo, formcontacomercio) {
  
  $scope.Proximo = function () {
    $state.go('contacomercioemail')
  };

}])
.controller('onboardingcomercionegocio4Ctrl', ['$scope', '$stateParams', '$state', 'EventoService', '$cordovaCamera', '$cordovaFile', '$cordovaFileTransfer', '$cordovaDevice', '$ionicPopup', '$cordovaActionSheet','$ionicLoading','$http','formCodigo', 'formcontacomercio', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, $state, EventoService, $cordovaCamera, $cordovaFile, $cordovaFileTransfer, $cordovaDevice, $ionicPopup, $cordovaActionSheet,$ionicLoading,$http,formCodigo, formcontacomercio) {
  
  $scope.Proximo = function () {
    $state.go('contacomercioemail');
  };
  

}])
.controller('onboardingcomerciopessoa1Ctrl', ['$scope', '$stateParams', '$state', 'EventoService', '$cordovaCamera', '$cordovaFile', '$cordovaFileTransfer', '$cordovaDevice', '$ionicPopup', '$cordovaActionSheet','$ionicLoading','$http','formCodigo', 'formcontacomercio', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, $state, EventoService, $cordovaCamera, $cordovaFile, $cordovaFileTransfer, $cordovaDevice, $ionicPopup, $cordovaActionSheet,$ionicLoading,$http,formCodigo, formcontacomercio) {
  
  $scope.Proximo = function () {
    $state.go('onboardingcomerciopessoa2')
  };

}])
.controller('onboardingcomerciopessoa2Ctrl', ['$scope', '$stateParams', '$state', 'EventoService', '$cordovaCamera', '$cordovaFile', '$cordovaFileTransfer', '$cordovaDevice', '$ionicPopup', '$cordovaActionSheet','$ionicLoading','$http','formCodigo', 'formcontacomercio', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, $state, EventoService, $cordovaCamera, $cordovaFile, $cordovaFileTransfer, $cordovaDevice, $ionicPopup, $cordovaActionSheet,$ionicLoading,$http,formCodigo, formcontacomercio) {
  
  $scope.Proximo = function () {
    $state.go('onboardingcomerciopessoa3')
  };

}])
.controller('onboardingcomerciopessoa3Ctrl', ['$scope', '$stateParams', '$state', 'EventoService', '$cordovaCamera', '$cordovaFile', '$cordovaFileTransfer', '$cordovaDevice', '$ionicPopup', '$cordovaActionSheet','$ionicLoading','$http','formCodigo', 'formcontacomercio', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, $state, EventoService, $cordovaCamera, $cordovaFile, $cordovaFileTransfer, $cordovaDevice, $ionicPopup, $cordovaActionSheet,$ionicLoading,$http,formCodigo, formcontacomercio) {
  
  $scope.Proximo = function () {
    $state.go('contacomercioemail')
  };
  

}])
.controller('onboardingcomerciopessoa4Ctrl', ['$scope', '$stateParams', '$state', 'EventoService', '$cordovaCamera', '$cordovaFile', '$cordovaFileTransfer', '$cordovaDevice', '$ionicPopup', '$cordovaActionSheet','$ionicLoading','$http','formCodigo', 'formcontacomercio', // The following is the constructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $stateParams, $state, EventoService, $cordovaCamera, $cordovaFile, $cordovaFileTransfer, $cordovaDevice, $ionicPopup, $cordovaActionSheet,$ionicLoading,$http,formCodigo, formcontacomercio) {
  
  $scope.Proximo = function () {
    $state.go('contacomercioemail')
  };

}])

.controller('PagSeguroEnderecoCtrl', ['$scope', '$state', '$stateParams','$ionicPopup', '$ionicTabsDelegate','formUser','formPagSeguro','EventoService',  //nstructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $state, $stateParams,$ionicPopup,$ionicTabsDelegate, formUser,formPagSeguro, EventoService) {

 $scope.disableTap = function(){
     container = document.getElementsByClassName('pac-container');
     // disable ionic data tab
     angular.element(container).attr('data-tap-disabled', 'true');
     // leave input field if google-address-entry is selected
     angular.element(container).on("click", function(){
                                   document.getElementById('searchTextField').blur();
                                   });
  };
    
  var input = document.getElementById('searchTextField');
  var autocomplete = new google.maps.places.Autocomplete(input);
     
  $scope.cidade = autocomplete.getPlace();

  $scope.reserva = formPagSeguro.getForm();
  $scope.user =formUser.getForm();
  $scope.dados = {};
  var geocoder = new google.maps.Geocoder();
  $scope.Confirmar = function(){
   
    $scope.cidade = autocomplete.getPlace();
    if($scope.cidade){
      for(var i = 0;i<$scope.cidade.address_components.length;i++){
        //console.log($scope.cidade.address_components[i].types[0] , i , $scope.cidade.address_components[i].long_name)
        if($scope.cidade.address_components[i].types[0] == "administrative_area_level_1"){
          $scope.user.estadoendereco = $scope.cidade.address_components[i].short_name;
        }
        if($scope.cidade.address_components[i].types[0] == "administrative_area_level_2"){
          $scope.user.cidade = $scope.cidade.address_components[i].long_name;
        }
        if($scope.cidade.address_components[i].types[0] == "sublocality_level_1"){
          $scope.user.bairro = $scope.cidade.address_components[i].long_name;
        }
        if($scope.cidade.address_components[i].types[0] == "route"){
          $scope.user.endereco = $scope.cidade.address_components[i].long_name;
        }
        if($scope.cidade.address_components[i].types[0] == "postal_code"){
          $scope.user.cep = $scope.cidade.address_components[i].long_name;
          console.log($scope.user.cep, "scope.user.cep")
        }
        
        // if($scope.cidade.address_components[i].types[0] == "country"){
        //   $scope.user.pais = $scope.cidade.address_components[i].long_name;
        // }
      }
      if(i==$scope.cidade.address_components.length){
        var auxendereco =  $scope.user.endereco + ', '+ $scope.user.numeroendereco + ', '+$scope.user.cidade+ ', '+$scope.user.estadoendereco
       console.log(auxendereco, "auxendereco")
        geocoder.geocode({'address': auxendereco}, function(results, status) {
          if (status === 'OK') {
            if (results[0]) {
              
              console.log(results[0],"results[0]")
              $scope.cidade = results[0];
              for(var j = 0;j<$scope.cidade.address_components.length;j++){
                console.log($scope.cidade.address_components[i].types[0] , i , $scope.cidade.address_components[i].long_name)
                if($scope.cidade.address_components[j].types[0] == "administrative_area_level_1"){
                  $scope.user.estadoendereco = $scope.cidade.address_components[j].short_name;
                }
                if($scope.cidade.address_components[j].types[0] == "administrative_area_level_2"){
                  $scope.user.cidade = $scope.cidade.address_components[j].long_name;
                }
                if($scope.cidade.address_components[j].types[0] == "sublocality_level_1"){
                  $scope.user.bairro = $scope.cidade.address_components[j].long_name;
                }
                if($scope.cidade.address_components[j].types[0] == "route"){
                  $scope.user.endereco = $scope.cidade.address_components[j].long_name;
                }
                if($scope.cidade.address_components[j].types[0] == "postal_code"){
                  $scope.user.cep = $scope.cidade.address_components[j].long_name;
                  //console.log($scope.user.cep, "scope.user.cep")
                }
              }
              var codigovalido = 0;
              if(j==$scope.cidade.address_components.length){
                $scope.reserva.billingAddressStreet = $scope.user.endereco;
                $scope.reserva.billingAddressNumber = $scope.user.numeroendereco;
                $scope.reserva.billingAddressDistrict = $scope.user.bairro;
                $scope.reserva.billingAddressPostalCode = ($scope.user.cep.toString()).replace('-','');
                $scope.reserva.billingAddressCity = $scope.user.cidade;
                $scope.reserva.billingAddressState = $scope.user.estadoendereco;
                formPagSeguro.updateForm($scope.reserva);
                
                $scope.dados.iduser = $scope.user.iduser;
                $scope.dados.username = $scope.user.username;
                $scope.dados.creditCardHolderBirthDate = $scope.reserva.creditCardHolderBirthDate
                $scope.dados.senderName = $scope.reserva.senderName;
                $scope.dados.senderAreaCode = $scope.reserva.senderAreaCode;
                $scope.dados.senderPhone = $scope.reserva.senderPhone;
                $scope.dados.senderEmail = $scope.reserva.senderEmail;
                $scope.dados.senderCPF = $scope.reserva.senderCPF;
                $scope.dados.billingAddressStreet = $scope.user.endereco;
                $scope.dados.billingAddressNumber = $scope.user.numeroendereco;
                $scope.dados.billingAddressDistrict = $scope.user.bairro;
                $scope.dados.billingAddressPostalCode = ($scope.user.cep.toString()).replace('-','');
                $scope.dados.billingAddressCity = $scope.user.cidade;
                $scope.dados.billingAddressState = $scope.user.estadoendereco;
                $scope.dados.billingAddressComplement = $scope.user.complemento;

                // var encrypted = CryptoJS.AES.encrypt($scope.reserva.NumCartao.toString(), "diwoapp");
                // $scope.dados.NumCartao = encrypted.toString();
                // var encrypted2 = CryptoJS.AES.encrypt($scope.reserva.NumCVV.toString(), "diwoapp");
                // $scope.dados.NumCVV = encrypted2.toString();
                $scope.dados.NumCartao = $scope.reserva.NumCartao
                $scope.dados.NumCVV = $scope.reserva.NumCVV;
                $scope.dados.bandeiraNome = $scope.reserva.bandeiraNome;
                $scope.dados.expirationMonth = $scope.reserva.expirationMonth;
                $scope.dados.expirationYear = $scope.reserva.expirationYear;

                EventoService.Salvacc($scope.dados);
                $state.go('tabsController.PagSeguroConfirmaCompra');
              }
            } else {
              window.alert('No results found');
            }
          } else {
            window.alert('Geocoder failed due to: ' + status);
          }
        });
       
      }
    
      
        
      
    }else{
      $scope.reserva.billingAddressStreet = $scope.user.endereco;
      $scope.reserva.billingAddressNumber = $scope.user.numeroendereco;
      $scope.reserva.billingAddressDistrict = $scope.user.bairro;
      $scope.reserva.billingAddressPostalCode = ($scope.user.cep.toString()).replace('-','');
      $scope.reserva.billingAddressCity = $scope.user.cidade;
      $scope.reserva.billingAddressState = $scope.user.estadoendereco;
      formPagSeguro.updateForm($scope.reserva);

      $scope.dados.iduser = $scope.user.iduser;
      $scope.dados.username = $scope.user.username;
      $scope.dados.creditCardHolderBirthDate = $scope.reserva.creditCardHolderBirthDate
      $scope.dados.senderName = $scope.reserva.senderName;
      $scope.dados.senderAreaCode = $scope.reserva.senderAreaCode;
      $scope.dados.senderPhone = $scope.reserva.senderPhone;
      $scope.dados.senderEmail = $scope.reserva.senderEmail;
      $scope.dados.senderCPF = $scope.reserva.senderCPF;
      $scope.dados.billingAddressStreet = $scope.user.endereco;
      $scope.dados.billingAddressNumber = $scope.user.numeroendereco;
      $scope.dados.billingAddressDistrict = $scope.user.bairro;
      $scope.dados.billingAddressPostalCode = ($scope.user.cep.toString()).replace('-','');
      $scope.dados.billingAddressCity = $scope.user.cidade;
      $scope.dados.billingAddressState = $scope.user.estadoendereco;
      $scope.dados.billingAddressComplement = $scope.user.complemento;

      // var encrypted = CryptoJS.AES.encrypt($scope.reserva.NumCartao.toString(), "diwoapp");
      // $scope.dados.NumCartao = encrypted.toString();
      // var encrypted2 = CryptoJS.AES.encrypt($scope.reserva.NumCVV.toString(), "diwoapp");
      // $scope.dados.NumCVV = encrypted2.toString();
      $scope.dados.NumCartao = $scope.reserva.NumCartao
      $scope.dados.NumCVV = $scope.reserva.NumCVV;
      $scope.dados.bandeiraNome = $scope.reserva.bandeiraNome;
      $scope.dados.expirationMonth = $scope.reserva.expirationMonth;
      $scope.dados.expirationYear = $scope.reserva.expirationYear;

      EventoService.Salvacc($scope.dados);
      $state.go('tabsController.PagSeguroConfirmaCompra');
    }
  }

}])

.controller('PagSeguroNomeContaCtrl', ['$scope', '$state', '$stateParams','$ionicPopup', '$ionicTabsDelegate','formUser','formPagSeguro','EventoService',  //nstructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $state, $stateParams,$ionicPopup,$ionicTabsDelegate, formUser,formPagSeguro, EventoService) {
  $scope.reserva = formPagSeguro.getForm();
  $scope.user =formUser.getForm();

  $scope.confirmar = function(){
    if(!$scope.reserva.senderName){
      $ionicPopup.alert({
        title: 'Atenção!',
        template: 'Precisamos do nome como no cartão'
      });
    }else{
      if(!$scope.reserva.creditCardHolderCPF){
        $ionicPopup.alert({
          title: 'Atenção!',
          template: 'Precisamos do CPF do titular'
        });
      }else{
        if(!$scope.reserva.creditCardHolderPhone){
          $ionicPopup.alert({
            title: 'Atenção!',
            template: 'Precisamos de número para contato'
          });
        }else{
          if(!$scope.reserva.auxcreditCardHolderBirthDate){
            $ionicPopup.alert({
              title: 'Atenção!',
              template: 'Precisamos de uma data de nascimento válida'
            });
          }else{
            var curr_date2 = ($scope.reserva.auxcreditCardHolderBirthDate.getDate()<10?'0':'') + ($scope.reserva.auxcreditCardHolderBirthDate.getDate());
            var curr_month2 = ($scope.reserva.auxcreditCardHolderBirthDate.getMonth()<10?'0':'') + ($scope.reserva.auxcreditCardHolderBirthDate.getMonth()+1) ;

            var  curr_year2= $scope.reserva.auxcreditCardHolderBirthDate.getFullYear();
            $scope.reserva.creditCardHolderBirthDate = curr_date2+'/'+curr_month2+'/'+curr_year2;  
            $scope.reserva.creditCardHolderName = $scope.reserva.senderName;
            $scope.reserva.senderAreaCode = $scope.reserva.creditCardHolderAreaCode;
            $scope.reserva.senderPhone = $scope.reserva.creditCardHolderPhone;
            $scope.reserva.senderEmail = "c72858014035059338109@sandbox.pagseguro.com.br";
            $scope.reserva.senderCPF = $scope.reserva.creditCardHolderCPF;
            formPagSeguro.updateForm($scope.reserva);
            $state.go('tabsController.PagSeguroEndereco')
          }
        }
      }
    }
    
  }
}])

.controller('PagSeguroMetodoCtrl', ['$scope', '$state', '$stateParams','$ionicPopup', '$ionicTabsDelegate','formUser','formPagSeguro','EventoService', '$ionicLoading',  //nstructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $state, $stateParams,$ionicPopup,$ionicTabsDelegate, formUser,formPagSeguro, EventoService, $ionicLoading) {

  $scope.reserva = {};
  $scope.reserva.expirationMonth = 12
  $scope.reserva.expirationYear = 2030
  $ionicTabsDelegate.showBar(0);

  //$scope.bandeiras = formPagSeguro.getForm();
  
  // var imgBand1 = 'https://stc.pagseguro.uol.com.br'+$scope.bandeiras.paymentMethods.CREDIT_CARD.options.MASTERCARD.images.MEDIUM.path
  // var imgBand2 = 'https://stc.pagseguro.uol.com.br'+$scope.bandeiras.paymentMethods.ONLINE_DEBIT.options.BANCO_BRASIL.images.MEDIUM.path
  // var imgBand3 = 'https://stc.pagseguro.uol.com.br'+$scope.bandeiras.paymentMethods.BOLETO.options.BOLETO.images.MEDIUM.path
    

  // document.getElementById("imgBandeira1").src=imgBand1
  // document.getElementById("imgBandeira2").src=imgBand2
  // document.getElementById("imgBandeira3").src=imgBand3
  //console.log(imgBand1)

  // $scope.escolhepagarCartaoCredito = false;

  // PagSeguroDirectPayment.onSenderHashReady(function(response){
  //     if(response.status == 'error') {
  //         console.log(response.message);
  //         return false;
  //     }
  //     var hash = response.senderHash; //Hash estará disponível nesta variável.
  //     console.log(hash)
  // });

  $scope.Bandeiraescolhida = false;
  $scope.reserva.tipoPagamento = 'CREDIT_CARD';

  $scope.AdicionarCartaoCredito = function(){
    $scope.escolhepagarCartaoCredito = true;
    $scope.Bandeiraescolhida = false;
    $scope.reserva.tipoPagamento = 'CREDIT_CARD';
    $scope.reserva.NumCartao = '';
    $scope.reserva.bandeiraNome = '';
    $scope.reserva.NumCVV  = '';
    $scope.reserva.expirationMonth = '';
    $scope.reserva.expirationYear = '';
    if($scope.reserva.NumCVV.toString().length>=2){
      $scope.proximatela = true;
    }
    EventoService.PagSeguroTests().then(function(response){
      PagSeguroDirectPayment.setSessionId(response);
      PagSeguroDirectPayment.getPaymentMethods({
        amount: 500.00,
        success: function(response) {
            // Retorna os meios de pagamento disponíveis.
            console.log(response)
            formPagSeguro.updateForm(response)
           
        },
        error: function(response) {
          //console.log("error", JSON.stringify(response))
            // Callback para chamadas que falharam.
        },
        complete: function(response) {
          //console.log("complete", JSON.stringify(response))
          //formPagSeguro.updateForm(response)
          //$state.go('tabsController.PagSeguroMetodo')
            // Callback para todas chamadas.
        }
      });
    })
  }

  // $scope.Boleto = function(){
  //   $scope.escolhepagarCartaoCredito = false;
  //   $scope.Bandeiraescolhida = false;
  //   PagSeguroDirectPayment.onSenderHashReady(function(response){
  //     $scope.reserva.hash = response.senderHash;
  //     $scope.reserva.tipoPagamento = 'BOLETO';
  //     formPagSeguro.updateForm($scope.reserva)
  //     console.log($scope.reserva.hash,"$scope.reserva.senderHash")
  //     $state.go('tabsController.PagSeguroDadosBoleto')
  //   });
  // }

  // $scope.CartaoDebito = function(){
  //   $scope.escolhepagarCartaoCredito = false;
  //   $scope.Bandeiraescolhida = false;
  //   PagSeguroDirectPayment.onSenderHashReady(function(response){
  //     $scope.reserva.hash = response.senderHash;
  //     $scope.reserva.tipoPagamento = 'DEBIT_CARD';
  //     formPagSeguro.updateForm($scope.reserva)
  //     console.log($scope.reserva.hash,"$scope.reserva.senderHash")
  //     $state.go('tabsController.PagSeguroDadosBoleto')
  //   });
  // }

  var inputNumCC = document.getElementById("inputNumberCC");

  inputNumCC.addEventListener("keyup",function(){
    //console.log($scope.reserva.NumCartao)
    var QtdCaracteres=$scope.reserva.NumCartao.toString().length;
    console.log(QtdCaracteres)
    if(QtdCaracteres == 6){
      console.log(QtdCaracteres)
        PagSeguroDirectPayment.getBrand({
            cardBin: $scope.reserva.NumCartao,
            success: function(response) {
                $scope.reserva.bandeiraNome=response.brand.name;
                console.log($scope.reserva.bandeiraNome)
                $scope.Bandeiraescolhida = true;
                var  auximg ="https://stc.pagseguro.uol.com.br/public/img/payment-methods-flags/68x30/"+$scope.reserva.bandeiraNome+".png";
                console.log(auximg )
                document.getElementById("imgBandeiraEscolhida").src = auximg
                //$('.BandeiraCartao').html("<img src=https://stc.pagseguro.uol.com.br/public/img/payment-methods-flags/42x20/"+BandeiraImg+".png>")
            },
            error: function (response) {
              $scope.reserva.NumCartao = '';
              $scope.Bandeiraescolhida = false;
                console('Cartão não reconhecido');
                //$('.BandeiraCartao').empty();
            }
        });
    }
  });

  var inputNumCVV = document.getElementById("inputNumberCVV");
  
  inputNumCVV.addEventListener("keyup",function(){
    var QtdCaracteresCVV=$scope.reserva.NumCVV.toString().length;
    console.log(QtdCaracteresCVV)
    if(QtdCaracteresCVV >= 2){
      console.log(QtdCaracteresCVV)
      $scope.proximatela = true;
    }
  });
  
  var repetecartao = 0

  $scope.Comprar = function(){
    EventoService.GetCCs($scope.reserva.NumCartao).then(function(items){
        console.log(items, "response")
        if(items!='E'){
          $ionicPopup.alert({
                title: 'Cartão inválido',
                template: 'Já existe um cartão cadastrado com esse número, por favor selecione-o acima ou adicione outro cartão'
              });
        }else{
          console.log($scope.reserva.NumCartao, $scope.reserva.bandeiraNome, $scope.reserva.NumCVV, $scope.reserva.expirationMonth, $scope.reserva.expirationYear)
          PagSeguroDirectPayment.createCardToken({
              cardNumber: $scope.reserva.NumCartao,
              brand: $scope.reserva.bandeiraNome,
              cvv: $scope.reserva.NumCVV,
              expirationMonth: $scope.reserva.expirationMonth,
              expirationYear: $scope.reserva.expirationYear,
              success: function(response)
              {
                //console.log(response.card.token)
                 $scope.reserva.creditCardToken = response.card.token;
                 console.log($scope.reserva.creditCardToken)
              }
          });
          PagSeguroDirectPayment.onSenderHashReady(function(response){
             $scope.reserva.hash = response.senderHash;
             formPagSeguro.updateForm($scope.reserva)
             console.log($scope.reserva.hash,"$scope.reserva.senderHash")
             if($scope.reserva.creditCardToken){
              $state.go('tabsController.PagSeguroNomeConta')
             }
             
          });
       }

      });
   
    
  }

  $scope.enterItem = function(cartaoCredito){
    $ionicLoading.show({
          template: '<ion-spinner icon="ripple" class="spinner-diwo"></ion-spinner>'+
                    '<p style="color:#ff4444;font-weight:bold;font-family:Kollektif;padding:auto;margin:auto;">Aguarde enquanto verificamos o cartão</p>'
    });
    $scope.reserva.NumCartao = cartaoCredito.NumCartao;
    $scope.reserva.bandeiraNome = cartaoCredito.bandeiraNome;
    $scope.reserva.NumCVV  = cartaoCredito.NumCVV;
    $scope.reserva.expirationMonth = cartaoCredito.expirationMonth;
    $scope.reserva.expirationYear = cartaoCredito.expirationYear;

    $scope.reserva.billingAddressStreet = cartaoCredito.billingAddressStreet;
    $scope.reserva.billingAddressNumber = cartaoCredito.billingAddressNumber;
    $scope.reserva.billingAddressDistrict = cartaoCredito.billingAddressDistrict;
    $scope.reserva.billingAddressPostalCode = cartaoCredito.billingAddressPostalCode;
    $scope.reserva.billingAddressCity = cartaoCredito.billingAddressCity;
    $scope.reserva.billingAddressState = cartaoCredito.billingAddressState;
    $scope.reserva.billingAddressComplement = cartaoCredito.billingAddressComplement;
    $scope.reserva.creditCardHolderBirthDate = cartaoCredito.creditCardHolderBirthDate;
    $scope.reserva.creditCardHolderName = cartaoCredito.senderName
    $scope.reserva.senderName = cartaoCredito.senderName;
    $scope.reserva.senderAreaCode = cartaoCredito.senderAreaCode;
    $scope.reserva.creditCardHolderAreaCode = cartaoCredito.senderAreaCode;
    $scope.reserva.senderPhone = cartaoCredito.senderPhone;
    $scope.reserva.creditCardHolderPhone = cartaoCredito.senderPhone;
    $scope.reserva.senderEmail = cartaoCredito.senderEmail;
    $scope.reserva.senderCPF = cartaoCredito.senderCPF;
    $scope.reserva.creditCardHolderCPF = cartaoCredito.senderCPF;

    console.log($scope.reserva.NumCartao, $scope.reserva.bandeiraNome, $scope.reserva.NumCVV, $scope.reserva.expirationMonth, $scope.reserva.expirationYear)
    
    EventoService.PagSeguroTests().then(function(response){
      PagSeguroDirectPayment.setSessionId(response);
      PagSeguroDirectPayment.getPaymentMethods({
        amount: 500.00,
        success: function(response) {
            // Retorna os meios de pagamento disponíveis.
            console.log(response)
            formPagSeguro.updateForm(response)
            PagSeguroDirectPayment.createCardToken({
                cardNumber: $scope.reserva.NumCartao,
                brand: $scope.reserva.bandeiraNome,
                cvv: $scope.reserva.NumCVV,
                expirationMonth: $scope.reserva.expirationMonth,
                expirationYear: $scope.reserva.expirationYear,
                success: function(response)
                {
                  //console.log(response.card.token)
                   $scope.reserva.creditCardToken = response.card.token;
                   console.log($scope.reserva.creditCardToken)
                }
            });
            PagSeguroDirectPayment.onSenderHashReady(function(response){
               $scope.reserva.hash = response.senderHash;
               formPagSeguro.updateForm($scope.reserva)
               $ionicLoading.hide();
               console.log($scope.reserva.hash,"$scope.reserva.senderHash")
               $state.go('tabsController.PagSeguroConfirmaCompra')
            });
           
        },
        error: function(response) {
          //console.log("error", JSON.stringify(response))
            // Callback para chamadas que falharam.
        },
        complete: function(response) {
          //console.log("complete", JSON.stringify(response))
          //formPagSeguro.updateForm(response)
          //$state.go('tabsController.PagSeguroMetodo')
            // Callback para todas chamadas.
        }
      });
    })


    
  }


    $scope.$on("$ionicView.enter", function(event, data){
      $ionicTabsDelegate.showBar(0);
      $scope.user =formUser.getForm();
      $scope.items = {};
      EventoService.GetUserCC($scope.user).then(function(items){
        console.log(items, "response")
        if(items!='E'){
          $scope.items = items;
        }else{
          $scope.items = [];
        }

      });
      
    });

   // var card = {} ;
   //  card.card_holder_name = $scope.reserva.senderName
   //  card.card_expiration_date = $scope.reserva.expirationMonth + '/' + $scope.reserva.expirationYear
   //  card.card_number = $scope.reserva.NumCartao
   //  card.card_cvv = $scope.reserva.bandeiraNome

   //  // pega os erros de validação nos campos do form e a bandeira do cartão
   //  var cardValidations = pagarme.validate({card: card})
    
   //  //Então você pode verificar se algum campo não é válido
   //  if(!cardValidations.card.card_number)
   //    console.log('Oops, número de cartão incorreto')
     
   //  //Mas caso esteja tudo certo, você pode seguir o fluxo
   //  pagarme.client.connect({ encryption_key: 'SUA_ENCRYPTION_KEY' })
   //    .then(client => client.security.encrypt(card))
   //    .then(card_hash => console.log(card_hash))
   //    // o próximo passo aqui é enviar o card_hash para seu servidor, e
   //    // em seguida criar a transação/assinatura

}])

.controller('PagSeguroConfirmaCompraCtrl', ['$scope', '$state', '$stateParams','$ionicPopup', '$ionicTabsDelegate','formUser','formPagSeguro','EventoService','formItem', '$ionicLoading','$http',   //nstructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $state, $stateParams,$ionicPopup,$ionicTabsDelegate, formUser,formPagSeguro, EventoService, formItem, $ionicLoading, $http) {
  
  $scope.reserva = formPagSeguro.getForm();
  $scope.evento = formItem.getForm();
  $scope.user = formUser.getForm();
  $scope.reserva.installmentValue = parseFloat($scope.evento.preco);
  $scope.reserva.itemAmount1 = parseFloat($scope.evento.preco);
  //$scope.reserva.reference = $scope.evento.idevento;
  $scope.reserva.installmentValue = $scope.reserva.installmentValue.toFixed(2);
  $scope.reserva.itemAmount1 = $scope.reserva.itemAmount1.toFixed(2);
  $scope.reserva.itemAmount1.toString();
  $scope.reserva.iduser = $scope.user.iduser;
  $scope.reserva.devicetoken = $scope.user.devicetoken;
  $scope.reserva.idevento = $scope.evento.idevento;
  var  hjl =$scope.evento.dialimiteconfirmacao;
  $scope.evento.limitedia =  (hjl[8]+hjl[9]).valueOf()+'/'+(hjl[5]+hjl[6]).valueOf();
  $scope.evento.limitehora =  (hjl[11]+hjl[12]).valueOf()+':'+(hjl[14]+hjl[15]).valueOf();

  
  var hj = $scope.evento.diainicio;
  var ano = (hj[0]+hj[1]+hj[2]+hj[3]).valueOf();
  var mes = (hj[5]+hj[6]).valueOf();
  var dia = (hj[8]+hj[9]).valueOf();
  var h = (hj[11]+hj[12]).valueOf();
  var m = (hj[14]+hj[15]).valueOf();
  var hjf = $scope.evento.diafim;
  $scope.evento.fimdia =  (hjf[8]+hjf[9]).valueOf()+'/'+(hjf[5]+hjf[6]).valueOf()+'/'+(hjf[0]+hjf[1]+hjf[2]+hjf[3]);
  $scope.evento.fimhora = (hjf[11]+hjf[12]).valueOf()+':'+(hjf[14]+hjf[15]).valueOf();
  $scope.evento.diadia = dia+'/'+mes;
  $scope.reserva.reference = $scope.user.iduser + 'ev' +$scope.evento.idevento + 'num' +mes+ dia+h+m
  if($scope.evento.limitedia == $scope.evento.diadia ){
    $scope.evento.limsemana = $scope.evento.semana ;
  }else{
    if($scope.evento.semana == "Segunda-feira"){
      $scope.evento.limsemana = "Domingo";
    }
    if($scope.evento.semana == "Terça-feira"){
      $scope.evento.limsemana = "Segunda-feira";
    }
    if($scope.evento.semana == "Quarta-feira"){
      $scope.evento.limsemana = "Terça-feira";
    }
    if($scope.evento.semana == "Quinta-feira"){
      $scope.evento.limsemana = "Quarta-feira";
    }
    if($scope.evento.semana == "Sexta-feira"){
      $scope.evento.limsemana = "Quinta-feira";
    }
    if($scope.evento.semana == "Sábado"){
      $scope.evento.limsemana = "Sexta-feira";
    }
    if($scope.evento.semana == "Domingo"){
      $scope.evento.limsemana = "Sábado";
    }
  }
  $scope.Comprar = function(){
    $ionicLoading.show({
          template: '<ion-spinner icon="ripple" class="spinner-diwo"></ion-spinner>'+
                    '<p style="color:#ff4444;font-weight:bold;font-family:Kollektif;padding:auto;margin:auto;">Fazendo reserva</p>'
    });
    if( $scope.reserva.tipoPagamento == 'BOLETO'){
      EventoService.PagSeguroBoleto($scope.reserva).then(function(response){
        console.log(response);
      });
    }
    if( $scope.reserva.tipoPagamento == 'CREDIT_CARD'){
      EventoService.PagSeguroCC($scope.reserva).then(function(response){
        if(response.code[0]){
          $scope.reserva.code = response.code[0];
          $scope.reserva.datadepagamento = response.date[0];
          EventoService.PagamentosCria($scope.reserva).then(function(response){
            

            $http.post('https://ec2.diwoapp.com.br/pessoanaoevento.php', {iduser : $scope.user.iduser, 
                                                                    idevento : $scope.evento.idevento,
                                                                    nomeevento : $scope.evento.nomeevento,
                                                                    estado : '10'}).then(function(resp) {//aceitou ir evento, nao mostra mais feed
              if(resp.data.success){
                var noti = {};
                $scope.pushnoti = {};
                          if (!$scope.evento.idevento || !$scope.user.iduser) {
                                          var alertPopup = $ionicPopup.alert({
                                          title: 'Vish deu ruim',
                                          template: 'Favor refaça seu login'
                                        });

                          }else{
                            if($scope.evento.tipodeevento){
                              if($scope.evento.zone == 'yellow'){
                                var confirmPopup = $ionicPopup.show({
                                     title: 'ZONA AMARELA',
                                     template: 'Evento esta na ZONA AMARELA, caso voce desista uma vez que confirmado a presença tu sofrerás um cartão amarelo. Deseja ir mesmo assim?',
                                     buttons: [
                                        { text: 'Não sei se vou',
                                          type: 'button-assertive',
                                          onTap: function(e){
                                            console.log('nada acontece');
                                          }},
                                        {
                                          text: 'Quero ir',
                                          type: 'button-positive',
                                          onTap: function(e){
                                            $scope.confirmacao = 'Aguardando confirmação do pagamento';
                                            $scope.estado = '1';
                                  var link = 'https://ec2.diwoapp.com.br/ireventopago.php';
                                  $http.post(link, {idevento : $scope.evento.idevento,
                                                  idadm : $scope.evento.adm, 
                                                  admusername : $scope.evento.admusername, 
                                                  diainicio : $scope.evento.diainicio,
                                                  diafim : $scope.evento.diafim,
                                                  iduser : $scope.user.iduser,
                                                  borda : $scope.user.borda,
                                                  username: $scope.user.username,
                                                  profilepic : $scope.user.profilepic,
                                                  devicetoken : $scope.user.devicetoken,
                                                  apelido : $scope.user.apelido,
                                                  confirmacao : $scope.confirmacao,
                                                  nomeevento :  $scope.evento.nomeevento,
                                                  eventopic : $scope.evento.eventopic,
                                                  idComercioParceiro : $scope.evento.idComercioParceiro, 
                                                  estado : $scope.estado,
                                                  reference : $scope.reserva.reference}).then(function (res){
                                    $scope.response = res.data;
                                    
                                    $http.post('https://ec2.diwoapp.com.br/deletapessoaevento.php', {iduser : $scope.user.iduser,
                                                                                                idevento : $scope.evento.idevento,
                                                                                                estado: '5'});
                                    if ($scope.response.success == true) {
                                      $scope.evento.patual = parseInt($scope.evento.patual)+1;
                                      $http.post('https://ec2.diwoapp.com.br/addpessoaevento.php', {idevento : $scope.evento.idevento,
                                                                                      patual : $scope.evento.patual});
                                      console.log($scope.evento.patual,$scope.evento.pmin , 'Número de pessoas alcançado do evento ')
                                      if(parseInt($scope.evento.patual) == parseInt($scope.evento.pmin)){
                                        EventoService.GetUserPorId($scope.evento.idComercioParceiro).then(function(comercio) {
                                          $scope.msgnotiComercio = ('Número mínimo de pessoas alcançado do evento ' + $scope.evento.nomeevento );
                                          noti.recebeusername = comercio.username;
                                          noti.recebe = comercio.idComercioParceiro;
                                          noti.envia = comercio.idComercioParceiro;
                                          noti.tipo = 51;   //evento bateu numero minimo de pessoas para acontecer
                                          noti.nomeevento = $scope.evento.nomeevento;
                                            EventoService.VerificaNotificacao(noti).then(function(res) {
                                            if(res){
                                              $http.post('https://ec2.diwoapp.com.br/notificapessoa.php', {notificacao : $scope.msgnotiComercio, 
                                                            idevento : $scope.evento.idevento,
                                                            nomeevento : $scope.evento.nomeevento,
                                                            id_user_envia : $scope.evento.idComercioParceiro,
                                                            username_envia : $scope.evento.nomeevento,
                                                            apelido_envia : $scope.evento.nomeevento,
                                                            tipo : '51',
                                                            id_user_recebe : $scope.evento.idComercioParceiro});
                                                $scope.pushnoti.titulo =  'Número de pessoas alcançado!' ;
                                                $scope.pushnoti.msg = $scope.msgnotiComercio;
                                                $scope.pushnoti.token = comercio.devicetoken;
                                                EventoService.MandaPushNoti($scope.pushnoti);
                                                $scope.pushnoti.titulo =  'Número de pessoas alcançado!' ;
                                                $scope.pushnoti.msg = $scope.msgnotiComercio;
                                                $scope.pushnoti.token = 'dKpOML7ZLIA:APA91bFhTghUqP4gpCkohaf3h1WzCjDwQTrMg2JbUJjEQ9WegZgXWZQSNWtwoeAIu98bLK6wtSByVo1jluGyPmVmBxrvEWu6sluypuLk6O7F_18Z_e2kko7UQdK16Hu7O4qxsvstCmSI';
                                                EventoService.MandaPushNoti($scope.pushnoti);
                                            }
                                          });
                                        });
                                      }
                                      $http.post("https://ec2.diwoapp.com.br/deletanotificacaoporids.php", {id_user_recebe : noti.recebe,
                                                                                                id_user_envia: noti.envia,
                                                                                                nomeevento: noti.nomeevento,
                                                                                                tipo : '5'});
                                      
                                        $http.post('https://ec2.diwoapp.com.br/deletapessoaevento.php', {iduser : $scope.user.iduser,
                                                                                                idevento : $scope.evento.idevento,
                                                                                                estado: '7'}).then(function (res){
                                        $scope.response = res.data;
                                        $ionicLoading.hide();
                                        var alertPopup = $ionicPopup.alert({
                                            title: 'Reserva realizada',
                                            template: 'Reserva esta sendo realizada com sucesso, quando ela for confirmada estaremos te avisando'
                                          });
                                        alertPopup.then(function(){
                                          $state.go('tabsController.home')
                                        });
                                       
                                        });
                                       
                                      
                                    }else{
                                      var alertPopup = $ionicPopup.alert({
                                        title: 'Ocorreu uma falha',
                                        template: $scope.response.msg
                                      });
                                    }
                                    console.log($scope.response.msg);
                                });
                                          }}]
                                   });
                              }else{
                                  $scope.confirmacao = 'Aguardando confirmação do pagamento';
                                  $scope.estado = '1';
                                  //console.log($scope.evento.idComercioParceiro, "ANSUIDNAIUSnd", $scope.evento.nomeevento);
                                  var link = 'https://ec2.diwoapp.com.br/ireventopago.php';
                                  $http.post(link, {idevento : $scope.evento.idevento,
                                                  idadm : $scope.evento.adm, 
                                                  admusername : $scope.evento.admusername, 
                                                  diainicio : $scope.evento.diainicio,
                                                  diafim : $scope.evento.diafim,
                                                  iduser : $scope.user.iduser,
                                                  borda : $scope.user.borda,
                                                  username: $scope.user.username,
                                                  profilepic : $scope.user.profilepic,
                                                  devicetoken : $scope.user.devicetoken,
                                                  apelido : $scope.user.apelido,
                                                  confirmacao : $scope.confirmacao,
                                                  nomeevento :  $scope.evento.nomeevento, 
                                                  eventopic : $scope.evento.eventopic,
                                                  idComercioParceiro : $scope.evento.idComercioParceiro, 
                                                  estado : $scope.estado,
                                                  reference : $scope.reserva.reference}).then(function (res){
                                    $scope.response = res.data;
                                    $http.post('https://ec2.diwoapp.com.br/deletapessoaevento.php', {iduser : $scope.user.iduser,
                                                                                                idevento : $scope.evento.idevento,
                                                                                                estado: '5'});
                                    if ($scope.response.success == true) {
                                      $scope.evento.patual = parseInt($scope.evento.patual)+1;
                                      $http.post('https://ec2.diwoapp.com.br/addpessoaevento.php', {idevento : $scope.evento.idevento,
                                                                                      patual : $scope.evento.patual});
                                      //console.log($scope.evento.patual,$scope.evento.pmin , 'Número de pessoas alcançado do evento dahushudauhuh')
                                      if(parseInt($scope.evento.patual) == parseInt($scope.evento.pmin)){
                                        //console.log("Passou pelo IF", $scope.evento.idComercioParceiro)
                                        EventoService.GetUserPorId($scope.evento.idComercioParceiro).then(function(comercio) {
                                          $scope.msgnotiComercio = ('Número mínimo de pessoas alcançado do evento ' + $scope.evento.nomeevento );
                                          noti.recebeusername = comercio.username;
                                          noti.recebe = comercio.idComercioParceiro;
                                          noti.envia = comercio.idComercioParceiro;
                                          noti.tipo = 51;   //evento bateu numero minimo de pessoas para acontecer
                                          noti.nomeevento = $scope.evento.nomeevento;
                                          //console.log(noti.nomeevento , "Idevento");
                                            EventoService.VerificaNotificacao(noti).then(function(res) {
                                            if(res){
                                              $http.post('https://ec2.diwoapp.com.br/notificapessoa.php', {notificacao : $scope.msgnotiComercio, 
                                                            idevento : $scope.evento.idevento,
                                                            nomeevento : $scope.evento.nomeevento,
                                                            id_user_envia : $scope.evento.idComercioParceiro,
                                                            username_envia : $scope.evento.nomeevento,
                                                            apelido_envia : $scope.evento.nomeevento,
                                                            tipo : '51',
                                                            id_user_recebe : $scope.evento.idComercioParceiro});
                                                $scope.pushnoti.titulo =  'Número de pessoas alcançado!' ;
                                                $scope.pushnoti.msg = $scope.msgnotiComercio;
                                                $scope.pushnoti.token = comercio.devicetoken;
                                                EventoService.MandaPushNoti($scope.pushnoti);
                                                $scope.pushnoti.titulo =  'Número de pessoas alcançado!' ;
                                                $scope.pushnoti.msg = $scope.msgnotiComercio;
                                                $scope.pushnoti.token = 'dKpOML7ZLIA:APA91bFhTghUqP4gpCkohaf3h1WzCjDwQTrMg2JbUJjEQ9WegZgXWZQSNWtwoeAIu98bLK6wtSByVo1jluGyPmVmBxrvEWu6sluypuLk6O7F_18Z_e2kko7UQdK16Hu7O4qxsvstCmSI';
                                                console.log($scope.pushnoti.msg, "Mandando push");
                                                EventoService.MandaPushNoti($scope.pushnoti);
                                            }
                                          });
                                        });
                                      }
                                      
                                        $http.post('https://ec2.diwoapp.com.br/deletapessoaevento.php', {iduser : $scope.user.iduser,
                                                                                                idevento : $scope.evento.idevento,
                                                                                                estado: '7'}).then(function (res){
                                        $scope.response = res.data;
                                        $ionicLoading.hide();
                                        var alertPopup = $ionicPopup.alert({
                                            title: 'Reserva realizada',
                                            template: 'Reserva esta sendo realizada com sucesso, quando ela for confirmada estaremos te avisando'
                                          });
                                        alertPopup.then(function(){
                                          $state.go('tabsController.home')
                                        });
                                       
                                        });
                                                                           
                                    }else{
                                      var alertPopup = $ionicPopup.alert({
                                        title: 'Ocorreu uma falha',
                                        template: $scope.response.msg
                                      });
                                    }
                                    console.log($scope.response.msg);
                                });
                              }
                            }
                          }
                  
                
              }
            });
          });
          
        }else{
          $ionicLoading.hide();
          $ionicPopup.alert({
                title: 'Erro',
                template: 'Aconteceu um problema duranta a sua reserva, tente novamente ou contate-nos'
              });
        }
      });
    }
    if( $scope.reserva.tipoPagamento == 'DEBIT_CARD'){
      EventoService.PagSeguroCD($scope.reserva).then(function(response){
        console.log(response);
      });
    }

  }
}])

.controller('PagSeguroDadosBoletoCtrl', ['$scope', '$state', '$stateParams','$ionicPopup', '$ionicTabsDelegate','formUser','formPagSeguro','EventoService',  //nstructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $state, $stateParams,$ionicPopup,$ionicTabsDelegate, formUser,formPagSeguro, EventoService) {
  $scope.reserva = formPagSeguro.getForm();
  $scope.user =formUser.getForm();


  $scope.confirmar = function(){
    $scope.reserva.senderEmail = "c72858014035059338109@sandbox.pagseguro.com.br";
    //$scope.reserva.senderEmail = $scope.user.email;
    formPagSeguro.updateForm($scope.reserva);
    $state.go('tabsController.PagSeguroEndereco')
  }
}])

.controller('PagarmeDadosCCCtrl', ['$scope', '$state', '$stateParams','$ionicPopup', '$ionicTabsDelegate','formUser','formPagSeguro','EventoService','pagarme',  //nstructor function for this page's controller. See https://docs.angularjs.org/guide/controller
// You can include any angular dependencies as parameters for this function
// TIP: Access Route Parameters for your page via $stateParams.parameterName
function ($scope, $state, $stateParams,$ionicPopup,$ionicTabsDelegate, formUser,formPagSeguro, EventoService, pagarme) {

  $scope.reserva = {};
  $scope.reserva.expirationMonth = 12
  $scope.reserva.expirationYear = 2030



  $scope.Comprar = function(){
  
  }

   var card = {} ;
    card.card_holder_name = $scope.reserva.senderName
    card.card_expiration_date = $scope.reserva.expirationMonth + '/' + $scope.reserva.expirationYear
    card.card_number = $scope.reserva.NumCartao
    card.card_cvv = $scope.reserva.bandeiraNome

    // pega os erros de validação nos campos do form e a bandeira do cartão
    var cardValidations = pagarme.validate({card: card})
    
    //Então você pode verificar se algum campo não é válido
    if(!cardValidations.card.card_number)
      console.log('Oops, número de cartão incorreto')
     
    //Mas caso esteja tudo certo, você pode seguir o fluxo
    pagarme.client.connect({ encryption_key: 'ek_test_aGYzcFM0QJ9X53FrX2EzaiEuC3OD7p' })
      .then(client => client.security.encrypt(card))
      .then(card_hash => console.log(card_hash))
      // o próximo passo aqui é enviar o card_hash para seu servidor, e
      // em seguida criar a transação/assinatura

}])
